import{S as N,I as U,a as G,g as ie,b as oe,c as H,d as L,_ as re,e as ne,f as se,o as ae,h as le,i as de,j as ue,k as ce,l as fe,m as pe,n as ge,p as Pe,q as we,s as ve,t as ye,P as p,u as V,v as O,w as g,G as Re,V as u,x as M,y as T,U as Se,z as K,A as x,B as E,W as me,C as he,D as Te,E as Ce}from"./index-BacJ9JLs.js";import{M as Xe,N as $e,F as je,L as qe,T as Je,O as Qe,J as ze,H as Ze,R as et,Q as tt,K as it}from"./index-BacJ9JLs.js";import{g as Ae,E as be,S as Ee,P as Ie,A as Be}from"./views-DMSO2ys6.js";import{a as rt,b as nt,i as st,o as at}from"./views-DMSO2ys6.js";import{M as Ve,a as Oe}from"./editor-V6cdv4rn.js";import"./editor.contribution._autosave-XfTFZJKA.js";function xe(e,i,n){const P=document.createElement(i==="status"?"footer":"div");P.classList.add("part","monaco-workbench-part",...n);P.id=e;P.setAttribute("role",i);if(i==="status"){P.setAttribute("aria-live","off")}return P}function F(e){const i=e.getContainer()?.parentNode;if(i==null){return}e.layout(Math.max(e.minimumWidth,Math.min(e.maximumWidth,i.offsetWidth)),Math.max(e.minimumHeight,Math.min(e.maximumHeight,i.offsetHeight)),i.offsetTop,i.offsetLeft)}function De(e,i){e.oncontextmenu=()=>false;function n(){F(i)}i.onDidVisibilityChange(P=>{if(P){n()}});n()}function Y(e){return N.get(U).getPart(e)}function Le(e,i){i.append(e.getContainer());const n=new ResizeObserver(()=>F(e));n.observe(i);return{dispose(){return n.disconnect()}}}function Ke(e,i){const n=Y(e);if(n==null){throw new Error("Part not found")}return Le(n,i)}function Ne(e,i){const n=Y(e);if(n==null){throw new Error("Part not found")}return n.onDidVisibilityChange(i)}function _e(e){if(!e.isConnected){return false}if(e.checkVisibility!=null){return e.checkVisibility({checkOpacity:true,checkVisibilityCSS:true})}return e.offsetHeight>0&&e.offsetWidth>0}function I(){const e=N.get(L).mainPart.getContainer();return e!=null&&_e(e)}let D=class Ue extends Oe{constructor(i){super(i.createInstance(be),false,i);this.restoreGroup=(...n)=>{return this.delegate.restoreGroup(...n)}}getId(){return"standalone"}updateStyles(){}registerPart(i){return this.delegate.registerPart(i)}bind(i,n){return this.delegate.bind(i,n)}get activePart(){return this.delegate.activePart}};D=re([ne(0,se)],D);let X=e=>e;ae(async e=>{const i=e.get(le);const n=e.get(de);const P=e.get(ue);const R=e.get(ce);const S=e.get(L);const $=e.get(H);const m=e.get(fe);const j=e.get(pe);const C=e.get(ge);const _=e.get(Pe);const k=e.get(we);const q=e.get(ve);const J=e.get(ye);const c=e.get(U);function Q(){const t=C.options?.defaultLayout;if((t?.editors!=null&&t.editors.length>0||t?.layout?.editors!=null)&&((t.force??false)||R.isNew(T.WORKSPACE))){return{layout:t.layout?.editors,filesToOpenOrCreate:t.editors?.map(r=>{return{viewColumn:r.viewColumn,fileUri:Se.revive(r.uri),openOnlyIfExists:r.openOnlyIfExists,options:r.options}})}}const{filesToOpenOrCreate:d,filesToDiff:o,filesToMerge:l}=C;if(d!=null||o!=null||l!=null){return{filesToOpenOrCreate:d,filesToDiff:o,filesToMerge:l}}return void 0}function z(t,d){const o=t.options?.defaultLayout;if(o==null){return void 0}if(!(o.force??false)&&!d.isNew(T.WORKSPACE)){return void 0}const{views:l}=o;if(l!=null&&l.length>0){return l.map(r=>r.id)}return void 0}function Z(t,d){if(he(t.getWorkspace())){return false}const o=k.getValue("window.restoreWindows")==="preserve";return!!o||d===void 0}async function ee(t,d){if(d!=null){const o=K(await x(d.filesToMerge,t,m));if(o.length===4&&E(o[0])&&E(o[1])&&E(o[2])&&E(o[3])){return[{editor:{input1:{resource:o[0].resource},input2:{resource:o[1].resource},base:{resource:o[2].resource},result:{resource:o[3].resource},options:{pinned:true}}}]}const l=K(await x(d.filesToDiff,t,m));if(l.length===2){return[{editor:{original:{resource:l[0].resource},modified:{resource:l[1].resource},options:{pinned:true}}}]}const r=[];const f=await x(d.filesToOpenOrCreate,t,m);for(let a=0;a<f.length;a++){const w=f[a];if(w!=null){r.push({editor:w,viewColumn:d.filesToOpenOrCreate?.[a].viewColumn})}}return r}else if(_.getWorkbenchState()===me.EMPTY&&k.getValue("workbench.startupEditor")==="newUntitledFile"){if(S.mainPart.hasRestorableState){return[]}const o=await J.hasBackups();if(o){return[]}return[{editor:{resource:void 0}}]}return[]}const h=Q();if(h!=null){m.info("Initial editor state",h)}let s={layout:{editors:h?.layout},editor:{restoreEditors:Z(_,h),editorsToOpen:ee(q,h)},views:{defaults:z(C,R),containerToRestore:{}}};function v(t){return n.getDefaultViewContainer(t)??n.getViewContainersByLocation(t)[0]}function te(){if(c.isVisible(p.SIDEBAR_PART)){let t;if(!C.isBuilt||P.startupKind===Te.ReloadedWindow||Ce){t=R.get(Ee.activeViewletSettingsKey,T.WORKSPACE,v(u.Sidebar)?.id)}else{t=v(u.Sidebar)?.id}s.views.containerToRestore.sideBar=t}if(c.isVisible(p.PANEL_PART)){const t=R.get(Ie.activePanelSettingsKey,T.WORKSPACE,v(u.Panel)?.id);s.views.containerToRestore.panel=t}if(c.isVisible(p.AUXILIARYBAR_PART)){const t=R.get(Be.activeViewSettingsKey,T.WORKSPACE,v(u.AuxiliaryBar)?.id);s.views.containerToRestore.auxiliaryBar=t}}te();s=X(s);if(s.views.containerToRestore.sideBar==null){c.setPartHidden(true,p.SIDEBAR_PART)}if(s.views.containerToRestore.panel==null){c.setPartHidden(true,p.PANEL_PART)}if(s.views.containerToRestore.auxiliaryBar==null){c.setPartHidden(true,p.AUXILIARYBAR_PART)}const B=document.createElement("div");B.style.display="none";document.body.append(B);for(const{id:t,role:d,classes:o,options:l,getPosition:r,onDidChangePosition:f}of[{id:p.TITLEBAR_PART,role:"none",classes:["titlebar"]},{id:p.BANNER_PART,role:"banner",classes:["banner"]},{id:p.ACTIVITYBAR_PART,role:"none",classes:["activitybar"],getPosition:()=>c.getSideBarPosition(),onDidChangePosition:c.onDidChangeSideBarPosition},{id:p.SIDEBAR_PART,role:"none",classes:["sidebar"],getPosition:()=>c.getSideBarPosition(),onDidChangePosition:c.onDidChangeSideBarPosition},{id:p.EDITOR_PART,role:"main",classes:["editor"],options:{restorePreviousState:s.editor.restoreEditors}},{id:p.PANEL_PART,role:"none",classes:["panel","basepanel"],getPosition:()=>c.getPanelPosition(),onDidChangePosition:c.onDidChangePanelPosition},{id:p.AUXILIARYBAR_PART,role:"none",classes:["auxiliarybar","basepanel"],getPosition:()=>c.getSideBarPosition()===V.LEFT?V.RIGHT:V.LEFT,onDidChangePosition:c.onDidChangeSideBarPosition},{id:p.STATUSBAR_PART,role:"status",classes:["statusbar"]}]){const a=c.getPart(t);if(a!=null){const w=xe(t,d,o);a.create(w,l);De(w,a);a.layout(9999,9999,0,0);B.append(w);if(r!=null){let b=r();a.element.classList.add(O(b));f?.(()=>{a.element.classList.remove(O(b));b=r();a.element.classList.add(O(b))})}}}const y=[];const W=[];y.push((async()=>{g("code/willRestoreEditors");await S.mainPart.whenReady;g("code/restoreEditors/editorGroupsReady");if(s.layout?.editors!=null){S.applyLayout(s.layout.editors)}const t=await s.editor.editorsToOpen;g("code/restoreEditors/editorsToOpenResolved");let d;if(t.length>0){const o=S.getGroups(Re.GRID_APPEARANCE);const l=new Map;for(const r of t){const f=o[(r.viewColumn??1)-1];let a=l.get(f.id);if(a==null){a=new Set;l.set(f.id,a)}a.add(r.editor)}d=Promise.all(Array.from(l).map(async([r,f])=>{try{await $.openEditors(Array.from(f),r,{validateTrust:true})}catch(a){m.error(a)}}))}W.push(Promise.all([d?.finally(()=>g("code/restoreEditors/editorsOpened")),S.mainPart.whenRestored.finally(()=>g("code/restoreEditors/editorGroupsRestored"))]).finally(()=>{g("code/didRestoreEditors")}))})());const A=(async()=>{if(s.views.defaults!=null&&s.views.defaults.length>0){g("code/willOpenDefaultViews");const t=[];const d=r=>{const f=n.getViewLocationById(r.id);if(f!==null){const a=n.getViewContainerByViewId(r.id);if(a!=null){if(r.order>=(t[f]?.order??0)){t[f]={id:a.id,order:r.order}}const w=n.getViewContainerModel(a);w.setCollapsed(r.id,false);w.setVisible(r.id,true);return true}}return false};const o=[...s.views.defaults].reverse().map((r,f)=>({id:r,order:f}));let l=o.length;while(l>0){l--;if(d(o[l])){o.splice(l,1)}}if(o.length>0){await j.whenInstalledExtensionsRegistered();let r=o.length;while(r>0){r--;if(d(o[r])){o.splice(r,1)}}}if(t[u.Sidebar]!=null){s.views.containerToRestore.sideBar=t[u.Sidebar].id}if(t[u.Panel]!=null){s.views.containerToRestore.panel=t[u.Panel].id}if(t[u.AuxiliaryBar]!=null){s.views.containerToRestore.auxiliaryBar=t[u.AuxiliaryBar].id}g("code/didOpenDefaultViews")}})();y.push(A);y.push((async()=>{await A;if(s.views.containerToRestore.sideBar==null){return}g("code/willRestoreViewlet");const t=await i.openPaneComposite(s.views.containerToRestore.sideBar,u.Sidebar);if(t==null){await i.openPaneComposite(v(u.Sidebar)?.id,u.Sidebar)}g("code/didRestoreViewlet")})());y.push((async()=>{await A;if(s.views.containerToRestore.panel==null){return}g("code/willRestorePanel");const t=await i.openPaneComposite(s.views.containerToRestore.panel,u.Panel);if(t==null){await i.openPaneComposite(v(u.Panel)?.id,u.Panel)}g("code/didRestorePanel")})());y.push((async()=>{await A;if(s.views.containerToRestore.auxiliaryBar==null){return}g("code/willRestoreAuxiliaryBar");const t=await i.openPaneComposite(s.views.containerToRestore.auxiliaryBar,u.AuxiliaryBar);if(t==null){await i.openPaneComposite(v(u.AuxiliaryBar)?.id,u.AuxiliaryBar)}g("code/didRestoreAuxiliaryBar")})());await M.settled(y);await M.settled(W)});function He(e,i,n){if(n!=null){X=typeof n==="boolean"?P=>({...P,editor:{...P.editor,restoreEditors:n}}):n}return{...Ae(i),...oe({isKeybindingConfigurationVisible:I,shouldUseGlobalPicker:I}),...ie({shouldUseGlobalKeybindings:I}),[L.toString()]:new G(D,[],false),[H.toString()]:new G(Ve,[e,I],false)}}export{Xe as AbstractResourceEditorInput,$e as AbstractTextResourceEditorInput,rt as ActivityService,je as ActivitybarPart,qe as ConfirmResult,Je as DomScrollableElement,Qe as EditorInput,ze as EditorInputCapabilities,Ze as GroupOrientation,Ie as PanelPart,p as Parts,V as Position,et as RegisteredEditorPriority,Ee as SidebarPart,tt as SplitView,u as ViewContainerLocation,it as ViewPaneContainer,Ke as attachPart,He as default,nt as getSideBarPosition,I as isEditorPartVisible,st as isPartVisibile,at as onDidChangeSideBarPosition,Ne as onPartVisibilityChange,De as renderPart};
