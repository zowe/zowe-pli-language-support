import{X as j,cq as Ps,cl as Y,cM as on,cN as Pe,cO as v,cP as Ns,cQ as St,cR as an,Y as T,av as Vs,cS as q,cT as cn,cU as hn,cV as oe,ag as ue,cW as P,c9 as ln,ca as N,cd as Fe,ce as E,cX as ci,cj as we,cY as se,cZ as Xt,c_ as Ge,c$ as Zt,d0 as We,f as B,d1 as me,aj as be,c4 as Bs,ad as V,am as g,cc as le,cn as Ie,cm as O,d2 as zi,d3 as Ki,_ as y,e as d,ak as Yi,bI as F,c0 as xe,c1 as Z,cs as ye,d4 as fe,d5 as dn,cv as S,d6 as Xi,d7 as Ls,d8 as Vt,d9 as ut,da as un,db as fn,bU as ft,dc as Bt,dd as Be,de as H,df as Ae,dg as $,dh as hi,U as $t,di as gn,dj as mn,dk as ei,dl as Ms,dm as Zi,dn as $i,dp as pn,dq as ge,dr as An,ds as ke,dt as ji,du as Os,dv as bn,dw as U,dx as it,dy as Le,q as Me,dz as xs,dA as Oe,dB as re,dC as ks,dD as Sn,dE as Cn,dF as En,P as l,bW as C,cr as ie,bZ as te,dG as Se,d as _e,dH as In,dI as K,dJ as Ce,dK as Tn,aM as st,dL as yn,dM as _n,dN as vn,j as Lt,dO as je,dP as Hs,dQ as wn,dR as ti,dS as w,dT as ns,dU as Dn,bY as Ct,p as jt,k as ae,t as Rn,m as Pn,l as Fs,dV as Nn,c as qe,h as Vn,i as Bn,dW as qi,dX as He,s as Ln,dY as Mt,dZ as li,d_ as Ze,d$ as rs,e0 as Mn,e1 as Xe,e2 as gt,E as ne,e3 as Ne,e4 as di,e5 as ve,e6 as Ws,e7 as os,u as _,e8 as On,e9 as xn,ea as kn,eb as Hn,D as Fn,y as I,V as A,C as Wn,z as tt,A as ii,B as Et,W as nt,w as M,G as Gn,x as as,ec as Tt,ed as Un,ee as zn,ef as qt,eg as ui,eh as x,ei as cs,ej as G,ek as Kn,el as Yn,em as Xn,en as Zn,J as $n,H as jn,eo as hs,ep as qn,eq as ls,er as ce,v as Ke,es as yt,et as fi,eu as Jn,ev as Qn,b7 as R,ew as ds,bP as Gs,ex as us,ey as er,ez as tr,eA as ir,au as _t,eB as Us,eC as sr,c6 as nr,eD as rr,eE as or,eF as vt,eG as ar,eH as si,eI as cr,eJ as hr,eK as lr,eL as dr,eM as ur,eN as fr,eO as gr,eP as mr,eQ as pr,eR as Ar,eS as br,eT as zs,eU as Sr,eV as Ji,eW as fs,eX as Cr,eY as Ks,cu as Ys,eZ as gi,e_ as Xs,c7 as Qi,c8 as es,e$ as Er,cb as ts,f0 as wt,f1 as Ir,f2 as Tr,f3 as yr,f4 as _r,f5 as vr,f6 as wr,cw as Q,f7 as gs,f8 as Dr,f9 as Rr,fa as Pr,fb as Nr,fc as is,fd as Vr,fe as ms,ff as Br,fg as ps,fh as As,fi as Lr,fj as Mr,fk as Or,fl as xr,fm as kr,fn as Hr,fo as Fr,fp as Wr,fq as Gr,fr as Ur,aB as zr,fs as Kr,ft as Yr,fu as Xr,fv as Zs,fw as Zr,fx as bs,fy as $r,fz as jr,fA as qr,fB as Ss,fC as ss,a as Ve,fD as $s,fE as Je,fF as Dt,fG as js,fH as qs,fI as Ue,fJ as Jr,fK as ni,fL as Cs,fM as Qr,fN as eo,fO as to,fP as io,fQ as Es,fR as so,fS as no,fT as ro,fU as oo,fV as ao,fW as co,fX as ho,fY as lo,fZ as uo,ci as fo,f_ as Is,f$ as go,g0 as mo,g1 as po,g2 as Ao,g3 as bo,g4 as So,g5 as Co,g6 as Eo,g7 as Io,ao as To,g8 as yo,g9 as _o,al as vo,ga as Js,aG as wo,aH as Do,gb as Ro,gc as Po,gd as No,ge as Vo,gf as Bo,gg as Lo,gh as Mo,gi as Oo,gj as Jt,bs as xo,gk as ko,gl as Ho,b4 as Fo,gm as Wo,g as Go,b as Uo,gn as zo,go as Ko,gp as Yo,gq as Xo,gr as Zo,o as $o}from"./index-B2Owkx8d.js";import{M as Vc,N as Bc,L as Lc,T as Mc,O as Oc,R as xc,Q as kc,K as Hc}from"./index-B2Owkx8d.js";import{S as jo,P as qo,A as Jo,c as Qo,d as et,D as z,g as ea,E as ta,B as ia}from"./views-CmCEDwXt.js";import{b as Wc,i as Gc,o as Uc}from"./views-CmCEDwXt.js";import{E as sa}from"./editor.contribution._autosave-PCsMmjQC.js";const na=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));const Qs=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));var X;(function(h){h[h["ADD"]=0]="ADD";h[h["CHANGE"]=1]="CHANGE";h[h["EXPAND_COLLAPSE"]=2]="EXPAND_COLLAPSE";h[h["REMOVE"]=3]="REMOVE"})(X||(X={}));var $e;(function(h){h[h["ADD"]=0]="ADD";h[h["REMOVE"]=1]="REMOVE"})($e||($e={}));class ra extends j{constructor(e,t){super();this.item=e;this.onClose=t;this._onDidClose=this._register(new T);this.onDidClose=this._onDidClose.event;this._onDidChangeVisibility=this._register(new T);this.onDidChangeVisibility=this._onDidChangeVisibility.event;this.registerListeners()}registerListeners(){this._register(this.item.onDidChangeVisibility(e=>this._onDidChangeVisibility.fire(e)));oe.once(this.item.onDidClose)(()=>{this._onDidClose.fire();this.dispose()})}get progress(){return this.item.progress}updateSeverity(e){this.item.updateSeverity(e)}updateMessage(e){this.item.updateMessage(e)}updateActions(e){this.item.updateActions(e)}close(){this.onClose(this.item);this.dispose()}}class en extends j{constructor(){super(...arguments);this._onDidChangeNotification=this._register(new T);this.onDidChangeNotification=this._onDidChangeNotification.event;this._onDidChangeStatusMessage=this._register(new T);this.onDidChangeStatusMessage=this._onDidChangeStatusMessage.event;this._onDidChangeFilter=this._register(new T);this.onDidChangeFilter=this._onDidChangeFilter.event;this._notifications=[];this.filter={global:v.OFF,sources:new Map}}static{this.NO_OP_NOTIFICATION=new cn}get notifications(){return this._notifications}get statusMessage(){return this._statusMessage}setFilter(e){let t=false;if(typeof e.global==="number"){t=this.filter.global!==e.global;this.filter.global=e.global}let i=false;if(e.sources){i=!hn(this.filter.sources,e.sources);this.filter.sources=e.sources}if(t||i){this._onDidChangeFilter.fire({global:t?e.global:void 0,sources:i?e.sources:void 0})}}addNotification(e){const t=this.createViewItem(e);if(!t){return en.NO_OP_NOTIFICATION}const i=this.findNotification(t);i?.close();this._notifications.splice(0,0,t);this._onDidChangeNotification.fire({item:t,index:0,kind:X.ADD});return new ra(t,s=>this.onClose(s))}onClose(e){const t=this.findNotification(e);if(t&&t!==e){t.close()}else{e.close()}}findNotification(e){return this._notifications.find(t=>t.equals(e))}createViewItem(e){const t=pe.create(e,this.filter);if(!t){return void 0}const i=(r,o)=>{const a=this._notifications.indexOf(t);if(a>=0){this._onDidChangeNotification.fire({item:t,index:a,kind:r,detail:o})}};const s=t.onDidChangeExpansion(()=>i(X.EXPAND_COLLAPSE));const n=t.onDidChangeContent(r=>i(X.CHANGE,r.kind));oe.once(t.onDidClose)(()=>{s.dispose();n.dispose();const r=this._notifications.indexOf(t);if(r>=0){this._notifications.splice(r,1);this._onDidChangeNotification.fire({item:t,index:r,kind:X.REMOVE})}});return t}showStatusMessage(e,t){const i=aa.create(e,t);if(!i){return j.None}this._statusMessage=i;this._onDidChangeStatusMessage.fire({kind:$e.ADD,item:i});return ue(()=>{if(this._statusMessage===i){this._statusMessage=void 0;this._onDidChangeStatusMessage.fire({kind:$e.REMOVE,item:i})}})}}function ri(h){return h instanceof pe}var ee;(function(h){h[h["SEVERITY"]=0]="SEVERITY";h[h["MESSAGE"]=1]="MESSAGE";h[h["ACTIONS"]=2]="ACTIONS";h[h["PROGRESS"]=3]="PROGRESS"})(ee||(ee={}));class oa extends j{constructor(){super();this._onDidChange=this._register(new T);this.onDidChange=this._onDidChange.event;this._state=Object.create(null)}get state(){return this._state}infinite(){if(this._state.infinite){return}this._state.infinite=true;this._state.total=void 0;this._state.worked=void 0;this._state.done=void 0;this._onDidChange.fire()}done(){if(this._state.done){return}this._state.done=true;this._state.infinite=void 0;this._state.total=void 0;this._state.worked=void 0;this._onDidChange.fire()}total(e){if(this._state.total===e){return}this._state.total=e;this._state.infinite=void 0;this._state.done=void 0;this._onDidChange.fire()}worked(e){if(typeof this._state.worked==="number"){this._state.worked+=e}else{this._state.worked=e}this._state.infinite=void 0;this._state.done=void 0;this._onDidChange.fire()}}class pe extends j{static{this.MAX_MESSAGE_LENGTH=1e3}static create(e,t){if(!e||!e.message||Ps(e.message)){return void 0}let i;if(typeof e.severity==="number"){i=e.severity}else{i=Y.Info}const s=pe.parseNotificationMessage(e.message);if(!s){return void 0}let n;if(e.actions){n=e.actions}else if(on(e.message)){n={primary:e.message.actions}}let r=e.priority??Pe.DEFAULT;if(r===Pe.DEFAULT&&i!==Y.Error){if(t.global===v.ERROR){r=Pe.SILENT}else if(Ns(e.source)&&t.sources.get(e.source.id)===v.ERROR){r=Pe.SILENT}}return new pe(e.id,i,e.sticky,r,s,e.source,e.progress,n)}static parseNotificationMessage(e){let t;if(e instanceof Error){t=St(e,false)}else if(typeof e==="string"){t=e}if(!t){return void 0}const i=t;if(t.length>pe.MAX_MESSAGE_LENGTH){t=`${t.substr(0,pe.MAX_MESSAGE_LENGTH)}...`}t=t.replace(/(\r\n|\n|\r)/gm," ").trim();const s=an(t);return{raw:i,linkedText:s,original:e}}constructor(e,t,i,s,n,r,o,a){super();this.id=e;this._severity=t;this._sticky=i;this._priority=s;this._message=n;this._source=r;this._visible=false;this._onDidChangeExpansion=this._register(new T);this.onDidChangeExpansion=this._onDidChangeExpansion.event;this._onDidClose=this._register(new T);this.onDidClose=this._onDidClose.event;this._onDidChangeContent=this._register(new T);this.onDidChangeContent=this._onDidChangeContent.event;this._onDidChangeVisibility=this._register(new T);this.onDidChangeVisibility=this._onDidChangeVisibility.event;if(o){this.setProgress(o)}this.setActions(a)}setProgress(e){if(e.infinite){this.progress.infinite()}else if(e.total){this.progress.total(e.total);if(e.worked){this.progress.worked(e.worked)}}}setActions(e={primary:[],secondary:[]}){this._actions={primary:Array.isArray(e.primary)?e.primary:[],secondary:Array.isArray(e.secondary)?e.secondary:[]};this._expanded=e.primary&&e.primary.length>0}get canCollapse(){return!this.hasActions}get expanded(){return!!this._expanded}get severity(){return this._severity}get sticky(){if(this._sticky){return true}const e=this.hasActions;if(e&&this._severity===Y.Error||!e&&this._expanded||this._progress&&!this._progress.state.done){return true}return false}get priority(){return this._priority}get hasActions(){if(!this._actions){return false}if(!this._actions.primary){return false}return this._actions.primary.length>0}get hasProgress(){return!!this._progress}get progress(){if(!this._progress){this._progress=this._register(new oa);this._register(this._progress.onDidChange(()=>this._onDidChangeContent.fire({kind:ee.PROGRESS})))}return this._progress}get message(){return this._message}get source(){return typeof this._source==="string"?this._source:this._source?this._source.label:void 0}get sourceId(){return this._source&&typeof this._source!=="string"&&"id"in this._source?this._source.id:void 0}get actions(){return this._actions}get visible(){return this._visible}updateSeverity(e){if(e===this._severity){return}this._severity=e;this._onDidChangeContent.fire({kind:ee.SEVERITY})}updateMessage(e){const t=pe.parseNotificationMessage(e);if(!t||t.raw===this._message.raw){return}this._message=t;this._onDidChangeContent.fire({kind:ee.MESSAGE})}updateActions(e){this.setActions(e);this._onDidChangeContent.fire({kind:ee.ACTIONS})}updateVisibility(e){if(this._visible!==e){this._visible=e;this._onDidChangeVisibility.fire(e)}}expand(){if(this._expanded||!this.canCollapse){return}this._expanded=true;this._onDidChangeExpansion.fire()}collapse(e){if(!this._expanded||!this.canCollapse){return}this._expanded=false;if(!e){this._onDidChangeExpansion.fire()}}toggle(){if(this._expanded){this.collapse()}else{this.expand()}}close(){this._onDidClose.fire();this.dispose()}equals(e){if(this.hasProgress||e.hasProgress){return false}if(typeof this.id==="string"||typeof e.id==="string"){return this.id===e.id}if(typeof this._source==="object"){if(this._source.label!==e.source||this._source.id!==e.sourceId){return false}}else if(this._source!==e.source){return false}if(this._message.raw!==e.message.raw){return false}const t=this._actions&&this._actions.primary||[];const i=e.actions&&e.actions.primary||[];return Vs(t,i,(s,n)=>s.id+s.label===n.id+n.label)}}class Ot extends q{constructor(e,t){super(e,t.label,void 0,true,async()=>{t.run();this._onDidRun.fire()});this._onDidRun=this._register(new T);this.onDidRun=this._onDidRun.event;this._keepOpen=!!t.keepOpen;this._menu=!t.isSecondary&&t.menu?t.menu.map((i,s)=>new Ot(`${e}.${s}`,i)):void 0}get menu(){return this._menu}get keepOpen(){return this._keepOpen}}class aa{static create(e,t){if(!e||Ps(e)){return void 0}let i;if(e instanceof Error){i=St(e,false)}else if(typeof e==="string"){i=e}if(!i){return void 0}return{message:i,options:t}}}const mi="notifications.showList";const mt="notifications.hideList";const ca="notifications.toggleList";const oi="notifications.hideToasts";const Ts="notifications.focusToasts";const ha="notifications.focusNextToast";const la="notifications.focusPreviousToast";const da="notifications.focusFirstToast";const ua="notifications.focusLastToast";const pi="notification.collapse";const Ai="notification.expand";const ys="notification.acceptPrimaryAction";const fa="notification.toggle";const bi="notification.clear";const xt="notifications.clearAll";const kt="notifications.toggleDoNotDisturbMode";const Ht="notifications.toggleDoNotDisturbModeBySource";function Re(h,e){if(ri(e)){return e}const t=h.lastFocusedList;if(t instanceof Ki){let i=t.getFocusedElements()[0];if(!ri(i)){if(t.isDOMFocused()){i=t.element(0)}}if(ri(i)){return i}}return void 0}function ga(h,e,t){P.registerCommandAndKeybindingRule({id:mi,weight:N.WorkbenchContrib,primary:ln(Fe.CtrlCmd|E.KeyK,Fe.CtrlCmd|Fe.Shift|E.KeyN),handler:()=>{e.hide();h.show()}});P.registerCommandAndKeybindingRule({id:mt,weight:N.WorkbenchContrib+50,when:ci,primary:E.Escape,handler:()=>h.hide()});we.registerCommand(ca,()=>{if(h.isVisible){h.hide()}else{e.hide();h.show()}});P.registerCommandAndKeybindingRule({id:bi,weight:N.WorkbenchContrib,when:se,primary:E.Delete,mac:{primary:Fe.CtrlCmd|E.Backspace},handler:(s,n)=>{const r=s.get(Xt);const o=Re(s.get(Ge),n);if(o&&!o.hasProgress){o.close();r.playSignal(Zt.clear)}}});P.registerCommandAndKeybindingRule({id:Ai,weight:N.WorkbenchContrib,when:se,primary:E.RightArrow,handler:(s,n)=>{const r=Re(s.get(Ge),n);r?.expand()}});P.registerCommandAndKeybindingRule({id:ys,weight:N.WorkbenchContrib,when:We.or(se,me),primary:Fe.CtrlCmd|Fe.Shift|E.KeyA,handler:s=>{const n=s.get(B).createInstance(pt);const r=Re(s.get(Ge))||t.notifications.at(0);if(!r){return}const o=r.actions?.primary?r.actions.primary.at(0):void 0;if(!o){return}n.run(o,r);r.close();n.dispose()}});P.registerCommandAndKeybindingRule({id:pi,weight:N.WorkbenchContrib,when:se,primary:E.LeftArrow,handler:(s,n)=>{const r=Re(s.get(Ge),n);r?.collapse()}});P.registerCommandAndKeybindingRule({id:fa,weight:N.WorkbenchContrib,when:se,primary:E.Space,secondary:[E.Enter],handler:s=>{const n=Re(s.get(Ge));n?.toggle()}});we.registerCommand(oi,s=>{e.hide()});P.registerKeybindingRule({id:oi,weight:N.WorkbenchContrib-50,when:me,primary:E.Escape});P.registerKeybindingRule({id:oi,weight:N.WorkbenchContrib+100,when:We.and(me,se),primary:E.Escape});we.registerCommand(Ts,()=>e.focus());P.registerCommandAndKeybindingRule({id:ha,weight:N.WorkbenchContrib,when:We.and(se,me),primary:E.DownArrow,handler:()=>{e.focusNext()}});P.registerCommandAndKeybindingRule({id:la,weight:N.WorkbenchContrib,when:We.and(se,me),primary:E.UpArrow,handler:()=>{e.focusPrevious()}});P.registerCommandAndKeybindingRule({id:da,weight:N.WorkbenchContrib,when:We.and(se,me),primary:E.PageUp,secondary:[E.Home],handler:()=>{e.focusFirst()}});P.registerCommandAndKeybindingRule({id:ua,weight:N.WorkbenchContrib,when:We.and(se,me),primary:E.PageDown,secondary:[E.End],handler:()=>{e.focusLast()}});we.registerCommand(xt,()=>h.clearAll());we.registerCommand(kt,s=>{const n=s.get(be);n.setFilter(n.getFilter()===v.ERROR?v.OFF:v.ERROR)});we.registerCommand(Ht,s=>{const n=s.get(be);const r=s.get(Bs);const o=n.getFilters().sort((u,m)=>u.label.localeCompare(m.label));const a=new V;const c=a.add(r.createQuickPick());c.items=o.map(u=>({id:u.id,label:u.label,tooltip:`${u.label} (${u.id})`,filter:u.filter}));c.canSelectMany=true;c.placeholder=g(3348,"Select sources to enable all notifications from");c.selectedItems=c.items.filter(u=>u.filter===v.OFF);c.show();a.add(c.onDidAccept(async()=>{for(const u of c.items){n.setFilter({id:u.id,label:u.label,filter:c.selectedItems.includes(u)?v.OFF:v.ERROR})}c.hide()}));a.add(c.onDidHide(()=>a.dispose()))});const i=le(3349,"Notifications");Ie.appendMenuItem(O.CommandPalette,{command:{id:mi,title:le(3350,"Show Notifications"),category:i}});Ie.appendMenuItem(O.CommandPalette,{command:{id:mt,title:le(3351,"Hide Notifications"),category:i},when:ci});Ie.appendMenuItem(O.CommandPalette,{command:{id:xt,title:le(3352,"Clear All Notifications"),category:i}});Ie.appendMenuItem(O.CommandPalette,{command:{id:ys,title:le(3353,"Accept Notification Primary Action"),category:i}});Ie.appendMenuItem(O.CommandPalette,{command:{id:kt,title:le(3354,"Toggle Do Not Disturb Mode"),category:i}});Ie.appendMenuItem(O.CommandPalette,{command:{id:Ht,title:le(3355,"Toggle Do Not Disturb Mode By Source..."),category:i}});Ie.appendMenuItem(O.CommandPalette,{command:{id:Ts,title:le(3356,"Focus Notification Toast"),category:i},when:me})}let pt=class Ya extends zi{constructor(e,t){super();this.telemetryService=e;this.notificationService=t}async runAction(e,t){this.telemetryService.publicLog2("workbenchActionExecuted",{id:e.id,from:"message"});try{await super.runAction(e,t)}catch(i){this.notificationService.error(i)}}};pt=y([d(0,Yi),d(1,be)],pt);const ma=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));ye(Qs);const pa=xe("notifications-clear",Z.close,g(3321,"Icon for the clear action in notifications."));const Aa=xe("notifications-clear-all",Z.clearAll,g(3322,"Icon for the clear all action in notifications."));const ba=xe("notifications-hide",Z.chevronDown,g(3323,"Icon for the hide action in notifications."));const Sa=xe("notifications-expand",Z.chevronUp,g(3324,"Icon for the expand action in notifications."));const Ca=xe("notifications-collapse",Z.chevronDown,g(3325,"Icon for the collapse action in notifications."));const Ea=xe("notifications-configure",Z.gear,g(3326,"Icon for the configure action in notifications."));const tn=xe("notifications-do-not-disturb",Z.bellSlash,g(3327,"Icon for the mute all action in notifications."));let rt=class Xa extends q{static{this.ID=bi}static{this.LABEL=g(3328,"Clear Notification")}constructor(e,t,i){super(e,t,F.asClassName(pa));this.commandService=i}async run(e){this.commandService.executeCommand(bi,e)}};rt=y([d(2,fe)],rt);let ot=class Za extends q{static{this.ID=xt}static{this.LABEL=g(3329,"Clear All Notifications")}constructor(e,t,i){super(e,t,F.asClassName(Aa));this.commandService=i}async run(){this.commandService.executeCommand(xt)}};ot=y([d(2,fe)],ot);let Ft=class $a extends q{static{this.ID=kt}static{this.LABEL=g(3330,"Toggle Do Not Disturb Mode")}constructor(e,t,i){super(e,t,F.asClassName(tn));this.commandService=i}async run(){this.commandService.executeCommand(kt)}};Ft=y([d(2,fe)],Ft);let Wt=class ja extends q{static{this.ID=Ht}static{this.LABEL=g(3331,"Toggle Do Not Disturb Mode By Source...")}constructor(e,t,i){super(e,t);this.commandService=i}async run(){this.commandService.executeCommand(Ht)}};Wt=y([d(2,fe)],Wt);class It extends q{static{this.ID="workbench.action.configureDoNotDisturbMode"}static{this.LABEL=g(3332,"Configure Do Not Disturb...")}constructor(e,t){super(e,t,F.asClassName(tn))}}let at=class qa extends q{static{this.ID=mt}static{this.LABEL=g(3333,"Hide Notifications")}constructor(e,t,i){super(e,t,F.asClassName(ba));this.commandService=i}async run(){this.commandService.executeCommand(mt)}};at=y([d(2,fe)],at);let ct=class Ja extends q{static{this.ID=Ai}static{this.LABEL=g(3334,"Expand Notification")}constructor(e,t,i){super(e,t,F.asClassName(Sa));this.commandService=i}async run(e){this.commandService.executeCommand(Ai,e)}};ct=y([d(2,fe)],ct);let ht=class Qa extends q{static{this.ID=pi}static{this.LABEL=g(3335,"Collapse Notification")}constructor(e,t,i){super(e,t,F.asClassName(Ca));this.commandService=i}async run(e){this.commandService.executeCommand(pi,e)}};ht=y([d(2,fe)],ht);class Rt extends q{static{this.ID="workbench.action.configureNotification"}static{this.LABEL=g(3336,"More Actions...")}constructor(e,t,i){super(e,t,F.asClassName(Ea));this.notification=i}}let lt=class ec extends q{static{this.ID="workbench.action.copyNotificationMessage"}static{this.LABEL=g(3337,"Copy Text")}constructor(e,t,i){super(e,t);this.clipboardService=i}run(e){return this.clipboardService.writeText(e.message.raw)}};lt=y([d(2,dn)],lt);var Si;var de;class Te{static{this.ROW_HEIGHT=42}static{this.LINE_HEIGHT=22}constructor(e){this.offsetHelper=this.createOffsetHelper(e)}createOffsetHelper(e){return e.appendChild(S(".notification-offset-helper"))}getHeight(e){if(!e.expanded){return Te.ROW_HEIGHT}let t=Te.ROW_HEIGHT;const i=this.computePreferredHeight(e);const s=Te.LINE_HEIGHT<i;if(s){const n=i-Te.LINE_HEIGHT;t+=n}if(e.source||Bt(e.actions&&e.actions.primary)){t+=Te.ROW_HEIGHT}if(t===Te.ROW_HEIGHT){e.collapse(true)}return t}computePreferredHeight(e){let t=0;if(!e.hasProgress){t++}if(e.canCollapse){t++}if(Bt(e.actions&&e.actions.secondary)){t++}this.offsetHelper.style.width=`${450-(10+30+t*30-Math.max(t-1,0)*4)}px`;const i=sn.render(e.message);this.offsetHelper.appendChild(i);const s=Math.max(this.offsetHelper.offsetHeight,this.offsetHelper.scrollHeight);Be(this.offsetHelper);return s}getTemplateId(e){if(e instanceof pe){return Gt.TEMPLATE_ID}throw new Error("unknown element type: "+e)}}class sn{static render(e,t){const i=S("span");for(const s of e.linkedText.nodes){if(typeof s==="string"){i.appendChild(document.createTextNode(s))}else{let n=s.title;if(!n&&s.href.startsWith("command:")){n=g(3378,"Click to execute command '{0}'",s.href.substr("command:".length))}else if(!n){n=s.href}const r=S("a",{href:s.href,title:n,tabIndex:0},s.label);if(t){const o=p=>{if(pn(p)){Ae.stop(p,true)}t.callback(s.href)};const a=t.toDispose.add(new ei(r,$.CLICK)).event;const c=t.toDispose.add(new ei(r,$.KEY_DOWN)).event;const u=oe.chain(c,p=>p.filter(b=>{const L=new Ms(b);return L.equals(E.Space)||L.equals(E.Enter)}));t.toDispose.add(Zi.addTarget(r));const m=t.toDispose.add(new ei(r,$i.Tap)).event;oe.any(a,m,u)(o,null,t.toDispose)}i.appendChild(r)}}return i}}let Gt=class tc{static{Si=this}static{this.TEMPLATE_ID="notification"}constructor(e,t,i,s){this.actionRunner=e;this.contextMenuService=t;this.instantiationService=i;this.notificationService=s}get templateId(){return Si.TEMPLATE_ID}renderTemplate(e){const t=Object.create(null);t.toDispose=new V;t.container=S(".notification-list-item");t.mainRow=S(".notification-list-item-main-row");t.icon=S(".notification-list-item-icon.codicon");t.message=S(".notification-list-item-message");const i=this;const s=S(".notification-list-item-toolbar-container");t.toolbar=new Xi(s,{ariaLabel:g(3379,"Notification Actions"),actionViewItemProvider:(n,r)=>{if(n instanceof Rt){return t.toDispose.add(new Ls(n,{getActions(){const o=[];const a={id:n.notification.sourceId,label:n.notification.source};if(Ns(a)){const c=i.notificationService.getFilter(a)===v.ERROR;o.push(Vt({id:a.id,label:c?g(3380,"Turn On All Notifications from '{0}'",a.label):g(3381,"Turn Off Info and Warning Notifications from '{0}'",a.label),run:()=>i.notificationService.setFilter({...a,filter:c?v.OFF:v.ERROR})}));if(n.notification.actions?.secondary?.length){o.push(new ut)}}if(Array.isArray(n.notification.actions?.secondary)){o.push(...n.notification.actions.secondary)}return o}},this.contextMenuService,{...r,actionRunner:this.actionRunner,classNames:n.class}))}return void 0},actionRunner:this.actionRunner});t.toDispose.add(t.toolbar);t.detailsRow=S(".notification-list-item-details-row");t.source=S(".notification-list-item-source");t.buttonsContainer=S(".notification-list-item-buttons-container");e.appendChild(t.container);t.container.appendChild(t.detailsRow);t.detailsRow.appendChild(t.source);t.detailsRow.appendChild(t.buttonsContainer);t.container.appendChild(t.mainRow);t.mainRow.appendChild(t.icon);t.mainRow.appendChild(t.message);t.mainRow.appendChild(s);t.progress=new un(e,fn);t.toDispose.add(t.progress);t.renderer=this.instantiationService.createInstance(Ci,t,this.actionRunner);t.toDispose.add(t.renderer);return t}renderElement(e,t,i){i.renderer.setInput(e)}disposeTemplate(e){ft(e.toDispose)}};Gt=Si=y([d(1,ge),d(2,B),d(3,be)],Gt);let Ci=class ic extends j{static{de=this}static{this.SEVERITIES=[Y.Info,Y.Warning,Y.Error]}constructor(e,t,i,s,n,r,o){super();this.template=e;this.actionRunner=t;this.openerService=i;this.instantiationService=s;this.keybindingService=n;this.contextMenuService=r;this.hoverService=o;this.inputDisposables=this._register(new V);if(!de.closeNotificationAction){de.closeNotificationAction=s.createInstance(rt,rt.ID,rt.LABEL);de.expandNotificationAction=s.createInstance(ct,ct.ID,ct.LABEL);de.collapseNotificationAction=s.createInstance(ht,ht.ID,ht.LABEL)}}setInput(e){this.inputDisposables.clear();this.render(e)}render(e){this.template.container.classList.toggle("expanded",e.expanded);this.inputDisposables.add(H(this.template.container,$.MOUSE_UP,n=>{if(n.button===1){Ae.stop(n,true)}}));this.inputDisposables.add(H(this.template.container,$.AUXCLICK,n=>{if(!e.hasProgress&&n.button===1){Ae.stop(n,true);e.close()}}));this.renderSeverity(e);const t=this.inputDisposables.add(this.hoverService.setupManagedHover(hi("mouse"),this.template.message,""));const i=this.renderMessage(e,t);this.renderSecondaryActions(e,i);const s=this.inputDisposables.add(this.hoverService.setupManagedHover(hi("mouse"),this.template.source,""));this.renderSource(e,s);this.renderButtons(e);this.renderProgress(e);this.inputDisposables.add(e.onDidChangeContent(n=>{switch(n.kind){case ee.SEVERITY:this.renderSeverity(e);break;case ee.PROGRESS:this.renderProgress(e);break;case ee.MESSAGE:this.renderMessage(e,t);break}}))}renderSeverity(e){de.SEVERITIES.forEach(t=>{if(e.severity!==t){this.template.icon.classList.remove(...F.asClassNameArray(this.toSeverityIcon(t)))}});this.template.icon.classList.add(...F.asClassNameArray(this.toSeverityIcon(e.severity)))}renderMessage(e,t){Be(this.template.message);this.template.message.appendChild(sn.render(e.message,{callback:s=>this.openerService.open($t.parse(s),{allowCommands:true}),toDispose:this.inputDisposables}));const i=e.canCollapse&&!e.expanded&&this.template.message.scrollWidth>this.template.message.clientWidth;t.update(i?this.template.message.textContent+"":"");return i}renderSecondaryActions(e,t){const i=[];if(Bt(e.actions?.secondary)){const n=this.instantiationService.createInstance(Rt,Rt.ID,Rt.LABEL,e);i.push(n);this.inputDisposables.add(n)}let s=false;if(e.canCollapse){if(e.expanded){s=true}else if(e.source){s=true}else if(t){s=true}}if(s){i.push(e.expanded?de.collapseNotificationAction:de.expandNotificationAction)}if(!e.hasProgress){i.push(de.closeNotificationAction)}this.template.toolbar.clear();this.template.toolbar.context=e;i.forEach(n=>this.template.toolbar.push(n,{icon:true,label:false,keybinding:this.getKeybindingLabel(n)}))}renderSource(e,t){if(e.expanded&&e.source){this.template.source.textContent=g(3382,"Source: {0}",e.source);t.update(e.source)}else{this.template.source.textContent="";t.update("")}}renderButtons(e){Be(this.template.buttonsContainer);const t=e.actions?e.actions.primary:void 0;if(e.expanded&&Bt(t)){const i=this;const s=this.inputDisposables.add(new class extends zi{async runAction(r){i.actionRunner.run(r,e);if(!(r instanceof Ot)||!r.keepOpen){e.close()}}});const n=this.inputDisposables.add(new gn(this.template.buttonsContainer));for(let r=0;r<t.length;r++){const o=t[r];const a={title:true,secondary:r>0,...mn};const c=o instanceof Ot?o.menu:void 0;const u=this.inputDisposables.add(c?n.addButtonWithDropdown({...a,contextMenuProvider:this.contextMenuService,actions:c,actionRunner:s}):n.addButton(a));u.label=o.label;this.inputDisposables.add(u.onDidClick(m=>{if(m){Ae.stop(m,true)}s.run(o)}))}}}renderProgress(e){if(!e.hasProgress){this.template.progress.stop().hide();return}const t=e.progress.state;if(t.infinite){this.template.progress.infinite().show()}else if(typeof t.total==="number"||typeof t.worked==="number"){if(typeof t.total==="number"&&!this.template.progress.hasTotal()){this.template.progress.total(t.total)}if(typeof t.worked==="number"){this.template.progress.setWorked(t.worked).show()}}else{this.template.progress.done().hide()}}toSeverityIcon(e){switch(e){case Y.Warning:return Z.warning;case Y.Error:return Z.error}return Z.info}getKeybindingLabel(e){const t=this.keybindingService.lookupKeybinding(e.id);return t?t.getLabel():null}};Ci=de=y([d(2,An),d(3,B),d(4,ke),d(5,ge),d(6,ji)],Ci);ye(ma);let Ut=class sc extends j{constructor(e,t,i,s){super();this.container=e;this.options=t;this.instantiationService=i;this.contextMenuService=s;this.viewModel=[]}show(){if(this.isVisible){return}if(!this.list){this.createNotificationsList()}this.isVisible=true}createNotificationsList(){this.listContainer=S(".notifications-list-container");const e=this._register(this.instantiationService.createInstance(pt));const t=this.instantiationService.createInstance(Gt,e);const i=this.listDelegate=new Te(this.listContainer);const s=this.options;const n=this.list=this._register(this.instantiationService.createInstance(Ki,"NotificationsList",this.listContainer,i,[t],{...s,setRowLineHeight:false,horizontalScrolling:false,overrideStyles:{listBackground:Os},accessibilityProvider:this.instantiationService.createInstance(Ei,s)}));const r=this._register(this.instantiationService.createInstance(lt,lt.ID,lt.LABEL));this._register(n.onContextMenu(a=>{if(!a.element){return}this.contextMenuService.showContextMenu({getAnchor:()=>a.anchor,getActions:()=>[r],getActionsContext:()=>a.element,actionRunner:e})}));this._register(n.onMouseDblClick(a=>a.element.toggle()));const o=this._register(bn(n.getHTMLElement()));this._register(o.onDidBlur(()=>{if(U(this.listContainer).document.hasFocus()){n.setFocus([])}}));se.bindTo(n.contextKeyService);this._register(n.onDidChangeSelection(a=>{if(a.indexes.length>0){n.setSelection([])}}));this.container.appendChild(this.listContainer)}updateNotificationsList(e,t,i=[]){const[s,n]=it(this.list,this.listContainer);const r=Le(n);const o=s.getFocus()[0];const a=this.viewModel[o];let c=null;if(typeof o==="number"){c=s.getRelativeTop(o)}this.viewModel.splice(e,t,...i);s.splice(e,t,i);s.layout();if(this.viewModel.length===0){this.hide()}else if(typeof o==="number"){let u=0;if(a){let m=this.viewModel.indexOf(a);if(m===-1){m=o-1}if(m<this.viewModel.length&&m>=0){u=m}}if(typeof c==="number"){s.reveal(u,c)}s.setFocus([u])}if(this.isVisible&&r){s.domFocus()}}updateNotificationHeight(e){const t=this.viewModel.indexOf(e);if(t===-1){return}const[i,s]=it(this.list,this.listDelegate);i.updateElementHeight(t,s.getHeight(e));i.layout()}hide(){if(!this.isVisible||!this.list){return}this.isVisible=false;this.list.splice(0,this.viewModel.length);this.viewModel=[]}focusFirst(){if(!this.list){return}this.list.focusFirst();this.list.domFocus()}hasFocus(){if(!this.listContainer){return false}return Le(this.listContainer)}layout(e,t){if(this.listContainer&&this.list){this.listContainer.style.width=`${e}px`;if(typeof t==="number"){this.list.getHTMLElement().style.maxHeight=`${t}px`}this.list.layout()}}dispose(){this.hide();super.dispose()}};Ut=y([d(2,B),d(3,ge)],Ut);let Ei=class nc{constructor(e,t,i){this._options=e;this._keybindingService=t;this._configurationService=i}getAriaLabel(e){let t;const i=this._keybindingService.lookupKeybinding("editor.action.accessibleView")?.getAriaLabel();if(this._configurationService.getValue("accessibility.verbosity.notification")){t=i?g(3357,"Inspect the response in the accessible view with {0}",i):g(3358,"Inspect the response in the accessible view via the command Open Accessible View which is currently not triggerable via keybinding")}if(!e.source){return t?g(3359,"{0}, notification, {1}",e.message.raw,t):g(3360,"{0}, notification",e.message.raw)}return t?g(3361,"{0}, source: {1}, notification, {2}",e.message.raw,e.source,t):g(3362,"{0}, source: {1}, notification",e.message.raw,e.source)}getWidgetAriaLabel(){return this._options.widgetAriaLabel??g(3363,"Notifications List")}getRole(){return"dialog"}};Ei=y([d(1,ke),d(2,Me)],Ei);var ze;ye(na);ye(Qs);let Ii=class rc extends xs{static{ze=this}static{this.MAX_DIMENSIONS=new Oe(450,400)}static{this.MAX_NOTIFICATION_SOURCES=10}constructor(e,t,i,s,n,r,o,a,c,u,m){super(i);this.container=e;this.model=t;this.instantiationService=s;this.layoutService=n;this.editorGroupService=o;this.keybindingService=a;this.notificationService=c;this.accessibilitySignalService=u;this.contextMenuService=m;this._onDidChangeVisibility=this._register(new T);this.onDidChangeVisibility=this._onDidChangeVisibility.event;this.notificationsCenterVisibleContextKey=ci.bindTo(r);this.registerListeners()}registerListeners(){this._register(this.model.onDidChangeNotification(e=>this.onDidChangeNotification(e)));this._register(this.layoutService.onDidLayoutMainContainer(e=>this.layout(Oe.lift(e))));this._register(this.notificationService.onDidChangeFilter(()=>this.onDidChangeFilter()))}onDidChangeFilter(){if(this.notificationService.getFilter()===v.ERROR){this.hide()}}get isVisible(){return!!this._isVisible}show(){if(this._isVisible){const i=re(this.notificationsList);i.show();i.focusFirst();return}if(!this.notificationsCenterContainer){this.create()}this.updateTitle();const[e,t]=it(this.notificationsList,this.notificationsCenterContainer);this._isVisible=true;t.classList.add("visible");e.show();this.layout(this.workbenchDimensions);e.updateNotificationsList(0,0,this.model.notifications);e.focusFirst();this.updateStyles();this.model.notifications.forEach(i=>i.updateVisibility(true));this.notificationsCenterVisibleContextKey.set(true);this._onDidChangeVisibility.fire()}updateTitle(){const[e,t]=it(this.notificationsCenterTitle,this.clearAllAction);if(this.model.notifications.length===0){e.textContent=g(3341,"No new notifications");t.enabled=false}else{e.textContent=g(3342,"Notifications");t.enabled=this.model.notifications.some(i=>!i.hasProgress)}}create(){this.notificationsCenterContainer=S(".notifications-center");this.notificationsCenterHeader=S(".notifications-center-header");this.notificationsCenterContainer.appendChild(this.notificationsCenterHeader);this.notificationsCenterTitle=S("span.notifications-center-header-title");this.notificationsCenterHeader.appendChild(this.notificationsCenterTitle);const e=S(".notifications-center-header-toolbar");this.notificationsCenterHeader.appendChild(e);const t=this._register(this.instantiationService.createInstance(pt));const i=this;const s=this._register(new Xi(e,{ariaLabel:g(3343,"Notification Center Actions"),actionRunner:t,actionViewItemProvider:(r,o)=>{if(r.id===It.ID){return this._register(this.instantiationService.createInstance(Ls,r,{getActions(){const a=[Vt({id:Ft.ID,label:i.notificationService.getFilter()===v.OFF?g(3344,"Enable Do Not Disturb Mode"):g(3345,"Disable Do Not Disturb Mode"),run:()=>i.notificationService.setFilter(i.notificationService.getFilter()===v.OFF?v.ERROR:v.OFF)})];const c=i.notificationService.getFilters().sort((u,m)=>u.label.localeCompare(m.label));for(const u of c.slice(0,ze.MAX_NOTIFICATION_SOURCES)){if(a.length===1){a.push(new ut)}a.push(Vt({id:`${Ft.ID}.${u.id}`,label:u.label,checked:u.filter!==v.ERROR,run:()=>i.notificationService.setFilter({...u,filter:u.filter===v.ERROR?v.OFF:v.ERROR})}))}if(c.length>ze.MAX_NOTIFICATION_SOURCES){a.push(new ut);a.push(i._register(i.instantiationService.createInstance(Wt,Wt.ID,g(3346,"More…"))))}return a}},this.contextMenuService,{...o,actionRunner:t,classNames:r.class,keybindingProvider:a=>this.keybindingService.lookupKeybinding(a.id)}))}return void 0}}));this.clearAllAction=this._register(this.instantiationService.createInstance(ot,ot.ID,ot.LABEL));s.push(this.clearAllAction,{icon:true,label:false,keybinding:this.getKeybindingLabel(this.clearAllAction)});this.configureDoNotDisturbAction=this._register(this.instantiationService.createInstance(It,It.ID,It.LABEL));s.push(this.configureDoNotDisturbAction,{icon:true,label:false});const n=this._register(this.instantiationService.createInstance(at,at.ID,at.LABEL));s.push(n,{icon:true,label:false,keybinding:this.getKeybindingLabel(n)});this.notificationsList=this.instantiationService.createInstance(Ut,this.notificationsCenterContainer,{widgetAriaLabel:g(3347,"Notifications Center")});this.container.appendChild(this.notificationsCenterContainer)}getKeybindingLabel(e){const t=this.keybindingService.lookupKeybinding(e.id);return t?t.getLabel():null}onDidChangeNotification(e){if(!this._isVisible){return}let t=false;const[i,s]=it(this.notificationsList,this.notificationsCenterContainer);switch(e.kind){case X.ADD:i.updateNotificationsList(e.index,0,[e.item]);e.item.updateVisibility(true);break;case X.CHANGE:switch(e.detail){case ee.ACTIONS:i.updateNotificationsList(e.index,1,[e.item]);break;case ee.MESSAGE:if(e.item.expanded){i.updateNotificationHeight(e.item)}break}break;case X.EXPAND_COLLAPSE:i.updateNotificationsList(e.index,1,[e.item]);break;case X.REMOVE:t=Le(s);i.updateNotificationsList(e.index,1);e.item.updateVisibility(false);break}this.updateTitle();if(this.model.notifications.length===0){this.hide();if(t){this.editorGroupService.activeGroup.focus()}}}hide(){if(!this._isVisible||!this.notificationsCenterContainer||!this.notificationsList){return}const e=Le(this.notificationsCenterContainer);this._isVisible=false;this.notificationsCenterContainer.classList.remove("visible");this.notificationsList.hide();this.model.notifications.forEach(t=>t.updateVisibility(false));this.notificationsCenterVisibleContextKey.set(false);this._onDidChangeVisibility.fire();if(e){this.editorGroupService.activeGroup.focus()}}updateStyles(){if(this.notificationsCenterContainer&&this.notificationsCenterHeader){const e=this.getColor(ks);this.notificationsCenterContainer.style.boxShadow=e?`0 0 8px 2px ${e}`:"";const t=this.getColor(Sn);this.notificationsCenterContainer.style.border=t?`1px solid ${t}`:"";const i=this.getColor(Cn);this.notificationsCenterHeader.style.color=i??"";const s=this.getColor(En);this.notificationsCenterHeader.style.background=s??""}}layout(e){this.workbenchDimensions=e;if(this._isVisible&&this.notificationsCenterContainer){const t=ze.MAX_DIMENSIONS.width;const i=ze.MAX_DIMENSIONS.height;let s=t;let n=i;if(this.workbenchDimensions){s=this.workbenchDimensions.width;s-=2*8;n=this.workbenchDimensions.height-35;if(this.layoutService.isVisible(l.STATUSBAR_PART,C)){n-=22}if(this.layoutService.isVisible(l.TITLEBAR_PART,C)){n-=22}n-=2*12}const r=re(this.notificationsList);r.layout(Math.min(t,s),Math.min(i,n))}}clearAll(){this.hide();for(const e of[...this.model.notifications]){if(!e.hasProgress){e.close()}this.accessibilitySignalService.playSignal(Zt.clear)}}};Ii=ze=y([d(2,ie),d(3,B),d(4,te),d(5,Se),d(6,_e),d(7,ke),d(8,be),d(9,Xt),d(10,ge)],Ii);class Ia extends j{constructor(e){super();this.model=e;for(const t of e.notifications){this.triggerAriaAlert(t)}this.registerListeners()}registerListeners(){this._register(this.model.onDidChangeNotification(e=>this.onDidChangeNotification(e)))}onDidChangeNotification(e){if(e.kind===X.ADD){this.triggerAriaAlert(e.item);if(e.item.severity===Y.Error){if(e.item.message.original instanceof Error){console.error(e.item.message.original)}else{console.error(St(e.item.message.linkedText.toString(),true))}}}}triggerAriaAlert(e){if(e.priority===Pe.SILENT){return}const t=e.onDidChangeContent(i=>{if(i.kind===ee.MESSAGE){this.doTriggerAriaAlert(e)}});oe.once(e.onDidClose)(()=>t.dispose());this.doTriggerAriaAlert(e)}doTriggerAriaAlert(e){let t;if(e.severity===Y.Error){t=g(3338,"Error: {0}",e.message.linkedText.toString())}else if(e.severity===Y.Warning){t=g(3339,"Warning: {0}",e.message.linkedText.toString())}else{t=g(3340,"Info: {0}",e.message.linkedText.toString())}In(t)}}let Ti=class oc extends j{constructor(e,t,i){super();this.model=e;this.statusbarService=t;this.notificationService=i;this.newNotificationsCount=0;this.isNotificationsCenterVisible=false;this.isNotificationsToastsVisible=false;this.updateNotificationsCenterStatusItem();if(e.statusMessage){this.doSetStatusMessage(e.statusMessage)}this.registerListeners()}registerListeners(){this._register(this.model.onDidChangeNotification(e=>this.onDidChangeNotification(e)));this._register(this.model.onDidChangeStatusMessage(e=>this.onDidChangeStatusMessage(e)));this._register(this.notificationService.onDidChangeFilter(()=>this.updateNotificationsCenterStatusItem()))}onDidChangeNotification(e){if(!this.isNotificationsCenterVisible){if(e.kind===X.ADD){this.newNotificationsCount++}else if(e.kind===X.REMOVE&&this.newNotificationsCount>0){this.newNotificationsCount--}}this.updateNotificationsCenterStatusItem()}updateNotificationsCenterStatusItem(){let e=0;if(!this.isNotificationsCenterVisible&&!this.isNotificationsToastsVisible){for(const i of this.model.notifications){if(i.hasProgress){e++}}}let t={name:g(3364,"Notifications"),text:`${e>0||this.newNotificationsCount>0?"$(bell-dot)":"$(bell)"}`,ariaLabel:g(3364,"Notifications"),command:this.isNotificationsCenterVisible?mt:mi,tooltip:this.getTooltip(e),showBeak:this.isNotificationsCenterVisible};if(this.notificationService.getFilter()===v.ERROR){t={...t,text:`${e>0||this.newNotificationsCount>0?"$(bell-slash-dot)":"$(bell-slash)"}`,ariaLabel:g(3365,"Do Not Disturb"),tooltip:g(3366,"Do Not Disturb Mode is Enabled")}}if(!this.notificationsCenterStatusItem){this.notificationsCenterStatusItem=this.statusbarService.addEntry(t,"status.notifications",K.RIGHT,Number.NEGATIVE_INFINITY)}else{this.notificationsCenterStatusItem.update(t)}}getTooltip(e){if(this.isNotificationsCenterVisible){return g(3367,"Hide Notifications")}if(this.model.notifications.length===0){return g(3368,"No Notifications")}if(e===0){if(this.newNotificationsCount===0){return g(3369,"No New Notifications")}if(this.newNotificationsCount===1){return g(3370,"1 New Notification")}return g(3371,"{0} New Notifications",this.newNotificationsCount)}if(this.newNotificationsCount===0){return g(3372,"No New Notifications ({0} in progress)",e)}if(this.newNotificationsCount===1){return g(3373,"1 New Notification ({0} in progress)",e)}return g(3374,"{0} New Notifications ({1} in progress)",this.newNotificationsCount,e)}update(e,t){let i=false;if(this.isNotificationsCenterVisible!==e){this.isNotificationsCenterVisible=e;this.newNotificationsCount=0;i=true}if(this.isNotificationsToastsVisible!==t){this.isNotificationsToastsVisible=t;i=true}if(i){this.updateNotificationsCenterStatusItem()}}onDidChangeStatusMessage(e){const t=e.item;switch(e.kind){case $e.ADD:this.doSetStatusMessage(t);break;case $e.REMOVE:if(this.currentStatusMessage&&this.currentStatusMessage[0]===t){ft(this.currentStatusMessage[1]);this.currentStatusMessage=void 0}break}}doSetStatusMessage(e){const t=e.message;const i=e.options&&typeof e.options.showAfter==="number"?e.options.showAfter:0;const s=e.options&&typeof e.options.hideAfter==="number"?e.options.hideAfter:-1;if(this.currentStatusMessage){ft(this.currentStatusMessage[1])}let n;let r=setTimeout(()=>{n=this.statusbarService.addEntry({name:g(3375,"Status Message"),text:t,ariaLabel:t},"status.message",K.LEFT,Number.NEGATIVE_INFINITY);r=null},i);let o;const a={dispose:()=>{if(r){clearTimeout(r)}if(o){clearTimeout(o)}n?.dispose()}};if(s>0){o=setTimeout(()=>a.dispose(),s)}this.currentStatusMessage=[e,a]}};Ti=y([d(1,Ce),d(2,be)],Ti);const Ta=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));var De;ye(Ta);var he;(function(h){h[h["HIDDEN_OR_VISIBLE"]=0]="HIDDEN_OR_VISIBLE";h[h["HIDDEN"]=1]="HIDDEN";h[h["VISIBLE"]=2]="VISIBLE"})(he||(he={}));let yi=class ac extends xs{static{De=this}static{this.MAX_WIDTH=450}static{this.MAX_NOTIFICATIONS=3}static{this.PURGE_TIMEOUT={[Y.Info]:15e3,[Y.Warning]:18e3,[Y.Error]:2e4}}static{this.SPAM_PROTECTION={interval:800,limit:this.MAX_NOTIFICATIONS}}get isVisible(){return!!this._isVisible}constructor(e,t,i,s,n,r,o,a,c){super(n);this.container=e;this.model=t;this.instantiationService=i;this.layoutService=s;this.editorGroupService=r;this.lifecycleService=a;this.hostService=c;this._onDidChangeVisibility=this._register(new T);this.onDidChangeVisibility=this._onDidChangeVisibility.event;this._isVisible=false;this.mapNotificationToToast=new Map;this.mapNotificationToDisposable=new Map;this.addedToastsIntervalCounter=new Tn(De.SPAM_PROTECTION.interval);this.notificationsToastsVisibleContextKey=me.bindTo(o);this.registerListeners()}registerListeners(){this._register(this.layoutService.onDidLayoutMainContainer(e=>this.layout(Oe.lift(e))));this.lifecycleService.when(st.Restored).then(()=>{this.model.notifications.forEach(e=>this.addToast(e));this._register(this.model.onDidChangeNotification(e=>this.onDidChangeNotification(e)))});this._register(this.model.onDidChangeFilter(({global:e,sources:t})=>{if(e===v.ERROR){this.hide()}else if(t){for(const[i]of this.mapNotificationToToast){if(typeof i.sourceId==="string"&&t.get(i.sourceId)===v.ERROR&&i.severity!==Y.Error&&i.priority!==Pe.URGENT){this.removeToast(i)}}}}))}onDidChangeNotification(e){switch(e.kind){case X.ADD:return this.addToast(e.item);case X.REMOVE:return this.removeToast(e.item)}}addToast(e){if(this.isNotificationsCenterVisible){return}if(e.priority===Pe.SILENT){return}if(this.addedToastsIntervalCounter.increment()>De.SPAM_PROTECTION.limit){return}const t=new V;this.mapNotificationToDisposable.set(e,t);t.add(yn(U(this.container),()=>this.doAddToast(e,t)))}doAddToast(e,t){let i=this.notificationsToastsContainer;if(!i){i=this.notificationsToastsContainer=S(".notifications-toasts");this.container.appendChild(i)}i.classList.add("visible");const s=S(".notification-toast-container");const n=i.firstChild;if(n){i.insertBefore(s,n)}else{i.appendChild(s)}const r=S(".notification-toast");s.appendChild(r);const o=this.instantiationService.createInstance(Ut,r,{verticalScrollMode:_n.Hidden,widgetAriaLabel:(()=>{if(!e.source){return g(3376,"{0}, notification",e.message.raw)}return g(3377,"{0}, source: {1}, notification",e.message.raw,e.source)})()});t.add(o);const a={item:e,list:o,container:s,toast:r};this.mapNotificationToToast.set(e,a);t.add(ue(()=>this.updateToastVisibility(a,false)));o.show();const c=this.computeMaxDimensions();this.layoutLists(c.width);o.updateNotificationsList(0,0,[e]);this.layoutContainer(c.height);t.add(e.onDidChangeExpansion(()=>{o.updateNotificationsList(0,1,[e])}));t.add(e.onDidChangeContent(u=>{switch(u.kind){case ee.ACTIONS:o.updateNotificationsList(0,1,[e]);break;case ee.MESSAGE:if(e.expanded){o.updateNotificationHeight(e)}break}}));oe.once(e.onDidClose)(()=>{this.removeToast(e)});this.purgeNotification(e,s,o,t);this.updateStyles();this.notificationsToastsVisibleContextKey.set(true);r.classList.add("notification-fade-in");t.add(H(r,"transitionend",()=>{r.classList.remove("notification-fade-in");r.classList.add("notification-fade-in-done")}));e.updateVisibility(true);if(!this._isVisible){this._isVisible=true;this._onDidChangeVisibility.fire()}}purgeNotification(e,t,i,s){let n=false;s.add(H(t,$.MOUSE_OVER,()=>n=true));s.add(H(t,$.MOUSE_OUT,()=>n=false));let r;let o;const a=()=>{r=setTimeout(()=>{if(!this.hostService.hasFocus){if(!o){o=this.hostService.onDidChangeFocus(c=>{if(c){a()}});s.add(o)}}else if(e.sticky||i.hasFocus()||n){a()}else{this.removeToast(e)}},De.PURGE_TIMEOUT[e.severity])};a();s.add(ue(()=>clearTimeout(r)))}removeToast(e){let t=false;const i=this.mapNotificationToToast.get(e);if(i){const n=Le(i.container);if(n){t=!(this.focusNext()||this.focusPrevious())}this.mapNotificationToToast.delete(e)}const s=this.mapNotificationToDisposable.get(e);if(s){ft(s);this.mapNotificationToDisposable.delete(e)}if(this.mapNotificationToToast.size>0){this.layout(this.workbenchDimensions)}else{this.doHide();if(t){this.editorGroupService.activeGroup.focus()}}}removeToasts(){this.mapNotificationToToast.clear();this.mapNotificationToDisposable.forEach(e=>ft(e));this.mapNotificationToDisposable.clear();this.doHide()}doHide(){this.notificationsToastsContainer?.classList.remove("visible");this.notificationsToastsVisibleContextKey.set(false);if(this._isVisible){this._isVisible=false;this._onDidChangeVisibility.fire()}}hide(){const e=this.notificationsToastsContainer?Le(this.notificationsToastsContainer):false;this.removeToasts();if(e){this.editorGroupService.activeGroup.focus()}}focus(){const e=this.getToasts(he.VISIBLE);if(e.length>0){e[0].list.focusFirst();return true}return false}focusNext(){const e=this.getToasts(he.VISIBLE);for(let t=0;t<e.length;t++){const i=e[t];if(i.list.hasFocus()){const s=e[t+1];if(s){s.list.focusFirst();return true}break}}return false}focusPrevious(){const e=this.getToasts(he.VISIBLE);for(let t=0;t<e.length;t++){const i=e[t];if(i.list.hasFocus()){const s=e[t-1];if(s){s.list.focusFirst();return true}break}}return false}focusFirst(){const e=this.getToasts(he.VISIBLE)[0];if(e){e.list.focusFirst();return true}return false}focusLast(){const e=this.getToasts(he.VISIBLE);if(e.length>0){e[e.length-1].list.focusFirst();return true}return false}update(e){if(this.isNotificationsCenterVisible!==e){this.isNotificationsCenterVisible=e;if(this.isNotificationsCenterVisible){this.removeToasts()}}}updateStyles(){this.mapNotificationToToast.forEach(({toast:e})=>{const t=this.getColor(Os);e.style.background=t?t:"";const i=this.getColor(ks);e.style.boxShadow=i?`0 0 8px 2px ${i}`:"";const s=this.getColor(vn);e.style.border=s?`1px solid ${s}`:""})}getToasts(e){const t=[];this.mapNotificationToToast.forEach(i=>{switch(e){case he.HIDDEN_OR_VISIBLE:t.push(i);break;case he.HIDDEN:if(!this.isToastInDOM(i)){t.push(i)}break;case he.VISIBLE:if(this.isToastInDOM(i)){t.push(i)}break}});return t.reverse()}layout(e){this.workbenchDimensions=e;const t=this.computeMaxDimensions();if(t.height){this.layoutContainer(t.height)}this.layoutLists(t.width)}computeMaxDimensions(){const e=De.MAX_WIDTH;let t=e;let i;if(this.workbenchDimensions){t=this.workbenchDimensions.width;t-=2*8;i=this.workbenchDimensions.height;if(this.layoutService.isVisible(l.STATUSBAR_PART,C)){i-=22}if(this.layoutService.isVisible(l.TITLEBAR_PART,C)){i-=22}i-=2*12}i=typeof i==="number"?Math.round(i*.618):0;return new Oe(Math.min(e,t),i)}layoutLists(e){this.mapNotificationToToast.forEach(({list:t})=>t.layout(e))}layoutContainer(e){let t=0;for(const i of this.getToasts(he.HIDDEN_OR_VISIBLE)){i.container.style.opacity="0";this.updateToastVisibility(i,true);e-=i.container.offsetHeight;let s=false;if(t===De.MAX_NOTIFICATIONS){s=false}else if(e>=0){s=true}this.updateToastVisibility(i,s);i.container.style.opacity="";if(s){t++}}}updateToastVisibility(e,t){if(this.isToastInDOM(e)===t){return}const i=re(this.notificationsToastsContainer);if(t){i.appendChild(e.container)}else{e.container.remove()}e.item.updateVisibility(t)}isToastInDOM(e){return!!e.container.parentElement}};yi=De=y([d(2,B),d(3,te),d(4,ie),d(5,_e),d(6,Se),d(7,Lt),d(8,je)],yi);var D;(function(h){h["SIDEBAR_HIDDEN"]="nosidebar";h["MAIN_EDITOR_AREA_HIDDEN"]="nomaineditorarea";h["PANEL_HIDDEN"]="nopanel";h["AUXILIARYBAR_HIDDEN"]="noauxiliarybar";h["STATUSBAR_HIDDEN"]="nostatusbar";h["FULLSCREEN"]="fullscreen";h["MAXIMIZED"]="maximized";h["WINDOW_BORDER"]="border"})(D||(D={}));const ya=["chat.commandCenter.enabled","workbench.navigationControl.enabled","workbench.experimental.share.enabled"];const _a=[w.ACTIVITY_BAR_LOCATION,w.COMMAND_CENTER,...ya,w.EDITOR_ACTIONS_LOCATION,w.LAYOUT_ACTIONS,"window.menuBarVisibility",Mt.TITLE_BAR_STYLE,Mt.CUSTOM_TITLE_BAR_VISIBILITY];const _s=new Oe(ds.width,ds.height);class va extends j{get activeContainer(){return this.getContainerFromDocument(Hs())}get containers(){const e=[];for(const{window:t}of wn()){e.push(this.getContainerFromDocument(t.document))}return e}getContainerFromDocument(e){if(e===this.mainContainer.ownerDocument){return this.mainContainer}else{return e.body.getElementsByClassName("monaco-workbench")[0]}}whenContainerStylesLoaded(e){return this.containerStylesLoaded.get(e.vscodeWindowId)}get mainContainerDimension(){return this._mainContainerDimension}get activeContainerDimension(){return this.getContainerDimension(this.activeContainer)}getContainerDimension(e){if(e===this.mainContainer){return this.mainContainerDimension}else{return ti(e)}}get mainContainerOffset(){return this.computeContainerOffset(C)}get activeContainerOffset(){return this.computeContainerOffset(U(this.activeContainer))}computeContainerOffset(e){let t=0;let i=0;if(this.isVisible(l.BANNER_PART)){t=this.getPart(l.BANNER_PART).maximumHeight;i=t}const s=this.isVisible(l.TITLEBAR_PART,e);if(s){t+=this.getPart(l.TITLEBAR_PART).maximumHeight;i=t}const n=s&&this.configurationService.getValue(w.COMMAND_CENTER)!==false;if(n){i=6}return{top:t,quickPickTop:i}}constructor(e){super();this.parent=e;this._onDidChangeZenMode=this._register(new T);this.onDidChangeZenMode=this._onDidChangeZenMode.event;this._onDidChangeMainEditorCenteredLayout=this._register(new T);this.onDidChangeMainEditorCenteredLayout=this._onDidChangeMainEditorCenteredLayout.event;this._onDidChangePanelAlignment=this._register(new T);this.onDidChangePanelAlignment=this._onDidChangePanelAlignment.event;this._onDidChangeWindowMaximized=this._register(new T);this.onDidChangeWindowMaximized=this._onDidChangeWindowMaximized.event;this._onDidChangePanelPosition=this._register(new T);this.onDidChangePanelPosition=this._onDidChangePanelPosition.event;this._onDidChangePartVisibility=this._register(new T);this.onDidChangePartVisibility=this._onDidChangePartVisibility.event;this._onDidChangeNotificationsVisibility=this._register(new T);this.onDidChangeNotificationsVisibility=this._onDidChangeNotificationsVisibility.event;this._onDidLayoutMainContainer=this._register(new T);this.onDidLayoutMainContainer=this._onDidLayoutMainContainer.event;this._onDidLayoutActiveContainer=this._register(new T);this.onDidLayoutActiveContainer=this._onDidLayoutActiveContainer.event;this._onDidLayoutContainer=this._register(new T);this.onDidLayoutContainer=this._onDidLayoutContainer.event;this._onDidAddContainer=this._register(new T);this.onDidAddContainer=this._onDidAddContainer.event;this._onDidChangeActiveContainer=this._register(new T);this.onDidChangeActiveContainer=this._onDidChangeActiveContainer.event;this.mainContainer=document.createElement("div");this.containerStylesLoaded=new Map;this.parts=new Map;this.initialized=false;this.disposed=false;this._openedDefaultEditors=false;this.whenReadyPromise=new ns;this.whenReady=this.whenReadyPromise.p;this.whenRestoredPromise=new ns;this.whenRestored=this.whenRestoredPromise.p;this.restored=false;Dn(e)}initLayout(e){this.environmentService=e.get(Ct);this.configurationService=e.get(Me);this.hostService=e.get(je);this.contextService=e.get(jt);this.storageService=e.get(ae);this.workingCopyBackupService=e.get(Rn);this.themeService=e.get(ie);this.extensionService=e.get(Pn);this.logService=e.get(Fs);this.telemetryService=e.get(Yi);this.auxiliaryWindowService=e.get(Nn);this.editorService=e.get(qe);this.mainPartEditorService=this.editorService.createScoped("main",this._store);this.editorGroupService=e.get(_e);this.paneCompositeService=e.get(Vn);this.viewDescriptorService=e.get(Bn);this.titleService=e.get(qi);this.notificationService=e.get(be);this.statusBarService=e.get(Ce);e.get(He);this.registerLayoutListeners();this.initLayoutState(e.get(Lt),e.get(Ln))}registerLayoutListeners(){const e=()=>{if(!this.isVisible(l.EDITOR_PART,C)){this.toggleMaximizedPanel()}};this.editorGroupService.whenRestored.then(()=>{this._register(this.mainPartEditorService.onDidVisibleEditorsChange(e));this._register(this.editorGroupService.mainPart.onDidActivateGroup(e));this._register(this.mainPartEditorService.onDidActiveEditorChange(()=>this.centerMainEditorLayout(this.stateModel.getRuntimeValue(f.MAIN_EDITOR_CENTERED))))});this._register(this.configurationService.onDidChangeConfiguration(i=>{if([..._a,J.SIDEBAR_POSITION,J.STATUSBAR_VISIBLE].some(s=>i.affectsConfiguration(s))){const s=i.affectsConfiguration("workbench.experimental.share.enabled")&&this.configurationService.getValue("workbench.experimental.share.enabled");const n=i.affectsConfiguration("workbench.navigationControl.enabled")&&this.configurationService.getValue("workbench.navigationControl.enabled");if(s||n){if(this.configurationService.getValue(w.COMMAND_CENTER)===false){this.configurationService.updateValue(w.COMMAND_CENTER,true);return}}const r=i.affectsConfiguration(w.EDITOR_ACTIONS_LOCATION)&&this.configurationService.getValue(w.EDITOR_ACTIONS_LOCATION)===li.TITLEBAR;const o=i.affectsConfiguration(w.COMMAND_CENTER)&&this.configurationService.getValue(w.COMMAND_CENTER);const a=i.affectsConfiguration(w.LAYOUT_ACTIONS)&&this.configurationService.getValue(w.LAYOUT_ACTIONS);const c=i.affectsConfiguration(w.ACTIVITY_BAR_LOCATION)&&[Ze.TOP,Ze.BOTTOM].includes(this.configurationService.getValue(w.ACTIVITY_BAR_LOCATION));if(c||r||o||a){if(this.configurationService.getValue(Mt.CUSTOM_TITLE_BAR_VISIBILITY)===rs.NEVER){this.configurationService.updateValue(Mt.CUSTOM_TITLE_BAR_VISIBILITY,rs.AUTO);return}}this.doUpdateLayoutConfiguration()}}));this._register(Mn(i=>this.onFullscreenChanged(i)));this._register(this.editorGroupService.mainPart.onDidAddGroup(()=>this.centerMainEditorLayout(this.stateModel.getRuntimeValue(f.MAIN_EDITOR_CENTERED))));this._register(this.editorGroupService.mainPart.onDidRemoveGroup(()=>this.centerMainEditorLayout(this.stateModel.getRuntimeValue(f.MAIN_EDITOR_CENTERED))));this._register(this.editorGroupService.mainPart.onDidChangeGroupMaximized(()=>this.centerMainEditorLayout(this.stateModel.getRuntimeValue(f.MAIN_EDITOR_CENTERED))));this._register(H(this.mainContainer,$.SCROLL,()=>this.mainContainer.scrollTop=0));const t=(Xe||gt||ne)&&!Ne(this.configurationService);if(t){this._register(this.titleService.onMenubarVisibilityChange(i=>this.onMenubarToggled(i)))}this._register(this.themeService.onDidColorThemeChange(()=>this.updateWindowsBorder()));this._register(this.hostService.onDidChangeFocus(i=>this.onWindowFocusChanged(i)));this._register(this.hostService.onDidChangeActiveWindow(()=>this.onActiveWindowChanged()));if(ne&&typeof navigator.windowControlsOverlay==="object"){this._register(H(navigator.windowControlsOverlay,"geometrychange",()=>this.onDidChangeWCO()))}this._register(this.auxiliaryWindowService.onDidOpenAuxiliaryWindow(({window:i,disposables:s})=>{const n=i.window.vscodeWindowId;this.containerStylesLoaded.set(n,i.whenStylesHaveLoaded);i.whenStylesHaveLoaded.then(()=>this.containerStylesLoaded.delete(n));s.add(ue(()=>this.containerStylesLoaded.delete(n)));const r=s.add(new V);this._onDidAddContainer.fire({container:i.container,disposables:r});s.add(i.onDidLayout(o=>this.handleContainerDidLayout(i.container,o)))}))}onMenubarToggled(e){if(e!==this.state.runtime.menuBar.toggled){this.state.runtime.menuBar.toggled=e;const t=di(this.configurationService);if(ne&&t==="toggle"){this.workbenchGrid.setViewVisible(this.titleBarPartView,ve(this.configurationService,C,this.state.runtime.menuBar.toggled))}else if(this.state.runtime.mainWindowFullscreen&&(t==="toggle"||t==="classic")){this.workbenchGrid.setViewVisible(this.titleBarPartView,ve(this.configurationService,C,this.state.runtime.menuBar.toggled))}this.handleContainerDidLayout(this.mainContainer,this._mainContainerDimension)}}handleContainerDidLayout(e,t){if(e===this.mainContainer){this._onDidLayoutMainContainer.fire(t)}if(Ws(e)){this._onDidLayoutActiveContainer.fire(t)}this._onDidLayoutContainer.fire({container:e,dimension:t})}onFullscreenChanged(e){if(e!==C.vscodeWindowId){return}this.state.runtime.mainWindowFullscreen=os(C);if(this.state.runtime.mainWindowFullscreen){this.mainContainer.classList.add(D.FULLSCREEN)}else{this.mainContainer.classList.remove(D.FULLSCREEN);const t=this.stateModel.getRuntimeValue(f.ZEN_MODE_EXIT_INFO);if(t.transitionedToFullScreen&&this.isZenModeActive()){this.toggleZenMode()}}this.workbenchGrid.edgeSnapping=this.state.runtime.mainWindowFullscreen;{this.workbenchGrid.setViewVisible(this.titleBarPartView,ve(this.configurationService,C,this.state.runtime.menuBar.toggled));this.updateWindowsBorder(true)}}onActiveWindowChanged(){const e=this.getActiveContainerId();if(this.state.runtime.activeContainerId!==e){this.state.runtime.activeContainerId=e;this.updateWindowsBorder();this._onDidChangeActiveContainer.fire()}}onWindowFocusChanged(e){if(this.state.runtime.hasFocus!==e){this.state.runtime.hasFocus=e;this.updateWindowsBorder()}}getActiveContainerId(){const e=this.activeContainer;return U(e).vscodeWindowId}doUpdateLayoutConfiguration(e){this.updateCustomTitleBarVisibility();this.updateMenubarVisibility(!!e);this.editorGroupService.whenRestored.then(()=>this.centerMainEditorLayout(this.stateModel.getRuntimeValue(f.MAIN_EDITOR_CENTERED),e))}setSideBarPosition(e){const t=this.getPart(l.ACTIVITYBAR_PART);const i=this.getPart(l.SIDEBAR_PART);const s=this.getPart(l.AUXILIARYBAR_PART);const n=e===_.LEFT?"left":"right";const r=e===_.RIGHT?"left":"right";const o=this.getPanelAlignment();const a=this.getPanelPosition();this.stateModel.setRuntimeValue(f.SIDEBAR_POSITON,e);const c=re(t.getContainer());const u=re(i.getContainer());const m=re(s.getContainer());c.classList.remove(r);u.classList.remove(r);c.classList.add(n);u.classList.add(n);m.classList.remove(n);m.classList.add(r);t.updateStyles();i.updateStyles();s.updateStyles();this.adjustPartPositions(e,o,a)}updateWindowsBorder(e=false){if(ne||Xe||(Xe||gt)&&On(this.configurationService)||Ne(this.configurationService)){return}const t=this.themeService.getColorTheme();const i=t.getColor(xn);const s=t.getColor(kn);const n=this.hasMainWindowBorder();for(const r of this.containers){const o=r===this.mainContainer;const a=this.activeContainer===r;let c=false;if(!this.state.runtime.mainWindowFullscreen&&(i||s)){c=true;const u=a&&this.state.runtime.hasFocus?i:s??i;r.style.setProperty("--window-border-color",u?.toString()??"transparent")}if(o){this.state.runtime.mainWindowBorder=c}r.classList.toggle(D.WINDOW_BORDER,c)}if(!e&&n!==this.hasMainWindowBorder()){this.layout()}}initLayoutState(e,t){this._mainContainerDimension=ti(this.parent,_s);this.stateModel=new dt(this.storageService,this.configurationService,this.contextService);this.stateModel.load(this._mainContainerDimension);if(this.stateModel.getRuntimeValue(f.PANEL_HIDDEN)&&this.stateModel.getRuntimeValue(f.EDITOR_HIDDEN)){this.stateModel.setRuntimeValue(f.EDITOR_HIDDEN,false)}this._register(this.stateModel.onDidChangeState(r=>{if(r.key===f.ACTIVITYBAR_HIDDEN){this.setActivityBarHidden(r.value)}if(r.key===f.STATUSBAR_HIDDEN){this.setStatusBarHidden(r.value)}if(r.key===f.SIDEBAR_POSITON){this.setSideBarPosition(r.value)}if(r.key===f.PANEL_POSITION){this.setPanelPosition(r.value)}if(r.key===f.PANEL_ALIGNMENT){this.setPanelAlignment(r.value)}this.doUpdateLayoutConfiguration()}));const i=this.getInitialEditorsState();if(i){this.logService.trace("Initial editor state",i)}const s={layout:{editors:i?.layout},editor:{restoreEditors:this.shouldRestoreEditors(this.contextService,i),editorsToOpen:this.resolveEditorsToOpen(t,i)},views:{defaults:this.getDefaultLayoutViews(this.environmentService,this.storageService),containerToRestore:{}}};const n={activeContainerId:this.getActiveContainerId(),mainWindowFullscreen:os(C),hasFocus:this.hostService.hasFocus,maximized:new Set,mainWindowBorder:false,menuBar:{toggled:false},zenMode:{transitionDisposables:new Hn}};this.state={initialization:s,runtime:n};if(this.isVisible(l.SIDEBAR_PART)){let r;if(!this.environmentService.isBuilt||e.startupKind===Fn.ReloadedWindow||this.environmentService.isExtensionDevelopment&&!this.environmentService.extensionTestsLocationURI){r=this.storageService.get(jo.activeViewletSettingsKey,I.WORKSPACE,this.viewDescriptorService.getDefaultViewContainer(A.Sidebar)?.id)}else{r=this.viewDescriptorService.getDefaultViewContainer(A.Sidebar)?.id}if(r){this.state.initialization.views.containerToRestore.sideBar=r}else{this.stateModel.setRuntimeValue(f.SIDEBAR_HIDDEN,true)}}if(this.isVisible(l.PANEL_PART)){const r=this.storageService.get(qo.activePanelSettingsKey,I.WORKSPACE,this.viewDescriptorService.getDefaultViewContainer(A.Panel)?.id);if(r){this.state.initialization.views.containerToRestore.panel=r}else{this.stateModel.setRuntimeValue(f.PANEL_HIDDEN,true)}}if(this.isVisible(l.AUXILIARYBAR_PART)){const r=this.storageService.get(Jo.activeViewSettingsKey,I.WORKSPACE,this.viewDescriptorService.getDefaultViewContainer(A.AuxiliaryBar)?.id);if(r){this.state.initialization.views.containerToRestore.auxiliaryBar=r}else{this.stateModel.setRuntimeValue(f.AUXILIARYBAR_HIDDEN,true)}}this.updateWindowsBorder(true)}getDefaultLayoutViews(e,t){const i=e.options?.defaultLayout;if(!i){return void 0}if(!i.force&&!t.isNew(I.WORKSPACE)){return void 0}const{views:s}=i;if(s?.length){return s.map(n=>n.id)}return void 0}shouldRestoreEditors(e,t){if(Wn(e.getWorkspace())){return false}const i=this.configurationService.getValue("window.restoreWindows")==="preserve";return!!i||t===void 0}willRestoreEditors(){return this.state.initialization.editor.restoreEditors}async resolveEditorsToOpen(e,t){if(t){const i=tt(await ii(t.filesToMerge,e,this.logService));if(i.length===4&&Et(i[0])&&Et(i[1])&&Et(i[2])&&Et(i[3])){return[{editor:{input1:{resource:i[0].resource},input2:{resource:i[1].resource},base:{resource:i[2].resource},result:{resource:i[3].resource},options:{pinned:true}}}]}const s=tt(await ii(t.filesToDiff,e,this.logService));if(s.length===2){return[{editor:{original:{resource:s[0].resource},modified:{resource:s[1].resource},options:{pinned:true}}}]}const n=[];const r=await ii(t.filesToOpenOrCreate,e,this.logService);for(let o=0;o<r.length;o++){const a=r[o];if(a){n.push({editor:a,viewColumn:t.filesToOpenOrCreate?.[o].viewColumn})}}return n}else if(this.contextService.getWorkbenchState()===nt.EMPTY&&this.configurationService.getValue("workbench.startupEditor")==="newUntitledFile"){if(this.editorGroupService.hasRestorableState){return[]}const i=await this.workingCopyBackupService.hasBackups();if(i){return[]}return[{editor:{resource:void 0}}]}return[]}get openedDefaultEditors(){return this._openedDefaultEditors}getInitialEditorsState(){const e=this.environmentService.options?.defaultLayout;if((e?.editors?.length||e?.layout?.editors)&&(e.force||this.storageService.isNew(I.WORKSPACE))){this._openedDefaultEditors=true;return{layout:e.layout?.editors,filesToOpenOrCreate:e?.editors?.map(n=>{return{viewColumn:n.viewColumn,fileUri:$t.revive(n.uri),openOnlyIfExists:n.openOnlyIfExists,options:n.options}})}}const{filesToOpenOrCreate:t,filesToDiff:i,filesToMerge:s}=this.environmentService;if(t||i||s){return{filesToOpenOrCreate:t,filesToDiff:i,filesToMerge:s}}return void 0}isRestored(){return this.restored}restoreParts(){const e=[];const t=[];e.push((async()=>{M("code/willRestoreEditors");await this.editorGroupService.whenReady;M("code/restoreEditors/editorGroupsReady");if(this.state.initialization.layout?.editors){this.editorGroupService.mainPart.applyLayout(this.state.initialization.layout.editors)}const r=await this.state.initialization.editor.editorsToOpen;M("code/restoreEditors/editorsToOpenResolved");let o=void 0;if(r.length){const a=this.editorGroupService.mainPart.getGroups(Gn.GRID_APPEARANCE);const c=new Map;for(const u of r){const m=a[(u.viewColumn??1)-1];let p=c.get(m.id);if(!p){p=new Set;c.set(m.id,p)}p.add(u.editor)}o=Promise.all(Array.from(c).map(async([u,m])=>{try{await this.editorService.openEditors(Array.from(m),u,{validateTrust:true})}catch(p){this.logService.error(p)}}))}t.push(Promise.all([o?.finally(()=>M("code/restoreEditors/editorsOpened")),this.editorGroupService.whenRestored.finally(()=>M("code/restoreEditors/editorGroupsRestored"))]).finally(()=>{M("code/didRestoreEditors")}))})());const i=(async()=>{if(this.state.initialization.views.defaults?.length){M("code/willOpenDefaultViews");const r=[];const o=u=>{const m=this.viewDescriptorService.getViewLocationById(u.id);if(m!==null){const p=this.viewDescriptorService.getViewContainerByViewId(u.id);if(p){if(u.order>=(r?.[m]?.order??0)){r[m]={id:p.id,order:u.order}}const b=this.viewDescriptorService.getViewContainerModel(p);b.setCollapsed(u.id,false);b.setVisible(u.id,true);return true}}return false};const a=[...this.state.initialization.views.defaults].reverse().map((u,m)=>({id:u,order:m}));let c=a.length;while(c){c--;if(o(a[c])){a.splice(c,1)}}if(a.length){await this.extensionService.whenInstalledExtensionsRegistered();let u=a.length;while(u){u--;if(o(a[u])){a.splice(u,1)}}}if(r[A.Sidebar]){this.state.initialization.views.containerToRestore.sideBar=r[A.Sidebar].id}if(r[A.Panel]){this.state.initialization.views.containerToRestore.panel=r[A.Panel].id}if(r[A.AuxiliaryBar]){this.state.initialization.views.containerToRestore.auxiliaryBar=r[A.AuxiliaryBar].id}M("code/didOpenDefaultViews")}})();e.push(i);e.push((async()=>{await i;if(!this.state.initialization.views.containerToRestore.sideBar){return}M("code/willRestoreViewlet");const r=await this.paneCompositeService.openPaneComposite(this.state.initialization.views.containerToRestore.sideBar,A.Sidebar);if(!r){await this.paneCompositeService.openPaneComposite(this.viewDescriptorService.getDefaultViewContainer(A.Sidebar)?.id,A.Sidebar)}M("code/didRestoreViewlet")})());e.push((async()=>{await i;if(!this.state.initialization.views.containerToRestore.panel){return}M("code/willRestorePanel");const r=await this.paneCompositeService.openPaneComposite(this.state.initialization.views.containerToRestore.panel,A.Panel);if(!r){await this.paneCompositeService.openPaneComposite(this.viewDescriptorService.getDefaultViewContainer(A.Panel)?.id,A.Panel)}M("code/didRestorePanel")})());e.push((async()=>{await i;if(!this.state.initialization.views.containerToRestore.auxiliaryBar){return}M("code/willRestoreAuxiliaryBar");const r=await this.paneCompositeService.openPaneComposite(this.state.initialization.views.containerToRestore.auxiliaryBar,A.AuxiliaryBar);if(!r){await this.paneCompositeService.openPaneComposite(this.viewDescriptorService.getDefaultViewContainer(A.AuxiliaryBar)?.id,A.AuxiliaryBar)}M("code/didRestoreAuxiliaryBar")})());const s=this.isZenModeActive();const n=vs(this.configurationService).restore;if(s){this.setZenModeActive(!n);this.toggleZenMode(false,true)}if(this.stateModel.getRuntimeValue(f.MAIN_EDITOR_CENTERED)){this.centerMainEditorLayout(true,true)}as.settled(e).finally(()=>{this.whenReadyPromise.complete();as.settled(t).finally(()=>{this.restored=true;this.whenRestoredPromise.complete()})})}registerPart(e){const t=e.getId();this.parts.set(t,e);return ue(()=>this.parts.delete(t))}getPart(e){const t=this.parts.get(e);if(!t){throw new Error(`Unknown part ${e}`)}return t}registerNotifications(e){this._register(e.onDidChangeNotificationsVisibility(t=>this._onDidChangeNotificationsVisibility.fire(t)))}hasFocus(e){const t=this.getContainer(Tt(),e);if(!t){return false}const i=Un();if(!i){return false}return zn(i,t)}_getFocusedPart(){for(const e of this.parts.keys()){if(this.hasFocus(e)){return e}}return void 0}focusPart(e,t=C){const i=this.getContainer(t,e)??this.mainContainer;switch(e){case l.EDITOR_PART:this.editorGroupService.getPart(i).activeGroup.focus();break;case l.PANEL_PART:{this.paneCompositeService.getActivePaneComposite(A.Panel)?.focus();break}case l.SIDEBAR_PART:{this.paneCompositeService.getActivePaneComposite(A.Sidebar)?.focus();break}case l.AUXILIARYBAR_PART:{this.paneCompositeService.getActivePaneComposite(A.AuxiliaryBar)?.focus();break}case l.ACTIVITYBAR_PART:this.getPart(l.SIDEBAR_PART).focusActivityBar();break;case l.STATUSBAR_PART:this.statusBarService.getPart(i).focus();break;default:{i?.focus()}}}getContainer(e,t){if(typeof t==="undefined"){return this.getContainerFromDocument(e.document)}if(e===C){return this.getPart(t).getContainer()}let i;if(t===l.EDITOR_PART){i=this.editorGroupService.getPart(this.getContainerFromDocument(e.document))}else if(t===l.STATUSBAR_PART){i=this.statusBarService.getPart(this.getContainerFromDocument(e.document))}else if(t===l.TITLEBAR_PART){i=this.titleService.getPart(this.getContainerFromDocument(e.document))}if(i instanceof qt){return i.getContainer()}return void 0}isVisible(e,t=C){if(t!==C&&e===l.EDITOR_PART){return true}if(this.initialized){switch(e){case l.TITLEBAR_PART:return this.workbenchGrid.isViewVisible(this.titleBarPartView);case l.SIDEBAR_PART:return!this.stateModel.getRuntimeValue(f.SIDEBAR_HIDDEN);case l.PANEL_PART:return!this.stateModel.getRuntimeValue(f.PANEL_HIDDEN);case l.AUXILIARYBAR_PART:return!this.stateModel.getRuntimeValue(f.AUXILIARYBAR_HIDDEN);case l.STATUSBAR_PART:return!this.stateModel.getRuntimeValue(f.STATUSBAR_HIDDEN);case l.ACTIVITYBAR_PART:return!this.stateModel.getRuntimeValue(f.ACTIVITYBAR_HIDDEN);case l.EDITOR_PART:return!this.stateModel.getRuntimeValue(f.EDITOR_HIDDEN);case l.BANNER_PART:return this.workbenchGrid.isViewVisible(this.bannerPartView);default:return false}}switch(e){case l.TITLEBAR_PART:return ve(this.configurationService,C,this.state.runtime.menuBar.toggled);case l.SIDEBAR_PART:return!this.stateModel.getRuntimeValue(f.SIDEBAR_HIDDEN);case l.PANEL_PART:return!this.stateModel.getRuntimeValue(f.PANEL_HIDDEN);case l.AUXILIARYBAR_PART:return!this.stateModel.getRuntimeValue(f.AUXILIARYBAR_HIDDEN);case l.STATUSBAR_PART:return!this.stateModel.getRuntimeValue(f.STATUSBAR_HIDDEN);case l.ACTIVITYBAR_PART:return!this.stateModel.getRuntimeValue(f.ACTIVITYBAR_HIDDEN);case l.EDITOR_PART:return!this.stateModel.getRuntimeValue(f.EDITOR_HIDDEN);default:return false}}shouldShowBannerFirst(){return ne&&!ui()}focus(){if(this.isPanelMaximized()&&this.mainContainer===this.activeContainer){this.focusPart(l.PANEL_PART)}else{this.focusPart(l.EDITOR_PART,U(this.activeContainer))}}focusPanelOrEditor(){const e=this.paneCompositeService.getActivePaneComposite(A.Panel);if((this.hasFocus(l.PANEL_PART)||!this.isVisible(l.EDITOR_PART))&&e){e.focus()}else{this.focus()}}getMaximumEditorDimensions(e){const t=U(e);const i=this.getContainerDimension(e);if(e===this.mainContainer){const s=x(this.getPanelPosition());const n=(this.isVisible(l.ACTIVITYBAR_PART)?this.activityBarPartView.minimumWidth:0)+(this.isVisible(l.SIDEBAR_PART)?this.sideBarPartView.minimumWidth:0)+(this.isVisible(l.PANEL_PART)&&!s?this.panelPartView.minimumWidth:0)+(this.isVisible(l.AUXILIARYBAR_PART)?this.auxiliaryBarPartView.minimumWidth:0);const r=(this.isVisible(l.TITLEBAR_PART,t)?this.titleBarPartView.minimumHeight:0)+(this.isVisible(l.STATUSBAR_PART,t)?this.statusBarPartView.minimumHeight:0)+(this.isVisible(l.PANEL_PART)&&s?this.panelPartView.minimumHeight:0);const o=i.width-n;const a=i.height-r;return{width:o,height:a}}else{const s=(this.isVisible(l.TITLEBAR_PART,t)?this.titleBarPartView.minimumHeight:0)+(this.isVisible(l.STATUSBAR_PART,t)?this.statusBarPartView.minimumHeight:0);return{width:i.width,height:i.height-s}}}isZenModeActive(){return this.stateModel.getRuntimeValue(f.ZEN_MODE_ACTIVE)}setZenModeActive(e){this.stateModel.setRuntimeValue(f.ZEN_MODE_ACTIVE,e)}toggleZenMode(e,t=false){const i=this._getFocusedPart();this.setZenModeActive(!this.isZenModeActive());this.state.runtime.zenMode.transitionDisposables.clearAndDisposeAll();const s=a=>{for(const c of this.mainPartEditorService.visibleTextEditorControls){if(!a&&Qn(c)&&c.hasModel()){const u=c.getModel();a=this.configurationService.getValue("editor.lineNumbers",{resource:u.uri,overrideIdentifier:u.getLanguageId()})}if(!a){a=this.configurationService.getValue("editor.lineNumbers")}c.updateOptions({lineNumbers:a})}};let n=false;const r=vs(this.configurationService);const o=this.stateModel.getRuntimeValue(f.ZEN_MODE_EXIT_INFO);if(this.isZenModeActive()){n=!this.state.runtime.mainWindowFullscreen&&r.fullScreen&&!cs;if(!t){o.transitionedToFullScreen=n;o.transitionedToCenteredEditorLayout=!this.isMainEditorLayoutCentered()&&r.centerLayout;o.handleNotificationsDoNotDisturbMode=this.notificationService.getFilter()===v.OFF;o.wasVisible.sideBar=this.isVisible(l.SIDEBAR_PART);o.wasVisible.panel=this.isVisible(l.PANEL_PART);o.wasVisible.auxiliaryBar=this.isVisible(l.AUXILIARYBAR_PART);this.stateModel.setRuntimeValue(f.ZEN_MODE_EXIT_INFO,o)}this.setPanelHidden(true,true);this.setAuxiliaryBarHidden(true,true);this.setSideBarHidden(true,true);if(r.hideActivityBar){this.setActivityBarHidden(true,true)}if(r.hideStatusBar){this.setStatusBarHidden(true,true)}if(r.hideLineNumbers){s("off");this.state.runtime.zenMode.transitionDisposables.set(G.HIDE_LINENUMBERS,this.mainPartEditorService.onDidVisibleEditorsChange(()=>s("off")))}if(r.showTabs!==this.editorGroupService.partOptions.showTabs){this.state.runtime.zenMode.transitionDisposables.set(G.SHOW_TABS,this.editorGroupService.mainPart.enforcePartOptions({showTabs:r.showTabs}))}if(r.silentNotifications&&o.handleNotificationsDoNotDisturbMode){this.notificationService.setFilter(v.ERROR)}if(r.centerLayout){this.centerMainEditorLayout(true,true)}this.state.runtime.zenMode.transitionDisposables.set("configurationChange",this.configurationService.onDidChangeConfiguration(a=>{if(a.affectsConfiguration(G.HIDE_ACTIVITYBAR)){const c=this.configurationService.getValue(G.HIDE_ACTIVITYBAR);this.setActivityBarHidden(c,true)}if(a.affectsConfiguration(G.HIDE_STATUSBAR)){const c=this.configurationService.getValue(G.HIDE_STATUSBAR);this.setStatusBarHidden(c,true)}if(a.affectsConfiguration(G.CENTER_LAYOUT)){const c=this.configurationService.getValue(G.CENTER_LAYOUT);this.centerMainEditorLayout(c,true)}if(a.affectsConfiguration(G.SHOW_TABS)){const c=this.configurationService.getValue(G.SHOW_TABS)??"multiple";this.state.runtime.zenMode.transitionDisposables.set(G.SHOW_TABS,this.editorGroupService.mainPart.enforcePartOptions({showTabs:c}))}if(a.affectsConfiguration(G.SILENT_NOTIFICATIONS)){const c=!!this.configurationService.getValue(G.SILENT_NOTIFICATIONS);if(o.handleNotificationsDoNotDisturbMode){this.notificationService.setFilter(c?v.ERROR:v.OFF)}}if(a.affectsConfiguration(G.HIDE_LINENUMBERS)){const c=this.configurationService.getValue(G.HIDE_LINENUMBERS)?"off":void 0;s(c);this.state.runtime.zenMode.transitionDisposables.set(G.HIDE_LINENUMBERS,this.mainPartEditorService.onDidVisibleEditorsChange(()=>s(c)))}}))}else{if(o.wasVisible.panel){this.setPanelHidden(false,true)}if(o.wasVisible.auxiliaryBar){this.setAuxiliaryBarHidden(false,true)}if(o.wasVisible.sideBar){this.setSideBarHidden(false,true)}if(!this.stateModel.getRuntimeValue(f.ACTIVITYBAR_HIDDEN,true)){this.setActivityBarHidden(false,true)}if(!this.stateModel.getRuntimeValue(f.STATUSBAR_HIDDEN,true)){this.setStatusBarHidden(false,true)}if(o.transitionedToCenteredEditorLayout){this.centerMainEditorLayout(false,true)}if(o.handleNotificationsDoNotDisturbMode){this.notificationService.setFilter(v.OFF)}s();n=o.transitionedToFullScreen&&this.state.runtime.mainWindowFullscreen}if(!e){this.layout()}if(n){this.hostService.toggleFullScreen(C)}if(i&&this.isVisible(i,U(this.activeContainer))){if(Kn(i)){this.focusPart(i,U(this.activeContainer))}else{this.focusPart(i)}}else{this.focus()}this._onDidChangeZenMode.fire(this.isZenModeActive())}setStatusBarHidden(e,t){this.stateModel.setRuntimeValue(f.STATUSBAR_HIDDEN,e);if(e){this.mainContainer.classList.add(D.STATUSBAR_HIDDEN)}else{this.mainContainer.classList.remove(D.STATUSBAR_HIDDEN)}this.workbenchGrid.setViewVisible(this.statusBarPartView,!e)}createWorkbenchLayout(){const e=this.getPart(l.TITLEBAR_PART);const t=this.getPart(l.BANNER_PART);const i=this.getPart(l.EDITOR_PART);const s=this.getPart(l.ACTIVITYBAR_PART);const n=this.getPart(l.PANEL_PART);const r=this.getPart(l.AUXILIARYBAR_PART);const o=this.getPart(l.SIDEBAR_PART);const a=this.getPart(l.STATUSBAR_PART);this.titleBarPartView=e;this.bannerPartView=t;this.sideBarPartView=o;this.activityBarPartView=s;this.editorPartView=i;this.panelPartView=n;this.auxiliaryBarPartView=r;this.statusBarPartView=a;const c={[l.ACTIVITYBAR_PART]:this.activityBarPartView,[l.BANNER_PART]:this.bannerPartView,[l.TITLEBAR_PART]:this.titleBarPartView,[l.EDITOR_PART]:this.editorPartView,[l.PANEL_PART]:this.panelPartView,[l.SIDEBAR_PART]:this.sideBarPartView,[l.STATUSBAR_PART]:this.statusBarPartView,[l.AUXILIARYBAR_PART]:this.auxiliaryBarPartView};const u=({type:p})=>c[p];const m=Qo.deserialize(this.createGridDescriptor(),{fromJSON:u},{proportionalLayout:false});this.mainContainer.prepend(m.element);this.mainContainer.setAttribute("role","application");this.workbenchGrid=m;this.workbenchGrid.edgeSnapping=this.state.runtime.mainWindowFullscreen;for(const p of[e,i,s,n,o,a,r,t]){this._register(p.onDidVisibilityChange(b=>{if(p===o){this.setSideBarHidden(!b,true)}else if(p===n){this.setPanelHidden(!b,true)}else if(p===r){this.setAuxiliaryBarHidden(!b,true)}else if(p===i){this.setEditorHidden(!b,true)}this._onDidChangePartVisibility.fire();this.handleContainerDidLayout(this.mainContainer,this._mainContainerDimension)}))}this._register(this.storageService.onWillSaveState(p=>{const b=this.stateModel.getRuntimeValue(f.SIDEBAR_HIDDEN)?this.workbenchGrid.getViewCachedVisibleSize(this.sideBarPartView):this.workbenchGrid.getViewSize(this.sideBarPartView).width;this.stateModel.setInitializationValue(f.SIDEBAR_SIZE,b);const L=this.stateModel.getRuntimeValue(f.PANEL_HIDDEN)?this.workbenchGrid.getViewCachedVisibleSize(this.panelPartView):x(this.stateModel.getRuntimeValue(f.PANEL_POSITION))?this.workbenchGrid.getViewSize(this.panelPartView).height:this.workbenchGrid.getViewSize(this.panelPartView).width;this.stateModel.setInitializationValue(f.PANEL_SIZE,L);const W=this.stateModel.getRuntimeValue(f.AUXILIARYBAR_HIDDEN)?this.workbenchGrid.getViewCachedVisibleSize(this.auxiliaryBarPartView):this.workbenchGrid.getViewSize(this.auxiliaryBarPartView).width;this.stateModel.setInitializationValue(f.AUXILIARYBAR_SIZE,W);this.stateModel.save(true,true)}))}layout(){if(!this.disposed){this._mainContainerDimension=ti(this.state.runtime.mainWindowFullscreen?C.document.body:this.parent,_s);this.logService.trace(`Layout#layout, height: ${this._mainContainerDimension.height}, width: ${this._mainContainerDimension.width}`);Yn(this.mainContainer,0,0,0,0,"relative");Xn(this.mainContainer,this._mainContainerDimension.width,this._mainContainerDimension.height);this.workbenchGrid.layout(this._mainContainerDimension.width,this._mainContainerDimension.height);this.initialized=true;this.handleContainerDidLayout(this.mainContainer,this._mainContainerDimension)}}isMainEditorLayoutCentered(){return this.stateModel.getRuntimeValue(f.MAIN_EDITOR_CENTERED)}centerMainEditorLayout(e,t){this.stateModel.setRuntimeValue(f.MAIN_EDITOR_CENTERED,e);const i=tt(this.editorGroupService.mainPart.groups.map(a=>a.activeEditor));const s=i.some(a=>{if(a instanceof Zn){return this.configurationService.getValue("diffEditor.renderSideBySide")}if(a?.hasCapability($n.MultipleEditors)){return true}return false});const n=this.editorGroupService.getLayout();let r=false;if(n.orientation===jn.HORIZONTAL){r=n.groups.length>1}else{r=n.groups.some(a=>a.groups&&a.groups.length>1)}const o=this.configurationService.getValue("workbench.editor.centeredLayoutAutoResize");if(o&&(r&&!this.editorGroupService.mainPart.hasMaximizedGroup()||s)){e=false}if(this.editorGroupService.mainPart.isLayoutCentered()!==e){this.editorGroupService.mainPart.centerLayout(e);if(!t){this.layout()}}this._onDidChangeMainEditorCenteredLayout.fire(this.stateModel.getRuntimeValue(f.MAIN_EDITOR_CENTERED))}getSize(e){return this.workbenchGrid.getViewSize(this.getPart(e))}setSize(e,t){this.workbenchGrid.resizeView(this.getPart(e),t)}resizePart(e,t,i){const s=Math.sign(t)*hs(Tt(),Math.abs(t));const n=Math.sign(i)*hs(Tt(),Math.abs(i));let r;switch(e){case l.SIDEBAR_PART:r=this.workbenchGrid.getViewSize(this.sideBarPartView);this.workbenchGrid.resizeView(this.sideBarPartView,{width:r.width+s,height:r.height});break;case l.PANEL_PART:r=this.workbenchGrid.getViewSize(this.panelPartView);this.workbenchGrid.resizeView(this.panelPartView,{width:r.width+(x(this.getPanelPosition())?0:s),height:r.height+(x(this.getPanelPosition())?n:0)});break;case l.AUXILIARYBAR_PART:r=this.workbenchGrid.getViewSize(this.auxiliaryBarPartView);this.workbenchGrid.resizeView(this.auxiliaryBarPartView,{width:r.width+s,height:r.height});break;case l.EDITOR_PART:r=this.workbenchGrid.getViewSize(this.editorPartView);if(this.editorGroupService.mainPart.count===1){this.workbenchGrid.resizeView(this.editorPartView,{width:r.width+s,height:r.height+n})}else{const o=this.editorGroupService.mainPart.activeGroup;const{width:a,height:c}=this.editorGroupService.mainPart.getSize(o);this.editorGroupService.mainPart.setSize(o,{width:a+s,height:c+n});const{width:u,height:m}=this.editorGroupService.mainPart.getSize(o);if(n&&c===m||s&&a===u){this.workbenchGrid.resizeView(this.editorPartView,{width:r.width+(s&&a===u?s:0),height:r.height+(n&&c===m?n:0)})}}break;default:return}}setActivityBarHidden(e,t){this.stateModel.setRuntimeValue(f.ACTIVITYBAR_HIDDEN,e);this.workbenchGrid.setViewVisible(this.activityBarPartView,!e)}setBannerHidden(e){this.workbenchGrid.setViewVisible(this.bannerPartView,!e)}setEditorHidden(e,t){this.stateModel.setRuntimeValue(f.EDITOR_HIDDEN,e);if(e){this.mainContainer.classList.add(D.MAIN_EDITOR_AREA_HIDDEN)}else{this.mainContainer.classList.remove(D.MAIN_EDITOR_AREA_HIDDEN)}this.workbenchGrid.setViewVisible(this.editorPartView,!e);if(e&&!this.isVisible(l.PANEL_PART)){this.setPanelHidden(false,true)}}getLayoutClasses(){return tt([!this.isVisible(l.SIDEBAR_PART)?D.SIDEBAR_HIDDEN:void 0,!this.isVisible(l.EDITOR_PART,C)?D.MAIN_EDITOR_AREA_HIDDEN:void 0,!this.isVisible(l.PANEL_PART)?D.PANEL_HIDDEN:void 0,!this.isVisible(l.AUXILIARYBAR_PART)?D.AUXILIARYBAR_HIDDEN:void 0,!this.isVisible(l.STATUSBAR_PART)?D.STATUSBAR_HIDDEN:void 0,this.state.runtime.mainWindowFullscreen?D.FULLSCREEN:void 0])}setSideBarHidden(e,t){this.stateModel.setRuntimeValue(f.SIDEBAR_HIDDEN,e);if(e){this.mainContainer.classList.add(D.SIDEBAR_HIDDEN)}else{this.mainContainer.classList.remove(D.SIDEBAR_HIDDEN)}if(e&&this.paneCompositeService.getActivePaneComposite(A.Sidebar)){this.paneCompositeService.hideActivePaneComposite(A.Sidebar);this.focusPanelOrEditor()}else if(!e&&!this.paneCompositeService.getActivePaneComposite(A.Sidebar)){const i=this.paneCompositeService.getLastActivePaneCompositeId(A.Sidebar);if(i){const s=this.paneCompositeService.openPaneComposite(i,A.Sidebar,true);if(!s){this.paneCompositeService.openPaneComposite(this.viewDescriptorService.getDefaultViewContainer(A.Sidebar)?.id,A.Sidebar,true)}}}this.workbenchGrid.setViewVisible(this.sideBarPartView,!e)}hasViews(e){const t=this.viewDescriptorService.getViewContainerById(e);if(!t){return false}const i=this.viewDescriptorService.getViewContainerModel(t);if(!i){return false}return i.activeViewDescriptors.length>=1}adjustPartPositions(e,t,i){const s=!x(i);const n=s||!(t==="center"||e===_.LEFT&&t==="right"||e===_.RIGHT&&t==="left");const r=s||!(t==="center"||e===_.RIGHT&&t==="right"||e===_.LEFT&&t==="left");const o=!this.isVisible(l.PANEL_PART)?et.Invisible(this.workbenchGrid.getViewCachedVisibleSize(this.panelPartView)??this.panelPartView.minimumWidth):this.workbenchGrid.getViewSize(this.panelPartView).width;const a=!this.isVisible(l.PANEL_PART)?et.Invisible(this.workbenchGrid.getViewCachedVisibleSize(this.panelPartView)??this.panelPartView.minimumHeight):this.workbenchGrid.getViewSize(this.panelPartView).height;const c=!this.isVisible(l.SIDEBAR_PART)?et.Invisible(this.workbenchGrid.getViewCachedVisibleSize(this.sideBarPartView)??this.sideBarPartView.minimumWidth):this.workbenchGrid.getViewSize(this.sideBarPartView).width;const u=!this.isVisible(l.AUXILIARYBAR_PART)?et.Invisible(this.workbenchGrid.getViewCachedVisibleSize(this.auxiliaryBarPartView)??this.auxiliaryBarPartView.minimumWidth):this.workbenchGrid.getViewSize(this.auxiliaryBarPartView).width;const m=[l.PANEL_PART,l.SIDEBAR_PART,l.AUXILIARYBAR_PART].find(p=>this.hasFocus(p));if(e===_.LEFT){this.workbenchGrid.moveViewTo(this.activityBarPartView,[2,0]);this.workbenchGrid.moveView(this.sideBarPartView,c,n?this.editorPartView:this.activityBarPartView,n?z.Left:z.Right);if(r){this.workbenchGrid.moveView(this.auxiliaryBarPartView,u,this.editorPartView,z.Right)}else{this.workbenchGrid.moveViewTo(this.auxiliaryBarPartView,[2,-1])}}else{this.workbenchGrid.moveViewTo(this.activityBarPartView,[2,-1]);this.workbenchGrid.moveView(this.sideBarPartView,c,n?this.editorPartView:this.activityBarPartView,n?z.Right:z.Left);if(r){this.workbenchGrid.moveView(this.auxiliaryBarPartView,u,this.editorPartView,z.Left)}else{this.workbenchGrid.moveViewTo(this.auxiliaryBarPartView,[2,0])}}if(m){this.focusPart(m)}if(s){this.workbenchGrid.moveView(this.panelPartView,o,this.editorPartView,i===_.LEFT?z.Left:z.Right);this.workbenchGrid.resizeView(this.panelPartView,{height:a,width:o})}if(this.isVisible(l.SIDEBAR_PART)){this.workbenchGrid.resizeView(this.sideBarPartView,{height:this.workbenchGrid.getViewSize(this.sideBarPartView).height,width:c})}if(this.isVisible(l.AUXILIARYBAR_PART)){this.workbenchGrid.resizeView(this.auxiliaryBarPartView,{height:this.workbenchGrid.getViewSize(this.auxiliaryBarPartView).height,width:u})}}setPanelAlignment(e,t){if(!x(this.getPanelPosition())){this.setPanelPosition(_.BOTTOM)}if(e!=="center"&&this.isPanelMaximized()){this.toggleMaximizedPanel()}this.stateModel.setRuntimeValue(f.PANEL_ALIGNMENT,e);this.adjustPartPositions(this.getSideBarPosition(),e,this.getPanelPosition());this._onDidChangePanelAlignment.fire(e)}setPanelHidden(e,t){if(!this.workbenchGrid){return}const i=!this.isVisible(l.PANEL_PART);this.stateModel.setRuntimeValue(f.PANEL_HIDDEN,e);const s=this.isPanelMaximized();const n=this.panelOpensMaximized();if(e){this.mainContainer.classList.add(D.PANEL_HIDDEN)}else{this.mainContainer.classList.remove(D.PANEL_HIDDEN)}let r=false;if(e&&this.paneCompositeService.getActivePaneComposite(A.Panel)){this.paneCompositeService.hideActivePaneComposite(A.Panel);r=cs?false:true}else if(!e&&!this.paneCompositeService.getActivePaneComposite(A.Panel)){let o=this.paneCompositeService.getLastActivePaneCompositeId(A.Panel);if(!o||!this.hasViews(o)){o=this.viewDescriptorService.getViewContainersByLocation(A.Panel).find(a=>this.hasViews(a.id))?.id}if(o){const a=!t;const c=this.paneCompositeService.openPaneComposite(o,A.Panel,a);if(!c){this.paneCompositeService.openPaneComposite(this.viewDescriptorService.getDefaultViewContainer(A.Panel)?.id,A.Panel,a)}}}if(e&&s){this.toggleMaximizedPanel()}if(i===e){return}this.workbenchGrid.setViewVisible(this.panelPartView,!e);if(!e){if(!t&&s!==n){this.toggleMaximizedPanel()}}else{this.stateModel.setRuntimeValue(f.PANEL_WAS_LAST_MAXIMIZED,s)}if(r){this.editorGroupService.mainPart.activeGroup.focus()}}toggleMaximizedPanel(){const e=this.workbenchGrid.getViewSize(this.panelPartView);const t=this.getPanelPosition();const i=this.isPanelMaximized();if(!i){if(this.isVisible(l.PANEL_PART)){if(x(t)){this.stateModel.setRuntimeValue(f.PANEL_LAST_NON_MAXIMIZED_HEIGHT,e.height)}else{this.stateModel.setRuntimeValue(f.PANEL_LAST_NON_MAXIMIZED_WIDTH,e.width)}}this.setEditorHidden(true)}else{this.setEditorHidden(false);this.workbenchGrid.resizeView(this.panelPartView,{width:x(t)?e.width:this.stateModel.getRuntimeValue(f.PANEL_LAST_NON_MAXIMIZED_WIDTH),height:x(t)?this.stateModel.getRuntimeValue(f.PANEL_LAST_NON_MAXIMIZED_HEIGHT):e.height})}this.stateModel.setRuntimeValue(f.PANEL_WAS_LAST_MAXIMIZED,!i)}panelOpensMaximized(){if(this.getPanelAlignment()!=="center"&&x(this.getPanelPosition())){return false}const e=qn(this.configurationService.getValue(At.PANEL_OPENS_MAXIMIZED));const t=this.stateModel.getRuntimeValue(f.PANEL_WAS_LAST_MAXIMIZED);return e===ls.ALWAYS||e===ls.REMEMBER_LAST&&t}setAuxiliaryBarHidden(e,t){this.stateModel.setRuntimeValue(f.AUXILIARYBAR_HIDDEN,e);if(e){this.mainContainer.classList.add(D.AUXILIARYBAR_HIDDEN)}else{this.mainContainer.classList.remove(D.AUXILIARYBAR_HIDDEN)}if(e&&this.paneCompositeService.getActivePaneComposite(A.AuxiliaryBar)){this.paneCompositeService.hideActivePaneComposite(A.AuxiliaryBar);this.focusPanelOrEditor()}else if(!e&&!this.paneCompositeService.getActivePaneComposite(A.AuxiliaryBar)){let i=this.paneCompositeService.getLastActivePaneCompositeId(A.AuxiliaryBar);if(!i||!this.hasViews(i)){i=this.viewDescriptorService.getViewContainersByLocation(A.AuxiliaryBar).find(s=>this.hasViews(s.id))?.id}if(i){const s=!t;const n=this.paneCompositeService.openPaneComposite(i,A.AuxiliaryBar,s);if(!n){this.paneCompositeService.openPaneComposite(this.viewDescriptorService.getDefaultViewContainer(A.AuxiliaryBar)?.id,A.AuxiliaryBar,s)}}}this.workbenchGrid.setViewVisible(this.auxiliaryBarPartView,!e)}setPartHidden(e,t,i=C){switch(t){case l.ACTIVITYBAR_PART:return this.setActivityBarHidden(e);case l.SIDEBAR_PART:return this.setSideBarHidden(e);case l.EDITOR_PART:return this.setEditorHidden(e);case l.BANNER_PART:return this.setBannerHidden(e);case l.AUXILIARYBAR_PART:return this.setAuxiliaryBarHidden(e);case l.PANEL_PART:return this.setPanelHidden(e)}}hasMainWindowBorder(){return this.state.runtime.mainWindowBorder}getMainWindowBorderRadius(){return this.state.runtime.mainWindowBorder&&ce?"10px":void 0}isPanelMaximized(){return(this.getPanelAlignment()==="center"||!x(this.getPanelPosition()))&&!this.isVisible(l.EDITOR_PART,C)}getSideBarPosition(){return this.stateModel.getRuntimeValue(f.SIDEBAR_POSITON)}getPanelAlignment(){return this.stateModel.getRuntimeValue(f.PANEL_ALIGNMENT)}updateMenubarVisibility(e){const t=ve(this.configurationService,C,this.state.runtime.menuBar.toggled);if(!e&&this.workbenchGrid&&t!==this.isVisible(l.TITLEBAR_PART,C)){this.workbenchGrid.setViewVisible(this.titleBarPartView,t)}}updateCustomTitleBarVisibility(){const e=ve(this.configurationService,C,this.state.runtime.menuBar.toggled);const t=this.isVisible(l.TITLEBAR_PART);if(e!==t){this.workbenchGrid.setViewVisible(this.titleBarPartView,e)}}toggleMenuBar(){let e=di(this.configurationService);if(typeof e!=="string"){e="classic"}let t;if(e==="visible"||e==="classic"){t=Ne(this.configurationService)?"toggle":"compact"}else{t="classic"}this.configurationService.updateValue("window.menuBarVisibility",t)}getPanelPosition(){return this.stateModel.getRuntimeValue(f.PANEL_POSITION)}setPanelPosition(e){if(!this.isVisible(l.PANEL_PART)){this.setPanelHidden(false)}const t=this.getPart(l.PANEL_PART);const i=Ke(this.getPanelPosition());const s=Ke(e);const n=re(t.getContainer());n.classList.remove(i);n.classList.add(s);t.updateStyles();const r=this.workbenchGrid.getViewSize(this.panelPartView);const o=this.workbenchGrid.getViewSize(this.sideBarPartView);const a=this.workbenchGrid.getViewSize(this.auxiliaryBarPartView);let c=!this.isVisible(l.EDITOR_PART,C);if(s!==i&&!c){if(x(e)){this.stateModel.setRuntimeValue(f.PANEL_LAST_NON_MAXIMIZED_WIDTH,r.width)}else if(x(yt(i))){this.stateModel.setRuntimeValue(f.PANEL_LAST_NON_MAXIMIZED_HEIGHT,r.height)}}if(x(e)&&this.getPanelAlignment()!=="center"&&c){this.toggleMaximizedPanel();c=false}this.stateModel.setRuntimeValue(f.PANEL_POSITION,e);const u=this.isVisible(l.SIDEBAR_PART);const m=this.isVisible(l.AUXILIARYBAR_PART);const p=this.hasFocus(l.PANEL_PART);if(e===_.BOTTOM){this.workbenchGrid.moveView(this.panelPartView,c?r.height:this.stateModel.getRuntimeValue(f.PANEL_LAST_NON_MAXIMIZED_HEIGHT),this.editorPartView,z.Down)}else if(e===_.TOP){this.workbenchGrid.moveView(this.panelPartView,c?r.height:this.stateModel.getRuntimeValue(f.PANEL_LAST_NON_MAXIMIZED_HEIGHT),this.editorPartView,z.Up)}else if(e===_.RIGHT){this.workbenchGrid.moveView(this.panelPartView,c?r.width:this.stateModel.getRuntimeValue(f.PANEL_LAST_NON_MAXIMIZED_WIDTH),this.editorPartView,z.Right)}else{this.workbenchGrid.moveView(this.panelPartView,c?r.width:this.stateModel.getRuntimeValue(f.PANEL_LAST_NON_MAXIMIZED_WIDTH),this.editorPartView,z.Left)}if(p){this.focusPart(l.PANEL_PART)}this.workbenchGrid.resizeView(this.sideBarPartView,o);if(!u){this.setSideBarHidden(true)}this.workbenchGrid.resizeView(this.auxiliaryBarPartView,a);if(!m){this.setAuxiliaryBarHidden(true)}if(x(e)){this.adjustPartPositions(this.getSideBarPosition(),this.getPanelAlignment(),e)}this._onDidChangePanelPosition.fire(s)}isWindowMaximized(e){return this.state.runtime.maximized.has(fi(e))}updateWindowMaximizedState(e,t){this.mainContainer.classList.toggle(D.MAXIMIZED,t);const i=fi(e);if(t===this.state.runtime.maximized.has(i)){return}if(t){this.state.runtime.maximized.add(i)}else{this.state.runtime.maximized.delete(i)}this.updateWindowsBorder();this._onDidChangeWindowMaximized.fire({windowId:i,maximized:t})}getVisibleNeighborPart(e,t){if(!this.workbenchGrid){return void 0}if(!this.isVisible(e,C)){return void 0}const i=this.workbenchGrid.getNeighborViews(this.getPart(e),t,false);if(!i){return void 0}for(const s of i){const n=[l.ACTIVITYBAR_PART,l.EDITOR_PART,l.PANEL_PART,l.AUXILIARYBAR_PART,l.SIDEBAR_PART,l.STATUSBAR_PART,l.TITLEBAR_PART].find(r=>this.getPart(r)===s&&this.isVisible(r,C));if(n!==void 0){return n}}return void 0}onDidChangeWCO(){const e=this.workbenchGrid.getNeighborViews(this.titleBarPartView,z.Up,false).length>0;const t=this.shouldShowBannerFirst();if(e!==t){this.workbenchGrid.moveView(this.bannerPartView,et.Distribute,this.titleBarPartView,t?z.Up:z.Down)}this.workbenchGrid.setViewVisible(this.titleBarPartView,ve(this.configurationService,C,this.state.runtime.menuBar.toggled))}arrangeEditorNodes(e,t,i){if(!e.sideBar&&!e.auxiliaryBar){e.editor.size=t;return e.editor}const s=[e.editor];e.editor.size=i;if(e.sideBar){if(this.stateModel.getRuntimeValue(f.SIDEBAR_POSITON)===_.LEFT){s.splice(0,0,e.sideBar)}else{s.push(e.sideBar)}e.editor.size-=this.stateModel.getRuntimeValue(f.SIDEBAR_HIDDEN)?0:e.sideBar.size}if(e.auxiliaryBar){if(this.stateModel.getRuntimeValue(f.SIDEBAR_POSITON)===_.RIGHT){s.splice(0,0,e.auxiliaryBar)}else{s.push(e.auxiliaryBar)}e.editor.size-=this.stateModel.getRuntimeValue(f.AUXILIARYBAR_HIDDEN)?0:e.auxiliaryBar.size}return{type:"branch",data:s,size:t}}arrangeMiddleSectionNodes(e,t,i){const s=this.stateModel.getRuntimeValue(f.ACTIVITYBAR_HIDDEN)?0:e.activityBar.size;const n=this.stateModel.getRuntimeValue(f.SIDEBAR_HIDDEN)?0:e.sideBar.size;const r=this.stateModel.getRuntimeValue(f.AUXILIARYBAR_HIDDEN)?0:e.auxiliaryBar.size;const o=this.stateModel.getInitializationValue(f.PANEL_SIZE)?0:e.panel.size;const a=this.stateModel.getRuntimeValue(f.PANEL_POSITION);const c=this.stateModel.getRuntimeValue(f.SIDEBAR_POSITON);const u=[];if(!x(a)){u.push(e.editor);e.editor.size=t-s-n-o-r;if(a===_.RIGHT){u.push(e.panel)}else{u.splice(0,0,e.panel)}if(c===_.LEFT){u.push(e.auxiliaryBar);u.splice(0,0,e.sideBar);u.splice(0,0,e.activityBar)}else{u.splice(0,0,e.auxiliaryBar);u.push(e.sideBar);u.push(e.activityBar)}}else{const m=this.stateModel.getRuntimeValue(f.PANEL_ALIGNMENT);const p=!(m==="center"||c===_.LEFT&&m==="right"||c===_.RIGHT&&m==="left");const b=!(m==="center"||c===_.RIGHT&&m==="right"||c===_.LEFT&&m==="left");const L=t-s-(p?0:n)-(b?0:r);const W=this.arrangeEditorNodes({editor:e.editor,sideBar:p?e.sideBar:void 0,auxiliaryBar:b?e.auxiliaryBar:void 0},i-o,L);u.push({type:"branch",data:a===_.BOTTOM?[W,e.panel]:[e.panel,W],size:L});if(!p){if(c===_.LEFT){u.splice(0,0,e.sideBar)}else{u.push(e.sideBar)}}if(!b){if(c===_.RIGHT){u.splice(0,0,e.auxiliaryBar)}else{u.push(e.auxiliaryBar)}}if(c===_.LEFT){u.splice(0,0,e.activityBar)}else{u.push(e.activityBar)}}return u}createGridDescriptor(){const{width:e,height:t}=this._mainContainerDimension;const i=this.stateModel.getInitializationValue(f.SIDEBAR_SIZE);const s=this.stateModel.getInitializationValue(f.AUXILIARYBAR_SIZE);const n=this.stateModel.getInitializationValue(f.PANEL_SIZE);const r=this.titleBarPartView.minimumHeight;const o=this.bannerPartView.minimumHeight;const a=this.statusBarPartView.minimumHeight;const c=this.activityBarPartView.minimumWidth;const u=t-r-a;const m=[{type:"leaf",data:{type:l.TITLEBAR_PART},size:r,visible:this.isVisible(l.TITLEBAR_PART,C)},{type:"leaf",data:{type:l.BANNER_PART},size:o,visible:false}];const p={type:"leaf",data:{type:l.ACTIVITYBAR_PART},size:c,visible:!this.stateModel.getRuntimeValue(f.ACTIVITYBAR_HIDDEN)};const b={type:"leaf",data:{type:l.SIDEBAR_PART},size:i,visible:!this.stateModel.getRuntimeValue(f.SIDEBAR_HIDDEN)};const L={type:"leaf",data:{type:l.AUXILIARYBAR_PART},size:s,visible:this.isVisible(l.AUXILIARYBAR_PART)};const W={type:"leaf",data:{type:l.EDITOR_PART},size:0,visible:!this.stateModel.getRuntimeValue(f.EDITOR_HIDDEN)};const Ee={type:"leaf",data:{type:l.PANEL_PART},size:n,visible:!this.stateModel.getRuntimeValue(f.PANEL_HIDDEN)};const Qe=this.arrangeMiddleSectionNodes({activityBar:p,auxiliaryBar:L,editor:W,panel:Ee,sideBar:b},e,u);const Qt={root:{type:"branch",size:e,data:[...this.shouldShowBannerFirst()?m.reverse():m,{type:"branch",data:Qe,size:u},{type:"leaf",data:{type:l.STATUSBAR_PART},size:a,visible:!this.stateModel.getRuntimeValue(f.STATUSBAR_HIDDEN)}]},orientation:Jn.VERTICAL,width:e,height:t};const rn={activityBarVisible:!this.stateModel.getRuntimeValue(f.ACTIVITYBAR_HIDDEN),sideBarVisible:!this.stateModel.getRuntimeValue(f.SIDEBAR_HIDDEN),auxiliaryBarVisible:!this.stateModel.getRuntimeValue(f.AUXILIARYBAR_HIDDEN),panelVisible:!this.stateModel.getRuntimeValue(f.PANEL_HIDDEN),statusbarVisible:!this.stateModel.getRuntimeValue(f.STATUSBAR_HIDDEN),sideBarPosition:Ke(this.stateModel.getRuntimeValue(f.SIDEBAR_POSITON)),panelPosition:Ke(this.stateModel.getRuntimeValue(f.PANEL_POSITION))};this.telemetryService.publicLog2("startupLayout",rn);return Qt}dispose(){super.dispose();this.disposed=true}}function vs(h){return h.getValue(At.ZEN_MODE_CONFIG)}class nn{constructor(e,t,i,s){this.name=e;this.scope=t;this.target=i;this.defaultValue=s}}class k extends nn{constructor(e,t,i,s,n){super(e,t,i,s);this.zenModeIgnore=n;this.runtime=true}}class ai extends nn{constructor(){super(...arguments);this.runtime=false}}const f={MAIN_EDITOR_CENTERED:new k("editor.centered",I.WORKSPACE,R.MACHINE,false),ZEN_MODE_ACTIVE:new k("zenMode.active",I.WORKSPACE,R.MACHINE,false),ZEN_MODE_EXIT_INFO:new k("zenMode.exitInfo",I.WORKSPACE,R.MACHINE,{transitionedToCenteredEditorLayout:false,transitionedToFullScreen:false,handleNotificationsDoNotDisturbMode:false,wasVisible:{auxiliaryBar:false,panel:false,sideBar:false}}),SIDEBAR_SIZE:new ai("sideBar.size",I.PROFILE,R.MACHINE,200),AUXILIARYBAR_SIZE:new ai("auxiliaryBar.size",I.PROFILE,R.MACHINE,200),PANEL_SIZE:new ai("panel.size",I.PROFILE,R.MACHINE,300),PANEL_LAST_NON_MAXIMIZED_HEIGHT:new k("panel.lastNonMaximizedHeight",I.PROFILE,R.MACHINE,300),PANEL_LAST_NON_MAXIMIZED_WIDTH:new k("panel.lastNonMaximizedWidth",I.PROFILE,R.MACHINE,300),PANEL_WAS_LAST_MAXIMIZED:new k("panel.wasLastMaximized",I.WORKSPACE,R.MACHINE,false),SIDEBAR_POSITON:new k("sideBar.position",I.WORKSPACE,R.MACHINE,_.LEFT),PANEL_POSITION:new k("panel.position",I.WORKSPACE,R.MACHINE,_.BOTTOM),PANEL_ALIGNMENT:new k("panel.alignment",I.PROFILE,R.USER,"center"),ACTIVITYBAR_HIDDEN:new k("activityBar.hidden",I.WORKSPACE,R.MACHINE,false,true),SIDEBAR_HIDDEN:new k("sideBar.hidden",I.WORKSPACE,R.MACHINE,false),EDITOR_HIDDEN:new k("editor.hidden",I.WORKSPACE,R.MACHINE,false),PANEL_HIDDEN:new k("panel.hidden",I.WORKSPACE,R.MACHINE,true),AUXILIARYBAR_HIDDEN:new k("auxiliaryBar.hidden",I.WORKSPACE,R.MACHINE,true),STATUSBAR_HIDDEN:new k("statusBar.hidden",I.WORKSPACE,R.MACHINE,false,true)};var At;(function(h){h["PANEL_POSITION"]="workbench.panel.defaultLocation";h["PANEL_OPENS_MAXIMIZED"]="workbench.panel.opensMaximized";h["ZEN_MODE_CONFIG"]="zenMode";h["EDITOR_CENTERED_LAYOUT_AUTO_RESIZE"]="workbench.editor.centeredLayoutAutoResize"})(At||(At={}));var J;(function(h){h["STATUSBAR_VISIBLE"]="workbench.statusBar.visible";h["SIDEBAR_POSITION"]="workbench.sideBar.location"})(J||(J={}));class dt extends j{static{this.STORAGE_PREFIX="workbench."}constructor(e,t,i){super();this.storageService=e;this.configurationService=t;this.contextService=i;this._onDidChangeState=this._register(new T);this.onDidChangeState=this._onDidChangeState.event;this.stateCache=new Map;this._register(this.configurationService.onDidChangeConfiguration(s=>this.updateStateFromLegacySettings(s)))}updateStateFromLegacySettings(e){if(e.affectsConfiguration(w.ACTIVITY_BAR_LOCATION)){this.setRuntimeValueAndFire(f.ACTIVITYBAR_HIDDEN,this.isActivityBarHidden())}if(e.affectsConfiguration(J.STATUSBAR_VISIBLE)){this.setRuntimeValueAndFire(f.STATUSBAR_HIDDEN,!this.configurationService.getValue(J.STATUSBAR_VISIBLE))}if(e.affectsConfiguration(J.SIDEBAR_POSITION)){this.setRuntimeValueAndFire(f.SIDEBAR_POSITON,yt(this.configurationService.getValue(J.SIDEBAR_POSITION)??"left"))}}updateLegacySettingsFromState(e,t){const i=this.getRuntimeValue(f.ZEN_MODE_ACTIVE);if(e.zenModeIgnore&&i){return}if(e===f.ACTIVITYBAR_HIDDEN){this.configurationService.updateValue(w.ACTIVITY_BAR_LOCATION,t?Ze.HIDDEN:void 0)}else if(e===f.STATUSBAR_HIDDEN){this.configurationService.updateValue(J.STATUSBAR_VISIBLE,!t)}else if(e===f.SIDEBAR_POSITON){this.configurationService.updateValue(J.SIDEBAR_POSITION,Ke(t))}}load(e){let t;for(t in f){const i=f[t];const s=this.loadKeyFromStorage(i);if(s!==void 0){this.stateCache.set(i.name,s)}}this.stateCache.set(f.ACTIVITYBAR_HIDDEN.name,this.isActivityBarHidden());this.stateCache.set(f.STATUSBAR_HIDDEN.name,!this.configurationService.getValue(J.STATUSBAR_VISIBLE));this.stateCache.set(f.SIDEBAR_POSITON.name,yt(this.configurationService.getValue(J.SIDEBAR_POSITION)??"left"));f.PANEL_POSITION.defaultValue=yt(this.configurationService.getValue(At.PANEL_POSITION)??"bottom");f.SIDEBAR_SIZE.defaultValue=Math.min(300,e.width/4);f.AUXILIARYBAR_SIZE.defaultValue=Math.min(300,e.width/4);f.PANEL_SIZE.defaultValue=this.stateCache.get(f.PANEL_POSITION.name)??x(f.PANEL_POSITION.defaultValue)?e.height/3:e.width/4;f.SIDEBAR_HIDDEN.defaultValue=this.contextService.getWorkbenchState()===nt.EMPTY;for(t in f){const i=f[t];if(this.stateCache.get(i.name)===void 0){this.stateCache.set(i.name,i.defaultValue)}}this._register(this.storageService.onDidChangeValue(I.PROFILE,void 0,this._store)(i=>{let s;for(s in f){const n=f[s];if(n instanceof k&&n.scope===I.PROFILE&&n.target===R.USER){if(`${dt.STORAGE_PREFIX}${n.name}`===i.key){const r=this.loadKeyFromStorage(n)??n.defaultValue;if(this.stateCache.get(n.name)!==r){this.stateCache.set(n.name,r);this._onDidChangeState.fire({key:n,value:r})}}}}}))}save(e,t){let i;const s=this.getRuntimeValue(f.ZEN_MODE_ACTIVE);for(i in f){const n=f[i];if(e&&n.scope===I.WORKSPACE||t&&n.scope===I.PROFILE){if(s&&n instanceof k&&n.zenModeIgnore){continue}this.saveKeyToStorage(n)}}}getInitializationValue(e){return this.stateCache.get(e.name)}setInitializationValue(e,t){this.stateCache.set(e.name,t)}getRuntimeValue(e,t){if(t){switch(e){case f.ACTIVITYBAR_HIDDEN:this.stateCache.set(e.name,this.isActivityBarHidden());break;case f.STATUSBAR_HIDDEN:this.stateCache.set(e.name,!this.configurationService.getValue(J.STATUSBAR_VISIBLE));break;case f.SIDEBAR_POSITON:this.stateCache.set(e.name,this.configurationService.getValue(J.SIDEBAR_POSITION)??"left");break}}return this.stateCache.get(e.name)}setRuntimeValue(e,t){this.stateCache.set(e.name,t);const i=this.getRuntimeValue(f.ZEN_MODE_ACTIVE);if(e.scope===I.PROFILE){if(!i||!e.zenModeIgnore){this.saveKeyToStorage(e);this.updateLegacySettingsFromState(e,t)}}}isActivityBarHidden(){const e=this.configurationService.getValue("workbench.activityBar.visible");if(e!==void 0){return!e}return this.configurationService.getValue(w.ACTIVITY_BAR_LOCATION)!==Ze.DEFAULT}setRuntimeValueAndFire(e,t){const i=this.stateCache.get(e.name);if(i===t){return}this.setRuntimeValue(e,t);this._onDidChangeState.fire({key:e,value:t})}saveKeyToStorage(e){const t=this.stateCache.get(e.name);this.storageService.store(`${dt.STORAGE_PREFIX}${e.name}`,typeof t==="object"?JSON.stringify(t):t,e.scope,e.target)}loadKeyFromStorage(e){let t=this.storageService.get(`${dt.STORAGE_PREFIX}${e.name}`,e.scope);if(t!==void 0){switch(typeof e.defaultValue){case"boolean":t=t==="true";break;case"number":t=parseInt(t);break;case"object":t=JSON.parse(t);break}}return t}}const wa=5e3;let _i=class cc extends j{constructor(e,t,i){super();this._accessibilitySignalService=i;this._scheduler=new Gs(()=>{this._signalLoop=this._accessibilitySignalService.playSignalLoop(Zt.progress,t??wa)},e);this._scheduler.schedule()}dispose(){super.dispose();this._signalLoop?.dispose();this._scheduler.dispose()}};_i=y([d(2,Xt)],_i);class Da{constructor(){this.priority=90;this.name="notifications";this.when=se;this.type=us.View}getProvider(e){const t=e.get(er);const i=e.get(Ge);const s=e.get(fe);const n=e.get(Xt);function r(){const o=Re(i);if(!o){return}s.executeCommand("notifications.showList");let a;const c=i.lastFocusedList;if(c instanceof Ki){a=c.indexOf(o)}if(a===void 0){return}function u(){s.executeCommand("notifications.showList");if(c&&a!==void 0){c.domFocus();try{c.setFocus([a])}catch{}}}function m(){const b=Re(i);const L=b?.message.original.toString();if(!b){return}return b.source?g(3318,"{0} Source: {1}",L,b.source):g(3319,"{0}",L)}const p=m();if(!p){return}o.onDidClose(()=>t.next());return new tr(ir.Notification,{type:us.View},()=>p,()=>u(),"accessibility.verbosity.notification",void 0,Ra(o,n),()=>{if(!c){return}u();c.focusNext();return m()},()=>{if(!c){return}u();c.focusPrevious();return m()})}return r()}}function Ra(h,e){let t=void 0;if(h.actions){t=[];if(h.actions.primary){t.push(...h.actions.primary)}if(h.actions.secondary){t.push(...h.actions.secondary)}}if(t){for(const s of t){s.class=F.asClassName(Z.bell);const n=s.run;s.run=()=>{n();h.close()}}}const i=t?.find(s=>s.label.includes("Manage Extension"));if(i){i.class=F.asClassName(Z.gear)}if(t){t.push({id:"clearNotification",label:g(3320,"Clear Notification"),tooltip:g(3320,"Clear Notification"),run:()=>{h.close();e.playSignal(Zt.clear)},enabled:true,class:F.asClassName(Z.clearAll)})}return t}class Pa extends va{constructor(e,t,i,s){super(e);this.options=t;this.serviceCollection=i;this._onWillShutdown=this._register(new T);this.onWillShutdown=this._onWillShutdown.event;this._onDidShutdown=this._register(new T);this.onDidShutdown=this._onDidShutdown.event;this.previousUnexpectedError={message:void 0,time:0};M("code/willStartWorkbench");this.registerErrorHandler(s);this.parent.appendChild(this.mainContainer)}registerErrorHandler(e){C.addEventListener("unhandledrejection",t=>{_t(t.reason);t.preventDefault()});Us(t=>this.handleUnexpectedError(t,e))}handleUnexpectedError(e,t){const i=St(e,true);if(!i){return}const s=Date.now();if(i===this.previousUnexpectedError.message&&s-this.previousUnexpectedError.time<=1e3){return}this.previousUnexpectedError.time=s;this.previousUnexpectedError.message=i;t.error(i)}startup(){try{this._register(sr(175));const e=this.initServices(this.serviceCollection);e.invokeFunction(t=>{const i=t.get(Lt);const s=t.get(ae);const n=t.get(Me);const r=t.get(je);const o=t.get(nr);const a=t.get(be);this.initLayout(t);this.registerListeners(i,s,n,r,o);this.renderWorkbench(e,a,s,n);this.createWorkbenchLayout();this.layout();this.restore(i)});return e}catch(e){_t(e);throw e}}initServices(e){e.set(te,this);const t=rr();for(const[s,n]of t){e.set(s,n)}const i=new or(e,true);i.invokeFunction(s=>{const n=s.get(Lt);const r=s.get(Me);if(typeof r.acquireInstantiationService==="function"){r.acquireInstantiationService(i)}n.phase=st.Ready});return i}registerListeners(e,t,i,s,n){this._register(i.onDidChangeConfiguration(r=>this.updateFontAliasing(r,i)));if(vt){this._register(t.onWillSaveState(r=>{if(r.reason===ar.SHUTDOWN){this.storeFontInfo(t)}}))}else{this._register(e.onWillShutdown(()=>this.storeFontInfo(t)))}this._register(e.onWillShutdown(r=>this._onWillShutdown.fire(r)));this._register(e.onDidShutdown(()=>{this._onDidShutdown.fire();this.dispose()}));this._register(s.onDidChangeFocus(r=>{if(!r){t.flush()}}));this._register(n.onWillShowDialog(()=>this.mainContainer.classList.add("modal-dialog-visible")));this._register(n.onDidShowDialog(()=>this.mainContainer.classList.remove("modal-dialog-visible")))}updateFontAliasing(e,t){if(!ce){return}if(e&&!e.affectsConfiguration("workbench.fontAliasing")){return}const i=t.getValue("workbench.fontAliasing");if(this.fontAliasing===i){return}this.fontAliasing=i;const s=["antialiased","none","auto"];this.mainContainer.classList.remove(...s.map(n=>`monaco-font-aliasing-${n}`));if(s.some(n=>n===i)){this.mainContainer.classList.add(`monaco-font-aliasing-${i}`)}}restoreFontInfo(e,t){const i=e.get("editorFontInfo",I.APPLICATION);if(i){try{const s=JSON.parse(i);if(Array.isArray(s)){si.restoreFontInfo(C,s)}}catch(s){}}si.readFontInfo(C,cr.createFromRawSettings(t.getValue("editor"),hr.getInstance(C).value))}storeFontInfo(e){const t=si.serializeFontInfo(C);if(t){e.store("editorFontInfo",JSON.stringify(t),I.APPLICATION,R.MACHINE)}}renderWorkbench(e,t,i,s){lr(this.mainContainer);dr((o,a)=>e.createInstance(_i,o,a));const n=Xe?"windows":gt?"linux":"mac";const r=tt(["monaco-workbench",n,ne?"web":void 0,ur?"chromium":fr?"firefox":gr?"safari":void 0,...this.getLayoutClasses(),...this.options?.extraClasses?this.options.extraClasses:[]]);this.mainContainer.classList.add(...r);this.updateFontAliasing(void 0,s);this.restoreFontInfo(i,s);for(const{id:o,role:a,classes:c,options:u}of[{id:l.TITLEBAR_PART,role:"none",classes:["titlebar"]},{id:l.BANNER_PART,role:"banner",classes:["banner"]},{id:l.ACTIVITYBAR_PART,role:"none",classes:["activitybar",this.getSideBarPosition()===_.LEFT?"left":"right"]},{id:l.SIDEBAR_PART,role:"none",classes:["sidebar",this.getSideBarPosition()===_.LEFT?"left":"right"]},{id:l.EDITOR_PART,role:"main",classes:["editor"],options:{restorePreviousState:this.willRestoreEditors()}},{id:l.PANEL_PART,role:"none",classes:["panel","basepanel",Ke(this.getPanelPosition())]},{id:l.AUXILIARYBAR_PART,role:"none",classes:["auxiliarybar","basepanel",this.getSideBarPosition()===_.LEFT?"right":"left"]},{id:l.STATUSBAR_PART,role:"status",classes:["statusbar"]}]){const m=this.createPart(o,a,c);M(`code/willCreatePart/${o}`);this.getPart(o).create(m,u);M(`code/didCreatePart/${o}`)}this.createNotificationsHandlers(e,t)}createPart(e,t,i){const s=document.createElement(t==="status"?"footer":"div");s.classList.add("part",...i);s.id=e;s.setAttribute("role",t);if(t==="status"){s.setAttribute("aria-live","off")}return s}createNotificationsHandlers(e,t){const i=this._register(e.createInstance(Ii,this.mainContainer,t.model));const s=this._register(e.createInstance(yi,this.mainContainer,t.model));this._register(e.createInstance(Ia,t.model));const n=e.createInstance(Ti,t.model);this._register(i.onDidChangeVisibility(()=>{n.update(i.isVisible,s.isVisible);s.update(i.isVisible)}));this._register(s.onDidChangeVisibility(()=>{n.update(i.isVisible,s.isVisible)}));ga(i,s,t.model);mr.register(new Da);this.registerNotifications({onDidChangeNotificationsVisibility:oe.map(oe.any(s.onDidChangeVisibility,i.onDidChangeVisibility),()=>s.isVisible||i.isVisible)})}restore(e){try{this.restoreParts()}catch(t){_t(t)}this.whenReady.finally(()=>Promise.race([this.whenRestored,pr(2e3)]).finally(()=>{function t(){M("code/didStartWorkbench");performance.measure("perf: workbench create & restore","code/didLoadWorkbenchMain","code/didStartWorkbench")}if(this.isRestored()){t()}else{this.whenRestored.finally(()=>t())}e.phase=st.Restored;const i=this._register(new Gs(()=>{this._register(Ar(C,()=>e.phase=st.Eventually,2500))},2500));i.schedule()}))}}const Na=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));var vi;let wi=class hc{constructor(e,t,i,s){this._disposables=new V;this._onDidChangeVisibility=this._disposables.add(new T);this.onDidChangeVisibility=this._onDidChangeVisibility.event;this.element=document.createElement("div");this.element.classList.add("command-center");const n=i.createInstance(br,this.element,O.CommandCenter,{contextMenu:O.TitleBarContext,hiddenItemStrategy:zs.NoHide,toolbarOptions:{primaryGroup:()=>true},telemetrySource:"commandCenter",actionViewItemProvider:(r,o)=>{if(r instanceof Sr&&r.item.submenu===O.CommandCenterCenter){return i.createInstance(Di,r,e,{...o,hoverDelegate:t})}else{return Ji(i,r,{...o,hoverDelegate:t})}}});this._disposables.add(oe.filter(s.onShow,()=>Ws(this.element),this._disposables)(this._setVisibility.bind(this,false)));this._disposables.add(s.onHide(this._setVisibility.bind(this,true)));this._disposables.add(n)}_setVisibility(e){this.element.classList.toggle("hide",!e);this._onDidChangeVisibility.fire()}dispose(){this._disposables.dispose()}};wi=y([d(2,B),d(3,Bs)],wi);let Di=class lc extends fs{static{vi=this}static{this._quickOpenCommandId="workbench.action.quickOpenWithModes"}constructor(e,t,i,s,n,r,o){super(void 0,e.actions.find(a=>a.id==="workbench.action.quickOpenWithModes")??e.actions[0],i);this._submenu=e;this._windowTitle=t;this._hoverService=s;this._keybindingService=n;this._instaService=r;this._editorGroupService=o;this._hoverDelegate=i.hoverDelegate??hi("mouse")}render(e){super.render(e);e.classList.add("command-center-center");e.classList.toggle("multiple",this._submenu.actions.length>1);const t=this._store.add(this._hoverService.setupManagedHover(this._hoverDelegate,e,this.getTooltip()));this._store.add(this._windowTitle.onDidChange(()=>{t.update(this.getTooltip())}));const i=[];for(const s of this._submenu.actions){if(s instanceof Cr){i.push(s.actions)}else{i.push([s])}}for(let s=0;s<i.length;s++){const n=i[s];const r=this._instaService.createInstance(Ks,e,{hiddenItemStrategy:zs.NoHide,telemetrySource:"commandCenterCenter",actionViewItemProvider:(o,a)=>{a={...a,hoverDelegate:this._hoverDelegate};if(o.id!==vi._quickOpenCommandId){return Ji(this._instaService,o,a)}const c=this;return this._instaService.createInstance(class dc extends fs{constructor(){super(void 0,o,a)}render(m){super.render(m);m.classList.toggle("command-center-quick-pick");m.role="button";const p=this.action;const b=document.createElement("span");b.ariaHidden="true";b.className=p.class??"";b.classList.add("search-icon");const L=this._getLabel();const W=document.createElement("span");W.classList.add("search-label");W.innerText=L;Ys(m,b,W);const Ee=this._store.add(c._hoverService.setupManagedHover(c._hoverDelegate,m,this.getTooltip()));this._store.add(c._windowTitle.onDidChange(()=>{Ee.update(this.getTooltip());W.innerText=this._getLabel()}));this._store.add(c._editorGroupService.onDidChangeEditorPartOptions(({newPartOptions:Qe,oldPartOptions:Qt})=>{if(Qe.showTabs!==Qt.showTabs){Ee.update(this.getTooltip());W.innerText=this._getLabel()}}))}getTooltip(){return c.getTooltip()}_getLabel(){const{prefix:m,suffix:p}=c._windowTitle.getTitleDecorations();let b=c._windowTitle.workspaceName;if(c._windowTitle.isCustomTitleFormat()){b=c._windowTitle.getWindowTitle()}else if(c._editorGroupService.partOptions.showTabs==="none"){b=c._windowTitle.fileName??b}if(!b){b=g(3440,"Search")}if(m){b=g(3441,"{0} {1}",m,b)}if(p){b=g(3442,"{0} {1}",b,p)}return b.replaceAll(/\r\n|\r|\n/g,"⏎")}})}});r.setActions(n);this._store.add(r);if(s<i.length-1){const o=gi(Z.circleSmallFilled);o.style.padding="0 12px";o.style.height="100%";o.style.opacity="0.5";e.appendChild(o)}}}getTooltip(){const e=this._keybindingService.lookupKeybinding(this.action.id)?.getLabel();const t=e?g(3443,"Search {0} ({1}) — {2}",this._windowTitle.workspaceName,e,this._windowTitle.value):g(3444,"Search {0} — {1}",this._windowTitle.workspaceName,this._windowTitle.value);return t}};Di=vi=y([d(3,ji),d(4,ke),d(5,B),d(6,_e)],Di);Ie.appendMenuItem(O.CommandCenter,{submenu:O.CommandCenterCenter,title:g(3445,"Command Center"),icon:Z.shield,order:101});var Ri;ye(Na);let Pi=class uc extends Xs{constructor(e,t,i){super("workbench.titleService",i,t);this.instantiationService=e;this.properties=void 0;this.variables=new Map;this.mainPart=this._register(this.createMainTitlebarPart());this.onMenubarVisibilityChange=this.mainPart.onMenubarVisibilityChange;this._register(this.registerPart(this.mainPart));this.registerActions();this.registerAPICommands()}createMainTitlebarPart(){return this.instantiationService.createInstance(Ni)}registerActions(){const e=this;this._register(Qi(class fc extends es{constructor(){super({id:`workbench.action.focusTitleBar`,title:le(3480,"Focus Title Bar"),category:ts.View,f1:true,precondition:Er})}run(){e.getPartByDocument(Hs())?.focus()}}))}registerAPICommands(){this._register(we.registerCommand({id:"registerWindowTitleVariable",handler:(e,t,i)=>{this.registerVariables([{name:t,contextKey:i}])},metadata:{description:"Registers a new title variable",args:[{name:"name",schema:{type:"string"},description:"The name of the variable to register"},{name:"contextKey",schema:{type:"string"},description:"The context key to use for the value of the variable"}]}}))}createAuxiliaryTitlebarPart(e,t){const i=S(".part.titlebar",{role:"none"});i.style.position="relative";e.insertBefore(i,e.firstChild);const s=new V;const n=this.doCreateAuxiliaryTitlebarPart(i,t);s.add(this.registerPart(n));s.add(oe.runAndSubscribe(n.onDidChange,()=>i.style.height=`${n.height}px`));n.create(i);if(this.properties){n.updateProperties(this.properties)}if(this.variables.size){n.registerVariables(Array.from(this.variables.values()))}oe.once(n.onWillDispose)(()=>s.dispose());return n}doCreateAuxiliaryTitlebarPart(e,t){return this.instantiationService.createInstance(Vi,e,t,this.mainPart)}updateProperties(e){this.properties=e;for(const t of this.parts){t.updateProperties(e)}}registerVariables(e){const t=[];for(const i of e){if(!this.variables.has(i.name)){this.variables.set(i.name,i);t.push(i)}}for(const i of this.parts){i.registerVariables(t)}}};Pi=y([d(0,B),d(1,ae),d(2,ie)],Pi);let zt=class gc extends qt{get minimumHeight(){const e=ne&&ui();let t=this.isCommandCenterVisible||e?Ir:30;if(e){t=Math.max(t,Tr(U(this.element))?.height??0)}return t/(this.preventZoom?wt(U(this.element)):1)}get maximumHeight(){return this.minimumHeight}constructor(e,t,i,s,n,r,o,a,c,u,m,p,b,L,W,Ee){super(e,{hasTitle:false},a,c,u);this.contextMenuService=s;this.configurationService=n;this.environmentService=r;this.instantiationService=o;this.storageService=c;this.contextKeyService=m;this.hostService=p;this.editorGroupService=b;this.menuService=W;this.keybindingService=Ee;this.minimumWidth=0;this.maximumWidth=Number.POSITIVE_INFINITY;this._onMenubarVisibilityChange=this._register(new T);this.onMenubarVisibilityChange=this._onMenubarVisibilityChange.event;this._onWillDispose=this._register(new T);this.onWillDispose=this._onWillDispose.event;this.actionToolBarDisposable=this._register(new V);this.editorActionsChangeDisposable=this._register(new V);this.hasGlobalToolbarEntries=false;this.globalToolbarMenuDisposables=this._register(new V);this.editorToolbarMenuDisposables=this._register(new V);this.layoutToolbarMenuDisposables=this._register(new V);this.activityToolbarDisposables=this._register(new V);this.titleDisposables=this._register(new V);this.isInactive=false;this.titleBarStyle=yr(this.configurationService);this.globalToolbarMenu=this._register(this.menuService.createMenu(O.TitleBar,this.contextKeyService));this.isAuxiliary=i!=="main";this.editorService=L.createScoped(i,this._store);this.editorGroupsContainer=i==="main"?b.mainPart:i;this.windowTitle=this._register(o.createInstance(_r,t,i));this.hoverDelegate=this._register(vr());this.registerListeners(fi(t))}registerListeners(e){this._register(this.hostService.onDidChangeFocus(t=>t?this.onFocus():this.onBlur()));this._register(this.hostService.onDidChangeActiveWindow(t=>t===e?this.onFocus():this.onBlur()));this._register(this.configurationService.onDidChangeConfiguration(t=>this.onConfigurationChanged(t)));this._register(this.editorGroupService.onDidChangeEditorPartOptions(t=>this.onEditorPartConfigurationChange(t)))}onBlur(){this.isInactive=true;this.updateStyles()}onFocus(){this.isInactive=false;this.updateStyles()}onEditorPartConfigurationChange({oldPartOptions:e,newPartOptions:t}){if(e.editorActionsLocation!==t.editorActionsLocation||e.showTabs!==t.showTabs){if(this.actionToolBar){this.createActionToolBar();this.createActionToolBarMenus({editorActions:true});this._onDidChange.fire(void 0)}}}onConfigurationChanged(e){if(!this.isAuxiliary&&!Ne(this.configurationService,this.titleBarStyle)&&(!ce||ne)){if(e.affectsConfiguration("window.menuBarVisibility")){if(this.currentMenubarVisibility==="compact"){this.uninstallMenubar()}else{this.installMenubar()}}}if(this.actionToolBar){const t=e.affectsConfiguration(w.LAYOUT_ACTIONS);const i=e.affectsConfiguration(w.ACTIVITY_BAR_LOCATION);if(t||i){this.createActionToolBarMenus({layoutActions:t,activityActions:i});this._onDidChange.fire(void 0)}}if(e.affectsConfiguration(w.COMMAND_CENTER)){this.createTitle();this._onDidChange.fire(void 0)}}installMenubar(){if(this.menubar){return}this.customMenubar=this._register(this.instantiationService.createInstance(wr));this.menubar=Q(this.leftContent,S("div.menubar"));this.menubar.setAttribute("role","menubar");this._register(this.customMenubar.onVisibilityChange(e=>this.onMenubarVisibilityChanged(e)));this.customMenubar.create(this.menubar)}uninstallMenubar(){this.customMenubar?.dispose();this.customMenubar=void 0;this.menubar?.remove();this.menubar=void 0;this.onMenubarVisibilityChanged(false)}onMenubarVisibilityChanged(e){if(ne||Xe||gt){if(this.lastLayoutDimensions){this.layout(this.lastLayoutDimensions.width,this.lastLayoutDimensions.height)}this._onMenubarVisibilityChange.fire(e)}}updateProperties(e){this.windowTitle.updateProperties(e)}registerVariables(e){this.windowTitle.registerVariables(e)}createContentArea(e){this.element=e;this.rootContainer=Q(e,S(".titlebar-container"));this.leftContent=Q(this.rootContainer,S(".titlebar-left"));this.centerContent=Q(this.rootContainer,S(".titlebar-center"));this.rightContent=Q(this.rootContainer,S(".titlebar-right"));if((Xe||gt)&&!Ne(this.configurationService,this.titleBarStyle)){this.appIcon=gs(this.leftContent,S("a.window-appicon"))}this.dragRegion=gs(this.rootContainer,S("div.titlebar-drag-region"));if(!this.isAuxiliary&&!Ne(this.configurationService,this.titleBarStyle)&&(!ce||ne)&&this.currentMenubarVisibility!=="compact"){this.installMenubar()}this.title=Q(this.centerContent,S("div.window-title"));this.createTitle();{this.actionToolBarElement=Q(this.rightContent,S("div.action-toolbar-container"));this.createActionToolBar();this.createActionToolBarMenus()}if(!Ne(this.configurationService,this.titleBarStyle)){let t=ce?"left":"right";if(ce&&vt){const i=Dr.Locale(Rr);if(i?.textInfo?.direction==="rtl"){t="right"}}if(ce&&vt&&t==="left");else if(Pr(this.configurationService)===Nr.HIDDEN);else{this.windowControlsContainer=Q(t==="left"?this.leftContent:this.rightContent,S("div.window-controls-container"));if(ne){Q(t==="left"?this.rightContent:this.leftContent,S("div.window-controls-container"))}if(ui()){this.windowControlsContainer.classList.add("wco-enabled")}}}{this._register(H(this.rootContainer,$.CONTEXT_MENU,t=>{Ae.stop(t);let i;if(ce&&is(t.target)&&Vr(t.target,this.title)){i=O.TitleBarTitleContext}else{i=O.TitleBarContext}this.onContextMenu(t,i)}));if(ce){this._register(H(this.title,$.MOUSE_DOWN,t=>{if(t.metaKey){Ae.stop(t,true);this.onContextMenu(t,O.TitleBarTitleContext)}},true))}}this.updateStyles();return this.element}createTitle(){this.titleDisposables.clear();if(!this.isCommandCenterVisible){this.title.innerText=this.windowTitle.value;this.titleDisposables.add(this.windowTitle.onDidChange(()=>{this.title.innerText=this.windowTitle.value;if(this.lastLayoutDimensions){this.updateLayout(this.lastLayoutDimensions)}}))}else{const e=this.instantiationService.createInstance(wi,this.windowTitle,this.hoverDelegate);Ys(this.title,e.element);this.titleDisposables.add(e)}}actionViewItemProvider(e,t){if(!this.isAuxiliary){if(e.id===ms){return this.instantiationService.createInstance(Br,{position:()=>ps.BELOW},t)}if(e.id===As){return this.instantiationService.createInstance(Lr,{position:()=>ps.BELOW},t)}}const i=this.editorGroupsContainer.activeGroup?.activeEditorPane;if(i&&i instanceof Mr){const s=i.getActionViewItem(e,t);if(s){return s}}return Ji(this.instantiationService,e,{...t,menuAsChild:false})}getKeybinding(e){const t=this.editorGroupsContainer.activeGroup?.activeEditorPane?.scopedContextKeyService??this.contextKeyService;return this.keybindingService.lookupKeybinding(e.id,t)}createActionToolBar(){this.actionToolBarDisposable.clear();this.actionToolBar=this.actionToolBarDisposable.add(this.instantiationService.createInstance(Ks,this.actionToolBarElement,{contextMenu:O.TitleBarContext,orientation:kr.HORIZONTAL,ariaLabel:g(3481,"Title actions"),getKeyBinding:e=>this.getKeybinding(e),overflowBehavior:{maxItems:9,exempted:[As,ms,...xr]},anchorAlignmentProvider:()=>Or.RIGHT,telemetrySource:"titlePart",highlightToggledItems:this.editorActionsEnabled,actionViewItemProvider:(e,t)=>this.actionViewItemProvider(e,t),hoverDelegate:this.hoverDelegate}));if(this.editorActionsEnabled){this.actionToolBarDisposable.add(this.editorGroupsContainer.onDidChangeActiveGroup(()=>this.createActionToolBarMenus({editorActions:true})))}}createActionToolBarMenus(e=true){if(e===true){e={editorActions:true,layoutActions:true,activityActions:true}}const t=()=>{const i={primary:[],secondary:[]};if(this.editorActionsEnabled){this.editorActionsChangeDisposable.clear();const n=this.editorGroupsContainer.activeGroup;if(n){const r=n.createEditorActions(this.editorActionsChangeDisposable);i.primary.push(...r.actions.primary);i.secondary.push(...r.actions.secondary);this.editorActionsChangeDisposable.add(r.onDidChange(()=>t()))}}const s=this.globalToolbarMenu.getActions();this.hasGlobalToolbarEntries=s.length>0;bs(s,i);if(this.layoutToolbarMenu){bs(this.layoutToolbarMenu.getActions(),i,()=>!this.editorActionsEnabled)}if(this.activityActionsEnabled){if($r(this.storageService)){i.primary.push(jr)}i.primary.push(qr)}this.actionToolBar.setActions(Ss(i.primary),Ss(i.secondary))};if(e.editorActions){this.editorToolbarMenuDisposables.clear();if(this.editorActionsEnabled&&this.editorService.activeEditor!==void 0){const i={groupId:this.editorGroupsContainer.activeGroup.id};this.actionToolBar.actionRunner=this.editorToolbarMenuDisposables.add(new Hr(i));this.actionToolBar.context=i}else{this.actionToolBar.actionRunner=this.editorToolbarMenuDisposables.add(new zi);this.actionToolBar.context=void 0}}if(e.layoutActions){this.layoutToolbarMenuDisposables.clear();if(this.layoutControlEnabled){this.layoutToolbarMenu=this.menuService.createMenu(O.LayoutControlMenu,this.contextKeyService);this.layoutToolbarMenuDisposables.add(this.layoutToolbarMenu);this.layoutToolbarMenuDisposables.add(this.layoutToolbarMenu.onDidChange(()=>t()))}else{this.layoutToolbarMenu=void 0}}this.globalToolbarMenuDisposables.clear();this.globalToolbarMenuDisposables.add(this.globalToolbarMenu.onDidChange(()=>t()));if(e.activityActions){this.activityToolbarDisposables.clear();if(this.activityActionsEnabled){this.activityToolbarDisposables.add(this.storageService.onDidChangeValue(I.PROFILE,Fr.ACCOUNTS_VISIBILITY_PREFERENCE_KEY,this._store)(()=>t()))}}t()}updateStyles(){super.updateStyles();if(this.element){if(this.isInactive){this.element.classList.add("inactive")}else{this.element.classList.remove("inactive")}const e=this.getColor(this.isInactive?Wr:Gr,(s,n)=>{return s.isOpaque()?s:s.makeOpaque(Ur(n))})||"";this.element.style.backgroundColor=e;if(this.appIconBadge){this.appIconBadge.style.backgroundColor=e}if(e&&zr.fromHex(e).isLighter()){this.element.classList.add("light")}else{this.element.classList.remove("light")}const t=this.getColor(this.isInactive?Kr:Yr);this.element.style.color=t||"";const i=this.getColor(Xr);this.element.style.borderBottom=i?`1px solid ${i}`:""}}onContextMenu(e,t){const i=new Zs(U(this.element),e);this.contextMenuService.showContextMenu({getAnchor:()=>i,menuId:t,contextKeyService:this.contextKeyService,domForShadowRoot:ce&&vt?i.target:void 0})}get currentMenubarVisibility(){if(this.isAuxiliary){return"hidden"}return di(this.configurationService)}get layoutControlEnabled(){return!this.isAuxiliary&&this.configurationService.getValue(w.LAYOUT_ACTIONS)!==false}get isCommandCenterVisible(){return this.configurationService.getValue(w.COMMAND_CENTER)!==false}get editorActionsEnabled(){return this.editorGroupService.partOptions.editorActionsLocation===li.TITLEBAR||this.editorGroupService.partOptions.editorActionsLocation===li.DEFAULT&&this.editorGroupService.partOptions.showTabs===Zr.NONE}get activityActionsEnabled(){const e=this.configurationService.getValue(w.ACTIVITY_BAR_LOCATION);return!this.isAuxiliary&&(e===Ze.TOP||e===Ze.BOTTOM)}get hasZoomableElements(){const e=!(this.currentMenubarVisibility==="hidden"||this.currentMenubarVisibility==="compact"||!ne&&ce);const t=this.isCommandCenterVisible;const i=this.hasGlobalToolbarEntries||this.layoutControlEnabled||this.editorActionsEnabled||this.activityActionsEnabled;return e||t||i}get preventZoom(){return wt(U(this.element))<1||!this.hasZoomableElements}layout(e,t){this.updateLayout(new Oe(e,t));super.layoutContents(e,t)}updateLayout(e){this.lastLayoutDimensions=e;{const t=wt(U(this.element));this.element.style.setProperty("--zoom-factor",t.toString());this.rootContainer.classList.toggle("counter-zoom",this.preventZoom);if(this.customMenubar){const i=new Oe(0,e.height);this.customMenubar.layout(i)}}}focus(){if(this.customMenubar){this.customMenubar.toggleFocus()}else{this.element.querySelector('[tabindex]:not([tabindex="-1"])')?.focus()}}toJSON(){return{type:l.TITLEBAR_PART}}dispose(){this._onWillDispose.fire();super.dispose()}};zt=y([d(3,ge),d(4,Me),d(5,Ct),d(6,B),d(7,ie),d(8,ae),d(9,te),d(10,Se),d(11,je),d(12,_e),d(13,qe),d(14,ss),d(15,ke)],zt);let Ni=class mc extends zt{constructor(e,t,i,s,n,r,o,a,c,u,m,p,b){super(l.TITLEBAR_PART,C,"main",e,t,i,s,n,r,o,a,c,u,m,p,b)}};Ni=y([d(0,ge),d(1,Me),d(2,Ct),d(3,B),d(4,ie),d(5,ae),d(6,te),d(7,Se),d(8,je),d(9,_e),d(10,qe),d(11,ss),d(12,ke)],Ni);let Vi=class pc extends zt{static{Ri=this}static{this.COUNTER=1}get height(){return this.minimumHeight}constructor(e,t,i,s,n,r,o,a,c,u,m,p,b,L,W,Ee){const Qe=Ri.COUNTER++;super(`workbench.parts.auxiliaryTitle.${Qe}`,U(e),t,s,n,r,o,a,c,u,m,p,b,L,W,Ee);this.container=e;this.mainTitlebar=i}get preventZoom(){return wt(U(this.element))<1||!this.mainTitlebar.hasZoomableElements}};Vi=Ri=y([d(3,ge),d(4,Me),d(5,Ct),d(6,B),d(7,ie),d(8,ae),d(9,te),d(10,Se),d(11,je),d(12,_e),d(13,qe),d(14,ss),d(15,ke)],Vi);function Va(){return{[qi.toString()]:new Ve(Pi,[],false)}}$s(async h=>{h.get(qi)});const Ba=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));class La extends q{constructor(e,t,i){super(e,t,void 0,true);this.model=i;this.checked=!i.isHidden(e)}async run(){if(this.model.isHidden(this.id)){this.model.show(this.id)}else{this.model.hide(this.id)}}}class Ma extends q{constructor(e,t,i){super(e,g(3436,"Hide '{0}'",t),void 0,true);this.model=i}async run(){this.model.hide(this.id)}}let Bi=class Ac extends q{constructor(e,t){super("statusbar.manage.extension",g(3437,"Manage Extension"));this.extensionId=e;this.commandService=t}run(){return this.commandService.executeCommand("_extensions.manage",this.extensionId)}};Bi=y([d(1,fe)],Bi);P.registerCommandAndKeybindingRule({id:"workbench.statusBar.focusPrevious",weight:N.WorkbenchContrib,primary:E.LeftArrow,secondary:[E.UpArrow],when:Je,handler:h=>{const e=h.get(Ce);e.focusPreviousEntry()}});P.registerCommandAndKeybindingRule({id:"workbench.statusBar.focusNext",weight:N.WorkbenchContrib,primary:E.RightArrow,secondary:[E.DownArrow],when:Je,handler:h=>{const e=h.get(Ce);e.focusNextEntry()}});P.registerCommandAndKeybindingRule({id:"workbench.statusBar.focusFirst",weight:N.WorkbenchContrib,primary:E.Home,when:Je,handler:h=>{const e=h.get(Ce);e.focus(false);e.focusNextEntry()}});P.registerCommandAndKeybindingRule({id:"workbench.statusBar.focusLast",weight:N.WorkbenchContrib,primary:E.End,when:Je,handler:h=>{const e=h.get(Ce);e.focus(false);e.focusPreviousEntry()}});P.registerCommandAndKeybindingRule({id:"workbench.statusBar.clearFocus",weight:N.WorkbenchContrib,primary:E.Escape,when:Je,handler:h=>{const e=h.get(Ce);const t=h.get(qe);if(e.isEntryFocused()){e.focus(false)}else if(t.activeEditorPane){t.activeEditorPane.focus()}}});class Oa extends es{constructor(){super({id:"workbench.action.focusStatusBar",title:le(3438,"Focus Status Bar"),category:ts.View,f1:true})}async run(e){const t=e.get(te);t.focusPart(l.STATUSBAR_PART,Tt())}}Qi(Oa);class Ye extends j{static{this.HIDDEN_ENTRIES_KEY="workbench.statusbar.hidden"}get entries(){return this._entries.slice(0)}get lastFocusedEntry(){return this._lastFocusedEntry&&!this.isHidden(this._lastFocusedEntry.id)?this._lastFocusedEntry:void 0}constructor(e){super();this.storageService=e;this._onDidChangeEntryVisibility=this._register(new T);this.onDidChangeEntryVisibility=this._onDidChangeEntryVisibility.event;this._entries=[];this.hidden=new Set;this.restoreState();this.registerListeners()}restoreState(){const e=this.storageService.get(Ye.HIDDEN_ENTRIES_KEY,I.PROFILE);if(e){try{this.hidden=new Set(JSON.parse(e))}catch(t){}}}registerListeners(){this._register(this.storageService.onDidChangeValue(I.PROFILE,Ye.HIDDEN_ENTRIES_KEY,this._store)(()=>this.onDidStorageValueChange()))}onDidStorageValueChange(){const e=new Set(this.hidden);this.hidden.clear();this.restoreState();const t=new Set;for(const i of e){if(!this.hidden.has(i)){t.add(i)}}for(const i of this.hidden){if(!e.has(i)){t.add(i)}}if(t.size>0){for(const i of this._entries){if(t.has(i.id)){this.updateVisibility(i.id,true);t.delete(i.id)}}}}add(e){this._entries.push(e);this.updateVisibility(e,false);this.sort();this.markFirstLastVisibleEntry()}remove(e){const t=this._entries.indexOf(e);if(t>=0){this._entries.splice(t,1);if(this._entries.some(i=>Dt(i.priority.primary)&&i.priority.primary.location.id===e.id)){this.sort()}this.markFirstLastVisibleEntry()}}isHidden(e){return this.hidden.has(e)}hide(e){if(!this.hidden.has(e)){this.hidden.add(e);this.updateVisibility(e,true);this.saveState()}}show(e){if(this.hidden.has(e)){this.hidden.delete(e);this.updateVisibility(e,true);this.saveState()}}findEntry(e){return this._entries.find(t=>t.container===e)}getEntries(e){return this._entries.filter(t=>t.alignment===e)}focusNextEntry(){this.focusEntry(1,0)}focusPreviousEntry(){this.focusEntry(-1,this.entries.length-1)}isEntryFocused(){return!!this.getFocusedEntry()}getFocusedEntry(){return this._entries.find(e=>Le(e.container))}focusEntry(e,t){const i=r=>{let o=r;let a=o>=0&&o<this._entries.length?this._entries[o]:void 0;while(a&&this.isHidden(a.id)){o+=e;a=o>=0&&o<this._entries.length?this._entries[o]:void 0}return a};const s=this.getFocusedEntry();if(s){const r=i(this._entries.indexOf(s)+e);if(r){this._lastFocusedEntry=r;r.labelContainer.focus();return}}const n=i(t);if(n){this._lastFocusedEntry=n;n.labelContainer.focus()}}updateVisibility(e,t){if(typeof e==="string"){const i=e;for(const s of this._entries){if(s.id===i){this.updateVisibility(s,t)}}}else{const i=e;const s=this.isHidden(i.id);if(s){js(i.container)}else{qs(i.container)}if(t){this._onDidChangeEntryVisibility.fire({id:i.id,visible:!s})}this.markFirstLastVisibleEntry()}}saveState(){if(this.hidden.size>0){this.storageService.store(Ye.HIDDEN_ENTRIES_KEY,JSON.stringify(Array.from(this.hidden.values())),I.PROFILE,R.USER)}else{this.storageService.remove(Ye.HIDDEN_ENTRIES_KEY,I.PROFILE)}}sort(){const e=new Set(this._entries.map(r=>r.id));const t=new Map;const i=new Map;for(let r=0;r<this._entries.length;r++){const o=this._entries[r];if(typeof o.priority.primary==="number"||!e.has(o.priority.primary.location.id)){t.set(o,r)}else{const a=o.priority.primary.location.id;let c=i.get(a);if(!c){for(const u of i.values()){if(u.has(a)){c=u;break}}if(!c){c=new Map;i.set(a,c)}}c.set(o.id,o)}}const s=Array.from(t.keys());s.sort((r,o)=>{if(r.alignment===o.alignment){const a=typeof r.priority.primary==="number"?r.priority.primary:r.priority.primary.location.priority;const c=typeof o.priority.primary==="number"?o.priority.primary:o.priority.primary.location.priority;if(a!==c){return c-a}if(r.priority.secondary!==o.priority.secondary){return o.priority.secondary-r.priority.secondary}return t.get(r)-t.get(o)}if(r.alignment===K.LEFT){return-1}if(o.alignment===K.LEFT){return 1}return 0});let n;if(i.size>0){n=[];for(const r of s){const o=i.get(r.id);const a=o?Array.from(o.values()):void 0;if(a){n.push(...a.filter(c=>Dt(c.priority.primary)&&c.priority.primary.alignment===K.LEFT).sort((c,u)=>u.priority.secondary-c.priority.secondary))}n.push(r);if(a){n.push(...a.filter(c=>Dt(c.priority.primary)&&c.priority.primary.alignment===K.RIGHT).sort((c,u)=>u.priority.secondary-c.priority.secondary))}i.delete(r.id)}for(const[,r]of i){n.push(...Array.from(r.values()).sort((o,a)=>a.priority.secondary-o.priority.secondary))}}else{n=s}this._entries=n}markFirstLastVisibleEntry(){this.doMarkFirstLastVisibleStatusbarItem(this.getEntries(K.LEFT));this.doMarkFirstLastVisibleStatusbarItem(this.getEntries(K.RIGHT))}doMarkFirstLastVisibleStatusbarItem(e){let t;let i;for(const s of e){s.container.classList.remove("first-visible-item","last-visible-item");const n=!this.isHidden(s.id);if(n){if(!t){t=s}i=s}}t?.container.classList.add("first-visible-item");i?.container.classList.add("last-visible-item")}}let Li=class bc extends j{get name(){return re(this.entry).name}get hasCommand(){return typeof this.entry?.command!=="undefined"}constructor(e,t,i,s,n,r,o,a){super();this.container=e;this.hoverDelegate=i;this.commandService=s;this.hoverService=n;this.notificationService=r;this.telemetryService=o;this.themeService=a;this.entry=void 0;this.foregroundListener=this._register(new Ue);this.backgroundListener=this._register(new Ue);this.commandMouseListener=this._register(new Ue);this.commandTouchListener=this._register(new Ue);this.commandKeyboardListener=this._register(new Ue);this.hover=void 0;this.labelContainer=S("a.statusbar-item-label",{role:"button",tabIndex:-1});this._register(Zi.addTarget(this.labelContainer));this.label=this._register(new xa(this.labelContainer));this.container.appendChild(this.labelContainer);this.beakContainer=S(".status-bar-item-beak-container");this.container.appendChild(this.beakContainer);this.update(t)}update(e){this.label.showProgress=e.showProgress??false;if(!this.entry||e.text!==this.entry.text){this.label.text=e.text;if(e.text){qs(this.labelContainer)}else{js(this.labelContainer)}}if(!this.entry||e.ariaLabel!==this.entry.ariaLabel){this.container.setAttribute("aria-label",e.ariaLabel);this.labelContainer.setAttribute("aria-label",e.ariaLabel)}if(!this.entry||e.role!==this.entry.role){this.labelContainer.setAttribute("role",e.role||"button")}if(!this.entry||!this.isEqualTooltip(this.entry,e)){let i;let s;if(Jr(e.tooltip)){s=e.tooltip.content;i={actions:e.tooltip.commands.map(r=>({commandId:r.id,label:r.title,run:()=>this.executeCommand(r)}))}}else{s=e.tooltip}const n=ni(s)?{markdown:s,markdownNotSupportedFallback:void 0}:s;if(this.hover){this.hover.update(n,i)}else{this.hover=this._register(this.hoverService.setupManagedHover(this.hoverDelegate,this.container,n,i))}}if(!this.entry||e.command!==this.entry.command){this.commandMouseListener.clear();this.commandTouchListener.clear();this.commandKeyboardListener.clear();const i=e.command;if(i&&(i!==Cs||this.hover)){this.commandMouseListener.value=H(this.labelContainer,$.CLICK,()=>this.executeCommand(i));this.commandTouchListener.value=H(this.labelContainer,$i.Tap,()=>this.executeCommand(i));this.commandKeyboardListener.value=H(this.labelContainer,$.KEY_DOWN,s=>{const n=new Ms(s);if(n.equals(E.Space)||n.equals(E.Enter)){Ae.stop(s);this.executeCommand(i)}else if(n.equals(E.Escape)||n.equals(E.LeftArrow)||n.equals(E.RightArrow)){Ae.stop(s);this.hover?.hide()}});this.labelContainer.classList.remove("disabled")}else{this.labelContainer.classList.add("disabled")}}if(!this.entry||e.showBeak!==this.entry.showBeak){if(e.showBeak){this.container.classList.add("has-beak")}else{this.container.classList.remove("has-beak")}}const t=!!e.backgroundColor||e.kind&&e.kind!=="standard";if(!this.entry||e.kind!==this.entry.kind){for(const i of Qr){this.container.classList.remove(`${i}-kind`)}if(e.kind&&e.kind!=="standard"){this.container.classList.add(`${e.kind}-kind`)}this.container.classList.toggle("has-background-color",t)}if(!this.entry||e.color!==this.entry.color){this.applyColor(this.labelContainer,e.color)}if(!this.entry||e.backgroundColor!==this.entry.backgroundColor){this.container.classList.toggle("has-background-color",t);this.applyColor(this.container,e.backgroundColor,true)}this.entry=e}isEqualTooltip({tooltip:e},{tooltip:t}){if(e===void 0){return t===void 0}if(ni(e)){return ni(t)&&eo(e,t)}return e===t}async executeCommand(e){if(e===Cs){this.hover?.show(true)}else{const t=typeof e==="string"?e:e.id;const i=typeof e==="string"?[]:e.arguments??[];this.telemetryService.publicLog2("workbenchActionExecuted",{id:t,from:"status bar"});try{await this.commandService.executeCommand(t,...i)}catch(s){this.notificationService.error(St(s))}}}applyColor(e,t,i){let s=void 0;if(i){this.backgroundListener.clear()}else{this.foregroundListener.clear()}if(t){if(to(t)){s=this.themeService.getColorTheme().getColor(t.id)?.toString();const n=this.themeService.onDidColorThemeChange(r=>{const o=r.getColor(t.id)?.toString();if(i){e.style.backgroundColor=o??""}else{e.style.color=o??""}});if(i){this.backgroundListener.value=n}else{this.foregroundListener.value=n}}else{s=t}}if(i){e.style.backgroundColor=s??""}else{e.style.color=s??""}}};Li=y([d(3,fe),d(4,ji),d(5,be),d(6,Yi),d(7,ie)],Li);class xa extends io{constructor(e){super(e);this.container=e;this.progressCodicon=gi(Es);this.currentText="";this.currentShowProgress=false}set showProgress(e){if(this.currentShowProgress!==e){this.currentShowProgress=e;this.progressCodicon=gi(e==="syncing"?Es:so);this.text=this.currentText}}set text(e){if(this.currentShowProgress){if(this.container.firstChild!==this.progressCodicon){this.container.appendChild(this.progressCodicon)}for(const i of Array.from(this.container.childNodes)){if(i!==this.progressCodicon){i.remove()}}let t=e??"";if(t){t=` ${t}`}Q(this.container,...no(t))}else{super.text=e}}}var Pt;var Mi;ye(Ba);let bt=class Sc extends qt{static{Pt=this}static{this.HEIGHT=22}constructor(e,t,i,s,n,r,o,a){super(e,{hasTitle:false},i,n,r);this.instantiationService=t;this.contextService=s;this.contextMenuService=o;this.contextKeyService=a;this.minimumWidth=0;this.maximumWidth=Number.POSITIVE_INFINITY;this.minimumHeight=Pt.HEIGHT;this.maximumHeight=Pt.HEIGHT;this.pendingEntries=[];this._onWillDispose=this._register(new T);this.onWillDispose=this._onWillDispose.event;this.onDidOverrideEntry=this._register(new T);this.entryOverrides=new Map;this.compactEntriesDisposable=this._register(new Ue);this.styleOverrides=new Set;this.viewModel=this._register(new Ye(n));this.onDidChangeEntryVisibility=this.viewModel.onDidChangeEntryVisibility;this.hoverDelegate=this._register(this.instantiationService.createInstance(ro,"element",{instantHover:true,dynamicDelay(c){if(typeof c==="function"||is(c)||oo(c)&&typeof c.markdown==="function"||ao(c)){return 500}return void 0}},(c,u)=>({persistence:{hideOnKeyDown:true,sticky:u}})));this.registerListeners()}registerListeners(){this._register(this.onDidChangeEntryVisibility(()=>this.updateCompactEntries()));this._register(this.contextService.onDidChangeWorkbenchState(()=>this.updateStyles()))}overrideEntry(e,t){this.entryOverrides.set(e,t);this.onDidOverrideEntry.fire(e);return ue(()=>{const i=this.entryOverrides.get(e);if(i===t){this.entryOverrides.delete(e);this.onDidOverrideEntry.fire(e)}})}withEntryOverride(e,t){const i=this.entryOverrides.get(t);if(i){e={...e,...i}}return e}addEntry(e,t,i,s=0){let n;if(co(s)){n=s}else{n={primary:s,secondary:ho(t)}}if(!this.element){return this.doAddPendingEntry(e,t,i,n)}return this.doAddEntry(e,t,i,n)}doAddPendingEntry(e,t,i,s){const n={entry:e,id:t,alignment:i,priority:s};this.pendingEntries.push(n);const r={update:o=>{if(n.accessor){n.accessor.update(o)}else{n.entry=o}},dispose:()=>{if(n.accessor){n.accessor.dispose()}else{this.pendingEntries=this.pendingEntries.filter(o=>o!==n)}}};return r}doAddEntry(e,t,i,s){const n=new V;const r=this.doCreateStatusItem(t,i);const o=n.add(this.instantiationService.createInstance(Li,r,this.withEntryOverride(e,t),this.hoverDelegate));const a=new class{constructor(){this.id=t;this.extensionId=e.extensionId;this.alignment=i;this.priority=s;this.container=r;this.labelContainer=o.labelContainer}get name(){return o.name}get hasCommand(){return o.hasCommand}};const{needsFullRefresh:c}=this.doAddOrRemoveModelEntry(a,true);if(c){this.appendStatusbarEntries()}else{this.appendStatusbarEntry(a)}let u=e;const m={update:p=>{u=p;o.update(this.withEntryOverride(p,t))},dispose:()=>{const{needsFullRefresh:p}=this.doAddOrRemoveModelEntry(a,false);if(p){this.appendStatusbarEntries()}else{r.remove();this.updateCompactEntries()}n.dispose()}};n.add(this.onDidOverrideEntry.event(p=>{if(p===t){m.update(u)}}));return m}doCreateStatusItem(e,t,...i){const s=S(".statusbar-item",{id:e});if(i){s.classList.add(...i)}if(t===K.RIGHT){s.classList.add("right")}else{s.classList.add("left")}return s}doAddOrRemoveModelEntry(e,t){const i=this.viewModel.entries;if(t){this.viewModel.add(e)}else{this.viewModel.remove(e)}const s=this.viewModel.entries;if(t){i.splice(s.indexOf(e),0,e)}else{i.splice(i.indexOf(e),1)}const n=!Vs(i,s);return{needsFullRefresh:n}}isEntryVisible(e){return!this.viewModel.isHidden(e)}updateEntryVisibility(e,t){if(t){this.viewModel.show(e)}else{this.viewModel.hide(e)}}focusNextEntry(){this.viewModel.focusNextEntry()}focusPreviousEntry(){this.viewModel.focusPreviousEntry()}isEntryFocused(){return this.viewModel.isEntryFocused()}focus(e=true){this.getContainer()?.focus();const t=this.viewModel.lastFocusedEntry;if(e&&t){setTimeout(()=>t.labelContainer.focus(),0)}}createContentArea(e){this.element=e;const t=this._register(this.contextKeyService.createScoped(this.element));Je.bindTo(t).set(true);this.leftItemsContainer=S(".left-items.items-container");this.element.appendChild(this.leftItemsContainer);this.element.tabIndex=0;this.rightItemsContainer=S(".right-items.items-container");this.element.appendChild(this.rightItemsContainer);this._register(H(e,$.CONTEXT_MENU,i=>this.showContextMenu(i)));this._register(Zi.addTarget(e));this._register(H(e,$i.Contextmenu,i=>this.showContextMenu(i)));this.createInitialStatusbarEntries();return this.element}createInitialStatusbarEntries(){this.appendStatusbarEntries();while(this.pendingEntries.length){const e=this.pendingEntries.shift();if(e){e.accessor=this.addEntry(e.entry,e.id,e.alignment,e.priority.primary)}}}appendStatusbarEntries(){const e=re(this.leftItemsContainer);const t=re(this.rightItemsContainer);Be(e);Be(t);for(const i of[...this.viewModel.getEntries(K.LEFT),...this.viewModel.getEntries(K.RIGHT).reverse()]){const s=i.alignment===K.LEFT?e:t;s.appendChild(i.container)}this.updateCompactEntries()}appendStatusbarEntry(e){const t=this.viewModel.getEntries(e.alignment);if(e.alignment===K.RIGHT){t.reverse()}const i=re(e.alignment===K.LEFT?this.leftItemsContainer:this.rightItemsContainer);const s=t.indexOf(e);if(s+1===t.length){i.appendChild(e.container)}else{i.insertBefore(e.container,t[s+1].container)}this.updateCompactEntries()}updateCompactEntries(){const e=this.viewModel.entries;const t=new Map;for(const r of e){if(!this.viewModel.isHidden(r.id)){t.set(r.id,r)}r.container.classList.remove("compact-left","compact-right")}const i=new Map;for(const r of t.values()){if(Dt(r.priority.primary)&&r.priority.primary.compact){const o=r.priority.primary.location.id;const a=t.get(o);if(!a){continue}let c=i.get(o);if(!c){for(const u of i.values()){if(u.has(o)){c=u;break}}if(!c){c=new Map;i.set(o,c)}}c.set(r.id,r);c.set(a.id,a);if(r.priority.primary.alignment===K.LEFT){a.container.classList.add("compact-left");r.container.classList.add("compact-right")}else{a.container.classList.add("compact-right");r.container.classList.add("compact-left")}}}const s=this.getColor(lo);const n=this.getColor(uo);this.compactEntriesDisposable.value=new V;if(s&&n&&!fo(this.theme.type)){for(const[,r]of i){for(const o of r.values()){if(!o.hasCommand){continue}this.compactEntriesDisposable.value.add(H(o.labelContainer,$.MOUSE_OVER,()=>{r.forEach(a=>a.labelContainer.style.backgroundColor=s);o.labelContainer.style.backgroundColor=n}));this.compactEntriesDisposable.value.add(H(o.labelContainer,$.MOUSE_OUT,()=>{r.forEach(a=>a.labelContainer.style.backgroundColor="")}))}}}}showContextMenu(e){Ae.stop(e,true);const t=new Zs(U(this.element),e);let i=void 0;this.contextMenuService.showContextMenu({getAnchor:()=>t,getActions:()=>{i=this.getContextMenuActions(t);return i},onHide:()=>{if(i){_o(i)}}})}getContextMenuActions(e){const t=[];t.push(Vt({id:Is.ID,label:g(3439,"Hide Status Bar"),run:()=>this.instantiationService.invokeFunction(n=>new Is().run(n))}));t.push(new ut);const i=new Set;for(const n of this.viewModel.entries){if(!i.has(n.id)){t.push(new La(n.id,n.name,this.viewModel));i.add(n.id)}}let s=void 0;for(let n=e.target;n;n=n.parentElement){const r=this.viewModel.findEntry(n);if(r){s=r;break}}if(s){t.push(new ut);if(s.extensionId){t.push(this.instantiationService.createInstance(Bi,s.extensionId))}t.push(new Ma(s.id,s.name,this.viewModel))}return t}updateStyles(){super.updateStyles();const e=re(this.getContainer());const t=[...this.styleOverrides].sort((a,c)=>a.priority-c.priority)[0];const i=this.getColor(t?.background??(this.contextService.getWorkbenchState()!==nt.EMPTY?go:mo))||"";e.style.backgroundColor=i;const s=this.getColor(t?.foreground??(this.contextService.getWorkbenchState()!==nt.EMPTY?po:Ao))||"";e.style.color=s;const n=this.getColor(bo);const r=this.getColor(t?.border??(this.contextService.getWorkbenchState()!==nt.EMPTY?So:Co))||this.getColor(Eo);if(r){e.classList.add("status-border-top");e.style.setProperty("--status-border-top-color",r)}else{e.classList.remove("status-border-top");e.style.removeProperty("--status-border-top-color")}const o=this.getColor(Io);if(!this.styleElement){this.styleElement=To(e)}this.styleElement.textContent=`

				/* Status bar focus outline */
				.monaco-workbench .part.statusbar:focus {
					outline-color: ${o};
				}

				/* Status bar item focus outline */
				.monaco-workbench .part.statusbar > .items-container > .statusbar-item a:focus-visible {
					outline: 1px solid ${this.getColor(yo)??n};
					outline-offset: ${r?"-2px":"-1px"};
				}

				/* Notification Beak */
				.monaco-workbench .part.statusbar > .items-container > .statusbar-item.has-beak > .status-bar-item-beak-container:before {
					border-bottom-color: ${i};
				}
			`}layout(e,t,i,s){super.layout(e,t,i,s);super.layoutContents(e,t)}overrideStyle(e){this.styleOverrides.add(e);this.updateStyles();return ue(()=>{this.styleOverrides.delete(e);this.updateStyles()})}toJSON(){return{type:l.STATUSBAR_PART}}dispose(){this._onWillDispose.fire();super.dispose()}};bt=Pt=y([d(1,B),d(2,ie),d(3,jt),d(4,ae),d(5,te),d(6,ge),d(7,Se)],bt);let Oi=class Cc extends bt{constructor(e,t,i,s,n,r,o){super(l.STATUSBAR_PART,e,t,i,s,n,r,o)}};Oi=y([d(0,B),d(1,ie),d(2,jt),d(3,ae),d(4,te),d(5,ge),d(6,Se)],Oi);let xi=class Ec extends bt{static{Mi=this}static{this.COUNTER=1}constructor(e,t,i,s,n,r,o,a){const c=Mi.COUNTER++;super(`workbench.parts.auxiliaryStatus.${c}`,t,i,s,n,r,o,a);this.container=e;this.height=bt.HEIGHT}};xi=Mi=y([d(1,B),d(2,ie),d(3,jt),d(4,ae),d(5,te),d(6,ge),d(7,Se)],xi);let ki=class Ic extends Xs{constructor(e,t,i){super("workbench.statusBarService",i,t);this.instantiationService=e;this._onDidCreateAuxiliaryStatusbarPart=this._register(new T);this.onDidCreateAuxiliaryStatusbarPart=this._onDidCreateAuxiliaryStatusbarPart.event;this.mainPart=this._register(this.instantiationService.createInstance(Oi));this._register(this.registerPart(this.mainPart));this.onDidChangeEntryVisibility=this.mainPart.onDidChangeEntryVisibility}createAuxiliaryStatusbarPart(e){const t=S("footer.part.statusbar",{"role":"status","aria-live":"off","tabIndex":"0"});t.style.position="relative";e.appendChild(t);const i=this.instantiationService.createInstance(xi,t);const s=this.registerPart(i);i.create(t);oe.once(i.onWillDispose)(()=>s.dispose());this._onDidCreateAuxiliaryStatusbarPart.fire(i);return i}createScoped(e,t){return t.add(this.instantiationService.createInstance(Hi,e))}addEntry(e,t,i,s=0){if(e.showInAllWindows){return this.doAddEntryToAllWindows(e,t,i,s)}return this.mainPart.addEntry(e,t,i,s)}doAddEntryToAllWindows(e,t,i,s=0){const n=new V;const r=new Set;let o=e;function a(c){const u=new V;u.add(c.onWillDispose(()=>u.dispose()));const m=u.add(c.addEntry(o,t,i,s));r.add(m);u.add(ue(()=>r.delete(m)));n.add(u);u.add(ue(()=>n.delete(u)))}for(const c of this.parts){a(c)}n.add(this.onDidCreateAuxiliaryStatusbarPart(c=>a(c)));return{update:c=>{o=c;for(const u of r){u.update(c)}},dispose:()=>n.dispose()}}isEntryVisible(e){return this.mainPart.isEntryVisible(e)}updateEntryVisibility(e,t){for(const i of this.parts){i.updateEntryVisibility(e,t)}}overrideEntry(e,t){const i=new V;for(const s of this.parts){i.add(s.overrideEntry(e,t))}return i}focus(e){this.activePart.focus(e)}focusNextEntry(){this.activePart.focusNextEntry()}focusPreviousEntry(){this.activePart.focusPreviousEntry()}isEntryFocused(){return this.activePart.isEntryFocused()}overrideStyle(e){const t=new V;for(const i of this.parts){t.add(i.overrideStyle(e))}return t}};ki=y([d(0,B),d(1,ae),d(2,ie)],ki);let Hi=class Tc extends j{constructor(e,t){super();this.statusbarEntryContainer=e;this.statusbarService=t;this.onDidChangeEntryVisibility=this.statusbarEntryContainer.onDidChangeEntryVisibility}createAuxiliaryStatusbarPart(e){return this.statusbarService.createAuxiliaryStatusbarPart(e)}createScoped(e,t){return this.statusbarService.createScoped(e,t)}getPart(){return this.statusbarEntryContainer}addEntry(e,t,i,s=0){return this.statusbarEntryContainer.addEntry(e,t,i,s)}isEntryVisible(e){return this.statusbarEntryContainer.isEntryVisible(e)}updateEntryVisibility(e,t){this.statusbarEntryContainer.updateEntryVisibility(e,t)}overrideEntry(e,t){return this.statusbarEntryContainer.overrideEntry(e,t)}focus(e){this.statusbarEntryContainer.focus(e)}focusNextEntry(){this.statusbarEntryContainer.focusNextEntry()}focusPreviousEntry(){this.statusbarEntryContainer.focusPreviousEntry()}isEntryFocused(){return this.statusbarEntryContainer.isEntryFocused()}overrideStyle(e){return this.statusbarEntryContainer.overrideStyle(e)}};Hi=y([d(1,Ce)],Hi);function ka(h){const e=h;return typeof e.id==="string"&&e.id.length>0&&typeof e.name==="string"&&typeof e.text==="string"&&(e.alignment==="left"||e.alignment==="right")&&(e.command===void 0||typeof e.command==="string")&&(e.tooltip===void 0||typeof e.tooltip==="string")&&(e.priority===void 0||typeof e.priority==="number")&&(e.accessibilityInformation===void 0||Lo(e.accessibilityInformation))}const ws={type:"object",required:["id","text","alignment","name"],properties:{id:{type:"string",markdownDescription:g(2429,"The identifier of the status bar entry. Must be unique within the extension. The same value must be used when calling the `vscode.window.createStatusBarItem(id, ...)`-API")},name:{type:"string",description:g(2430,"The name of the entry, like 'Python Language Indicator', 'Git Status' etc. Try to keep the length of the name short, yet descriptive enough that users can understand what the status bar item is about.")},text:{type:"string",description:g(2431,"The text to show for the entry. You can embed icons in the text by leveraging the `$(<name>)`-syntax, like 'Hello $(globe)!'")},tooltip:{type:"string",description:g(2432,"The tooltip text for the entry.")},command:{type:"string",description:g(2433,"The command to execute when the status bar entry is clicked.")},alignment:{type:"string",enum:["left","right"],description:g(2434,"The alignment of the status bar entry.")},priority:{type:"number",description:g(2435,"The priority of the status bar entry. Higher value means the item should be shown more to the left.")},accessibilityInformation:{type:"object",description:g(2436,"Defines the role and aria label to be used when the status bar entry is focused."),properties:{role:{type:"string",description:g(2437,"The role of the status bar entry which defines how a screen reader interacts with it. More about aria roles can be found here https://w3c.github.io/aria/#widget_roles")},label:{type:"string",description:g(2438,"The aria label of the status bar entry. Defaults to the entry's text.")}}}}};const Ha={description:g(2439,"Contributes items to the status bar."),oneOf:[ws,{type:"array",items:ws}]};const Ds=vo.registerExtensionPoint({extensionPoint:"statusBarItems",jsonSchema:Ha});let Fi=class yc{constructor(e){const t=new V;Ds.setHandler(i=>{t.clear();for(const s of i){if(!Ro(s.description,"contribStatusBarItems")){s.collector.error(`The ${Ds.name} is proposed API`);continue}const{value:n,collector:r}=s;for(const o of Po.wrap(n)){if(!ka(o)){r.error(g(2440,"Invalid status bar item contribution."));continue}const a=No(s.description.identifier,o.id);const c=e.setOrUpdateEntry(a,a,Vo.toKey(s.description.identifier),o.name??s.description.displayName??s.description.name,o.text,o.tooltip,o.command?{id:o.command,title:o.name}:void 0,void 0,void 0,o.alignment==="left",o.priority,o.accessibilityInformation);if(c===Bo.DidDefine){t.add(ue(()=>e.unsetEntry(a)))}}}})}};Fi=y([d(0,Js)],Fi);let Kt=class _c{static{this.ID="workbench.contrib.statusBarItemsExtensionPoint"}constructor(e){this.instantiationService=e;this.instantiationService.createInstance(Fi)}};Kt=y([d(0,B)],Kt);wo(Kt.ID,Kt,Do.BlockStartup);function Fa(){return{[Ce.toString()]:new Ve(ki,[],false),[Js.toString()]:new Ve(Mo,[],false)}}const Wa=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));ye(Wa);let Wi=class vc extends qt{get minimumHeight(){return this.visible?this.height:0}get maximumHeight(){return this.visible?this.height:0}get onDidChange(){return this._onDidChangeSize.event}constructor(e,t,i,s,n){super(l.BANNER_PART,{hasTitle:false},e,i,t);this.contextKeyService=s;this.instantiationService=n;this.height=26;this.minimumWidth=0;this.maximumWidth=Number.POSITIVE_INFINITY;this._onDidChangeSize=this._register(new T);this.visible=false;this.focusedActionIndex=-1;this.markdownRenderer=this.instantiationService.createInstance(Oo,{})}createContentArea(e){this.element=e;this.element.tabIndex=0;this._register(H(this.element,$.FOCUS,()=>{if(this.focusedActionIndex!==-1){this.focusActionLink()}}));const t=this._register(this.contextKeyService.createScoped(this.element));Jt.bindTo(t).set(true);return this.element}close(e){this.setVisibility(false);Be(this.element);if(typeof e.onClose==="function"){e.onClose()}this.item=void 0}focusActionLink(){const e=this.item?.actions?.length??0;if(this.focusedActionIndex<e){const t=this.messageActionsContainer?.children[this.focusedActionIndex];if(is(t)){this.actionBar?.setFocusable(false);t.focus()}}else{this.actionBar?.focus(0)}}getAriaLabel(e){if(e.ariaLabel){return e.ariaLabel}if(typeof e.message==="string"){return e.message}return void 0}getBannerMessage(e){if(typeof e==="string"){const t=S("span");t.innerText=e;return t}return this.markdownRenderer.render(e).element}setVisibility(e){if(e!==this.visible){this.visible=e;this.focusedActionIndex=-1;this.layoutService.setPartHidden(!e,l.BANNER_PART);this._onDidChangeSize.fire(void 0)}}focus(){this.focusedActionIndex=-1;this.element.focus()}focusNextAction(){const e=this.item?.actions?.length??0;this.focusedActionIndex=this.focusedActionIndex<e?this.focusedActionIndex+1:0;this.focusActionLink()}focusPreviousAction(){const e=this.item?.actions?.length??0;this.focusedActionIndex=this.focusedActionIndex>0?this.focusedActionIndex-1:e;this.focusActionLink()}hide(e){if(this.item?.id!==e){return}this.setVisibility(false)}show(e){if(e.id===this.item?.id){this.setVisibility(true);return}Be(this.element);const t=this.getAriaLabel(e);if(t){this.element.setAttribute("aria-label",t)}const i=Q(this.element,S("div.icon-container"));i.setAttribute("aria-hidden","true");if(F.isThemeIcon(e.icon)){i.appendChild(S(`div${F.asCSSSelector(e.icon)}`))}else{i.classList.add("custom-icon");if($t.isUri(e.icon)){i.style.backgroundImage=xo(e.icon)}}const s=Q(this.element,S("div.message-container"));s.setAttribute("aria-hidden","true");s.appendChild(this.getBannerMessage(e.message));this.messageActionsContainer=Q(this.element,S("div.message-actions-container"));if(e.actions){for(const a of e.actions){this._register(this.instantiationService.createInstance(ko,this.messageActionsContainer,{...a,tabIndex:-1},{}))}}const n=Q(this.element,S("div.action-container"));this.actionBar=this._register(new Xi(n));const r=e.closeLabel??"Close Banner";const o=this._register(new q("banner.close",r,F.asClassName(Ho),true,()=>this.close(e)));this.actionBar.push(o,{icon:true,label:false});this.actionBar.setFocusable(false);this.setVisibility(true);this.item=e}toJSON(){return{type:l.BANNER_PART}}};Wi=y([d(0,ie),d(1,te),d(2,ae),d(3,Se),d(4,B)],Wi);P.registerCommandAndKeybindingRule({id:"workbench.banner.focusBanner",weight:N.WorkbenchContrib,primary:E.Escape,when:Jt,handler:h=>{const e=h.get(He);e.focus()}});P.registerCommandAndKeybindingRule({id:"workbench.banner.focusNextAction",weight:N.WorkbenchContrib,primary:E.RightArrow,secondary:[E.DownArrow],when:Jt,handler:h=>{const e=h.get(He);e.focusNextAction()}});P.registerCommandAndKeybindingRule({id:"workbench.banner.focusPreviousAction",weight:N.WorkbenchContrib,primary:E.LeftArrow,secondary:[E.UpArrow],when:Jt,handler:h=>{const e=h.get(He);e.focusPreviousAction()}});class Yt extends es{static{this.ID="workbench.action.focusBanner"}static{this.LABEL=le(2845,"Focus Banner")}constructor(){super({id:Yt.ID,title:Yt.LABEL,category:ts.View,f1:true})}async run(e){const t=e.get(te);t.focusPart(l.BANNER_PART)}}Qi(Yt);var Nt;let Gi=class wc{static{Nt=this}static{this.WELCOME_BANNER_DISMISSED_KEY="workbench.banner.welcome.dismissed"}constructor(e,t,i){const s=i.options?.welcomeBanner;if(!s){return}if(t.getBoolean(Nt.WELCOME_BANNER_DISMISSED_KEY,I.PROFILE,false)){return}let n=void 0;if(typeof s.icon==="string"){n=F.fromId(s.icon)}else if(s.icon){n=$t.revive(s.icon)}e.show({id:"welcome.banner",message:s.message,icon:n,actions:s.actions,onClose:()=>{t.store(Nt.WELCOME_BANNER_DISMISSED_KEY,true,I.PROFILE,R.MACHINE)}})}};Gi=Nt=y([d(0,He),d(1,ae),d(2,Ct)],Gi);Fo.as(Wo.Workbench).registerWorkbenchContribution(Gi,st.Restored);function Ga(){return{[He.toString()]:new Ve(Wi,[],false)}}$s(async h=>{h.get(He)});let Ui=class Dc extends Pa{constructor(e,t,i){super(zo(),e,new Ko,t);this.instantiationService=i;this.mainContainer.classList.add("monaco-workbench-part")}registerErrorHandler(e){Us(t=>this.handleUnexpectedError(t,e))}createNotificationsHandlers(){}initServices(){return this.instantiationService}restore(){try{this.restoreParts()}catch(e){_t(e)}}};Ui=y([d(1,Fs),d(2,B)],Ui);const Rs=Yo(C);Xo(Rs!=null&&!Rs.guess,C);Zo(async h=>{h.get(te).startup()});$o(async h=>{h.get(B).createInstance(ia)});function Rc(h,e){return{...ea(e),...Uo({isKeybindingConfigurationVisible:()=>true,shouldUseGlobalPicker:()=>true}),...Go({shouldUseGlobalKeybindings:()=>true}),[te.toString()]:new Ve(Ui,[h],false),[_e.toString()]:new Ve(ta,[],false),[qe.toString()]:new Ve(sa,[void 0],false),...Va(),...Fa(),...Ga()}}export{Vc as AbstractResourceEditorInput,Bc as AbstractTextResourceEditorInput,Lc as ConfirmResult,Mc as DomScrollableElement,Oc as EditorInput,$n as EditorInputCapabilities,l as Parts,xc as RegisteredEditorPriority,kc as SplitView,A as ViewContainerLocation,Hc as ViewPaneContainer,Rc as default,Wc as getSideBarPosition,Gc as isPartVisibile,Uc as onDidChangeSideBarPosition};
