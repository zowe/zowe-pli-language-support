class Fn{constructor(e){this.executor=e;this._didRun=false}get hasValue(){return this._didRun}get value(){if(!this._didRun){try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=true}}if(this._error){throw this._error}return this._value}get rawValue(){return this._value}}let w5=class dM{constructor(){this.listeners=[];this.unexpectedErrorHandler=function(e){setTimeout(()=>{if(e.stack){if(Ns.isErrorNoTelemetry(e)){throw new Ns(e.message+"\n\n"+e.stack)}throw new Error(e.message+"\n\n"+e.stack)}throw e},0)}}addListener(e){this.listeners.push(e);return()=>{this._removeListener(e)}}emit(e){this.listeners.forEach(i=>{i(e)})}_removeListener(e){this.listeners.splice(this.listeners.indexOf(e),1)}setUnexpectedErrorHandler(e){this.unexpectedErrorHandler=e}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(e){this.unexpectedErrorHandler(e);this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}};const rh=new w5;function X1(t){rh.setUnexpectedErrorHandler(t)}function kf(t){rh.onUnexpectedError(t);return void 0}function Pi(t){if(!fo(t)){rh.onUnexpectedError(t)}return void 0}function Pk(t){if(!fo(t)){rh.onUnexpectedExternalError(t)}return void 0}function Wl(t){if(t instanceof Error){const{name:e,message:i,cause:n}=t;const s=t.stacktrace||t.stack;return{$isError:true,name:e,message:i,stack:s,noTelemetry:Ns.isErrorNoTelemetry(t),cause:n?Wl(n):void 0,code:t.code}}return t}function Ak(t){let e;if(t.noTelemetry){e=new Ns}else{e=new Error;e.name=t.name}e.message=t.message;e.stack=t.stack;if(t.code){e.code=t.code}if(t.cause){e.cause=Ak(t.cause)}return e}const If="Canceled";function fo(t){if(t instanceof Us){return true}return t instanceof Error&&t.name===If&&t.message===If}class Us extends Error{constructor(){super(If);this.name=this.message}}function jy(){const t=new Error(If);t.name=t.message;return t}function $e(t){if(t){return new Error(`Illegal argument: ${t}`)}else{return new Error("Illegal argument")}}function d0(t){if(t){return new Error(`Illegal state: ${t}`)}else{return new Error("Illegal state")}}class Vo extends TypeError{constructor(e){super(e?`${e} is read-only and cannot be changed`:"Cannot change read-only property")}}class b5 extends Error{constructor(e){super("NotImplemented");if(e){this.message=e}}}class Y1 extends Error{constructor(e){super("NotSupported");if(e){this.message=e}}}class Ns extends Error{constructor(e){super(e);this.name="CodeExpectedError"}static fromError(e){if(e instanceof Ns){return e}const i=new Ns;i.message=e.message;i.stack=e.stack;return i}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}}class Ji extends Error{constructor(e){super(e||"An unexpected bug occurred.");Object.setPrototypeOf(this,Ji.prototype)}}function y5(t,e,i=t.length-1){const n=x5(t,e,i);if(n===-1){return void 0}return t[n]}function x5(t,e,i=t.length-1){for(let n=i;n>=0;n--){const s=t[n];if(e(s)){return n}}return-1}function Is(t,e,i=(n,s)=>n===s){if(t===e){return true}if(!t||!e){return false}if(t.length!==e.length){return false}for(let n=0,s=t.length;n<s;n++){if(!i(t[n],e[n])){return false}}return true}function E5(t,e){const i=[];let n=void 0;for(const s of t.slice(0).sort(e)){if(!n||e(n[0],s)!==0){n=[s];i.push(n)}else{n.push(s)}}return i}function Rk(t,e,i){const n=[];function s(a,l,c){if(l===0&&c.length===0){return}const u=n[n.length-1];if(u&&u.start+u.deleteCount===a){u.deleteCount+=l;u.toInsert.push(...c)}else{n.push({start:a,deleteCount:l,toInsert:c})}}let r=0;let o=0;while(true){if(r===t.length){s(r,0,e.slice(o));break}if(o===e.length){s(r,t.length-r,[]);break}const a=t[r];const l=e[o];const c=i(a,l);if(c===0){r+=1;o+=1}else if(c<0){s(r,1,[]);r+=1}else if(c>0){s(r,0,[l]);o+=1}}return n}function S5(t,e,i){const n=Rk(t,e,i);const s=[];const r=[];for(const o of n){s.push(...t.slice(o.start,o.start+o.deleteCount));r.push(...o.toInsert)}return{removed:s,added:r}}function ei(t){return t.filter(e=>!!e)}function D5(t){let e=0;for(let i=0;i<t.length;i++){if(!!t[i]){t[e]=t[i];e+=1}}t.length=e}function h0(t){return!Array.isArray(t)||t.length===0}function kc(t){return Array.isArray(t)&&t.length>0}function sl(t,e=i=>i){const i=new Set;return t.filter(n=>{const s=e(n);if(i.has(s)){return false}i.add(s);return true})}function Gy(t,e){let i;{i=Math.random}for(let n=t.length-1;n>0;n-=1){const s=Math.floor(i()*(n+1));const r=t[n];t[n]=t[s];t[s]=r}}function Z1(t,e){return Array.isArray(t)?t.map(e):e(t)}function Sn(t){return Array.isArray(t)?t:[t]}var e_;(function(t){function e(r){return r<0}t.isLessThan=e;function i(r){return r<=0}t.isLessThanOrEqual=i;function n(r){return r>0}t.isGreaterThan=n;function s(r){return r===0}t.isNeitherLessOrGreaterThan=s;t.greaterThan=1;t.lessThan=-1;t.neitherLessOrGreaterThan=0})(e_||(e_={}));function k5(t,e){return(i,n)=>e(t(i),t(n))}const I5=(t,e)=>t-e;class qh{static{this.empty=new qh(e=>{})}constructor(e){this.iterate=e}forEach(e){this.iterate(i=>{e(i);return true})}toArray(){const e=[];this.iterate(i=>{e.push(i);return true});return e}filter(e){return new qh(i=>this.iterate(n=>e(n)?i(n):true))}map(e){return new qh(i=>this.iterate(n=>i(e(n))))}some(e){let i=false;this.iterate(n=>{i=e(n);return!i});return i}findFirst(e){let i;this.iterate(n=>{if(e(n)){i=n;return false}return true});return i}findLast(e){let i;this.iterate(n=>{if(e(n)){i=n}return true});return i}findLastMaxBy(e){let i;let n=true;this.iterate(s=>{if(n||e_.isGreaterThan(e(s,i))){n=false;i=s}return true});return i}}function Lk(t,e){const i=Object.create(null);for(const n of t){const s=e(n);let r=i[s];if(!r){r=i[s]=[]}r.push(n)}return i}function C5(t,e){const i=[];const n=[];for(const s of t){if(!e.has(s)){i.push(s)}}for(const s of e){if(!t.has(s)){n.push(s)}}return{removed:i,added:n}}var Ky;var Qy;var Jy;function T5(t,e,i){let n=t.get(e);if(n===void 0){n=i;t.set(e,n)}return n}class P5{constructor(e,i){this.uri=e;this.value=i}}function A5(t){return Array.isArray(t)}class Ft{static{this.defaultToKey=e=>e.toString()}constructor(e,i){this[Ky]="ResourceMap";if(e instanceof Ft){this.map=new Map(e.map);this.toKey=i??Ft.defaultToKey}else if(A5(e)){this.map=new Map;this.toKey=i??Ft.defaultToKey;for(const[n,s]of e){this.set(n,s)}}else{this.map=new Map;this.toKey=e??Ft.defaultToKey}}set(e,i){this.map.set(this.toKey(e),new P5(e,i));return this}get(e){return this.map.get(this.toKey(e))?.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,i){if(typeof i!=="undefined"){e=e.bind(i)}for(const[n,s]of this.map){e(s.value,s.uri,this)}}*values(){for(const e of this.map.values()){yield e.value}}*keys(){for(const e of this.map.values()){yield e.uri}}*entries(){for(const e of this.map.values()){yield[e.uri,e.value]}}*[(Ky=Symbol.toStringTag,Symbol.iterator)](){for(const[,e]of this.map){yield[e.uri,e.value]}}}class Nk{constructor(e,i){this[Qy]="ResourceSet";if(!e||typeof e==="function"){this._map=new Ft(e)}else{this._map=new Ft(i);e.forEach(this.add,this)}}get size(){return this._map.size}add(e){this._map.set(e,e);return this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,i){this._map.forEach((n,s)=>e.call(i,s,s,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[(Qy=Symbol.toStringTag,Symbol.iterator)](){return this.keys()}}var Mi;(function(t){t[t["None"]=0]="None";t[t["AsOld"]=1]="AsOld";t[t["AsNew"]=2]="AsNew"})(Mi||(Mi={}));class R5{constructor(){this[Jy]="LinkedMap";this._map=new Map;this._head=void 0;this._tail=void 0;this._size=0;this._state=0}clear(){this._map.clear();this._head=void 0;this._tail=void 0;this._size=0;this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,i=Mi.None){const n=this._map.get(e);if(!n){return void 0}if(i!==Mi.None){this.touch(n,i)}return n.value}set(e,i,n=Mi.None){let s=this._map.get(e);if(s){s.value=i;if(n!==Mi.None){this.touch(s,n)}}else{s={key:e,value:i,next:void 0,previous:void 0};switch(n){case Mi.None:this.addItemLast(s);break;case Mi.AsOld:this.addItemFirst(s);break;case Mi.AsNew:this.addItemLast(s);break;default:this.addItemLast(s);break}this._map.set(e,s);this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const i=this._map.get(e);if(!i){return void 0}this._map.delete(e);this.removeItem(i);this._size--;return i.value}shift(){if(!this._head&&!this._tail){return void 0}if(!this._head||!this._tail){throw new Error("Invalid list")}const e=this._head;this._map.delete(e.key);this.removeItem(e);this._size--;return e.value}forEach(e,i){const n=this._state;let s=this._head;while(s){if(i){e.bind(i)(s.value,s.key,this)}else{e(s.value,s.key,this)}if(this._state!==n){throw new Error(`LinkedMap got modified during iteration.`)}s=s.next}}keys(){const e=this;const i=this._state;let n=this._head;const s={[Symbol.iterator](){return s},next(){if(e._state!==i){throw new Error(`LinkedMap got modified during iteration.`)}if(n){const r={value:n.key,done:false};n=n.next;return r}else{return{value:void 0,done:true}}}};return s}values(){const e=this;const i=this._state;let n=this._head;const s={[Symbol.iterator](){return s},next(){if(e._state!==i){throw new Error(`LinkedMap got modified during iteration.`)}if(n){const r={value:n.value,done:false};n=n.next;return r}else{return{value:void 0,done:true}}}};return s}entries(){const e=this;const i=this._state;let n=this._head;const s={[Symbol.iterator](){return s},next(){if(e._state!==i){throw new Error(`LinkedMap got modified during iteration.`)}if(n){const r={value:[n.key,n.value],done:false};n=n.next;return r}else{return{value:void 0,done:true}}}};return s}[(Jy=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size){return}if(e===0){this.clear();return}let i=this._head;let n=this.size;while(i&&n>e){this._map.delete(i.key);i=i.next;n--}this._head=i;this._size=n;if(i){i.previous=void 0}this._state++}trimNew(e){if(e>=this.size){return}if(e===0){this.clear();return}let i=this._tail;let n=this.size;while(i&&n>e){this._map.delete(i.key);i=i.previous;n--}this._tail=i;this._size=n;if(i){i.next=void 0}this._state++}addItemFirst(e){if(!this._head&&!this._tail){this._tail=e}else if(!this._head){throw new Error("Invalid list")}else{e.next=this._head;this._head.previous=e}this._head=e;this._state++}addItemLast(e){if(!this._head&&!this._tail){this._head=e}else if(!this._tail){throw new Error("Invalid list")}else{e.previous=this._tail;this._tail.next=e}this._tail=e;this._state++}removeItem(e){if(e===this._head&&e===this._tail){this._head=void 0;this._tail=void 0}else if(e===this._head){if(!e.next){throw new Error("Invalid list")}e.next.previous=void 0;this._head=e.next}else if(e===this._tail){if(!e.previous){throw new Error("Invalid list")}e.previous.next=void 0;this._tail=e.previous}else{const i=e.next;const n=e.previous;if(!i||!n){throw new Error("Invalid list")}i.previous=n;n.next=i}e.next=void 0;e.previous=void 0;this._state++}touch(e,i){if(!this._head||!this._tail){throw new Error("Invalid list")}if(i!==Mi.AsOld&&i!==Mi.AsNew){return}if(i===Mi.AsOld){if(e===this._head){return}const n=e.next;const s=e.previous;if(e===this._tail){s.next=void 0;this._tail=s}else{n.previous=s;s.next=n}e.previous=void 0;e.next=this._head;this._head.previous=e;this._head=e;this._state++}else if(i===Mi.AsNew){if(e===this._tail){return}const n=e.next;const s=e.previous;if(e===this._head){n.previous=void 0;this._head=n}else{n.previous=s;s.next=n}e.next=void 0;e.previous=this._tail;this._tail.next=e;this._tail=e;this._state++}}toJSON(){const e=[];this.forEach((i,n)=>{e.push([n,i])});return e}fromJSON(e){this.clear();for(const[i,n]of e){this.set(i,n)}}}let L5=class hM extends R5{constructor(e,i=1){super();this._limit=e;this._ratio=Math.min(Math.max(0,i),1)}get limit(){return this._limit}set limit(e){this._limit=e;this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1);this.checkTrim()}get(e,i=Mi.AsNew){return super.get(e,i)}peek(e){return super.get(e,Mi.None)}set(e,i){super.set(e,i,Mi.AsNew);return this}checkTrim(){if(this.size>this._limit){this.trim(Math.round(this._limit*this._ratio))}}};class f0 extends L5{constructor(e,i=1){super(e,i)}trim(e){this.trimOld(e)}set(e,i){super.set(e,i);this.checkTrim();return this}}class Ok{constructor(){this.map=new Map}add(e,i){let n=this.map.get(e);if(!n){n=new Set;this.map.set(e,n)}n.add(i)}delete(e,i){const n=this.map.get(e);if(!n){return}n.delete(i);if(n.size===0){this.map.delete(e)}}forEach(e,i){const n=this.map.get(e);if(!n){return}n.forEach(i)}get(e){const i=this.map.get(e);if(!i){return new Set}return i}}function p0(t,e){const i=this;let n=false;let s;return function(){if(n){return s}n=true;{s=t.apply(i,arguments)}return s}}function Hi(t,e){if(!t){throw new Error(e?`Assertion failed (${e})`:"Assertion Failed")}}function t_(t,e="Unreachable"){throw new Error(e)}function i_(t,e="unexpected state"){if(!t){const i=typeof e==="string"?new Ji(`Assertion Failed: ${e}`):e;throw i}}function Fk(t){if(!t()){debugger;t();Pi(new Ji("Assertion Failed"))}}function tt(t){return typeof t==="string"}function N5(t){return Array.isArray(t)&&t.every(e=>tt(e))}function Yt(t){return typeof t==="object"&&t!==null&&!Array.isArray(t)&&!(t instanceof RegExp)&&!(t instanceof Date)}function O5(t){const e=Object.getPrototypeOf(Uint8Array);return typeof t==="object"&&t instanceof e}function ia(t){return typeof t==="number"&&!isNaN(t)}function F5(t){return!!t&&typeof t[Symbol.iterator]==="function"}function iu(t){return typeof t==="undefined"}function ln(t){return!Xt(t)}function Xt(t){return iu(t)||t===null}function Mk(t,e){if(!t){throw new Error(e?`Unexpected type, expected '${e}'`:"Unexpected type")}}function zl(t){i_(t!==null&&t!==void 0,"Argument is `undefined` or `null`.");return t}const M5=Object.prototype.hasOwnProperty;function Uk(t){if(!Yt(t)){return false}for(const e in t){if(M5.call(t,e)){return false}}return true}function $k(t){return typeof t==="function"}function U5(t,e){const i=Math.min(t.length,e.length);for(let n=0;n<i;n++){Hk(t[n],e[n])}}function Hk(t,e){if(tt(e)){if(typeof t!==e){throw new Error(`argument does not match constraint: typeof ${e}`)}}else if($k(e)){try{if(t instanceof e){return}}catch{}if(!Xt(t)&&t.constructor===e){return}if(e.length===1&&e.call(void 0,t)===true){return}throw new Error(`argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true`)}}var _i;(function(t){function e(H){return H&&typeof H==="object"&&typeof H[Symbol.iterator]==="function"}t.is=e;const i=Object.freeze([]);function n(){return i}t.empty=n;function*s(H){yield H}t.single=s;function r(H){if(e(H)){return H}else{return s(H)}}t.wrap=r;function o(H){return H||i}t.from=o;function*a(H){for(let Q=H.length-1;Q>=0;Q--){yield H[Q]}}t.reverse=a;function l(H){return!H||H[Symbol.iterator]().next().done===true}t.isEmpty=l;function c(H){return H[Symbol.iterator]().next().value}t.first=c;function u(H,Q){let ne=0;for(const te of H){if(Q(te,ne++)){return true}}return false}t.some=u;function d(H,Q){for(const ne of H){if(Q(ne)){return ne}}return void 0}t.find=d;function*p(H,Q){for(const ne of H){if(Q(ne)){yield ne}}}t.filter=p;function*f(H,Q){let ne=0;for(const te of H){yield Q(te,ne++)}}t.map=f;function*m(H,Q){let ne=0;for(const te of H){yield*Q(te,ne++)}}t.flatMap=m;function*v(...H){for(const Q of H){if(F5(Q)){yield*Q}else{yield Q}}}t.concat=v;function y(H,Q,ne){let te=ne;for(const le of H){te=Q(te,le)}return te}t.reduce=y;function D(H){let Q=0;for(const ne of H){Q++}return Q}t.length=D;function*I(H,Q,ne=H.length){if(Q<-H.length){Q=0}if(Q<0){Q+=H.length}if(ne<0){ne+=H.length}else if(ne>H.length){ne=H.length}for(;Q<ne;Q++){yield H[Q]}}t.slice=I;function R(H,Q=Number.POSITIVE_INFINITY){const ne=[];if(Q===0){return[ne,H]}const te=H[Symbol.iterator]();for(let le=0;le<Q;le++){const Ce=te.next();if(Ce.done){return[ne,t.empty()]}ne.push(Ce.value)}return[ne,{[Symbol.iterator](){return te}}]}t.consume=R;async function J(H){const Q=[];for await(const ne of H){Q.push(ne)}return Promise.resolve(Q)}t.asyncToArray=J})(_i||(_i={}));class Bk{constructor(){this.livingDisposables=new Map}static{this.idx=0}getDisposableData(e){let i=this.livingDisposables.get(e);if(!i){i={parent:null,source:null,isSingleton:false,value:e,idx:Bk.idx++};this.livingDisposables.set(e,i)}return i}trackDisposable(e){const i=this.getDisposableData(e);if(!i.source){i.source=new Error().stack}}setParent(e,i){const n=this.getDisposableData(e);n.parent=i}markAsDisposed(e){this.livingDisposables.delete(e)}markAsSingleton(e){this.getDisposableData(e).isSingleton=true}getRootParent(e,i){const n=i.get(e);if(n){return n}const s=e.parent?this.getRootParent(this.getDisposableData(e.parent),i):e;i.set(e,s);return s}getTrackedDisposables(){const e=new Map;const i=[...this.livingDisposables.entries()].filter(([,n])=>n.source!==null&&!this.getRootParent(n,e).isSingleton).flatMap(([n])=>n);return i}computeLeakingDisposables(e=10,i){let n;if(i){n=i}else{const l=new Map;const c=[...this.livingDisposables.values()].filter(d=>d.source!==null&&!this.getRootParent(d,l).isSingleton);if(c.length===0){return}const u=new Set(c.map(d=>d.value));n=c.filter(d=>{return!(d.parent&&u.has(d.parent))});if(n.length===0){throw new Error("There are cyclic diposable chains!")}}if(!n){return void 0}function s(l){function c(d,p){while(d.length>0&&p.some(f=>typeof f==="string"?f===d[0]:d[0].match(f))){d.shift()}}const u=l.source.split("\n").map(d=>d.trim().replace("at ","")).filter(d=>d!=="");c(u,["Error",/^trackDisposable \(.*\)$/,/^DisposableTracker.trackDisposable \(.*\)$/]);return u.reverse()}const r=new Ok;for(const l of n){const c=s(l);for(let u=0;u<=c.length;u++){r.add(c.slice(0,u).join("\n"),l)}}n.sort(k5(l=>l.idx,I5));let o="";let a=0;for(const l of n.slice(0,e)){a++;const c=s(l);const u=[];for(let d=0;d<c.length;d++){let p=c[d];const f=r.get(c.slice(0,d+1).join("\n"));p=`(shared with ${f.size}/${n.length} leaks) at ${p}`;const m=r.get(c.slice(0,d).join("\n"));const v=Lk([...m].map(y=>s(y)[d]),y=>y);delete v[c[d]];for(const[y,D]of Object.entries(v)){u.unshift(`    - stacktraces of ${D.length} other leaks continue with ${y}`)}u.unshift(p)}o+=`


==================== Leaking disposable ${a}/${n.length}: ${l.value.constructor.name} ====================
${u.join("\n")}
============================================================

`}if(n.length>e){o+=`


... and ${n.length-e} more leaking disposables

`}return{leaks:n,details:o}}}function $5(t){return t}function H5(t,e){}function n_(t){return t}function Vk(t){return typeof t==="object"&&t!==null&&typeof t.dispose==="function"&&t.dispose.length===0}function yr(t){if(_i.is(t)){const e=[];for(const i of t){if(i){try{i.dispose()}catch(n){e.push(n)}}}if(e.length===1){throw e[0]}else if(e.length>1){throw new AggregateError(e,"Encountered errors while disposing of store")}return Array.isArray(t)?[]:t}else if(t){t.dispose();return t}}function g0(...t){const e=ge(()=>yr(t));return e}function ge(t){const e=$5({dispose:p0(()=>{t()})});return e}class Ie{static{this.DISABLE_DISPOSED_WARNING=false}constructor(){this._toDispose=new Set;this._isDisposed=false}dispose(){if(this._isDisposed){return}this._isDisposed=true;this.clear()}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size===0){return}try{yr(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e){return e}if(e===this){throw new Error("Cannot register a disposable on itself!")}if(this._isDisposed){if(!Ie.DISABLE_DISPOSED_WARNING){console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack)}}else{this._toDispose.add(e)}return e}delete(e){if(!e){return}if(e===this){throw new Error("Cannot dispose a disposable on itself!")}this._toDispose.delete(e);e.dispose()}deleteAndLeak(e){if(!e){return}if(this._toDispose.has(e)){this._toDispose.delete(e)}}}let Ee=class fM{static{this.None=Object.freeze({dispose(){}})}constructor(){this._store=new Ie;H5(this._store)}dispose(){this._store.dispose()}_register(e){if(e===this){throw new Error("Cannot register a disposable on itself!")}return this._store.add(e)}};class eo{constructor(){this._isDisposed=false}get value(){return this._isDisposed?void 0:this._value}set value(e){if(this._isDisposed||e===this._value){return}this._value?.dispose();this._value=e}clear(){this.value=void 0}dispose(){this._isDisposed=true;this._value?.dispose();this._value=void 0}clearAndLeak(){const e=this._value;this._value=void 0;return e}}class Cf{constructor(){this._store=new Map;this._isDisposed=false}dispose(){this._isDisposed=true;this.clearAndDisposeAll()}clearAndDisposeAll(){if(!this._store.size){return}try{yr(this._store.values())}finally{this._store.clear()}}has(e){return this._store.has(e)}get size(){return this._store.size}get(e){return this._store.get(e)}set(e,i,n=false){if(this._isDisposed){console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack)}if(!n){this._store.get(e)?.dispose()}this._store.set(e,i)}deleteAndDispose(e){this._store.get(e)?.dispose();this._store.delete(e)}deleteAndLeak(e){const i=this._store.get(e);this._store.delete(e);return i}keys(){return this._store.keys()}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}}function Wk(t,e){return new B5(t,e)}class B5{constructor(e,i){this.reducer=e;this.options=i;this.state={flowing:false,ended:false,destroyed:false};this.buffer={data:[],error:[]};this.listeners={data:[],error:[],end:[]};this.pendingWritePromises=[]}pause(){if(this.state.destroyed){return}this.state.flowing=false}resume(){if(this.state.destroyed){return}if(!this.state.flowing){this.state.flowing=true;this.flowData();this.flowErrors();this.flowEnd()}}write(e){if(this.state.destroyed){return}if(this.state.flowing){this.emitData(e)}else{this.buffer.data.push(e);if(typeof this.options?.highWaterMark==="number"&&this.buffer.data.length>this.options.highWaterMark){return new Promise(i=>this.pendingWritePromises.push(i))}}}error(e){if(this.state.destroyed){return}if(this.state.flowing){this.emitError(e)}else{this.buffer.error.push(e)}}end(e){if(this.state.destroyed){return}if(typeof e!=="undefined"){this.write(e)}if(this.state.flowing){this.emitEnd();this.destroy()}else{this.state.ended=true}}emitData(e){this.listeners.data.slice(0).forEach(i=>i(e))}emitError(e){if(this.listeners.error.length===0){Pi(e)}else{this.listeners.error.slice(0).forEach(i=>i(e))}}emitEnd(){this.listeners.end.slice(0).forEach(e=>e())}on(e,i){if(this.state.destroyed){return}switch(e){case"data":this.listeners.data.push(i);this.resume();break;case"end":this.listeners.end.push(i);if(this.state.flowing&&this.flowEnd()){this.destroy()}break;case"error":this.listeners.error.push(i);if(this.state.flowing){this.flowErrors()}break}}removeListener(e,i){if(this.state.destroyed){return}let n=void 0;switch(e){case"data":n=this.listeners.data;break;case"end":n=this.listeners.end;break;case"error":n=this.listeners.error;break}if(n){const s=n.indexOf(i);if(s>=0){n.splice(s,1)}}}flowData(){if(this.buffer.data.length===0){return}if(typeof this.reducer==="function"){const i=this.reducer(this.buffer.data);this.emitData(i)}else{for(const i of this.buffer.data){this.emitData(i)}}this.buffer.data.length=0;const e=[...this.pendingWritePromises];this.pendingWritePromises.length=0;e.forEach(i=>i())}flowErrors(){if(this.listeners.error.length>0){for(const e of this.buffer.error){this.emitError(e)}this.buffer.error.length=0}}flowEnd(){if(this.state.ended){this.emitEnd();return this.listeners.end.length>0}return false}destroy(){if(!this.state.destroyed){this.state.destroyed=true;this.state.ended=true;this.buffer.data.length=0;this.buffer.error.length=0;this.listeners.data.length=0;this.listeners.error.length=0;this.listeners.end.length=0;this.pendingWritePromises.length=0}}}function V5(t,e){const i=[];let n;while((n=t.read())!==null){i.push(n)}return e(i)}function zk(t,e){return new Promise((i,n)=>{const s=[];qk(t,{onData:r=>{if(e){s.push(r)}},onError:r=>{if(e){n(r)}else{i(void 0)}},onEnd:()=>{if(e){i(e(s))}else{i(void 0)}}})})}function qk(t,e,i){t.on("error",n=>{if(!i?.isCancellationRequested){e.onError(n)}});t.on("end",()=>{if(!i?.isCancellationRequested){e.onEnd()}});t.on("data",n=>{if(!i?.isCancellationRequested){e.onData(n)}})}function W5(t,e){const i=Wk(e);i.end(t);return i}const yh=typeof Buffer!=="undefined";const z5=new Fn(()=>new Uint8Array(256));let p1;let g1;class ue{static alloc(e){if(yh){return new ue(Buffer.allocUnsafe(e))}else{return new ue(new Uint8Array(e))}}static wrap(e){if(yh&&!Buffer.isBuffer(e)){e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)}return new ue(e)}static fromString(e,i){const n=i?.dontUseNodeBuffer||false;if(!n&&yh){return new ue(Buffer.from(e))}else{if(!p1){p1=new TextEncoder}return new ue(p1.encode(e))}}static fromByteArray(e){const i=ue.alloc(e.length);for(let n=0,s=e.length;n<s;n++){i.buffer[n]=e[n]}return i}static concat(e,i){if(typeof i==="undefined"){i=0;for(let r=0,o=e.length;r<o;r++){i+=e[r].byteLength}}const n=ue.alloc(i);let s=0;for(let r=0,o=e.length;r<o;r++){const a=e[r];n.set(a,s);s+=a.byteLength}return n}constructor(e){this.buffer=e;this.byteLength=this.buffer.byteLength}clone(){const e=ue.alloc(this.byteLength);e.set(this);return e}toString(){if(yh){return this.buffer.toString()}else{if(!g1){g1=new TextDecoder}return g1.decode(this.buffer)}}slice(e,i){return new ue(this.buffer.subarray(e,i))}set(e,i){if(e instanceof ue){this.buffer.set(e.buffer,i)}else if(e instanceof Uint8Array){this.buffer.set(e,i)}else if(e instanceof ArrayBuffer){this.buffer.set(new Uint8Array(e),i)}else if(ArrayBuffer.isView(e)){this.buffer.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),i)}else{throw new Error(`Unknown argument 'array'`)}}readUInt32BE(e){return jh(this.buffer,e)}writeUInt32BE(e,i){Gh(this.buffer,e,i)}readUInt32LE(e){return K5(this.buffer,e)}writeUInt32LE(e,i){Q5(this.buffer,e,i)}readUInt8(e){return J5(this.buffer,e)}writeUInt8(e,i){X5(this.buffer,e,i)}indexOf(e,i=0){return q5(this.buffer,e instanceof ue?e.buffer:e,i)}equals(e){if(this===e){return true}if(this.byteLength!==e.byteLength){return false}return this.buffer.every((i,n)=>i===e.buffer[n])}}function q5(t,e,i=0){const n=e.byteLength;const s=t.byteLength;if(n===0){return 0}if(n===1){return t.indexOf(e[0])}if(n>s-i){return-1}const r=z5.value;r.fill(e.length);for(let c=0;c<e.length;c++){r[e[c]]=e.length-c-1}let o=i+e.length-1;let a=o;let l=-1;while(o<s){if(t[o]===e[a]){if(a===0){l=o;break}o--;a--}else{o+=Math.max(e.length-a,r[t[o]]);a=e.length-1}}return l}function j5(t,e){return t[e+0]<<0>>>0|t[e+1]<<8>>>0}function G5(t,e,i){t[i+0]=e&255;e=e>>>8;t[i+1]=e&255}function jh(t,e){return t[e]*2**24+t[e+1]*2**16+t[e+2]*2**8+t[e+3]}function Gh(t,e,i){t[i+3]=e;e=e>>>8;t[i+2]=e;e=e>>>8;t[i+1]=e;e=e>>>8;t[i]=e}function K5(t,e){return t[e+0]<<0>>>0|t[e+1]<<8>>>0|t[e+2]<<16>>>0|t[e+3]<<24>>>0}function Q5(t,e,i){t[i+0]=e&255;e=e>>>8;t[i+1]=e&255;e=e>>>8;t[i+2]=e&255;e=e>>>8;t[i+3]=e&255}function J5(t,e){return t[e]}function X5(t,e,i){t[i]=e}function Y5(t){return V5(t,e=>ue.concat(e))}function Z5(t){return zk(t,e=>ue.concat(e))}function eT(t){return W5(t,e=>ue.concat(e))}function Tf(t){let e=0;let i=0;let n=0;const s=new Uint8Array(Math.floor(t.length/4*3));const r=a=>{switch(i){case 3:s[n++]=e|a;i=0;break;case 2:s[n++]=e|a>>>2;e=a<<6;i=3;break;case 1:s[n++]=e|a>>>4;e=a<<4;i=2;break;default:e=a<<2;i=1}};for(let a=0;a<t.length;a++){const l=t.charCodeAt(a);if(l>=65&&l<=90){r(l-65)}else if(l>=97&&l<=122){r(l-97+26)}else if(l>=48&&l<=57){r(l-48+52)}else if(l===43||l===45){r(62)}else if(l===47||l===95){r(63)}else if(l===61){break}else{throw new SyntaxError(`Unexpected base64 character ${t[a]}`)}}const o=n;while(i>0){r(0)}return ue.wrap(s).slice(0,o)}const tT="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";const iT="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";function m0({buffer:t},e=true,i=false){const n=i?iT:tT;let s="";const r=t.byteLength%3;let o=0;for(;o<t.byteLength-r;o+=3){const a=t[o+0];const l=t[o+1];const c=t[o+2];s+=n[a>>>2];s+=n[(a<<4|l>>>4)&63];s+=n[(l<<2|c>>>6)&63];s+=n[c&63]}if(r===1){const a=t[o+0];s+=n[a>>>2];s+=n[a<<4&63];if(e){s+="=="}}else if(r===2){const a=t[o+0];const l=t[o+1];s+=n[a>>>2];s+=n[(a<<4|l>>>4)&63];s+=n[l<<2&63];if(e){s+="="}}return s}let Wt=class Kh{static{this.Undefined=new Kh(void 0)}constructor(e){this.element=e;this.next=Kh.Undefined;this.prev=Kh.Undefined}};class wo{constructor(){this._first=Wt.Undefined;this._last=Wt.Undefined;this._size=0}get size(){return this._size}isEmpty(){return this._first===Wt.Undefined}clear(){let e=this._first;while(e!==Wt.Undefined){const i=e.next;e.prev=Wt.Undefined;e.next=Wt.Undefined;e=i}this._first=Wt.Undefined;this._last=Wt.Undefined;this._size=0}unshift(e){return this._insert(e,false)}push(e){return this._insert(e,true)}_insert(e,i){const n=new Wt(e);if(this._first===Wt.Undefined){this._first=n;this._last=n}else if(i){const r=this._last;this._last=n;n.prev=r;r.next=n}else{const r=this._first;this._first=n;n.next=r;r.prev=n}this._size+=1;let s=false;return()=>{if(!s){s=true;this._remove(n)}}}shift(){if(this._first===Wt.Undefined){return void 0}else{const e=this._first.element;this._remove(this._first);return e}}pop(){if(this._last===Wt.Undefined){return void 0}else{const e=this._last.element;this._remove(this._last);return e}}_remove(e){if(e.prev!==Wt.Undefined&&e.next!==Wt.Undefined){const i=e.prev;i.next=e.next;e.next.prev=i}else if(e.prev===Wt.Undefined&&e.next===Wt.Undefined){this._first=Wt.Undefined;this._last=Wt.Undefined}else if(e.next===Wt.Undefined){this._last=this._last.prev;this._last.next=Wt.Undefined}else if(e.prev===Wt.Undefined){this._first=this._first.next;this._first.prev=Wt.Undefined}this._size-=1}*[Symbol.iterator](){let e=this._first;while(e!==Wt.Undefined){yield e.element;e=e.next}}}const nT=globalThis.performance.now.bind(globalThis.performance);class xr{static create(e){return new xr(e)}constructor(e){this._now=e===false?Date.now:nT;this._startTime=this._now();this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now();this._stopTime=-1}elapsed(){if(this._stopTime!==-1){return this._stopTime-this._startTime}return this._now()-this._startTime}}var Bt;(function(t){t.None=()=>Ee.None;function e(se,G){return p(se,()=>void 0,0,void 0,true,void 0,G)}t.defer=e;function i(se){return(G,ce=null,ie)=>{let _e=false;let be=void 0;be=se(Ke=>{if(_e){return}else if(be){be.dispose()}else{_e=true}return G.call(ce,Ke)},null,ie);if(_e){be.dispose()}return be}}t.once=i;function n(se,G){return t.once(t.filter(se,G))}t.onceIf=n;function s(se,G,ce){return u((ie,_e=null,be)=>se(Ke=>ie.call(_e,G(Ke)),null,be),ce)}t.map=s;function r(se,G,ce){return u((ie,_e=null,be)=>se(Ke=>{G(Ke);ie.call(_e,Ke)},null,be),ce)}t.forEach=r;function o(se,G,ce){return u((ie,_e=null,be)=>se(Ke=>G(Ke)&&ie.call(_e,Ke),null,be),ce)}t.filter=o;function a(se){return se}t.signal=a;function l(...se){return(G,ce=null,ie)=>{const _e=g0(...se.map(be=>be(Ke=>G.call(ce,Ke))));return d(_e,ie)}}t.any=l;function c(se,G,ce,ie){let _e=ce;return s(se,be=>{_e=G(_e,be);return _e},ie)}t.reduce=c;function u(se,G){let ce;const ie={onWillAddFirstListener(){ce=se(_e.fire,_e)},onDidRemoveLastListener(){ce?.dispose()}};const _e=new L(ie);G?.add(_e);return _e.event}function d(se,G){if(G instanceof Array){G.push(se)}else if(G){G.add(se)}return se}function p(se,G,ce=100,ie=false,_e=false,be,Ke){let Et;let Ue=void 0;let Gt=void 0;let Ri=0;let At;const dn={leakWarningThreshold:be,onWillAddFirstListener(){Et=se(Vt=>{Ri++;Ue=G(Ue,Vt);if(ie&&!Gt){bi.fire(Ue);Ue=void 0}At=()=>{const Cn=Ue;Ue=void 0;Gt=void 0;if(!ie||Ri>1){bi.fire(Cn)}Ri=0};if(typeof ce==="number"){clearTimeout(Gt);Gt=setTimeout(At,ce)}else{if(Gt===void 0){Gt=0;queueMicrotask(At)}}})},onWillRemoveListener(){if(_e&&Ri>0){At?.()}},onDidRemoveLastListener(){At=void 0;Et.dispose()}};const bi=new L(dn);Ke?.add(bi);return bi.event}t.debounce=p;function f(se,G=0,ce){return t.debounce(se,(ie,_e)=>{if(!ie){return[_e]}ie.push(_e);return ie},G,void 0,true,void 0,ce)}t.accumulate=f;function m(se,G=(ie,_e)=>ie===_e,ce){let ie=true;let _e;return o(se,be=>{const Ke=ie||!G(be,_e);ie=false;_e=be;return Ke},ce)}t.latch=m;function v(se,G,ce){return[t.filter(se,G,ce),t.filter(se,ie=>!G(ie),ce)]}t.split=v;function y(se,G=false,ce=[],ie){let _e=ce.slice();let be=se(Ue=>{if(_e){_e.push(Ue)}else{Et.fire(Ue)}});if(ie){ie.add(be)}const Ke=()=>{_e?.forEach(Ue=>Et.fire(Ue));_e=null};const Et=new L({onWillAddFirstListener(){if(!be){be=se(Ue=>Et.fire(Ue));if(ie){ie.add(be)}}},onDidAddFirstListener(){if(_e){if(G){setTimeout(Ke)}else{Ke()}}},onDidRemoveLastListener(){if(be){be.dispose()}be=null}});if(ie){ie.add(Et)}return Et.event}t.buffer=y;function D(se,G){const ce=(ie,_e,be)=>{const Ke=G(new R);return se(function(Et){const Ue=Ke.evaluate(Et);if(Ue!==I){ie.call(_e,Ue)}},void 0,be)};return ce}t.chain=D;const I=Symbol("HaltChainable");class R{constructor(){this.steps=[]}map(G){this.steps.push(G);return this}forEach(G){this.steps.push(ce=>{G(ce);return ce});return this}filter(G){this.steps.push(ce=>G(ce)?ce:I);return this}reduce(G,ce){let ie=ce;this.steps.push(_e=>{ie=G(ie,_e);return ie});return this}latch(G=(ce,ie)=>ce===ie){let ce=true;let ie;this.steps.push(_e=>{const be=ce||!G(_e,ie);ce=false;ie=_e;return be?_e:I});return this}evaluate(G){for(const ce of this.steps){G=ce(G);if(G===I){break}}return G}}function J(se,G,ce=ie=>ie){const ie=(...Et)=>Ke.fire(ce(...Et));const _e=()=>se.on(G,ie);const be=()=>se.removeListener(G,ie);const Ke=new L({onWillAddFirstListener:_e,onDidRemoveLastListener:be});return Ke.event}t.fromNodeEventEmitter=J;function H(se,G,ce=ie=>ie){const ie=(...Et)=>Ke.fire(ce(...Et));const _e=()=>se.addEventListener(G,ie);const be=()=>se.removeEventListener(G,ie);const Ke=new L({onWillAddFirstListener:_e,onDidRemoveLastListener:be});return Ke.event}t.fromDOMEventEmitter=H;function Q(se,G){return new Promise(ce=>i(se)(ce,null,G))}t.toPromise=Q;function ne(se){const G=new L;se.then(ce=>{G.fire(ce)},()=>{G.fire(void 0)}).finally(()=>{G.dispose()});return G.event}t.fromPromise=ne;function te(se,G){return se(ce=>G.fire(ce))}t.forward=te;function le(se,G,ce){G(ce);return se(ie=>G(ie))}t.runAndSubscribe=le;class Ce{constructor(G,ce){this._observable=G;this._counter=0;this._hasChanged=false;const ie={onWillAddFirstListener:()=>{G.addObserver(this);this._observable.reportChanges()},onDidRemoveLastListener:()=>{G.removeObserver(this)}};this.emitter=new L(ie);if(ce){ce.add(this.emitter)}}beginUpdate(G){this._counter++}handlePossibleChange(G){}handleChange(G,ce){this._hasChanged=true}endUpdate(G){this._counter--;if(this._counter===0){this._observable.reportChanges();if(this._hasChanged){this._hasChanged=false;this.emitter.fire(this._observable.get())}}}}function Je(se,G){const ce=new Ce(se,G);return ce.emitter.event}t.fromObservable=Je;function We(se){return(G,ce,ie)=>{let _e=0;let be=false;const Ke={beginUpdate(){_e++},endUpdate(){_e--;if(_e===0){se.reportChanges();if(be){be=false;G.call(ce)}}},handlePossibleChange(){},handleChange(){be=true}};se.addObserver(Ke);se.reportChanges();const Et={dispose(){se.removeObserver(Ke)}};if(ie instanceof Ie){ie.add(Et)}else if(Array.isArray(ie)){ie.push(Et)}return Et}}t.fromObservableLight=We})(Bt||(Bt={}));class Pf{static{this.all=new Set}static{this._idPool=0}constructor(e){this.listenerCount=0;this.invocationCount=0;this.elapsedOverall=0;this.durations=[];this.name=`${e}_${Pf._idPool++}`;Pf.all.add(this)}start(e){this._stopWatch=new xr;this.listenerCount=e}stop(){if(this._stopWatch){const e=this._stopWatch.elapsed();this.durations.push(e);this.elapsedOverall+=e;this.invocationCount+=1;this._stopWatch=void 0}}}let sT=-1;class _0{static{this._idPool=1}constructor(e,i,n=(_0._idPool++).toString(16).padStart(3,"0")){this._errorHandler=e;this.threshold=i;this.name=n;this._warnCountdown=0}dispose(){this._stacks?.clear()}check(e,i){const n=this.threshold;if(n<=0||i<n){return void 0}if(!this._stacks){this._stacks=new Map}const s=this._stacks.get(e.value)||0;this._stacks.set(e.value,s+1);this._warnCountdown-=1;if(this._warnCountdown<=0){this._warnCountdown=n*.5;const[r,o]=this.getMostFrequentStack();const a=`[${this.name}] potential listener LEAK detected, having ${i} listeners already. MOST frequent listener (${o}):`;console.warn(a);console.warn(r);const l=new rT(a,r);this._errorHandler(l)}return()=>{const r=this._stacks.get(e.value)||0;this._stacks.set(e.value,r-1)}}getMostFrequentStack(){if(!this._stacks){return void 0}let e;let i=0;for(const[n,s]of this._stacks){if(!e||i<s){e=[n,s];i=s}}return e}}class v0{static create(){const e=new Error;return new v0(e.stack??"")}constructor(e){this.value=e}print(){console.warn(this.value.split("\n").slice(2).join("\n"))}}class rT extends Error{constructor(e,i){super(e);this.name="ListenerLeakError";this.stack=i}}class oT extends Error{constructor(e,i){super(e);this.name="ListenerRefusalError";this.stack=i}}let aT=0;class Qh{constructor(e){this.value=e;this.id=aT++}}const lT=2;const cT=(t,e)=>{if(t instanceof Qh){e(t)}else{for(let i=0;i<t.length;i++){const n=t[i];if(n){e(n)}}}};class L{constructor(e){this._size=0;this._options=e;this._leakageMon=this._options?.leakWarningThreshold?new _0(e?.onListenerError??Pi,this._options?.leakWarningThreshold??sT):void 0;this._perfMon=this._options?._profName?new Pf(this._options._profName):void 0;this._deliveryQueue=this._options?.deliveryQueue}dispose(){if(!this._disposed){this._disposed=true;if(this._deliveryQueue?.current===this){this._deliveryQueue.reset()}if(this._listeners){this._listeners=void 0;this._size=0}this._options?.onDidRemoveLastListener?.();this._leakageMon?.dispose()}}get event(){this._event??=(e,i,n)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){const a=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(a);const l=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1];const c=new oT(`${a}. HINT: Stack shows most frequent listener (${l[1]}-times)`,l[0]);const u=this._options?.onListenerError||Pi;u(c);return Ee.None}if(this._disposed){return Ee.None}if(i){e=e.bind(i)}const s=new Qh(e);let r;if(this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)){s.stack=v0.create();r=this._leakageMon.check(s.stack,this._size+1)}if(!this._listeners){this._options?.onWillAddFirstListener?.(this);this._listeners=s;this._options?.onDidAddFirstListener?.(this)}else if(this._listeners instanceof Qh){this._deliveryQueue??=new uT;this._listeners=[this._listeners,s]}else{this._listeners.push(s)}this._options?.onDidAddListener?.(this);this._size++;const o=ge(()=>{r?.();this._removeListener(s)});if(n instanceof Ie){n.add(o)}else if(Array.isArray(n)){n.push(o)}return o};return this._event}_removeListener(e){this._options?.onWillRemoveListener?.(this);if(!this._listeners){return}if(this._size===1){this._listeners=void 0;this._options?.onDidRemoveLastListener?.(this);this._size=0;return}const i=this._listeners;const n=i.indexOf(e);if(n===-1){console.log("disposed?",this._disposed);console.log("size?",this._size);console.log("arr?",JSON.stringify(this._listeners));throw new Error("Attempted to dispose unknown listener")}this._size--;i[n]=void 0;const s=this._deliveryQueue.current===this;if(this._size*lT<=i.length){let r=0;for(let o=0;o<i.length;o++){if(i[o]){i[r++]=i[o]}else if(s&&r<this._deliveryQueue.end){this._deliveryQueue.end--;if(r<this._deliveryQueue.i){this._deliveryQueue.i--}}}i.length=r}}_deliver(e,i){if(!e){return}const n=this._options?.onListenerError||Pi;if(!n){e.value(i);return}try{e.value(i)}catch(s){n(s)}}_deliverQueue(e){const i=e.current._listeners;while(e.i<e.end){this._deliver(i[e.i++],e.value)}e.reset()}fire(e){if(this._deliveryQueue?.current){this._deliverQueue(this._deliveryQueue);this._perfMon?.stop()}this._perfMon?.start(this._size);if(!this._listeners);else if(this._listeners instanceof Qh){this._deliver(this._listeners,e)}else{const i=this._deliveryQueue;i.enqueue(this,e,this._listeners.length);this._deliverQueue(i)}this._perfMon?.stop()}hasListeners(){return this._size>0}}class uT{constructor(){this.i=-1;this.end=0}enqueue(e,i,n){this.i=0;this.end=n;this.current=e;this.value=i}reset(){this.i=this.end;this.current=void 0;this.value=void 0}}class hu extends L{async fireAsync(e,i,n){if(!this._listeners){return}if(!this._asyncDeliveryQueue){this._asyncDeliveryQueue=new wo}cT(this._listeners,s=>this._asyncDeliveryQueue.push([s.value,e]));while(this._asyncDeliveryQueue.size>0&&!i.isCancellationRequested){const[s,r]=this._asyncDeliveryQueue.shift();const o=[];const a={...r,token:i,waitUntil:l=>{if(Object.isFrozen(o)){throw new Error("waitUntil can NOT be called asynchronous")}if(n){l=n(l,s)}o.push(l)}};try{s(a)}catch(l){Pi(l);continue}await Promise.allSettled(o).then(l=>{for(const c of l){if(c.status==="rejected"){Pi(c.reason)}}})}}}class Af extends L{get isPaused(){return this._isPaused!==0}constructor(e){super(e);this._isPaused=0;this._eventQueue=new wo;this._mergeFn=e?.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused===0){if(this._mergeFn){if(this._eventQueue.size>0){const e=Array.from(this._eventQueue);this._eventQueue.clear();super.fire(this._mergeFn(e))}}else{while(!this._isPaused&&this._eventQueue.size!==0){super.fire(this._eventQueue.shift())}}}}fire(e){if(this._size){if(this._isPaused!==0){this._eventQueue.push(e)}else{super.fire(e)}}}}class dT extends Af{constructor(e){super(e);this._delay=e.delay??100}fire(e){if(!this._handle){this.pause();this._handle=setTimeout(()=>{this._handle=void 0;this.resume()},this._delay)}super.fire(e)}}class hT extends L{constructor(e){super(e);this._queuedEvents=[];this._mergeFn=e?.merge}fire(e){if(!this.hasListeners()){return}this._queuedEvents.push(e);if(this._queuedEvents.length===1){queueMicrotask(()=>{if(this._mergeFn){super.fire(this._mergeFn(this._queuedEvents))}else{this._queuedEvents.forEach(i=>super.fire(i))}this._queuedEvents=[]})}}}var Wu;(function(t){t[t["Desktop"]=1]="Desktop";t[t["Web"]=2]="Web"})(Wu||(Wu={}));var Xy;(function(t){t[t["VersionMismatch"]=55]="VersionMismatch";t[t["UnexpectedError"]=81]="UnexpectedError"})(Xy||(Xy={}));var rs;(function(t){t[t["Initialized"]=0]="Initialized";t[t["Ready"]=1]="Ready";t[t["Terminate"]=2]="Terminate"})(rs||(rs={}));function Yy(t){const e=ue.alloc(1);switch(t){case rs.Initialized:e.writeUInt8(1,0);break;case rs.Ready:e.writeUInt8(2,0);break;case rs.Terminate:e.writeUInt8(3,0);break}return e}function fT(t,e){if(t.byteLength!==1){return false}switch(t.readUInt8(0)){case 1:return e===rs.Initialized;case 2:return e===rs.Ready;case 3:return e===rs.Terminate;default:return false}}var Zy;(function(t){t["Start"]="START_NATIVE_LOG";t["End"]="END_NATIVE_LOG"})(Zy||(Zy={}));function m1(t){const e=[];if(typeof t==="number"){e.push("code/timeOrigin",t)}function i(s,r){e.push(s,r?.startTime??Date.now())}function n(){const s=[];for(let r=0;r<e.length;r+=2){s.push({name:e[r],startTime:e[r+1]})}return s}return{mark:i,getMarks:n}}function pT(){if(typeof performance==="object"&&typeof performance.mark==="function"&&!performance.nodeTiming){if(typeof performance.timeOrigin!=="number"&&!performance.timing){return m1()}else{return{mark(t,e){performance.mark(t,e)},getMarks(){let t=performance.timeOrigin;if(typeof t!=="number"){t=performance.timing.navigationStart||performance.timing.redirectStart||performance.timing.fetchStart}const e=[{name:"code/timeOrigin",startTime:Math.round(t)}];for(const i of performance.getEntriesByType("mark")){e.push({name:i.name,startTime:Math.round(t+i.startTime)})}return e}}}}else if(typeof process==="object"){const t=performance?.timeOrigin;return m1(t)}else{console.trace("perf-util loaded in UNKNOWN environment");return m1()}}function gT(t){if(!t.MonacoPerformanceMarks){t.MonacoPerformanceMarks=pT()}return t.MonacoPerformanceMarks}const jk=gT(globalThis);const Qi=jk.mark;const mT=jk.getMarks;var A;(function(t){t[t["Null"]=0]="Null";t[t["Backspace"]=8]="Backspace";t[t["Tab"]=9]="Tab";t[t["LineFeed"]=10]="LineFeed";t[t["CarriageReturn"]=13]="CarriageReturn";t[t["Space"]=32]="Space";t[t["ExclamationMark"]=33]="ExclamationMark";t[t["DoubleQuote"]=34]="DoubleQuote";t[t["Hash"]=35]="Hash";t[t["DollarSign"]=36]="DollarSign";t[t["PercentSign"]=37]="PercentSign";t[t["Ampersand"]=38]="Ampersand";t[t["SingleQuote"]=39]="SingleQuote";t[t["OpenParen"]=40]="OpenParen";t[t["CloseParen"]=41]="CloseParen";t[t["Asterisk"]=42]="Asterisk";t[t["Plus"]=43]="Plus";t[t["Comma"]=44]="Comma";t[t["Dash"]=45]="Dash";t[t["Period"]=46]="Period";t[t["Slash"]=47]="Slash";t[t["Digit0"]=48]="Digit0";t[t["Digit1"]=49]="Digit1";t[t["Digit2"]=50]="Digit2";t[t["Digit3"]=51]="Digit3";t[t["Digit4"]=52]="Digit4";t[t["Digit5"]=53]="Digit5";t[t["Digit6"]=54]="Digit6";t[t["Digit7"]=55]="Digit7";t[t["Digit8"]=56]="Digit8";t[t["Digit9"]=57]="Digit9";t[t["Colon"]=58]="Colon";t[t["Semicolon"]=59]="Semicolon";t[t["LessThan"]=60]="LessThan";t[t["Equals"]=61]="Equals";t[t["GreaterThan"]=62]="GreaterThan";t[t["QuestionMark"]=63]="QuestionMark";t[t["AtSign"]=64]="AtSign";t[t["A"]=65]="A";t[t["B"]=66]="B";t[t["C"]=67]="C";t[t["D"]=68]="D";t[t["E"]=69]="E";t[t["F"]=70]="F";t[t["G"]=71]="G";t[t["H"]=72]="H";t[t["I"]=73]="I";t[t["J"]=74]="J";t[t["K"]=75]="K";t[t["L"]=76]="L";t[t["M"]=77]="M";t[t["N"]=78]="N";t[t["O"]=79]="O";t[t["P"]=80]="P";t[t["Q"]=81]="Q";t[t["R"]=82]="R";t[t["S"]=83]="S";t[t["T"]=84]="T";t[t["U"]=85]="U";t[t["V"]=86]="V";t[t["W"]=87]="W";t[t["X"]=88]="X";t[t["Y"]=89]="Y";t[t["Z"]=90]="Z";t[t["OpenSquareBracket"]=91]="OpenSquareBracket";t[t["Backslash"]=92]="Backslash";t[t["CloseSquareBracket"]=93]="CloseSquareBracket";t[t["Caret"]=94]="Caret";t[t["Underline"]=95]="Underline";t[t["BackTick"]=96]="BackTick";t[t["a"]=97]="a";t[t["b"]=98]="b";t[t["c"]=99]="c";t[t["d"]=100]="d";t[t["e"]=101]="e";t[t["f"]=102]="f";t[t["g"]=103]="g";t[t["h"]=104]="h";t[t["i"]=105]="i";t[t["j"]=106]="j";t[t["k"]=107]="k";t[t["l"]=108]="l";t[t["m"]=109]="m";t[t["n"]=110]="n";t[t["o"]=111]="o";t[t["p"]=112]="p";t[t["q"]=113]="q";t[t["r"]=114]="r";t[t["s"]=115]="s";t[t["t"]=116]="t";t[t["u"]=117]="u";t[t["v"]=118]="v";t[t["w"]=119]="w";t[t["x"]=120]="x";t[t["y"]=121]="y";t[t["z"]=122]="z";t[t["OpenCurlyBrace"]=123]="OpenCurlyBrace";t[t["Pipe"]=124]="Pipe";t[t["CloseCurlyBrace"]=125]="CloseCurlyBrace";t[t["Tilde"]=126]="Tilde";t[t["NoBreakSpace"]=160]="NoBreakSpace";t[t["U_Combining_Grave_Accent"]=768]="U_Combining_Grave_Accent";t[t["U_Combining_Acute_Accent"]=769]="U_Combining_Acute_Accent";t[t["U_Combining_Circumflex_Accent"]=770]="U_Combining_Circumflex_Accent";t[t["U_Combining_Tilde"]=771]="U_Combining_Tilde";t[t["U_Combining_Macron"]=772]="U_Combining_Macron";t[t["U_Combining_Overline"]=773]="U_Combining_Overline";t[t["U_Combining_Breve"]=774]="U_Combining_Breve";t[t["U_Combining_Dot_Above"]=775]="U_Combining_Dot_Above";t[t["U_Combining_Diaeresis"]=776]="U_Combining_Diaeresis";t[t["U_Combining_Hook_Above"]=777]="U_Combining_Hook_Above";t[t["U_Combining_Ring_Above"]=778]="U_Combining_Ring_Above";t[t["U_Combining_Double_Acute_Accent"]=779]="U_Combining_Double_Acute_Accent";t[t["U_Combining_Caron"]=780]="U_Combining_Caron";t[t["U_Combining_Vertical_Line_Above"]=781]="U_Combining_Vertical_Line_Above";t[t["U_Combining_Double_Vertical_Line_Above"]=782]="U_Combining_Double_Vertical_Line_Above";t[t["U_Combining_Double_Grave_Accent"]=783]="U_Combining_Double_Grave_Accent";t[t["U_Combining_Candrabindu"]=784]="U_Combining_Candrabindu";t[t["U_Combining_Inverted_Breve"]=785]="U_Combining_Inverted_Breve";t[t["U_Combining_Turned_Comma_Above"]=786]="U_Combining_Turned_Comma_Above";t[t["U_Combining_Comma_Above"]=787]="U_Combining_Comma_Above";t[t["U_Combining_Reversed_Comma_Above"]=788]="U_Combining_Reversed_Comma_Above";t[t["U_Combining_Comma_Above_Right"]=789]="U_Combining_Comma_Above_Right";t[t["U_Combining_Grave_Accent_Below"]=790]="U_Combining_Grave_Accent_Below";t[t["U_Combining_Acute_Accent_Below"]=791]="U_Combining_Acute_Accent_Below";t[t["U_Combining_Left_Tack_Below"]=792]="U_Combining_Left_Tack_Below";t[t["U_Combining_Right_Tack_Below"]=793]="U_Combining_Right_Tack_Below";t[t["U_Combining_Left_Angle_Above"]=794]="U_Combining_Left_Angle_Above";t[t["U_Combining_Horn"]=795]="U_Combining_Horn";t[t["U_Combining_Left_Half_Ring_Below"]=796]="U_Combining_Left_Half_Ring_Below";t[t["U_Combining_Up_Tack_Below"]=797]="U_Combining_Up_Tack_Below";t[t["U_Combining_Down_Tack_Below"]=798]="U_Combining_Down_Tack_Below";t[t["U_Combining_Plus_Sign_Below"]=799]="U_Combining_Plus_Sign_Below";t[t["U_Combining_Minus_Sign_Below"]=800]="U_Combining_Minus_Sign_Below";t[t["U_Combining_Palatalized_Hook_Below"]=801]="U_Combining_Palatalized_Hook_Below";t[t["U_Combining_Retroflex_Hook_Below"]=802]="U_Combining_Retroflex_Hook_Below";t[t["U_Combining_Dot_Below"]=803]="U_Combining_Dot_Below";t[t["U_Combining_Diaeresis_Below"]=804]="U_Combining_Diaeresis_Below";t[t["U_Combining_Ring_Below"]=805]="U_Combining_Ring_Below";t[t["U_Combining_Comma_Below"]=806]="U_Combining_Comma_Below";t[t["U_Combining_Cedilla"]=807]="U_Combining_Cedilla";t[t["U_Combining_Ogonek"]=808]="U_Combining_Ogonek";t[t["U_Combining_Vertical_Line_Below"]=809]="U_Combining_Vertical_Line_Below";t[t["U_Combining_Bridge_Below"]=810]="U_Combining_Bridge_Below";t[t["U_Combining_Inverted_Double_Arch_Below"]=811]="U_Combining_Inverted_Double_Arch_Below";t[t["U_Combining_Caron_Below"]=812]="U_Combining_Caron_Below";t[t["U_Combining_Circumflex_Accent_Below"]=813]="U_Combining_Circumflex_Accent_Below";t[t["U_Combining_Breve_Below"]=814]="U_Combining_Breve_Below";t[t["U_Combining_Inverted_Breve_Below"]=815]="U_Combining_Inverted_Breve_Below";t[t["U_Combining_Tilde_Below"]=816]="U_Combining_Tilde_Below";t[t["U_Combining_Macron_Below"]=817]="U_Combining_Macron_Below";t[t["U_Combining_Low_Line"]=818]="U_Combining_Low_Line";t[t["U_Combining_Double_Low_Line"]=819]="U_Combining_Double_Low_Line";t[t["U_Combining_Tilde_Overlay"]=820]="U_Combining_Tilde_Overlay";t[t["U_Combining_Short_Stroke_Overlay"]=821]="U_Combining_Short_Stroke_Overlay";t[t["U_Combining_Long_Stroke_Overlay"]=822]="U_Combining_Long_Stroke_Overlay";t[t["U_Combining_Short_Solidus_Overlay"]=823]="U_Combining_Short_Solidus_Overlay";t[t["U_Combining_Long_Solidus_Overlay"]=824]="U_Combining_Long_Solidus_Overlay";t[t["U_Combining_Right_Half_Ring_Below"]=825]="U_Combining_Right_Half_Ring_Below";t[t["U_Combining_Inverted_Bridge_Below"]=826]="U_Combining_Inverted_Bridge_Below";t[t["U_Combining_Square_Below"]=827]="U_Combining_Square_Below";t[t["U_Combining_Seagull_Below"]=828]="U_Combining_Seagull_Below";t[t["U_Combining_X_Above"]=829]="U_Combining_X_Above";t[t["U_Combining_Vertical_Tilde"]=830]="U_Combining_Vertical_Tilde";t[t["U_Combining_Double_Overline"]=831]="U_Combining_Double_Overline";t[t["U_Combining_Grave_Tone_Mark"]=832]="U_Combining_Grave_Tone_Mark";t[t["U_Combining_Acute_Tone_Mark"]=833]="U_Combining_Acute_Tone_Mark";t[t["U_Combining_Greek_Perispomeni"]=834]="U_Combining_Greek_Perispomeni";t[t["U_Combining_Greek_Koronis"]=835]="U_Combining_Greek_Koronis";t[t["U_Combining_Greek_Dialytika_Tonos"]=836]="U_Combining_Greek_Dialytika_Tonos";t[t["U_Combining_Greek_Ypogegrammeni"]=837]="U_Combining_Greek_Ypogegrammeni";t[t["U_Combining_Bridge_Above"]=838]="U_Combining_Bridge_Above";t[t["U_Combining_Equals_Sign_Below"]=839]="U_Combining_Equals_Sign_Below";t[t["U_Combining_Double_Vertical_Line_Below"]=840]="U_Combining_Double_Vertical_Line_Below";t[t["U_Combining_Left_Angle_Below"]=841]="U_Combining_Left_Angle_Below";t[t["U_Combining_Not_Tilde_Above"]=842]="U_Combining_Not_Tilde_Above";t[t["U_Combining_Homothetic_Above"]=843]="U_Combining_Homothetic_Above";t[t["U_Combining_Almost_Equal_To_Above"]=844]="U_Combining_Almost_Equal_To_Above";t[t["U_Combining_Left_Right_Arrow_Below"]=845]="U_Combining_Left_Right_Arrow_Below";t[t["U_Combining_Upwards_Arrow_Below"]=846]="U_Combining_Upwards_Arrow_Below";t[t["U_Combining_Grapheme_Joiner"]=847]="U_Combining_Grapheme_Joiner";t[t["U_Combining_Right_Arrowhead_Above"]=848]="U_Combining_Right_Arrowhead_Above";t[t["U_Combining_Left_Half_Ring_Above"]=849]="U_Combining_Left_Half_Ring_Above";t[t["U_Combining_Fermata"]=850]="U_Combining_Fermata";t[t["U_Combining_X_Below"]=851]="U_Combining_X_Below";t[t["U_Combining_Left_Arrowhead_Below"]=852]="U_Combining_Left_Arrowhead_Below";t[t["U_Combining_Right_Arrowhead_Below"]=853]="U_Combining_Right_Arrowhead_Below";t[t["U_Combining_Right_Arrowhead_And_Up_Arrowhead_Below"]=854]="U_Combining_Right_Arrowhead_And_Up_Arrowhead_Below";t[t["U_Combining_Right_Half_Ring_Above"]=855]="U_Combining_Right_Half_Ring_Above";t[t["U_Combining_Dot_Above_Right"]=856]="U_Combining_Dot_Above_Right";t[t["U_Combining_Asterisk_Below"]=857]="U_Combining_Asterisk_Below";t[t["U_Combining_Double_Ring_Below"]=858]="U_Combining_Double_Ring_Below";t[t["U_Combining_Zigzag_Above"]=859]="U_Combining_Zigzag_Above";t[t["U_Combining_Double_Breve_Below"]=860]="U_Combining_Double_Breve_Below";t[t["U_Combining_Double_Breve"]=861]="U_Combining_Double_Breve";t[t["U_Combining_Double_Macron"]=862]="U_Combining_Double_Macron";t[t["U_Combining_Double_Macron_Below"]=863]="U_Combining_Double_Macron_Below";t[t["U_Combining_Double_Tilde"]=864]="U_Combining_Double_Tilde";t[t["U_Combining_Double_Inverted_Breve"]=865]="U_Combining_Double_Inverted_Breve";t[t["U_Combining_Double_Rightwards_Arrow_Below"]=866]="U_Combining_Double_Rightwards_Arrow_Below";t[t["U_Combining_Latin_Small_Letter_A"]=867]="U_Combining_Latin_Small_Letter_A";t[t["U_Combining_Latin_Small_Letter_E"]=868]="U_Combining_Latin_Small_Letter_E";t[t["U_Combining_Latin_Small_Letter_I"]=869]="U_Combining_Latin_Small_Letter_I";t[t["U_Combining_Latin_Small_Letter_O"]=870]="U_Combining_Latin_Small_Letter_O";t[t["U_Combining_Latin_Small_Letter_U"]=871]="U_Combining_Latin_Small_Letter_U";t[t["U_Combining_Latin_Small_Letter_C"]=872]="U_Combining_Latin_Small_Letter_C";t[t["U_Combining_Latin_Small_Letter_D"]=873]="U_Combining_Latin_Small_Letter_D";t[t["U_Combining_Latin_Small_Letter_H"]=874]="U_Combining_Latin_Small_Letter_H";t[t["U_Combining_Latin_Small_Letter_M"]=875]="U_Combining_Latin_Small_Letter_M";t[t["U_Combining_Latin_Small_Letter_R"]=876]="U_Combining_Latin_Small_Letter_R";t[t["U_Combining_Latin_Small_Letter_T"]=877]="U_Combining_Latin_Small_Letter_T";t[t["U_Combining_Latin_Small_Letter_V"]=878]="U_Combining_Latin_Small_Letter_V";t[t["U_Combining_Latin_Small_Letter_X"]=879]="U_Combining_Latin_Small_Letter_X";t[t["LINE_SEPARATOR"]=8232]="LINE_SEPARATOR";t[t["PARAGRAPH_SEPARATOR"]=8233]="PARAGRAPH_SEPARATOR";t[t["NEXT_LINE"]=133]="NEXT_LINE";t[t["U_CIRCUMFLEX"]=94]="U_CIRCUMFLEX";t[t["U_GRAVE_ACCENT"]=96]="U_GRAVE_ACCENT";t[t["U_DIAERESIS"]=168]="U_DIAERESIS";t[t["U_MACRON"]=175]="U_MACRON";t[t["U_ACUTE_ACCENT"]=180]="U_ACUTE_ACCENT";t[t["U_CEDILLA"]=184]="U_CEDILLA";t[t["U_MODIFIER_LETTER_LEFT_ARROWHEAD"]=706]="U_MODIFIER_LETTER_LEFT_ARROWHEAD";t[t["U_MODIFIER_LETTER_RIGHT_ARROWHEAD"]=707]="U_MODIFIER_LETTER_RIGHT_ARROWHEAD";t[t["U_MODIFIER_LETTER_UP_ARROWHEAD"]=708]="U_MODIFIER_LETTER_UP_ARROWHEAD";t[t["U_MODIFIER_LETTER_DOWN_ARROWHEAD"]=709]="U_MODIFIER_LETTER_DOWN_ARROWHEAD";t[t["U_MODIFIER_LETTER_CENTRED_RIGHT_HALF_RING"]=722]="U_MODIFIER_LETTER_CENTRED_RIGHT_HALF_RING";t[t["U_MODIFIER_LETTER_CENTRED_LEFT_HALF_RING"]=723]="U_MODIFIER_LETTER_CENTRED_LEFT_HALF_RING";t[t["U_MODIFIER_LETTER_UP_TACK"]=724]="U_MODIFIER_LETTER_UP_TACK";t[t["U_MODIFIER_LETTER_DOWN_TACK"]=725]="U_MODIFIER_LETTER_DOWN_TACK";t[t["U_MODIFIER_LETTER_PLUS_SIGN"]=726]="U_MODIFIER_LETTER_PLUS_SIGN";t[t["U_MODIFIER_LETTER_MINUS_SIGN"]=727]="U_MODIFIER_LETTER_MINUS_SIGN";t[t["U_BREVE"]=728]="U_BREVE";t[t["U_DOT_ABOVE"]=729]="U_DOT_ABOVE";t[t["U_RING_ABOVE"]=730]="U_RING_ABOVE";t[t["U_OGONEK"]=731]="U_OGONEK";t[t["U_SMALL_TILDE"]=732]="U_SMALL_TILDE";t[t["U_DOUBLE_ACUTE_ACCENT"]=733]="U_DOUBLE_ACUTE_ACCENT";t[t["U_MODIFIER_LETTER_RHOTIC_HOOK"]=734]="U_MODIFIER_LETTER_RHOTIC_HOOK";t[t["U_MODIFIER_LETTER_CROSS_ACCENT"]=735]="U_MODIFIER_LETTER_CROSS_ACCENT";t[t["U_MODIFIER_LETTER_EXTRA_HIGH_TONE_BAR"]=741]="U_MODIFIER_LETTER_EXTRA_HIGH_TONE_BAR";t[t["U_MODIFIER_LETTER_HIGH_TONE_BAR"]=742]="U_MODIFIER_LETTER_HIGH_TONE_BAR";t[t["U_MODIFIER_LETTER_MID_TONE_BAR"]=743]="U_MODIFIER_LETTER_MID_TONE_BAR";t[t["U_MODIFIER_LETTER_LOW_TONE_BAR"]=744]="U_MODIFIER_LETTER_LOW_TONE_BAR";t[t["U_MODIFIER_LETTER_EXTRA_LOW_TONE_BAR"]=745]="U_MODIFIER_LETTER_EXTRA_LOW_TONE_BAR";t[t["U_MODIFIER_LETTER_YIN_DEPARTING_TONE_MARK"]=746]="U_MODIFIER_LETTER_YIN_DEPARTING_TONE_MARK";t[t["U_MODIFIER_LETTER_YANG_DEPARTING_TONE_MARK"]=747]="U_MODIFIER_LETTER_YANG_DEPARTING_TONE_MARK";t[t["U_MODIFIER_LETTER_UNASPIRATED"]=749]="U_MODIFIER_LETTER_UNASPIRATED";t[t["U_MODIFIER_LETTER_LOW_DOWN_ARROWHEAD"]=751]="U_MODIFIER_LETTER_LOW_DOWN_ARROWHEAD";t[t["U_MODIFIER_LETTER_LOW_UP_ARROWHEAD"]=752]="U_MODIFIER_LETTER_LOW_UP_ARROWHEAD";t[t["U_MODIFIER_LETTER_LOW_LEFT_ARROWHEAD"]=753]="U_MODIFIER_LETTER_LOW_LEFT_ARROWHEAD";t[t["U_MODIFIER_LETTER_LOW_RIGHT_ARROWHEAD"]=754]="U_MODIFIER_LETTER_LOW_RIGHT_ARROWHEAD";t[t["U_MODIFIER_LETTER_LOW_RING"]=755]="U_MODIFIER_LETTER_LOW_RING";t[t["U_MODIFIER_LETTER_MIDDLE_GRAVE_ACCENT"]=756]="U_MODIFIER_LETTER_MIDDLE_GRAVE_ACCENT";t[t["U_MODIFIER_LETTER_MIDDLE_DOUBLE_GRAVE_ACCENT"]=757]="U_MODIFIER_LETTER_MIDDLE_DOUBLE_GRAVE_ACCENT";t[t["U_MODIFIER_LETTER_MIDDLE_DOUBLE_ACUTE_ACCENT"]=758]="U_MODIFIER_LETTER_MIDDLE_DOUBLE_ACUTE_ACCENT";t[t["U_MODIFIER_LETTER_LOW_TILDE"]=759]="U_MODIFIER_LETTER_LOW_TILDE";t[t["U_MODIFIER_LETTER_RAISED_COLON"]=760]="U_MODIFIER_LETTER_RAISED_COLON";t[t["U_MODIFIER_LETTER_BEGIN_HIGH_TONE"]=761]="U_MODIFIER_LETTER_BEGIN_HIGH_TONE";t[t["U_MODIFIER_LETTER_END_HIGH_TONE"]=762]="U_MODIFIER_LETTER_END_HIGH_TONE";t[t["U_MODIFIER_LETTER_BEGIN_LOW_TONE"]=763]="U_MODIFIER_LETTER_BEGIN_LOW_TONE";t[t["U_MODIFIER_LETTER_END_LOW_TONE"]=764]="U_MODIFIER_LETTER_END_LOW_TONE";t[t["U_MODIFIER_LETTER_SHELF"]=765]="U_MODIFIER_LETTER_SHELF";t[t["U_MODIFIER_LETTER_OPEN_SHELF"]=766]="U_MODIFIER_LETTER_OPEN_SHELF";t[t["U_MODIFIER_LETTER_LOW_LEFT_ARROW"]=767]="U_MODIFIER_LETTER_LOW_LEFT_ARROW";t[t["U_GREEK_LOWER_NUMERAL_SIGN"]=885]="U_GREEK_LOWER_NUMERAL_SIGN";t[t["U_GREEK_TONOS"]=900]="U_GREEK_TONOS";t[t["U_GREEK_DIALYTIKA_TONOS"]=901]="U_GREEK_DIALYTIKA_TONOS";t[t["U_GREEK_KORONIS"]=8125]="U_GREEK_KORONIS";t[t["U_GREEK_PSILI"]=8127]="U_GREEK_PSILI";t[t["U_GREEK_PERISPOMENI"]=8128]="U_GREEK_PERISPOMENI";t[t["U_GREEK_DIALYTIKA_AND_PERISPOMENI"]=8129]="U_GREEK_DIALYTIKA_AND_PERISPOMENI";t[t["U_GREEK_PSILI_AND_VARIA"]=8141]="U_GREEK_PSILI_AND_VARIA";t[t["U_GREEK_PSILI_AND_OXIA"]=8142]="U_GREEK_PSILI_AND_OXIA";t[t["U_GREEK_PSILI_AND_PERISPOMENI"]=8143]="U_GREEK_PSILI_AND_PERISPOMENI";t[t["U_GREEK_DASIA_AND_VARIA"]=8157]="U_GREEK_DASIA_AND_VARIA";t[t["U_GREEK_DASIA_AND_OXIA"]=8158]="U_GREEK_DASIA_AND_OXIA";t[t["U_GREEK_DASIA_AND_PERISPOMENI"]=8159]="U_GREEK_DASIA_AND_PERISPOMENI";t[t["U_GREEK_DIALYTIKA_AND_VARIA"]=8173]="U_GREEK_DIALYTIKA_AND_VARIA";t[t["U_GREEK_DIALYTIKA_AND_OXIA"]=8174]="U_GREEK_DIALYTIKA_AND_OXIA";t[t["U_GREEK_VARIA"]=8175]="U_GREEK_VARIA";t[t["U_GREEK_OXIA"]=8189]="U_GREEK_OXIA";t[t["U_GREEK_DASIA"]=8190]="U_GREEK_DASIA";t[t["U_IDEOGRAPHIC_FULL_STOP"]=12290]="U_IDEOGRAPHIC_FULL_STOP";t[t["U_LEFT_CORNER_BRACKET"]=12300]="U_LEFT_CORNER_BRACKET";t[t["U_RIGHT_CORNER_BRACKET"]=12301]="U_RIGHT_CORNER_BRACKET";t[t["U_LEFT_BLACK_LENTICULAR_BRACKET"]=12304]="U_LEFT_BLACK_LENTICULAR_BRACKET";t[t["U_RIGHT_BLACK_LENTICULAR_BRACKET"]=12305]="U_RIGHT_BLACK_LENTICULAR_BRACKET";t[t["U_OVERLINE"]=8254]="U_OVERLINE";t[t["UTF8_BOM"]=65279]="UTF8_BOM";t[t["U_FULLWIDTH_SEMICOLON"]=65307]="U_FULLWIDTH_SEMICOLON";t[t["U_FULLWIDTH_COMMA"]=65292]="U_FULLWIDTH_COMMA"})(A||(A={}));var it;(function(t){t[t["Uri"]=1]="Uri";t[t["Regexp"]=2]="Regexp";t[t["ScmResource"]=3]="ScmResource";t[t["ScmResourceGroup"]=4]="ScmResourceGroup";t[t["ScmProvider"]=5]="ScmProvider";t[t["CommentController"]=6]="CommentController";t[t["CommentThread"]=7]="CommentThread";t[t["CommentThreadInstance"]=8]="CommentThreadInstance";t[t["CommentThreadReply"]=9]="CommentThreadReply";t[t["CommentNode"]=10]="CommentNode";t[t["CommentThreadNode"]=11]="CommentThreadNode";t[t["TimelineActionContext"]=12]="TimelineActionContext";t[t["NotebookCellActionContext"]=13]="NotebookCellActionContext";t[t["NotebookActionContext"]=14]="NotebookActionContext";t[t["TerminalContext"]=15]="TerminalContext";t[t["TestItemContext"]=16]="TestItemContext";t[t["Date"]=17]="Date";t[t["TestMessageMenuArgs"]=18]="TestMessageMenuArgs";t[t["ChatViewContext"]=19]="ChatViewContext";t[t["LanguageModelToolResult"]=20]="LanguageModelToolResult";t[t["LanguageModelTextPart"]=21]="LanguageModelTextPart";t[t["LanguageModelPromptTsxPart"]=22]="LanguageModelPromptTsxPart";t[t["LanguageModelDataPart"]=23]="LanguageModelDataPart";t[t["LanguageModelExtraDataPart"]=24]="LanguageModelExtraDataPart"})(it||(it={}));function _T(){return globalThis._VSCODE_NLS_MESSAGES}function Gk(){return globalThis._VSCODE_NLS_LANGUAGE}const vT=Gk()==="pseudo"||typeof document!=="undefined"&&document.location&&typeof document.location.hash==="string"&&document.location.hash.indexOf("pseudo=true")>=0;function Rf(t,e){let i;if(e.length===0){i=t}else{i=t.replace(/\{(\d+)\}/g,(n,s)=>{const r=s[0];const o=e[r];let a=n;if(typeof o==="string"){a=o}else if(typeof o==="number"||typeof o==="boolean"||o===void 0||o===null){a=String(o)}return a})}if(vT){i=""+i.replace(/[aouei]/g,"$&$&")+""}return i}function h(t,e,...i){if(typeof t==="number"){return Rf(Kk(t,e),i)}return Rf(e,i)}function Kk(t,e){const i=_T()?.[t];if(typeof i!=="string"){if(typeof e==="string"){return e}throw new Error(`!!! NLS MISSING: ${t} !!!`)}return i}function gm(t,e,...i){let n;if(typeof t==="number"){n=Kk(t,e)}else{n=e}const s=Rf(n,i);return{value:s,original:e===n?s:Rf(e,i)}}const to="en";let zu=false;let qu=false;let fu=false;let Qk=false;let w0=false;let b0=false;let Jk=false;let Xk=false;let xh=void 0;let Jh=to;let ex=to;let wT=void 0;let Qs=void 0;const _r=globalThis;let _n=void 0;if(typeof _r.vscode!=="undefined"&&typeof _r.vscode.process!=="undefined"){_n=_r.vscode.process}else if(typeof process!=="undefined"&&typeof process?.versions?.node==="string"){_n=process}const bT=typeof _n?.versions?.electron==="string";const yT=bT&&_n?.type==="renderer";if(typeof _n==="object"){zu=_n.platform==="win32";qu=_n.platform==="darwin";fu=_n.platform==="linux";fu&&!!_n.env["SNAP"]&&!!_n.env["SNAP_REVISION"];Jk=!!_n.env["CI"]||!!_n.env["BUILD_ARTIFACTSTAGINGDIRECTORY"];xh=to;Jh=to;const t=_n.env["VSCODE_NLS_CONFIG"];if(t){try{const e=JSON.parse(t);xh=e.userLocale;ex=e.osLocale;Jh=e.resolvedLanguage||to;wT=e.languagePack?.translationsConfigFile}catch(e){}}Qk=true}else if(typeof navigator==="object"&&!yT){Qs=navigator.userAgent;zu=Qs.indexOf("Windows")>=0;qu=Qs.indexOf("Macintosh")>=0;b0=(Qs.indexOf("Macintosh")>=0||Qs.indexOf("iPad")>=0||Qs.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0;fu=Qs.indexOf("Linux")>=0;Xk=Qs?.indexOf("Mobi")>=0;w0=true;Jh=Gk()||to;xh=navigator.language.toLowerCase();ex=xh}else{console.error("Unable to resolve platform.")}var is;(function(t){t[t["Web"]=0]="Web";t[t["Mac"]=1]="Mac";t[t["Linux"]=2]="Linux";t[t["Windows"]=3]="Windows"})(is||(is={}));function xT(t){switch(t){case is.Web:return"Web";case is.Mac:return"Mac";case is.Linux:return"Linux";case is.Windows:return"Windows"}}is.Web;if(qu){is.Mac}else if(zu){is.Windows}else if(fu){is.Linux}const Yi=zu;const Dn=qu;const Er=fu;const Yk=Qk;const oh=w0;const ju=w0&&typeof _r.importScripts==="function";const ET=ju?_r.origin:void 0;const ST=b0;const DT=Xk;const So=Jk;const Os=Qs;const Rr=Jh;var tx;(function(t){function e(){return Rr}t.value=e;function i(){if(Rr.length===2){return Rr==="en"}else if(Rr.length>=3){return Rr[0]==="e"&&Rr[1]==="n"&&Rr[2]==="-"}else{return false}}t.isDefaultVariant=i;function n(){return Rr==="en"}t.isDefault=n})(tx||(tx={}));const kT=typeof _r.postMessage==="function"&&!_r.importScripts;const Zk=(()=>{if(kT){const t=[];_r.addEventListener("message",i=>{if(i.data&&i.data.vscodeScheduleAsyncWork){for(let n=0,s=t.length;n<s;n++){const r=t[n];if(r.id===i.data.vscodeScheduleAsyncWork){t.splice(n,1);r.callback();return}}}});let e=0;return i=>{const n=++e;t.push({id:n,callback:i});_r.postMessage({vscodeScheduleAsyncWork:n},"*")}}return t=>setTimeout(t)})();var Cs;(function(t){t[t["Windows"]=1]="Windows";t[t["Macintosh"]=2]="Macintosh";t[t["Linux"]=3]="Linux"})(Cs||(Cs={}));const Eh=qu||b0?Cs.Macintosh:zu?Cs.Windows:Cs.Linux;let ix=true;let nx=false;function eI(){if(!nx){nx=true;const t=new Uint8Array(2);t[0]=1;t[1]=2;const e=new Uint16Array(t.buffer);ix=e[0]===(2<<8)+1}return ix}const y0=!!(Os&&Os.indexOf("Chrome")>=0);const IT=!!(Os&&Os.indexOf("Firefox")>=0);const CT=!!(!y0&&(Os&&Os.indexOf("Safari")>=0));const tI=!!(Os&&Os.indexOf("Edg/")>=0);!!(Os&&Os.indexOf("Android")>=0);var sx={};let na;const _1=globalThis.vscode;if(typeof _1!=="undefined"&&typeof _1.process!=="undefined"){const t=_1.process;na={get platform(){return t.platform},get arch(){return t.arch},get env(){return t.env},cwd(){return t.cwd()}}}else if(typeof process!=="undefined"&&typeof process?.versions?.node==="string"){na={get platform(){return process.platform},get arch(){return process.arch},get env(){return sx},cwd(){return sx["VSCODE_CWD"]||process.cwd()}}}else{na={get platform(){return Yi?"win32":Dn?"darwin":"linux"},get arch(){return void 0},get env(){return{}},cwd(){return"/"}}}const ql=na.cwd;const Gu=na.env;const TT=na.platform;na.arch;const PT=65;const AT=97;const RT=90;const LT=122;const sa=46;const yi=47;const nn=92;const qs=58;const NT=63;class iI extends Error{constructor(e,i,n){let s;if(typeof i==="string"&&i.indexOf("not ")===0){s="must not be";i=i.replace(/^not /,"")}else{s="must be"}const r=e.indexOf(".")!==-1?"property":"argument";let o=`The "${e}" ${r} ${s} of type ${i}`;o+=`. Received type ${typeof n}`;super(o);this.code="ERR_INVALID_ARG_TYPE"}}function OT(t,e){if(t===null||typeof t!=="object"){throw new iI(e,"Object",t)}}function Qt(t,e){if(typeof t!=="string"){throw new iI(e,"string",t)}}const us=TT==="win32";function ze(t){return t===yi||t===nn}function s_(t){return t===yi}function js(t){return t>=PT&&t<=RT||t>=AT&&t<=LT}function Lf(t,e,i,n){let s="";let r=0;let o=-1;let a=0;let l=0;for(let c=0;c<=t.length;++c){if(c<t.length){l=t.charCodeAt(c)}else if(n(l)){break}else{l=yi}if(n(l)){if(o===c-1||a===1);else if(a===2){if(s.length<2||r!==2||s.charCodeAt(s.length-1)!==sa||s.charCodeAt(s.length-2)!==sa){if(s.length>2){const u=s.lastIndexOf(i);if(u===-1){s="";r=0}else{s=s.slice(0,u);r=s.length-1-s.lastIndexOf(i)}o=c;a=0;continue}else if(s.length!==0){s="";r=0;o=c;a=0;continue}}if(e){s+=s.length>0?`${i}..`:"..";r=2}}else{if(s.length>0){s+=`${i}${t.slice(o+1,c)}`}else{s=t.slice(o+1,c)}r=c-o-1}o=c;a=0}else if(l===sa&&a!==-1){++a}else{a=-1}}return s}function FT(t){return t?`${t[0]==="."?"":"."}${t}`:""}function nI(t,e){OT(e,"pathObject");const i=e.dir||e.root;const n=e.base||`${e.name||""}${FT(e.ext)}`;if(!i){return n}return i===e.root?`${i}${n}`:`${i}${t}${n}`}const Ti={resolve(...t){let e="";let i="";let n=false;for(let s=t.length-1;s>=-1;s--){let r;if(s>=0){r=t[s];Qt(r,`paths[${s}]`);if(r.length===0){continue}}else if(e.length===0){r=ql()}else{r=Gu[`=${e}`]||ql();if(r===void 0||r.slice(0,2).toLowerCase()!==e.toLowerCase()&&r.charCodeAt(2)===nn){r=`${e}\\`}}const o=r.length;let a=0;let l="";let c=false;const u=r.charCodeAt(0);if(o===1){if(ze(u)){a=1;c=true}}else if(ze(u)){c=true;if(ze(r.charCodeAt(1))){let d=2;let p=d;while(d<o&&!ze(r.charCodeAt(d))){d++}if(d<o&&d!==p){const f=r.slice(p,d);p=d;while(d<o&&ze(r.charCodeAt(d))){d++}if(d<o&&d!==p){p=d;while(d<o&&!ze(r.charCodeAt(d))){d++}if(d===o||d!==p){l=`\\\\${f}\\${r.slice(p,d)}`;a=d}}}}else{a=1}}else if(js(u)&&r.charCodeAt(1)===qs){l=r.slice(0,2);a=2;if(o>2&&ze(r.charCodeAt(2))){c=true;a=3}}if(l.length>0){if(e.length>0){if(l.toLowerCase()!==e.toLowerCase()){continue}}else{e=l}}if(n){if(e.length>0){break}}else{i=`${r.slice(a)}\\${i}`;n=c;if(c&&e.length>0){break}}}i=Lf(i,!n,"\\",ze);return n?`${e}\\${i}`:`${e}${i}`||"."},normalize(t){Qt(t,"path");const e=t.length;if(e===0){return"."}let i=0;let n;let s=false;const r=t.charCodeAt(0);if(e===1){return s_(r)?"\\":t}if(ze(r)){s=true;if(ze(t.charCodeAt(1))){let a=2;let l=a;while(a<e&&!ze(t.charCodeAt(a))){a++}if(a<e&&a!==l){const c=t.slice(l,a);l=a;while(a<e&&ze(t.charCodeAt(a))){a++}if(a<e&&a!==l){l=a;while(a<e&&!ze(t.charCodeAt(a))){a++}if(a===e){return`\\\\${c}\\${t.slice(l)}\\`}if(a!==l){n=`\\\\${c}\\${t.slice(l,a)}`;i=a}}}}else{i=1}}else if(js(r)&&t.charCodeAt(1)===qs){n=t.slice(0,2);i=2;if(e>2&&ze(t.charCodeAt(2))){s=true;i=3}}let o=i<e?Lf(t.slice(i),!s,"\\",ze):"";if(o.length===0&&!s){o="."}if(o.length>0&&ze(t.charCodeAt(e-1))){o+="\\"}if(!s&&n===void 0&&t.includes(":")){if(o.length>=2&&js(o.charCodeAt(0))&&o.charCodeAt(1)===qs){return`.\\${o}`}let a=t.indexOf(":");do{if(a===e-1||ze(t.charCodeAt(a+1))){return`.\\${o}`}}while((a=t.indexOf(":",a+1))!==-1)}if(n===void 0){return s?`\\${o}`:o}return s?`${n}\\${o}`:`${n}${o}`},isAbsolute(t){Qt(t,"path");const e=t.length;if(e===0){return false}const i=t.charCodeAt(0);return ze(i)||e>2&&js(i)&&t.charCodeAt(1)===qs&&ze(t.charCodeAt(2))},join(...t){if(t.length===0){return"."}let e;let i;for(let r=0;r<t.length;++r){const o=t[r];Qt(o,"path");if(o.length>0){if(e===void 0){e=i=o}else{e+=`\\${o}`}}}if(e===void 0){return"."}let n=true;let s=0;if(typeof i==="string"&&ze(i.charCodeAt(0))){++s;const r=i.length;if(r>1&&ze(i.charCodeAt(1))){++s;if(r>2){if(ze(i.charCodeAt(2))){++s}else{n=false}}}}if(n){while(s<e.length&&ze(e.charCodeAt(s))){s++}if(s>=2){e=`\\${e.slice(s)}`}}return Ti.normalize(e)},relative(t,e){Qt(t,"from");Qt(e,"to");if(t===e){return""}const i=Ti.resolve(t);const n=Ti.resolve(e);if(i===n){return""}t=i.toLowerCase();e=n.toLowerCase();if(t===e){return""}if(i.length!==t.length||n.length!==e.length){const m=i.split("\\");const v=n.split("\\");if(m[m.length-1]===""){m.pop()}if(v[v.length-1]===""){v.pop()}const y=m.length;const D=v.length;const I=y<D?y:D;let R;for(R=0;R<I;R++){if(m[R].toLowerCase()!==v[R].toLowerCase()){break}}if(R===0){return n}else if(R===I){if(D>I){return v.slice(R).join("\\")}if(y>I){return"..\\".repeat(y-1-R)+".."}return""}return"..\\".repeat(y-R)+v.slice(R).join("\\")}let s=0;while(s<t.length&&t.charCodeAt(s)===nn){s++}let r=t.length;while(r-1>s&&t.charCodeAt(r-1)===nn){r--}const o=r-s;let a=0;while(a<e.length&&e.charCodeAt(a)===nn){a++}let l=e.length;while(l-1>a&&e.charCodeAt(l-1)===nn){l--}const c=l-a;const u=o<c?o:c;let d=-1;let p=0;for(;p<u;p++){const m=t.charCodeAt(s+p);if(m!==e.charCodeAt(a+p)){break}else if(m===nn){d=p}}if(p!==u){if(d===-1){return n}}else{if(c>u){if(e.charCodeAt(a+p)===nn){return n.slice(a+p+1)}if(p===2){return n.slice(a+p)}}if(o>u){if(t.charCodeAt(s+p)===nn){d=p}else if(p===2){d=3}}if(d===-1){d=0}}let f="";for(p=s+d+1;p<=r;++p){if(p===r||t.charCodeAt(p)===nn){f+=f.length===0?"..":"\\.."}}a+=d;if(f.length>0){return`${f}${n.slice(a,l)}`}if(n.charCodeAt(a)===nn){++a}return n.slice(a,l)},toNamespacedPath(t){if(typeof t!=="string"||t.length===0){return t}const e=Ti.resolve(t);if(e.length<=2){return t}if(e.charCodeAt(0)===nn){if(e.charCodeAt(1)===nn){const i=e.charCodeAt(2);if(i!==NT&&i!==sa){return`\\\\?\\UNC\\${e.slice(2)}`}}}else if(js(e.charCodeAt(0))&&e.charCodeAt(1)===qs&&e.charCodeAt(2)===nn){return`\\\\?\\${e}`}return e},dirname(t){Qt(t,"path");const e=t.length;if(e===0){return"."}let i=-1;let n=0;const s=t.charCodeAt(0);if(e===1){return ze(s)?t:"."}if(ze(s)){i=n=1;if(ze(t.charCodeAt(1))){let a=2;let l=a;while(a<e&&!ze(t.charCodeAt(a))){a++}if(a<e&&a!==l){l=a;while(a<e&&ze(t.charCodeAt(a))){a++}if(a<e&&a!==l){l=a;while(a<e&&!ze(t.charCodeAt(a))){a++}if(a===e){return t}if(a!==l){i=n=a+1}}}}}else if(js(s)&&t.charCodeAt(1)===qs){i=e>2&&ze(t.charCodeAt(2))?3:2;n=i}let r=-1;let o=true;for(let a=e-1;a>=n;--a){if(ze(t.charCodeAt(a))){if(!o){r=a;break}}else{o=false}}if(r===-1){if(i===-1){return"."}r=i}return t.slice(0,r)},basename(t,e){if(e!==void 0){Qt(e,"suffix")}Qt(t,"path");let i=0;let n=-1;let s=true;let r;if(t.length>=2&&js(t.charCodeAt(0))&&t.charCodeAt(1)===qs){i=2}if(e!==void 0&&e.length>0&&e.length<=t.length){if(e===t){return""}let o=e.length-1;let a=-1;for(r=t.length-1;r>=i;--r){const l=t.charCodeAt(r);if(ze(l)){if(!s){i=r+1;break}}else{if(a===-1){s=false;a=r+1}if(o>=0){if(l===e.charCodeAt(o)){if(--o===-1){n=r}}else{o=-1;n=a}}}}if(i===n){n=a}else if(n===-1){n=t.length}return t.slice(i,n)}for(r=t.length-1;r>=i;--r){if(ze(t.charCodeAt(r))){if(!s){i=r+1;break}}else if(n===-1){s=false;n=r+1}}if(n===-1){return""}return t.slice(i,n)},extname(t){Qt(t,"path");let e=0;let i=-1;let n=0;let s=-1;let r=true;let o=0;if(t.length>=2&&t.charCodeAt(1)===qs&&js(t.charCodeAt(0))){e=n=2}for(let a=t.length-1;a>=e;--a){const l=t.charCodeAt(a);if(ze(l)){if(!r){n=a+1;break}continue}if(s===-1){r=false;s=a+1}if(l===sa){if(i===-1){i=a}else if(o!==1){o=1}}else if(i!==-1){o=-1}}if(i===-1||s===-1||o===0||o===1&&i===s-1&&i===n+1){return""}return t.slice(i,s)},format:nI.bind(null,"\\"),parse(t){Qt(t,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0){return e}const i=t.length;let n=0;let s=t.charCodeAt(0);if(i===1){if(ze(s)){e.root=e.dir=t;return e}e.base=e.name=t;return e}if(ze(s)){n=1;if(ze(t.charCodeAt(1))){let d=2;let p=d;while(d<i&&!ze(t.charCodeAt(d))){d++}if(d<i&&d!==p){p=d;while(d<i&&ze(t.charCodeAt(d))){d++}if(d<i&&d!==p){p=d;while(d<i&&!ze(t.charCodeAt(d))){d++}if(d===i){n=d}else if(d!==p){n=d+1}}}}}else if(js(s)&&t.charCodeAt(1)===qs){if(i<=2){e.root=e.dir=t;return e}n=2;if(ze(t.charCodeAt(2))){if(i===3){e.root=e.dir=t;return e}n=3}}if(n>0){e.root=t.slice(0,n)}let r=-1;let o=n;let a=-1;let l=true;let c=t.length-1;let u=0;for(;c>=n;--c){s=t.charCodeAt(c);if(ze(s)){if(!l){o=c+1;break}continue}if(a===-1){l=false;a=c+1}if(s===sa){if(r===-1){r=c}else if(u!==1){u=1}}else if(r!==-1){u=-1}}if(a!==-1){if(r===-1||u===0||u===1&&r===a-1&&r===o+1){e.base=e.name=t.slice(o,a)}else{e.name=t.slice(o,r);e.base=t.slice(o,a);e.ext=t.slice(r,a)}}if(o>0&&o!==n){e.dir=t.slice(0,o-1)}else{e.dir=e.root}return e},sep:"\\",delimiter:";",win32:null,posix:null};const MT=(()=>{if(us){const t=/\\/g;return()=>{const e=ql().replace(t,"/");return e.slice(e.indexOf("/"))}}return()=>ql()})();const ct={resolve(...t){let e="";let i=false;for(let n=t.length-1;n>=0&&!i;n--){const s=t[n];Qt(s,`paths[${n}]`);if(s.length===0){continue}e=`${s}/${e}`;i=s.charCodeAt(0)===yi}if(!i){const n=MT();e=`${n}/${e}`;i=n.charCodeAt(0)===yi}e=Lf(e,!i,"/",s_);if(i){return`/${e}`}return e.length>0?e:"."},normalize(t){Qt(t,"path");if(t.length===0){return"."}const e=t.charCodeAt(0)===yi;const i=t.charCodeAt(t.length-1)===yi;t=Lf(t,!e,"/",s_);if(t.length===0){if(e){return"/"}return i?"./":"."}if(i){t+="/"}return e?`/${t}`:t},isAbsolute(t){Qt(t,"path");return t.length>0&&t.charCodeAt(0)===yi},join(...t){if(t.length===0){return"."}const e=[];for(let i=0;i<t.length;++i){const n=t[i];Qt(n,"path");if(n.length>0){e.push(n)}}if(e.length===0){return"."}return ct.normalize(e.join("/"))},relative(t,e){Qt(t,"from");Qt(e,"to");if(t===e){return""}t=ct.resolve(t);e=ct.resolve(e);if(t===e){return""}const i=1;const n=t.length;const s=n-i;const r=1;const o=e.length-r;const a=s<o?s:o;let l=-1;let c=0;for(;c<a;c++){const d=t.charCodeAt(i+c);if(d!==e.charCodeAt(r+c)){break}else if(d===yi){l=c}}if(c===a){if(o>a){if(e.charCodeAt(r+c)===yi){return e.slice(r+c+1)}if(c===0){return e.slice(r+c)}}else if(s>a){if(t.charCodeAt(i+c)===yi){l=c}else if(c===0){l=0}}}let u="";for(c=i+l+1;c<=n;++c){if(c===n||t.charCodeAt(c)===yi){u+=u.length===0?"..":"/.."}}return`${u}${e.slice(r+l)}`},toNamespacedPath(t){return t},dirname(t){Qt(t,"path");if(t.length===0){return"."}const e=t.charCodeAt(0)===yi;let i=-1;let n=true;for(let s=t.length-1;s>=1;--s){if(t.charCodeAt(s)===yi){if(!n){i=s;break}}else{n=false}}if(i===-1){return e?"/":"."}if(e&&i===1){return"//"}return t.slice(0,i)},basename(t,e){if(e!==void 0){Qt(e,"suffix")}Qt(t,"path");let i=0;let n=-1;let s=true;let r;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e===t){return""}let o=e.length-1;let a=-1;for(r=t.length-1;r>=0;--r){const l=t.charCodeAt(r);if(l===yi){if(!s){i=r+1;break}}else{if(a===-1){s=false;a=r+1}if(o>=0){if(l===e.charCodeAt(o)){if(--o===-1){n=r}}else{o=-1;n=a}}}}if(i===n){n=a}else if(n===-1){n=t.length}return t.slice(i,n)}for(r=t.length-1;r>=0;--r){if(t.charCodeAt(r)===yi){if(!s){i=r+1;break}}else if(n===-1){s=false;n=r+1}}if(n===-1){return""}return t.slice(i,n)},extname(t){Qt(t,"path");let e=-1;let i=0;let n=-1;let s=true;let r=0;for(let o=t.length-1;o>=0;--o){const a=t[o];if(a==="/"){if(!s){i=o+1;break}continue}if(n===-1){s=false;n=o+1}if(a==="."){if(e===-1){e=o}else if(r!==1){r=1}}else if(e!==-1){r=-1}}if(e===-1||n===-1||r===0||r===1&&e===n-1&&e===i+1){return""}return t.slice(e,n)},format:nI.bind(null,"/"),parse(t){Qt(t,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0){return e}const i=t.charCodeAt(0)===yi;let n;if(i){e.root="/";n=1}else{n=0}let s=-1;let r=0;let o=-1;let a=true;let l=t.length-1;let c=0;for(;l>=n;--l){const u=t.charCodeAt(l);if(u===yi){if(!a){r=l+1;break}continue}if(o===-1){a=false;o=l+1}if(u===sa){if(s===-1){s=l}else if(c!==1){c=1}}else if(s!==-1){c=-1}}if(o!==-1){const u=r===0&&i?1:r;if(s===-1||c===0||c===1&&s===o-1&&s===r+1){e.base=e.name=t.slice(u,o)}else{e.name=t.slice(u,s);e.base=t.slice(u,o);e.ext=t.slice(s,o)}}if(r>0){e.dir=t.slice(0,r-1)}else if(i){e.dir="/"}return e},sep:"/",delimiter:":",win32:null,posix:null};ct.win32=Ti.win32=Ti;ct.posix=Ti.posix=ct;const jl=us?Ti.normalize:ct.normalize;const Nf=us?Ti.isAbsolute:ct.isAbsolute;const r_=us?Ti.join:ct.join;const UT=us?Ti.resolve:ct.resolve;const Ku=us?Ti.relative:ct.relative;const El=us?Ti.dirname:ct.dirname;const rn=us?Ti.basename:ct.basename;const o_=us?Ti.extname:ct.extname;us?Ti.parse:ct.parse;const os=us?Ti.sep:ct.sep;const $T=/^\w[\w\d+.-]*$/;const HT=/^\//;const BT=/^\/\//;function VT(t,e){if(!t.scheme&&e){throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${t.authority}", path: "${t.path}", query: "${t.query}", fragment: "${t.fragment}"}`)}if(t.scheme&&!$T.test(t.scheme)){throw new Error("[UriError]: Scheme contains illegal characters.")}if(t.path){if(t.authority){if(!HT.test(t.path)){throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}}else{if(BT.test(t.path)){throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}}}function WT(t,e){if(!t&&!e){return"file"}return t}function zT(t,e){switch(t){case"https":case"http":case"file":if(!e){e=Yn}else if(e[0]!==Yn){e=Yn+e}break}return e}const Ct="";const Yn="/";const qT=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class b{static isUri(e){if(e instanceof b){return true}if(!e){return false}return typeof e.authority==="string"&&typeof e.fragment==="string"&&typeof e.path==="string"&&typeof e.query==="string"&&typeof e.scheme==="string"&&typeof e.fsPath==="string"&&typeof e.with==="function"&&typeof e.toString==="function"}constructor(e,i,n,s,r,o=false){if(typeof e==="object"){this.scheme=e.scheme||Ct;this.authority=e.authority||Ct;this.path=e.path||Ct;this.query=e.query||Ct;this.fragment=e.fragment||Ct}else{this.scheme=WT(e,o);this.authority=i||Ct;this.path=zT(this.scheme,n||Ct);this.query=s||Ct;this.fragment=r||Ct;VT(this,o)}}get fsPath(){return Ff(this,false)}with(e){if(!e){return this}let{scheme:i,authority:n,path:s,query:r,fragment:o}=e;if(i===void 0){i=this.scheme}else if(i===null){i=Ct}if(n===void 0){n=this.authority}else if(n===null){n=Ct}if(s===void 0){s=this.path}else if(s===null){s=Ct}if(r===void 0){r=this.query}else if(r===null){r=Ct}if(o===void 0){o=this.fragment}else if(o===null){o=Ct}if(i===this.scheme&&n===this.authority&&s===this.path&&r===this.query&&o===this.fragment){return this}return new ja(i,n,s,r,o)}static parse(e,i=false){const n=qT.exec(e);if(!n){return new ja(Ct,Ct,Ct,Ct,Ct)}return new ja(n[2]||Ct,Sh(n[4]||Ct),Sh(n[5]||Ct),Sh(n[7]||Ct),Sh(n[9]||Ct),i)}static file(e){let i=Ct;if(Yi){e=e.replace(/\\/g,Yn)}if(e[0]===Yn&&e[1]===Yn){const n=e.indexOf(Yn,2);if(n===-1){i=e.substring(2);e=Yn}else{i=e.substring(2,n);e=e.substring(n)||Yn}}return new ja("file",i,e,Ct,Ct)}static from(e,i){const n=new ja(e.scheme,e.authority,e.path,e.query,e.fragment,i);return n}static joinPath(e,...i){if(!e.path){throw new Error(`[UriError]: cannot call joinPath on URI without path`)}let n;if(Yi&&e.scheme==="file"){n=b.file(Ti.join(Ff(e,true),...i)).path}else{n=ct.join(e.path,...i)}return e.with({path:n})}toString(e=false){return a_(this,e)}toJSON(){return this}static revive(e){if(!e){return e}else if(e instanceof b){return e}else{const i=new ja(e);i._formatted=e.external??null;i._fsPath=e._sep===sI?e.fsPath??null:null;return i}}[Symbol.for("debug.description")](){return`URI(${this.toString()})`}}function Of(t){if(!t||typeof t!=="object"){return false}return typeof t.scheme==="string"&&(typeof t.authority==="string"||typeof t.authority==="undefined")&&(typeof t.path==="string"||typeof t.path==="undefined")&&(typeof t.query==="string"||typeof t.query==="undefined")&&(typeof t.fragment==="string"||typeof t.fragment==="undefined")}const sI=Yi?1:void 0;class ja extends b{constructor(){super(...arguments);this._formatted=null;this._fsPath=null}get fsPath(){if(!this._fsPath){this._fsPath=Ff(this,false)}return this._fsPath}toString(e=false){if(!e){if(!this._formatted){this._formatted=a_(this,false)}return this._formatted}else{return a_(this,true)}}toJSON(){const e={$mid:it.Uri};if(this._fsPath){e.fsPath=this._fsPath;e._sep=sI}if(this._formatted){e.external=this._formatted}if(this.path){e.path=this.path}if(this.scheme){e.scheme=this.scheme}if(this.authority){e.authority=this.authority}if(this.query){e.query=this.query}if(this.fragment){e.fragment=this.fragment}return e}}const rI={[A.Colon]:"%3A",[A.Slash]:"%2F",[A.QuestionMark]:"%3F",[A.Hash]:"%23",[A.OpenSquareBracket]:"%5B",[A.CloseSquareBracket]:"%5D",[A.AtSign]:"%40",[A.ExclamationMark]:"%21",[A.DollarSign]:"%24",[A.Ampersand]:"%26",[A.SingleQuote]:"%27",[A.OpenParen]:"%28",[A.CloseParen]:"%29",[A.Asterisk]:"%2A",[A.Plus]:"%2B",[A.Comma]:"%2C",[A.Semicolon]:"%3B",[A.Equals]:"%3D",[A.Space]:"%20"};function rx(t,e,i){let n=void 0;let s=-1;for(let r=0;r<t.length;r++){const o=t.charCodeAt(r);if(o>=A.a&&o<=A.z||o>=A.A&&o<=A.Z||o>=A.Digit0&&o<=A.Digit9||o===A.Dash||o===A.Period||o===A.Underline||o===A.Tilde||e&&o===A.Slash||i&&o===A.OpenSquareBracket||i&&o===A.CloseSquareBracket||i&&o===A.Colon){if(s!==-1){n+=encodeURIComponent(t.substring(s,r));s=-1}if(n!==void 0){n+=t.charAt(r)}}else{if(n===void 0){n=t.substr(0,r)}const a=rI[o];if(a!==void 0){if(s!==-1){n+=encodeURIComponent(t.substring(s,r));s=-1}n+=a}else if(s===-1){s=r}}}if(s!==-1){n+=encodeURIComponent(t.substring(s))}return n!==void 0?n:t}function jT(t){let e=void 0;for(let i=0;i<t.length;i++){const n=t.charCodeAt(i);if(n===A.Hash||n===A.QuestionMark){if(e===void 0){e=t.substr(0,i)}e+=rI[n]}else{if(e!==void 0){e+=t[i]}}}return e!==void 0?e:t}function Ff(t,e){let i;if(t.authority&&t.path.length>1&&t.scheme==="file"){i=`//${t.authority}${t.path}`}else if(t.path.charCodeAt(0)===A.Slash&&(t.path.charCodeAt(1)>=A.A&&t.path.charCodeAt(1)<=A.Z||t.path.charCodeAt(1)>=A.a&&t.path.charCodeAt(1)<=A.z)&&t.path.charCodeAt(2)===A.Colon){if(!e){i=t.path[1].toLowerCase()+t.path.substr(2)}else{i=t.path.substr(1)}}else{i=t.path}if(Yi){i=i.replace(/\//g,"\\")}return i}function a_(t,e){const i=!e?rx:jT;let n="";let{scheme:s,authority:r,path:o,query:a,fragment:l}=t;if(s){n+=s;n+=":"}if(r||s==="file"){n+=Yn;n+=Yn}if(r){let c=r.indexOf("@");if(c!==-1){const u=r.substr(0,c);r=r.substr(c+1);c=u.lastIndexOf(":");if(c===-1){n+=i(u,false,false)}else{n+=i(u.substr(0,c),false,false);n+=":";n+=i(u.substr(c+1),false,true)}n+="@"}r=r.toLowerCase();c=r.lastIndexOf(":");if(c===-1){n+=i(r,false,true)}else{n+=i(r.substr(0,c),false,true);n+=r.substr(c)}}if(o){if(o.length>=3&&o.charCodeAt(0)===A.Slash&&o.charCodeAt(2)===A.Colon){const c=o.charCodeAt(1);if(c>=A.A&&c<=A.Z){o=`/${String.fromCharCode(c+32)}:${o.substr(3)}`}}else if(o.length>=2&&o.charCodeAt(1)===A.Colon){const c=o.charCodeAt(0);if(c>=A.A&&c<=A.Z){o=`${String.fromCharCode(c+32)}:${o.substr(2)}`}}n+=i(o,true,false)}if(a){n+="?";n+=i(a,false,false)}if(l){n+="#";n+=!e?rx(l,false,false):l}return n}function oI(t){try{return decodeURIComponent(t)}catch{if(t.length>3){return t.substr(0,3)+oI(t.substr(3))}else{return t}}}const ox=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function Sh(t){if(!t.match(ox)){return t}return t.replace(ox,e=>oI(e))}class mm{static{this.count=0}constructor(e){this._proxyIdentifierBrand=void 0;this.sid=e;this.nid=++mm.count}}const aI=[];function V(t){const e=new mm(t);aI[e.nid]=e;return e}function Dh(t){return aI[t].sid}class Bi{constructor(e){this.value=e}}var ax;(function(t){t[t["Default"]=0]="Default";t[t["InCenter"]=1]="InCenter";t[t["InCenterIfOutsideViewport"]=2]="InCenterIfOutsideViewport";t[t["AtTop"]=3]="AtTop"})(ax||(ax={}));var fn;(function(t){t[t["UnknownInput"]=0]="UnknownInput";t[t["TextInput"]=1]="TextInput";t[t["TextDiffInput"]=2]="TextDiffInput";t[t["TextMergeInput"]=3]="TextMergeInput";t[t["NotebookInput"]=4]="NotebookInput";t[t["NotebookDiffInput"]=5]="NotebookDiffInput";t[t["CustomEditorInput"]=6]="CustomEditorInput";t[t["WebviewEditorInput"]=7]="WebviewEditorInput";t[t["TerminalEditorInput"]=8]="TerminalEditorInput";t[t["InteractiveEditorInput"]=9]="InteractiveEditorInput";t[t["ChatEditorInput"]=10]="ChatEditorInput";t[t["MultiDiffEditorInput"]=11]="MultiDiffEditorInput"})(fn||(fn={}));var ur;(function(t){t[t["TAB_OPEN"]=0]="TAB_OPEN";t[t["TAB_CLOSE"]=1]="TAB_CLOSE";t[t["TAB_UPDATE"]=2]="TAB_UPDATE";t[t["TAB_MOVE"]=3]="TAB_MOVE"})(ur||(ur={}));var lx;(function(t){t[t["Editable"]=0]="Editable";t[t["SupportsHotExit"]=1]="SupportsHotExit"})(lx||(lx={}));var $t;(function(t){t[t["Int8Array"]=1]="Int8Array";t[t["Uint8Array"]=2]="Uint8Array";t[t["Uint8ClampedArray"]=3]="Uint8ClampedArray";t[t["Int16Array"]=4]="Int16Array";t[t["Uint16Array"]=5]="Uint16Array";t[t["Int32Array"]=6]="Int32Array";t[t["Uint32Array"]=7]="Uint32Array";t[t["Float32Array"]=8]="Float32Array";t[t["Float64Array"]=9]="Float64Array";t[t["BigInt64Array"]=10]="BigInt64Array";t[t["BigUint64Array"]=11]="BigUint64Array"})($t||($t={}));var cx;(function(t){t[t["Text"]=1]="Text";t[t["Error"]=2]="Error";t[t["Rich"]=3]="Rich"})(cx||(cx={}));var ux;(function(t){t[t["Default"]=0]="Default";t[t["InCenter"]=1]="InCenter";t[t["InCenterIfOutsideViewport"]=2]="InCenterIfOutsideViewport";t[t["AtTop"]=3]="AtTop"})(ux||(ux={}));var l_;(function(t){t[t["None"]=0]="None";t[t["Process"]=1]="Process";t[t["Output"]=2]="Output";t[t["Hybrid"]=3]="Hybrid"})(l_||(l_={}));var Fe;(function(t){t["label"]="a";t["kind"]="b";t["detail"]="c";t["documentation"]="d";t["sortText"]="e";t["filterText"]="f";t["preselect"]="g";t["insertText"]="h";t["insertTextRules"]="i";t["range"]="j";t["commitCharacters"]="k";t["additionalTextEdits"]="l";t["kindModifier"]="m";t["commandIdent"]="n";t["commandId"]="o";t["commandArguments"]="p"})(Fe||(Fe={}));var rl;(function(t){t["defaultRanges"]="a";t["completions"]="b";t["isIncomplete"]="c";t["duration"]="d"})(rl||(rl={}));var dx;(function(t){t[t["Workspace"]=0]="Workspace";t[t["TextDocument"]=1]="TextDocument"})(dx||(dx={}));const Y={MainThreadAuthentication:V("MainThreadAuthentication"),MainThreadBulkEdits:V("MainThreadBulkEdits"),MainThreadLanguageModels:V("MainThreadLanguageModels"),MainThreadEmbeddings:V("MainThreadEmbeddings"),MainThreadChatAgents2:V("MainThreadChatAgents2"),MainThreadCodeMapper:V("MainThreadCodeMapper"),MainThreadLanguageModelTools:V("MainThreadChatSkills"),MainThreadClipboard:V("MainThreadClipboard"),MainThreadCommands:V("MainThreadCommands"),MainThreadComments:V("MainThreadComments"),MainThreadConfiguration:V("MainThreadConfiguration"),MainThreadConsole:V("MainThreadConsole"),MainThreadDebugService:V("MainThreadDebugService"),MainThreadDecorations:V("MainThreadDecorations"),MainThreadDiagnostics:V("MainThreadDiagnostics"),MainThreadDialogs:V("MainThreadDiaglogs"),MainThreadDocuments:V("MainThreadDocuments"),MainThreadDocumentContentProviders:V("MainThreadDocumentContentProviders"),MainThreadTextEditors:V("MainThreadTextEditors"),MainThreadEditorInsets:V("MainThreadEditorInsets"),MainThreadEditorTabs:V("MainThreadEditorTabs"),MainThreadErrors:V("MainThreadErrors"),MainThreadTreeViews:V("MainThreadTreeViews"),MainThreadDownloadService:V("MainThreadDownloadService"),MainThreadLanguageFeatures:V("MainThreadLanguageFeatures"),MainThreadLanguages:V("MainThreadLanguages"),MainThreadLogger:V("MainThreadLogger"),MainThreadMessageService:V("MainThreadMessageService"),MainThreadOutputService:V("MainThreadOutputService"),MainThreadProgress:V("MainThreadProgress"),MainThreadQuickDiff:V("MainThreadQuickDiff"),MainThreadQuickOpen:V("MainThreadQuickOpen"),MainThreadStatusBar:V("MainThreadStatusBar"),MainThreadSecretState:V("MainThreadSecretState"),MainThreadStorage:V("MainThreadStorage"),MainThreadSpeech:V("MainThreadSpeechProvider"),MainThreadTelemetry:V("MainThreadTelemetry"),MainThreadTerminalService:V("MainThreadTerminalService"),MainThreadTerminalShellIntegration:V("MainThreadTerminalShellIntegration"),MainThreadWebviews:V("MainThreadWebviews"),MainThreadWebviewPanels:V("MainThreadWebviewPanels"),MainThreadWebviewViews:V("MainThreadWebviewViews"),MainThreadCustomEditors:V("MainThreadCustomEditors"),MainThreadUrls:V("MainThreadUrls"),MainThreadUriOpeners:V("MainThreadUriOpeners"),MainThreadProfileContentHandlers:V("MainThreadProfileContentHandlers"),MainThreadWorkspace:V("MainThreadWorkspace"),MainThreadFileSystem:V("MainThreadFileSystem"),MainThreadFileSystemEventService:V("MainThreadFileSystemEventService"),MainThreadExtensionService:V("MainThreadExtensionService"),MainThreadSCM:V("MainThreadSCM"),MainThreadSearch:V("MainThreadSearch"),MainThreadShare:V("MainThreadShare"),MainThreadTask:V("MainThreadTask"),MainThreadWindow:V("MainThreadWindow"),MainThreadLabelService:V("MainThreadLabelService"),MainThreadNotebook:V("MainThreadNotebook"),MainThreadNotebookDocuments:V("MainThreadNotebookDocumentsShape"),MainThreadNotebookEditors:V("MainThreadNotebookEditorsShape"),MainThreadNotebookKernels:V("MainThreadNotebookKernels"),MainThreadNotebookRenderers:V("MainThreadNotebookRenderers"),MainThreadInteractive:V("MainThreadInteractive"),MainThreadTheming:V("MainThreadTheming"),MainThreadTunnelService:V("MainThreadTunnelService"),MainThreadManagedSockets:V("MainThreadManagedSockets"),MainThreadTimeline:V("MainThreadTimeline"),MainThreadTesting:V("MainThreadTesting"),MainThreadLocalization:V("MainThreadLocalizationShape"),MainThreadMcp:V("MainThreadMcpShape"),MainThreadAiRelatedInformation:V("MainThreadAiRelatedInformation"),MainThreadAiEmbeddingVector:V("MainThreadAiEmbeddingVector"),MainThreadChatStatus:V("MainThreadChatStatus"),MainThreadAiSettingsSearch:V("MainThreadAiSettingsSearch")};const de={ExtHostCodeMapper:V("ExtHostCodeMapper"),ExtHostCommands:V("ExtHostCommands"),ExtHostConfiguration:V("ExtHostConfiguration"),ExtHostDiagnostics:V("ExtHostDiagnostics"),ExtHostDebugService:V("ExtHostDebugService"),ExtHostDecorations:V("ExtHostDecorations"),ExtHostDocumentsAndEditors:V("ExtHostDocumentsAndEditors"),ExtHostDocuments:V("ExtHostDocuments"),ExtHostDocumentContentProviders:V("ExtHostDocumentContentProviders"),ExtHostDocumentSaveParticipant:V("ExtHostDocumentSaveParticipant"),ExtHostEditors:V("ExtHostEditors"),ExtHostTreeViews:V("ExtHostTreeViews"),ExtHostFileSystem:V("ExtHostFileSystem"),ExtHostFileSystemInfo:V("ExtHostFileSystemInfo"),ExtHostFileSystemEventService:V("ExtHostFileSystemEventService"),ExtHostLanguages:V("ExtHostLanguages"),ExtHostLanguageFeatures:V("ExtHostLanguageFeatures"),ExtHostQuickOpen:V("ExtHostQuickOpen"),ExtHostQuickDiff:V("ExtHostQuickDiff"),ExtHostStatusBar:V("ExtHostStatusBar"),ExtHostShare:V("ExtHostShare"),ExtHostExtensionService:V("ExtHostExtensionService"),ExtHostLogLevelServiceShape:V("ExtHostLogLevelServiceShape"),ExtHostTerminalService:V("ExtHostTerminalService"),ExtHostTerminalShellIntegration:V("ExtHostTerminalShellIntegration"),ExtHostSCM:V("ExtHostSCM"),ExtHostSearch:V("ExtHostSearch"),ExtHostTask:V("ExtHostTask"),ExtHostWorkspace:V("ExtHostWorkspace"),ExtHostWindow:V("ExtHostWindow"),ExtHostWebviews:V("ExtHostWebviews"),ExtHostWebviewPanels:V("ExtHostWebviewPanels"),ExtHostCustomEditors:V("ExtHostCustomEditors"),ExtHostWebviewViews:V("ExtHostWebviewViews"),ExtHostEditorInsets:V("ExtHostEditorInsets"),ExtHostEditorTabs:V("ExtHostEditorTabs"),ExtHostProgress:V("ExtHostProgress"),ExtHostComments:V("ExtHostComments"),ExtHostSecretState:V("ExtHostSecretState"),ExtHostStorage:V("ExtHostStorage"),ExtHostUrls:V("ExtHostUrls"),ExtHostUriOpeners:V("ExtHostUriOpeners"),ExtHostProfileContentHandlers:V("ExtHostProfileContentHandlers"),ExtHostOutputService:V("ExtHostOutputService"),ExtHostLabelService:V("ExtHostLabelService"),ExtHostNotebook:V("ExtHostNotebook"),ExtHostNotebookDocuments:V("ExtHostNotebookDocuments"),ExtHostNotebookEditors:V("ExtHostNotebookEditors"),ExtHostNotebookKernels:V("ExtHostNotebookKernels"),ExtHostNotebookRenderers:V("ExtHostNotebookRenderers"),ExtHostNotebookDocumentSaveParticipant:V("ExtHostNotebookDocumentSaveParticipant"),ExtHostInteractive:V("ExtHostInteractive"),ExtHostChatAgents2:V("ExtHostChatAgents"),ExtHostLanguageModelTools:V("ExtHostChatSkills"),ExtHostChatProvider:V("ExtHostChatProvider"),ExtHostSpeech:V("ExtHostSpeech"),ExtHostEmbeddings:V("ExtHostEmbeddings"),ExtHostAiRelatedInformation:V("ExtHostAiRelatedInformation"),ExtHostAiEmbeddingVector:V("ExtHostAiEmbeddingVector"),ExtHostAiSettingsSearch:V("ExtHostAiSettingsSearch"),ExtHostTheming:V("ExtHostTheming"),ExtHostTunnelService:V("ExtHostTunnelService"),ExtHostManagedSockets:V("ExtHostManagedSockets"),ExtHostAuthentication:V("ExtHostAuthentication"),ExtHostTimeline:V("ExtHostTimeline"),ExtHostTesting:V("ExtHostTesting"),ExtHostTelemetry:V("ExtHostTelemetry"),ExtHostLocalization:V("ExtHostLocalization"),ExtHostMcp:V("ExtHostMcp")};const lI=Object.freeze(function(t,e){const i=setTimeout(t.bind(e),0);return{dispose(){clearTimeout(i)}}});var bt;(function(t){function e(i){if(i===t.None||i===t.Cancelled){return true}if(i instanceof Xh){return true}if(!i||typeof i!=="object"){return false}return typeof i.isCancellationRequested==="boolean"&&typeof i.onCancellationRequested==="function"}t.isCancellationToken=e;t.None=Object.freeze({isCancellationRequested:false,onCancellationRequested:Bt.None});t.Cancelled=Object.freeze({isCancellationRequested:true,onCancellationRequested:lI})})(bt||(bt={}));class Xh{constructor(){this._isCancelled=false;this._emitter=null}cancel(){if(!this._isCancelled){this._isCancelled=true;if(this._emitter){this._emitter.fire(void 0);this.dispose()}}}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){if(this._isCancelled){return lI}if(!this._emitter){this._emitter=new L}return this._emitter.event}dispose(){if(this._emitter){this._emitter.dispose();this._emitter=null}}}class Ot{constructor(e){this._token=void 0;this._parentListener=void 0;this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){if(!this._token){this._token=new Xh}return this._token}cancel(){if(!this._token){this._token=bt.Cancelled}else if(this._token instanceof Xh){this._token.cancel()}}dispose(e=false){if(e){this.cancel()}this._parentListener?.dispose();if(!this._token){this._token=bt.None}else if(this._token instanceof Xh){this._token.dispose()}}}function GT(t){return t}class KT{constructor(e,i){this.lastCache=void 0;this.lastArgKey=void 0;if(typeof e==="function"){this._fn=e;this._computeKey=GT}else{this._fn=i;this._computeKey=e.getCacheKey}}get(e){const i=this._computeKey(e);if(this.lastArgKey!==i){this.lastArgKey=i;this.lastCache=this._fn(e)}return this.lastCache}}var Ui;(function(t){t[t["MAX_SAFE_SMALL_INTEGER"]=1073741824]="MAX_SAFE_SMALL_INTEGER";t[t["MIN_SAFE_SMALL_INTEGER"]=-1073741824]="MIN_SAFE_SMALL_INTEGER";t[t["MAX_UINT_8"]=255]="MAX_UINT_8";t[t["MAX_UINT_16"]=65535]="MAX_UINT_16";t[t["MAX_UINT_32"]=4294967295]="MAX_UINT_32";t[t["UNICODE_SUPPLEMENTARY_PLANE_BEGIN"]=65536]="UNICODE_SUPPLEMENTARY_PLANE_BEGIN"})(Ui||(Ui={}));function hx(t){if(t<0){return 0}if(t>Ui.MAX_UINT_8){return Ui.MAX_UINT_8}return t|0}function Ga(t){if(t<0){return 0}if(t>Ui.MAX_UINT_32){return Ui.MAX_UINT_32}return t|0}function Qu(t){if(!t||typeof t!=="string"){return true}return t.trim().length===0}const QT=/{([^}]+)}/g;function fx(t,e){if(Object.keys(e).length===0){return t}return t.replace(QT,(i,n)=>e[n]??i)}function ya(t){return t.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function JT(t,e){let i=0;let n=t.indexOf(e);while(n!==-1){i++;n=t.indexOf(e,n+e.length)}return i}function XT(t,e){if(!t||!e){return t}const i=e.length;if(i===0||t.length===0){return t}let n=0;while(t.indexOf(e,n)===n){n=n+i}return t.substring(n)}function c_(t,e){if(!t||!e){return t}const i=e.length,n=t.length;if(i===0||n===0){return t}let s=n,r=-1;while(true){r=t.lastIndexOf(e,s-1);if(r===-1||r+i!==s){break}if(r===0){return""}s=r}return t.substring(0,s)}function YT(t,e,i={}){if(!t){throw new Error("Cannot create regex from empty string")}if(!e){t=ya(t)}if(i.wholeWord){if(!/\B/.test(t.charAt(0))){t="\\b"+t}if(!/\B/.test(t.charAt(t.length-1))){t=t+"\\b"}}let n="";if(i.global){n+="g"}if(!i.matchCase){n+="i"}if(i.multiline){n+="m"}if(i.unicode){n+="u"}return new RegExp(t,n)}function cI(t){if(t.source==="^"||t.source==="^$"||t.source==="$"||t.source==="^\\s*$"){return false}const e=t.exec("");return!!(e&&t.lastIndex===0)}function uI(t){return t.split(/\r\n|\r|\n/)}function v1(t){for(let e=0,i=t.length;e<i;e++){const n=t.charCodeAt(e);if(n!==A.Space&&n!==A.Tab){return e}}return-1}function ZT(t,e=t.length-1){for(let i=e;i>=0;i--){const n=t.charCodeAt(i);if(n!==A.Space&&n!==A.Tab){return i}}return-1}function xa(t,e){if(t<e){return-1}else if(t>e){return 1}else{return 0}}function x0(t,e,i=0,n=t.length,s=0,r=e.length){for(;i<n&&s<r;i++,s++){const l=t.charCodeAt(i);const c=e.charCodeAt(s);if(l<c){return-1}else if(l>c){return 1}}const o=n-i;const a=r-s;if(o<a){return-1}else if(o>a){return 1}return 0}function u_(t,e){return ah(t,e,0,t.length,0,e.length)}function ah(t,e,i=0,n=t.length,s=0,r=e.length){for(;i<n&&s<r;i++,s++){let l=t.charCodeAt(i);let c=e.charCodeAt(s);if(l===c){continue}if(l>=128||c>=128){return x0(t.toLowerCase(),e.toLowerCase(),i,n,s,r)}if(px(l)){l-=32}if(px(c)){c-=32}const u=l-c;if(u===0){continue}return u}const o=n-i;const a=r-s;if(o<a){return-1}else if(o>a){return 1}return 0}function px(t){return t>=A.a&&t<=A.z}function io(t,e){return t.length===e.length&&ah(t,e)===0}function E0(t,e){const i=e.length;if(e.length>t.length){return false}return ah(t,e,0,i)===0}function eP(t,e){const i=Math.min(t.length,e.length);let n;for(n=0;n<i;n++){if(t.charCodeAt(n)!==e.charCodeAt(n)){return n}}return i}function _m(t){return 55296<=t&&t<=56319}function Mf(t){return 56320<=t&&t<=57343}function S0(t,e){return(t-55296<<10)+(e-56320)+65536}function dI(t,e,i){const n=t.charCodeAt(i);if(_m(n)&&i+1<e){const s=t.charCodeAt(i+1);if(Mf(s)){return S0(n,s)}}return n}function tP(t,e){const i=t.charCodeAt(e-1);if(Mf(i)&&e>1){const n=t.charCodeAt(e-2);if(_m(n)){return S0(n,i)}}return i}class iP{get offset(){return this._offset}constructor(e,i=0){this._str=e;this._len=e.length;this._offset=i}setOffset(e){this._offset=e}prevCodePoint(){const e=tP(this._str,this._offset);this._offset-=e>=Ui.UNICODE_SUPPLEMENTARY_PLANE_BEGIN?2:1;return e}nextCodePoint(){const e=dI(this._str,this._len,this._offset);this._offset+=e>=Ui.UNICODE_SUPPLEMENTARY_PLANE_BEGIN?2:1;return e}eol(){return this._offset>=this._len}}class nP{get offset(){return this._iterator.offset}constructor(e,i=0){this._iterator=new iP(e,i)}nextGraphemeLength(){const e=Wo.getInstance();const i=this._iterator;const n=i.offset;let s=e.getGraphemeBreakType(i.nextCodePoint());while(!i.eol()){const r=i.offset;const o=e.getGraphemeBreakType(i.nextCodePoint());if(_x(s,o)){i.setOffset(r);break}s=o}return i.offset-n}prevGraphemeLength(){const e=Wo.getInstance();const i=this._iterator;const n=i.offset;let s=e.getGraphemeBreakType(i.prevCodePoint());while(i.offset>0){const r=i.offset;const o=e.getGraphemeBreakType(i.prevCodePoint());if(_x(o,s)){i.setOffset(r);break}s=o}return n-i.offset}eol(){return this._iterator.eol()}}function gx(t,e){const i=new nP(t,e);return i.nextGraphemeLength()}let w1=void 0;function sP(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function hI(t){if(!w1){w1=sP()}return w1.test(t)}const rP=/^[\t\n\r\x20-\x7E]*$/;function oP(t){return rP.test(t)}const aP=/[\u2028\u2029]/;function fI(t){return aP.test(t)}const lP=String.fromCharCode(A.UTF8_BOM);function cP(t){return!!(t&&t.length>0&&t.charCodeAt(0)===A.UTF8_BOM)}function mx(t,e=false){if(!t){return false}if(e){t=t.replace(/\\./g,"")}return t.toLowerCase()!==t}function uP(t,e=1){if(e===0){return""}let i=-1;do{i=t.indexOf("\n",i+1);e--}while(e>0&&i>=0);if(i===-1){return t}if(t[i-1]==="\r"){i--}return t.substr(0,i)}function _x(t,e){if(t===Xe.Other){return e!==Xe.Extend&&e!==Xe.SpacingMark}if(t===Xe.CR){if(e===Xe.LF){return false}}if(t===Xe.Control||t===Xe.CR||t===Xe.LF){return true}if(e===Xe.Control||e===Xe.CR||e===Xe.LF){return true}if(t===Xe.L){if(e===Xe.L||e===Xe.V||e===Xe.LV||e===Xe.LVT){return false}}if(t===Xe.LV||t===Xe.V){if(e===Xe.V||e===Xe.T){return false}}if(t===Xe.LVT||t===Xe.T){if(e===Xe.T){return false}}if(e===Xe.Extend||e===Xe.ZWJ){return false}if(e===Xe.SpacingMark){return false}if(t===Xe.Prepend){return false}if(t===Xe.ZWJ&&e===Xe.Extended_Pictographic){return false}if(t===Xe.Regional_Indicator&&e===Xe.Regional_Indicator){return false}return true}var Xe;(function(t){t[t["Other"]=0]="Other";t[t["Prepend"]=1]="Prepend";t[t["CR"]=2]="CR";t[t["LF"]=3]="LF";t[t["Control"]=4]="Control";t[t["Extend"]=5]="Extend";t[t["Regional_Indicator"]=6]="Regional_Indicator";t[t["SpacingMark"]=7]="SpacingMark";t[t["L"]=8]="L";t[t["V"]=9]="V";t[t["T"]=10]="T";t[t["LV"]=11]="LV";t[t["LVT"]=12]="LVT";t[t["ZWJ"]=13]="ZWJ";t[t["Extended_Pictographic"]=14]="Extended_Pictographic"})(Xe||(Xe={}));class Wo{static{this._INSTANCE=null}static getInstance(){if(!Wo._INSTANCE){Wo._INSTANCE=new Wo}return Wo._INSTANCE}constructor(){this._data=dP()}getGraphemeBreakType(e){if(e<32){if(e===A.LineFeed){return Xe.LF}if(e===A.CarriageReturn){return Xe.CR}return Xe.Control}if(e<127){return Xe.Other}const i=this._data;const n=i.length/3;let s=1;while(s<=n){if(e<i[3*s]){s=2*s}else if(e>i[3*s+1]){s=2*s+1}else{return i[3*s+2]}}return Xe.Other}}function dP(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}var d_;(function(t){t[t["zwj"]=8205]="zwj";t[t["emojiVariantSelector"]=65039]="emojiVariantSelector";t[t["enclosingKeyCap"]=8419]="enclosingKeyCap";t[t["space"]=32]="space"})(d_||(d_={}));class nu{static{this.ambiguousCharacterData=new Fn(()=>{return JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,1523,96,8242,96,1370,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,118002,50,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,118003,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,118004,52,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,118005,53,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,118006,54,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,118007,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,118008,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,118009,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,117974,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,117975,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71913,67,71922,67,65315,67,8557,67,8450,67,8493,67,117976,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,117977,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,117978,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,117979,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,117980,71,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,117981,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,117983,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,117984,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,118001,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,117982,108,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,117985,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,117986,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,117987,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,118000,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,117988,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,117989,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,117990,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,117991,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,117992,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,117993,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,117994,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,117995,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71910,87,71919,87,117996,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,117997,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,117998,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,71909,90,66293,90,65338,90,8484,90,8488,90,117999,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65283,35,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"cs":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"es":[8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"fr":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"it":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"ja":[8211,45,8218,44,65281,33,8216,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65292,44,65297,49,65307,59],"ko":[8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"pt-BR":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"ru":[65374,126,8218,44,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,8218,44,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41,65292,44,65297,49,65307,59,65311,63],"zh-hans":[160,32,65374,126,8218,44,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65297,49],"zh-hant":[8211,45,65374,126,8218,44,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89]}')})}static{this.cache=new KT({getCacheKey:JSON.stringify},e=>{function i(u){const d=new Map;for(let p=0;p<u.length;p+=2){d.set(u[p],u[p+1])}return d}function n(u,d){const p=new Map(u);for(const[f,m]of d){p.set(f,m)}return p}function s(u,d){if(!u){return d}const p=new Map;for(const[f,m]of u){if(d.has(f)){p.set(f,m)}}return p}const r=this.ambiguousCharacterData.value;let o=e.filter(u=>!u.startsWith("_")&&u in r);if(o.length===0){o=["_default"]}let a=void 0;for(const u of o){const d=i(r[u]);a=s(a,d)}const l=i(r["_common"]);const c=n(l,a);return new nu(c)})}static getInstance(e){return nu.cache.get(Array.from(e))}static{this._locales=new Fn(()=>Object.keys(nu.ambiguousCharacterData.value).filter(e=>!e.startsWith("_")))}static getLocales(){return nu._locales.value}constructor(e){this.confusableDictionary=e}isAmbiguous(e){return this.confusableDictionary.has(e)}containsAmbiguousCharacter(e){for(let i=0;i<e.length;i++){const n=e.codePointAt(i);if(typeof n==="number"&&this.isAmbiguous(n)){return true}}return false}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}}class su{static getRawData(){return JSON.parse('{"_common":[11,12,13,127,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999],"cs":[173,8203,12288],"de":[173,8203,12288],"es":[8203,12288],"fr":[173,8203,12288],"it":[160,173,12288],"ja":[173],"ko":[173,12288],"pl":[173,8203,12288],"pt-BR":[173,8203,12288],"qps-ploc":[160,173,8203,12288],"ru":[173,12288],"tr":[160,173,8203,12288],"zh-hans":[160,173,8203,12288],"zh-hant":[173,12288]}')}static{this._data=void 0}static getData(){if(!this._data){this._data=new Set([...Object.values(su.getRawData())].flat())}return this._data}static isInvisibleCharacter(e){return su.getData().has(e)}static containsInvisibleCharacter(e){for(let i=0;i<e.length;i++){const n=e.codePointAt(i);if(typeof n==="number"&&(su.isInvisibleCharacter(n)||n===d_.space)){return true}}return false}static get codePoints(){return su.getData()}}function Lr(t){return t===A.Slash||t===A.Backslash}function pI(t){return t.replace(/[\\/]/g,ct.sep)}function hP(t){if(t.indexOf("/")===-1){t=pI(t)}if(/^[a-zA-Z]:(\/|$)/.test(t)){t="/"+t}return t}function vx(t,e=ct.sep){if(!t){return""}const i=t.length;const n=t.charCodeAt(0);if(Lr(n)){if(Lr(t.charCodeAt(1))){if(!Lr(t.charCodeAt(2))){let r=3;const o=r;for(;r<i;r++){if(Lr(t.charCodeAt(r))){break}}if(o!==r&&!Lr(t.charCodeAt(r+1))){r+=1;for(;r<i;r++){if(Lr(t.charCodeAt(r))){return t.slice(0,r+1).replace(/[\\/]/g,e)}}}}}return e}else if(gI(n)){if(t.charCodeAt(1)===A.Colon){if(Lr(t.charCodeAt(2))){return t.slice(0,2)+e}else{return t.slice(0,2)}}}let s=t.indexOf("://");if(s!==-1){s+=3;for(;s<i;s++){if(Lr(t.charCodeAt(s))){return t.slice(0,s+1)}}}return""}function Uf(t,e,i,n=os){if(t===e){return true}if(!t||!e){return false}if(e.length>t.length){return false}if(i){const s=E0(t,e);if(!s){return false}if(e.length===t.length){return true}let r=e.length;if(e.charAt(e.length-1)===n){r--}return t.charAt(r)===n}if(e.charAt(e.length-1)!==n){e+=n}return t.indexOf(e)===0}function gI(t){return t>=A.A&&t<=A.Z||t>=A.a&&t<=A.z}function fP(t,e=Yi){if(e){return gI(t.charCodeAt(0))&&t.charCodeAt(1)===A.Colon}return false}var ae;(function(t){t.inMemory="inmemory";t.vscode="vscode";t.internal="private";t.walkThrough="walkThrough";t.walkThroughSnippet="walkThroughSnippet";t.http="http";t.https="https";t.file="file";t.mailto="mailto";t.untitled="untitled";t.data="data";t.command="command";t.vscodeRemote="vscode-remote";t.vscodeRemoteResource="vscode-remote-resource";t.vscodeManagedRemoteResource="vscode-managed-remote-resource";t.vscodeUserData="vscode-userdata";t.vscodeCustomEditor="vscode-custom-editor";t.vscodeNotebookCell="vscode-notebook-cell";t.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata";t.vscodeNotebookCellMetadataDiff="vscode-notebook-cell-metadata-diff";t.vscodeNotebookCellOutput="vscode-notebook-cell-output";t.vscodeNotebookCellOutputDiff="vscode-notebook-cell-output-diff";t.vscodeNotebookMetadata="vscode-notebook-metadata";t.vscodeInteractiveInput="vscode-interactive-input";t.vscodeSettings="vscode-settings";t.vscodeWorkspaceTrust="vscode-workspace-trust";t.vscodeTerminal="vscode-terminal";t.vscodeChatCodeBlock="vscode-chat-code-block";t.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block";t.vscodeChatSesssion="vscode-chat-editor";t.webviewPanel="webview-panel";t.vscodeWebview="vscode-webview";t.extension="extension";t.vscodeFileResource="vscode-file";t.tmp="tmp";t.vsls="vsls";t.vscodeSourceControl="vscode-scm";t.commentsInput="comment";t.codeSetting="code-setting";t.outputChannel="output";t.accessibleView="accessible-view"})(ae||(ae={}));function h_(t,e){if(b.isUri(t)){return io(t.scheme,e)}else{return E0(t,e+":")}}function pP(t,...e){return e.some(i=>h_(t,i))}const gP="tkn";class mP{constructor(){this._hosts=Object.create(null);this._ports=Object.create(null);this._connectionTokens=Object.create(null);this._preferredWebSchema="http";this._delegate=null;this._serverRootPath="/"}setPreferredWebSchema(e){this._preferredWebSchema=e}setDelegate(e){this._delegate=e}setServerRootPath(e,i){this._serverRootPath=ct.join(i??"/",vP(e))}getServerRootPath(){return this._serverRootPath}get _remoteResourcesPath(){return ct.join(this._serverRootPath,ae.vscodeRemoteResource)}set(e,i,n){this._hosts[e]=i;this._ports[e]=n}setConnectionToken(e,i){this._connectionTokens[e]=i}getPreferredWebSchema(){return this._preferredWebSchema}rewrite(e){if(this._delegate){try{return this._delegate(e)}catch(a){Pi(a);return e}}const i=e.authority;let n=this._hosts[i];if(n&&n.indexOf(":")!==-1&&n.indexOf("[")===-1){n=`[${n}]`}const s=this._ports[i];const r=this._connectionTokens[i];let o=`path=${encodeURIComponent(e.path)}`;if(typeof r==="string"){o+=`&${gP}=${encodeURIComponent(r)}`}return b.from({scheme:oh?this._preferredWebSchema:ae.vscodeRemoteResource,authority:`${n}:${s}`,path:this._remoteResourcesPath,query:o})}}const _P=new mP;function vP(t){return`${t.quality??"oss"}-${t.commit??"dev"}`}const wP="vscode-app";class pu{constructor(){this.staticBrowserUris=new Ft;this.appResourcePathUrls=new Map}static{this.FALLBACK_AUTHORITY=wP}registerAppResourcePathUrl(e,i){this.appResourcePathUrls.set(e,i)}toUrl(e){let i=this.appResourcePathUrls.get(e);if(typeof i==="function"){i=i()}return new URL(i??e,globalThis.location?.href??import.meta.url).toString()}asBrowserUri(e){const i=this.toUri(e);return this.uriToBrowserUri(i)}uriToBrowserUri(e){if(e.scheme===ae.vscodeRemote){return _P.rewrite(e)}if(e.scheme===ae.file&&(Yk||ET===`${ae.vscodeFileResource}://${pu.FALLBACK_AUTHORITY}`)){return e.with({scheme:ae.vscodeFileResource,authority:e.authority||pu.FALLBACK_AUTHORITY,query:null,fragment:null})}return this.staticBrowserUris.get(e)??e}asFileUri(e){const i=this.toUri(e);return this.uriToFileUri(i)}uriToFileUri(e){if(e.scheme===ae.vscodeFileResource){return e.with({scheme:ae.file,authority:e.authority!==pu.FALLBACK_AUTHORITY?e.authority:null,query:null,fragment:null})}return e}toUri(e){if(b.isUri(e)){return e}if(globalThis._VSCODE_FILE_ROOT){const i=globalThis._VSCODE_FILE_ROOT;if(/^\w[\w\d+.-]*:\/\//.test(i)){return b.joinPath(b.parse(i,true),e)}const n=r_(i,e);return b.file(n)}return b.parse(this.toUrl(e))}registerStaticBrowserUri(e,i){this.staticBrowserUris.set(e,i);return ge(()=>{if(this.staticBrowserUris.get(e)===i){this.staticBrowserUris.delete(e)}})}getRegisteredBrowserUris(){return this.staticBrowserUris.keys()}}new pu;var wx;(function(t){const e=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);t.CoopAndCoep=Object.freeze(e.get("3"));const i="vscode-coi";function n(r){let o;if(typeof r==="string"){o=new URL(r).searchParams}else if(r instanceof URL){o=r.searchParams}else if(b.isUri(r)){o=new URL(r.toString(true)).searchParams}const a=o?.get(i);if(!a){return void 0}return e.get(a)}t.getHeadersFromQuery=n;function s(r,o,a){if(!globalThis.crossOriginIsolated){return}const l=o&&a?"3":a?"2":"1";if(r instanceof URLSearchParams){r.set(i,l)}else{r[i]=l}}t.addSearchParam=s})(wx||(wx={}));function Wn(t){return Ff(t,true)}class lh{constructor(e){this._ignorePathCasing=e}compare(e,i,n=false){if(e===i){return 0}return xa(this.getComparisonKey(e,n),this.getComparisonKey(i,n))}isEqual(e,i,n=false){if(e===i){return true}if(!e||!i){return false}return this.getComparisonKey(e,n)===this.getComparisonKey(i,n)}getComparisonKey(e,i=false){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:i?null:void 0}).toString()}ignorePathCasing(e){return this._ignorePathCasing(e)}isEqualOrParent(e,i,n=false){if(e.scheme===i.scheme){if(e.scheme===ae.file){return Uf(Wn(e),Wn(i),this._ignorePathCasing(e))&&e.query===i.query&&(n||e.fragment===i.fragment)}if(bx(e.authority,i.authority)){return Uf(e.path,i.path,this._ignorePathCasing(e),"/")&&e.query===i.query&&(n||e.fragment===i.fragment)}}return false}joinPath(e,...i){return b.joinPath(e,...i)}basenameOrAuthority(e){return $s(e)||e.authority}basename(e){return ct.basename(e.path)}extname(e){return ct.extname(e.path)}dirname(e){if(e.path.length===0){return e}let i;if(e.scheme===ae.file){i=b.file(El(Wn(e))).path}else{i=ct.dirname(e.path);if(e.authority&&i.length&&i.charCodeAt(0)!==A.Slash){console.error(`dirname("${e.toString})) resulted in a relative path`);i="/"}}return e.with({path:i})}normalizePath(e){if(!e.path.length){return e}let i;if(e.scheme===ae.file){i=b.file(jl(Wn(e))).path}else{i=ct.normalize(e.path)}return e.with({path:i})}relativePath(e,i){if(e.scheme!==i.scheme||!bx(e.authority,i.authority)){return void 0}if(e.scheme===ae.file){const r=Ku(Wn(e),Wn(i));return Yi?pI(r):r}let n=e.path||"/";const s=i.path||"/";if(this._ignorePathCasing(e)){let r=0;for(const o=Math.min(n.length,s.length);r<o;r++){if(n.charCodeAt(r)!==s.charCodeAt(r)){if(n.charAt(r).toLowerCase()!==s.charAt(r).toLowerCase()){break}}}n=s.substr(0,r)+n.substr(r)}return ct.relative(n,s)}resolvePath(e,i){if(e.scheme===ae.file){const n=b.file(UT(Wn(e),i));return e.with({authority:n.authority,path:n.path})}i=hP(i);return e.with({path:ct.resolve(e.path,i)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,i){return e===i||e!==void 0&&i!==void 0&&io(e,i)}hasTrailingPathSeparator(e,i=os){if(e.scheme===ae.file){const n=Wn(e);return n.length>vx(n).length&&n[n.length-1]===i}else{const n=e.path;return n.length>1&&n.charCodeAt(n.length-1)===A.Slash&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,i=os){if(yx(e,i)){return e.with({path:e.path.substr(0,e.path.length-1)})}return e}addTrailingPathSeparator(e,i=os){let n=false;if(e.scheme===ae.file){const s=Wn(e);n=s!==void 0&&s.length===vx(s).length&&s[s.length-1]===i}else{i="/";const s=e.path;n=s.length===1&&s.charCodeAt(s.length-1)===A.Slash}if(!n&&!yx(e,i)){return e.with({path:e.path+"/"})}return e}}const nt=new lh(()=>false);const bP=new lh(t=>{return t.scheme===ae.file?!Er:true});const yP=new lh(t=>true);const Sl=nt.isEqual.bind(nt);nt.isEqualOrParent.bind(nt);nt.getComparisonKey.bind(nt);const f_=nt.basenameOrAuthority.bind(nt);const $s=nt.basename.bind(nt);const xP=nt.extname.bind(nt);const vm=nt.dirname.bind(nt);const ki=nt.joinPath.bind(nt);nt.normalizePath.bind(nt);const mI=nt.relativePath.bind(nt);nt.resolvePath.bind(nt);const EP=nt.isAbsolutePath.bind(nt);const bx=nt.isEqualAuthority.bind(nt);const yx=nt.hasTrailingPathSeparator.bind(nt);nt.removeTrailingPathSeparator.bind(nt);nt.addTrailingPathSeparator.bind(nt);var xx;(function(t){t.META_DATA_LABEL="label";t.META_DATA_DESCRIPTION="description";t.META_DATA_SIZE="size";t.META_DATA_MIME="mime";function e(i){const n=new Map;const s=i.path.substring(i.path.indexOf(";")+1,i.path.lastIndexOf(";"));s.split(";").forEach(o=>{const[a,l]=o.split(":");if(a&&l){n.set(a,l)}});const r=i.path.substring(0,i.path.indexOf(";"));if(r){n.set(t.META_DATA_MIME,r)}return n}t.parseMetaData=e})(xx||(xx={}));const SP=Symbol("MicrotaskDelay");function po(t){return!!t&&typeof t.then==="function"}function DP(t){const e=new Ot;const i=t(e.token);let n=false;const s=new Promise((r,o)=>{const a=e.token.onCancellationRequested(()=>{n=true;a.dispose();o(new Us)});Promise.resolve(i).then(l=>{a.dispose();e.dispose();if(!n){r(l)}else if(Vk(l)){l.dispose()}},l=>{a.dispose();e.dispose();o(l)})});return new class{cancel(){e.cancel();e.dispose()}then(r,o){return s.then(r,o)}catch(r){return this.then(void 0,r)}finally(r){return s.finally(r)}}}function _I(t,e,i){return new Promise((n,s)=>{const r=e.onCancellationRequested(()=>{r.dispose();n(i)});t.then(n,s).finally(()=>r.dispose())})}function vI(t,e){return new Promise((i,n)=>{const s=e.onCancellationRequested(()=>{s.dispose();n(new Us)});t.then(i,n).finally(()=>s.dispose())})}function Ci(t){return new Promise((e,i)=>{const n=t();if(po(n)){n.then(e,i)}else{e(n)}})}function kP(){let t;let e;const i=new Promise((n,s)=>{t=n;e=s});return{promise:i,resolve:t,reject:e}}let IP=class pM{constructor(){this.isDisposed=false;this.activePromise=null;this.queuedPromise=null;this.queuedPromiseFactory=null}queue(e){if(this.isDisposed){return Promise.reject(new Error("Throttler is disposed"))}if(this.activePromise){this.queuedPromiseFactory=e;if(!this.queuedPromise){const i=()=>{this.queuedPromise=null;if(this.isDisposed){return}const n=this.queue(this.queuedPromiseFactory);this.queuedPromiseFactory=null;return n};this.queuedPromise=new Promise(n=>{this.activePromise.then(i,i).then(n)})}return new Promise((i,n)=>{this.queuedPromise.then(i,n)})}this.activePromise=e();return new Promise((i,n)=>{this.activePromise.then(s=>{this.activePromise=null;i(s)},s=>{this.activePromise=null;n(s)})})}dispose(){this.isDisposed=true}};class CP{constructor(){this.current=Promise.resolve(null)}queue(e){return this.current=this.current.then(()=>e(),()=>e())}}const TP=(t,e)=>{let i=true;const n=setTimeout(()=>{i=false;e()},t);return{isTriggered:()=>i,dispose:()=>{clearTimeout(n);i=false}}};const PP=t=>{let e=true;queueMicrotask(()=>{if(e){e=false;t()}});return{isTriggered:()=>e,dispose:()=>{e=false}}};class AP{constructor(e){this.defaultDelay=e;this.deferred=null;this.completionPromise=null;this.doResolve=null;this.doReject=null;this.task=null}trigger(e,i=this.defaultDelay){this.task=e;this.cancelTimeout();if(!this.completionPromise){this.completionPromise=new Promise((s,r)=>{this.doResolve=s;this.doReject=r}).then(()=>{this.completionPromise=null;this.doResolve=null;if(this.task){const s=this.task;this.task=null;return s()}return void 0})}const n=()=>{this.deferred=null;this.doResolve?.(null)};this.deferred=i===SP?PP(n):TP(i,n);return this.completionPromise}isTriggered(){return!!this.deferred?.isTriggered()}cancel(){this.cancelTimeout();if(this.completionPromise){this.doReject?.(new Us);this.completionPromise=null}}cancelTimeout(){this.deferred?.dispose();this.deferred=null}dispose(){this.cancel()}}class RP{constructor(e){this.delayer=new AP(e);this.throttler=new IP}trigger(e,i){return this.delayer.trigger(()=>this.throttler.queue(e),i)}isTriggered(){return this.delayer.isTriggered()}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose();this.throttler.dispose()}}class xs{constructor(){this._isOpen=false;this._promise=new Promise((e,i)=>{this._completePromise=e})}isOpen(){return this._isOpen}open(){this._isOpen=true;this._completePromise(true)}wait(){return this._promise}}function Ts(t,e){if(!e){return DP(i=>Ts(t,i))}return new Promise((i,n)=>{const s=setTimeout(()=>{r.dispose();i()},t);const r=e.onCancellationRequested(()=>{clearTimeout(s);r.dispose();n(new Us)})})}function LP(t,e=0,i){const n=setTimeout(()=>{t()},e);const s=ge(()=>{clearTimeout(n)});return s}class NP{constructor(e){this._size=0;this._isDisposed=false;this.maxDegreeOfParalellism=e;this.outstandingPromises=[];this.runningPromises=0;this._onDrained=new L}whenIdle(){return this.size>0?Bt.toPromise(this.onDrained):Promise.resolve()}get onDrained(){return this._onDrained.event}get size(){return this._size}queue(e){if(this._isDisposed){throw new Error("Object has been disposed")}this._size++;return new Promise((i,n)=>{this.outstandingPromises.push({factory:e,c:i,e:n});this.consume()})}consume(){while(this.outstandingPromises.length&&this.runningPromises<this.maxDegreeOfParalellism){const e=this.outstandingPromises.shift();this.runningPromises++;const i=e.factory();i.then(e.c,e.e);i.then(()=>this.consumed(),()=>this.consumed())}}consumed(){if(this._isDisposed){return}this.runningPromises--;if(--this._size===0){this._onDrained.fire()}if(this.outstandingPromises.length>0){this.consume()}}clear(){if(this._isDisposed){throw new Error("Object has been disposed")}this.outstandingPromises.length=0;this._size=this.runningPromises}dispose(){this._isDisposed=true;this.outstandingPromises.length=0;this._size=0;this._onDrained.dispose()}}class OP extends NP{constructor(){super(1)}}class FP{constructor(){this.queues=new Map;this.drainers=new Set;this.drainListeners=void 0;this.drainListenerCount=0}async whenDrained(){if(this.isDrained()){return}const e=new Fs;this.drainers.add(e);return e.p}isDrained(){for(const[,e]of this.queues){if(e.size>0){return false}}return true}queueSize(e,i=nt){const n=i.getComparisonKey(e);return this.queues.get(n)?.size??0}queueFor(e,i,n=nt){const s=n.getComparisonKey(e);let r=this.queues.get(s);if(!r){r=new OP;const o=this.drainListenerCount++;const a=Bt.once(r.onDrained)(()=>{r?.dispose();this.queues.delete(s);this.onDidQueueDrain();this.drainListeners?.deleteAndDispose(o);if(this.drainListeners?.size===0){this.drainListeners.dispose();this.drainListeners=void 0}});if(!this.drainListeners){this.drainListeners=new Cf}this.drainListeners.set(o,a);this.queues.set(s,r)}return r.queue(i)}onDidQueueDrain(){if(!this.isDrained()){return}this.releaseDrainers()}releaseDrainers(){for(const e of this.drainers){e.complete()}this.drainers.clear()}dispose(){for(const[,e]of this.queues){e.dispose()}this.queues.clear();this.releaseDrainers();this.drainListeners?.dispose()}}class MP{constructor(){this.disposable=void 0;this.isDisposed=false}cancel(){this.disposable?.dispose();this.disposable=void 0}cancelAndSet(e,i,n=globalThis){if(this.isDisposed){throw new Ji(`Calling 'cancelAndSet' on a disposed IntervalTimer`)}this.cancel();const s=n.setInterval(()=>{e()},i);this.disposable=ge(()=>{n.clearInterval(s);this.disposable=void 0})}dispose(){this.cancel();this.isDisposed=true}}class Ic{constructor(e,i){this.timeoutToken=-1;this.runner=e;this.timeout=i;this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel();this.runner=null}cancel(){if(this.isScheduled()){clearTimeout(this.timeoutToken);this.timeoutToken=-1}}schedule(e=this.timeout){this.cancel();this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return this.timeoutToken!==-1}flush(){if(this.isScheduled()){this.cancel();this.doRun()}}onTimeout(){this.timeoutToken=-1;if(this.runner){this.doRun()}}doRun(){this.runner?.()}}let wI;let Yh;(function(){if(typeof globalThis.requestIdleCallback!=="function"||typeof globalThis.cancelIdleCallback!=="function"){Yh=(t,e,i)=>{Zk(()=>{if(n){return}const s=Date.now()+15;const r={didTimeout:true,timeRemaining(){return Math.max(0,s-Date.now())}};e(Object.freeze(r))});let n=false;return{dispose(){if(n){return}n=true}}}}else{Yh=(t,e,i)=>{const n=t.requestIdleCallback(e,typeof i==="number"?{timeout:i}:void 0);let s=false;return{dispose(){if(s){return}s=true;t.cancelIdleCallback(n)}}}}wI=(t,e)=>Yh(globalThis,t,e)})();class UP{constructor(e,i){this._didRun=false;this._executor=()=>{try{this._value=i()}catch(n){this._error=n}finally{this._didRun=true}};this._handle=Yh(e,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(!this._didRun){this._handle.dispose();this._executor()}if(this._error){throw this._error}return this._value}get isInitialized(){return this._didRun}}class $P extends UP{constructor(e){super(globalThis,e)}}var Lo;(function(t){t[t["Resolved"]=0]="Resolved";t[t["Rejected"]=1]="Rejected"})(Lo||(Lo={}));class Fs{get isRejected(){return this.outcome?.outcome===Lo.Rejected}get isResolved(){return this.outcome?.outcome===Lo.Resolved}get isSettled(){return!!this.outcome}get value(){return this.outcome?.outcome===Lo.Resolved?this.outcome?.value:void 0}constructor(){this.p=new Promise((e,i)=>{this.completeCallback=e;this.errorCallback=i})}complete(e){return new Promise(i=>{this.completeCallback(e);this.outcome={outcome:Lo.Resolved,value:e};i()})}error(e){return new Promise(i=>{this.errorCallback(e);this.outcome={outcome:Lo.Rejected,value:e};i()})}cancel(){return this.error(new Us)}}var Gl;(function(t){async function e(n){let s=void 0;const r=await Promise.all(n.map(o=>o.then(a=>a,a=>{if(!s){s=a}return void 0})));if(typeof s!=="undefined"){throw s}return r}t.settled=e;function i(n){return new Promise(async(s,r)=>{try{await n(s,r)}catch(o){r(o)}})}t.withAsyncBody=i})(Gl||(Gl={}));var zn;(function(t){t[t["Initial"]=0]="Initial";t[t["DoneOK"]=1]="DoneOK";t[t["DoneError"]=2]="DoneError"})(zn||(zn={}));class Ei{static fromArray(e){return new Ei(i=>{i.emitMany(e)})}static fromPromise(e){return new Ei(async i=>{i.emitMany(await e)})}static fromPromisesResolveOrder(e){return new Ei(async i=>{await Promise.all(e.map(async n=>i.emitOne(await n)))})}static merge(e){return new Ei(async i=>{await Promise.all(e.map(async n=>{for await(const s of n){i.emitOne(s)}}))})}static{this.EMPTY=Ei.fromArray([])}constructor(e,i){this._state=zn.Initial;this._results=[];this._error=null;this._onReturn=i;this._onStateChanged=new L;queueMicrotask(async()=>{const n={emitOne:s=>this.emitOne(s),emitMany:s=>this.emitMany(s),reject:s=>this.reject(s)};try{await Promise.resolve(e(n));this.resolve()}catch(s){this.reject(s)}finally{n.emitOne=void 0;n.emitMany=void 0;n.reject=void 0}})}[Symbol.asyncIterator](){let e=0;return{next:async()=>{do{if(this._state===zn.DoneError){throw this._error}if(e<this._results.length){return{done:false,value:this._results[e++]}}if(this._state===zn.DoneOK){return{done:true,value:void 0}}await Bt.toPromise(this._onStateChanged.event)}while(true)},return:async()=>{this._onReturn?.();return{done:true,value:void 0}}}}static map(e,i){return new Ei(async n=>{for await(const s of e){n.emitOne(i(s))}})}map(e){return Ei.map(this,e)}static filter(e,i){return new Ei(async n=>{for await(const s of e){if(i(s)){n.emitOne(s)}}})}filter(e){return Ei.filter(this,e)}static coalesce(e){return Ei.filter(e,i=>!!i)}coalesce(){return Ei.coalesce(this)}static async toPromise(e){const i=[];for await(const n of e){i.push(n)}return i}toPromise(){return Ei.toPromise(this)}emitOne(e){if(this._state!==zn.Initial){return}this._results.push(e);this._onStateChanged.fire()}emitMany(e){if(this._state!==zn.Initial){return}this._results=this._results.concat(e);this._onStateChanged.fire()}resolve(){if(this._state!==zn.Initial){return}this._state=zn.DoneOK;this._onStateChanged.fire()}reject(e){if(this._state!==zn.Initial){return}this._state=zn.DoneError;this._error=e;this._onStateChanged.fire()}}class p_{constructor(e){this._deferred=new Fs;this._asyncIterable=new Ei(s=>{if(i){s.reject(i);return}if(n){s.emitMany(n)}this._errorFn=r=>s.reject(r);this._emitFn=r=>s.emitOne(r);return this._deferred.p},e);let i;let n;this._emitFn=s=>{if(!n){n=[]}n.push(s)};this._errorFn=s=>{if(!i){i=s}}}get asyncIterable(){return this._asyncIterable}resolve(){this._deferred.complete()}reject(e){this._errorFn(e);this._deferred.complete()}emitOne(e){this._emitFn(e)}}function bI(t,e,i,n){if(!t||n>200){return null}if(typeof t==="object"){if(t.$mid===it.Uri){return i?b.revive(e.transformIncoming(t)):e.transformIncoming(t)}if(t instanceof ue){return null}for(const s in t){if(Object.hasOwnProperty.call(t,s)){const r=bI(t[s],e,i,n+1);if(r!==null){t[s]=r}}}}return null}function Vc(t,e){const i=bI(t,e,false,0);if(i===null){return t}return i}class yI{constructor(){this._actual=null;this._actualOk=null;this._actualErr=null;this._hasValue=false;this._value=null;this._hasErr=false;this._err=null}get[Symbol.toStringTag](){return this.toString()}_ensureActual(){if(!this._actual){this._actual=new Promise((e,i)=>{this._actualOk=e;this._actualErr=i;if(this._hasValue){this._actualOk(this._value)}if(this._hasErr){this._actualErr(this._err)}})}return this._actual}resolveOk(e){if(this._hasValue||this._hasErr){return}this._hasValue=true;this._value=e;if(this._actual){this._actualOk(e)}}resolveErr(e){if(this._hasValue||this._hasErr){return}this._hasErr=true;this._err=e;if(this._actual){this._actualErr(e)}else{Pi(e)}}then(e,i){return this._ensureActual().then(e,i)}catch(e){return this._ensureActual().then(void 0,e)}finally(e){return this._ensureActual().finally(e)}}class HP extends yI{constructor(){super();this._hasErr=true;this._err=new Us}}var Ex;function g_(t,e){try{return JSON.stringify(t,e)}catch(i){return"null"}}const D0="$$ref$$";const BP={[D0]:-1};function Sx(t,e=null,i=false){const n=[];const s=(i?g_:JSON.stringify)(t,(r,o)=>{if(typeof o==="undefined"){return BP}else if(typeof o==="object"){if(o instanceof ue){const a=n.push(o)-1;return{[D0]:a}}if(e){return e(r,o)}}return o});return{jsonString:s,referencedBuffers:n}}function xI(t,e,i){return JSON.parse(t,(n,s)=>{if(s){const r=s[D0];if(typeof r==="number"){return e[r]}if(i&&s.$mid===it.Uri){return i.transformIncoming(s)}}return s})}function Dx(t,e){return JSON.stringify(t,e)}function VP(t){if(!t){return null}return(e,i)=>{if(i&&i.$mid===it.Uri){return t.transformOutgoing(i)}return i}}var Pn;(function(t){t[t["LocalSide"]=0]="LocalSide";t[t["OtherSide"]=1]="OtherSide"})(Pn||(Pn={}));var gu;(function(t){t[t["Responsive"]=0]="Responsive";t[t["Unresponsive"]=1]="Unresponsive"})(gu||(gu={}));const WP=()=>{};const zP=Symbol.for("rpcProtocol");const qP=Symbol.for("rpcProxy");class $f extends Ee{static{Ex=zP}static{this.UNRESPONSIVE_TIME=3*1e3}constructor(e,i=null,n=null){super();this[Ex]=true;this._onDidChangeResponsiveState=this._register(new L);this.onDidChangeResponsiveState=this._onDidChangeResponsiveState.event;this._protocol=e;this._logger=i;this._uriTransformer=n;this._uriReplacer=VP(this._uriTransformer);this._isDisposed=false;this._locals=[];this._proxies=[];for(let s=0,r=mm.count;s<r;s++){this._locals[s]=null;this._proxies[s]=null}this._lastMessageId=0;this._cancelInvokedHandlers=Object.create(null);this._pendingRPCReplies={};this._responsiveState=gu.Responsive;this._unacknowledgedCount=0;this._unresponsiveTime=0;this._asyncCheckUresponsive=this._register(new Ic(()=>this._checkUnresponsive(),1e3));this._register(this._protocol.onMessage(s=>this._receiveOneMessage(s)))}dispose(){this._isDisposed=true;Object.keys(this._pendingRPCReplies).forEach(e=>{const i=this._pendingRPCReplies[e];delete this._pendingRPCReplies[e];i.resolveErr(jy())});super.dispose()}drain(){if(typeof this._protocol.drain==="function"){return this._protocol.drain()}return Promise.resolve()}_onWillSendRequest(e){if(this._unacknowledgedCount===0){this._unresponsiveTime=Date.now()+$f.UNRESPONSIVE_TIME}this._unacknowledgedCount++;if(!this._asyncCheckUresponsive.isScheduled()){this._asyncCheckUresponsive.schedule()}}_onDidReceiveAcknowledge(e){this._unresponsiveTime=Date.now()+$f.UNRESPONSIVE_TIME;this._unacknowledgedCount--;if(this._unacknowledgedCount===0){this._asyncCheckUresponsive.cancel()}this._setResponsiveState(gu.Responsive)}_checkUnresponsive(){if(this._unacknowledgedCount===0){return}if(Date.now()>this._unresponsiveTime){this._setResponsiveState(gu.Unresponsive)}else{this._asyncCheckUresponsive.schedule()}}_setResponsiveState(e){if(this._responsiveState===e){return}this._responsiveState=e;this._onDidChangeResponsiveState.fire(this._responsiveState)}get responsiveState(){return this._responsiveState}transformIncomingURIs(e){if(!this._uriTransformer){return e}return Vc(e,this._uriTransformer)}getProxy(e){const{nid:i,sid:n}=e;if(!this._proxies[i]){this._proxies[i]=this._createProxy(i,n)}return this._proxies[i]}_createProxy(e,i){const n={get:(s,r)=>{if(typeof r==="string"&&!s[r]&&r.charCodeAt(0)===A.DollarSign){s[r]=(...o)=>{return this._remoteCall(e,r,o)}}if(r===qP){return i}return s[r]}};return new Proxy(Object.create(null),n)}set(e,i){this._locals[e.nid]=i;return i}assertRegistered(e){for(let i=0,n=e.length;i<n;i++){const s=e[i];if(!this._locals[s.nid]){throw new Error(`Missing proxy instance ${s.sid}`)}}}_receiveOneMessage(e){if(this._isDisposed){return}const i=e.byteLength;const n=Lt.read(e,0);const s=n.readUInt8();const r=n.readUInt32();switch(s){case Dt.RequestJSONArgs:case Dt.RequestJSONArgsWithCancellation:{let{rpcId:o,method:a,args:l}=Tn.deserializeRequestJSONArgs(n);if(this._uriTransformer){l=Vc(l,this._uriTransformer)}this._receiveRequest(i,r,o,a,l,s===Dt.RequestJSONArgsWithCancellation);break}case Dt.RequestMixedArgs:case Dt.RequestMixedArgsWithCancellation:{let{rpcId:o,method:a,args:l}=Tn.deserializeRequestMixedArgs(n);if(this._uriTransformer){l=Vc(l,this._uriTransformer)}this._receiveRequest(i,r,o,a,l,s===Dt.RequestMixedArgsWithCancellation);break}case Dt.Acknowledged:{this._logger?.logIncoming(i,r,Pn.LocalSide,`ack`);this._onDidReceiveAcknowledge(r);break}case Dt.Cancel:{this._receiveCancel(i,r);break}case Dt.ReplyOKEmpty:{this._receiveReply(i,r,void 0);break}case Dt.ReplyOKJSON:{let o=Tn.deserializeReplyOKJSON(n);if(this._uriTransformer){o=Vc(o,this._uriTransformer)}this._receiveReply(i,r,o);break}case Dt.ReplyOKJSONWithBuffers:{const o=Tn.deserializeReplyOKJSONWithBuffers(n,this._uriTransformer);this._receiveReply(i,r,o);break}case Dt.ReplyOKVSBuffer:{const o=Tn.deserializeReplyOKVSBuffer(n);this._receiveReply(i,r,o);break}case Dt.ReplyErrError:{let o=Tn.deserializeReplyErrError(n);if(this._uriTransformer){o=Vc(o,this._uriTransformer)}this._receiveReplyErr(i,r,o);break}case Dt.ReplyErrEmpty:{this._receiveReplyErr(i,r,void 0);break}default:console.error(`received unexpected message`);console.error(e)}}_receiveRequest(e,i,n,s,r,o){this._logger?.logIncoming(e,i,Pn.OtherSide,`receiveRequest ${Dh(n)}.${s}(`,r);const a=String(i);let l;let c;if(o){const d=new Ot;r.push(d.token);l=this._invokeHandler(n,s,r);c=()=>d.cancel()}else{l=this._invokeHandler(n,s,r);c=WP}this._cancelInvokedHandlers[a]=c;const u=Tn.serializeAcknowledged(i);this._logger?.logOutgoing(u.byteLength,i,Pn.OtherSide,`ack`);this._protocol.send(u);l.then(d=>{delete this._cancelInvokedHandlers[a];const p=Tn.serializeReplyOK(i,d,this._uriReplacer);this._logger?.logOutgoing(p.byteLength,i,Pn.OtherSide,`reply:`,d);this._protocol.send(p)},d=>{delete this._cancelInvokedHandlers[a];const p=Tn.serializeReplyErr(i,d);this._logger?.logOutgoing(p.byteLength,i,Pn.OtherSide,`replyErr:`,d);this._protocol.send(p)})}_receiveCancel(e,i){this._logger?.logIncoming(e,i,Pn.OtherSide,`receiveCancel`);const n=String(i);this._cancelInvokedHandlers[n]?.()}_receiveReply(e,i,n){this._logger?.logIncoming(e,i,Pn.LocalSide,`receiveReply:`,n);const s=String(i);if(!this._pendingRPCReplies.hasOwnProperty(s)){return}const r=this._pendingRPCReplies[s];delete this._pendingRPCReplies[s];r.resolveOk(n)}_receiveReplyErr(e,i,n){this._logger?.logIncoming(e,i,Pn.LocalSide,`receiveReplyErr:`,n);const s=String(i);if(!this._pendingRPCReplies.hasOwnProperty(s)){return}const r=this._pendingRPCReplies[s];delete this._pendingRPCReplies[s];let o=void 0;if(n){if(n.$isError){o=new Error;o.name=n.name;o.message=n.message;o.stack=n.stack}else{o=n}}r.resolveErr(o)}_invokeHandler(e,i,n){try{return Promise.resolve(this._doInvokeHandler(e,i,n))}catch(s){return Promise.reject(s)}}_doInvokeHandler(e,i,n){const s=this._locals[e];if(!s){throw new Error("Unknown actor "+Dh(e))}const r=s[i];if(typeof r!=="function"){throw new Error("Unknown method "+i+" on actor "+Dh(e))}return r.apply(s,n)}_remoteCall(e,i,n){if(this._isDisposed){return new HP}let s=null;if(n.length>0&&bt.isCancellationToken(n[n.length-1])){s=n.pop()}if(s&&s.isCancellationRequested){return Promise.reject(jy())}const r=Tn.serializeRequestArguments(n,this._uriReplacer);const o=++this._lastMessageId;const a=String(o);const l=new yI;const c=new Ie;if(s){c.add(s.onCancellationRequested(()=>{const d=Tn.serializeCancel(o);this._logger?.logOutgoing(d.byteLength,o,Pn.LocalSide,`cancel`);this._protocol.send(d)}))}this._pendingRPCReplies[a]=new jP(l,c);this._onWillSendRequest(o);const u=Tn.serializeRequest(o,e,i,r,!!s);this._logger?.logOutgoing(u.byteLength,o,Pn.LocalSide,`request: ${Dh(e)}.${i}(`,n);this._protocol.send(u);return l}}class jP{constructor(e,i){this._promise=e;this._disposable=i}resolveOk(e){this._promise.resolveOk(e);this._disposable.dispose()}resolveErr(e){this._promise.resolveErr(e);this._disposable.dispose()}}class Lt{static alloc(e,i,n){const s=new Lt(ue.alloc(n+1+4),0);s.writeUInt8(e);s.writeUInt32(i);return s}static read(e,i){return new Lt(e,i)}get buffer(){return this._buff}constructor(e,i){this._buff=e;this._offset=i}static sizeUInt8(){return 1}static{this.sizeUInt32=4}writeUInt8(e){this._buff.writeUInt8(e,this._offset);this._offset+=1}readUInt8(){const e=this._buff.readUInt8(this._offset);this._offset+=1;return e}writeUInt32(e){this._buff.writeUInt32BE(e,this._offset);this._offset+=4}readUInt32(){const e=this._buff.readUInt32BE(this._offset);this._offset+=4;return e}static sizeShortString(e){return 1+e.byteLength}writeShortString(e){this._buff.writeUInt8(e.byteLength,this._offset);this._offset+=1;this._buff.set(e,this._offset);this._offset+=e.byteLength}readShortString(){const e=this._buff.readUInt8(this._offset);this._offset+=1;const i=this._buff.slice(this._offset,this._offset+e);const n=i.toString();this._offset+=e;return n}static sizeLongString(e){return 4+e.byteLength}writeLongString(e){this._buff.writeUInt32BE(e.byteLength,this._offset);this._offset+=4;this._buff.set(e,this._offset);this._offset+=e.byteLength}readLongString(){const e=this._buff.readUInt32BE(this._offset);this._offset+=4;const i=this._buff.slice(this._offset,this._offset+e);const n=i.toString();this._offset+=e;return n}writeBuffer(e){this._buff.writeUInt32BE(e.byteLength,this._offset);this._offset+=4;this._buff.set(e,this._offset);this._offset+=e.byteLength}static sizeVSBuffer(e){return 4+e.byteLength}writeVSBuffer(e){this._buff.writeUInt32BE(e.byteLength,this._offset);this._offset+=4;this._buff.set(e,this._offset);this._offset+=e.byteLength}readVSBuffer(){const e=this._buff.readUInt32BE(this._offset);this._offset+=4;const i=this._buff.slice(this._offset,this._offset+e);this._offset+=e;return i}static sizeMixedArray(e){let i=0;i+=1;for(let n=0,s=e.length;n<s;n++){const r=e[n];i+=1;switch(r.type){case ri.String:i+=this.sizeLongString(r.value);break;case ri.VSBuffer:i+=this.sizeVSBuffer(r.value);break;case ri.SerializedObjectWithBuffers:i+=this.sizeUInt32;i+=this.sizeLongString(r.value);for(let o=0;o<r.buffers.length;++o){i+=this.sizeVSBuffer(r.buffers[o])}break}}return i}writeMixedArray(e){this._buff.writeUInt8(e.length,this._offset);this._offset+=1;for(let i=0,n=e.length;i<n;i++){const s=e[i];switch(s.type){case ri.String:this.writeUInt8(ri.String);this.writeLongString(s.value);break;case ri.VSBuffer:this.writeUInt8(ri.VSBuffer);this.writeVSBuffer(s.value);break;case ri.SerializedObjectWithBuffers:this.writeUInt8(ri.SerializedObjectWithBuffers);this.writeUInt32(s.buffers.length);this.writeLongString(s.value);for(let r=0;r<s.buffers.length;++r){this.writeBuffer(s.buffers[r])}break;case ri.Undefined:this.writeUInt8(ri.Undefined);break}}}readMixedArray(){const e=this._buff.readUInt8(this._offset);this._offset+=1;const i=new Array(e);for(let n=0;n<e;n++){const s=this.readUInt8();switch(s){case ri.String:i[n]=this.readLongString();break;case ri.VSBuffer:i[n]=this.readVSBuffer();break;case ri.SerializedObjectWithBuffers:{const r=this.readUInt32();const o=this.readLongString();const a=[];for(let l=0;l<r;++l){a.push(this.readVSBuffer())}i[n]=new Bi(xI(o,a,null));break}case ri.Undefined:i[n]=void 0;break}}return i}}var ol;(function(t){t[t["Simple"]=0]="Simple";t[t["Mixed"]=1]="Mixed"})(ol||(ol={}));class Tn{static _useMixedArgSerialization(e){for(let i=0,n=e.length;i<n;i++){if(e[i]instanceof ue){return true}if(e[i]instanceof Bi){return true}if(typeof e[i]==="undefined"){return true}}return false}static serializeRequestArguments(e,i){if(this._useMixedArgSerialization(e)){const n=[];for(let s=0,r=e.length;s<r;s++){const o=e[s];if(o instanceof ue){n[s]={type:ri.VSBuffer,value:o}}else if(typeof o==="undefined"){n[s]={type:ri.Undefined}}else if(o instanceof Bi){const{jsonString:a,referencedBuffers:l}=Sx(o.value,i);n[s]={type:ri.SerializedObjectWithBuffers,value:ue.fromString(a),buffers:l}}else{n[s]={type:ri.String,value:ue.fromString(Dx(o,i))}}}return{type:ol.Mixed,args:n}}return{type:ol.Simple,args:Dx(e,i)}}static serializeRequest(e,i,n,s,r){switch(s.type){case ol.Simple:return this._requestJSONArgs(e,i,n,s.args,r);case ol.Mixed:return this._requestMixedArgs(e,i,n,s.args,r)}}static _requestJSONArgs(e,i,n,s,r){const o=ue.fromString(n);const a=ue.fromString(s);let l=0;l+=Lt.sizeUInt8();l+=Lt.sizeShortString(o);l+=Lt.sizeLongString(a);const c=Lt.alloc(r?Dt.RequestJSONArgsWithCancellation:Dt.RequestJSONArgs,e,l);c.writeUInt8(i);c.writeShortString(o);c.writeLongString(a);return c.buffer}static deserializeRequestJSONArgs(e){const i=e.readUInt8();const n=e.readShortString();const s=e.readLongString();return{rpcId:i,method:n,args:JSON.parse(s)}}static _requestMixedArgs(e,i,n,s,r){const o=ue.fromString(n);let a=0;a+=Lt.sizeUInt8();a+=Lt.sizeShortString(o);a+=Lt.sizeMixedArray(s);const l=Lt.alloc(r?Dt.RequestMixedArgsWithCancellation:Dt.RequestMixedArgs,e,a);l.writeUInt8(i);l.writeShortString(o);l.writeMixedArray(s);return l.buffer}static deserializeRequestMixedArgs(e){const i=e.readUInt8();const n=e.readShortString();const s=e.readMixedArray();const r=new Array(s.length);for(let o=0,a=s.length;o<a;o++){const l=s[o];if(typeof l==="string"){r[o]=JSON.parse(l)}else{r[o]=l}}return{rpcId:i,method:n,args:r}}static serializeAcknowledged(e){return Lt.alloc(Dt.Acknowledged,e,0).buffer}static serializeCancel(e){return Lt.alloc(Dt.Cancel,e,0).buffer}static serializeReplyOK(e,i,n){if(typeof i==="undefined"){return this._serializeReplyOKEmpty(e)}else if(i instanceof ue){return this._serializeReplyOKVSBuffer(e,i)}else if(i instanceof Bi){const{jsonString:s,referencedBuffers:r}=Sx(i.value,n,true);return this._serializeReplyOKJSONWithBuffers(e,s,r)}else{return this._serializeReplyOKJSON(e,g_(i,n))}}static _serializeReplyOKEmpty(e){return Lt.alloc(Dt.ReplyOKEmpty,e,0).buffer}static _serializeReplyOKVSBuffer(e,i){let n=0;n+=Lt.sizeVSBuffer(i);const s=Lt.alloc(Dt.ReplyOKVSBuffer,e,n);s.writeVSBuffer(i);return s.buffer}static deserializeReplyOKVSBuffer(e){return e.readVSBuffer()}static _serializeReplyOKJSON(e,i){const n=ue.fromString(i);let s=0;s+=Lt.sizeLongString(n);const r=Lt.alloc(Dt.ReplyOKJSON,e,s);r.writeLongString(n);return r.buffer}static _serializeReplyOKJSONWithBuffers(e,i,n){const s=ue.fromString(i);let r=0;r+=Lt.sizeUInt32;r+=Lt.sizeLongString(s);for(const a of n){r+=Lt.sizeVSBuffer(a)}const o=Lt.alloc(Dt.ReplyOKJSONWithBuffers,e,r);o.writeUInt32(n.length);o.writeLongString(s);for(const a of n){o.writeBuffer(a)}return o.buffer}static deserializeReplyOKJSON(e){const i=e.readLongString();return JSON.parse(i)}static deserializeReplyOKJSONWithBuffers(e,i){const n=e.readUInt32();const s=e.readLongString();const r=[];for(let o=0;o<n;++o){r.push(e.readVSBuffer())}return new Bi(xI(s,r,i))}static serializeReplyErr(e,i){const n=i?g_(Wl(i),null):void 0;if(typeof n!=="string"){return this._serializeReplyErrEmpty(e)}const s=ue.fromString(n);let r=0;r+=Lt.sizeLongString(s);const o=Lt.alloc(Dt.ReplyErrError,e,r);o.writeLongString(s);return o.buffer}static deserializeReplyErrError(e){const i=e.readLongString();return JSON.parse(i)}static _serializeReplyErrEmpty(e){return Lt.alloc(Dt.ReplyErrEmpty,e,0).buffer}}var Dt;(function(t){t[t["RequestJSONArgs"]=1]="RequestJSONArgs";t[t["RequestJSONArgsWithCancellation"]=2]="RequestJSONArgsWithCancellation";t[t["RequestMixedArgs"]=3]="RequestMixedArgs";t[t["RequestMixedArgsWithCancellation"]=4]="RequestMixedArgsWithCancellation";t[t["Acknowledged"]=5]="Acknowledged";t[t["Cancel"]=6]="Cancel";t[t["ReplyOKEmpty"]=7]="ReplyOKEmpty";t[t["ReplyOKVSBuffer"]=8]="ReplyOKVSBuffer";t[t["ReplyOKJSON"]=9]="ReplyOKJSON";t[t["ReplyOKJSONWithBuffers"]=10]="ReplyOKJSONWithBuffers";t[t["ReplyErrError"]=11]="ReplyErrError";t[t["ReplyErrEmpty"]=12]="ReplyErrEmpty"})(Dt||(Dt={}));var ri;(function(t){t[t["String"]=1]="String";t[t["VSBuffer"]=2]="VSBuffer";t[t["SerializedObjectWithBuffers"]=3]="SerializedObjectWithBuffers";t[t["Undefined"]=4]="Undefined"})(ri||(ri={}));function k0(t){if(!t){return void 0}const e=t.indexOf("+");if(e<0){return t}return t.substr(0,e)}const GP=["AI","Azure","Chat","Data Science","Debuggers","Extension Packs","Education","Formatters","Keymaps","Language Packs","Linters","Machine Learning","Notebooks","Programming Languages","SCM Providers","Snippets","Testing","Themes","Visualization","Other"];var kx;(function(t){t[t["System"]=0]="System";t[t["User"]=1]="User"})(kx||(kx={}));var m_;(function(t){t["WIN32_X64"]="win32-x64";t["WIN32_ARM64"]="win32-arm64";t["LINUX_X64"]="linux-x64";t["LINUX_ARM64"]="linux-arm64";t["LINUX_ARMHF"]="linux-armhf";t["ALPINE_X64"]="alpine-x64";t["ALPINE_ARM64"]="alpine-arm64";t["DARWIN_X64"]="darwin-x64";t["DARWIN_ARM64"]="darwin-arm64";t["WEB"]="web";t["UNIVERSAL"]="universal";t["UNKNOWN"]="unknown";t["UNDEFINED"]="undefined"})(m_||(m_={}));class Ze{constructor(e){this.value=e;this._lower=e.toLowerCase()}static equals(e,i){if(typeof e==="undefined"||e===null){return typeof i==="undefined"||i===null}if(typeof i==="undefined"||i===null){return false}if(typeof e==="string"||typeof i==="string"){const n=typeof e==="string"?e:e.value;const s=typeof i==="string"?i:i.value;return io(n,s)}return e._lower===i._lower}static toKey(e){if(typeof e==="string"){return e.toLowerCase()}return e._lower}}class La{get size(){return this._set.size}constructor(e){this._set=new Set;if(e){for(const i of e){this.add(i)}}}add(e){this._set.add(Ze.toKey(e))}delete(e){return this._set.delete(Ze.toKey(e))}has(e){return this._set.has(Ze.toKey(e))}}class Sr{constructor(){this._map=new Map}clear(){this._map.clear()}delete(e){this._map.delete(Ze.toKey(e))}get(e){return this._map.get(Ze.toKey(e))}has(e){return this._map.has(Ze.toKey(e))}set(e,i){this._map.set(Ze.toKey(e),i)}values(){return this._map.values()}forEach(e){this._map.forEach(e)}[Symbol.iterator](){return this._map[Symbol.iterator]()}}class EI extends Error{constructor(e,i,n){super(`Error in extension ${Ze.toKey(e)}: ${n??i.message}`,{cause:i});this.name="ExtensionError";this.extension=e}}var ns;(function(t){t.serviceIds=new Map;t.DI_TARGET="$di$target";t.DI_DEPENDENCIES="$di$dependencies";function e(i){return i[t.DI_DEPENDENCIES]||[]}t.getServiceDependencies=e})(ns||(ns={}));const ch=xe("instantiationService");function KP(t,e,i){if(e[ns.DI_TARGET]===e){e[ns.DI_DEPENDENCIES].push({id:t,index:i})}else{e[ns.DI_DEPENDENCIES]=[{id:t,index:i}];e[ns.DI_TARGET]=e}}function xe(t){if(ns.serviceIds.has(t)){return ns.serviceIds.get(t)}const e=function(i,n,s){if(arguments.length!==3){throw new Error("@IServiceName-decorator can only be used to decorate a parameter")}KP(e,i,s)};e.toString=()=>t;ns.serviceIds.set(t,e);return e}const at=xe("logService");const Cc=xe("loggerService");class Zn{constructor(e,i=[],n=false){this.ctor=e;this.staticArguments=i;this.supportsDelayedInstantiation=n}}const SI=[];var _t;(function(t){t[t["Eager"]=0]="Eager";t[t["Delayed"]=1]="Delayed"})(_t||(_t={}));function xt(t,e,i){if(!(e instanceof Zn)){e=new Zn(e,[],Boolean(i))}SI.push([t,e])}function QP(){return SI}class I0{constructor(...e){this._entries=new Map;for(const[i,n]of e){this.set(i,n)}}set(e,i){const n=this._entries.get(e);this._entries.set(e,i);return n}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}}const Ai=xe("IExtHostInitDataService");let JP=class gM{constructor(e,i){this.key=e;this.data=i;this.incoming=new Map;this.outgoing=new Map}};class Ix{constructor(e){this._hashFn=e;this._nodes=new Map}roots(){const e=[];for(const i of this._nodes.values()){if(i.outgoing.size===0){e.push(i)}}return e}insertEdge(e,i){const n=this.lookupOrInsertNode(e);const s=this.lookupOrInsertNode(i);n.outgoing.set(s.key,s);s.incoming.set(n.key,n)}removeNode(e){const i=this._hashFn(e);this._nodes.delete(i);for(const n of this._nodes.values()){n.outgoing.delete(i);n.incoming.delete(i)}}lookupOrInsertNode(e){const i=this._hashFn(e);let n=this._nodes.get(i);if(!n){n=new JP(i,e);this._nodes.set(i,n)}return n}lookup(e){return this._nodes.get(this._hashFn(e))}isEmpty(){return this._nodes.size===0}toString(){const e=[];for(const[i,n]of this._nodes){e.push(`${i}
	(-> incoming)[${[...n.incoming.keys()].join(", ")}]
	(outgoing ->)[${[...n.outgoing.keys()].join(",")}]
`)}return e.join("\n")}findCycleSlow(){for(const[e,i]of this._nodes){const n=new Set([e]);const s=this._findCycle(i,n);if(s){return s}}return void 0}_findCycle(e,i){for(const[n,s]of e.outgoing){if(i.has(n)){return[...i,n].join(" -> ")}i.add(n);const r=this._findCycle(s,i);if(r){return r}i.delete(n)}return void 0}}const XP=false;class Cx extends Error{constructor(e){super("cyclic dependency between services");this.message=e.findCycleSlow()??`UNABLE to detect cycle, dumping graph: 
${e.toString()}`}}class Hf{constructor(e=new I0,i=false,n,s=XP){this._services=e;this._strict=i;this._parent=n;this._enableTracing=s;this._isDisposed=false;this._servicesToMaybeDispose=new Set;this._children=new Set;this._activeInstantiations=new Set;this._services.set(ch,this);this._globalGraph=s?n?._globalGraph??new Ix(r=>r):void 0}dispose(){if(!this._isDisposed){this._isDisposed=true;yr(this._children);this._children.clear();for(const e of this._servicesToMaybeDispose){if(Vk(e)){e.dispose()}}this._servicesToMaybeDispose.clear()}}_throwIfDisposed(){if(this._isDisposed){throw new Error("InstantiationService has been disposed")}}createChild(e,i){this._throwIfDisposed();const n=this;const s=new class extends Hf{dispose(){n._children.delete(s);super.dispose()}}(e,this._strict,this,this._enableTracing);this._children.add(s);i?.add(s);return s}invokeFunction(e,...i){this._throwIfDisposed();const n=vn.traceInvocation(this._enableTracing,e);let s=false;try{const r={get:o=>{if(s){throw d0("service accessor is only valid during the invocation of its target method")}const a=this._getOrCreateServiceInstance(o,n);if(!a){throw new Error(`[invokeFunction] unknown service '${o}'`)}return a}};return e(r,...i)}finally{s=true;n.stop()}}createInstance(e,...i){this._throwIfDisposed();let n;let s;if(e instanceof Zn){n=vn.traceCreation(this._enableTracing,e.ctor);s=this._createInstance(e.ctor,e.staticArguments.concat(i),n)}else{n=vn.traceCreation(this._enableTracing,e);s=this._createInstance(e,i,n)}n.stop();return s}_createInstance(e,i=[],n){const s=ns.getServiceDependencies(e).sort((a,l)=>a.index-l.index);const r=[];for(const a of s){const l=this._getOrCreateServiceInstance(a.id,n);if(!l){this._throwIfStrict(`[createInstance] ${e.name} depends on UNKNOWN service ${a.id}.`,false)}r.push(l)}const o=s.length>0?s[0].index:i.length;if(i.length!==o){console.trace(`[createInstance] First service dependency of ${e.name} at position ${o+1} conflicts with ${i.length} static arguments`);const a=o-i.length;if(a>0){i=i.concat(new Array(a))}else{i=i.slice(0,o)}}return Reflect.construct(e,i.concat(r))}_setCreatedServiceInstance(e,i){if(this._services.get(e)instanceof Zn){this._services.set(e,i)}else if(this._parent){this._parent._setCreatedServiceInstance(e,i)}else{throw new Error("illegalState - setting UNKNOWN service instance")}}_getServiceInstanceOrDescriptor(e){const i=this._services.get(e);if(!i&&this._parent){return this._parent._getServiceInstanceOrDescriptor(e)}else{return i}}_getOrCreateServiceInstance(e,i){if(this._globalGraph&&this._globalGraphImplicitDependency){this._globalGraph.insertEdge(this._globalGraphImplicitDependency,String(e))}const n=this._getServiceInstanceOrDescriptor(e);if(n instanceof Zn){return this._safeCreateAndCacheServiceInstance(e,n,i.branch(e,true))}else{i.branch(e,false);return n}}_safeCreateAndCacheServiceInstance(e,i,n){if(this._activeInstantiations.has(e)){throw new Error(`illegal state - RECURSIVELY instantiating service '${e}'`)}this._activeInstantiations.add(e);try{return this._createAndCacheServiceInstance(e,i,n)}finally{this._activeInstantiations.delete(e)}}_createAndCacheServiceInstance(e,i,n){const s=new Ix(l=>l.id.toString());let r=0;const o=[{id:e,desc:i,_trace:n}];const a=new Set;while(o.length){const l=o.pop();if(a.has(String(l.id))){continue}a.add(String(l.id));s.lookupOrInsertNode(l);if(r++>1e3){throw new Cx(s)}for(const c of ns.getServiceDependencies(l.desc.ctor)){const u=this._getServiceInstanceOrDescriptor(c.id);if(!u){this._throwIfStrict(`[createInstance] ${e} depends on ${c.id} which is NOT registered.`,true)}this._globalGraph?.insertEdge(String(l.id),String(c.id));if(u instanceof Zn){const d={id:c.id,desc:u,_trace:l._trace.branch(c.id,true)};if(!s.lookup(d)){o.push(d)}s.insertEdge(l,d)}}}while(true){const l=s.roots();if(l.length===0){if(!s.isEmpty()){throw new Cx(s)}break}for(const{data:c}of l){const u=this._getServiceInstanceOrDescriptor(c.id);if(u instanceof Zn){const d=this._createServiceInstanceWithOwner(c.id,c.desc.ctor,c.desc.staticArguments,c.desc.supportsDelayedInstantiation,c._trace);this._setCreatedServiceInstance(c.id,d)}s.removeNode(c)}}return this._getServiceInstanceOrDescriptor(e)}_createServiceInstanceWithOwner(e,i,n=[],s,r){if(this._services.get(e)instanceof Zn){return this._createServiceInstance(e,i,n,s,r,this._servicesToMaybeDispose)}else if(this._parent){return this._parent._createServiceInstanceWithOwner(e,i,n,s,r)}else{throw new Error(`illegalState - creating UNKNOWN service instance ${i.name}`)}}_createServiceInstance(e,i,n=[],s,r,o){if(!s){const a=this._createInstance(i,n,r);o.add(a);return a}else{const a=new Hf(void 0,this._strict,this,this._enableTracing);a._globalGraphImplicitDependency=String(e);const l=new Map;const c=new $P(()=>{const u=a._createInstance(i,n,r);for(const[d,p]of l){const f=u[d];if(typeof f==="function"){for(const m of p){m.disposable=f.apply(u,m.listener)}}}l.clear();o.add(u);return u});return new Proxy(Object.create(null),{get(u,d){if(!c.isInitialized){if(typeof d==="string"&&(d.startsWith("onDid")||d.startsWith("onWill"))){let m=l.get(d);if(!m){m=new wo;l.set(d,m)}const v=(y,D,I)=>{if(c.isInitialized){return c.value[d](y,D,I)}else{const R={listener:[y,D,I],disposable:void 0};const J=m.push(R);const H=ge(()=>{J();R.disposable?.dispose()});return H}};return v}}if(d in u){return u[d]}const p=c.value;let f=p[d];if(typeof f!=="function"){return f}f=f.bind(p);u[d]=f;return f},set(u,d,p){c.value[d]=p;return true},getPrototypeOf(u){return i.prototype}})}}_throwIfStrict(e,i){if(i){console.warn(e)}if(this._strict){throw new Error(e)}}}var No;(function(t){t[t["None"]=0]="None";t[t["Creation"]=1]="Creation";t[t["Invocation"]=2]="Invocation";t[t["Branch"]=3]="Branch"})(No||(No={}));class vn{static{this.all=new Set}static{this._None=new class extends vn{constructor(){super(No.None,null)}stop(){}branch(){return this}}}static traceInvocation(e,i){return!e?vn._None:new vn(No.Invocation,i.name||new Error().stack.split("\n").slice(3,4).join("\n"))}static traceCreation(e,i){return!e?vn._None:new vn(No.Creation,i.name)}static{this._totals=0}constructor(e,i){this.type=e;this.name=i;this._start=Date.now();this._dep=[]}branch(e,i){const n=new vn(No.Branch,e.toString());this._dep.push([e,i,n]);return n}stop(){const e=Date.now()-this._start;vn._totals+=e;let i=false;function n(r,o){const a=[];const l=new Array(r+1).join("	");for(const[c,u,d]of o._dep){if(u&&d){i=true;a.push(`${l}CREATES -> ${c}`);const p=n(r+1,d);if(p){a.push(p)}}else{a.push(`${l}uses -> ${c}`)}}return a.join("\n")}const s=[`${this.type===No.Creation?"CREATE":"CALL"} ${this.name}`,`${n(1,this)}`,`DONE, took ${e.toFixed(2)}ms (grand total ${vn._totals.toFixed(2)}ms)`];if(e>2||i){vn.all.add(s.join("\n"))}}}const st=xe("IExtHostRpcService");class YP{constructor(e){this.getProxy=e.getProxy.bind(e);this.set=e.set.bind(e);this.dispose=e.dispose.bind(e);this.assertRegistered=e.assertRegistered.bind(e);this.drain=e.drain.bind(e)}}const wm=xe("IURITransformerService");class ZP{constructor(e){if(!e){this.transformIncoming=i=>i;this.transformOutgoing=i=>i;this.transformOutgoingURI=i=>i;this.transformOutgoingScheme=i=>i}else{this.transformIncoming=e.transformIncoming.bind(e);this.transformOutgoing=e.transformOutgoing.bind(e);this.transformOutgoingURI=e.transformOutgoingURI.bind(e);this.transformOutgoingScheme=e.transformOutgoingScheme.bind(e)}}}function z(t,e,i,n){var s=arguments.length,r=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n,o;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)if(o=t[a])r=(s<3?o(r):s>3?o(e,i,r):o(e,i))||r;return s>3&&r&&Object.defineProperty(e,i,r),r}function O(t,e){return function(i,n){e(i,n,t)}}class e7{constructor(){this._value="";this._pos=0}reset(e){this._value=e;this._pos=0;return this}next(){this._pos+=1;return this}hasNext(){return this._pos<this._value.length-1}cmp(e){const i=e.charCodeAt(0);const n=this._value.charCodeAt(this._pos);return i-n}value(){return this._value[this._pos]}}class t7{constructor(e=true){this._caseSensitive=e}reset(e){this._value=e;this._from=0;this._to=0;return this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let e=true;for(;this._to<this._value.length;this._to++){const i=this._value.charCodeAt(this._to);if(i===A.Period){if(e){this._from++}else{break}}else{e=false}}return this}cmp(e){return this._caseSensitive?x0(e,this._value,0,e.length,this._from,this._to):ah(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class DI{constructor(e=true,i=true){this._splitOnBackslash=e;this._caseSensitive=i}reset(e){this._from=0;this._to=0;this._value=e;this._valueLen=e.length;for(let i=e.length-1;i>=0;i--,this._valueLen--){const n=this._value.charCodeAt(i);if(!(n===A.Slash||this._splitOnBackslash&&n===A.Backslash)){break}}return this.next()}hasNext(){return this._to<this._valueLen}next(){this._from=this._to;let e=true;for(;this._to<this._valueLen;this._to++){const i=this._value.charCodeAt(this._to);if(i===A.Slash||this._splitOnBackslash&&i===A.Backslash){if(e){this._from++}else{break}}else{e=false}}return this}cmp(e){return this._caseSensitive?x0(e,this._value,0,e.length,this._from,this._to):ah(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}var fi;(function(t){t[t["Scheme"]=1]="Scheme";t[t["Authority"]=2]="Authority";t[t["Path"]=3]="Path";t[t["Query"]=4]="Query";t[t["Fragment"]=5]="Fragment"})(fi||(fi={}));class kI{constructor(e,i){this._ignorePathCasing=e;this._ignoreQueryAndFragment=i;this._states=[];this._stateIdx=0}reset(e){this._value=e;this._states=[];if(this._value.scheme){this._states.push(fi.Scheme)}if(this._value.authority){this._states.push(fi.Authority)}if(this._value.path){this._pathIterator=new DI(false,!this._ignorePathCasing(e));this._pathIterator.reset(e.path);if(this._pathIterator.value()){this._states.push(fi.Path)}}if(!this._ignoreQueryAndFragment(e)){if(this._value.query){this._states.push(fi.Query)}if(this._value.fragment){this._states.push(fi.Fragment)}}this._stateIdx=0;return this}next(){if(this._states[this._stateIdx]===fi.Path&&this._pathIterator.hasNext()){this._pathIterator.next()}else{this._stateIdx+=1}return this}hasNext(){return this._states[this._stateIdx]===fi.Path&&this._pathIterator.hasNext()||this._stateIdx<this._states.length-1}cmp(e){if(this._states[this._stateIdx]===fi.Scheme){return u_(e,this._value.scheme)}else if(this._states[this._stateIdx]===fi.Authority){return u_(e,this._value.authority)}else if(this._states[this._stateIdx]===fi.Path){return this._pathIterator.cmp(e)}else if(this._states[this._stateIdx]===fi.Query){return xa(e,this._value.query)}else if(this._states[this._stateIdx]===fi.Fragment){return xa(e,this._value.fragment)}throw new Error}value(){if(this._states[this._stateIdx]===fi.Scheme){return this._value.scheme}else if(this._states[this._stateIdx]===fi.Authority){return this._value.authority}else if(this._states[this._stateIdx]===fi.Path){return this._pathIterator.value()}else if(this._states[this._stateIdx]===fi.Query){return this._value.query}else if(this._states[this._stateIdx]===fi.Fragment){return this._value.fragment}throw new Error}}class _s{static{this.Val=Symbol("undefined_placeholder")}static wrap(e){return e===void 0?_s.Val:e}static unwrap(e){return e===_s.Val?void 0:e}}class kh{constructor(){this.height=1;this.value=void 0;this.key=void 0;this.left=void 0;this.mid=void 0;this.right=void 0}isEmpty(){return!this.left&&!this.mid&&!this.right&&this.value===void 0}rotateLeft(){const e=this.right;this.right=e.left;e.left=this;this.updateHeight();e.updateHeight();return e}rotateRight(){const e=this.left;this.left=e.right;e.right=this;this.updateHeight();e.updateHeight();return e}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){return this.left?.height??0}get heightRight(){return this.right?.height??0}}var ut;(function(t){t[t["Left"]=-1]="Left";t[t["Mid"]=0]="Mid";t[t["Right"]=1]="Right"})(ut||(ut={}));class xn{static forUris(e=()=>false,i=()=>false){return new xn(new kI(e,i))}static forPaths(e=false){return new xn(new DI(void 0,!e))}static forStrings(){return new xn(new e7)}static forConfigKeys(){return new xn(new t7)}constructor(e){this._iter=e}clear(){this._root=void 0}fill(e,i){if(i){const n=i.slice(0);Gy(n);for(const s of n){this.set(s,e)}}else{const n=e.slice(0);Gy(n);for(const s of n){this.set(s[0],s[1])}}}set(e,i){const n=this._iter.reset(e);let s;if(!this._root){this._root=new kh;this._root.segment=n.value()}const r=[];s=this._root;while(true){const a=n.cmp(s.segment);if(a>0){if(!s.left){s.left=new kh;s.left.segment=n.value()}r.push([ut.Left,s]);s=s.left}else if(a<0){if(!s.right){s.right=new kh;s.right.segment=n.value()}r.push([ut.Right,s]);s=s.right}else if(n.hasNext()){n.next();if(!s.mid){s.mid=new kh;s.mid.segment=n.value()}r.push([ut.Mid,s]);s=s.mid}else{break}}const o=_s.unwrap(s.value);s.value=_s.wrap(i);s.key=e;for(let a=r.length-1;a>=0;a--){const l=r[a][1];l.updateHeight();const c=l.balanceFactor();if(c<-1||c>1){const u=r[a][0];const d=r[a+1][0];if(u===ut.Right&&d===ut.Right){r[a][1]=l.rotateLeft()}else if(u===ut.Left&&d===ut.Left){r[a][1]=l.rotateRight()}else if(u===ut.Right&&d===ut.Left){l.right=r[a+1][1]=r[a+1][1].rotateRight();r[a][1]=l.rotateLeft()}else if(u===ut.Left&&d===ut.Right){l.left=r[a+1][1]=r[a+1][1].rotateLeft();r[a][1]=l.rotateRight()}else{throw new Error}if(a>0){switch(r[a-1][0]){case ut.Left:r[a-1][1].left=r[a][1];break;case ut.Right:r[a-1][1].right=r[a][1];break;case ut.Mid:r[a-1][1].mid=r[a][1];break}}else{this._root=r[0][1]}}}return o}get(e){return _s.unwrap(this._getNode(e)?.value)}_getNode(e){const i=this._iter.reset(e);let n=this._root;while(n){const s=i.cmp(n.segment);if(s>0){n=n.left}else if(s<0){n=n.right}else if(i.hasNext()){i.next();n=n.mid}else{break}}return n}has(e){const i=this._getNode(e);return!(i?.value===void 0&&i?.mid===void 0)}delete(e){return this._delete(e,false)}deleteSuperstr(e){return this._delete(e,true)}_delete(e,i){const n=this._iter.reset(e);const s=[];let r=this._root;while(r){const o=n.cmp(r.segment);if(o>0){s.push([ut.Left,r]);r=r.left}else if(o<0){s.push([ut.Right,r]);r=r.right}else if(n.hasNext()){n.next();s.push([ut.Mid,r]);r=r.mid}else{break}}if(!r){return}if(i){r.left=void 0;r.mid=void 0;r.right=void 0;r.height=1}else{r.key=void 0;r.value=void 0}if(!r.mid&&!r.value){if(r.left&&r.right){const o=[[ut.Right,r]];const a=this._min(r.right,o);if(a.key){r.key=a.key;r.value=a.value;r.segment=a.segment;const l=a.right;if(o.length>1){const[u,d]=o[o.length-1];switch(u){case ut.Left:d.left=l;break;case ut.Mid:i_(false);case ut.Right:i_(false)}}else{r.right=l}const c=this._balanceByStack(o);if(s.length>0){const[u,d]=s[s.length-1];switch(u){case ut.Left:d.left=c;break;case ut.Mid:d.mid=c;break;case ut.Right:d.right=c;break}}else{this._root=c}}}else{const o=r.left??r.right;if(s.length>0){const[a,l]=s[s.length-1];switch(a){case ut.Left:l.left=o;break;case ut.Mid:l.mid=o;break;case ut.Right:l.right=o;break}}else{this._root=o}}}this._root=this._balanceByStack(s)??this._root}_min(e,i){while(e.left){i.push([ut.Left,e]);e=e.left}return e}_balanceByStack(e){for(let i=e.length-1;i>=0;i--){const n=e[i][1];n.updateHeight();const s=n.balanceFactor();if(s>1){if(n.right.balanceFactor()>=0){e[i][1]=n.rotateLeft()}else{n.right=n.right.rotateRight();e[i][1]=n.rotateLeft()}}else if(s<-1){if(n.left.balanceFactor()<=0){e[i][1]=n.rotateRight()}else{n.left=n.left.rotateLeft();e[i][1]=n.rotateRight()}}if(i>0){switch(e[i-1][0]){case ut.Left:e[i-1][1].left=e[i][1];break;case ut.Right:e[i-1][1].right=e[i][1];break;case ut.Mid:e[i-1][1].mid=e[i][1];break}}else{return e[0][1]}}return void 0}findSubstr(e){const i=this._iter.reset(e);let n=this._root;let s=void 0;while(n){const r=i.cmp(n.segment);if(r>0){n=n.left}else if(r<0){n=n.right}else if(i.hasNext()){i.next();s=_s.unwrap(n.value)||s;n=n.mid}else{break}}return n&&_s.unwrap(n.value)||s}findSuperstr(e){return this._findSuperstrOrElement(e,false)}_findSuperstrOrElement(e,i){const n=this._iter.reset(e);let s=this._root;while(s){const r=n.cmp(s.segment);if(r>0){s=s.left}else if(r<0){s=s.right}else if(n.hasNext()){n.next();s=s.mid}else{if(!s.mid){if(i){return _s.unwrap(s.value)}else{return void 0}}else{return this._entries(s.mid)}}}return void 0}hasElementOrSubtree(e){return this._findSuperstrOrElement(e,true)!==void 0}forEach(e){for(const[i,n]of this){e(n,i)}}*[Symbol.iterator](){yield*this._entries(this._root)}_entries(e){const i=[];this._dfsEntries(e,i);return i[Symbol.iterator]()}_dfsEntries(e,i){if(!e){return}if(e.left){this._dfsEntries(e.left,i)}if(e.value!==void 0){i.push([e.key,_s.unwrap(e.value)])}if(e.mid){this._dfsEntries(e.mid,i)}if(e.right){this._dfsEntries(e.right,i)}}_isBalanced(){const e=i=>{if(!i){return true}const n=i.balanceFactor();if(n<-1||n>1){return false}return e(i.left)&&e(i.right)};return e(this._root)}}function vt(t){if(!t||typeof t!=="object"){return t}if(t instanceof RegExp){return t}const e=Array.isArray(t)?[]:{};Object.entries(t).forEach(([i,n])=>{e[i]=n&&typeof n==="object"?vt(n):n});return e}function II(t){if(!t||typeof t!=="object"){return t}const e=[t];while(e.length>0){const i=e.shift();for(const n in i){if(CI.call(i,n)){const s=i[n];if(typeof s==="object"&&!Object.isFrozen(s)&&!O5(s)){e.push(s)}}}}return t}const CI=Object.prototype.hasOwnProperty;function Kl(t,e){return __(t,e,new Set)}function __(t,e,i){if(Xt(t)){return t}const n=e(t);if(typeof n!=="undefined"){return n}if(Array.isArray(t)){const s=[];for(const r of t){s.push(__(r,e,i))}return s}if(Yt(t)){if(i.has(t)){throw new Error("Cannot clone recursive data-structure")}i.add(t);const s={};for(const r in t){if(CI.call(t,r)){s[r]=__(t[r],e,i)}}i.delete(t);return s}return t}function Ea(t,e,i=true){if(!Yt(t)){return e}if(Yt(e)){Object.keys(e).forEach(n=>{if(n in t){if(i){if(Yt(t[n])&&Yt(e[n])){Ea(t[n],e[n],i)}else{t[n]=e[n]}}}else{t[n]=e[n]}})}return t}function Xi(t,e){if(t===e){return true}if(t===null||t===void 0||e===null||e===void 0){return false}if(typeof t!==typeof e){return false}if(typeof t!=="object"){return false}if(Array.isArray(t)!==Array.isArray(e)){return false}let i;let n;if(Array.isArray(t)){if(t.length!==e.length){return false}for(i=0;i<t.length;i++){if(!Xi(t[i],e[i])){return false}}}else{const s=[];for(n in t){s.push(n)}s.sort();const r=[];for(n in e){r.push(n)}r.sort();if(!Xi(s,r)){return false}for(i=0;i<s.length;i++){if(!Xi(t[s[i]],e[s[i]])){return false}}}return true}function i7(t){const e=new Set;return JSON.stringify(t,(i,n)=>{if(Yt(n)||Array.isArray(n)){if(e.has(n)){return"[Circular]"}else{e.add(n)}}if(typeof n==="bigint"){return`[BigInt ${n.toString()}]`}return n})}function Tx(t,e){const i=Object.create(null);for(const[n,s]of Object.entries(t)){if(e(n,s)){i[n]=s}}return i}class n7{constructor(){this._next=0}getNext(){return this._next++}}var ra;(function(t){t[t["Unknown"]=0]="Unknown";t[t["File"]=1]="File";t[t["Directory"]=2]="Directory";t[t["SymbolicLink"]=64]="SymbolicLink"})(ra||(ra={}));var Ql;(function(t){t[t["Readonly"]=1]="Readonly";t[t["Locked"]=2]="Locked"})(Ql||(Ql={}));var Hr;(function(t){t[t["UPDATED"]=2]="UPDATED";t[t["ADDED"]=4]="ADDED";t[t["DELETED"]=8]="DELETED"})(Hr||(Hr={}));var ws;(function(t){t[t["None"]=0]="None";t[t["FileReadWrite"]=2]="FileReadWrite";t[t["FileOpenReadWriteClose"]=4]="FileOpenReadWriteClose";t[t["FileReadStream"]=16]="FileReadStream";t[t["FileFolderCopy"]=8]="FileFolderCopy";t[t["PathCaseSensitive"]=1024]="PathCaseSensitive";t[t["Readonly"]=2048]="Readonly";t[t["Trash"]=4096]="Trash";t[t["FileWriteUnlock"]=8192]="FileWriteUnlock";t[t["FileAtomicRead"]=16384]="FileAtomicRead";t[t["FileAtomicWrite"]=32768]="FileAtomicWrite";t[t["FileAtomicDelete"]=65536]="FileAtomicDelete";t[t["FileClone"]=131072]="FileClone"})(ws||(ws={}));var Le;(function(t){t["FileExists"]="EntryExists";t["FileNotFound"]="EntryNotFound";t["FileNotADirectory"]="EntryNotADirectory";t["FileIsADirectory"]="EntryIsADirectory";t["FileExceedsStorageQuota"]="EntryExceedsStorageQuota";t["FileTooLarge"]="EntryTooLarge";t["FileWriteLocked"]="EntryWriteLocked";t["NoPermissions"]="NoPermissions";t["Unavailable"]="Unavailable";t["Unknown"]="Unknown"})(Le||(Le={}));class bm extends Error{static create(e,i){const n=new bm(e.toString(),i);TI(n,i);return n}constructor(e,i){super(e);this.code=i}}function TI(t,e){t.name=e?`${e} (FileSystemError)`:`FileSystemError`;return t}function Bf(t){if(!t){return Le.Unknown}if(t instanceof bm){return t.code}const e=/^(.+) \(FileSystemError\)$/.exec(t.name);if(!e){return Le.Unknown}switch(e[1]){case Le.FileExists:return Le.FileExists;case Le.FileIsADirectory:return Le.FileIsADirectory;case Le.FileNotADirectory:return Le.FileNotADirectory;case Le.FileNotFound:return Le.FileNotFound;case Le.FileTooLarge:return Le.FileTooLarge;case Le.FileWriteLocked:return Le.FileWriteLocked;case Le.NoPermissions:return Le.NoPermissions;case Le.Unavailable:return Le.Unavailable}return Le.Unknown}function s7(t){if(t instanceof v_){return t.fileOperationResult}switch(Bf(t)){case Le.FileNotFound:return wn.FILE_NOT_FOUND;case Le.FileIsADirectory:return wn.FILE_IS_DIRECTORY;case Le.FileNotADirectory:return wn.FILE_NOT_DIRECTORY;case Le.FileWriteLocked:return wn.FILE_WRITE_LOCKED;case Le.NoPermissions:return wn.FILE_PERMISSION_DENIED;case Le.FileExists:return wn.FILE_MOVE_CONFLICT;case Le.FileTooLarge:return wn.FILE_TOO_LARGE;default:return wn.FILE_OTHER_ERROR}}var ms;(function(t){t[t["CREATE"]=0]="CREATE";t[t["DELETE"]=1]="DELETE";t[t["MOVE"]=2]="MOVE";t[t["COPY"]=3]="COPY";t[t["WRITE"]=4]="WRITE"})(ms||(ms={}));var es;(function(t){t[t["UPDATED"]=0]="UPDATED";t[t["ADDED"]=1]="ADDED";t[t["DELETED"]=2]="DELETED"})(es||(es={}));class Zh{static{this.MIXED_CORRELATION=null}constructor(e,i){this.ignorePathCasing=i;this.correlationId=void 0;this.added=new Fn(()=>{const n=xn.forUris(()=>this.ignorePathCasing);n.fill(this.rawAdded.map(s=>[s,true]));return n});this.updated=new Fn(()=>{const n=xn.forUris(()=>this.ignorePathCasing);n.fill(this.rawUpdated.map(s=>[s,true]));return n});this.deleted=new Fn(()=>{const n=xn.forUris(()=>this.ignorePathCasing);n.fill(this.rawDeleted.map(s=>[s,true]));return n});this.rawAdded=[];this.rawUpdated=[];this.rawDeleted=[];for(const n of e){switch(n.type){case es.ADDED:this.rawAdded.push(n.resource);break;case es.UPDATED:this.rawUpdated.push(n.resource);break;case es.DELETED:this.rawDeleted.push(n.resource);break}if(this.correlationId!==Zh.MIXED_CORRELATION){if(typeof n.cId==="number"){if(this.correlationId===void 0){this.correlationId=n.cId}else if(this.correlationId!==n.cId){this.correlationId=Zh.MIXED_CORRELATION}}else{if(this.correlationId!==void 0){this.correlationId=Zh.MIXED_CORRELATION}}}}}contains(e,...i){return this.doContains(e,{includeChildren:false},...i)}affects(e,...i){return this.doContains(e,{includeChildren:true},...i)}doContains(e,i,...n){if(!e){return false}const s=n.length>0;if(!s||n.includes(es.ADDED)){if(this.added.value.get(e)){return true}if(i.includeChildren&&this.added.value.findSuperstr(e)){return true}}if(!s||n.includes(es.UPDATED)){if(this.updated.value.get(e)){return true}if(i.includeChildren&&this.updated.value.findSuperstr(e)){return true}}if(!s||n.includes(es.DELETED)){if(this.deleted.value.findSubstr(e)){return true}if(i.includeChildren&&this.deleted.value.findSuperstr(e)){return true}}return false}gotAdded(){return this.rawAdded.length>0}gotDeleted(){return this.rawDeleted.length>0}gotUpdated(){return this.rawUpdated.length>0}correlates(e){return this.correlationId===e}hasCorrelation(){return typeof this.correlationId==="number"}}class v_ extends Error{constructor(e,i,n){super(e);this.fileOperationResult=i;this.options=n}}var wn;(function(t){t[t["FILE_IS_DIRECTORY"]=0]="FILE_IS_DIRECTORY";t[t["FILE_NOT_FOUND"]=1]="FILE_NOT_FOUND";t[t["FILE_NOT_MODIFIED_SINCE"]=2]="FILE_NOT_MODIFIED_SINCE";t[t["FILE_MODIFIED_SINCE"]=3]="FILE_MODIFIED_SINCE";t[t["FILE_MOVE_CONFLICT"]=4]="FILE_MOVE_CONFLICT";t[t["FILE_WRITE_LOCKED"]=5]="FILE_WRITE_LOCKED";t[t["FILE_PERMISSION_DENIED"]=6]="FILE_PERMISSION_DENIED";t[t["FILE_TOO_LARGE"]=7]="FILE_TOO_LARGE";t[t["FILE_INVALID_PATH"]=8]="FILE_INVALID_PATH";t[t["FILE_NOT_DIRECTORY"]=9]="FILE_NOT_DIRECTORY";t[t["FILE_OTHER_ERROR"]=10]="FILE_OTHER_ERROR"})(wn||(wn={}));var Px;(function(t){t[t["FILE"]=0]="FILE";t[t["FOLDER"]=1]="FOLDER";t[t["ROOT_FOLDER"]=2]="ROOT_FOLDER"})(Px||(Px={}));const r7="";function Ax(t){if(typeof t.size!=="number"||typeof t.mtime!=="number"){return void 0}return t.mtime.toString(29)+t.size.toString(31)}class ji{static{this.KB=1024}static{this.MB=ji.KB*ji.KB}static{this.GB=ji.MB*ji.KB}static{this.TB=ji.GB*ji.KB}static formatSize(e){if(!ia(e)){e=0}if(e<ji.KB){return h(1879,"{0}B",e.toFixed(0))}if(e<ji.MB){return h(1880,"{0}KB",(e/ji.KB).toFixed(2))}if(e<ji.GB){return h(1881,"{0}MB",(e/ji.MB).toFixed(2))}if(e<ji.TB){return h(1882,"{0}GB",(e/ji.GB).toFixed(2))}return h(1883,"{0}TB",(e/ji.TB).toFixed(2))}}var Ju;(function(t){t[t["Ignore"]=0]="Ignore";t[t["Info"]=1]="Info";t[t["Warning"]=2]="Warning";t[t["Error"]=3]="Error"})(Ju||(Ju={}));(function(t){const e="error";const i="warning";const n="warn";const s="info";const r="ignore";function o(l){if(!l){return t.Ignore}if(io(e,l)){return t.Error}if(io(i,l)||io(n,l)){return t.Warning}if(io(s,l)){return t.Info}return t.Ignore}t.fromValue=o;function a(l){switch(l){case t.Error:return e;case t.Warning:return i;case t.Info:return s;default:return r}}t.toString=a})(Ju||(Ju={}));var jt=Ju;var Rx;(function(t){t[t["DEFAULT"]=0]="DEFAULT";t[t["OPTIONAL"]=1]="OPTIONAL";t[t["SILENT"]=2]="SILENT";t[t["URGENT"]=3]="URGENT"})(Rx||(Rx={}));var Lx;(function(t){t[t["WORKSPACE"]=0]="WORKSPACE";t[t["PROFILE"]=1]="PROFILE";t[t["APPLICATION"]=2]="APPLICATION"})(Lx||(Lx={}));var Nx;(function(t){t[t["OFF"]=0]="OFF";t[t["ERROR"]=1]="ERROR"})(Nx||(Nx={}));function o7(t){const e=t;return typeof e?.id==="string"&&b.isUri(e.uri)}function a7(t){const e=t;return typeof e?.id==="string"&&b.isUri(e.configPath)}var Vf;(function(t){t[t["EMPTY"]=1]="EMPTY";t[t["FOLDER"]=2]="FOLDER";t[t["WORKSPACE"]=3]="WORKSPACE"})(Vf||(Vf={}));let l7=class mM{get folders(){return this._folders}set folders(e){this._folders=e;this.updateFoldersMap()}constructor(e,i,n,s,r){this._id=e;this._transient=n;this._configuration=s;this.ignorePathCasing=r;this.foldersMap=xn.forUris(this.ignorePathCasing,()=>true);this.folders=i}update(e){this._id=e.id;this._configuration=e.configuration;this._transient=e.transient;this.ignorePathCasing=e.ignorePathCasing;this.folders=e.folders}get id(){return this._id}get transient(){return this._transient}get configuration(){return this._configuration}set configuration(e){this._configuration=e}getFolder(e){if(!e){return null}return this.foldersMap.findSubstr(e)||null}updateFoldersMap(){this.foldersMap=xn.forUris(this.ignorePathCasing,()=>true);for(const e of this.folders){this.foldersMap.set(e.uri,e)}}toJSON(){return{id:this.id,folders:this.folders,transient:this.transient,configuration:this.configuration}}};class PI{constructor(e,i){this.raw=i;this.uri=e.uri;this.index=e.index;this.name=e.name}toResource(e){return ki(this.uri,e)}toJSON(){return{uri:this.uri,name:this.name,index:this.index}}}function b1(t){return new PI({uri:t,index:0,name:f_(t)},{uri:t.toString()})}const c7="code-workspace";[{name:h(2380,"Code Workspace"),extensions:[c7]}];class u7{constructor(){this._systemSchemes=new Set(Object.keys(ae));this._providerInfo=new Map;this.extUri=new lh(e=>{const i=this._providerInfo.get(e.scheme);if(i===void 0){return false}if(i&ws.PathCaseSensitive){return false}return true})}$acceptProviderInfos(e,i){if(i===null){this._providerInfo.delete(e.scheme)}else{this._providerInfo.set(e.scheme,i)}}isFreeScheme(e){return!this._providerInfo.has(e)&&!this._systemSchemes.has(e)}getCapabilities(e){return this._providerInfo.get(e)}}const Tc=xe("IExtHostFileSystemInfo");const vi=function(){if(typeof crypto.randomUUID==="function"){return crypto.randomUUID.bind(crypto)}const t=new Uint8Array(16);const e=[];for(let i=0;i<256;i++){e.push(i.toString(16).padStart(2,"0"))}return function i(){crypto.getRandomValues(t);t[6]=t[6]&15|64;t[8]=t[8]&63|128;let n=0;let s="";s+=e[t[n++]];s+=e[t[n++]];s+=e[t[n++]];s+=e[t[n++]];s+="-";s+=e[t[n++]];s+=e[t[n++]];s+="-";s+=e[t[n++]];s+=e[t[n++]];s+="-";s+=e[t[n++]];s+=e[t[n++]];s+="-";s+=e[t[n++]];s+=e[t[n++]];s+=e[t[n++]];s+=e[t[n++]];s+=e[t[n++]];s+=e[t[n++]];return s}}();const w_=Object.freeze({create:t=>{return sl(t.map(e=>e.toString())).join("\r\n")},split:t=>{return t.split("\r\n")},parse:t=>{return w_.split(t).filter(e=>!e.startsWith("#"))}});var Ox;(function(t){t[t["InitialConsonant"]=4352]="InitialConsonant";t[t["Vowel"]=4449]="Vowel";t[t["FinalConsonant"]=4520]="FinalConsonant";t[t["CompatibilityJamo"]=12593]="CompatibilityJamo"})(Ox||(Ox={}));var Z;(function(t){t[t["NUL"]=0]="NUL";t[t["A"]=65]="A";t[t["B"]=66]="B";t[t["C"]=67]="C";t[t["D"]=68]="D";t[t["E"]=69]="E";t[t["F"]=70]="F";t[t["G"]=71]="G";t[t["H"]=72]="H";t[t["I"]=73]="I";t[t["J"]=74]="J";t[t["K"]=75]="K";t[t["L"]=76]="L";t[t["M"]=77]="M";t[t["N"]=78]="N";t[t["O"]=79]="O";t[t["P"]=80]="P";t[t["Q"]=81]="Q";t[t["R"]=82]="R";t[t["S"]=83]="S";t[t["T"]=84]="T";t[t["U"]=85]="U";t[t["V"]=86]="V";t[t["W"]=87]="W";t[t["X"]=88]="X";t[t["Y"]=89]="Y";t[t["Z"]=90]="Z";t[t["a"]=97]="a";t[t["b"]=98]="b";t[t["c"]=99]="c";t[t["d"]=100]="d";t[t["e"]=101]="e";t[t["f"]=102]="f";t[t["g"]=103]="g";t[t["h"]=104]="h";t[t["i"]=105]="i";t[t["j"]=106]="j";t[t["k"]=107]="k";t[t["l"]=108]="l";t[t["m"]=109]="m";t[t["n"]=110]="n";t[t["o"]=111]="o";t[t["p"]=112]="p";t[t["q"]=113]="q";t[t["r"]=114]="r";t[t["s"]=115]="s";t[t["t"]=116]="t";t[t["u"]=117]="u";t[t["v"]=118]="v";t[t["w"]=119]="w";t[t["x"]=120]="x";t[t["y"]=121]="y";t[t["z"]=122]="z"})(Z||(Z={}));var Ye;(function(t){t[t["fa"]=24934]="fa";t[t["fg"]=26470]="fg";t[t["fq"]=29030]="fq";t[t["fr"]=29286]="fr";t[t["ft"]=29798]="ft";t[t["fv"]=30310]="fv";t[t["fx"]=30822]="fx";t[t["hk"]=27496]="hk";t[t["hl"]=27752]="hl";t[t["ho"]=28520]="ho";t[t["ml"]=27757]="ml";t[t["nj"]=27246]="nj";t[t["nl"]=27758]="nl";t[t["np"]=28782]="np";t[t["qt"]=29809]="qt";t[t["rt"]=29810]="rt";t[t["sg"]=26483]="sg";t[t["sw"]=30579]="sw"})(Ye||(Ye={}));new Uint8Array([Z.r,Z.R,Z.s,Z.e,Z.E,Z.f,Z.a,Z.q,Z.Q,Z.t,Z.T,Z.d,Z.w,Z.W,Z.c,Z.z,Z.x,Z.v,Z.g]);new Uint16Array([Z.k,Z.o,Z.i,Z.O,Z.j,Z.p,Z.u,Z.P,Z.h,Ye.hk,Ye.ho,Ye.hl,Z.y,Z.n,Ye.nj,Ye.np,Ye.nl,Z.b,Z.m,Ye.ml,Z.l]);new Uint16Array([Z.r,Z.R,Ye.rt,Z.s,Ye.sw,Ye.sg,Z.e,Z.f,Ye.fr,Ye.fa,Ye.fq,Ye.ft,Ye.fx,Ye.fv,Ye.fg,Z.a,Z.q,Ye.qt,Z.t,Z.T,Z.d,Z.w,Z.c,Z.z,Z.x,Z.v,Z.g]);new Uint16Array([Z.r,Z.R,Ye.rt,Z.s,Ye.sw,Ye.sg,Z.e,Z.E,Z.f,Ye.fr,Ye.fa,Ye.fq,Ye.ft,Ye.fx,Ye.fv,Ye.fg,Z.a,Z.q,Z.Q,Ye.qt,Z.t,Z.T,Z.d,Z.w,Z.W,Z.c,Z.z,Z.x,Z.v,Z.g,Z.k,Z.o,Z.i,Z.O,Z.j,Z.p,Z.u,Z.P,Z.h,Ye.hk,Ye.ho,Ye.hl,Z.y,Z.n,Ye.nj,Ye.np,Ye.nl,Z.b,Z.m,Ye.ml,Z.l]);function AI(...t){return function(e,i){for(let n=0,s=t.length;n<s;n++){const r=t[n](e,i);if(r){return r}}return null}}LI.bind(void 0,false);const RI=LI.bind(void 0,true);function LI(t,e,i){if(!i||i.length<e.length){return null}let n;if(t){n=E0(i,e)}else{n=i.indexOf(e)===0}if(!n){return null}return e.length>0?[{start:0,end:e.length}]:[]}function d7(t,e){const i=e.toLowerCase().indexOf(t.toLowerCase());if(i===-1){return null}return[{start:i,end:i+t.length}]}function h7(t,e){return b_(t.toLowerCase(),e.toLowerCase(),0,0)}function b_(t,e,i,n){if(i===t.length){return[]}else if(n===e.length){return null}else{if(t[i]===e[n]){let s=null;if(s=b_(t,e,i+1,n+1)){return OI({start:n,end:n+1},s)}return null}return b_(t,e,i,n+1)}}function C0(t){return A.a<=t&&t<=A.z}function ym(t){return A.A<=t&&t<=A.Z}function T0(t){return A.Digit0<=t&&t<=A.Digit9}function f7(t){return t===A.Space||t===A.Tab||t===A.LineFeed||t===A.CarriageReturn}const p7=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(t=>p7.add(t.charCodeAt(0)));function NI(t){return C0(t)||ym(t)||T0(t)}function OI(t,e){if(e.length===0){e=[t]}else if(t.end===e[0].start){e[0].start=t.start}else{e.unshift(t)}return e}function FI(t,e){for(let i=e;i<t.length;i++){const n=t.charCodeAt(i);if(ym(n)||T0(n)||i>0&&!NI(t.charCodeAt(i-1))){return i}}return t.length}function y_(t,e,i,n){if(i===t.length){return[]}else if(n===e.length){return null}else if(t[i]!==e[n].toLowerCase()){return null}else{let s=null;let r=n+1;s=y_(t,e,i+1,n+1);while(!s&&(r=FI(e,r))<e.length){s=y_(t,e,i+1,r);r++}return s===null?null:OI({start:n,end:n+1},s)}}function g7(t){let e=0,i=0,n=0,s=0,r=0;for(let u=0;u<t.length;u++){r=t.charCodeAt(u);if(ym(r)){e++}if(C0(r)){i++}if(NI(r)){n++}if(T0(r)){s++}}const o=e/t.length;const a=i/t.length;const l=n/t.length;const c=s/t.length;return{upperPercent:o,lowerPercent:a,alphaPercent:l,numericPercent:c}}function m7(t){const{upperPercent:e,lowerPercent:i}=t;return i===0&&e>.6}function _7(t){const{upperPercent:e,lowerPercent:i,alphaPercent:n,numericPercent:s}=t;return i>.2&&e<.8&&n>.6&&s<.2}function v7(t){let e=0,i=0,n=0,s=0;for(let r=0;r<t.length;r++){n=t.charCodeAt(r);if(ym(n)){e++}if(C0(n)){i++}if(f7(n)){s++}}if((e===0||i===0)&&s===0){return t.length<=30}else{return e<=5}}function MI(t,e){if(!e){return null}e=e.trim();if(e.length===0){return null}if(!v7(t)){return null}if(e.length>60){e=e.substring(0,60)}const i=g7(e);if(!_7(i)){if(!m7(i)){return null}e=e.toLowerCase()}let n=null;let s=0;t=t.toLowerCase();while(s<e.length&&(n=y_(t,e,0,s))===null){s=FI(e,s+1)}return n}AI(RI,MI,d7);AI(RI,MI,h7);new f0(1e4);const Fx=128;function P0(){const t=[];const e=[];for(let i=0;i<=Fx;i++){e[i]=0}for(let i=0;i<=Fx;i++){t.push(e.slice(0))}return t}P0();P0();P0();var Mx;(function(t){t[t["Diag"]=1]="Diag";t[t["Left"]=2]="Left";t[t["LeftLeft"]=3]="LeftLeft"})(Mx||(Mx={}));var Ux;(function(t){t.Default=[-100,0];function e(i){return!i||i.length===2&&i[0]===-100&&i[1]===0}t.isDefault=e})(Ux||(Ux={}));const x_=Object.create(null);function g(t,e){if(tt(e)){const i=x_[e];if(i===void 0){throw new Error(`${t} references an unknown codicon: ${e}`)}e=i}x_[t]=e;return{id:t}}function w7(){return x_}const b7={add:g("add",6e4),plus:g("plus",6e4),gistNew:g("gist-new",6e4),repoCreate:g("repo-create",6e4),lightbulb:g("lightbulb",60001),lightBulb:g("light-bulb",60001),repo:g("repo",60002),repoDelete:g("repo-delete",60002),gistFork:g("gist-fork",60003),repoForked:g("repo-forked",60003),gitPullRequest:g("git-pull-request",60004),gitPullRequestAbandoned:g("git-pull-request-abandoned",60004),recordKeys:g("record-keys",60005),keyboard:g("keyboard",60005),tag:g("tag",60006),gitPullRequestLabel:g("git-pull-request-label",60006),tagAdd:g("tag-add",60006),tagRemove:g("tag-remove",60006),person:g("person",60007),personFollow:g("person-follow",60007),personOutline:g("person-outline",60007),personFilled:g("person-filled",60007),gitBranch:g("git-branch",60008),gitBranchCreate:g("git-branch-create",60008),gitBranchDelete:g("git-branch-delete",60008),sourceControl:g("source-control",60008),mirror:g("mirror",60009),mirrorPublic:g("mirror-public",60009),star:g("star",60010),starAdd:g("star-add",60010),starDelete:g("star-delete",60010),starEmpty:g("star-empty",60010),comment:g("comment",60011),commentAdd:g("comment-add",60011),alert:g("alert",60012),warning:g("warning",60012),search:g("search",60013),searchSave:g("search-save",60013),logOut:g("log-out",60014),signOut:g("sign-out",60014),logIn:g("log-in",60015),signIn:g("sign-in",60015),eye:g("eye",60016),eyeUnwatch:g("eye-unwatch",60016),eyeWatch:g("eye-watch",60016),circleFilled:g("circle-filled",60017),primitiveDot:g("primitive-dot",60017),closeDirty:g("close-dirty",60017),debugBreakpoint:g("debug-breakpoint",60017),debugBreakpointDisabled:g("debug-breakpoint-disabled",60017),debugHint:g("debug-hint",60017),terminalDecorationSuccess:g("terminal-decoration-success",60017),primitiveSquare:g("primitive-square",60018),edit:g("edit",60019),pencil:g("pencil",60019),info:g("info",60020),issueOpened:g("issue-opened",60020),gistPrivate:g("gist-private",60021),gitForkPrivate:g("git-fork-private",60021),lock:g("lock",60021),mirrorPrivate:g("mirror-private",60021),close:g("close",60022),removeClose:g("remove-close",60022),x:g("x",60022),repoSync:g("repo-sync",60023),sync:g("sync",60023),clone:g("clone",60024),desktopDownload:g("desktop-download",60024),beaker:g("beaker",60025),microscope:g("microscope",60025),vm:g("vm",60026),deviceDesktop:g("device-desktop",60026),file:g("file",60027),fileText:g("file-text",60027),more:g("more",60028),ellipsis:g("ellipsis",60028),kebabHorizontal:g("kebab-horizontal",60028),mailReply:g("mail-reply",60029),reply:g("reply",60029),organization:g("organization",60030),organizationFilled:g("organization-filled",60030),organizationOutline:g("organization-outline",60030),newFile:g("new-file",60031),fileAdd:g("file-add",60031),newFolder:g("new-folder",60032),fileDirectoryCreate:g("file-directory-create",60032),trash:g("trash",60033),trashcan:g("trashcan",60033),history:g("history",60034),clock:g("clock",60034),folder:g("folder",60035),fileDirectory:g("file-directory",60035),symbolFolder:g("symbol-folder",60035),logoGithub:g("logo-github",60036),markGithub:g("mark-github",60036),github:g("github",60036),terminal:g("terminal",60037),console:g("console",60037),repl:g("repl",60037),zap:g("zap",60038),symbolEvent:g("symbol-event",60038),error:g("error",60039),stop:g("stop",60039),variable:g("variable",60040),symbolVariable:g("symbol-variable",60040),array:g("array",60042),symbolArray:g("symbol-array",60042),symbolModule:g("symbol-module",60043),symbolPackage:g("symbol-package",60043),symbolNamespace:g("symbol-namespace",60043),symbolObject:g("symbol-object",60043),symbolMethod:g("symbol-method",60044),symbolFunction:g("symbol-function",60044),symbolConstructor:g("symbol-constructor",60044),symbolBoolean:g("symbol-boolean",60047),symbolNull:g("symbol-null",60047),symbolNumeric:g("symbol-numeric",60048),symbolNumber:g("symbol-number",60048),symbolStructure:g("symbol-structure",60049),symbolStruct:g("symbol-struct",60049),symbolParameter:g("symbol-parameter",60050),symbolTypeParameter:g("symbol-type-parameter",60050),symbolKey:g("symbol-key",60051),symbolText:g("symbol-text",60051),symbolReference:g("symbol-reference",60052),goToFile:g("go-to-file",60052),symbolEnum:g("symbol-enum",60053),symbolValue:g("symbol-value",60053),symbolRuler:g("symbol-ruler",60054),symbolUnit:g("symbol-unit",60054),activateBreakpoints:g("activate-breakpoints",60055),archive:g("archive",60056),arrowBoth:g("arrow-both",60057),arrowDown:g("arrow-down",60058),arrowLeft:g("arrow-left",60059),arrowRight:g("arrow-right",60060),arrowSmallDown:g("arrow-small-down",60061),arrowSmallLeft:g("arrow-small-left",60062),arrowSmallRight:g("arrow-small-right",60063),arrowSmallUp:g("arrow-small-up",60064),arrowUp:g("arrow-up",60065),bell:g("bell",60066),bold:g("bold",60067),book:g("book",60068),bookmark:g("bookmark",60069),debugBreakpointConditionalUnverified:g("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:g("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:g("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:g("debug-breakpoint-data-unverified",60072),debugBreakpointData:g("debug-breakpoint-data",60073),debugBreakpointDataDisabled:g("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:g("debug-breakpoint-log-unverified",60074),debugBreakpointLog:g("debug-breakpoint-log",60075),debugBreakpointLogDisabled:g("debug-breakpoint-log-disabled",60075),briefcase:g("briefcase",60076),broadcast:g("broadcast",60077),browser:g("browser",60078),bug:g("bug",60079),calendar:g("calendar",60080),caseSensitive:g("case-sensitive",60081),check:g("check",60082),checklist:g("checklist",60083),chevronDown:g("chevron-down",60084),chevronLeft:g("chevron-left",60085),chevronRight:g("chevron-right",60086),chevronUp:g("chevron-up",60087),chromeClose:g("chrome-close",60088),chromeMaximize:g("chrome-maximize",60089),chromeMinimize:g("chrome-minimize",60090),chromeRestore:g("chrome-restore",60091),circleOutline:g("circle-outline",60092),circle:g("circle",60092),debugBreakpointUnverified:g("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:g("terminal-decoration-incomplete",60092),circleSlash:g("circle-slash",60093),circuitBoard:g("circuit-board",60094),clearAll:g("clear-all",60095),clippy:g("clippy",60096),closeAll:g("close-all",60097),cloudDownload:g("cloud-download",60098),cloudUpload:g("cloud-upload",60099),code:g("code",60100),collapseAll:g("collapse-all",60101),colorMode:g("color-mode",60102),commentDiscussion:g("comment-discussion",60103),creditCard:g("credit-card",60105),dash:g("dash",60108),dashboard:g("dashboard",60109),database:g("database",60110),debugContinue:g("debug-continue",60111),debugDisconnect:g("debug-disconnect",60112),debugPause:g("debug-pause",60113),debugRestart:g("debug-restart",60114),debugStart:g("debug-start",60115),debugStepInto:g("debug-step-into",60116),debugStepOut:g("debug-step-out",60117),debugStepOver:g("debug-step-over",60118),debugStop:g("debug-stop",60119),debug:g("debug",60120),deviceCameraVideo:g("device-camera-video",60121),deviceCamera:g("device-camera",60122),deviceMobile:g("device-mobile",60123),diffAdded:g("diff-added",60124),diffIgnored:g("diff-ignored",60125),diffModified:g("diff-modified",60126),diffRemoved:g("diff-removed",60127),diffRenamed:g("diff-renamed",60128),diff:g("diff",60129),diffSidebyside:g("diff-sidebyside",60129),discard:g("discard",60130),editorLayout:g("editor-layout",60131),emptyWindow:g("empty-window",60132),exclude:g("exclude",60133),extensions:g("extensions",60134),eyeClosed:g("eye-closed",60135),fileBinary:g("file-binary",60136),fileCode:g("file-code",60137),fileMedia:g("file-media",60138),filePdf:g("file-pdf",60139),fileSubmodule:g("file-submodule",60140),fileSymlinkDirectory:g("file-symlink-directory",60141),fileSymlinkFile:g("file-symlink-file",60142),fileZip:g("file-zip",60143),files:g("files",60144),filter:g("filter",60145),flame:g("flame",60146),foldDown:g("fold-down",60147),foldUp:g("fold-up",60148),fold:g("fold",60149),folderActive:g("folder-active",60150),folderOpened:g("folder-opened",60151),gear:g("gear",60152),gift:g("gift",60153),gistSecret:g("gist-secret",60154),gist:g("gist",60155),gitCommit:g("git-commit",60156),gitCompare:g("git-compare",60157),compareChanges:g("compare-changes",60157),gitMerge:g("git-merge",60158),githubAction:g("github-action",60159),githubAlt:g("github-alt",60160),globe:g("globe",60161),grabber:g("grabber",60162),graph:g("graph",60163),gripper:g("gripper",60164),heart:g("heart",60165),home:g("home",60166),horizontalRule:g("horizontal-rule",60167),hubot:g("hubot",60168),inbox:g("inbox",60169),issueReopened:g("issue-reopened",60171),issues:g("issues",60172),italic:g("italic",60173),jersey:g("jersey",60174),json:g("json",60175),kebabVertical:g("kebab-vertical",60176),key:g("key",60177),law:g("law",60178),lightbulbAutofix:g("lightbulb-autofix",60179),linkExternal:g("link-external",60180),link:g("link",60181),listOrdered:g("list-ordered",60182),listUnordered:g("list-unordered",60183),liveShare:g("live-share",60184),loading:g("loading",60185),location:g("location",60186),mailRead:g("mail-read",60187),mail:g("mail",60188),markdown:g("markdown",60189),megaphone:g("megaphone",60190),mention:g("mention",60191),milestone:g("milestone",60192),gitPullRequestMilestone:g("git-pull-request-milestone",60192),mortarBoard:g("mortar-board",60193),move:g("move",60194),multipleWindows:g("multiple-windows",60195),mute:g("mute",60196),noNewline:g("no-newline",60197),note:g("note",60198),octoface:g("octoface",60199),openPreview:g("open-preview",60200),package:g("package",60201),paintcan:g("paintcan",60202),pin:g("pin",60203),play:g("play",60204),run:g("run",60204),plug:g("plug",60205),preserveCase:g("preserve-case",60206),preview:g("preview",60207),project:g("project",60208),pulse:g("pulse",60209),question:g("question",60210),quote:g("quote",60211),radioTower:g("radio-tower",60212),reactions:g("reactions",60213),references:g("references",60214),refresh:g("refresh",60215),regex:g("regex",60216),remoteExplorer:g("remote-explorer",60217),remote:g("remote",60218),remove:g("remove",60219),replaceAll:g("replace-all",60220),replace:g("replace",60221),repoClone:g("repo-clone",60222),repoForcePush:g("repo-force-push",60223),repoPull:g("repo-pull",60224),repoPush:g("repo-push",60225),report:g("report",60226),requestChanges:g("request-changes",60227),rocket:g("rocket",60228),rootFolderOpened:g("root-folder-opened",60229),rootFolder:g("root-folder",60230),rss:g("rss",60231),ruby:g("ruby",60232),saveAll:g("save-all",60233),saveAs:g("save-as",60234),save:g("save",60235),screenFull:g("screen-full",60236),screenNormal:g("screen-normal",60237),searchStop:g("search-stop",60238),server:g("server",60240),settingsGear:g("settings-gear",60241),settings:g("settings",60242),shield:g("shield",60243),smiley:g("smiley",60244),sortPrecedence:g("sort-precedence",60245),splitHorizontal:g("split-horizontal",60246),splitVertical:g("split-vertical",60247),squirrel:g("squirrel",60248),starFull:g("star-full",60249),starHalf:g("star-half",60250),symbolClass:g("symbol-class",60251),symbolColor:g("symbol-color",60252),symbolConstant:g("symbol-constant",60253),symbolEnumMember:g("symbol-enum-member",60254),symbolField:g("symbol-field",60255),symbolFile:g("symbol-file",60256),symbolInterface:g("symbol-interface",60257),symbolKeyword:g("symbol-keyword",60258),symbolMisc:g("symbol-misc",60259),symbolOperator:g("symbol-operator",60260),symbolProperty:g("symbol-property",60261),wrench:g("wrench",60261),wrenchSubaction:g("wrench-subaction",60261),symbolSnippet:g("symbol-snippet",60262),tasklist:g("tasklist",60263),telescope:g("telescope",60264),textSize:g("text-size",60265),threeBars:g("three-bars",60266),thumbsdown:g("thumbsdown",60267),thumbsup:g("thumbsup",60268),tools:g("tools",60269),triangleDown:g("triangle-down",60270),triangleLeft:g("triangle-left",60271),triangleRight:g("triangle-right",60272),triangleUp:g("triangle-up",60273),twitter:g("twitter",60274),unfold:g("unfold",60275),unlock:g("unlock",60276),unmute:g("unmute",60277),unverified:g("unverified",60278),verified:g("verified",60279),versions:g("versions",60280),vmActive:g("vm-active",60281),vmOutline:g("vm-outline",60282),vmRunning:g("vm-running",60283),watch:g("watch",60284),whitespace:g("whitespace",60285),wholeWord:g("whole-word",60286),window:g("window",60287),wordWrap:g("word-wrap",60288),zoomIn:g("zoom-in",60289),zoomOut:g("zoom-out",60290),listFilter:g("list-filter",60291),listFlat:g("list-flat",60292),listSelection:g("list-selection",60293),selection:g("selection",60293),listTree:g("list-tree",60294),debugBreakpointFunctionUnverified:g("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:g("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:g("debug-breakpoint-function-disabled",60296),debugStackframeActive:g("debug-stackframe-active",60297),circleSmallFilled:g("circle-small-filled",60298),debugStackframeDot:g("debug-stackframe-dot",60298),terminalDecorationMark:g("terminal-decoration-mark",60298),debugStackframe:g("debug-stackframe",60299),debugStackframeFocused:g("debug-stackframe-focused",60299),debugBreakpointUnsupported:g("debug-breakpoint-unsupported",60300),symbolString:g("symbol-string",60301),debugReverseContinue:g("debug-reverse-continue",60302),debugStepBack:g("debug-step-back",60303),debugRestartFrame:g("debug-restart-frame",60304),debugAlt:g("debug-alt",60305),callIncoming:g("call-incoming",60306),callOutgoing:g("call-outgoing",60307),menu:g("menu",60308),expandAll:g("expand-all",60309),feedback:g("feedback",60310),gitPullRequestReviewer:g("git-pull-request-reviewer",60310),groupByRefType:g("group-by-ref-type",60311),ungroupByRefType:g("ungroup-by-ref-type",60312),account:g("account",60313),gitPullRequestAssignee:g("git-pull-request-assignee",60313),bellDot:g("bell-dot",60314),debugConsole:g("debug-console",60315),library:g("library",60316),output:g("output",60317),runAll:g("run-all",60318),syncIgnored:g("sync-ignored",60319),pinned:g("pinned",60320),githubInverted:g("github-inverted",60321),serverProcess:g("server-process",60322),serverEnvironment:g("server-environment",60323),pass:g("pass",60324),issueClosed:g("issue-closed",60324),stopCircle:g("stop-circle",60325),playCircle:g("play-circle",60326),record:g("record",60327),debugAltSmall:g("debug-alt-small",60328),vmConnect:g("vm-connect",60329),cloud:g("cloud",60330),merge:g("merge",60331),export:g("export",60332),graphLeft:g("graph-left",60333),magnet:g("magnet",60334),notebook:g("notebook",60335),redo:g("redo",60336),checkAll:g("check-all",60337),pinnedDirty:g("pinned-dirty",60338),passFilled:g("pass-filled",60339),circleLargeFilled:g("circle-large-filled",60340),circleLarge:g("circle-large",60341),circleLargeOutline:g("circle-large-outline",60341),combine:g("combine",60342),gather:g("gather",60342),table:g("table",60343),variableGroup:g("variable-group",60344),typeHierarchy:g("type-hierarchy",60345),typeHierarchySub:g("type-hierarchy-sub",60346),typeHierarchySuper:g("type-hierarchy-super",60347),gitPullRequestCreate:g("git-pull-request-create",60348),runAbove:g("run-above",60349),runBelow:g("run-below",60350),notebookTemplate:g("notebook-template",60351),debugRerun:g("debug-rerun",60352),workspaceTrusted:g("workspace-trusted",60353),workspaceUntrusted:g("workspace-untrusted",60354),workspaceUnknown:g("workspace-unknown",60355),terminalCmd:g("terminal-cmd",60356),terminalDebian:g("terminal-debian",60357),terminalLinux:g("terminal-linux",60358),terminalPowershell:g("terminal-powershell",60359),terminalTmux:g("terminal-tmux",60360),terminalUbuntu:g("terminal-ubuntu",60361),terminalBash:g("terminal-bash",60362),arrowSwap:g("arrow-swap",60363),copy:g("copy",60364),personAdd:g("person-add",60365),filterFilled:g("filter-filled",60366),wand:g("wand",60367),debugLineByLine:g("debug-line-by-line",60368),inspect:g("inspect",60369),layers:g("layers",60370),layersDot:g("layers-dot",60371),layersActive:g("layers-active",60372),compass:g("compass",60373),compassDot:g("compass-dot",60374),compassActive:g("compass-active",60375),azure:g("azure",60376),issueDraft:g("issue-draft",60377),gitPullRequestClosed:g("git-pull-request-closed",60378),gitPullRequestDraft:g("git-pull-request-draft",60379),debugAll:g("debug-all",60380),debugCoverage:g("debug-coverage",60381),runErrors:g("run-errors",60382),folderLibrary:g("folder-library",60383),debugContinueSmall:g("debug-continue-small",60384),beakerStop:g("beaker-stop",60385),graphLine:g("graph-line",60386),graphScatter:g("graph-scatter",60387),pieChart:g("pie-chart",60388),bracket:g("bracket",60175),bracketDot:g("bracket-dot",60389),bracketError:g("bracket-error",60390),lockSmall:g("lock-small",60391),azureDevops:g("azure-devops",60392),verifiedFilled:g("verified-filled",60393),newline:g("newline",60394),layout:g("layout",60395),layoutActivitybarLeft:g("layout-activitybar-left",60396),layoutActivitybarRight:g("layout-activitybar-right",60397),layoutPanelLeft:g("layout-panel-left",60398),layoutPanelCenter:g("layout-panel-center",60399),layoutPanelJustify:g("layout-panel-justify",60400),layoutPanelRight:g("layout-panel-right",60401),layoutPanel:g("layout-panel",60402),layoutSidebarLeft:g("layout-sidebar-left",60403),layoutSidebarRight:g("layout-sidebar-right",60404),layoutStatusbar:g("layout-statusbar",60405),layoutMenubar:g("layout-menubar",60406),layoutCentered:g("layout-centered",60407),target:g("target",60408),indent:g("indent",60409),recordSmall:g("record-small",60410),errorSmall:g("error-small",60411),terminalDecorationError:g("terminal-decoration-error",60411),arrowCircleDown:g("arrow-circle-down",60412),arrowCircleLeft:g("arrow-circle-left",60413),arrowCircleRight:g("arrow-circle-right",60414),arrowCircleUp:g("arrow-circle-up",60415),layoutSidebarRightOff:g("layout-sidebar-right-off",60416),layoutPanelOff:g("layout-panel-off",60417),layoutSidebarLeftOff:g("layout-sidebar-left-off",60418),blank:g("blank",60419),heartFilled:g("heart-filled",60420),map:g("map",60421),mapHorizontal:g("map-horizontal",60421),foldHorizontal:g("fold-horizontal",60421),mapFilled:g("map-filled",60422),mapHorizontalFilled:g("map-horizontal-filled",60422),foldHorizontalFilled:g("fold-horizontal-filled",60422),circleSmall:g("circle-small",60423),bellSlash:g("bell-slash",60424),bellSlashDot:g("bell-slash-dot",60425),commentUnresolved:g("comment-unresolved",60426),gitPullRequestGoToChanges:g("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:g("git-pull-request-new-changes",60428),searchFuzzy:g("search-fuzzy",60429),commentDraft:g("comment-draft",60430),send:g("send",60431),sparkle:g("sparkle",60432),insert:g("insert",60433),mic:g("mic",60434),thumbsdownFilled:g("thumbsdown-filled",60435),thumbsupFilled:g("thumbsup-filled",60436),coffee:g("coffee",60437),snake:g("snake",60438),game:g("game",60439),vr:g("vr",60440),chip:g("chip",60441),piano:g("piano",60442),music:g("music",60443),micFilled:g("mic-filled",60444),repoFetch:g("repo-fetch",60445),copilot:g("copilot",60446),lightbulbSparkle:g("lightbulb-sparkle",60447),robot:g("robot",60448),sparkleFilled:g("sparkle-filled",60449),diffSingle:g("diff-single",60450),diffMultiple:g("diff-multiple",60451),surroundWith:g("surround-with",60452),share:g("share",60453),gitStash:g("git-stash",60454),gitStashApply:g("git-stash-apply",60455),gitStashPop:g("git-stash-pop",60456),vscode:g("vscode",60457),vscodeInsiders:g("vscode-insiders",60458),codeOss:g("code-oss",60459),runCoverage:g("run-coverage",60460),runAllCoverage:g("run-all-coverage",60461),coverage:g("coverage",60462),githubProject:g("github-project",60463),mapVertical:g("map-vertical",60464),foldVertical:g("fold-vertical",60464),mapVerticalFilled:g("map-vertical-filled",60465),foldVerticalFilled:g("fold-vertical-filled",60465),goToSearch:g("go-to-search",60466),percentage:g("percentage",60467),sortPercentage:g("sort-percentage",60467),attach:g("attach",60468),goToEditingSession:g("go-to-editing-session",60469),editSession:g("edit-session",60470),codeReview:g("code-review",60471),copilotWarning:g("copilot-warning",60472),python:g("python",60473),copilotLarge:g("copilot-large",60474),copilotWarningLarge:g("copilot-warning-large",60475),keyboardTab:g("keyboard-tab",60476),copilotBlocked:g("copilot-blocked",60477),copilotNotConnected:g("copilot-not-connected",60478),flag:g("flag",60479),lightbulbEmpty:g("lightbulb-empty",60480),symbolMethodArrow:g("symbol-method-arrow",60481),copilotUnavailable:g("copilot-unavailable",60482),repoPinned:g("repo-pinned",60483),keyboardTabAbove:g("keyboard-tab-above",60484),keyboardTabBelow:g("keyboard-tab-below",60485),gitPullRequestDone:g("git-pull-request-done",60486)};const y7={dialogError:g("dialog-error","error"),dialogWarning:g("dialog-warning","warning"),dialogInfo:g("dialog-info","info"),dialogClose:g("dialog-close","close"),treeItemExpanded:g("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:g("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:g("tree-filter-on-type-off","list-selection"),treeFilterClear:g("tree-filter-clear","close"),treeItemLoading:g("tree-item-loading","loading"),menuSelection:g("menu-selection","check"),menuSubmenu:g("menu-submenu","chevron-right"),menuBarMore:g("menubar-more","more"),scrollbarButtonLeft:g("scrollbar-button-left","triangle-left"),scrollbarButtonRight:g("scrollbar-button-right","triangle-right"),scrollbarButtonUp:g("scrollbar-button-up","triangle-up"),scrollbarButtonDown:g("scrollbar-button-down","triangle-down"),toolBarMore:g("toolbar-more","more"),quickInputBack:g("quick-input-back","arrow-left"),dropDownButton:g("drop-down-button",60084),symbolCustomColor:g("symbol-customcolor",60252),exportIcon:g("export",60332),workspaceUnspecified:g("workspace-unspecified",60355),newLine:g("newline",60394),thumbsDownFilled:g("thumbsdown-filled",60435),thumbsUpFilled:g("thumbsup-filled",60436),gitFetch:g("git-fetch",60445),lightbulbSparkleAutofix:g("lightbulb-sparkle-autofix",60447),debugBreakpointPending:g("debug-breakpoint-pending",60377)};const ve={...b7,...y7};var Jl;(function(t){function e(i){return i&&typeof i==="object"&&typeof i.id==="string"}t.isThemeColor=e})(Jl||(Jl={}));var Zt;(function(t){t.iconNameSegment="[A-Za-z0-9]+";t.iconNameExpression="[A-Za-z0-9-]+";t.iconModifierExpression="~[A-Za-z]+";t.iconNameCharacter="[A-Za-z0-9~-]";const e=new RegExp(`^(${t.iconNameExpression})(${t.iconModifierExpression})?$`);function i(p){const f=e.exec(p.id);if(!f){return i(ve.error)}const[,m,v]=f;const y=["codicon","codicon-"+m];if(v){y.push("codicon-modifier-"+v.substring(1))}return y}t.asClassNameArray=i;function n(p){return i(p).join(" ")}t.asClassName=n;function s(p){return"."+i(p).join(".")}t.asCSSSelector=s;function r(p){return p&&typeof p==="object"&&typeof p.id==="string"&&(typeof p.color==="undefined"||Jl.isThemeColor(p.color))}t.isThemeIcon=r;const o=new RegExp(`^\\$\\((${t.iconNameExpression}(?:${t.iconModifierExpression})?)\\)$`);function a(p){const f=o.exec(p);if(!f){return void 0}const[,m]=f;return{id:m}}t.fromString=a;function l(p){return{id:p}}t.fromId=l;function c(p,f){let m=p.id;const v=m.lastIndexOf("~");if(v!==-1){m=m.substring(0,v)}if(f){m=`${m}~${f}`}return{id:m}}t.modify=c;function u(p){const f=p.id.lastIndexOf("~");if(f!==-1){return p.id.substring(f+1)}return void 0}t.getModifier=u;function d(p,f){return p.id===f.id&&p.color?.id===f.color?.id}t.isEqual=d})(Zt||(Zt={}));const A0=new RegExp(`\\$\\(${Zt.iconNameExpression}(?:${Zt.iconModifierExpression})?\\)`,"g");const x7=new RegExp(`(\\\\)?${A0.source}`,"g");function E7(t){return t.replace(x7,(e,i)=>i?e:`\\${e}`)}new RegExp(`\\\\${A0.source}`,"g");new RegExp(`(\\s)?(\\\\)?${A0.source}(\\s)?`,"g");new RegExp(`\\$\\(${Zt.iconNameCharacter}+\\)`,"g");var Wf;(function(t){t[t["Paragraph"]=0]="Paragraph";t[t["Break"]=1]="Break"})(Wf||(Wf={}));let Xl=class UI{static lift(e){const i=new UI(e.value,e);i.uris=e.uris;i.baseUri=e.baseUri?b.revive(e.baseUri):void 0;return i}constructor(e="",i=false){this.value=e;if(typeof this.value!=="string"){throw $e("value")}if(typeof i==="boolean"){this.isTrusted=i;this.supportThemeIcons=false;this.supportHtml=false}else{this.isTrusted=i.isTrusted??void 0;this.supportThemeIcons=i.supportThemeIcons??false;this.supportHtml=i.supportHtml??false}}appendText(e,i=Wf.Paragraph){this.value+=S7(this.supportThemeIcons?E7(e):e).replace(/([ \t]+)/g,(n,s)=>"&nbsp;".repeat(s.length)).replace(/\>/gm,"\\>").replace(/\n/g,i===Wf.Break?"\\\n":"\n\n");return this}appendMarkdown(e){this.value+=e;return this}appendCodeblock(e,i){this.value+=`
${D7(i,e)}
`;return this}appendLink(e,i,n){this.value+="[";this.value+=this._escape(i,"]");this.value+="](";this.value+=this._escape(String(e),")");if(n){this.value+=` "${this._escape(this._escape(n,'"'),")")}"`}this.value+=")";return this}_escape(e,i){const n=new RegExp(ya(i),"g");return e.replace(n,(s,r)=>{if(e.charAt(r-1)!=="\\"){return`\\${s}`}else{return s}})}};function Ir(t){if(t instanceof Xl){return true}else if(t&&typeof t==="object"){return typeof t.value==="string"&&(typeof t.isTrusted==="boolean"||typeof t.isTrusted==="object"||t.isTrusted===void 0)&&(typeof t.supportThemeIcons==="boolean"||t.supportThemeIcons===void 0)}return false}function S7(t){return t.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}function D7(t,e){const i=t.match(/^`+/gm)?.reduce((s,r)=>s.length>r.length?s:r).length??0;const n=i>=3?i+1:3;return[`${"`".repeat(n)}${e}`,t,`${"`".repeat(n)}`].join("\n")}function k7(t){const e=[];const i=t.split("|").map(s=>s.trim());t=i[0];const n=i[1];if(n){const s=/height=(\d+)/.exec(n);const r=/width=(\d+)/.exec(n);const o=s?s[1]:"";const a=r?r[1]:"";const l=isFinite(parseInt(a));const c=isFinite(parseInt(o));if(l){e.push(`width="${a}"`)}if(c){e.push(`height="${o}"`)}}return{href:t,dimensions:e}}function R0(){return{async:false,breaks:false,extensions:null,gfm:true,hooks:null,pedantic:false,renderer:null,silent:false,tokenizer:null,walkTokens:null}}let Na=R0();function $I(t){Na=t}const HI=/[&<>"']/;const I7=new RegExp(HI.source,"g");const BI=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/;const C7=new RegExp(BI.source,"g");const T7={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};const $x=t=>T7[t];function bn(t,e){if(e){if(HI.test(t)){return t.replace(I7,$x)}}else{if(BI.test(t)){return t.replace(C7,$x)}}return t}const P7=/(^|[^\[])\^/g;function It(t,e){let i=typeof t==="string"?t:t.source;e=e||"";const n={replace:(s,r)=>{let o=typeof r==="string"?r:r.source;o=o.replace(P7,"$1");i=i.replace(s,o);return n},getRegex:()=>{return new RegExp(i,e)}};return n}function Hx(t){try{t=encodeURI(t).replace(/%25/g,"%")}catch{return null}return t}const mu={exec:()=>null};function Bx(t,e){const i=t.replace(/\|/g,(r,o,a)=>{let l=false;let c=o;while(--c>=0&&a[c]==="\\")l=!l;if(l){return"|"}else{return" |"}}),n=i.split(/ \|/);let s=0;if(!n[0].trim()){n.shift()}if(n.length>0&&!n[n.length-1].trim()){n.pop()}if(e){if(n.length>e){n.splice(e)}else{while(n.length<e)n.push("")}}for(;s<n.length;s++){n[s]=n[s].trim().replace(/\\\|/g,"|")}return n}function Wc(t,e,i){const n=t.length;if(n===0){return""}let s=0;while(s<n){const r=t.charAt(n-s-1);if(r===e&&true){s++}else{break}}return t.slice(0,n-s)}function A7(t,e){if(t.indexOf(e[1])===-1){return-1}let i=0;for(let n=0;n<t.length;n++){if(t[n]==="\\"){n++}else if(t[n]===e[0]){i++}else if(t[n]===e[1]){i--;if(i<0){return n}}}return-1}function Vx(t,e,i,n){const s=e.href;const r=e.title?bn(e.title):null;const o=t[1].replace(/\\([\[\]])/g,"$1");if(t[0].charAt(0)!=="!"){n.state.inLink=true;const a={type:"link",raw:i,href:s,title:r,text:o,tokens:n.inlineTokens(o)};n.state.inLink=false;return a}return{type:"image",raw:i,href:s,title:r,text:bn(o)}}function R7(t,e){const i=t.match(/^(\s+)(?:```)/);if(i===null){return e}const n=i[1];return e.split("\n").map(s=>{const r=s.match(/^\s+/);if(r===null){return s}const[o]=r;if(o.length>=n.length){return s.slice(n.length)}return s}).join("\n")}class zf{options;rules;lexer;constructor(e){this.options=e||Na}space(e){const i=this.rules.block.newline.exec(e);if(i&&i[0].length>0){return{type:"space",raw:i[0]}}}code(e){const i=this.rules.block.code.exec(e);if(i){const n=i[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:i[0],codeBlockStyle:"indented",text:!this.options.pedantic?Wc(n,"\n"):n}}}fences(e){const i=this.rules.block.fences.exec(e);if(i){const n=i[0];const s=R7(n,i[3]||"");return{type:"code",raw:n,lang:i[2]?i[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):i[2],text:s}}}heading(e){const i=this.rules.block.heading.exec(e);if(i){let n=i[2].trim();if(/#$/.test(n)){const s=Wc(n,"#");if(this.options.pedantic){n=s.trim()}else if(!s||/ $/.test(s)){n=s.trim()}}return{type:"heading",raw:i[0],depth:i[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){const i=this.rules.block.hr.exec(e);if(i){return{type:"hr",raw:Wc(i[0],"\n")}}}blockquote(e){const i=this.rules.block.blockquote.exec(e);if(i){let n=Wc(i[0],"\n").split("\n");let s="";let r="";const o=[];while(n.length>0){let a=false;const l=[];let c;for(c=0;c<n.length;c++){if(/^ {0,3}>/.test(n[c])){l.push(n[c]);a=true}else if(!a){l.push(n[c])}else{break}}n=n.slice(c);const u=l.join("\n");const d=u.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,"\n    $1").replace(/^ {0,3}>[ \t]?/gm,"");s=s?`${s}
${u}`:u;r=r?`${r}
${d}`:d;const p=this.lexer.state.top;this.lexer.state.top=true;this.lexer.blockTokens(d,o,true);this.lexer.state.top=p;if(n.length===0){break}const f=o[o.length-1];if(f?.type==="code"){break}else if(f?.type==="blockquote"){const m=f;const v=m.raw+"\n"+n.join("\n");const y=this.blockquote(v);o[o.length-1]=y;s=s.substring(0,s.length-m.raw.length)+y.raw;r=r.substring(0,r.length-m.text.length)+y.text;break}else if(f?.type==="list"){const m=f;const v=m.raw+"\n"+n.join("\n");const y=this.list(v);o[o.length-1]=y;s=s.substring(0,s.length-f.raw.length)+y.raw;r=r.substring(0,r.length-m.raw.length)+y.raw;n=v.substring(o[o.length-1].raw.length).split("\n");continue}}return{type:"blockquote",raw:s,tokens:o,text:r}}}list(e){let i=this.rules.block.list.exec(e);if(i){let n=i[1].trim();const s=n.length>1;const r={type:"list",raw:"",ordered:s,start:s?+n.slice(0,-1):"",loose:false,items:[]};n=s?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`;if(this.options.pedantic){n=s?n:"[*+-]"}const o=new RegExp(`^( {0,3}${n})((?:[	 ][^\\n]*)?(?:\\n|$))`);let a=false;while(e){let l=false;let c="";let u="";if(!(i=o.exec(e))){break}if(this.rules.block.hr.test(e)){break}c=i[0];e=e.substring(c.length);let d=i[2].split("\n",1)[0].replace(/^\t+/,D=>" ".repeat(3*D.length));let p=e.split("\n",1)[0];let f=!d.trim();let m=0;if(this.options.pedantic){m=2;u=d.trimStart()}else if(f){m=i[1].length+1}else{m=i[2].search(/[^ ]/);m=m>4?1:m;u=d.slice(m);m+=i[1].length}if(f&&/^ *$/.test(p)){c+=p+"\n";e=e.substring(p.length+1);l=true}if(!l){const D=new RegExp(`^ {0,${Math.min(3,m-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`);const I=new RegExp(`^ {0,${Math.min(3,m-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`);const R=new RegExp(`^ {0,${Math.min(3,m-1)}}(?:\`\`\`|~~~)`);const J=new RegExp(`^ {0,${Math.min(3,m-1)}}#`);while(e){const H=e.split("\n",1)[0];p=H;if(this.options.pedantic){p=p.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")}if(R.test(p)){break}if(J.test(p)){break}if(D.test(p)){break}if(I.test(e)){break}if(p.search(/[^ ]/)>=m||!p.trim()){u+="\n"+p.slice(m)}else{if(f){break}if(d.search(/[^ ]/)>=4){break}if(R.test(d)){break}if(J.test(d)){break}if(I.test(d)){break}u+="\n"+p}if(!f&&!p.trim()){f=true}c+=H+"\n";e=e.substring(H.length+1);d=p.slice(m)}}if(!r.loose){if(a){r.loose=true}else if(/\n *\n *$/.test(c)){a=true}}let v=null;let y;if(this.options.gfm){v=/^\[[ xX]\] /.exec(u);if(v){y=v[0]!=="[ ] ";u=u.replace(/^\[[ xX]\] +/,"")}}r.items.push({type:"list_item",raw:c,task:!!v,checked:y,loose:false,text:u,tokens:[]});r.raw+=c}r.items[r.items.length-1].raw=r.items[r.items.length-1].raw.trimEnd();r.items[r.items.length-1].text=r.items[r.items.length-1].text.trimEnd();r.raw=r.raw.trimEnd();for(let l=0;l<r.items.length;l++){this.lexer.state.top=false;r.items[l].tokens=this.lexer.blockTokens(r.items[l].text,[]);if(!r.loose){const c=r.items[l].tokens.filter(d=>d.type==="space");const u=c.length>0&&c.some(d=>/\n.*\n/.test(d.raw));r.loose=u}}if(r.loose){for(let l=0;l<r.items.length;l++){r.items[l].loose=true}}return r}}html(e){const i=this.rules.block.html.exec(e);if(i){const n={type:"html",block:true,raw:i[0],pre:i[1]==="pre"||i[1]==="script"||i[1]==="style",text:i[0]};return n}}def(e){const i=this.rules.block.def.exec(e);if(i){const n=i[1].toLowerCase().replace(/\s+/g," ");const s=i[2]?i[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"";const r=i[3]?i[3].substring(1,i[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):i[3];return{type:"def",tag:n,raw:i[0],href:s,title:r}}}table(e){const i=this.rules.block.table.exec(e);if(!i){return}if(!/[:|]/.test(i[2])){return}const n=Bx(i[1]);const s=i[2].replace(/^\||\| *$/g,"").split("|");const r=i[3]&&i[3].trim()?i[3].replace(/\n[ \t]*$/,"").split("\n"):[];const o={type:"table",raw:i[0],header:[],align:[],rows:[]};if(n.length!==s.length){return}for(const a of s){if(/^ *-+: *$/.test(a)){o.align.push("right")}else if(/^ *:-+: *$/.test(a)){o.align.push("center")}else if(/^ *:-+ *$/.test(a)){o.align.push("left")}else{o.align.push(null)}}for(let a=0;a<n.length;a++){o.header.push({text:n[a],tokens:this.lexer.inline(n[a]),header:true,align:o.align[a]})}for(const a of r){o.rows.push(Bx(a,o.header.length).map((l,c)=>{return{text:l,tokens:this.lexer.inline(l),header:false,align:o.align[c]}}))}return o}lheading(e){const i=this.rules.block.lheading.exec(e);if(i){return{type:"heading",raw:i[0],depth:i[2].charAt(0)==="="?1:2,text:i[1],tokens:this.lexer.inline(i[1])}}}paragraph(e){const i=this.rules.block.paragraph.exec(e);if(i){const n=i[1].charAt(i[1].length-1)==="\n"?i[1].slice(0,-1):i[1];return{type:"paragraph",raw:i[0],text:n,tokens:this.lexer.inline(n)}}}text(e){const i=this.rules.block.text.exec(e);if(i){return{type:"text",raw:i[0],text:i[0],tokens:this.lexer.inline(i[0])}}}escape(e){const i=this.rules.inline.escape.exec(e);if(i){return{type:"escape",raw:i[0],text:bn(i[1])}}}tag(e){const i=this.rules.inline.tag.exec(e);if(i){if(!this.lexer.state.inLink&&/^<a /i.test(i[0])){this.lexer.state.inLink=true}else if(this.lexer.state.inLink&&/^<\/a>/i.test(i[0])){this.lexer.state.inLink=false}if(!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(i[0])){this.lexer.state.inRawBlock=true}else if(this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(i[0])){this.lexer.state.inRawBlock=false}return{type:"html",raw:i[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:false,text:i[0]}}}link(e){const i=this.rules.inline.link.exec(e);if(i){const n=i[2].trim();if(!this.options.pedantic&&/^</.test(n)){if(!/>$/.test(n)){return}const o=Wc(n.slice(0,-1),"\\");if((n.length-o.length)%2===0){return}}else{const o=A7(i[2],"()");if(o>-1){const a=i[0].indexOf("!")===0?5:4;const l=a+i[1].length+o;i[2]=i[2].substring(0,o);i[0]=i[0].substring(0,l).trim();i[3]=""}}let s=i[2];let r="";if(this.options.pedantic){const o=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(s);if(o){s=o[1];r=o[3]}}else{r=i[3]?i[3].slice(1,-1):""}s=s.trim();if(/^</.test(s)){if(this.options.pedantic&&!/>$/.test(n)){s=s.slice(1)}else{s=s.slice(1,-1)}}return Vx(i,{href:s?s.replace(this.rules.inline.anyPunctuation,"$1"):s,title:r?r.replace(this.rules.inline.anyPunctuation,"$1"):r},i[0],this.lexer)}}reflink(e,i){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){const s=(n[2]||n[1]).replace(/\s+/g," ");const r=i[s.toLowerCase()];if(!r){const o=n[0].charAt(0);return{type:"text",raw:o,text:o}}return Vx(n,r,n[0],this.lexer)}}emStrong(e,i,n=""){let s=this.rules.inline.emStrongLDelim.exec(e);if(!s)return;if(s[3]&&n.match(/[\p{L}\p{N}]/u))return;const r=s[1]||s[2]||"";if(!r||!n||this.rules.inline.punctuation.exec(n)){const o=[...s[0]].length-1;let a,l,c=o,u=0;const d=s[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;d.lastIndex=0;i=i.slice(-1*e.length+o);while((s=d.exec(i))!=null){a=s[1]||s[2]||s[3]||s[4]||s[5]||s[6];if(!a)continue;l=[...a].length;if(s[3]||s[4]){c+=l;continue}else if(s[5]||s[6]){if(o%3&&!((o+l)%3)){u+=l;continue}}c-=l;if(c>0)continue;l=Math.min(l,l+c+u);const p=[...s[0]][0].length;const f=e.slice(0,o+s.index+p+l);if(Math.min(o,l)%2){const v=f.slice(1,-1);return{type:"em",raw:f,text:v,tokens:this.lexer.inlineTokens(v)}}const m=f.slice(2,-2);return{type:"strong",raw:f,text:m,tokens:this.lexer.inlineTokens(m)}}}}codespan(e){const i=this.rules.inline.code.exec(e);if(i){let n=i[2].replace(/\n/g," ");const s=/[^ ]/.test(n);const r=/^ /.test(n)&&/ $/.test(n);if(s&&r){n=n.substring(1,n.length-1)}n=bn(n,true);return{type:"codespan",raw:i[0],text:n}}}br(e){const i=this.rules.inline.br.exec(e);if(i){return{type:"br",raw:i[0]}}}del(e){const i=this.rules.inline.del.exec(e);if(i){return{type:"del",raw:i[0],text:i[2],tokens:this.lexer.inlineTokens(i[2])}}}autolink(e){const i=this.rules.inline.autolink.exec(e);if(i){let n,s;if(i[2]==="@"){n=bn(i[1]);s="mailto:"+n}else{n=bn(i[1]);s=n}return{type:"link",raw:i[0],text:n,href:s,tokens:[{type:"text",raw:n,text:n}]}}}url(e){let i;if(i=this.rules.inline.url.exec(e)){let n,s;if(i[2]==="@"){n=bn(i[0]);s="mailto:"+n}else{let r;do{r=i[0];i[0]=this.rules.inline._backpedal.exec(i[0])?.[0]??""}while(r!==i[0]);n=bn(i[0]);if(i[1]==="www."){s="http://"+i[0]}else{s=i[0]}}return{type:"link",raw:i[0],text:n,href:s,tokens:[{type:"text",raw:n,text:n}]}}}inlineText(e){const i=this.rules.inline.text.exec(e);if(i){let n;if(this.lexer.state.inRawBlock){n=i[0]}else{n=bn(i[0])}return{type:"text",raw:i[0],text:n}}}}const L7=/^(?: *(?:\n|$))+/;const N7=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/;const O7=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/;const uh=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/;const F7=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/;const VI=/(?:[*+-]|\d{1,9}[.)])/;const WI=It(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,VI).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex();const L0=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/;const M7=/^[^\n]+/;const N0=/(?!\s*\])(?:\\.|[^\[\]\\])+/;const U7=It(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",N0).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex();const $7=It(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,VI).getRegex();const xm="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";const O0=/<!--(?:-?>|[\s\S]*?(?:-->|$))/;const H7=It("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",O0).replace("tag",xm).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();const zI=It(L0).replace("hr",uh).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",xm).getRegex();const B7=It(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",zI).getRegex();const F0={blockquote:B7,code:N7,def:U7,fences:O7,heading:F7,hr:uh,html:H7,lheading:WI,list:$7,newline:L7,paragraph:zI,table:mu,text:M7};const Wx=It("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",uh).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",xm).getRegex();const V7={...F0,table:Wx,paragraph:It(L0).replace("hr",uh).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Wx).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",xm).getRegex()};const W7={...F0,html:It(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",O0).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:mu,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:It(L0).replace("hr",uh).replace("heading"," *#{1,6} *[^\n]").replace("lheading",WI).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()};const qI=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/;const z7=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/;const jI=/^( {2,}|\\)\n(?!\s*$)/;const q7=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/;const dh="\\p{P}\\p{S}";const j7=It(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,dh).getRegex();const G7=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g;const K7=It(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,dh).getRegex();const Q7=It("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,dh).getRegex();const J7=It("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,dh).getRegex();const X7=It(/\\([punct])/,"gu").replace(/punct/g,dh).getRegex();const Y7=It(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex();const Z7=It(O0).replace("(?:-->|$)","-->").getRegex();const eA=It("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Z7).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex();const qf=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;const tA=It(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",qf).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex();const GI=It(/^!?\[(label)\]\[(ref)\]/).replace("label",qf).replace("ref",N0).getRegex();const KI=It(/^!?\[(ref)\](?:\[\])?/).replace("ref",N0).getRegex();const iA=It("reflink|nolink(?!\\()","g").replace("reflink",GI).replace("nolink",KI).getRegex();const M0={_backpedal:mu,anyPunctuation:X7,autolink:Y7,blockSkip:G7,br:jI,code:z7,del:mu,emStrongLDelim:K7,emStrongRDelimAst:Q7,emStrongRDelimUnd:J7,escape:qI,link:tA,nolink:KI,punctuation:j7,reflink:GI,reflinkSearch:iA,tag:eA,text:q7,url:mu};const nA={...M0,link:It(/^!?\[(label)\]\((.*?)\)/).replace("label",qf).getRegex(),reflink:It(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",qf).getRegex()};const E_={...M0,escape:It(qI).replace("])","~|])").getRegex(),url:It(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/};const sA={...E_,br:It(jI).replace("{2,}","*").getRegex(),text:It(E_.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()};const Ih={normal:F0,gfm:V7,pedantic:W7};const zc={normal:M0,gfm:E_,breaks:sA,pedantic:nA};class Es{tokens;options;state;tokenizer;inlineQueue;constructor(e){this.tokens=[];this.tokens.links=Object.create(null);this.options=e||Na;this.options.tokenizer=this.options.tokenizer||new zf;this.tokenizer=this.options.tokenizer;this.tokenizer.options=this.options;this.tokenizer.lexer=this;this.inlineQueue=[];this.state={inLink:false,inRawBlock:false,top:true};const i={block:Ih.normal,inline:zc.normal};if(this.options.pedantic){i.block=Ih.pedantic;i.inline=zc.pedantic}else if(this.options.gfm){i.block=Ih.gfm;if(this.options.breaks){i.inline=zc.breaks}else{i.inline=zc.gfm}}this.tokenizer.rules=i}static get rules(){return{block:Ih,inline:zc}}static lex(e,i){const n=new Es(i);return n.lex(e)}static lexInline(e,i){const n=new Es(i);return n.inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,"\n");this.blockTokens(e,this.tokens);for(let i=0;i<this.inlineQueue.length;i++){const n=this.inlineQueue[i];this.inlineTokens(n.src,n.tokens)}this.inlineQueue=[];return this.tokens}blockTokens(e,i=[],n=false){if(this.options.pedantic){e=e.replace(/\t/g,"    ").replace(/^ +$/gm,"")}else{e=e.replace(/^( *)(\t+)/gm,(a,l,c)=>{return l+"    ".repeat(c.length)})}let s;let r;let o;while(e){if(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>{if(s=a.call({lexer:this},e,i)){e=e.substring(s.raw.length);i.push(s);return true}return false})){continue}if(s=this.tokenizer.space(e)){e=e.substring(s.raw.length);if(s.raw.length===1&&i.length>0){i[i.length-1].raw+="\n"}else{i.push(s)}continue}if(s=this.tokenizer.code(e)){e=e.substring(s.raw.length);r=i[i.length-1];if(r&&(r.type==="paragraph"||r.type==="text")){r.raw+="\n"+s.raw;r.text+="\n"+s.text;this.inlineQueue[this.inlineQueue.length-1].src=r.text}else{i.push(s)}continue}if(s=this.tokenizer.fences(e)){e=e.substring(s.raw.length);i.push(s);continue}if(s=this.tokenizer.heading(e)){e=e.substring(s.raw.length);i.push(s);continue}if(s=this.tokenizer.hr(e)){e=e.substring(s.raw.length);i.push(s);continue}if(s=this.tokenizer.blockquote(e)){e=e.substring(s.raw.length);i.push(s);continue}if(s=this.tokenizer.list(e)){e=e.substring(s.raw.length);i.push(s);continue}if(s=this.tokenizer.html(e)){e=e.substring(s.raw.length);i.push(s);continue}if(s=this.tokenizer.def(e)){e=e.substring(s.raw.length);r=i[i.length-1];if(r&&(r.type==="paragraph"||r.type==="text")){r.raw+="\n"+s.raw;r.text+="\n"+s.raw;this.inlineQueue[this.inlineQueue.length-1].src=r.text}else if(!this.tokens.links[s.tag]){this.tokens.links[s.tag]={href:s.href,title:s.title}}continue}if(s=this.tokenizer.table(e)){e=e.substring(s.raw.length);i.push(s);continue}if(s=this.tokenizer.lheading(e)){e=e.substring(s.raw.length);i.push(s);continue}o=e;if(this.options.extensions&&this.options.extensions.startBlock){let a=Infinity;const l=e.slice(1);let c;this.options.extensions.startBlock.forEach(u=>{c=u.call({lexer:this},l);if(typeof c==="number"&&c>=0){a=Math.min(a,c)}});if(a<Infinity&&a>=0){o=e.substring(0,a+1)}}if(this.state.top&&(s=this.tokenizer.paragraph(o))){r=i[i.length-1];if(n&&r?.type==="paragraph"){r.raw+="\n"+s.raw;r.text+="\n"+s.text;this.inlineQueue.pop();this.inlineQueue[this.inlineQueue.length-1].src=r.text}else{i.push(s)}n=o.length!==e.length;e=e.substring(s.raw.length);continue}if(s=this.tokenizer.text(e)){e=e.substring(s.raw.length);r=i[i.length-1];if(r&&r.type==="text"){r.raw+="\n"+s.raw;r.text+="\n"+s.text;this.inlineQueue.pop();this.inlineQueue[this.inlineQueue.length-1].src=r.text}else{i.push(s)}continue}if(e){const a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}else{throw new Error(a)}}}this.state.top=true;return i}inline(e,i=[]){this.inlineQueue.push({src:e,tokens:i});return i}inlineTokens(e,i=[]){let n,s,r;let o=e;let a;let l,c;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0){while((a=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null){if(u.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))){o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex)}}}}while((a=this.tokenizer.rules.inline.blockSkip.exec(o))!=null){o=o.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex)}while((a=this.tokenizer.rules.inline.anyPunctuation.exec(o))!=null){o=o.slice(0,a.index)+"++"+o.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex)}while(e){if(!l){c=""}l=false;if(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(u=>{if(n=u.call({lexer:this},e,i)){e=e.substring(n.raw.length);i.push(n);return true}return false})){continue}if(n=this.tokenizer.escape(e)){e=e.substring(n.raw.length);i.push(n);continue}if(n=this.tokenizer.tag(e)){e=e.substring(n.raw.length);s=i[i.length-1];if(s&&n.type==="text"&&s.type==="text"){s.raw+=n.raw;s.text+=n.text}else{i.push(n)}continue}if(n=this.tokenizer.link(e)){e=e.substring(n.raw.length);i.push(n);continue}if(n=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(n.raw.length);s=i[i.length-1];if(s&&n.type==="text"&&s.type==="text"){s.raw+=n.raw;s.text+=n.text}else{i.push(n)}continue}if(n=this.tokenizer.emStrong(e,o,c)){e=e.substring(n.raw.length);i.push(n);continue}if(n=this.tokenizer.codespan(e)){e=e.substring(n.raw.length);i.push(n);continue}if(n=this.tokenizer.br(e)){e=e.substring(n.raw.length);i.push(n);continue}if(n=this.tokenizer.del(e)){e=e.substring(n.raw.length);i.push(n);continue}if(n=this.tokenizer.autolink(e)){e=e.substring(n.raw.length);i.push(n);continue}if(!this.state.inLink&&(n=this.tokenizer.url(e))){e=e.substring(n.raw.length);i.push(n);continue}r=e;if(this.options.extensions&&this.options.extensions.startInline){let u=Infinity;const d=e.slice(1);let p;this.options.extensions.startInline.forEach(f=>{p=f.call({lexer:this},d);if(typeof p==="number"&&p>=0){u=Math.min(u,p)}});if(u<Infinity&&u>=0){r=e.substring(0,u+1)}}if(n=this.tokenizer.inlineText(r)){e=e.substring(n.raw.length);if(n.raw.slice(-1)!=="_"){c=n.raw.slice(-1)}l=true;s=i[i.length-1];if(s&&s.type==="text"){s.raw+=n.raw;s.text+=n.text}else{i.push(n)}continue}if(e){const u="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(u);break}else{throw new Error(u)}}}return i}}class jf{options;parser;constructor(e){this.options=e||Na}space(e){return""}code({text:e,lang:i,escaped:n}){const s=(i||"").match(/^\S*/)?.[0];const r=e.replace(/\n$/,"")+"\n";if(!s){return"<pre><code>"+(n?r:bn(r,true))+"</code></pre>\n"}return'<pre><code class="language-'+bn(s)+'">'+(n?r:bn(r,true))+"</code></pre>\n"}blockquote({tokens:e}){const i=this.parser.parse(e);return`<blockquote>
${i}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:i}){return`<h${i}>${this.parser.parseInline(e)}</h${i}>
`}hr(e){return"<hr>\n"}list(e){const i=e.ordered;const n=e.start;let s="";for(let a=0;a<e.items.length;a++){const l=e.items[a];s+=this.listitem(l)}const r=i?"ol":"ul";const o=i&&n!==1?' start="'+n+'"':"";return"<"+r+o+">\n"+s+"</"+r+">\n"}listitem(e){let i="";if(e.task){const n=this.checkbox({checked:!!e.checked});if(e.loose){if(e.tokens.length>0&&e.tokens[0].type==="paragraph"){e.tokens[0].text=n+" "+e.tokens[0].text;if(e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"){e.tokens[0].tokens[0].text=n+" "+e.tokens[0].tokens[0].text}}else{e.tokens.unshift({type:"text",raw:n+" ",text:n+" "})}}else{i+=n+" "}}i+=this.parser.parse(e.tokens,!!e.loose);return`<li>${i}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let i="";let n="";for(let r=0;r<e.header.length;r++){n+=this.tablecell(e.header[r])}i+=this.tablerow({text:n});let s="";for(let r=0;r<e.rows.length;r++){const o=e.rows[r];n="";for(let a=0;a<o.length;a++){n+=this.tablecell(o[a])}s+=this.tablerow({text:n})}if(s)s=`<tbody>${s}</tbody>`;return"<table>\n<thead>\n"+i+"</thead>\n"+s+"</table>\n"}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const i=this.parser.parseInline(e.tokens);const n=e.header?"th":"td";const s=e.align?`<${n} align="${e.align}">`:`<${n}>`;return s+i+`</${n}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${e}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:i,tokens:n}){const s=this.parser.parseInline(n);const r=Hx(e);if(r===null){return s}e=r;let o='<a href="'+e+'"';if(i){o+=' title="'+i+'"'}o+=">"+s+"</a>";return o}image({href:e,title:i,text:n}){const s=Hx(e);if(s===null){return n}e=s;let r=`<img src="${e}" alt="${n}"`;if(i){r+=` title="${i}"`}r+=">";return r}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):e.text}}class U0{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}}class Ss{options;renderer;textRenderer;constructor(e){this.options=e||Na;this.options.renderer=this.options.renderer||new jf;this.renderer=this.options.renderer;this.renderer.options=this.options;this.renderer.parser=this;this.textRenderer=new U0}static parse(e,i){const n=new Ss(i);return n.parse(e)}static parseInline(e,i){const n=new Ss(i);return n.parseInline(e)}parse(e,i=true){let n="";for(let s=0;s<e.length;s++){const r=e[s];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[r.type]){const a=r;const l=this.options.extensions.renderers[a.type].call({parser:this},a);if(l!==false||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(a.type)){n+=l||"";continue}}const o=r;switch(o.type){case"space":{n+=this.renderer.space(o);continue}case"hr":{n+=this.renderer.hr(o);continue}case"heading":{n+=this.renderer.heading(o);continue}case"code":{n+=this.renderer.code(o);continue}case"table":{n+=this.renderer.table(o);continue}case"blockquote":{n+=this.renderer.blockquote(o);continue}case"list":{n+=this.renderer.list(o);continue}case"html":{n+=this.renderer.html(o);continue}case"paragraph":{n+=this.renderer.paragraph(o);continue}case"text":{let a=o;let l=this.renderer.text(a);while(s+1<e.length&&e[s+1].type==="text"){a=e[++s];l+="\n"+this.renderer.text(a)}if(i){n+=this.renderer.paragraph({type:"paragraph",raw:l,text:l,tokens:[{type:"text",raw:l,text:l}]})}else{n+=l}continue}default:{const a='Token with "'+o.type+'" type was not found.';if(this.options.silent){console.error(a);return""}else{throw new Error(a)}}}}return n}parseInline(e,i){i=i||this.renderer;let n="";for(let s=0;s<e.length;s++){const r=e[s];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[r.type]){const a=this.options.extensions.renderers[r.type].call({parser:this},r);if(a!==false||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(r.type)){n+=a||"";continue}}const o=r;switch(o.type){case"escape":{n+=i.text(o);break}case"html":{n+=i.html(o);break}case"link":{n+=i.link(o);break}case"image":{n+=i.image(o);break}case"strong":{n+=i.strong(o);break}case"em":{n+=i.em(o);break}case"codespan":{n+=i.codespan(o);break}case"br":{n+=i.br(o);break}case"del":{n+=i.del(o);break}case"text":{n+=i.text(o);break}default:{const a='Token with "'+o.type+'" type was not found.';if(this.options.silent){console.error(a);return""}else{throw new Error(a)}}}}return n}}class ef{options;constructor(e){this.options=e||Na}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}}class rA{defaults=R0();options=this.setOptions;parse=this.parseMarkdown(Es.lex,Ss.parse);parseInline=this.parseMarkdown(Es.lexInline,Ss.parseInline);Parser=Ss;Renderer=jf;TextRenderer=U0;Lexer=Es;Tokenizer=zf;Hooks=ef;constructor(...e){this.use(...e)}walkTokens(e,i){let n=[];for(const s of e){n=n.concat(i.call(this,s));switch(s.type){case"table":{const r=s;for(const o of r.header){n=n.concat(this.walkTokens(o.tokens,i))}for(const o of r.rows){for(const a of o){n=n.concat(this.walkTokens(a.tokens,i))}}break}case"list":{const r=s;n=n.concat(this.walkTokens(r.items,i));break}default:{const r=s;if(this.defaults.extensions?.childTokens?.[r.type]){this.defaults.extensions.childTokens[r.type].forEach(o=>{const a=r[o].flat(Infinity);n=n.concat(this.walkTokens(a,i))})}else if(r.tokens){n=n.concat(this.walkTokens(r.tokens,i))}}}}return n}use(...e){const i=this.defaults.extensions||{renderers:{},childTokens:{}};e.forEach(n=>{const s={...n};s.async=this.defaults.async||s.async||false;if(n.extensions){n.extensions.forEach(r=>{if(!r.name){throw new Error("extension name required")}if("renderer"in r){const o=i.renderers[r.name];if(o){i.renderers[r.name]=function(...a){let l=r.renderer.apply(this,a);if(l===false){l=o.apply(this,a)}return l}}else{i.renderers[r.name]=r.renderer}}if("tokenizer"in r){if(!r.level||r.level!=="block"&&r.level!=="inline"){throw new Error("extension level must be 'block' or 'inline'")}const o=i[r.level];if(o){o.unshift(r.tokenizer)}else{i[r.level]=[r.tokenizer]}if(r.start){if(r.level==="block"){if(i.startBlock){i.startBlock.push(r.start)}else{i.startBlock=[r.start]}}else if(r.level==="inline"){if(i.startInline){i.startInline.push(r.start)}else{i.startInline=[r.start]}}}}if("childTokens"in r&&r.childTokens){i.childTokens[r.name]=r.childTokens}});s.extensions=i}if(n.renderer){const r=this.defaults.renderer||new jf(this.defaults);for(const o in n.renderer){if(!(o in r)){throw new Error(`renderer '${o}' does not exist`)}if(["options","parser"].includes(o)){continue}const a=o;const l=n.renderer[a];const c=r[a];r[a]=(...u)=>{let d=l.apply(r,u);if(d===false){d=c.apply(r,u)}return d||""}}s.renderer=r}if(n.tokenizer){const r=this.defaults.tokenizer||new zf(this.defaults);for(const o in n.tokenizer){if(!(o in r)){throw new Error(`tokenizer '${o}' does not exist`)}if(["options","rules","lexer"].includes(o)){continue}const a=o;const l=n.tokenizer[a];const c=r[a];r[a]=(...u)=>{let d=l.apply(r,u);if(d===false){d=c.apply(r,u)}return d}}s.tokenizer=r}if(n.hooks){const r=this.defaults.hooks||new ef;for(const o in n.hooks){if(!(o in r)){throw new Error(`hook '${o}' does not exist`)}if(o==="options"){continue}const a=o;const l=n.hooks[a];const c=r[a];if(ef.passThroughHooks.has(o)){r[a]=u=>{if(this.defaults.async){return Promise.resolve(l.call(r,u)).then(p=>{return c.call(r,p)})}const d=l.call(r,u);return c.call(r,d)}}else{r[a]=(...u)=>{let d=l.apply(r,u);if(d===false){d=c.apply(r,u)}return d}}}s.hooks=r}if(n.walkTokens){const r=this.defaults.walkTokens;const o=n.walkTokens;s.walkTokens=function(a){let l=[];l.push(o.call(this,a));if(r){l=l.concat(r.call(this,a))}return l}}this.defaults={...this.defaults,...s}});return this}setOptions(e){this.defaults={...this.defaults,...e};return this}lexer(e,i){return Es.lex(e,i??this.defaults)}parser(e,i){return Ss.parse(e,i??this.defaults)}parseMarkdown(e,i){const n=(s,r)=>{const o={...r};const a={...this.defaults,...o};const l=this.onError(!!a.silent,!!a.async);if(this.defaults.async===true&&o.async===false){return l(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."))}if(typeof s==="undefined"||s===null){return l(new Error("marked(): input parameter is undefined or null"))}if(typeof s!=="string"){return l(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(s)+", string expected"))}if(a.hooks){a.hooks.options=a}if(a.async){return Promise.resolve(a.hooks?a.hooks.preprocess(s):s).then(c=>e(c,a)).then(c=>a.hooks?a.hooks.processAllTokens(c):c).then(c=>a.walkTokens?Promise.all(this.walkTokens(c,a.walkTokens)).then(()=>c):c).then(c=>i(c,a)).then(c=>a.hooks?a.hooks.postprocess(c):c).catch(l)}try{if(a.hooks){s=a.hooks.preprocess(s)}let c=e(s,a);if(a.hooks){c=a.hooks.processAllTokens(c)}if(a.walkTokens){this.walkTokens(c,a.walkTokens)}let u=i(c,a);if(a.hooks){u=a.hooks.postprocess(u)}return u}catch(c){return l(c)}};return n}onError(e,i){return n=>{n.message+="\nPlease report this to https://github.com/markedjs/marked.";if(e){const s="<p>An error occurred:</p><pre>"+bn(n.message+"",true)+"</pre>";if(i){return Promise.resolve(s)}return s}if(i){return Promise.reject(n)}throw n}}}const Sa=new rA;function yt(t,e){return Sa.parse(t,e)}yt.options=yt.setOptions=function(t){Sa.setOptions(t);yt.defaults=Sa.defaults;$I(yt.defaults);return yt};yt.getDefaults=R0;yt.defaults=Na;yt.use=function(...t){Sa.use(...t);yt.defaults=Sa.defaults;$I(yt.defaults);return yt};yt.walkTokens=function(t,e){return Sa.walkTokens(t,e)};yt.parseInline=Sa.parseInline;yt.Parser=Ss;yt.parser=Ss.parse;yt.Renderer=jf;yt.TextRenderer=U0;yt.Lexer=Es;yt.lexer=Es.lex;yt.Tokenizer=zf;yt.Hooks=ef;yt.parse=yt;yt.options;yt.setOptions;yt.use;yt.walkTokens;yt.parseInline;Ss.parse;Es.lex;function oA(t){return JSON.stringify(t,aA)}function QI(t){let e=JSON.parse(t);e=ti(e);return e}function aA(t,e){if(e instanceof RegExp){return{$mid:it.Regexp,source:e.source,flags:e.flags}}return e}function ti(t,e=0){if(!t||e>200){return t}if(typeof t==="object"){switch(t.$mid){case it.Uri:return b.revive(t);case it.Regexp:return new RegExp(t.source,t.flags);case it.Date:return new Date(t.source)}if(t instanceof ue||t instanceof Uint8Array){return t}if(Array.isArray(t)){for(let i=0;i<t.length;++i){t[i]=ti(t[i],e+1)}}else{for(const i in t){if(Object.hasOwnProperty.call(t,i)){t[i]=ti(t[i],e+1)}}}}return t}const vr=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list",html:"text/html"});const lA=/^(.+)\/(.+?)(;.+)?$/;function JI(t,e){const i=lA.exec(t);if(!i){return e?void 0:t}return`${i[1].toLowerCase()}/${i[2].toLowerCase()}${i[3]??""}`}const Fi=Symbol("unset");class cA{constructor(){this.root=new y1;this._size=0}get size(){return this._size}get nodes(){return this.root.children?.values()||_i.empty()}get entries(){return this.root.children?.entries()||_i.empty()}insert(e,i,n){this.opNode(e,s=>s._value=i,n)}mutate(e,i){this.opNode(e,n=>n._value=i(n._value===Fi?void 0:n._value))}mutatePath(e,i){this.opNode(e,()=>{},n=>i(n))}delete(e){const i=this.getPathToKey(e);if(!i){return}let n=i.length-1;const s=i[n].node._value;if(s===Fi){return}this._size--;i[n].node._value=Fi;for(;n>0;n--){const{node:r,part:o}=i[n];if(r.children?.size||r._value!==Fi){break}i[n-1].node.children.delete(o)}return s}*deleteRecursive(e){const i=this.getPathToKey(e);if(!i){return}const n=i[i.length-1].node;for(let s=i.length-1;s>0;s--){const r=i[s-1];r.node.children.delete(i[s].part);if(r.node.children.size>0||r.node._value!==Fi){break}}for(const s of zx(n)){if(s._value!==Fi){this._size--;yield s._value}}if(n===this.root){this.root._value=Fi;this.root.children=void 0}}find(e){let i=this.root;for(const n of e){const s=i.children?.get(n);if(!s){return void 0}i=s}return i._value===Fi?void 0:i._value}hasKeyOrParent(e){let i=this.root;for(const n of e){const s=i.children?.get(n);if(!s){return false}if(s._value!==Fi){return true}i=s}return false}hasKeyOrChildren(e){let i=this.root;for(const n of e){const s=i.children?.get(n);if(!s){return false}i=s}return true}hasKey(e){let i=this.root;for(const n of e){const s=i.children?.get(n);if(!s){return false}i=s}return i._value!==Fi}getPathToKey(e){const i=[{part:"",node:this.root}];let n=0;for(const s of e){const r=i[n].node.children?.get(s);if(!r){return}i.push({part:s,node:r});n++}return i}opNode(e,i,n){let s=this.root;for(const a of e){if(!s.children){const l=new y1;s.children=new Map([[a,l]]);s=l}else if(!s.children.has(a)){const l=new y1;s.children.set(a,l);s=l}else{s=s.children.get(a)}n?.(s)}const r=s._value===Fi?0:1;i(s);const o=s._value===Fi?0:1;this._size+=o-r}*values(){for(const{_value:e}of zx(this.root)){if(e!==Fi){yield e}}}}function*zx(t){const e=[t];while(e.length>0){const i=e.pop();yield i;if(i.children){for(const n of i.children.values()){e.push(n)}}}}class y1{constructor(){this._value=Fi}get value(){return this._value===Fi?void 0:this._value}set value(e){this._value=e===void 0?Fi:e}}var oa;(function(t){t[t["Auto"]=1]="Auto";t[t["Hidden"]=2]="Hidden";t[t["Visible"]=3]="Visible"})(oa||(oa={}));const qx={bracketPairColorizationOptions:{enabled:true,independentColorPoolPerBracketType:false}};const XI="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function uA(t=""){let e="(-?\\d*\\.\\d\\w*)|([^";for(const i of XI){if(t.indexOf(i)>=0){continue}e+="\\"+i}e+="\\s]+)";return new RegExp(e,"g")}const dA=uA();function YI(t){let e=dA;if(t&&t instanceof RegExp){if(!t.global){let i="g";if(t.ignoreCase){i+="i"}if(t.multiline){i+="m"}if(t.unicode){i+="u"}e=new RegExp(t.source,i)}else{e=t}}e.lastIndex=0;return e}const ZI=new wo;ZI.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function e4(t,e,i,n,s){e=YI(e);if(!s){s=_i.first(ZI)}if(i.length>s.maxLen){let c=t-s.maxLen/2;if(c<0){c=0}else{n+=c}i=i.substring(c,t+s.maxLen/2);return e4(t,e,i,n,s)}const r=Date.now();const o=t-1-n;let a=-1;let l=null;for(let c=1;;c++){if(Date.now()-r>=s.timeBudget){break}const u=o-s.windowSize*c;e.lastIndex=Math.max(0,u);const d=hA(e,i,o,a);if(!d&&l){break}l=d;if(u<=0){break}a=u}if(l){const c={word:l[0],startColumn:n+1+l.index,endColumn:n+1+l.index+l[0].length};e.lastIndex=0;return c}return null}function hA(t,e,i,n){let s;while(s=t.exec(e)){const r=s.index||0;if(r<=i&&t.lastIndex>=i){return s}else if(n>0&&r>n){return null}}return null}var X;(function(t){t[t["LParen"]=0]="LParen";t[t["RParen"]=1]="RParen";t[t["Neg"]=2]="Neg";t[t["Eq"]=3]="Eq";t[t["NotEq"]=4]="NotEq";t[t["Lt"]=5]="Lt";t[t["LtEq"]=6]="LtEq";t[t["Gt"]=7]="Gt";t[t["GtEq"]=8]="GtEq";t[t["RegexOp"]=9]="RegexOp";t[t["RegexStr"]=10]="RegexStr";t[t["True"]=11]="True";t[t["False"]=12]="False";t[t["In"]=13]="In";t[t["Not"]=14]="Not";t[t["And"]=15]="And";t[t["Or"]=16]="Or";t[t["Str"]=17]="Str";t[t["QuotedStr"]=18]="QuotedStr";t[t["Error"]=19]="Error";t[t["EOF"]=20]="EOF"})(X||(X={}));function x1(...t){switch(t.length){case 1:return h(1737,"Did you mean {0}?",t[0]);case 2:return h(1738,"Did you mean {0} or {1}?",t[0],t[1]);case 3:return h(1739,"Did you mean {0}, {1} or {2}?",t[0],t[1],t[2]);default:return void 0}}const fA=h(1740,"Did you forget to open or close the quote?");const pA=h(1741,"Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'.");class Gr{constructor(){this._input="";this._start=0;this._current=0;this._tokens=[];this._errors=[];this.stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy}static getLexeme(e){switch(e.type){case X.LParen:return"(";case X.RParen:return")";case X.Neg:return"!";case X.Eq:return e.isTripleEq?"===":"==";case X.NotEq:return e.isTripleEq?"!==":"!=";case X.Lt:return"<";case X.LtEq:return"<=";case X.Gt:return">=";case X.GtEq:return">=";case X.RegexOp:return"=~";case X.RegexStr:return e.lexeme;case X.True:return"true";case X.False:return"false";case X.In:return"in";case X.Not:return"not";case X.And:return"&&";case X.Or:return"||";case X.Str:return e.lexeme;case X.QuotedStr:return e.lexeme;case X.Error:return e.lexeme;case X.EOF:return"EOF";default:throw d0(`unhandled token type: ${JSON.stringify(e)}; have you forgotten to add a case?`)}}static{this._regexFlags=new Set(["i","g","s","m","y","u"].map(e=>e.charCodeAt(0)))}static{this._keywords=new Map([["not",X.Not],["in",X.In],["false",X.False],["true",X.True]])}get errors(){return this._errors}reset(e){this._input=e;this._start=0;this._current=0;this._tokens=[];this._errors=[];return this}scan(){while(!this._isAtEnd()){this._start=this._current;const e=this._advance();switch(e){case A.OpenParen:this._addToken(X.LParen);break;case A.CloseParen:this._addToken(X.RParen);break;case A.ExclamationMark:if(this._match(A.Equals)){const i=this._match(A.Equals);this._tokens.push({type:X.NotEq,offset:this._start,isTripleEq:i})}else{this._addToken(X.Neg)}break;case A.SingleQuote:this._quotedString();break;case A.Slash:this._regex();break;case A.Equals:if(this._match(A.Equals)){const i=this._match(A.Equals);this._tokens.push({type:X.Eq,offset:this._start,isTripleEq:i})}else if(this._match(A.Tilde)){this._addToken(X.RegexOp)}else{this._error(x1("==","=~"))}break;case A.LessThan:this._addToken(this._match(A.Equals)?X.LtEq:X.Lt);break;case A.GreaterThan:this._addToken(this._match(A.Equals)?X.GtEq:X.Gt);break;case A.Ampersand:if(this._match(A.Ampersand)){this._addToken(X.And)}else{this._error(x1("&&"))}break;case A.Pipe:if(this._match(A.Pipe)){this._addToken(X.Or)}else{this._error(x1("||"))}break;case A.Space:case A.CarriageReturn:case A.Tab:case A.LineFeed:case A.NoBreakSpace:break;default:this._string()}}this._start=this._current;this._addToken(X.EOF);return Array.from(this._tokens)}_match(e){if(this._isAtEnd()){return false}if(this._input.charCodeAt(this._current)!==e){return false}this._current++;return true}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?A.Null:this._input.charCodeAt(this._current)}_addToken(e){this._tokens.push({type:e,offset:this._start})}_error(e){const i=this._start;const n=this._input.substring(this._start,this._current);const s={type:X.Error,offset:this._start,lexeme:n};this._errors.push({offset:i,lexeme:n,additionalInfo:e});this._tokens.push(s)}_string(){this.stringRe.lastIndex=this._start;const e=this.stringRe.exec(this._input);if(e){this._current=this._start+e[0].length;const i=this._input.substring(this._start,this._current);const n=Gr._keywords.get(i);if(n){this._addToken(n)}else{this._tokens.push({type:X.Str,lexeme:i,offset:this._start})}}}_quotedString(){while(this._peek()!==A.SingleQuote&&!this._isAtEnd()){this._advance()}if(this._isAtEnd()){this._error(fA);return}this._advance();this._tokens.push({type:X.QuotedStr,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let e=this._current;let i=false;let n=false;while(true){if(e>=this._input.length){this._current=e;this._error(pA);return}const r=this._input.charCodeAt(e);if(i){i=false}else if(r===A.Slash&&!n){e++;break}else if(r===A.OpenSquareBracket){n=true}else if(r===A.Backslash){i=true}else if(r===A.CloseSquareBracket){n=false}e++}while(e<this._input.length&&Gr._regexFlags.has(this._input.charCodeAt(e))){e++}this._current=e;const s=this._input.substring(this._start,this._current);this._tokens.push({type:X.RegexStr,lexeme:s,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}}const wi=new Map;wi.set("false",false);wi.set("true",true);wi.set("isMac",Dn);wi.set("isLinux",Er);wi.set("isWindows",Yi);wi.set("isWeb",oh);wi.set("isMacNative",Dn&&!oh);wi.set("isEdge",tI);wi.set("isFirefox",IT);wi.set("isChrome",y0);wi.set("isSafari",CT);const gA=Object.prototype.hasOwnProperty;var Nt;(function(t){t[t["False"]=0]="False";t[t["True"]=1]="True";t[t["Defined"]=2]="Defined";t[t["Not"]=3]="Not";t[t["Equals"]=4]="Equals";t[t["NotEquals"]=5]="NotEquals";t[t["And"]=6]="And";t[t["Regex"]=7]="Regex";t[t["NotRegex"]=8]="NotRegex";t[t["Or"]=9]="Or";t[t["In"]=10]="In";t[t["NotIn"]=11]="NotIn";t[t["Greater"]=12]="Greater";t[t["GreaterEquals"]=13]="GreaterEquals";t[t["Smaller"]=14]="Smaller";t[t["SmallerEquals"]=15]="SmallerEquals"})(Nt||(Nt={}));const mA={regexParsingWithErrorRecovery:true};const _A=h(1717,"Empty context key expression");const vA=h(1718,"Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively.");const wA=h(1719,"'in' after 'not'.");const jx=h(1720,"closing parenthesis ')'");const bA=h(1721,"Unexpected token");const yA=h(1722,"Did you forget to put && or || before the token?");const xA=h(1723,"Unexpected end of expression");const EA=h(1724,"Did you forget to put a context key?");class zo{static{this._parseError=new Error}get lexingErrors(){return this._scanner.errors}get parsingErrors(){return this._parsingErrors}constructor(e=mA){this._config=e;this._scanner=new Gr;this._tokens=[];this._current=0;this._parsingErrors=[];this._flagsGYRe=/g|y/g}parse(e){if(e===""){this._parsingErrors.push({message:_A,offset:0,lexeme:"",additionalInfo:vA});return void 0}this._tokens=this._scanner.reset(e).scan();this._current=0;this._parsingErrors=[];try{const i=this._expr();if(!this._isAtEnd()){const n=this._peek();const s=n.type===X.Str?yA:void 0;this._parsingErrors.push({message:bA,offset:n.offset,lexeme:Gr.getLexeme(n),additionalInfo:s});throw zo._parseError}return i}catch(i){if(!(i===zo._parseError)){throw i}return void 0}}_expr(){return this._or()}_or(){const e=[this._and()];while(this._matchOne(X.Or)){const i=this._and();e.push(i)}return e.length===1?e[0]:Kt.or(...e)}_and(){const e=[this._term()];while(this._matchOne(X.And)){const i=this._term();e.push(i)}return e.length===1?e[0]:Kt.and(...e)}_term(){if(this._matchOne(X.Neg)){const e=this._peek();switch(e.type){case X.True:this._advance();return Oi.INSTANCE;case X.False:this._advance();return Wi.INSTANCE;case X.LParen:{this._advance();const i=this._expr();this._consume(X.RParen,jx);return i?.negate()}case X.Str:this._advance();return Fa.create(e.lexeme);default:throw this._errExpectedButGot(`KEY | true | false | '(' expression ')'`,e)}}return this._primary()}_primary(){const e=this._peek();switch(e.type){case X.True:this._advance();return Kt.true();case X.False:this._advance();return Kt.false();case X.LParen:{this._advance();const i=this._expr();this._consume(X.RParen,jx);return i}case X.Str:{const i=e.lexeme;this._advance();if(this._matchOne(X.RegexOp)){const s=this._peek();if(!this._config.regexParsingWithErrorRecovery){this._advance();if(s.type!==X.RegexStr){throw this._errExpectedButGot(`REGEX`,s)}const r=s.lexeme;const o=r.lastIndexOf("/");const a=o===r.length-1?void 0:this._removeFlagsGY(r.substring(o+1));let l;try{l=new RegExp(r.substring(1,o),a)}catch(c){throw this._errExpectedButGot(`REGEX`,s)}return Xu.create(i,l)}switch(s.type){case X.RegexStr:case X.Error:{const r=[s.lexeme];this._advance();let o=this._peek();let a=0;for(let p=0;p<s.lexeme.length;p++){if(s.lexeme.charCodeAt(p)===A.OpenParen){a++}else if(s.lexeme.charCodeAt(p)===A.CloseParen){a--}}while(!this._isAtEnd()&&o.type!==X.And&&o.type!==X.Or){switch(o.type){case X.LParen:a++;break;case X.RParen:a--;break;case X.RegexStr:case X.QuotedStr:for(let p=0;p<o.lexeme.length;p++){if(o.lexeme.charCodeAt(p)===A.OpenParen){a++}else if(s.lexeme.charCodeAt(p)===A.CloseParen){a--}}}if(a<0){break}r.push(Gr.getLexeme(o));this._advance();o=this._peek()}const l=r.join("");const c=l.lastIndexOf("/");const u=c===l.length-1?void 0:this._removeFlagsGY(l.substring(c+1));let d;try{d=new RegExp(l.substring(1,c),u)}catch(p){throw this._errExpectedButGot(`REGEX`,s)}return Kt.regex(i,d)}case X.QuotedStr:{const r=s.lexeme;this._advance();let o=null;if(!Qu(r)){const a=r.indexOf("/");const l=r.lastIndexOf("/");if(a!==l&&a>=0){const c=r.slice(a+1,l);const u=r[l+1]==="i"?"i":"";try{o=new RegExp(c,u)}catch(d){throw this._errExpectedButGot(`REGEX`,s)}}}if(o===null){throw this._errExpectedButGot("REGEX",s)}return Xu.create(i,o)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(X.Not)){this._consume(X.In,wA);const s=this._value();return Kt.notIn(i,s)}const n=this._peek().type;switch(n){case X.Eq:{this._advance();const s=this._value();if(this._previous().type===X.QuotedStr){return Kt.equals(i,s)}switch(s){case"true":return Kt.has(i);case"false":return Kt.not(i);default:return Kt.equals(i,s)}}case X.NotEq:{this._advance();const s=this._value();if(this._previous().type===X.QuotedStr){return Kt.notEquals(i,s)}switch(s){case"true":return Kt.not(i);case"false":return Kt.has(i);default:return Kt.notEquals(i,s)}}case X.Lt:this._advance();return gh.create(i,this._value());case X.LtEq:this._advance();return mh.create(i,this._value());case X.Gt:this._advance();return Pc.create(i,this._value());case X.GtEq:this._advance();return ph.create(i,this._value());case X.In:this._advance();return Kt.in(i,this._value());default:return Kt.has(i)}}case X.EOF:this._parsingErrors.push({message:xA,offset:e.offset,lexeme:"",additionalInfo:EA});throw zo._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){const e=this._peek();switch(e.type){case X.Str:case X.QuotedStr:this._advance();return e.lexeme;case X.True:this._advance();return"true";case X.False:this._advance();return"false";case X.In:this._advance();return"in";default:return""}}_removeFlagsGY(e){return e.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(e){if(this._check(e)){this._advance();return true}return false}_advance(){if(!this._isAtEnd()){this._current++}return this._previous()}_consume(e,i){if(this._check(e)){return this._advance()}throw this._errExpectedButGot(i,this._peek())}_errExpectedButGot(e,i,n){const s=h(1725,"Expected: {0}\nReceived: '{1}'.",e,Gr.getLexeme(i));const r=i.offset;const o=Gr.getLexeme(i);this._parsingErrors.push({message:s,offset:r,lexeme:o,additionalInfo:n});return zo._parseError}_check(e){return this._peek().type===e}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===X.EOF}}class Kt{static false(){return Oi.INSTANCE}static true(){return Wi.INSTANCE}static has(e){return Oa.create(e)}static equals(e,i){return hh.create(e,i)}static notEquals(e,i){return fh.create(e,i)}static regex(e,i){return Xu.create(e,i)}static in(e,i){return Em.create(e,i)}static notIn(e,i){return Sm.create(e,i)}static not(e){return Fa.create(e)}static and(...e){return Kr.create(e,null,true)}static or(...e){return vs.create(e,null,true)}static greater(e,i){return Pc.create(e,i)}static greaterEquals(e,i){return ph.create(e,i)}static smaller(e,i){return gh.create(e,i)}static smallerEquals(e,i){return mh.create(e,i)}static{this._parser=new zo({regexParsingWithErrorRecovery:false})}static deserialize(e){if(e===void 0||e===null){return void 0}const i=this._parser.parse(e);return i}}function SA(t){const e=new zo({regexParsingWithErrorRecovery:false});return t.map(i=>{e.parse(i);if(e.lexingErrors.length>0){return e.lexingErrors.map(n=>({errorMessage:n.additionalInfo?h(1726,"Unexpected token. Hint: {0}",n.additionalInfo):h(1727,"Unexpected token."),offset:n.offset,length:n.lexeme.length}))}else if(e.parsingErrors.length>0){return e.parsingErrors.map(n=>({errorMessage:n.additionalInfo?`${n.message}. ${n.additionalInfo}`:n.message,offset:n.offset,length:n.lexeme.length}))}else{return[]}})}function _u(t,e){return t.cmp(e)}class Oi{static{this.INSTANCE=new Oi}constructor(){this.type=Nt.False}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return false}serialize(){return"false"}keys(){return[]}map(e){return this}negate(){return Wi.INSTANCE}}class Wi{static{this.INSTANCE=new Wi}constructor(){this.type=Nt.True}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return true}serialize(){return"true"}keys(){return[]}map(e){return this}negate(){return Oi.INSTANCE}}class Oa{static create(e,i=null){const n=wi.get(e);if(typeof n==="boolean"){return n?Wi.INSTANCE:Oi.INSTANCE}return new Oa(e,i)}constructor(e,i){this.key=e;this.negated=i;this.type=Nt.Defined}cmp(e){if(e.type!==this.type){return this.type-e.type}return i4(this.key,e.key)}equals(e){if(e.type===this.type){return this.key===e.key}return false}substituteConstants(){const e=wi.get(this.key);if(typeof e==="boolean"){return e?Wi.INSTANCE:Oi.INSTANCE}return this}evaluate(e){return!!e.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}map(e){return e.mapDefined(this.key)}negate(){if(!this.negated){this.negated=Fa.create(this.key,this)}return this.negated}}class hh{static create(e,i,n=null){if(typeof i==="boolean"){return i?Oa.create(e,n):Fa.create(e,n)}const s=wi.get(e);if(typeof s==="boolean"){const r=s?"true":"false";return i===r?Wi.INSTANCE:Oi.INSTANCE}return new hh(e,i,n)}constructor(e,i,n){this.key=e;this.value=i;this.negated=n;this.type=Nt.Equals}cmp(e){if(e.type!==this.type){return this.type-e.type}return Ma(this.key,this.value,e.key,e.value)}equals(e){if(e.type===this.type){return this.key===e.key&&this.value===e.value}return false}substituteConstants(){const e=wi.get(this.key);if(typeof e==="boolean"){const i=e?"true":"false";return this.value===i?Wi.INSTANCE:Oi.INSTANCE}return this}evaluate(e){return e.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}map(e){return e.mapEquals(this.key,this.value)}negate(){if(!this.negated){this.negated=fh.create(this.key,this.value,this)}return this.negated}}class Em{static create(e,i){return new Em(e,i)}constructor(e,i){this.key=e;this.valueKey=i;this.type=Nt.In;this.negated=null}cmp(e){if(e.type!==this.type){return this.type-e.type}return Ma(this.key,this.valueKey,e.key,e.valueKey)}equals(e){if(e.type===this.type){return this.key===e.key&&this.valueKey===e.valueKey}return false}substituteConstants(){return this}evaluate(e){const i=e.getValue(this.valueKey);const n=e.getValue(this.key);if(Array.isArray(i)){return i.includes(n)}if(typeof n==="string"&&typeof i==="object"&&i!==null){return gA.call(i,n)}return false}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}map(e){return e.mapIn(this.key,this.valueKey)}negate(){if(!this.negated){this.negated=Sm.create(this.key,this.valueKey)}return this.negated}}class Sm{static create(e,i){return new Sm(e,i)}constructor(e,i){this.key=e;this.valueKey=i;this.type=Nt.NotIn;this._negated=Em.create(e,i)}cmp(e){if(e.type!==this.type){return this.type-e.type}return this._negated.cmp(e._negated)}equals(e){if(e.type===this.type){return this._negated.equals(e._negated)}return false}substituteConstants(){return this}evaluate(e){return!this._negated.evaluate(e)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}map(e){return e.mapNotIn(this.key,this.valueKey)}negate(){return this._negated}}class fh{static create(e,i,n=null){if(typeof i==="boolean"){if(i){return Fa.create(e,n)}return Oa.create(e,n)}const s=wi.get(e);if(typeof s==="boolean"){const r=s?"true":"false";return i===r?Oi.INSTANCE:Wi.INSTANCE}return new fh(e,i,n)}constructor(e,i,n){this.key=e;this.value=i;this.negated=n;this.type=Nt.NotEquals}cmp(e){if(e.type!==this.type){return this.type-e.type}return Ma(this.key,this.value,e.key,e.value)}equals(e){if(e.type===this.type){return this.key===e.key&&this.value===e.value}return false}substituteConstants(){const e=wi.get(this.key);if(typeof e==="boolean"){const i=e?"true":"false";return this.value===i?Oi.INSTANCE:Wi.INSTANCE}return this}evaluate(e){return e.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}map(e){return e.mapNotEquals(this.key,this.value)}negate(){if(!this.negated){this.negated=hh.create(this.key,this.value,this)}return this.negated}}class Fa{static create(e,i=null){const n=wi.get(e);if(typeof n==="boolean"){return n?Oi.INSTANCE:Wi.INSTANCE}return new Fa(e,i)}constructor(e,i){this.key=e;this.negated=i;this.type=Nt.Not}cmp(e){if(e.type!==this.type){return this.type-e.type}return i4(this.key,e.key)}equals(e){if(e.type===this.type){return this.key===e.key}return false}substituteConstants(){const e=wi.get(this.key);if(typeof e==="boolean"){return e?Oi.INSTANCE:Wi.INSTANCE}return this}evaluate(e){return!e.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}map(e){return e.mapNot(this.key)}negate(){if(!this.negated){this.negated=Oa.create(this.key,this)}return this.negated}}function Dm(t,e){if(typeof t==="string"){const i=parseFloat(t);if(!isNaN(i)){t=i}}if(typeof t==="string"||typeof t==="number"){return e(t)}return Oi.INSTANCE}class Pc{static create(e,i,n=null){return Dm(i,s=>new Pc(e,s,n))}constructor(e,i,n){this.key=e;this.value=i;this.negated=n;this.type=Nt.Greater}cmp(e){if(e.type!==this.type){return this.type-e.type}return Ma(this.key,this.value,e.key,e.value)}equals(e){if(e.type===this.type){return this.key===e.key&&this.value===e.value}return false}substituteConstants(){return this}evaluate(e){if(typeof this.value==="string"){return false}return parseFloat(e.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreater(this.key,this.value)}negate(){if(!this.negated){this.negated=mh.create(this.key,this.value,this)}return this.negated}}class ph{static create(e,i,n=null){return Dm(i,s=>new ph(e,s,n))}constructor(e,i,n){this.key=e;this.value=i;this.negated=n;this.type=Nt.GreaterEquals}cmp(e){if(e.type!==this.type){return this.type-e.type}return Ma(this.key,this.value,e.key,e.value)}equals(e){if(e.type===this.type){return this.key===e.key&&this.value===e.value}return false}substituteConstants(){return this}evaluate(e){if(typeof this.value==="string"){return false}return parseFloat(e.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}map(e){return e.mapGreaterEquals(this.key,this.value)}negate(){if(!this.negated){this.negated=gh.create(this.key,this.value,this)}return this.negated}}class gh{static create(e,i,n=null){return Dm(i,s=>new gh(e,s,n))}constructor(e,i,n){this.key=e;this.value=i;this.negated=n;this.type=Nt.Smaller}cmp(e){if(e.type!==this.type){return this.type-e.type}return Ma(this.key,this.value,e.key,e.value)}equals(e){if(e.type===this.type){return this.key===e.key&&this.value===e.value}return false}substituteConstants(){return this}evaluate(e){if(typeof this.value==="string"){return false}return parseFloat(e.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmaller(this.key,this.value)}negate(){if(!this.negated){this.negated=ph.create(this.key,this.value,this)}return this.negated}}class mh{static create(e,i,n=null){return Dm(i,s=>new mh(e,s,n))}constructor(e,i,n){this.key=e;this.value=i;this.negated=n;this.type=Nt.SmallerEquals}cmp(e){if(e.type!==this.type){return this.type-e.type}return Ma(this.key,this.value,e.key,e.value)}equals(e){if(e.type===this.type){return this.key===e.key&&this.value===e.value}return false}substituteConstants(){return this}evaluate(e){if(typeof this.value==="string"){return false}return parseFloat(e.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}map(e){return e.mapSmallerEquals(this.key,this.value)}negate(){if(!this.negated){this.negated=Pc.create(this.key,this.value,this)}return this.negated}}class Xu{static create(e,i){return new Xu(e,i)}constructor(e,i){this.key=e;this.regexp=i;this.type=Nt.Regex;this.negated=null}cmp(e){if(e.type!==this.type){return this.type-e.type}if(this.key<e.key){return-1}if(this.key>e.key){return 1}const i=this.regexp?this.regexp.source:"";const n=e.regexp?e.regexp.source:"";if(i<n){return-1}if(i>n){return 1}return 0}equals(e){if(e.type===this.type){const i=this.regexp?this.regexp.source:"";const n=e.regexp?e.regexp.source:"";return this.key===e.key&&i===n}return false}substituteConstants(){return this}evaluate(e){const i=e.getValue(this.key);return this.regexp?this.regexp.test(i):false}serialize(){const e=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${e}`}keys(){return[this.key]}map(e){return e.mapRegex(this.key,this.regexp)}negate(){if(!this.negated){this.negated=Gf.create(this)}return this.negated}}class Gf{static create(e){return new Gf(e)}constructor(e){this._actual=e;this.type=Nt.NotRegex}cmp(e){if(e.type!==this.type){return this.type-e.type}return this._actual.cmp(e._actual)}equals(e){if(e.type===this.type){return this._actual.equals(e._actual)}return false}substituteConstants(){return this}evaluate(e){return!this._actual.evaluate(e)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}map(e){return new Gf(this._actual.map(e))}negate(){return this._actual}}function t4(t){let e=null;for(let i=0,n=t.length;i<n;i++){const s=t[i].substituteConstants();if(t[i]!==s){if(e===null){e=[];for(let r=0;r<i;r++){e[r]=t[r]}}}if(e!==null){e[i]=s}}if(e===null){return t}return e}class Kr{static create(e,i,n){return Kr._normalizeArr(e,i,n)}constructor(e,i){this.expr=e;this.negated=i;this.type=Nt.And}cmp(e){if(e.type!==this.type){return this.type-e.type}if(this.expr.length<e.expr.length){return-1}if(this.expr.length>e.expr.length){return 1}for(let i=0,n=this.expr.length;i<n;i++){const s=_u(this.expr[i],e.expr[i]);if(s!==0){return s}}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length){return false}for(let i=0,n=this.expr.length;i<n;i++){if(!this.expr[i].equals(e.expr[i])){return false}}return true}return false}substituteConstants(){const e=t4(this.expr);if(e===this.expr){return this}return Kr.create(e,this.negated,false)}evaluate(e){for(let i=0,n=this.expr.length;i<n;i++){if(!this.expr[i].evaluate(e)){return false}}return true}static _normalizeArr(e,i,n){const s=[];let r=false;for(const o of e){if(!o){continue}if(o.type===Nt.True){r=true;continue}if(o.type===Nt.False){return Oi.INSTANCE}if(o.type===Nt.And){s.push(...o.expr);continue}s.push(o)}if(s.length===0&&r){return Wi.INSTANCE}if(s.length===0){return void 0}if(s.length===1){return s[0]}s.sort(_u);for(let o=1;o<s.length;o++){if(s[o-1].equals(s[o])){s.splice(o,1);o--}}if(s.length===1){return s[0]}while(s.length>1){const o=s[s.length-1];if(o.type!==Nt.Or){break}s.pop();const a=s.pop();const l=s.length===0;const c=vs.create(o.expr.map(u=>Kr.create([u,a],null,n)),null,l);if(c){s.push(c);s.sort(_u)}}if(s.length===1){return s[0]}if(n){for(let o=0;o<s.length;o++){for(let a=o+1;a<s.length;a++){if(s[o].negate().equals(s[a])){return Oi.INSTANCE}}}if(s.length===1){return s[0]}}return new Kr(s,i)}serialize(){return this.expr.map(e=>e.serialize()).join(" && ")}keys(){const e=[];for(const i of this.expr){e.push(...i.keys())}return e}map(e){return new Kr(this.expr.map(i=>i.map(e)),null)}negate(){if(!this.negated){const e=[];for(const i of this.expr){e.push(i.negate())}this.negated=vs.create(e,this,true)}return this.negated}}class vs{static create(e,i,n){return vs._normalizeArr(e,i,n)}constructor(e,i){this.expr=e;this.negated=i;this.type=Nt.Or}cmp(e){if(e.type!==this.type){return this.type-e.type}if(this.expr.length<e.expr.length){return-1}if(this.expr.length>e.expr.length){return 1}for(let i=0,n=this.expr.length;i<n;i++){const s=_u(this.expr[i],e.expr[i]);if(s!==0){return s}}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length){return false}for(let i=0,n=this.expr.length;i<n;i++){if(!this.expr[i].equals(e.expr[i])){return false}}return true}return false}substituteConstants(){const e=t4(this.expr);if(e===this.expr){return this}return vs.create(e,this.negated,false)}evaluate(e){for(let i=0,n=this.expr.length;i<n;i++){if(this.expr[i].evaluate(e)){return true}}return false}static _normalizeArr(e,i,n){let s=[];let r=false;if(e){for(let o=0,a=e.length;o<a;o++){const l=e[o];if(!l){continue}if(l.type===Nt.False){r=true;continue}if(l.type===Nt.True){return Wi.INSTANCE}if(l.type===Nt.Or){s=s.concat(l.expr);continue}s.push(l)}if(s.length===0&&r){return Oi.INSTANCE}s.sort(_u)}if(s.length===0){return void 0}if(s.length===1){return s[0]}for(let o=1;o<s.length;o++){if(s[o-1].equals(s[o])){s.splice(o,1);o--}}if(s.length===1){return s[0]}if(n){for(let o=0;o<s.length;o++){for(let a=o+1;a<s.length;a++){if(s[o].negate().equals(s[a])){return Wi.INSTANCE}}}if(s.length===1){return s[0]}}return new vs(s,i)}serialize(){return this.expr.map(e=>e.serialize()).join(" || ")}keys(){const e=[];for(const i of this.expr){e.push(...i.keys())}return e}map(e){return new vs(this.expr.map(i=>i.map(e)),null)}negate(){if(!this.negated){const e=[];for(const i of this.expr){e.push(i.negate())}while(e.length>1){const i=e.shift();const n=e.shift();const s=[];for(const r of Gx(i)){for(const o of Gx(n)){s.push(Kr.create([r,o],null,false))}}e.unshift(vs.create(s,null,false))}this.negated=vs.create(e,this,true)}return this.negated}}class T extends Oa{static{this._info=[]}static all(){return T._info.values()}constructor(e,i,n){super(e,null);this._defaultValue=i;if(typeof n==="object"){T._info.push({...n,key:e})}else if(n!==true){T._info.push({key:e,description:n,type:i!==null&&i!==void 0?typeof i:void 0})}}bindTo(e){return e.createKey(this.key,this._defaultValue)}getValue(e){return e.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(e){return hh.create(this.key,e)}notEqualsTo(e){return fh.create(this.key,e)}greater(e){return Pc.create(this.key,e)}}function i4(t,e){if(t<e){return-1}if(t>e){return 1}return 0}function Ma(t,e,i,n){if(t<i){return-1}if(t>i){return 1}if(e<n){return-1}if(e>n){return 1}return 0}function Gx(t){if(t.type===Nt.Or){return t.expr}return[t]}var cr;(function(t){t[t["Unknown"]=0]="Unknown";t[t["Disabled"]=1]="Disabled";t[t["Enabled"]=2]="Enabled"})(cr||(cr={}));new T("accessibilityModeEnabled",false);var DA={quality:"stable",...globalThis._VSCODE_PRODUCT_JSON??{}};var Qr;(function(t){t[t["None"]=0]="None";t[t["Keep"]=1]="Keep";t[t["Brackets"]=2]="Brackets";t[t["Advanced"]=3]="Advanced";t[t["Full"]=4]="Full"})(Qr||(Qr={}));const kA=8;class IA{constructor(){this.stableMinimapLayoutInput=null;this.stableFitMaxMinimapScale=0;this.stableFitRemainingWidth=0}}class ht{constructor(e,i,n,s){this.id=e;this.name=i;this.defaultValue=n;this.schema=s}applyUpdate(e,i){return km(e,i)}compute(e,i,n){return n}}class tf{constructor(e,i){this.newValue=e;this.didChange=i}}function km(t,e){if(typeof t!=="object"||typeof e!=="object"||!t||!e){return new tf(e,t!==e)}if(Array.isArray(t)||Array.isArray(e)){const n=Array.isArray(t)&&Array.isArray(e)&&Is(t,e);return new tf(e,!n)}let i=false;for(const n in e){if(e.hasOwnProperty(n)){const s=km(t[n],e[n]);if(s.didChange){t[n]=s.newValue;i=true}}}return new tf(t,i)}class Ua{constructor(e){this.schema=void 0;this.id=e;this.name="_never_";this.defaultValue=void 0}applyUpdate(e,i){return km(e,i)}validate(e){return this.defaultValue}}class Ac{constructor(e,i,n,s){this.id=e;this.name=i;this.defaultValue=n;this.schema=s}applyUpdate(e,i){return km(e,i)}validate(e){if(typeof e==="undefined"){return this.defaultValue}return e}compute(e,i,n){return n}}function ee(t,e){if(typeof t==="undefined"){return e}if(t==="false"){return false}return Boolean(t)}class Ae extends Ac{constructor(e,i,n,s=void 0){if(typeof s!=="undefined"){s.type="boolean";s.default=n}super(e,i,n,s)}validate(e){return ee(e,this.defaultValue)}}function CA(t,e,i,n){if(typeof t==="undefined"){return e}let s=parseInt(t,10);if(isNaN(s)){return e}s=Math.max(i,s);s=Math.min(n,s);return s|0}class Qe extends Ac{static clampedInt(e,i,n,s){return CA(e,i,n,s)}constructor(e,i,n,s,r,o=void 0){if(typeof o!=="undefined"){o.type="integer";o.default=n;o.minimum=s;o.maximum=r}super(e,i,n,o);this.minimum=s;this.maximum=r}validate(e){return Qe.clampedInt(e,this.defaultValue,this.minimum,this.maximum)}}class Nn extends Ac{static clamp(e,i,n){if(e<i){return i}if(e>n){return n}return e}static float(e,i){if(typeof e==="number"){return e}if(typeof e==="undefined"){return i}const n=parseFloat(e);return isNaN(n)?i:n}constructor(e,i,n,s,r){if(typeof r!=="undefined"){r.type="number";r.default=n}super(e,i,n,r);this.validationFn=s}validate(e){return this.validationFn(Nn.float(e,this.defaultValue))}}class Ni extends Ac{static string(e,i){if(typeof e!=="string"){return i}return e}constructor(e,i,n,s=void 0){if(typeof s!=="undefined"){s.type="string";s.default=n}super(e,i,n,s)}validate(e){return Ni.string(e,this.defaultValue)}}function mt(t,e,i,n){if(typeof t!=="string"){return e}if(i.indexOf(t)===-1){return e}return t}class ft extends Ac{constructor(e,i,n,s,r=void 0){if(typeof r!=="undefined"){r.type="string";r.enum=s;r.default=n}super(e,i,n,r);this._allowedValues=s}validate(e){return mt(e,this.defaultValue,this._allowedValues)}}class qc extends ht{constructor(e,i,n,s,r,o,a=void 0){if(typeof a!=="undefined"){a.type="string";a.enum=r;a.default=s}super(e,i,n,a);this._allowedValues=r;this._convert=o}validate(e){if(typeof e!=="string"){return this.defaultValue}if(this._allowedValues.indexOf(e)===-1){return this.defaultValue}return this._convert(e)}}function TA(t){switch(t){case"none":return Qr.None;case"keep":return Qr.Keep;case"brackets":return Qr.Brackets;case"advanced":return Qr.Advanced;case"full":return Qr.Full}}class PA extends ht{constructor(){super(N.accessibilitySupport,"accessibilitySupport",cr.Unknown,{type:"string",enum:["auto","on","off"],enumDescriptions:[h(262,"Use platform APIs to detect when a Screen Reader is attached."),h(263,"Optimize for usage with a Screen Reader."),h(264,"Assume a screen reader is not attached.")],default:"auto",tags:["accessibility"],description:h(265,"Controls if the UI should run in a mode where it is optimized for screen readers.")})}validate(e){switch(e){case"auto":return cr.Unknown;case"off":return cr.Disabled;case"on":return cr.Enabled}return this.defaultValue}compute(e,i,n){if(n===cr.Unknown){return e.accessibilitySupport}return n}}class AA extends ht{constructor(){const e={insertSpace:true,ignoreEmptyLines:true};super(N.comments,"comments",e,{"editor.comments.insertSpace":{type:"boolean",default:e.insertSpace,description:h(266,"Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:e.ignoreEmptyLines,description:h(267,"Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;return{insertSpace:ee(i.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:ee(i.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}}var Jr;(function(t){t[t["Hidden"]=0]="Hidden";t[t["Blink"]=1]="Blink";t[t["Smooth"]=2]="Smooth";t[t["Phase"]=3]="Phase";t[t["Expand"]=4]="Expand";t[t["Solid"]=5]="Solid"})(Jr||(Jr={}));function RA(t){switch(t){case"blink":return Jr.Blink;case"smooth":return Jr.Smooth;case"phase":return Jr.Phase;case"expand":return Jr.Expand;case"solid":return Jr.Solid}}var ts;(function(t){t[t["Line"]=1]="Line";t[t["Block"]=2]="Block";t[t["Underline"]=3]="Underline";t[t["LineThin"]=4]="LineThin";t[t["BlockOutline"]=5]="BlockOutline";t[t["UnderlineThin"]=6]="UnderlineThin"})(ts||(ts={}));function Kx(t){switch(t){case"line":return ts.Line;case"block":return ts.Block;case"underline":return ts.Underline;case"line-thin":return ts.LineThin;case"block-outline":return ts.BlockOutline;case"underline-thin":return ts.UnderlineThin}}class LA extends Ua{constructor(){super(N.editorClassName)}compute(e,i,n){const s=["monaco-editor"];if(i.get(N.extraEditorClassName)){s.push(i.get(N.extraEditorClassName))}if(e.extraEditorClassName){s.push(e.extraEditorClassName)}if(i.get(N.mouseStyle)==="default"){s.push("mouse-default")}else if(i.get(N.mouseStyle)==="copy"){s.push("mouse-copy")}if(i.get(N.showUnused)){s.push("showUnused")}if(i.get(N.showDeprecated)){s.push("showDeprecated")}return s.join(" ")}}class NA extends Ae{constructor(){super(N.emptySelectionClipboard,"emptySelectionClipboard",true,{description:h(268,"Controls whether copying without a selection copies the current line.")})}compute(e,i,n){return n&&e.emptySelectionClipboard}}class OA extends ht{constructor(){const e={cursorMoveOnType:true,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:false,addExtraSpaceOnTop:true,loop:true,history:"workspace",replaceHistory:"workspace"};super(N.find,"find",e,{"editor.find.cursorMoveOnType":{type:"boolean",default:e.cursorMoveOnType,description:h(269,"Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:e.seedSearchStringFromSelection,enumDescriptions:[h(270,"Never seed search string from the editor selection."),h(271,"Always seed search string from the editor selection, including word at cursor position."),h(272,"Only seed search string from the editor selection.")],description:h(273,"Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:e.autoFindInSelection,enumDescriptions:[h(274,"Never turn on Find in Selection automatically (default)."),h(275,"Always turn on Find in Selection automatically."),h(276,"Turn on Find in Selection automatically when multiple lines of content are selected.")],description:h(277,"Controls the condition for turning on Find in Selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:e.globalFindClipboard,description:h(278,"Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:Dn},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:e.addExtraSpaceOnTop,description:h(279,"Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:e.loop,description:h(280,"Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")},"editor.find.history":{type:"string",enum:["never","workspace"],default:"workspace",enumDescriptions:[h(281,"Do not store search history from the find widget."),h(282,"Store search history across the active workspace")],description:h(283,"Controls how the find widget history should be stored")},"editor.find.replaceHistory":{type:"string",enum:["never","workspace"],default:"workspace",enumDescriptions:[h(284,"Do not store history from the replace widget."),h(285,"Store replace history across the active workspace")],description:h(286,"Controls how the replace widget history should be stored")}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;return{cursorMoveOnType:ee(i.cursorMoveOnType,this.defaultValue.cursorMoveOnType),seedSearchStringFromSelection:typeof e.seedSearchStringFromSelection==="boolean"?e.seedSearchStringFromSelection?"always":"never":mt(i.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof e.autoFindInSelection==="boolean"?e.autoFindInSelection?"always":"never":mt(i.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:ee(i.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:ee(i.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:ee(i.loop,this.defaultValue.loop),history:mt(i.history,this.defaultValue.history,["never","workspace"]),replaceHistory:mt(i.replaceHistory,this.defaultValue.replaceHistory,["never","workspace"])}}}class Oo extends ht{static{this.OFF='"liga" off, "calt" off'}static{this.ON='"liga" on, "calt" on'}constructor(){super(N.fontLigatures,"fontLigatures",Oo.OFF,{anyOf:[{type:"boolean",description:h(287,"Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:h(288,"Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:h(289,"Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:false})}validate(e){if(typeof e==="undefined"){return this.defaultValue}if(typeof e==="string"){if(e==="false"||e.length===0){return Oo.OFF}if(e==="true"){return Oo.ON}return e}if(Boolean(e)){return Oo.ON}return Oo.OFF}}class Fo extends ht{static{this.OFF="normal"}static{this.TRANSLATE="translate"}constructor(){super(N.fontVariations,"fontVariations",Fo.OFF,{anyOf:[{type:"boolean",description:h(290,"Enables/Disables the translation from font-weight to font-variation-settings. Change this to a string for fine-grained control of the 'font-variation-settings' CSS property.")},{type:"string",description:h(291,"Explicit 'font-variation-settings' CSS property. A boolean can be passed instead if one only needs to translate font-weight to font-variation-settings.")}],description:h(292,"Configures font variations. Can be either a boolean to enable/disable the translation from font-weight to font-variation-settings or a string for the value of the CSS 'font-variation-settings' property."),default:false})}validate(e){if(typeof e==="undefined"){return this.defaultValue}if(typeof e==="string"){if(e==="false"){return Fo.OFF}if(e==="true"){return Fo.TRANSLATE}return e}if(Boolean(e)){return Fo.TRANSLATE}return Fo.OFF}compute(e,i,n){return e.fontInfo.fontVariationSettings}}class FA extends Ua{constructor(){super(N.fontInfo)}compute(e,i,n){return e.fontInfo}}class MA extends Ua{constructor(){super(N.effectiveCursorStyle)}compute(e,i,n){return e.inputMode==="overtype"?i.get(N.overtypeCursorStyle):i.get(N.cursorStyle)}}class UA extends Ua{constructor(){super(N.effectiveExperimentalEditContextEnabled)}compute(e,i){return e.editContextSupported&&i.get(N.experimentalEditContextEnabled)}}class $A extends Ac{constructor(){super(N.fontSize,"fontSize",wr.fontSize,{type:"number",minimum:6,maximum:100,default:wr.fontSize,description:h(293,"Controls the font size in pixels.")})}validate(e){const i=Nn.float(e,this.defaultValue);if(i===0){return wr.fontSize}return Nn.clamp(i,6,100)}compute(e,i,n){return e.fontInfo.fontSize}}class Mo extends ht{static{this.SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"]}static{this.MINIMUM_VALUE=1}static{this.MAXIMUM_VALUE=1e3}constructor(){super(N.fontWeight,"fontWeight",wr.fontWeight,{anyOf:[{type:"number",minimum:Mo.MINIMUM_VALUE,maximum:Mo.MAXIMUM_VALUE,errorMessage:h(294,'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:Mo.SUGGESTION_VALUES}],default:wr.fontWeight,description:h(295,'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(e){if(e==="normal"||e==="bold"){return e}return String(Qe.clampedInt(e,wr.fontWeight,Mo.MINIMUM_VALUE,Mo.MAXIMUM_VALUE))}}class HA extends ht{constructor(){const e={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",multipleTests:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:"",alternativeTestsCommand:""};const i={type:"string",enum:["peek","gotoAndPeek","goto"],default:e.multiple,enumDescriptions:[h(296,"Show Peek view of the results (default)"),h(297,"Go to the primary result and show a Peek view"),h(298,"Go to the primary result and enable Peek-less navigation to others")]};const n=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(N.gotoLocation,"gotoLocation",e,{"editor.gotoLocation.multiple":{deprecationMessage:h(299,"This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":{description:h(300,"Controls the behavior the 'Go to Definition'-command when multiple target locations exist."),...i},"editor.gotoLocation.multipleTypeDefinitions":{description:h(301,"Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist."),...i},"editor.gotoLocation.multipleDeclarations":{description:h(302,"Controls the behavior the 'Go to Declaration'-command when multiple target locations exist."),...i},"editor.gotoLocation.multipleImplementations":{description:h(303,"Controls the behavior the 'Go to Implementations'-command when multiple target locations exist."),...i},"editor.gotoLocation.multipleReferences":{description:h(304,"Controls the behavior the 'Go to References'-command when multiple target locations exist."),...i},"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:e.alternativeDefinitionCommand,enum:n,description:h(305,"Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:e.alternativeTypeDefinitionCommand,enum:n,description:h(306,"Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:e.alternativeDeclarationCommand,enum:n,description:h(307,"Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:e.alternativeImplementationCommand,enum:n,description:h(308,"Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:e.alternativeReferenceCommand,enum:n,description:h(309,"Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;return{multiple:mt(i.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:i.multipleDefinitions??mt(i.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:i.multipleTypeDefinitions??mt(i.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:i.multipleDeclarations??mt(i.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:i.multipleImplementations??mt(i.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:i.multipleReferences??mt(i.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),multipleTests:i.multipleTests??mt(i.multipleTests,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:Ni.string(i.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:Ni.string(i.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:Ni.string(i.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:Ni.string(i.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:Ni.string(i.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand),alternativeTestsCommand:Ni.string(i.alternativeTestsCommand,this.defaultValue.alternativeTestsCommand)}}}class BA extends ht{constructor(){const e={enabled:true,delay:300,hidingDelay:300,sticky:true,above:true};super(N.hover,"hover",e,{"editor.hover.enabled":{type:"boolean",default:e.enabled,description:h(310,"Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:e.delay,minimum:0,maximum:1e4,description:h(311,"Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:e.sticky,description:h(312,"Controls whether the hover should remain visible when mouse is moved over it.")},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:e.hidingDelay,description:h(313,"Controls the delay in milliseconds after which the hover is hidden. Requires `editor.hover.sticky` to be enabled.")},"editor.hover.above":{type:"boolean",default:e.above,description:h(314,"Prefer showing hovers above the line, if there's space.")}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;return{enabled:ee(i.enabled,this.defaultValue.enabled),delay:Qe.clampedInt(i.delay,this.defaultValue.delay,0,1e4),sticky:ee(i.sticky,this.defaultValue.sticky),hidingDelay:Qe.clampedInt(i.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:ee(i.above,this.defaultValue.above)}}}var al;(function(t){t[t["None"]=0]="None";t[t["Text"]=1]="Text";t[t["Blocks"]=2]="Blocks"})(al||(al={}));class vu extends Ua{constructor(){super(N.layoutInfo)}compute(e,i,n){return vu.computeLayout(i,{memory:e.memory,outerWidth:e.outerWidth,outerHeight:e.outerHeight,isDominatedByLongLines:e.isDominatedByLongLines,lineHeight:e.fontInfo.lineHeight,viewLineCount:e.viewLineCount,lineNumbersDigitCount:e.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:e.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:e.fontInfo.maxDigitWidth,pixelRatio:e.pixelRatio,glyphMarginDecorationLaneCount:e.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(e){const i=e.height/e.lineHeight;const n=Math.floor(e.paddingTop/e.lineHeight);let s=Math.floor(e.paddingBottom/e.lineHeight);if(e.scrollBeyondLastLine){s=Math.max(s,i-1)}const r=(n+e.viewLineCount+s)/(e.pixelRatio*e.height);const o=Math.floor(e.viewLineCount/r);return{typicalViewportLineCount:i,extraLinesBeforeFirstLine:n,extraLinesBeyondLastLine:s,desiredRatio:r,minimapLineCount:o}}static _computeMinimapLayout(e,i){const n=e.outerWidth;const s=e.outerHeight;const r=e.pixelRatio;if(!e.minimap.enabled){return{renderMinimap:al.None,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:false,minimapIsSampling:false,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(r*s),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:s}}const o=i.stableMinimapLayoutInput;const a=o&&e.outerHeight===o.outerHeight&&e.lineHeight===o.lineHeight&&e.typicalHalfwidthCharacterWidth===o.typicalHalfwidthCharacterWidth&&e.pixelRatio===o.pixelRatio&&e.scrollBeyondLastLine===o.scrollBeyondLastLine&&e.paddingTop===o.paddingTop&&e.paddingBottom===o.paddingBottom&&e.minimap.enabled===o.minimap.enabled&&e.minimap.side===o.minimap.side&&e.minimap.size===o.minimap.size&&e.minimap.showSlider===o.minimap.showSlider&&e.minimap.renderCharacters===o.minimap.renderCharacters&&e.minimap.maxColumn===o.minimap.maxColumn&&e.minimap.scale===o.minimap.scale&&e.verticalScrollbarWidth===o.verticalScrollbarWidth&&e.isViewportWrapping===o.isViewportWrapping;const l=e.lineHeight;const c=e.typicalHalfwidthCharacterWidth;const u=e.scrollBeyondLastLine;const d=e.minimap.renderCharacters;let p=r>=2?Math.round(e.minimap.scale*2):e.minimap.scale;const f=e.minimap.maxColumn;const m=e.minimap.size;const v=e.minimap.side;const y=e.verticalScrollbarWidth;const D=e.viewLineCount;const I=e.remainingWidth;const R=e.isViewportWrapping;const J=d?2:3;let H=Math.floor(r*s);const Q=H/r;let ne=false;let te=false;let le=J*p;let Ce=p/r;let Je=1;if(m==="fill"||m==="fit"){const{typicalViewportLineCount:be,extraLinesBeforeFirstLine:Ke,extraLinesBeyondLastLine:Et,desiredRatio:Ue,minimapLineCount:Gt}=vu.computeContainedMinimapLineCount({viewLineCount:D,scrollBeyondLastLine:u,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:s,lineHeight:l,pixelRatio:r});const Ri=D/Gt;if(Ri>1){ne=true;te=true;p=1;le=1;Ce=p/r}else{let At=false;let dn=p+1;if(m==="fit"){const bi=Math.ceil((Ke+D+Et)*le);if(R&&a&&I<=i.stableFitRemainingWidth){At=true;dn=i.stableFitMaxMinimapScale}else{At=bi>H}}if(m==="fill"||At){ne=true;const bi=p;le=Math.min(l*r,Math.max(1,Math.floor(1/Ue)));if(R&&a&&I<=i.stableFitRemainingWidth){dn=i.stableFitMaxMinimapScale}p=Math.min(dn,Math.max(1,Math.floor(le/J)));if(p>bi){Je=Math.min(2,p/bi)}Ce=p/r/Je;H=Math.ceil(Math.max(be,Ke+D+Et)*le);if(R){i.stableMinimapLayoutInput=e;i.stableFitRemainingWidth=I;i.stableFitMaxMinimapScale=p}else{i.stableMinimapLayoutInput=null;i.stableFitRemainingWidth=0}}}}const We=Math.floor(f*Ce);const se=Math.min(We,Math.max(0,Math.floor((I-y-2)*Ce/(c+Ce)))+kA);let G=Math.floor(r*se);const ce=G/r;G=Math.floor(G*Je);const ie=d?al.Text:al.Blocks;const _e=v==="left"?0:n-se-y;return{renderMinimap:ie,minimapLeft:_e,minimapWidth:se,minimapHeightIsEditorHeight:ne,minimapIsSampling:te,minimapScale:p,minimapLineHeight:le,minimapCanvasInnerWidth:G,minimapCanvasInnerHeight:H,minimapCanvasOuterWidth:ce,minimapCanvasOuterHeight:Q}}static computeLayout(e,i){const n=i.outerWidth|0;const s=i.outerHeight|0;const r=i.lineHeight|0;const o=i.lineNumbersDigitCount|0;const a=i.typicalHalfwidthCharacterWidth;const l=i.maxDigitWidth;const c=i.pixelRatio;const u=i.viewLineCount;const d=e.get(N.wordWrapOverride2);const p=d==="inherit"?e.get(N.wordWrapOverride1):d;const f=p==="inherit"?e.get(N.wordWrap):p;const m=e.get(N.wordWrapColumn);const v=i.isDominatedByLongLines;const y=e.get(N.glyphMargin);const D=e.get(N.lineNumbers).renderType!==Li.Off;const I=e.get(N.lineNumbersMinChars);const R=e.get(N.scrollBeyondLastLine);const J=e.get(N.padding);const H=e.get(N.minimap);const Q=e.get(N.scrollbar);const ne=Q.verticalScrollbarSize;const te=Q.verticalHasArrows;const le=Q.arrowSize;const Ce=Q.horizontalScrollbarSize;const Je=e.get(N.folding);const We=e.get(N.showFoldingControls)!=="never";let se=e.get(N.lineDecorationsWidth);if(Je&&We){se+=16}let G=0;if(D){const Cn=Math.max(o,I);G=Math.round(Cn*l)}let ce=0;if(y){ce=r*i.glyphMarginDecorationLaneCount}let ie=0;let _e=ie+ce;let be=_e+G;let Ke=be+se;const Et=n-ce-G-se;let Ue=false;let Gt=false;let Ri=-1;if(p==="inherit"&&v){Ue=true;Gt=true}else if(f==="on"||f==="bounded"){Gt=true}else if(f==="wordWrapColumn"){Ri=m}const At=vu._computeMinimapLayout({outerWidth:n,outerHeight:s,lineHeight:r,typicalHalfwidthCharacterWidth:a,pixelRatio:c,scrollBeyondLastLine:R,paddingTop:J.top,paddingBottom:J.bottom,minimap:H,verticalScrollbarWidth:ne,viewLineCount:u,remainingWidth:Et,isViewportWrapping:Gt},i.memory||new IA);if(At.renderMinimap!==al.None&&At.minimapLeft===0){ie+=At.minimapWidth;_e+=At.minimapWidth;be+=At.minimapWidth;Ke+=At.minimapWidth}const dn=Et-At.minimapWidth;const bi=Math.max(1,Math.floor((dn-ne-2)/a));const Vt=te?le:0;if(Gt){Ri=Math.max(1,bi);if(f==="bounded"){Ri=Math.min(Ri,m)}}return{width:n,height:s,glyphMarginLeft:ie,glyphMarginWidth:ce,glyphMarginDecorationLaneCount:i.glyphMarginDecorationLaneCount,lineNumbersLeft:_e,lineNumbersWidth:G,decorationsLeft:be,decorationsWidth:se,contentLeft:Ke,contentWidth:dn,minimap:At,viewportColumn:bi,isWordWrapMinified:Ue,isViewportWrapping:Gt,wrappingColumn:Ri,verticalScrollbarWidth:ne,horizontalScrollbarHeight:Ce,overviewRuler:{top:Vt,width:ne,height:s-2*Vt,right:0}}}}class VA extends ht{constructor(){super(N.wrappingStrategy,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[h(315,"Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),h(316,"Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],type:"string",enum:["simple","advanced"],default:"simple",description:h(317,"Controls the algorithm that computes wrapping points. Note that when in accessibility mode, advanced will be used for the best experience.")}})}validate(e){return mt(e,"simple",["simple","advanced"])}compute(e,i,n){const s=i.get(N.accessibilitySupport);if(s===cr.Enabled){return"advanced"}return n}}var Zs;(function(t){t["Off"]="off";t["OnCode"]="onCode";t["On"]="on"})(Zs||(Zs={}));class WA extends ht{constructor(){const e={enabled:Zs.OnCode};super(N.lightbulb,"lightbulb",e,{"editor.lightbulb.enabled":{type:"string",enum:[Zs.Off,Zs.OnCode,Zs.On],default:e.enabled,enumDescriptions:[h(318,"Disable the code action menu."),h(319,"Show the code action menu when the cursor is on lines with code."),h(320,"Show the code action menu when the cursor is on lines with code or on empty lines.")],description:h(321,"Enables the Code Action lightbulb in the editor.")}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;return{enabled:mt(i.enabled,this.defaultValue.enabled,[Zs.Off,Zs.OnCode,Zs.On])}}}class zA extends ht{constructor(){const e={enabled:true,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:true};super(N.stickyScroll,"stickyScroll",e,{"editor.stickyScroll.enabled":{type:"boolean",default:e.enabled,description:h(322,"Shows the nested current scopes during the scroll at the top of the editor.")},"editor.stickyScroll.maxLineCount":{type:"number",default:e.maxLineCount,minimum:1,maximum:20,description:h(323,"Defines the maximum number of sticky lines to show.")},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:e.defaultModel,description:h(324,"Defines the model to use for determining which lines to stick. If the outline model does not exist, it will fall back on the folding provider model which falls back on the indentation model. This order is respected in all three cases.")},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:e.scrollWithEditor,description:h(325,"Enable scrolling of Sticky Scroll with the editor's horizontal scrollbar.")}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;return{enabled:ee(i.enabled,this.defaultValue.enabled),maxLineCount:Qe.clampedInt(i.maxLineCount,this.defaultValue.maxLineCount,1,20),defaultModel:mt(i.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:ee(i.scrollWithEditor,this.defaultValue.scrollWithEditor)}}}class qA extends ht{constructor(){const e={enabled:"on",fontSize:0,fontFamily:"",padding:false,maximumLength:43};super(N.inlayHints,"inlayHints",e,{"editor.inlayHints.enabled":{type:"string",default:e.enabled,description:h(326,"Enables the inlay hints in the editor."),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[h(327,"Inlay hints are enabled"),h(328,"Inlay hints are showing by default and hide when holding {0}",Dn?`Ctrl+Option`:`Ctrl+Alt`),h(329,"Inlay hints are hidden by default and show when holding {0}",Dn?`Ctrl+Option`:`Ctrl+Alt`),h(330,"Inlay hints are disabled")]},"editor.inlayHints.fontSize":{type:"number",default:e.fontSize,markdownDescription:h(331,"Controls font size of inlay hints in the editor. As default the {0} is used when the configured value is less than {1} or greater than the editor font size.","`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:e.fontFamily,markdownDescription:h(332,"Controls font family of inlay hints in the editor. When set to empty, the {0} is used.","`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:e.padding,description:h(333,"Enables the padding around the inlay hints in the editor.")},"editor.inlayHints.maximumLength":{type:"number",default:e.maximumLength,markdownDescription:h(334,"Maximum overall length of inlay hints, for a single line, before they get truncated by the editor. Set to `0` to never truncate")}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;if(typeof i.enabled==="boolean"){i.enabled=i.enabled?"on":"off"}return{enabled:mt(i.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:Qe.clampedInt(i.fontSize,this.defaultValue.fontSize,0,100),fontFamily:Ni.string(i.fontFamily,this.defaultValue.fontFamily),padding:ee(i.padding,this.defaultValue.padding),maximumLength:Qe.clampedInt(i.maximumLength,this.defaultValue.maximumLength,0,Number.MAX_SAFE_INTEGER)}}}class jA extends ht{constructor(){super(N.lineDecorationsWidth,"lineDecorationsWidth",10)}validate(e){if(typeof e==="string"&&/^\d+(\.\d+)?ch$/.test(e)){const i=parseFloat(e.substring(0,e.length-2));return-i}else{return Qe.clampedInt(e,this.defaultValue,0,1e3)}}compute(e,i,n){if(n<0){return Qe.clampedInt(-n*e.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3)}else{return n}}}class GA extends Nn{constructor(){super(N.lineHeight,"lineHeight",wr.lineHeight,e=>Nn.clamp(e,0,150),{markdownDescription:h(335,"Controls the line height. \n - Use 0 to automatically compute the line height from the font size.\n - Values between 0 and 8 will be used as a multiplier with the font size.\n - Values greater than or equal to 8 will be used as effective values.")})}compute(e,i,n){return e.fontInfo.lineHeight}}class KA extends ht{constructor(){const e={enabled:true,size:"proportional",side:"right",showSlider:"mouseover",autohide:false,renderCharacters:true,maxColumn:120,scale:1,showRegionSectionHeaders:true,showMarkSectionHeaders:true,markSectionHeaderRegex:"\\bMARK:\\s*(?<separator>-?)\\s*(?<label>.*)$",sectionHeaderFontSize:9,sectionHeaderLetterSpacing:1};super(N.minimap,"minimap",e,{"editor.minimap.enabled":{type:"boolean",default:e.enabled,description:h(336,"Controls whether the minimap is shown.")},"editor.minimap.autohide":{type:"boolean",default:e.autohide,description:h(337,"Controls whether the minimap is hidden automatically.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[h(338,"The minimap has the same size as the editor contents (and might scroll)."),h(339,"The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),h(340,"The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:e.size,description:h(341,"Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:e.side,description:h(342,"Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:e.showSlider,description:h(343,"Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:h(344,"Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:e.renderCharacters,description:h(345,"Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:e.maxColumn,description:h(346,"Limit the width of the minimap to render at most a certain number of columns.")},"editor.minimap.showRegionSectionHeaders":{type:"boolean",default:e.showRegionSectionHeaders,description:h(347,"Controls whether named regions are shown as section headers in the minimap.")},"editor.minimap.showMarkSectionHeaders":{type:"boolean",default:e.showMarkSectionHeaders,description:h(348,"Controls whether MARK: comments are shown as section headers in the minimap.")},"editor.minimap.markSectionHeaderRegex":{type:"string",default:e.markSectionHeaderRegex,description:h(349,"Defines the regular expression used to find section headers in comments. The regex must contain a named match group `label` (written as `(?<label>.+)`) that encapsulates the section header, otherwise it will not work. Optionally you can include another match group named `separator`. Use \\n in the pattern to match multi-line headers.")},"editor.minimap.sectionHeaderFontSize":{type:"number",default:e.sectionHeaderFontSize,description:h(350,"Controls the font size of section headers in the minimap.")},"editor.minimap.sectionHeaderLetterSpacing":{type:"number",default:e.sectionHeaderLetterSpacing,description:h(351,"Controls the amount of space (in pixels) between characters of section header. This helps the readability of the header in small font sizes.")}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;let n=this.defaultValue.markSectionHeaderRegex;const s=e.markSectionHeaderRegex;if(typeof s==="string"){try{new RegExp(s,"d");n=s}catch{}}return{enabled:ee(i.enabled,this.defaultValue.enabled),autohide:ee(i.autohide,this.defaultValue.autohide),size:mt(i.size,this.defaultValue.size,["proportional","fill","fit"]),side:mt(i.side,this.defaultValue.side,["right","left"]),showSlider:mt(i.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:ee(i.renderCharacters,this.defaultValue.renderCharacters),scale:Qe.clampedInt(i.scale,1,1,3),maxColumn:Qe.clampedInt(i.maxColumn,this.defaultValue.maxColumn,1,1e4),showRegionSectionHeaders:ee(i.showRegionSectionHeaders,this.defaultValue.showRegionSectionHeaders),showMarkSectionHeaders:ee(i.showMarkSectionHeaders,this.defaultValue.showMarkSectionHeaders),markSectionHeaderRegex:n,sectionHeaderFontSize:Nn.clamp(i.sectionHeaderFontSize??this.defaultValue.sectionHeaderFontSize,4,32),sectionHeaderLetterSpacing:Nn.clamp(i.sectionHeaderLetterSpacing??this.defaultValue.sectionHeaderLetterSpacing,0,5)}}}function QA(t){if(t==="ctrlCmd"){return Dn?"metaKey":"ctrlKey"}return"altKey"}class JA extends ht{constructor(){super(N.padding,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:h(352,"Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:h(353,"Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;return{top:Qe.clampedInt(i.top,0,0,1e3),bottom:Qe.clampedInt(i.bottom,0,0,1e3)}}}class XA extends ht{constructor(){const e={enabled:true,cycle:true};super(N.parameterHints,"parameterHints",e,{"editor.parameterHints.enabled":{type:"boolean",default:e.enabled,description:h(354,"Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:e.cycle,description:h(355,"Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;return{enabled:ee(i.enabled,this.defaultValue.enabled),cycle:ee(i.cycle,this.defaultValue.cycle)}}}class YA extends Ua{constructor(){super(N.pixelRatio)}compute(e,i,n){return e.pixelRatio}}class ZA extends ht{constructor(){super(N.placeholder,"placeholder",void 0)}validate(e){if(typeof e==="undefined"){return this.defaultValue}if(typeof e==="string"){return e}return this.defaultValue}}class e8 extends ht{constructor(){const e={other:"on",comments:"off",strings:"off"};const i=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[h(356,"Quick suggestions show inside the suggest widget"),h(357,"Quick suggestions show as ghost text"),h(358,"Quick suggestions are disabled")]}];super(N.quickSuggestions,"quickSuggestions",e,{type:"object",additionalProperties:false,properties:{strings:{anyOf:i,default:e.strings,description:h(359,"Enable quick suggestions inside strings.")},comments:{anyOf:i,default:e.comments,description:h(360,"Enable quick suggestions inside comments.")},other:{anyOf:i,default:e.other,description:h(361,"Enable quick suggestions outside of strings and comments.")}},default:e,markdownDescription:h(362,"Controls whether suggestions should automatically show up while typing. This can be controlled for typing in comments, strings, and other code. Quick suggestion can be configured to show as ghost text or with the suggest widget. Also be aware of the {0}-setting which controls if suggestions are triggered by special characters.","`#editor.suggestOnTriggerCharacters#`")});this.defaultValue=e}validate(e){if(typeof e==="boolean"){const c=e?"on":"off";return{comments:c,strings:c,other:c}}if(!e||typeof e!=="object"){return this.defaultValue}const{other:i,comments:n,strings:s}=e;const r=["on","inline","off"];let o;let a;let l;if(typeof i==="boolean"){o=i?"on":"off"}else{o=mt(i,this.defaultValue.other,r)}if(typeof n==="boolean"){a=n?"on":"off"}else{a=mt(n,this.defaultValue.comments,r)}if(typeof s==="boolean"){l=s?"on":"off"}else{l=mt(s,this.defaultValue.strings,r)}return{other:o,comments:a,strings:l}}}var Li;(function(t){t[t["Off"]=0]="Off";t[t["On"]=1]="On";t[t["Relative"]=2]="Relative";t[t["Interval"]=3]="Interval";t[t["Custom"]=4]="Custom"})(Li||(Li={}));class t8 extends ht{constructor(){super(N.lineNumbers,"lineNumbers",{renderType:Li.On,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[h(363,"Line numbers are not rendered."),h(364,"Line numbers are rendered as absolute number."),h(365,"Line numbers are rendered as distance in lines to cursor position."),h(366,"Line numbers are rendered every 10 lines.")],default:"on",description:h(367,"Controls the display of line numbers.")})}validate(e){let i=this.defaultValue.renderType;let n=this.defaultValue.renderFn;if(typeof e!=="undefined"){if(typeof e==="function"){i=Li.Custom;n=e}else if(e==="interval"){i=Li.Interval}else if(e==="relative"){i=Li.Relative}else if(e==="on"){i=Li.On}else{i=Li.Off}}return{renderType:i,renderFn:n}}}class i8 extends ht{constructor(){const e=[];const i={type:"number",description:h(368,"Number of monospace characters at which this editor ruler will render.")};super(N.rulers,"rulers",e,{type:"array",items:{anyOf:[i,{type:["object"],properties:{column:i,color:{type:"string",description:h(369,"Color of this editor ruler."),format:"color-hex"}}}]},default:e,description:h(370,"Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(e){if(Array.isArray(e)){const i=[];for(const n of e){if(typeof n==="number"){i.push({column:Qe.clampedInt(n,0,0,1e4),color:null})}else if(n&&typeof n==="object"){const s=n;i.push({column:Qe.clampedInt(s.column,0,0,1e4),color:s.color})}}i.sort((n,s)=>n.column-s.column);return i}return this.defaultValue}}class n8 extends ht{constructor(){const e=void 0;super(N.readOnlyMessage,"readOnlyMessage",e)}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}return e}}function Qx(t,e){if(typeof t!=="string"){return e}switch(t){case"hidden":return oa.Hidden;case"visible":return oa.Visible;default:return oa.Auto}}class s8 extends ht{constructor(){const e={vertical:oa.Auto,horizontal:oa.Auto,arrowSize:11,useShadows:true,verticalHasArrows:false,horizontalHasArrows:false,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:true,alwaysConsumeMouseWheel:true,scrollByPage:false,ignoreHorizontalScrollbarInContentHeight:false};super(N.scrollbar,"scrollbar",e,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[h(371,"The vertical scrollbar will be visible only when necessary."),h(372,"The vertical scrollbar will always be visible."),h(373,"The vertical scrollbar will always be hidden.")],default:"auto",description:h(374,"Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[h(375,"The horizontal scrollbar will be visible only when necessary."),h(376,"The horizontal scrollbar will always be visible."),h(377,"The horizontal scrollbar will always be hidden.")],default:"auto",description:h(378,"Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:e.verticalScrollbarSize,description:h(379,"The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:e.horizontalScrollbarSize,description:h(380,"The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:e.scrollByPage,description:h(381,"Controls whether clicks scroll by page or jump to click position.")},"editor.scrollbar.ignoreHorizontalScrollbarInContentHeight":{type:"boolean",default:e.ignoreHorizontalScrollbarInContentHeight,description:h(382,"When set, the horizontal scrollbar will not increase the size of the editor's content.")}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;const n=Qe.clampedInt(i.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3);const s=Qe.clampedInt(i.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:Qe.clampedInt(i.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:Qx(i.vertical,this.defaultValue.vertical),horizontal:Qx(i.horizontal,this.defaultValue.horizontal),useShadows:ee(i.useShadows,this.defaultValue.useShadows),verticalHasArrows:ee(i.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:ee(i.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:ee(i.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:ee(i.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:n,horizontalSliderSize:Qe.clampedInt(i.horizontalSliderSize,n,0,1e3),verticalScrollbarSize:s,verticalSliderSize:Qe.clampedInt(i.verticalSliderSize,s,0,1e3),scrollByPage:ee(i.scrollByPage,this.defaultValue.scrollByPage),ignoreHorizontalScrollbarInContentHeight:ee(i.ignoreHorizontalScrollbarInContentHeight,this.defaultValue.ignoreHorizontalScrollbarInContentHeight)}}}const Hn="inUntrustedWorkspace";const Do={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"};class r8 extends ht{constructor(){const e={nonBasicASCII:Hn,invisibleCharacters:true,ambiguousCharacters:true,includeComments:Hn,includeStrings:true,allowedCharacters:{},allowedLocales:{_os:true,_vscode:true}};super(N.unicodeHighlighting,"unicodeHighlight",e,{[Do.nonBasicASCII]:{restricted:true,type:["boolean","string"],enum:[true,false,Hn],default:e.nonBasicASCII,description:h(383,"Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.")},[Do.invisibleCharacters]:{restricted:true,type:"boolean",default:e.invisibleCharacters,description:h(384,"Controls whether characters that just reserve space or have no width at all are highlighted.")},[Do.ambiguousCharacters]:{restricted:true,type:"boolean",default:e.ambiguousCharacters,description:h(385,"Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.")},[Do.includeComments]:{restricted:true,type:["boolean","string"],enum:[true,false,Hn],default:e.includeComments,description:h(386,"Controls whether characters in comments should also be subject to Unicode highlighting.")},[Do.includeStrings]:{restricted:true,type:["boolean","string"],enum:[true,false,Hn],default:e.includeStrings,description:h(387,"Controls whether characters in strings should also be subject to Unicode highlighting.")},[Do.allowedCharacters]:{restricted:true,type:"object",default:e.allowedCharacters,description:h(388,"Defines allowed characters that are not being highlighted."),additionalProperties:{type:"boolean"}},[Do.allowedLocales]:{restricted:true,type:"object",additionalProperties:{type:"boolean"},default:e.allowedLocales,description:h(389,"Unicode characters that are common in allowed locales are not being highlighted.")}})}applyUpdate(e,i){let n=false;if(i.allowedCharacters&&e){if(!Xi(e.allowedCharacters,i.allowedCharacters)){e={...e,allowedCharacters:i.allowedCharacters};n=true}}if(i.allowedLocales&&e){if(!Xi(e.allowedLocales,i.allowedLocales)){e={...e,allowedLocales:i.allowedLocales};n=true}}const s=super.applyUpdate(e,i);if(n){return new tf(s.newValue,true)}return s}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;return{nonBasicASCII:Dl(i.nonBasicASCII,Hn,[true,false,Hn]),invisibleCharacters:ee(i.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:ee(i.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:Dl(i.includeComments,Hn,[true,false,Hn]),includeStrings:Dl(i.includeStrings,Hn,[true,false,Hn]),allowedCharacters:this.validateBooleanMap(e.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(e.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(e,i){if(typeof e!=="object"||!e){return i}const n={};for(const[s,r]of Object.entries(e)){if(r===true){n[s]=true}}return n}}class o8 extends ht{constructor(){const e={enabled:true,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:false,keepOnBlur:false,fontFamily:"default",syntaxHighlightingEnabled:true,edits:{enabled:true,showCollapsed:false,renderSideBySide:"auto",allowCodeShifting:"always",useMultiLineGhostText:true}};super(N.inlineSuggest,"inlineSuggest",e,{"editor.inlineSuggest.enabled":{type:"boolean",default:e.enabled,description:h(390,"Controls whether to automatically show inline suggestions in the editor.")},"editor.inlineSuggest.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[h(391,"Show the inline suggestion toolbar whenever an inline suggestion is shown."),h(392,"Show the inline suggestion toolbar when hovering over an inline suggestion."),h(393,"Never show the inline suggestion toolbar.")],description:h(394,"Controls when to show the inline suggestion toolbar.")},"editor.inlineSuggest.syntaxHighlightingEnabled":{type:"boolean",default:e.syntaxHighlightingEnabled,description:h(395,"Controls whether to show syntax highlighting for inline suggestions in the editor.")},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:e.suppressSuggestions,description:h(396,"Controls how inline suggestions interact with the suggest widget. If enabled, the suggest widget is not shown automatically when inline suggestions are available.")},"editor.inlineSuggest.fontFamily":{type:"string",default:e.fontFamily,description:h(397,"Controls the font family of the inline suggestions.")},"editor.inlineSuggest.edits.allowCodeShifting":{type:"string",default:e.edits.allowCodeShifting,description:h(398,"Controls whether showing a suggestion will shift the code to make space for the suggestion inline."),enum:["always","horizontal","never"],tags:["nextEditSuggestions"]},"editor.inlineSuggest.edits.renderSideBySide":{type:"string",default:e.edits.renderSideBySide,description:h(399,"Controls whether larger suggestions can be shown side by side."),enum:["auto","never"],enumDescriptions:[h(400,"Larger suggestions will show side by side if there is enough space, otherwise they will be shown below."),h(401,"Larger suggestions are never shown side by side and will always be shown below.")],tags:["nextEditSuggestions"]},"editor.inlineSuggest.edits.showCollapsed":{type:"boolean",default:e.edits.showCollapsed,description:h(402,"Controls whether the suggestion will show as collapsed until jumping to it."),tags:["nextEditSuggestions"]}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;return{enabled:ee(i.enabled,this.defaultValue.enabled),mode:mt(i.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:mt(i.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),suppressSuggestions:ee(i.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:ee(i.keepOnBlur,this.defaultValue.keepOnBlur),fontFamily:Ni.string(i.fontFamily,this.defaultValue.fontFamily),syntaxHighlightingEnabled:ee(i.syntaxHighlightingEnabled,this.defaultValue.syntaxHighlightingEnabled),edits:{enabled:ee(i.edits?.enabled,this.defaultValue.edits.enabled),showCollapsed:ee(i.edits?.showCollapsed,this.defaultValue.edits.showCollapsed),allowCodeShifting:mt(i.edits?.allowCodeShifting,this.defaultValue.edits.allowCodeShifting,["always","horizontal","never"]),renderSideBySide:mt(i.edits?.renderSideBySide,this.defaultValue.edits.renderSideBySide,["never","auto"]),useMultiLineGhostText:ee(i.edits?.useMultiLineGhostText,this.defaultValue.edits.useMultiLineGhostText)}}}}class a8 extends ht{constructor(){const e={enabled:qx.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:qx.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(N.bracketPairColorization,"bracketPairColorization",e,{"editor.bracketPairColorization.enabled":{type:"boolean",default:e.enabled,markdownDescription:h(403,"Controls whether bracket pair colorization is enabled or not. Use {0} to override the bracket highlight colors.","`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:e.independentColorPoolPerBracketType,description:h(404,"Controls whether each bracket type has its own independent color pool.")}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;return{enabled:ee(i.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:ee(i.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}}class l8 extends ht{constructor(){const e={bracketPairs:false,bracketPairsHorizontal:"active",highlightActiveBracketPair:true,indentation:true,highlightActiveIndentation:true};super(N.guides,"guides",e,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[true,"active",false],enumDescriptions:[h(405,"Enables bracket pair guides."),h(406,"Enables bracket pair guides only for the active bracket pair."),h(407,"Disables bracket pair guides.")],default:e.bracketPairs,description:h(408,"Controls whether bracket pair guides are enabled or not.")},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[true,"active",false],enumDescriptions:[h(409,"Enables horizontal guides as addition to vertical bracket pair guides."),h(410,"Enables horizontal guides only for the active bracket pair."),h(411,"Disables horizontal bracket pair guides.")],default:e.bracketPairsHorizontal,description:h(412,"Controls whether horizontal bracket pair guides are enabled or not.")},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:e.highlightActiveBracketPair,description:h(413,"Controls whether the editor should highlight the active bracket pair.")},"editor.guides.indentation":{type:"boolean",default:e.indentation,description:h(414,"Controls whether the editor should render indent guides.")},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[true,"always",false],enumDescriptions:[h(415,"Highlights the active indent guide."),h(416,"Highlights the active indent guide even if bracket guides are highlighted."),h(417,"Do not highlight the active indent guide.")],default:e.highlightActiveIndentation,description:h(418,"Controls whether the editor should highlight the active indent guide.")}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;return{bracketPairs:Dl(i.bracketPairs,this.defaultValue.bracketPairs,[true,false,"active"]),bracketPairsHorizontal:Dl(i.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[true,false,"active"]),highlightActiveBracketPair:ee(i.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:ee(i.indentation,this.defaultValue.indentation),highlightActiveIndentation:Dl(i.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[true,false,"always"])}}}function Dl(t,e,i){const n=i.indexOf(t);if(n===-1){return e}return i[n]}class c8 extends ht{constructor(){const e={insertMode:"insert",filterGraceful:true,snippetsPreventQuickSuggestions:false,localityBonus:false,shareSuggestSelections:false,selectionMode:"always",showIcons:true,showStatusBar:false,preview:false,previewMode:"subwordSmart",showInlineDetails:true,showMethods:true,showFunctions:true,showConstructors:true,showDeprecated:true,matchOnWordStartOnly:true,showFields:true,showVariables:true,showClasses:true,showStructs:true,showInterfaces:true,showModules:true,showProperties:true,showEvents:true,showOperators:true,showUnits:true,showValues:true,showConstants:true,showEnums:true,showEnumMembers:true,showKeywords:true,showWords:true,showColors:true,showFiles:true,showReferences:true,showFolders:true,showTypeParameters:true,showSnippets:true,showUsers:true,showIssues:true};super(N.suggest,"suggest",e,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[h(419,"Insert suggestion without overwriting text right of the cursor."),h(420,"Insert suggestion and overwrite text right of the cursor.")],default:e.insertMode,description:h(421,"Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:e.filterGraceful,description:h(422,"Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:e.localityBonus,description:h(423,"Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:e.shareSuggestSelections,markdownDescription:h(424,"Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[h(425,"Always select a suggestion when automatically triggering IntelliSense."),h(426,"Never select a suggestion when automatically triggering IntelliSense."),h(427,"Select a suggestion only when triggering IntelliSense from a trigger character."),h(428,"Select a suggestion only when triggering IntelliSense as you type.")],default:e.selectionMode,markdownDescription:h(429,"Controls whether a suggestion is selected when the widget shows. Note that this only applies to automatically triggered suggestions ({0} and {1}) and that a suggestion is always selected when explicitly invoked, e.g via `Ctrl+Space`.","`#editor.quickSuggestions#`","`#editor.suggestOnTriggerCharacters#`")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:e.snippetsPreventQuickSuggestions,description:h(430,"Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:e.showIcons,description:h(431,"Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:e.showStatusBar,description:h(432,"Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:e.preview,description:h(433,"Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.showInlineDetails":{type:"boolean",default:e.showInlineDetails,description:h(434,"Controls whether suggest details show inline with the label or only in the details widget.")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:h(435,"This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:h(436,"This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:true,markdownDescription:h(437,"When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:true,markdownDescription:h(438,"When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:true,markdownDescription:h(439,"When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:true,markdownDescription:h(440,"When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:true,markdownDescription:h(441,"When enabled IntelliSense filtering requires that the first character matches on a word start. For example, `c` on `Console` or `WebContext` but _not_ on `description`. When disabled IntelliSense will show more results but still sorts them by match quality.")},"editor.suggest.showFields":{type:"boolean",default:true,markdownDescription:h(442,"When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:true,markdownDescription:h(443,"When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:true,markdownDescription:h(444,"When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:true,markdownDescription:h(445,"When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:true,markdownDescription:h(446,"When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:true,markdownDescription:h(447,"When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:true,markdownDescription:h(448,"When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:true,markdownDescription:h(449,"When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:true,markdownDescription:h(450,"When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:true,markdownDescription:h(451,"When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:true,markdownDescription:h(452,"When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:true,markdownDescription:h(453,"When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:true,markdownDescription:h(454,"When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:true,markdownDescription:h(455,"When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:true,markdownDescription:h(456,"When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:true,markdownDescription:h(457,"When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:true,markdownDescription:h(458,"When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:true,markdownDescription:h(459,"When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:true,markdownDescription:h(460,"When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:true,markdownDescription:h(461,"When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:true,markdownDescription:h(462,"When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:true,markdownDescription:h(463,"When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:true,markdownDescription:h(464,"When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:true,markdownDescription:h(465,"When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:true,markdownDescription:h(466,"When enabled IntelliSense shows `issues`-suggestions.")}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;return{insertMode:mt(i.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:ee(i.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:ee(i.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:ee(i.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:ee(i.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:mt(i.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:ee(i.showIcons,this.defaultValue.showIcons),showStatusBar:ee(i.showStatusBar,this.defaultValue.showStatusBar),preview:ee(i.preview,this.defaultValue.preview),previewMode:mt(i.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:ee(i.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:ee(i.showMethods,this.defaultValue.showMethods),showFunctions:ee(i.showFunctions,this.defaultValue.showFunctions),showConstructors:ee(i.showConstructors,this.defaultValue.showConstructors),showDeprecated:ee(i.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:ee(i.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:ee(i.showFields,this.defaultValue.showFields),showVariables:ee(i.showVariables,this.defaultValue.showVariables),showClasses:ee(i.showClasses,this.defaultValue.showClasses),showStructs:ee(i.showStructs,this.defaultValue.showStructs),showInterfaces:ee(i.showInterfaces,this.defaultValue.showInterfaces),showModules:ee(i.showModules,this.defaultValue.showModules),showProperties:ee(i.showProperties,this.defaultValue.showProperties),showEvents:ee(i.showEvents,this.defaultValue.showEvents),showOperators:ee(i.showOperators,this.defaultValue.showOperators),showUnits:ee(i.showUnits,this.defaultValue.showUnits),showValues:ee(i.showValues,this.defaultValue.showValues),showConstants:ee(i.showConstants,this.defaultValue.showConstants),showEnums:ee(i.showEnums,this.defaultValue.showEnums),showEnumMembers:ee(i.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:ee(i.showKeywords,this.defaultValue.showKeywords),showWords:ee(i.showWords,this.defaultValue.showWords),showColors:ee(i.showColors,this.defaultValue.showColors),showFiles:ee(i.showFiles,this.defaultValue.showFiles),showReferences:ee(i.showReferences,this.defaultValue.showReferences),showFolders:ee(i.showFolders,this.defaultValue.showFolders),showTypeParameters:ee(i.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:ee(i.showSnippets,this.defaultValue.showSnippets),showUsers:ee(i.showUsers,this.defaultValue.showUsers),showIssues:ee(i.showIssues,this.defaultValue.showIssues)}}}class u8 extends ht{constructor(){super(N.smartSelect,"smartSelect",{selectLeadingAndTrailingWhitespace:true,selectSubwords:true},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:h(467,"Whether leading and trailing whitespace should always be selected."),default:true,type:"boolean"},"editor.smartSelect.selectSubwords":{description:h(468,"Whether subwords (like 'foo' in 'fooBar' or 'foo_bar') should be selected."),default:true,type:"boolean"}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}return{selectLeadingAndTrailingWhitespace:ee(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:ee(e.selectSubwords,this.defaultValue.selectSubwords)}}}class d8 extends ht{constructor(){const e=[];super(N.wordSegmenterLocales,"wordSegmenterLocales",e,{anyOf:[{description:h(469,"Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"string"},{description:h(469,"Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"array",items:{type:"string"}}]})}validate(e){if(typeof e==="string"){e=[e]}if(Array.isArray(e)){const i=[];for(const n of e){if(typeof n==="string"){try{if(Intl.Segmenter.supportedLocalesOf(n).length>0){i.push(n)}}catch{}}}return i}return this.defaultValue}}var er;(function(t){t[t["None"]=0]="None";t[t["Same"]=1]="Same";t[t["Indent"]=2]="Indent";t[t["DeepIndent"]=3]="DeepIndent"})(er||(er={}));class h8 extends ht{constructor(){super(N.wrappingIndent,"wrappingIndent",er.Same,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[h(470,"No indentation. Wrapped lines begin at column 1."),h(471,"Wrapped lines get the same indentation as the parent."),h(472,"Wrapped lines get +1 indentation toward the parent."),h(473,"Wrapped lines get +2 indentation toward the parent.")],description:h(474,"Controls the indentation of wrapped lines."),default:"same"}})}validate(e){switch(e){case"none":return er.None;case"same":return er.Same;case"indent":return er.Indent;case"deepIndent":return er.DeepIndent}return er.Same}compute(e,i,n){const s=i.get(N.accessibilitySupport);if(s===cr.Enabled){return er.None}return n}}class f8 extends Ua{constructor(){super(N.wrappingInfo)}compute(e,i,n){const s=i.get(N.layoutInfo);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:s.isWordWrapMinified,isViewportWrapping:s.isViewportWrapping,wrappingColumn:s.wrappingColumn}}}class p8 extends ht{constructor(){const e={enabled:true,showDropSelector:"afterDrop"};super(N.dropIntoEditor,"dropIntoEditor",e,{"editor.dropIntoEditor.enabled":{type:"boolean",default:e.enabled,markdownDescription:h(475,"Controls whether you can drag and drop a file into a text editor by holding down the `Shift` key (instead of opening the file in an editor).")},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:h(476,"Controls if a widget is shown when dropping files into the editor. This widget lets you control how the file is dropped."),enum:["afterDrop","never"],enumDescriptions:[h(477,"Show the drop selector widget after a file is dropped into the editor."),h(478,"Never show the drop selector widget. Instead the default drop provider is always used.")],default:"afterDrop"}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;return{enabled:ee(i.enabled,this.defaultValue.enabled),showDropSelector:mt(i.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}}class g8 extends ht{constructor(){const e={enabled:true,showPasteSelector:"afterPaste"};super(N.pasteAs,"pasteAs",e,{"editor.pasteAs.enabled":{type:"boolean",default:e.enabled,markdownDescription:h(479,"Controls whether you can paste content in different ways.")},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:h(480,"Controls if a widget is shown when pasting content in to the editor. This widget lets you control how the file is pasted."),enum:["afterPaste","never"],enumDescriptions:[h(481,"Show the paste selector widget after content is pasted into the editor."),h(482,"Never show the paste selector widget. Instead the default pasting behavior is always used.")],default:"afterPaste"}})}validate(e){if(!e||typeof e!=="object"){return this.defaultValue}const i=e;return{enabled:ee(i.enabled,this.defaultValue.enabled),showPasteSelector:mt(i.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}}const m8="Consolas, 'Courier New', monospace";const _8="Menlo, Monaco, 'Courier New', monospace";const v8="'Droid Sans Mono', 'monospace', monospace";const wr={fontFamily:Dn?_8:Er?v8:m8,fontWeight:"normal",fontSize:Dn?12:14,lineHeight:0,letterSpacing:0};const w8=[];function U(t){w8[t.id]=t;return t}var N;(function(t){t[t["acceptSuggestionOnCommitCharacter"]=0]="acceptSuggestionOnCommitCharacter";t[t["acceptSuggestionOnEnter"]=1]="acceptSuggestionOnEnter";t[t["accessibilitySupport"]=2]="accessibilitySupport";t[t["accessibilityPageSize"]=3]="accessibilityPageSize";t[t["ariaLabel"]=4]="ariaLabel";t[t["ariaRequired"]=5]="ariaRequired";t[t["autoClosingBrackets"]=6]="autoClosingBrackets";t[t["autoClosingComments"]=7]="autoClosingComments";t[t["screenReaderAnnounceInlineSuggestion"]=8]="screenReaderAnnounceInlineSuggestion";t[t["autoClosingDelete"]=9]="autoClosingDelete";t[t["autoClosingOvertype"]=10]="autoClosingOvertype";t[t["autoClosingQuotes"]=11]="autoClosingQuotes";t[t["autoIndent"]=12]="autoIndent";t[t["automaticLayout"]=13]="automaticLayout";t[t["autoSurround"]=14]="autoSurround";t[t["bracketPairColorization"]=15]="bracketPairColorization";t[t["guides"]=16]="guides";t[t["codeLens"]=17]="codeLens";t[t["codeLensFontFamily"]=18]="codeLensFontFamily";t[t["codeLensFontSize"]=19]="codeLensFontSize";t[t["colorDecorators"]=20]="colorDecorators";t[t["colorDecoratorsLimit"]=21]="colorDecoratorsLimit";t[t["columnSelection"]=22]="columnSelection";t[t["comments"]=23]="comments";t[t["contextmenu"]=24]="contextmenu";t[t["copyWithSyntaxHighlighting"]=25]="copyWithSyntaxHighlighting";t[t["cursorBlinking"]=26]="cursorBlinking";t[t["cursorSmoothCaretAnimation"]=27]="cursorSmoothCaretAnimation";t[t["cursorStyle"]=28]="cursorStyle";t[t["cursorSurroundingLines"]=29]="cursorSurroundingLines";t[t["cursorSurroundingLinesStyle"]=30]="cursorSurroundingLinesStyle";t[t["cursorWidth"]=31]="cursorWidth";t[t["disableLayerHinting"]=32]="disableLayerHinting";t[t["disableMonospaceOptimizations"]=33]="disableMonospaceOptimizations";t[t["domReadOnly"]=34]="domReadOnly";t[t["dragAndDrop"]=35]="dragAndDrop";t[t["dropIntoEditor"]=36]="dropIntoEditor";t[t["experimentalEditContextEnabled"]=37]="experimentalEditContextEnabled";t[t["emptySelectionClipboard"]=38]="emptySelectionClipboard";t[t["experimentalGpuAcceleration"]=39]="experimentalGpuAcceleration";t[t["experimentalWhitespaceRendering"]=40]="experimentalWhitespaceRendering";t[t["extraEditorClassName"]=41]="extraEditorClassName";t[t["fastScrollSensitivity"]=42]="fastScrollSensitivity";t[t["find"]=43]="find";t[t["fixedOverflowWidgets"]=44]="fixedOverflowWidgets";t[t["folding"]=45]="folding";t[t["foldingStrategy"]=46]="foldingStrategy";t[t["foldingHighlight"]=47]="foldingHighlight";t[t["foldingImportsByDefault"]=48]="foldingImportsByDefault";t[t["foldingMaximumRegions"]=49]="foldingMaximumRegions";t[t["unfoldOnClickAfterEndOfLine"]=50]="unfoldOnClickAfterEndOfLine";t[t["fontFamily"]=51]="fontFamily";t[t["fontInfo"]=52]="fontInfo";t[t["fontLigatures"]=53]="fontLigatures";t[t["fontSize"]=54]="fontSize";t[t["fontWeight"]=55]="fontWeight";t[t["fontVariations"]=56]="fontVariations";t[t["formatOnPaste"]=57]="formatOnPaste";t[t["formatOnType"]=58]="formatOnType";t[t["glyphMargin"]=59]="glyphMargin";t[t["gotoLocation"]=60]="gotoLocation";t[t["hideCursorInOverviewRuler"]=61]="hideCursorInOverviewRuler";t[t["hover"]=62]="hover";t[t["inDiffEditor"]=63]="inDiffEditor";t[t["inlineSuggest"]=64]="inlineSuggest";t[t["letterSpacing"]=65]="letterSpacing";t[t["lightbulb"]=66]="lightbulb";t[t["lineDecorationsWidth"]=67]="lineDecorationsWidth";t[t["lineHeight"]=68]="lineHeight";t[t["lineNumbers"]=69]="lineNumbers";t[t["lineNumbersMinChars"]=70]="lineNumbersMinChars";t[t["linkedEditing"]=71]="linkedEditing";t[t["links"]=72]="links";t[t["matchBrackets"]=73]="matchBrackets";t[t["minimap"]=74]="minimap";t[t["mouseStyle"]=75]="mouseStyle";t[t["mouseWheelScrollSensitivity"]=76]="mouseWheelScrollSensitivity";t[t["mouseWheelZoom"]=77]="mouseWheelZoom";t[t["multiCursorMergeOverlapping"]=78]="multiCursorMergeOverlapping";t[t["multiCursorModifier"]=79]="multiCursorModifier";t[t["multiCursorPaste"]=80]="multiCursorPaste";t[t["multiCursorLimit"]=81]="multiCursorLimit";t[t["occurrencesHighlight"]=82]="occurrencesHighlight";t[t["occurrencesHighlightDelay"]=83]="occurrencesHighlightDelay";t[t["overtypeCursorStyle"]=84]="overtypeCursorStyle";t[t["overtypeOnPaste"]=85]="overtypeOnPaste";t[t["overviewRulerBorder"]=86]="overviewRulerBorder";t[t["overviewRulerLanes"]=87]="overviewRulerLanes";t[t["padding"]=88]="padding";t[t["pasteAs"]=89]="pasteAs";t[t["parameterHints"]=90]="parameterHints";t[t["peekWidgetDefaultFocus"]=91]="peekWidgetDefaultFocus";t[t["placeholder"]=92]="placeholder";t[t["definitionLinkOpensInPeek"]=93]="definitionLinkOpensInPeek";t[t["quickSuggestions"]=94]="quickSuggestions";t[t["quickSuggestionsDelay"]=95]="quickSuggestionsDelay";t[t["readOnly"]=96]="readOnly";t[t["readOnlyMessage"]=97]="readOnlyMessage";t[t["renameOnType"]=98]="renameOnType";t[t["renderControlCharacters"]=99]="renderControlCharacters";t[t["renderFinalNewline"]=100]="renderFinalNewline";t[t["renderLineHighlight"]=101]="renderLineHighlight";t[t["renderLineHighlightOnlyWhenFocus"]=102]="renderLineHighlightOnlyWhenFocus";t[t["renderValidationDecorations"]=103]="renderValidationDecorations";t[t["renderWhitespace"]=104]="renderWhitespace";t[t["revealHorizontalRightPadding"]=105]="revealHorizontalRightPadding";t[t["roundedSelection"]=106]="roundedSelection";t[t["rulers"]=107]="rulers";t[t["scrollbar"]=108]="scrollbar";t[t["scrollBeyondLastColumn"]=109]="scrollBeyondLastColumn";t[t["scrollBeyondLastLine"]=110]="scrollBeyondLastLine";t[t["scrollPredominantAxis"]=111]="scrollPredominantAxis";t[t["selectionClipboard"]=112]="selectionClipboard";t[t["selectionHighlight"]=113]="selectionHighlight";t[t["selectOnLineNumbers"]=114]="selectOnLineNumbers";t[t["showFoldingControls"]=115]="showFoldingControls";t[t["showUnused"]=116]="showUnused";t[t["snippetSuggestions"]=117]="snippetSuggestions";t[t["smartSelect"]=118]="smartSelect";t[t["smoothScrolling"]=119]="smoothScrolling";t[t["stickyScroll"]=120]="stickyScroll";t[t["stickyTabStops"]=121]="stickyTabStops";t[t["stopRenderingLineAfter"]=122]="stopRenderingLineAfter";t[t["suggest"]=123]="suggest";t[t["suggestFontSize"]=124]="suggestFontSize";t[t["suggestLineHeight"]=125]="suggestLineHeight";t[t["suggestOnTriggerCharacters"]=126]="suggestOnTriggerCharacters";t[t["suggestSelection"]=127]="suggestSelection";t[t["tabCompletion"]=128]="tabCompletion";t[t["tabIndex"]=129]="tabIndex";t[t["unicodeHighlighting"]=130]="unicodeHighlighting";t[t["unusualLineTerminators"]=131]="unusualLineTerminators";t[t["useShadowDOM"]=132]="useShadowDOM";t[t["useTabStops"]=133]="useTabStops";t[t["wordBreak"]=134]="wordBreak";t[t["wordSegmenterLocales"]=135]="wordSegmenterLocales";t[t["wordSeparators"]=136]="wordSeparators";t[t["wordWrap"]=137]="wordWrap";t[t["wordWrapBreakAfterCharacters"]=138]="wordWrapBreakAfterCharacters";t[t["wordWrapBreakBeforeCharacters"]=139]="wordWrapBreakBeforeCharacters";t[t["wordWrapColumn"]=140]="wordWrapColumn";t[t["wordWrapOverride1"]=141]="wordWrapOverride1";t[t["wordWrapOverride2"]=142]="wordWrapOverride2";t[t["wrappingIndent"]=143]="wrappingIndent";t[t["wrappingStrategy"]=144]="wrappingStrategy";t[t["showDeprecated"]=145]="showDeprecated";t[t["inlayHints"]=146]="inlayHints";t[t["effectiveCursorStyle"]=147]="effectiveCursorStyle";t[t["editorClassName"]=148]="editorClassName";t[t["pixelRatio"]=149]="pixelRatio";t[t["tabFocusMode"]=150]="tabFocusMode";t[t["layoutInfo"]=151]="layoutInfo";t[t["wrappingInfo"]=152]="wrappingInfo";t[t["defaultColorDecorators"]=153]="defaultColorDecorators";t[t["colorDecoratorsActivatedOn"]=154]="colorDecoratorsActivatedOn";t[t["inlineCompletionsAccessibilityVerbose"]=155]="inlineCompletionsAccessibilityVerbose";t[t["effectiveExperimentalEditContextEnabled"]=156]="effectiveExperimentalEditContextEnabled"})(N||(N={}));({acceptSuggestionOnCommitCharacter:U(new Ae(N.acceptSuggestionOnCommitCharacter,"acceptSuggestionOnCommitCharacter",true,{markdownDescription:h(483,"Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),acceptSuggestionOnEnter:U(new ft(N.acceptSuggestionOnEnter,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",h(484,"Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:h(485,"Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),accessibilitySupport:U(new PA),accessibilityPageSize:U(new Qe(N.accessibilityPageSize,"accessibilityPageSize",500,1,Ui.MAX_SAFE_SMALL_INTEGER,{description:h(486,"Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default."),tags:["accessibility"]})),ariaLabel:U(new Ni(N.ariaLabel,"ariaLabel",h(487,"Editor content"))),ariaRequired:U(new Ae(N.ariaRequired,"ariaRequired",false,void 0)),screenReaderAnnounceInlineSuggestion:U(new Ae(N.screenReaderAnnounceInlineSuggestion,"screenReaderAnnounceInlineSuggestion",true,{description:h(488,"Control whether inline suggestions are announced by a screen reader."),tags:["accessibility"]})),autoClosingBrackets:U(new ft(N.autoClosingBrackets,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",h(489,"Use language configurations to determine when to autoclose brackets."),h(490,"Autoclose brackets only when the cursor is to the left of whitespace."),""],description:h(491,"Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),autoClosingComments:U(new ft(N.autoClosingComments,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",h(492,"Use language configurations to determine when to autoclose comments."),h(493,"Autoclose comments only when the cursor is to the left of whitespace."),""],description:h(494,"Controls whether the editor should automatically close comments after the user adds an opening comment.")})),autoClosingDelete:U(new ft(N.autoClosingDelete,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",h(495,"Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:h(496,"Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),autoClosingOvertype:U(new ft(N.autoClosingOvertype,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",h(497,"Type over closing quotes or brackets only if they were automatically inserted."),""],description:h(498,"Controls whether the editor should type over closing quotes or brackets.")})),autoClosingQuotes:U(new ft(N.autoClosingQuotes,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",h(499,"Use language configurations to determine when to autoclose quotes."),h(500,"Autoclose quotes only when the cursor is to the left of whitespace."),""],description:h(501,"Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),autoIndent:U(new qc(N.autoIndent,"autoIndent",Qr.Full,"full",["none","keep","brackets","advanced","full"],TA,{enumDescriptions:[h(502,"The editor will not insert indentation automatically."),h(503,"The editor will keep the current line's indentation."),h(504,"The editor will keep the current line's indentation and honor language defined brackets."),h(505,"The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),h(506,"The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:h(507,"Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),automaticLayout:U(new Ae(N.automaticLayout,"automaticLayout",false)),autoSurround:U(new ft(N.autoSurround,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[h(508,"Use language configurations to determine when to automatically surround selections."),h(509,"Surround with quotes but not brackets."),h(510,"Surround with brackets but not quotes."),""],description:h(511,"Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),bracketPairColorization:U(new a8),bracketPairGuides:U(new l8),stickyTabStops:U(new Ae(N.stickyTabStops,"stickyTabStops",false,{description:h(512,"Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),codeLens:U(new Ae(N.codeLens,"codeLens",true,{description:h(513,"Controls whether the editor shows CodeLens.")})),codeLensFontFamily:U(new Ni(N.codeLensFontFamily,"codeLensFontFamily","",{description:h(514,"Controls the font family for CodeLens.")})),codeLensFontSize:U(new Qe(N.codeLensFontSize,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:h(515,"Controls the font size in pixels for CodeLens. When set to 0, 90% of `#editor.fontSize#` is used.")})),colorDecorators:U(new Ae(N.colorDecorators,"colorDecorators",true,{description:h(516,"Controls whether the editor should render the inline color decorators and color picker.")})),colorDecoratorActivatedOn:U(new ft(N.colorDecoratorsActivatedOn,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[h(517,"Make the color picker appear both on click and hover of the color decorator"),h(518,"Make the color picker appear on hover of the color decorator"),h(519,"Make the color picker appear on click of the color decorator")],description:h(520,"Controls the condition to make a color picker appear from a color decorator.")})),colorDecoratorsLimit:U(new Qe(N.colorDecoratorsLimit,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:h(521,"Controls the max number of color decorators that can be rendered in an editor at once.")})),columnSelection:U(new Ae(N.columnSelection,"columnSelection",false,{description:h(522,"Enable that the selection with the mouse and keys is doing column selection.")})),comments:U(new AA),contextmenu:U(new Ae(N.contextmenu,"contextmenu",true)),copyWithSyntaxHighlighting:U(new Ae(N.copyWithSyntaxHighlighting,"copyWithSyntaxHighlighting",true,{description:h(523,"Controls whether syntax highlighting should be copied into the clipboard.")})),cursorBlinking:U(new qc(N.cursorBlinking,"cursorBlinking",Jr.Blink,"blink",["blink","smooth","phase","expand","solid"],RA,{description:h(524,"Control the cursor animation style.")})),cursorSmoothCaretAnimation:U(new ft(N.cursorSmoothCaretAnimation,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[h(525,"Smooth caret animation is disabled."),h(526,"Smooth caret animation is enabled only when the user moves the cursor with an explicit gesture."),h(527,"Smooth caret animation is always enabled.")],description:h(528,"Controls whether the smooth caret animation should be enabled.")})),cursorStyle:U(new qc(N.cursorStyle,"cursorStyle",ts.Line,"line",["line","block","underline","line-thin","block-outline","underline-thin"],Kx,{description:h(529,"Controls the cursor style in insert input mode.")})),overtypeCursorStyle:U(new qc(N.overtypeCursorStyle,"overtypeCursorStyle",ts.Block,"block",["line","block","underline","line-thin","block-outline","underline-thin"],Kx,{description:h(530,"Controls the cursor style in overtype input mode.")})),cursorSurroundingLines:U(new Qe(N.cursorSurroundingLines,"cursorSurroundingLines",0,0,Ui.MAX_SAFE_SMALL_INTEGER,{description:h(531,"Controls the minimal number of visible leading lines (minimum 0) and trailing lines (minimum 1) surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),cursorSurroundingLinesStyle:U(new ft(N.cursorSurroundingLinesStyle,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[h(532,"`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),h(533,"`cursorSurroundingLines` is enforced always.")],markdownDescription:h(534,"Controls when `#editor.cursorSurroundingLines#` should be enforced.")})),cursorWidth:U(new Qe(N.cursorWidth,"cursorWidth",0,0,Ui.MAX_SAFE_SMALL_INTEGER,{markdownDescription:h(535,"Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),disableLayerHinting:U(new Ae(N.disableLayerHinting,"disableLayerHinting",false)),disableMonospaceOptimizations:U(new Ae(N.disableMonospaceOptimizations,"disableMonospaceOptimizations",false)),domReadOnly:U(new Ae(N.domReadOnly,"domReadOnly",false)),dragAndDrop:U(new Ae(N.dragAndDrop,"dragAndDrop",true,{description:h(536,"Controls whether the editor should allow moving selections via drag and drop.")})),emptySelectionClipboard:U(new NA),dropIntoEditor:U(new p8),experimentalEditContextEnabled:U(new Ae(N.experimentalEditContextEnabled,"experimentalEditContextEnabled",DA.quality!=="stable",{description:h(537,"Sets whether the new experimental edit context should be used instead of the text area."),included:y0||tI||Yk})),stickyScroll:U(new zA),experimentalGpuAcceleration:U(new ft(N.experimentalGpuAcceleration,"experimentalGpuAcceleration","off",["off","on"],{tags:["experimental"],enumDescriptions:[h(538,"Use regular DOM-based rendering."),h(539,"Use GPU acceleration.")],description:h(540,"Controls whether to use the experimental GPU acceleration to render the editor.")})),experimentalWhitespaceRendering:U(new ft(N.experimentalWhitespaceRendering,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[h(541,"Use a new rendering method with svgs."),h(542,"Use a new rendering method with font characters."),h(543,"Use the stable rendering method.")],description:h(544,"Controls whether whitespace is rendered with a new, experimental method.")})),extraEditorClassName:U(new Ni(N.extraEditorClassName,"extraEditorClassName","")),fastScrollSensitivity:U(new Nn(N.fastScrollSensitivity,"fastScrollSensitivity",5,t=>t<=0?5:t,{markdownDescription:h(545,"Scrolling speed multiplier when pressing `Alt`.")})),find:U(new OA),fixedOverflowWidgets:U(new Ae(N.fixedOverflowWidgets,"fixedOverflowWidgets",false)),folding:U(new Ae(N.folding,"folding",true,{description:h(546,"Controls whether the editor has code folding enabled.")})),foldingStrategy:U(new ft(N.foldingStrategy,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[h(547,"Use a language-specific folding strategy if available, else the indentation-based one."),h(548,"Use the indentation-based folding strategy.")],description:h(549,"Controls the strategy for computing folding ranges.")})),foldingHighlight:U(new Ae(N.foldingHighlight,"foldingHighlight",true,{description:h(550,"Controls whether the editor should highlight folded ranges.")})),foldingImportsByDefault:U(new Ae(N.foldingImportsByDefault,"foldingImportsByDefault",false,{description:h(551,"Controls whether the editor automatically collapses import ranges.")})),foldingMaximumRegions:U(new Qe(N.foldingMaximumRegions,"foldingMaximumRegions",5e3,10,65e3,{description:h(552,"The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.")})),unfoldOnClickAfterEndOfLine:U(new Ae(N.unfoldOnClickAfterEndOfLine,"unfoldOnClickAfterEndOfLine",false,{description:h(553,"Controls whether clicking on the empty content after a folded line will unfold the line.")})),fontFamily:U(new Ni(N.fontFamily,"fontFamily",wr.fontFamily,{description:h(554,"Controls the font family.")})),fontInfo:U(new FA),fontLigatures2:U(new Oo),fontSize:U(new $A),fontWeight:U(new Mo),fontVariations:U(new Fo),formatOnPaste:U(new Ae(N.formatOnPaste,"formatOnPaste",false,{description:h(555,"Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),formatOnType:U(new Ae(N.formatOnType,"formatOnType",false,{description:h(556,"Controls whether the editor should automatically format the line after typing.")})),glyphMargin:U(new Ae(N.glyphMargin,"glyphMargin",true,{description:h(557,"Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),gotoLocation:U(new HA),hideCursorInOverviewRuler:U(new Ae(N.hideCursorInOverviewRuler,"hideCursorInOverviewRuler",false,{description:h(558,"Controls whether the cursor should be hidden in the overview ruler.")})),hover:U(new BA),inDiffEditor:U(new Ae(N.inDiffEditor,"inDiffEditor",false)),letterSpacing:U(new Nn(N.letterSpacing,"letterSpacing",wr.letterSpacing,t=>Nn.clamp(t,-5,20),{description:h(559,"Controls the letter spacing in pixels.")})),lightbulb:U(new WA),lineDecorationsWidth:U(new jA),lineHeight:U(new GA),lineNumbers:U(new t8),lineNumbersMinChars:U(new Qe(N.lineNumbersMinChars,"lineNumbersMinChars",5,1,300)),linkedEditing:U(new Ae(N.linkedEditing,"linkedEditing",false,{description:h(560,"Controls whether the editor has linked editing enabled. Depending on the language, related symbols such as HTML tags, are updated while editing.")})),links:U(new Ae(N.links,"links",true,{description:h(561,"Controls whether the editor should detect links and make them clickable.")})),matchBrackets:U(new ft(N.matchBrackets,"matchBrackets","always",["always","near","never"],{description:h(562,"Highlight matching brackets.")})),minimap:U(new KA),mouseStyle:U(new ft(N.mouseStyle,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:U(new Nn(N.mouseWheelScrollSensitivity,"mouseWheelScrollSensitivity",1,t=>t===0?1:t,{markdownDescription:h(563,"A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),mouseWheelZoom:U(new Ae(N.mouseWheelZoom,"mouseWheelZoom",false,{markdownDescription:Dn?h(564,"Zoom the font of the editor when using mouse wheel and holding `Cmd`."):h(565,"Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),multiCursorMergeOverlapping:U(new Ae(N.multiCursorMergeOverlapping,"multiCursorMergeOverlapping",true,{description:h(566,"Merge multiple cursors when they are overlapping.")})),multiCursorModifier:U(new qc(N.multiCursorModifier,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],QA,{markdownEnumDescriptions:[h(567,"Maps to `Control` on Windows and Linux and to `Command` on macOS."),h(568,"Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:h(569,"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the [multicursor modifier](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),multiCursorPaste:U(new ft(N.multiCursorPaste,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[h(570,"Each cursor pastes a single line of the text."),h(571,"Each cursor pastes the full text.")],markdownDescription:h(572,"Controls pasting when the line count of the pasted text matches the cursor count.")})),multiCursorLimit:U(new Qe(N.multiCursorLimit,"multiCursorLimit",1e4,1,1e5,{markdownDescription:h(573,"Controls the max number of cursors that can be in an active editor at once.")})),occurrencesHighlight:U(new ft(N.occurrencesHighlight,"occurrencesHighlight","singleFile",["off","singleFile","multiFile"],{markdownEnumDescriptions:[h(574,"Does not highlight occurrences."),h(575,"Highlights occurrences only in the current file."),h(576,"Experimental: Highlights occurrences across all valid open files.")],markdownDescription:h(577,"Controls whether occurrences should be highlighted across open files.")})),occurrencesHighlightDelay:U(new Qe(N.occurrencesHighlightDelay,"occurrencesHighlightDelay",0,0,2e3,{description:h(578,"Controls the delay in milliseconds after which occurrences are highlighted."),tags:["preview"]})),overtypeOnPaste:U(new Ae(N.overtypeOnPaste,"overtypeOnPaste",true,{description:h(579,"Controls whether pasting should overtype.")})),overviewRulerBorder:U(new Ae(N.overviewRulerBorder,"overviewRulerBorder",true,{description:h(580,"Controls whether a border should be drawn around the overview ruler.")})),overviewRulerLanes:U(new Qe(N.overviewRulerLanes,"overviewRulerLanes",3,0,3)),padding:U(new JA),pasteAs:U(new g8),parameterHints:U(new XA),peekWidgetDefaultFocus:U(new ft(N.peekWidgetDefaultFocus,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[h(581,"Focus the tree when opening peek"),h(582,"Focus the editor when opening peek")],description:h(583,"Controls whether to focus the inline editor or the tree in the peek widget.")})),placeholder:U(new ZA),definitionLinkOpensInPeek:U(new Ae(N.definitionLinkOpensInPeek,"definitionLinkOpensInPeek",false,{description:h(584,"Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),quickSuggestions:U(new e8),quickSuggestionsDelay:U(new Qe(N.quickSuggestionsDelay,"quickSuggestionsDelay",10,0,Ui.MAX_SAFE_SMALL_INTEGER,{description:h(585,"Controls the delay in milliseconds after which quick suggestions will show up.")})),readOnly:U(new Ae(N.readOnly,"readOnly",false)),readOnlyMessage:U(new n8),renameOnType:U(new Ae(N.renameOnType,"renameOnType",false,{description:h(586,"Controls whether the editor auto renames on type."),markdownDeprecationMessage:h(587,"Deprecated, use `editor.linkedEditing` instead.")})),renderControlCharacters:U(new Ae(N.renderControlCharacters,"renderControlCharacters",true,{description:h(588,"Controls whether the editor should render control characters."),restricted:true})),renderFinalNewline:U(new ft(N.renderFinalNewline,"renderFinalNewline",Er?"dimmed":"on",["off","on","dimmed"],{description:h(589,"Render last line number when the file ends with a newline.")})),renderLineHighlight:U(new ft(N.renderLineHighlight,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",h(590,"Highlights both the gutter and the current line.")],description:h(591,"Controls how the editor should render the current line highlight.")})),renderLineHighlightOnlyWhenFocus:U(new Ae(N.renderLineHighlightOnlyWhenFocus,"renderLineHighlightOnlyWhenFocus",false,{description:h(592,"Controls if the editor should render the current line highlight only when the editor is focused.")})),renderValidationDecorations:U(new ft(N.renderValidationDecorations,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:U(new ft(N.renderWhitespace,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",h(593,"Render whitespace characters except for single spaces between words."),h(594,"Render whitespace characters only on selected text."),h(595,"Render only trailing whitespace characters."),""],description:h(596,"Controls how the editor should render whitespace characters.")})),revealHorizontalRightPadding:U(new Qe(N.revealHorizontalRightPadding,"revealHorizontalRightPadding",15,0,1e3)),roundedSelection:U(new Ae(N.roundedSelection,"roundedSelection",true,{description:h(597,"Controls whether selections should have rounded corners.")})),rulers:U(new i8),scrollbar:U(new s8),scrollBeyondLastColumn:U(new Qe(N.scrollBeyondLastColumn,"scrollBeyondLastColumn",4,0,Ui.MAX_SAFE_SMALL_INTEGER,{description:h(598,"Controls the number of extra characters beyond which the editor will scroll horizontally.")})),scrollBeyondLastLine:U(new Ae(N.scrollBeyondLastLine,"scrollBeyondLastLine",true,{description:h(599,"Controls whether the editor will scroll beyond the last line.")})),scrollPredominantAxis:U(new Ae(N.scrollPredominantAxis,"scrollPredominantAxis",true,{description:h(600,"Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),selectionClipboard:U(new Ae(N.selectionClipboard,"selectionClipboard",true,{description:h(601,"Controls whether the Linux primary clipboard should be supported."),included:Er})),selectionHighlight:U(new Ae(N.selectionHighlight,"selectionHighlight",true,{description:h(602,"Controls whether the editor should highlight matches similar to the selection.")})),selectOnLineNumbers:U(new Ae(N.selectOnLineNumbers,"selectOnLineNumbers",true)),showFoldingControls:U(new ft(N.showFoldingControls,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[h(603,"Always show the folding controls."),h(604,"Never show the folding controls and reduce the gutter size."),h(605,"Only show the folding controls when the mouse is over the gutter.")],description:h(606,"Controls when the folding controls on the gutter are shown.")})),showUnused:U(new Ae(N.showUnused,"showUnused",true,{description:h(607,"Controls fading out of unused code.")})),showDeprecated:U(new Ae(N.showDeprecated,"showDeprecated",true,{description:h(608,"Controls strikethrough deprecated variables.")})),inlayHints:U(new qA),snippetSuggestions:U(new ft(N.snippetSuggestions,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[h(609,"Show snippet suggestions on top of other suggestions."),h(610,"Show snippet suggestions below other suggestions."),h(611,"Show snippets suggestions with other suggestions."),h(612,"Do not show snippet suggestions.")],description:h(613,"Controls whether snippets are shown with other suggestions and how they are sorted.")})),smartSelect:U(new u8),smoothScrolling:U(new Ae(N.smoothScrolling,"smoothScrolling",false,{description:h(614,"Controls whether the editor will scroll using an animation.")})),stopRenderingLineAfter:U(new Qe(N.stopRenderingLineAfter,"stopRenderingLineAfter",1e4,-1,Ui.MAX_SAFE_SMALL_INTEGER)),suggest:U(new c8),inlineSuggest:U(new o8),inlineCompletionsAccessibilityVerbose:U(new Ae(N.inlineCompletionsAccessibilityVerbose,"inlineCompletionsAccessibilityVerbose",false,{description:h(615,"Controls whether the accessibility hint should be provided to screen reader users when an inline completion is shown.")})),suggestFontSize:U(new Qe(N.suggestFontSize,"suggestFontSize",0,0,1e3,{markdownDescription:h(616,"Font size for the suggest widget. When set to {0}, the value of {1} is used.","`0`","`#editor.fontSize#`")})),suggestLineHeight:U(new Qe(N.suggestLineHeight,"suggestLineHeight",0,0,1e3,{markdownDescription:h(617,"Line height for the suggest widget. When set to {0}, the value of {1} is used. The minimum value is 8.","`0`","`#editor.lineHeight#`")})),suggestOnTriggerCharacters:U(new Ae(N.suggestOnTriggerCharacters,"suggestOnTriggerCharacters",true,{description:h(618,"Controls whether suggestions should automatically show up when typing trigger characters.")})),suggestSelection:U(new ft(N.suggestSelection,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[h(619,"Always select the first suggestion."),h(620,"Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),h(621,"Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:h(622,"Controls how suggestions are pre-selected when showing the suggest list.")})),tabCompletion:U(new ft(N.tabCompletion,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[h(623,"Tab complete will insert the best matching suggestion when pressing tab."),h(624,"Disable tab completions."),h(625,"Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:h(626,"Enables tab completions.")})),tabIndex:U(new Qe(N.tabIndex,"tabIndex",0,-1,Ui.MAX_SAFE_SMALL_INTEGER)),unicodeHighlight:U(new r8),unusualLineTerminators:U(new ft(N.unusualLineTerminators,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[h(627,"Unusual line terminators are automatically removed."),h(628,"Unusual line terminators are ignored."),h(629,"Unusual line terminators prompt to be removed.")],description:h(630,"Remove unusual line terminators that might cause problems.")})),useShadowDOM:U(new Ae(N.useShadowDOM,"useShadowDOM",true)),useTabStops:U(new Ae(N.useTabStops,"useTabStops",true,{description:h(631,"Spaces and tabs are inserted and deleted in alignment with tab stops.")})),wordBreak:U(new ft(N.wordBreak,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[h(632,"Use the default line break rule."),h(633,"Word breaks should not be used for Chinese/Japanese/Korean (CJK) text. Non-CJK text behavior is the same as for normal.")],description:h(634,"Controls the word break rules used for Chinese/Japanese/Korean (CJK) text.")})),wordSegmenterLocales:U(new d8),wordSeparators:U(new Ni(N.wordSeparators,"wordSeparators",XI,{description:h(635,"Characters that will be used as word separators when doing word related navigations or operations.")})),wordWrap:U(new ft(N.wordWrap,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[h(636,"Lines will never wrap."),h(637,"Lines will wrap at the viewport width."),h(638,"Lines will wrap at `#editor.wordWrapColumn#`."),h(639,"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:h(640,"Controls how lines should wrap.")})),wordWrapBreakAfterCharacters:U(new Ni(N.wordWrapBreakAfterCharacters,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;")),wordWrapBreakBeforeCharacters:U(new Ni(N.wordWrapBreakBeforeCharacters,"wordWrapBreakBeforeCharacters","([{+")),wordWrapColumn:U(new Qe(N.wordWrapColumn,"wordWrapColumn",80,1,Ui.MAX_SAFE_SMALL_INTEGER,{markdownDescription:h(641,"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),wordWrapOverride1:U(new ft(N.wordWrapOverride1,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:U(new ft(N.wordWrapOverride2,"wordWrapOverride2","inherit",["off","on","inherit"])),effectiveCursorStyle:U(new MA),editorClassName:U(new LA),defaultColorDecorators:U(new ft(N.defaultColorDecorators,"defaultColorDecorators","auto",["auto","always","never"],{enumDescriptions:[h(642,"Show default color decorators only when no extension provides colors decorators."),h(643,"Always show default color decorators."),h(644,"Never show default color decorators.")],description:h(645,"Controls whether inline color decorations should be shown using the default document color provider.")})),pixelRatio:U(new YA),tabFocusMode:U(new Ae(N.tabFocusMode,"tabFocusMode",false,{markdownDescription:h(646,"Controls whether the editor receives tabs or defers them to the workbench for navigation.")})),layoutInfo:U(new vu),wrappingInfo:U(new f8),wrappingIndent:U(new h8),wrappingStrategy:U(new VA),effectiveExperimentalEditContextEnabled:U(new UA)});let En=class Io{constructor(e,i){this.lineNumber=e;this.column=i}with(e=this.lineNumber,i=this.column){if(e===this.lineNumber&&i===this.column){return this}else{return new Io(e,i)}}delta(e=0,i=0){return this.with(Math.max(1,this.lineNumber+e),Math.max(1,this.column+i))}equals(e){return Io.equals(this,e)}static equals(e,i){if(!e&&!i){return true}return!!e&&!!i&&e.lineNumber===i.lineNumber&&e.column===i.column}isBefore(e){return Io.isBefore(this,e)}static isBefore(e,i){if(e.lineNumber<i.lineNumber){return true}if(i.lineNumber<e.lineNumber){return false}return e.column<i.column}isBeforeOrEqual(e){return Io.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,i){if(e.lineNumber<i.lineNumber){return true}if(i.lineNumber<e.lineNumber){return false}return e.column<=i.column}static compare(e,i){const n=e.lineNumber|0;const s=i.lineNumber|0;if(n===s){const r=e.column|0;const o=i.column|0;return r-o}return n-s}clone(){return new Io(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new Io(e.lineNumber,e.column)}static isIPosition(e){return e&&typeof e.lineNumber==="number"&&typeof e.column==="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}};let et=class ii{constructor(e,i,n,s){if(e>n||e===n&&i>s){this.startLineNumber=n;this.startColumn=s;this.endLineNumber=e;this.endColumn=i}else{this.startLineNumber=e;this.startColumn=i;this.endLineNumber=n;this.endColumn=s}}isEmpty(){return ii.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return ii.containsPosition(this,e)}static containsPosition(e,i){if(i.lineNumber<e.startLineNumber||i.lineNumber>e.endLineNumber){return false}if(i.lineNumber===e.startLineNumber&&i.column<e.startColumn){return false}if(i.lineNumber===e.endLineNumber&&i.column>e.endColumn){return false}return true}static strictContainsPosition(e,i){if(i.lineNumber<e.startLineNumber||i.lineNumber>e.endLineNumber){return false}if(i.lineNumber===e.startLineNumber&&i.column<=e.startColumn){return false}if(i.lineNumber===e.endLineNumber&&i.column>=e.endColumn){return false}return true}containsRange(e){return ii.containsRange(this,e)}static containsRange(e,i){if(i.startLineNumber<e.startLineNumber||i.endLineNumber<e.startLineNumber){return false}if(i.startLineNumber>e.endLineNumber||i.endLineNumber>e.endLineNumber){return false}if(i.startLineNumber===e.startLineNumber&&i.startColumn<e.startColumn){return false}if(i.endLineNumber===e.endLineNumber&&i.endColumn>e.endColumn){return false}return true}strictContainsRange(e){return ii.strictContainsRange(this,e)}static strictContainsRange(e,i){if(i.startLineNumber<e.startLineNumber||i.endLineNumber<e.startLineNumber){return false}if(i.startLineNumber>e.endLineNumber||i.endLineNumber>e.endLineNumber){return false}if(i.startLineNumber===e.startLineNumber&&i.startColumn<=e.startColumn){return false}if(i.endLineNumber===e.endLineNumber&&i.endColumn>=e.endColumn){return false}return true}plusRange(e){return ii.plusRange(this,e)}static plusRange(e,i){let n;let s;let r;let o;if(i.startLineNumber<e.startLineNumber){n=i.startLineNumber;s=i.startColumn}else if(i.startLineNumber===e.startLineNumber){n=i.startLineNumber;s=Math.min(i.startColumn,e.startColumn)}else{n=e.startLineNumber;s=e.startColumn}if(i.endLineNumber>e.endLineNumber){r=i.endLineNumber;o=i.endColumn}else if(i.endLineNumber===e.endLineNumber){r=i.endLineNumber;o=Math.max(i.endColumn,e.endColumn)}else{r=e.endLineNumber;o=e.endColumn}return new ii(n,s,r,o)}intersectRanges(e){return ii.intersectRanges(this,e)}static intersectRanges(e,i){let n=e.startLineNumber;let s=e.startColumn;let r=e.endLineNumber;let o=e.endColumn;const a=i.startLineNumber;const l=i.startColumn;const c=i.endLineNumber;const u=i.endColumn;if(n<a){n=a;s=l}else if(n===a){s=Math.max(s,l)}if(r>c){r=c;o=u}else if(r===c){o=Math.min(o,u)}if(n>r){return null}if(n===r&&s>o){return null}return new ii(n,s,r,o)}equalsRange(e){return ii.equalsRange(this,e)}static equalsRange(e,i){if(!e&&!i){return true}return!!e&&!!i&&e.startLineNumber===i.startLineNumber&&e.startColumn===i.startColumn&&e.endLineNumber===i.endLineNumber&&e.endColumn===i.endColumn}getEndPosition(){return ii.getEndPosition(this)}static getEndPosition(e){return new En(e.endLineNumber,e.endColumn)}getStartPosition(){return ii.getStartPosition(this)}static getStartPosition(e){return new En(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,i){return new ii(this.startLineNumber,this.startColumn,e,i)}setStartPosition(e,i){return new ii(e,i,this.endLineNumber,this.endColumn)}collapseToStart(){return ii.collapseToStart(this)}static collapseToStart(e){return new ii(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}collapseToEnd(){return ii.collapseToEnd(this)}static collapseToEnd(e){return new ii(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)}delta(e){return new ii(this.startLineNumber+e,this.startColumn,this.endLineNumber+e,this.endColumn)}isSingleLine(){return this.startLineNumber===this.endLineNumber}static fromPositions(e,i=e){return new ii(e.lineNumber,e.column,i.lineNumber,i.column)}static lift(e){if(!e){return null}return new ii(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn)}static isIRange(e){return e&&typeof e.startLineNumber==="number"&&typeof e.startColumn==="number"&&typeof e.endLineNumber==="number"&&typeof e.endColumn==="number"}static areIntersectingOrTouching(e,i){if(e.endLineNumber<i.startLineNumber||e.endLineNumber===i.startLineNumber&&e.endColumn<i.startColumn){return false}if(i.endLineNumber<e.startLineNumber||i.endLineNumber===e.startLineNumber&&i.endColumn<e.startColumn){return false}return true}static areIntersecting(e,i){if(e.endLineNumber<i.startLineNumber||e.endLineNumber===i.startLineNumber&&e.endColumn<=i.startColumn){return false}if(i.endLineNumber<e.startLineNumber||i.endLineNumber===e.startLineNumber&&i.endColumn<=e.startColumn){return false}return true}static areOnlyIntersecting(e,i){if(e.endLineNumber<i.startLineNumber-1||e.endLineNumber===i.startLineNumber&&e.endColumn<i.startColumn-1){return false}if(i.endLineNumber<e.startLineNumber-1||i.endLineNumber===e.startLineNumber&&i.endColumn<e.startColumn-1){return false}return true}static compareRangesUsingStarts(e,i){if(e&&i){const r=e.startLineNumber|0;const o=i.startLineNumber|0;if(r===o){const a=e.startColumn|0;const l=i.startColumn|0;if(a===l){const c=e.endLineNumber|0;const u=i.endLineNumber|0;if(c===u){const d=e.endColumn|0;const p=i.endColumn|0;return d-p}return c-u}return a-l}return r-o}const n=e?1:0;const s=i?1:0;return n-s}static compareRangesUsingEnds(e,i){if(e.endLineNumber===i.endLineNumber){if(e.endColumn===i.endColumn){if(e.startLineNumber===i.startLineNumber){return e.startColumn-i.startColumn}return e.startLineNumber-i.startLineNumber}return e.endColumn-i.endColumn}return e.endLineNumber-i.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}};var Jx;(function(t){t[t["Null"]=0]="Null";t[t["PlainText"]=1]="PlainText"})(Jx||(Jx={}));var Xx;(function(t){t[t["NotSet"]=-1]="NotSet";t[t["None"]=0]="None";t[t["Italic"]=1]="Italic";t[t["Bold"]=2]="Bold";t[t["Underline"]=4]="Underline";t[t["Strikethrough"]=8]="Strikethrough"})(Xx||(Xx={}));var Kf;(function(t){t[t["None"]=0]="None";t[t["DefaultForeground"]=1]="DefaultForeground";t[t["DefaultBackground"]=2]="DefaultBackground"})(Kf||(Kf={}));var ll;(function(t){t[t["Other"]=0]="Other";t[t["Comment"]=1]="Comment";t[t["String"]=2]="String";t[t["RegEx"]=3]="RegEx"})(ll||(ll={}));var Yx;(function(t){t[t["LANGUAGEID_MASK"]=255]="LANGUAGEID_MASK";t[t["TOKEN_TYPE_MASK"]=768]="TOKEN_TYPE_MASK";t[t["BALANCED_BRACKETS_MASK"]=1024]="BALANCED_BRACKETS_MASK";t[t["FONT_STYLE_MASK"]=30720]="FONT_STYLE_MASK";t[t["FOREGROUND_MASK"]=16744448]="FOREGROUND_MASK";t[t["BACKGROUND_MASK"]=4278190080]="BACKGROUND_MASK";t[t["ITALIC_MASK"]=2048]="ITALIC_MASK";t[t["BOLD_MASK"]=4096]="BOLD_MASK";t[t["UNDERLINE_MASK"]=8192]="UNDERLINE_MASK";t[t["STRIKETHROUGH_MASK"]=16384]="STRIKETHROUGH_MASK";t[t["SEMANTIC_USE_ITALIC"]=1]="SEMANTIC_USE_ITALIC";t[t["SEMANTIC_USE_BOLD"]=2]="SEMANTIC_USE_BOLD";t[t["SEMANTIC_USE_UNDERLINE"]=4]="SEMANTIC_USE_UNDERLINE";t[t["SEMANTIC_USE_STRIKETHROUGH"]=8]="SEMANTIC_USE_STRIKETHROUGH";t[t["SEMANTIC_USE_FOREGROUND"]=16]="SEMANTIC_USE_FOREGROUND";t[t["SEMANTIC_USE_BACKGROUND"]=32]="SEMANTIC_USE_BACKGROUND";t[t["LANGUAGEID_OFFSET"]=0]="LANGUAGEID_OFFSET";t[t["TOKEN_TYPE_OFFSET"]=8]="TOKEN_TYPE_OFFSET";t[t["BALANCED_BRACKETS_OFFSET"]=10]="BALANCED_BRACKETS_OFFSET";t[t["FONT_STYLE_OFFSET"]=11]="FONT_STYLE_OFFSET";t[t["FOREGROUND_OFFSET"]=15]="FOREGROUND_OFFSET";t[t["BACKGROUND_OFFSET"]=24]="BACKGROUND_OFFSET"})(Yx||(Yx={}));class b8{static insert(e,i){return{range:new et(e.lineNumber,e.column,e.lineNumber,e.column),text:i,forceMoveMarkers:true}}static delete(e){return{range:e,text:null}}static replace(e,i){return{range:e,text:i}}static replaceMove(e,i){return{range:e,text:i,forceMoveMarkers:true}}}class n4{constructor(){this._tokenizationSupports=new Map;this._factories=new Map;this._onDidChange=new L;this.onDidChange=this._onDidChange.event;this._colorMap=null}handleChange(e){this._onDidChange.fire({changedLanguages:e,changedColorMap:false})}register(e,i){this._tokenizationSupports.set(e,i);this.handleChange([e]);return ge(()=>{if(this._tokenizationSupports.get(e)!==i){return}this._tokenizationSupports.delete(e);this.handleChange([e])})}get(e){return this._tokenizationSupports.get(e)||null}registerFactory(e,i){this._factories.get(e)?.dispose();const n=new y8(this,e,i);this._factories.set(e,n);return ge(()=>{const s=this._factories.get(e);if(!s||s!==n){return}this._factories.delete(e);s.dispose()})}async getOrCreate(e){const i=this.get(e);if(i){return i}const n=this._factories.get(e);if(!n||n.isResolved){return null}await n.resolve();return this.get(e)}isResolved(e){const i=this.get(e);if(i){return true}const n=this._factories.get(e);if(!n||n.isResolved){return true}return false}setColorMap(e){this._colorMap=e;this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:true})}getColorMap(){return this._colorMap}getDefaultBackground(){if(this._colorMap&&this._colorMap.length>Kf.DefaultBackground){return this._colorMap[Kf.DefaultBackground]}return null}}class y8 extends Ee{get isResolved(){return this._isResolved}constructor(e,i,n){super();this._registry=e;this._languageId=i;this._factory=n;this._isDisposed=false;this._resolvePromise=null;this._isResolved=false}dispose(){this._isDisposed=true;super.dispose()}async resolve(){if(!this._resolvePromise){this._resolvePromise=this._create()}return this._resolvePromise}async _create(){const e=await this._factory.tokenizationSupport;this._isResolved=true;if(e&&!this._isDisposed){this._register(this._registry.register(this._languageId,e))}}}var Zx;(function(t){t[t["Increase"]=0]="Increase";t[t["Decrease"]=1]="Decrease"})(Zx||(Zx={}));var M;(function(t){t[t["Method"]=0]="Method";t[t["Function"]=1]="Function";t[t["Constructor"]=2]="Constructor";t[t["Field"]=3]="Field";t[t["Variable"]=4]="Variable";t[t["Class"]=5]="Class";t[t["Struct"]=6]="Struct";t[t["Interface"]=7]="Interface";t[t["Module"]=8]="Module";t[t["Property"]=9]="Property";t[t["Event"]=10]="Event";t[t["Operator"]=11]="Operator";t[t["Unit"]=12]="Unit";t[t["Value"]=13]="Value";t[t["Constant"]=14]="Constant";t[t["Enum"]=15]="Enum";t[t["EnumMember"]=16]="EnumMember";t[t["Keyword"]=17]="Keyword";t[t["Text"]=18]="Text";t[t["Color"]=19]="Color";t[t["File"]=20]="File";t[t["Reference"]=21]="Reference";t[t["Customcolor"]=22]="Customcolor";t[t["Folder"]=23]="Folder";t[t["TypeParameter"]=24]="TypeParameter";t[t["User"]=25]="User";t[t["Issue"]=26]="Issue";t[t["Snippet"]=27]="Snippet"})(M||(M={}));var eE;(function(t){const e=new Map;e.set(M.Method,ve.symbolMethod);e.set(M.Function,ve.symbolFunction);e.set(M.Constructor,ve.symbolConstructor);e.set(M.Field,ve.symbolField);e.set(M.Variable,ve.symbolVariable);e.set(M.Class,ve.symbolClass);e.set(M.Struct,ve.symbolStruct);e.set(M.Interface,ve.symbolInterface);e.set(M.Module,ve.symbolModule);e.set(M.Property,ve.symbolProperty);e.set(M.Event,ve.symbolEvent);e.set(M.Operator,ve.symbolOperator);e.set(M.Unit,ve.symbolUnit);e.set(M.Value,ve.symbolValue);e.set(M.Enum,ve.symbolEnum);e.set(M.Constant,ve.symbolConstant);e.set(M.Enum,ve.symbolEnum);e.set(M.EnumMember,ve.symbolEnumMember);e.set(M.Keyword,ve.symbolKeyword);e.set(M.Snippet,ve.symbolSnippet);e.set(M.Text,ve.symbolText);e.set(M.Color,ve.symbolColor);e.set(M.File,ve.symbolFile);e.set(M.Reference,ve.symbolReference);e.set(M.Customcolor,ve.symbolCustomColor);e.set(M.Folder,ve.symbolFolder);e.set(M.TypeParameter,ve.symbolTypeParameter);e.set(M.User,ve.account);e.set(M.Issue,ve.issues);function i(o){let a=e.get(o);if(!a){console.info("No codicon found for CompletionItemKind "+o);a=ve.symbolProperty}return a}t.toIcon=i;function n(o){switch(o){case M.Method:return h(763,"Method");case M.Function:return h(764,"Function");case M.Constructor:return h(765,"Constructor");case M.Field:return h(766,"Field");case M.Variable:return h(767,"Variable");case M.Class:return h(768,"Class");case M.Struct:return h(769,"Struct");case M.Interface:return h(770,"Interface");case M.Module:return h(771,"Module");case M.Property:return h(772,"Property");case M.Event:return h(773,"Event");case M.Operator:return h(774,"Operator");case M.Unit:return h(775,"Unit");case M.Value:return h(776,"Value");case M.Constant:return h(777,"Constant");case M.Enum:return h(778,"Enum");case M.EnumMember:return h(779,"Enum Member");case M.Keyword:return h(780,"Keyword");case M.Text:return h(781,"Text");case M.Color:return h(782,"Color");case M.File:return h(783,"File");case M.Reference:return h(784,"Reference");case M.Customcolor:return h(785,"Custom Color");case M.Folder:return h(786,"Folder");case M.TypeParameter:return h(787,"Type Parameter");case M.User:return h(788,"User");case M.Issue:return h(789,"Issue");case M.Snippet:return h(790,"Snippet");default:return""}}t.toLabel=n;const s=new Map;s.set("method",M.Method);s.set("function",M.Function);s.set("constructor",M.Constructor);s.set("field",M.Field);s.set("variable",M.Variable);s.set("class",M.Class);s.set("struct",M.Struct);s.set("interface",M.Interface);s.set("module",M.Module);s.set("property",M.Property);s.set("event",M.Event);s.set("operator",M.Operator);s.set("unit",M.Unit);s.set("value",M.Value);s.set("constant",M.Constant);s.set("enum",M.Enum);s.set("enum-member",M.EnumMember);s.set("enumMember",M.EnumMember);s.set("keyword",M.Keyword);s.set("snippet",M.Snippet);s.set("text",M.Text);s.set("color",M.Color);s.set("file",M.File);s.set("reference",M.Reference);s.set("customcolor",M.Customcolor);s.set("folder",M.Folder);s.set("type-parameter",M.TypeParameter);s.set("typeParameter",M.TypeParameter);s.set("account",M.User);s.set("issue",M.Issue);function r(o,a){let l=s.get(o);if(typeof l==="undefined"&&!a){l=M.Property}return l}t.fromString=r})(eE||(eE={}));var Qf;(function(t){t[t["Deprecated"]=1]="Deprecated"})(Qf||(Qf={}));var aa;(function(t){t[t["None"]=0]="None";t[t["KeepWhitespace"]=1]="KeepWhitespace";t[t["InsertAsSnippet"]=4]="InsertAsSnippet"})(aa||(aa={}));var wu;(function(t){t[t["Word"]=0]="Word";t[t["Line"]=1]="Line";t[t["Suggest"]=2]="Suggest"})(wu||(wu={}));var bu;(function(t){t[t["Invoke"]=0]="Invoke";t[t["TriggerCharacter"]=1]="TriggerCharacter";t[t["TriggerForIncompleteCompletions"]=2]="TriggerForIncompleteCompletions"})(bu||(bu={}));var Jf;(function(t){t[t["Automatic"]=0]="Automatic";t[t["Explicit"]=1]="Explicit"})(Jf||(Jf={}));var Xf;(function(t){t[t["Accepted"]=0]="Accepted";t[t["Rejected"]=1]="Rejected";t[t["Ignored"]=2]="Ignored"})(Xf||(Xf={}));var Yf;(function(t){t[t["Invoke"]=1]="Invoke";t[t["Auto"]=2]="Auto"})(Yf||(Yf={}));var tE;(function(t){t[t["Automatic"]=0]="Automatic";t[t["PasteAs"]=1]="PasteAs"})(tE||(tE={}));var iE;(function(t){t[t["Invoke"]=1]="Invoke";t[t["TriggerCharacter"]=2]="TriggerCharacter";t[t["ContentChange"]=3]="ContentChange"})(iE||(iE={}));var nE;(function(t){t[t["Text"]=0]="Text";t[t["Read"]=1]="Read";t[t["Write"]=2]="Write"})(nE||(nE={}));function x8(t){return t&&b.isUri(t.uri)&&et.isIRange(t.range)&&(et.isIRange(t.originSelectionRange)||et.isIRange(t.targetSelectionRange))}var j;(function(t){t[t["File"]=0]="File";t[t["Module"]=1]="Module";t[t["Namespace"]=2]="Namespace";t[t["Package"]=3]="Package";t[t["Class"]=4]="Class";t[t["Method"]=5]="Method";t[t["Property"]=6]="Property";t[t["Field"]=7]="Field";t[t["Constructor"]=8]="Constructor";t[t["Enum"]=9]="Enum";t[t["Interface"]=10]="Interface";t[t["Function"]=11]="Function";t[t["Variable"]=12]="Variable";t[t["Constant"]=13]="Constant";t[t["String"]=14]="String";t[t["Number"]=15]="Number";t[t["Boolean"]=16]="Boolean";t[t["Array"]=17]="Array";t[t["Object"]=18]="Object";t[t["Key"]=19]="Key";t[t["Null"]=20]="Null";t[t["EnumMember"]=21]="EnumMember";t[t["Struct"]=22]="Struct";t[t["Event"]=23]="Event";t[t["Operator"]=24]="Operator";t[t["TypeParameter"]=25]="TypeParameter"})(j||(j={}));({[j.Array]:h(791,"array"),[j.Boolean]:h(792,"boolean"),[j.Class]:h(793,"class"),[j.Constant]:h(794,"constant"),[j.Constructor]:h(795,"constructor"),[j.Enum]:h(796,"enumeration"),[j.EnumMember]:h(797,"enumeration member"),[j.Event]:h(798,"event"),[j.Field]:h(799,"field"),[j.File]:h(800,"file"),[j.Function]:h(801,"function"),[j.Interface]:h(802,"interface"),[j.Key]:h(803,"key"),[j.Method]:h(804,"method"),[j.Module]:h(805,"module"),[j.Namespace]:h(806,"namespace"),[j.Null]:h(807,"null"),[j.Number]:h(808,"number"),[j.Object]:h(809,"object"),[j.Operator]:h(810,"operator"),[j.Package]:h(811,"package"),[j.Property]:h(812,"property"),[j.String]:h(813,"string"),[j.Struct]:h(814,"struct"),[j.TypeParameter]:h(815,"type parameter"),[j.Variable]:h(816,"variable")});var Zf;(function(t){t[t["Deprecated"]=1]="Deprecated"})(Zf||(Zf={}));var sE;(function(t){const e=new Map;e.set(j.File,ve.symbolFile);e.set(j.Module,ve.symbolModule);e.set(j.Namespace,ve.symbolNamespace);e.set(j.Package,ve.symbolPackage);e.set(j.Class,ve.symbolClass);e.set(j.Method,ve.symbolMethod);e.set(j.Property,ve.symbolProperty);e.set(j.Field,ve.symbolField);e.set(j.Constructor,ve.symbolConstructor);e.set(j.Enum,ve.symbolEnum);e.set(j.Interface,ve.symbolInterface);e.set(j.Function,ve.symbolFunction);e.set(j.Variable,ve.symbolVariable);e.set(j.Constant,ve.symbolConstant);e.set(j.String,ve.symbolString);e.set(j.Number,ve.symbolNumber);e.set(j.Boolean,ve.symbolBoolean);e.set(j.Array,ve.symbolArray);e.set(j.Object,ve.symbolObject);e.set(j.Key,ve.symbolKey);e.set(j.Null,ve.symbolNull);e.set(j.EnumMember,ve.symbolEnumMember);e.set(j.Struct,ve.symbolStruct);e.set(j.Event,ve.symbolEvent);e.set(j.Operator,ve.symbolOperator);e.set(j.TypeParameter,ve.symbolTypeParameter);function i(r){let o=e.get(r);if(!o){console.info("No codicon found for SymbolKind "+r);o=ve.symbolProperty}return o}t.toIcon=i;const n=new Map;n.set(j.File,M.File);n.set(j.Module,M.Module);n.set(j.Namespace,M.Module);n.set(j.Package,M.Module);n.set(j.Class,M.Class);n.set(j.Method,M.Method);n.set(j.Property,M.Property);n.set(j.Field,M.Field);n.set(j.Constructor,M.Constructor);n.set(j.Enum,M.Enum);n.set(j.Interface,M.Interface);n.set(j.Function,M.Function);n.set(j.Variable,M.Variable);n.set(j.Constant,M.Constant);n.set(j.String,M.Text);n.set(j.Number,M.Value);n.set(j.Boolean,M.Value);n.set(j.Array,M.Value);n.set(j.Object,M.Value);n.set(j.Key,M.Keyword);n.set(j.Null,M.Value);n.set(j.EnumMember,M.EnumMember);n.set(j.Struct,M.Struct);n.set(j.Event,M.Event);n.set(j.Operator,M.Operator);n.set(j.TypeParameter,M.TypeParameter);function s(r){let o=n.get(r);if(o===void 0){console.info("No completion kind found for SymbolKind "+r);o=M.File}return o}t.toCompletionKind=s})(sE||(sE={}));let E8=class _M{static asEditOperation(e){return b8.replace(et.lift(e.range),e.text)}static isTextEdit(e){const i=e;return typeof i.text==="string"&&et.isIRange(i.range)}};let Ka=class Ur{static{this.Comment=new Ur("comment")}static{this.Imports=new Ur("imports")}static{this.Region=new Ur("region")}static fromValue(e){switch(e){case"comment":return Ur.Comment;case"imports":return Ur.Imports;case"region":return Ur.Region}return new Ur(e)}constructor(e){this.value=e}};var rE;(function(t){t[t["AIGenerated"]=1]="AIGenerated"})(rE||(rE={}));var ep;(function(t){t[t["Invoke"]=0]="Invoke";t[t["Automatic"]=1]="Automatic"})(ep||(ep={}));var S_;(function(t){function e(i){if(!i||typeof i!=="object"){return false}return typeof i.id==="string"&&typeof i.title==="string"}t.is=e})(S_||(S_={}));var cl;(function(t){t[t["Collapsed"]=0]="Collapsed";t[t["Expanded"]=1]="Expanded"})(cl||(cl={}));var yu;(function(t){t[t["Unresolved"]=0]="Unresolved";t[t["Resolved"]=1]="Resolved"})(yu||(yu={}));var xu;(function(t){t[t["Current"]=0]="Current";t[t["Outdated"]=1]="Outdated"})(xu||(xu={}));var oE;(function(t){t[t["Editing"]=0]="Editing";t[t["Preview"]=1]="Preview"})(oE||(oE={}));var aE;(function(t){t[t["Published"]=0]="Published";t[t["Draft"]=1]="Draft"})(aE||(aE={}));var lE;(function(t){t[t["Type"]=1]="Type";t[t["Parameter"]=2]="Parameter"})(lE||(lE={}));new n4;new n4;var cE;(function(t){t[t["None"]=0]="None";t[t["Option"]=1]="Option";t[t["Default"]=2]="Default";t[t["Preferred"]=3]="Preferred"})(cE||(cE={}));var tp;(function(t){t[t["Invoke"]=0]="Invoke";t[t["Automatic"]=1]="Automatic"})(tp||(tp={}));var D_;(function(t){t[t["Left"]=1]="Left";t[t["Center"]=2]="Center";t[t["Right"]=4]="Right";t[t["Full"]=7]="Full"})(D_||(D_={}));var uE;(function(t){t[t["Left"]=1]="Left";t[t["Center"]=2]="Center";t[t["Right"]=3]="Right"})(uE||(uE={}));var dE;(function(t){t[t["Inline"]=1]="Inline";t[t["Gutter"]=2]="Gutter"})(dE||(dE={}));var hE;(function(t){t[t["Normal"]=1]="Normal";t[t["Underlined"]=2]="Underlined"})(hE||(hE={}));var fE;(function(t){t[t["Both"]=0]="Both";t[t["Right"]=1]="Right";t[t["Left"]=2]="Left";t[t["None"]=3]="None"})(fE||(fE={}));var tr;(function(t){t[t["TextDefined"]=0]="TextDefined";t[t["LF"]=1]="LF";t[t["CRLF"]=2]="CRLF"})(tr||(tr={}));var Yu;(function(t){t[t["LF"]=1]="LF";t[t["CRLF"]=2]="CRLF"})(Yu||(Yu={}));var ul;(function(t){t[t["LF"]=0]="LF";t[t["CRLF"]=1]="CRLF"})(ul||(ul={}));class k_{constructor(e,i){this._findMatchBrand=void 0;this.range=e;this.matches=i}}var dl;(function(t){t[t["AlwaysGrowsWhenTypingAtEdges"]=0]="AlwaysGrowsWhenTypingAtEdges";t[t["NeverGrowsWhenTypingAtEdges"]=1]="NeverGrowsWhenTypingAtEdges";t[t["GrowsOnlyWhenTypingBefore"]=2]="GrowsOnlyWhenTypingBefore";t[t["GrowsOnlyWhenTypingAfter"]=3]="GrowsOnlyWhenTypingAfter"})(dl||(dl={}));var pE;(function(t){t[t["Left"]=0]="Left";t[t["Right"]=1]="Right";t[t["None"]=2]="None";t[t["LeftOfInjectedText"]=3]="LeftOfInjectedText";t[t["RightOfInjectedText"]=4]="RightOfInjectedText"})(pE||(pE={}));var gE;(function(t){t[t["FIRST_LINE_DETECTION_LENGTH_LIMIT"]=1e3]="FIRST_LINE_DETECTION_LENGTH_LIMIT"})(gE||(gE={}));class S8{constructor(e,i,n){this.regex=e;this.wordSeparators=i;this.simpleSearch=n}}class D8{constructor(e,i,n){this.reverseEdits=e;this.changes=i;this.trimAutoWhitespaceLineNumbers=n}}var hl;(function(t){t[t["Unnecessary"]=1]="Unnecessary";t[t["Deprecated"]=2]="Deprecated"})(hl||(hl={}));var Ki;(function(t){t[t["Hint"]=1]="Hint";t[t["Info"]=2]="Info";t[t["Warning"]=4]="Warning";t[t["Error"]=8]="Error"})(Ki||(Ki={}));(function(t){function e(l,c){return c-l}t.compare=e;const i=Object.create(null);i[t.Error]=h(1931,"Error");i[t.Warning]=h(1932,"Warning");i[t.Info]=h(1933,"Info");function n(l){return i[l]||""}t.toString=n;const s=Object.create(null);s[t.Error]=h(1934,"Errors");s[t.Warning]=h(1935,"Warnings");s[t.Info]=h(1936,"Infos");function r(l){return s[l]||""}t.toStringPlural=r;function o(l){switch(l){case jt.Error:return t.Error;case jt.Warning:return t.Warning;case jt.Info:return t.Info;case jt.Ignore:return t.Hint}}t.fromSeverity=o;function a(l){switch(l){case t.Error:return jt.Error;case t.Warning:return jt.Warning;case t.Info:return jt.Info;case t.Hint:return jt.Ignore}}t.toSeverity=a})(Ki||(Ki={}));var mE;(function(t){const e="";function i(s){return n(s,true)}t.makeKey=i;function n(s,r){const o=[e];if(s.source){o.push(s.source.replace("","\\"))}else{o.push(e)}if(s.code){if(typeof s.code==="string"){o.push(s.code.replace("","\\"))}else{o.push(s.code.value.replace("","\\"))}}else{o.push(e)}if(s.severity!==void 0&&s.severity!==null){o.push(Ki.toString(s.severity))}else{o.push(e)}if(s.message&&r){o.push(s.message.replace("","\\"))}else{o.push(e)}if(s.startLineNumber!==void 0&&s.startLineNumber!==null){o.push(s.startLineNumber.toString())}else{o.push(e)}if(s.startColumn!==void 0&&s.startColumn!==null){o.push(s.startColumn.toString())}else{o.push(e)}if(s.endLineNumber!==void 0&&s.endLineNumber!==null){o.push(s.endLineNumber.toString())}else{o.push(e)}if(s.endColumn!==void 0&&s.endColumn!==null){o.push(s.endColumn.toString())}else{o.push(e)}o.push(e);return o.join("")}t.makeKeyOptionalMessage=n})(mE||(mE={}));const k8=xe("progressService");xe("editorProgressService");var Eu;(function(t){t[t["Explorer"]=1]="Explorer";t[t["Scm"]=3]="Scm";t[t["Extensions"]=5]="Extensions";t[t["Window"]=10]="Window";t[t["Notification"]=15]="Notification";t[t["Dialog"]=20]="Dialog"})(Eu||(Eu={}));class $0{static{this.None=Object.freeze({report(){}})}get value(){return this._value}constructor(e){this.callback=e}report(e){this._value=e;this.callback(this._value)}}let _E=class vM extends Ee{constructor(e,i){super();this.deferred=new Fs;i.withProgress(e,n=>{this.reporter=n;if(this.lastStep){n.report(this.lastStep)}return this.deferred.p});this._register(ge(()=>this.deferred.complete()))}report(e){if(this.reporter){this.reporter.report(e)}else{this.lastStep=e}}};_E=z([O(1,k8)],_E);class I8{constructor(){this.data=new Map}add(e,i){Hi(tt(e));Hi(Yt(i));Hi(!this.data.has(e),"There is already an extension with this id");this.data.set(e,i)}knows(e){return this.data.has(e)}as(e){return this.data.get(e)||null}dispose(){this.data.forEach(e=>{if($k(e.dispose)){e.dispose()}});this.data.clear()}}const ci=new I8;function E1(t,e){if(e&&(t.stack||t.stacktrace)){return h(105,"{0}: {1}",wE(t),vE(t.stack)||vE(t.stacktrace))}return wE(t)}function vE(t){if(Array.isArray(t)){return t.join("\n")}return t}function wE(t){if(t.code==="ERR_UNC_HOST_NOT_ALLOWED"){return`${t.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`}if(typeof t.code==="string"&&typeof t.errno==="number"&&typeof t.syscall==="string"){return h(106,"A system error occurred ({0})",t.message)}return t.message||h(107,"An unknown error occurred. Please consult the log for more details.")}function Rc(t=null,e=false){if(!t){return h(107,"An unknown error occurred. Please consult the log for more details.")}if(Array.isArray(t)){const i=ei(t);const n=Rc(i[0],e);if(i.length>1){return h(108,"{0} ({1} errors in total)",n,i.length)}return n}if(tt(t)){return t}if(t.detail){const i=t.detail;if(i.error){return E1(i.error,e)}if(i.exception){return E1(i.exception,e)}}if(t.stack){return E1(t,e)}if(t.message){return t.message}return h(107,"An unknown error occurred. Please consult the log for more details.")}class C8 extends Ee{constructor(e,i="",n="",s=true,r){super();this._onDidChange=this._register(new L);this.onDidChange=this._onDidChange.event;this._enabled=true;this._id=e;this._label=i;this._cssClass=n;this._enabled=s;this._actionCallback=r}get id(){return this._id}get label(){return this._label}set label(e){this._setLabel(e)}_setLabel(e){if(this._label!==e){this._label=e;this._onDidChange.fire({label:e})}}get tooltip(){return this._tooltip||""}set tooltip(e){this._setTooltip(e)}_setTooltip(e){if(this._tooltip!==e){this._tooltip=e;this._onDidChange.fire({tooltip:e})}}get class(){return this._cssClass}set class(e){this._setClass(e)}_setClass(e){if(this._cssClass!==e){this._cssClass=e;this._onDidChange.fire({class:e})}}get enabled(){return this._enabled}set enabled(e){this._setEnabled(e)}_setEnabled(e){if(this._enabled!==e){this._enabled=e;this._onDidChange.fire({enabled:e})}}get checked(){return this._checked}set checked(e){this._setChecked(e)}_setChecked(e){if(this._checked!==e){this._checked=e;this._onDidChange.fire({checked:e})}}async run(e,i){if(this._actionCallback){await this._actionCallback(e)}}}class s4 extends C8{static{this.ID="vs.actions.empty"}constructor(){super(s4.ID,h(43,"(empty)"),void 0,false)}}const T8={EditorFactory:"workbench.contributions.editor.inputFactories"};const P8={id:"default",displayName:h(3853,"Text Editor"),providerDisplayName:h(3854,"Built-in")};var bE;(function(t){t[t["PROGRAMMATIC"]=1]="PROGRAMMATIC";t[t["USER"]=2]="USER";t[t["EDIT"]=3]="EDIT";t[t["NAVIGATION"]=4]="NAVIGATION";t[t["JUMP"]=5]="JUMP"})(bE||(bE={}));var yE;(function(t){t[t["IDENTICAL"]=1]="IDENTICAL";t[t["SIMILAR"]=2]="SIMILAR";t[t["DIFFERENT"]=3]="DIFFERENT"})(yE||(yE={}));var xE;(function(t){t[t["SHORT"]=0]="SHORT";t[t["MEDIUM"]=1]="MEDIUM";t[t["LONG"]=2]="LONG"})(xE||(xE={}));var fl;(function(t){t[t["EXPLICIT"]=1]="EXPLICIT";t[t["AUTO"]=2]="AUTO";t[t["FOCUS_CHANGE"]=3]="FOCUS_CHANGE";t[t["WINDOW_CHANGE"]=4]="WINDOW_CHANGE"})(fl||(fl={}));var EE;(function(t){t[t["None"]=0]="None";t[t["Readonly"]=2]="Readonly";t[t["Untitled"]=4]="Untitled";t[t["Singleton"]=8]="Singleton";t[t["RequiresTrust"]=16]="RequiresTrust";t[t["CanSplitInGroup"]=32]="CanSplitInGroup";t[t["ForceDescription"]=64]="ForceDescription";t[t["CanDropIntoEditor"]=128]="CanDropIntoEditor";t[t["MultipleEditors"]=256]="MultipleEditors";t[t["Scratchpad"]=512]="Scratchpad"})(EE||(EE={}));var SE;(function(t){t[t["UNKNOWN"]=0]="UNKNOWN";t[t["REPLACE"]=1]="REPLACE";t[t["MOVE"]=2]="MOVE";t[t["UNPIN"]=3]="UNPIN"})(SE||(SE={}));var DE;(function(t){t[t["GROUP_ACTIVE"]=0]="GROUP_ACTIVE";t[t["GROUP_INDEX"]=1]="GROUP_INDEX";t[t["GROUP_LABEL"]=2]="GROUP_LABEL";t[t["GROUP_LOCKED"]=3]="GROUP_LOCKED";t[t["EDITORS_SELECTION"]=4]="EDITORS_SELECTION";t[t["EDITOR_OPEN"]=5]="EDITOR_OPEN";t[t["EDITOR_CLOSE"]=6]="EDITOR_CLOSE";t[t["EDITOR_MOVE"]=7]="EDITOR_MOVE";t[t["EDITOR_ACTIVE"]=8]="EDITOR_ACTIVE";t[t["EDITOR_LABEL"]=9]="EDITOR_LABEL";t[t["EDITOR_CAPABILITIES"]=10]="EDITOR_CAPABILITIES";t[t["EDITOR_PIN"]=11]="EDITOR_PIN";t[t["EDITOR_TRANSIENT"]=12]="EDITOR_TRANSIENT";t[t["EDITOR_STICKY"]=13]="EDITOR_STICKY";t[t["EDITOR_DIRTY"]=14]="EDITOR_DIRTY";t[t["EDITOR_WILL_DISPOSE"]=15]="EDITOR_WILL_DISPOSE"})(DE||(DE={}));var kE;(function(t){t[t["PRIMARY"]=1]="PRIMARY";t[t["SECONDARY"]=2]="SECONDARY";t[t["BOTH"]=3]="BOTH";t[t["ANY"]=4]="ANY"})(kE||(kE={}));var IE;(function(t){t[t["UNKNOWN"]=0]="UNKNOWN";t[t["KEYBOARD"]=1]="KEYBOARD";t[t["MOUSE"]=2]="MOUSE"})(IE||(IE={}));var CE;(function(t){t[t["LEFT"]=0]="LEFT";t[t["RIGHT"]=1]="RIGHT"})(CE||(CE={}));class A8{constructor(){this.editorSerializerConstructors=new Map;this.editorSerializerInstances=new Map}start(e){const i=this.instantiationService=e.get(ch);for(const[n,s]of this.editorSerializerConstructors){this.createEditorSerializer(n,s,i)}this.editorSerializerConstructors.clear()}createEditorSerializer(e,i,n){const s=n.createInstance(i);this.editorSerializerInstances.set(e,s)}registerFileEditorFactory(e){if(this.fileEditorFactory){throw new Error("Can only register one file editor factory.")}this.fileEditorFactory=e}getFileEditorFactory(){return zl(this.fileEditorFactory)}registerEditorSerializer(e,i){if(this.editorSerializerConstructors.has(e)||this.editorSerializerInstances.has(e)){throw new Error(`A editor serializer with type ID '${e}' was already registered.`)}if(!this.instantiationService){this.editorSerializerConstructors.set(e,i)}else{this.createEditorSerializer(e,i,this.instantiationService)}return ge(()=>{this.editorSerializerConstructors.delete(e);this.editorSerializerInstances.delete(e)})}getEditorSerializer(e){return this.editorSerializerInstances.get(typeof e==="string"?e:e.typeId)}}ci.add(T8.EditorFactory,new A8);var TE;(function(t){t[t["MOST_RECENTLY_ACTIVE"]=0]="MOST_RECENTLY_ACTIVE";t[t["SEQUENTIAL"]=1]="SEQUENTIAL"})(TE||(TE={}));let Co;function r4(t){if(!Co){Co=t}else if(Co instanceof PE){Co.loggers.push(t)}else{Co=new PE([Co,t])}}function mi(){return Co}let I_=void 0;function R8(t){I_=t}function L8(t){if(I_){I_(t)}}class PE{constructor(e){this.loggers=e}handleObservableCreated(e){for(const i of this.loggers){i.handleObservableCreated(e)}}handleOnListenerCountChanged(e,i){for(const n of this.loggers){n.handleOnListenerCountChanged(e,i)}}handleObservableUpdated(e,i){for(const n of this.loggers){n.handleObservableUpdated(e,i)}}handleAutorunCreated(e){for(const i of this.loggers){i.handleAutorunCreated(e)}}handleAutorunDisposed(e){for(const i of this.loggers){i.handleAutorunDisposed(e)}}handleAutorunDependencyChanged(e,i,n){for(const s of this.loggers){s.handleAutorunDependencyChanged(e,i,n)}}handleAutorunStarted(e){for(const i of this.loggers){i.handleAutorunStarted(e)}}handleAutorunFinished(e){for(const i of this.loggers){i.handleAutorunFinished(e)}}handleDerivedDependencyChanged(e,i,n){for(const s of this.loggers){s.handleDerivedDependencyChanged(e,i,n)}}handleDerivedCleared(e){for(const i of this.loggers){i.handleDerivedCleared(e)}}handleBeginTransaction(e){for(const i of this.loggers){i.handleBeginTransaction(e)}}handleEndTransaction(e){for(const i of this.loggers){i.handleEndTransaction(e)}}}class Zu{constructor(e,i,n){this.owner=e;this.debugNameSource=i;this.referenceFn=n}getDebugName(e){return N8(e,this)}}const AE=new Map;const C_=new WeakMap;function N8(t,e){const i=C_.get(t);if(i){return i}const n=O8(t,e);if(n){let s=AE.get(n)??0;s++;AE.set(n,s);const r=s===1?n:`${n}#${s}`;C_.set(t,r);return r}return void 0}function O8(t,e){const i=C_.get(t);if(i){return i}const n=e.owner?M8(e.owner)+`.`:"";let s;const r=e.debugNameSource;if(r!==void 0){if(typeof r==="function"){s=r();if(s!==void 0){return n+s}}else{return n+r}}const o=e.referenceFn;if(o!==void 0){s=H0(o);if(s!==void 0){return n+s}}if(e.owner!==void 0){const a=F8(e.owner,t);if(a!==void 0){return n+a}}return void 0}function F8(t,e){for(const i in t){if(t[i]===e){return i}}return void 0}const RE=new Map;const LE=new WeakMap;function M8(t){const e=LE.get(t);if(e){return e}const i=o4(t)??"Object";let n=RE.get(i)??0;n++;RE.set(i,n);const s=n===1?i:`${i}#${n}`;LE.set(t,s);return s}function o4(t){const e=t.constructor;if(e){if(e.name==="Object"){return void 0}return e.name}return void 0}function H0(t){const e=t.toString();const i=/\/\*\*\s*@description\s*([^*]*)\*\//;const n=i.exec(e);const s=n?n[1]:void 0;return s?.trim()}function T_(t){return new B0(new Zu(void 0,void 0,t),t,void 0)}var xi;(function(t){t[t["dependenciesMightHaveChanged"]=1]="dependenciesMightHaveChanged";t[t["stale"]=2]="stale";t[t["upToDate"]=3]="upToDate"})(xi||(xi={}));class B0{get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}constructor(e,i,n){this._debugNameData=e;this._runFn=i;this._changeTracker=n;this._state=xi.stale;this._updateCount=0;this._disposed=false;this._dependencies=new Set;this._dependenciesToBeRemoved=new Set;this._isRunning=false;this._changeSummary=this._changeTracker?.createChangeSummary(void 0);mi()?.handleAutorunCreated(this);this._run()}dispose(){if(this._disposed){return}this._disposed=true;for(const e of this._dependencies){e.removeObserver(this)}this._dependencies.clear();mi()?.handleAutorunDisposed(this)}_run(){const e=this._dependenciesToBeRemoved;this._dependenciesToBeRemoved=this._dependencies;this._dependencies=e;this._state=xi.upToDate;try{if(!this._disposed){mi()?.handleAutorunStarted(this);const i=this._changeSummary;try{this._isRunning=true;if(this._changeTracker){this._changeTracker.beforeUpdate?.(this,i);this._changeSummary=this._changeTracker.createChangeSummary(i)}this._runFn(this,i)}catch(n){kf(n)}finally{this._isRunning=false}}}finally{if(!this._disposed){mi()?.handleAutorunFinished(this)}for(const i of this._dependenciesToBeRemoved){i.removeObserver(this)}this._dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(e){if(this._state===xi.upToDate){this._state=xi.dependenciesMightHaveChanged}this._updateCount++}endUpdate(e){try{if(this._updateCount===1){do{if(this._state===xi.dependenciesMightHaveChanged){this._state=xi.upToDate;for(const i of this._dependencies){i.reportChanges();if(this._state===xi.stale){break}}}if(this._state!==xi.upToDate){this._run()}}while(this._state!==xi.upToDate)}}finally{this._updateCount--}Fk(()=>this._updateCount>=0)}handlePossibleChange(e){if(this._state===xi.upToDate&&this._isDependency(e)){this._state=xi.dependenciesMightHaveChanged}}handleChange(e,i){if(this._isDependency(e)){mi()?.handleAutorunDependencyChanged(this,e,i);try{const n=this._changeTracker?this._changeTracker.handleChange({changedObservable:e,change:i,didChange:s=>s===e},this._changeSummary):true;if(n){this._state=xi.stale}}catch(n){kf(n)}}}_isDependency(e){return this._dependencies.has(e)&&!this._dependenciesToBeRemoved.has(e)}readObservable(e){if(!this._isRunning){throw new Ji("The reader object cannot be used outside its compute function!")}if(this._disposed){return e.get()}e.addObserver(this);const i=e.get();this._dependencies.add(e);this._dependenciesToBeRemoved.delete(e);return i}debugGetState(){return{isRunning:this._isRunning,updateCount:this._updateCount,dependencies:this._dependencies,state:this._state}}debugRerun(){if(!this._isRunning){this._run()}else{this._state=xi.stale}}}(function(t){t.Observer=B0})(T_||(T_={}));const V0=(t,e)=>t===e;function P_(t,e){if(t===e){return true}if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length){return false}for(let i=0;i<t.length;i++){if(!P_(t[i],e[i])){return false}}return true}if(t&&typeof t==="object"&&e&&typeof e==="object"){if(Object.getPrototypeOf(t)===Object.prototype&&Object.getPrototypeOf(e)===Object.prototype){const i=t;const n=e;const s=Object.keys(i);const r=Object.keys(n);const o=new Set(r);if(s.length!==r.length){return false}for(const a of s){if(!o.has(a)){return false}if(!P_(i[a],n[a])){return false}}return true}}return false}let a4;function U8(t){a4=t}let l4;function $8(t){l4=t}let A_;function H8(t){A_=t}class B8{get TChange(){return null}reportChanges(){this.get()}read(e){if(e){return e.readObservable(this)}else{return this.get()}}map(e,i){const n=i===void 0?void 0:e;const s=i===void 0?e:i;return A_({owner:n,debugName:()=>{const r=H0(s);if(r!==void 0){return r}const o=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/;const a=o.exec(s.toString());if(a){return`${this.debugName}.${a[2]}`}if(!n){return`${this.debugName} (mapped)`}return void 0},debugReferenceFn:s},r=>s(this.read(r),r))}flatten(){return A_({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},e=>this.read(e).read(e))}recomputeInitiallyAndOnChange(e,i){e.add(a4(this,i));return this}keepObserved(e){e.add(l4(this));return this}get debugValue(){return this.get()}}class W0 extends B8{constructor(){super();this._observers=new Set;mi()?.handleObservableCreated(this)}addObserver(e){const i=this._observers.size;this._observers.add(e);if(i===0){this.onFirstObserverAdded()}if(i!==this._observers.size){mi()?.handleOnListenerCountChanged(this,this._observers.size)}}removeObserver(e){const i=this._observers.delete(e);if(i&&this._observers.size===0){this.onLastObserverRemoved()}if(i){mi()?.handleOnListenerCountChanged(this,this._observers.size)}}onFirstObserverAdded(){}onLastObserverRemoved(){}log(){const e=!!mi();L8(this);if(!e){mi()?.handleObservableCreated(this)}return this}debugGetObservers(){return this._observers}}function ip(t,e){const i=new c4(t,e);try{t(i)}finally{i.finish()}}function V8(t,e,i){if(!t){ip(e,i)}else{e(t)}}class c4{constructor(e,i){this._fn=e;this._getDebugName=i;this._updatingObservers=[];mi()?.handleBeginTransaction(this)}getDebugName(){if(this._getDebugName){return this._getDebugName()}return H0(this._fn)}updateObserver(e,i){if(!this._updatingObservers){NE("Transaction already finished!");ip(n=>{n.updateObserver(e,i)});return}this._updatingObservers.push({observer:e,observable:i});e.beginUpdate(i)}finish(){const e=this._updatingObservers;if(!e){NE("transaction.finish() has already been called!");return}for(let i=0;i<e.length;i++){const{observer:n,observable:s}=e[i];n.endUpdate(s)}this._updatingObservers=null;mi()?.handleEndTransaction(this)}debugGetUpdatingObservers(){return this._updatingObservers}}function NE(t){const e=new Error("BugIndicatingErrorRecovery: "+t);Pi(e);console.error("recovered from an error that indicates a bug",e)}function z0(t,e){let i;if(typeof t==="string"){i=new Zu(void 0,t,void 0)}else{i=new Zu(t,void 0,void 0)}return new R_(i,e,V0)}class R_ extends W0{get debugName(){return this._debugNameData.getDebugName(this)??"ObservableValue"}constructor(e,i,n){super();this._debugNameData=e;this._equalityComparator=n;this._value=i;mi()?.handleObservableUpdated(this,{hadValue:false,newValue:i,change:void 0,didChange:true,oldValue:void 0})}get(){return this._value}set(e,i,n){if(n===void 0&&this._equalityComparator(this._value,e)){return}let s;if(!i){i=s=new c4(()=>{},()=>`Setting ${this.debugName}`)}try{const r=this._value;this._setValue(e);mi()?.handleObservableUpdated(this,{oldValue:r,newValue:e,change:n,didChange:true,hadValue:true});for(const o of this._observers){i.updateObserver(o,this);o.handleChange(this,n)}}finally{if(s){s.finish()}}}toString(){return`${this.debugName}: ${this._value}`}_setValue(e){this._value=e}debugGetState(){return{value:this._value}}debugSetValue(e){this._value=e}}function W8(t,e){return new sr(new Zu(t.owner,t.debugName,t.debugReferenceFn),e,void 0,t.onLastObserverRemoved,t.equalsFn??V0)}H8(W8);var zt;(function(t){t[t["initial"]=0]="initial";t[t["dependenciesMightHaveChanged"]=1]="dependenciesMightHaveChanged";t[t["stale"]=2]="stale";t[t["upToDate"]=3]="upToDate"})(zt||(zt={}));class sr extends W0{get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}constructor(e,i,n,s=void 0,r){super();this._debugNameData=e;this._computeFn=i;this._changeTracker=n;this._handleLastObserverRemoved=s;this._equalityComparator=r;this._state=zt.initial;this._value=void 0;this._updateCount=0;this._dependencies=new Set;this._dependenciesToBeRemoved=new Set;this._changeSummary=void 0;this._isUpdating=false;this._isComputing=false;this._didReportChange=false;this._removedObserverToCallEndUpdateOn=null;this._isReaderValid=false;this._changeSummary=this._changeTracker?.createChangeSummary(void 0)}onLastObserverRemoved(){this._state=zt.initial;this._value=void 0;mi()?.handleDerivedCleared(this);for(const e of this._dependencies){e.removeObserver(this)}this._dependencies.clear();this._handleLastObserverRemoved?.()}get(){if(this._observers.size===0){let e;try{this._isReaderValid=true;let i=void 0;if(this._changeTracker){i=this._changeTracker.createChangeSummary(void 0);this._changeTracker.beforeUpdate?.(this,i)}e=this._computeFn(this,i)}finally{this._isReaderValid=false}this.onLastObserverRemoved();return e}else{do{if(this._state===zt.dependenciesMightHaveChanged){for(const e of this._dependencies){e.reportChanges();if(this._state===zt.stale){break}}}if(this._state===zt.dependenciesMightHaveChanged){this._state=zt.upToDate}if(this._state!==zt.upToDate){this._recompute()}}while(this._state!==zt.upToDate);return this._value}}_recompute(){const e=this._dependenciesToBeRemoved;this._dependenciesToBeRemoved=this._dependencies;this._dependencies=e;const i=this._state!==zt.initial;const n=this._value;this._state=zt.upToDate;let s=false;this._isComputing=true;this._didReportChange=false;try{const r=this._changeSummary;try{this._isReaderValid=true;if(this._changeTracker){this._changeTracker.beforeUpdate?.(this,r);this._changeSummary=this._changeTracker?.createChangeSummary(r)}this._value=this._computeFn(this,r)}finally{this._isReaderValid=false;for(const o of this._dependenciesToBeRemoved){o.removeObserver(this)}this._dependenciesToBeRemoved.clear()}s=this._didReportChange||i&&!this._equalityComparator(n,this._value);mi()?.handleObservableUpdated(this,{oldValue:n,newValue:this._value,change:void 0,didChange:s,hadValue:i})}catch(r){kf(r)}this._isComputing=false;if(!this._didReportChange&&s){for(const r of this._observers){r.handleChange(this,void 0)}}else{this._didReportChange=false}}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(e){if(this._isUpdating){throw new Ji("Cyclic deriveds are not supported yet!")}this._updateCount++;this._isUpdating=true;try{const i=this._updateCount===1;if(this._state===zt.upToDate){this._state=zt.dependenciesMightHaveChanged;if(!i){for(const n of this._observers){n.handlePossibleChange(this)}}}if(i){for(const n of this._observers){n.beginUpdate(this)}}}finally{this._isUpdating=false}}endUpdate(e){this._updateCount--;if(this._updateCount===0){const i=[...this._observers];for(const n of i){n.endUpdate(this)}if(this._removedObserverToCallEndUpdateOn){const n=[...this._removedObserverToCallEndUpdateOn];this._removedObserverToCallEndUpdateOn=null;for(const s of n){s.endUpdate(this)}}}Fk(()=>this._updateCount>=0)}handlePossibleChange(e){if(this._state===zt.upToDate&&this._dependencies.has(e)&&!this._dependenciesToBeRemoved.has(e)){this._state=zt.dependenciesMightHaveChanged;for(const i of this._observers){i.handlePossibleChange(this)}}}handleChange(e,i){if(this._dependencies.has(e)&&!this._dependenciesToBeRemoved.has(e)){mi()?.handleDerivedDependencyChanged(this,e,i);let n=false;try{n=this._changeTracker?this._changeTracker.handleChange({changedObservable:e,change:i,didChange:r=>r===e},this._changeSummary):true}catch(r){kf(r)}const s=this._state===zt.upToDate;if(n&&(this._state===zt.dependenciesMightHaveChanged||s)){this._state=zt.stale;if(s){for(const r of this._observers){r.handlePossibleChange(this)}}}}}readObservable(e){if(!this._isReaderValid){throw new Ji("The reader object cannot be used outside its compute function!")}e.addObserver(this);const i=e.get();this._dependencies.add(e);this._dependenciesToBeRemoved.delete(e);return i}reportChange(e){if(!this._isReaderValid){throw new Ji("The reader object cannot be used outside its compute function!")}this._didReportChange=true;for(const i of this._observers){i.handleChange(this,e)}}addObserver(e){const i=!this._observers.has(e)&&this._updateCount>0;super.addObserver(e);if(i){if(this._removedObserverToCallEndUpdateOn&&this._removedObserverToCallEndUpdateOn.has(e)){this._removedObserverToCallEndUpdateOn.delete(e)}else{e.beginUpdate(this)}}}removeObserver(e){if(this._observers.has(e)&&this._updateCount>0){if(!this._removedObserverToCallEndUpdateOn){this._removedObserverToCallEndUpdateOn=new Set}this._removedObserverToCallEndUpdateOn.add(e)}super.removeObserver(e)}debugGetState(){return{state:this._state,updateCount:this._updateCount,isComputing:this._isComputing,dependencies:this._dependencies,value:this._value}}debugSetValue(e){this._value=e}setValue(e,i,n){this._value=e;const s=this._observers;i.updateObserver(this,this);for(const r of s){r.handleChange(this,n)}}}function OE(...t){let e;let i;let n;if(t.length===3){[e,i,n]=t}else{[i,n]=t}return new qo(new Zu(e,void 0,n),i,n,()=>qo.globalTransaction,V0)}class qo extends W0{constructor(e,i,n,s,r){super();this._debugNameData=e;this.event=i;this._getValue=n;this._getTransaction=s;this._equalityComparator=r;this._hasValue=false;this.handleEvent=o=>{const a=this._getValue(o);const l=this._value;const c=!this._hasValue||!this._equalityComparator(l,a);let u=false;if(c){this._value=a;if(this._hasValue){u=true;V8(this._getTransaction(),d=>{mi()?.handleObservableUpdated(this,{oldValue:l,newValue:a,change:void 0,didChange:c,hadValue:this._hasValue});for(const p of this._observers){d.updateObserver(p,this);p.handleChange(this,void 0)}},()=>{const d=this.getDebugName();return"Event fired"+(d?`: ${d}`:"")})}this._hasValue=true}if(!u){mi()?.handleObservableUpdated(this,{oldValue:l,newValue:a,change:void 0,didChange:c,hadValue:this._hasValue})}}}getDebugName(){return this._debugNameData.getDebugName(this)}get debugName(){const e=this.getDebugName();return"From Event"+(e?`: ${e}`:"")}onFirstObserverAdded(){this._subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this._subscription.dispose();this._subscription=void 0;this._hasValue=false;this._value=void 0}get(){if(this._subscription){if(!this._hasValue){this.handleEvent(void 0)}return this._value}else{const e=this._getValue(void 0);return e}}debugSetValue(e){this._value=e}}(function(t){t.Observer=qo;function e(i,n){let s=false;if(qo.globalTransaction===void 0){qo.globalTransaction=i;s=true}try{n()}finally{if(s){qo.globalTransaction=void 0}}}t.batchEventsGlobally=e})(OE||(OE={}));function z8(t){const e=new u4(false,void 0);t.addObserver(e);return ge(()=>{t.removeObserver(e)})}$8(z8);function q8(t,e){const i=new u4(true,e);t.addObserver(i);try{i.beginUpdate(t)}finally{i.endUpdate(t)}return ge(()=>{t.removeObserver(i)})}U8(q8);class u4{constructor(e,i){this._forceRecompute=e;this._handleValue=i;this._counter=0}beginUpdate(e){this._counter++}endUpdate(e){if(this._counter===1&&this._forceRecompute){if(this._handleValue){this._handleValue(e.get())}else{e.reportChanges()}}this._counter--}handlePossibleChange(e){}handleChange(e,i){}}let Ch;function j8(t){if(!Ch){Ch=new G8;r4(Ch)}Ch.addFilteredObj(t)}class G8{constructor(){this.indentation=0;this.changedObservablesSets=new WeakMap}addFilteredObj(e){if(!this._filteredObjects){this._filteredObjects=new Set}this._filteredObjects.add(e)}_isIncluded(e){return this._filteredObjects?.has(e)??true}textToConsoleArgs(e){return K8([Qa(X8("|  ",this.indentation)),e])}formatInfo(e){if(!e.hadValue){return[Qa(` `),An(dr(e.newValue,60),{color:"green"}),Qa(` (initial)`)]}return e.didChange?[Qa(` `),An(dr(e.oldValue,70),{color:"red",strikeThrough:true}),Qa(` `),An(dr(e.newValue,60),{color:"green"})]:[Qa(` (unchanged)`)]}handleObservableCreated(e){if(e instanceof sr){const i=e;this.changedObservablesSets.set(i,new Set)}}handleOnListenerCountChanged(e,i){}handleObservableUpdated(e,i){if(!this._isIncluded(e)){return}if(e instanceof sr){this._handleDerivedRecomputed(e,i);return}console.log(...this.textToConsoleArgs([Ja("observable value changed"),An(e.debugName,{color:"BlueViolet"}),...this.formatInfo(i)]))}formatChanges(e){if(e.size===0){return void 0}return An(" (changed deps: "+[...e].map(i=>i.debugName).join(", ")+")",{color:"gray"})}handleDerivedDependencyChanged(e,i,n){if(!this._isIncluded(e)){return}this.changedObservablesSets.get(e)?.add(i)}_handleDerivedRecomputed(e,i){if(!this._isIncluded(e)){return}const n=this.changedObservablesSets.get(e);if(!n){return}console.log(...this.textToConsoleArgs([Ja("derived recomputed"),An(e.debugName,{color:"BlueViolet"}),...this.formatInfo(i),this.formatChanges(n),{data:[{fn:e._debugNameData.referenceFn??e._computeFn}]}]));n.clear()}handleDerivedCleared(e){if(!this._isIncluded(e)){return}console.log(...this.textToConsoleArgs([Ja("derived cleared"),An(e.debugName,{color:"BlueViolet"})]))}handleFromEventObservableTriggered(e,i){if(!this._isIncluded(e)){return}console.log(...this.textToConsoleArgs([Ja("observable from event triggered"),An(e.debugName,{color:"BlueViolet"}),...this.formatInfo(i),{data:[{fn:e._getValue}]}]))}handleAutorunCreated(e){if(!this._isIncluded(e)){return}this.changedObservablesSets.set(e,new Set)}handleAutorunDisposed(e){}handleAutorunDependencyChanged(e,i,n){if(!this._isIncluded(e)){return}this.changedObservablesSets.get(e).add(i)}handleAutorunStarted(e){const i=this.changedObservablesSets.get(e);if(!i){return}if(this._isIncluded(e)){console.log(...this.textToConsoleArgs([Ja("autorun"),An(e.debugName,{color:"BlueViolet"}),this.formatChanges(i),{data:[{fn:e._debugNameData.referenceFn??e._runFn}]}]))}i.clear();this.indentation++}handleAutorunFinished(e){this.indentation--}handleBeginTransaction(e){let i=e.getDebugName();if(i===void 0){i=""}if(this._isIncluded(e)){console.log(...this.textToConsoleArgs([Ja("transaction"),An(i,{color:"BlueViolet"}),{data:[{fn:e._fn}]}]))}this.indentation++}handleEndTransaction(){this.indentation--}}function K8(t){const e=new Array;const i=[];let n="";function s(o){if("length"in o){for(const a of o){if(a){s(a)}}}else if("text"in o){n+=`%c${o.text}`;e.push(o.style);if(o.data){i.push(...o.data)}}else if("data"in o){i.push(...o.data)}}s(t);const r=[n,...e];r.push(...i);return r}function Qa(t){return An(t,{color:"black"})}function Ja(t){return An(Y8(`${t}: `,10),{color:"black",bold:true})}function An(t,e={color:"black"}){function i(s){return Object.entries(s).reduce((r,[o,a])=>{return`${r}${o}:${a};`},"")}const n={color:e.color};if(e.strikeThrough){n["text-decoration"]="line-through"}if(e.bold){n["font-weight"]="bold"}return{text:t,style:i(n)}}function dr(t,e){switch(typeof t){case"number":return""+t;case"string":if(t.length+2<=e){return`"${t}"`}return`"${t.substr(0,e-7)}"+...`;case"boolean":return t?"true":"false";case"undefined":return"undefined";case"object":if(t===null){return"null"}if(Array.isArray(t)){return Q8(t,e)}return J8(t,e);case"symbol":return t.toString();case"function":return`[[Function${t.name?" "+t.name:""}]]`;default:return""+t}}function Q8(t,e){let i="[ ";let n=true;for(const s of t){if(!n){i+=", "}if(i.length-5>e){i+="...";break}n=false;i+=`${dr(s,e-i.length)}`}i+=" ]";return i}function J8(t,e){if(typeof t.toString==="function"&&t.toString!==Object.prototype.toString){const r=t.toString();if(r.length<=e){return r}return r.substring(0,e-3)+"..."}const i=o4(t);let n=i?i+"(":"{ ";let s=true;for(const[r,o]of Object.entries(t)){if(!s){n+=", "}if(n.length-5>e){n+="...";break}s=false;n+=`${r}: ${dr(o,e-n.length)}`}n+=i?")":" }";return n}function X8(t,e){let i="";for(let n=1;n<=e;n++){i+=t}return i}function Y8(t,e){while(t.length<e){t+=" "}return t}class np{static createHost(e,i){return new np(e,i)}static createClient(e,i){return new np(e,i)}constructor(e,i){this._channelFactory=e;this._getHandler=i;this._channel=this._channelFactory({handleNotification:r=>{const o=r;const a=this._getHandler().notifications[o[0]];if(!a){throw new Error(`Unknown notification "${o[0]}"!`)}a(...o[1])},handleRequest:r=>{const o=r;try{const a=this._getHandler().requests[o[0]](...o[1]);return{type:"result",value:a}}catch(a){return{type:"error",value:a}}}});const n=new Proxy({},{get:(r,o)=>{return async(...a)=>{const l=await this._channel.sendRequest([o,a]);if(l.type==="error"){throw l.value}else{return l.value}}}});const s=new Proxy({},{get:(r,o)=>{return(...a)=>{this._channel.sendNotification([o,a])}}});this.api={notifications:s,requests:n}}}function Z8(t,e){const i=globalThis;let n=[];let s=void 0;const{channel:r,handler:o}=e9({sendNotification:l=>{if(s){s.sendNotification(l)}else{n.push(l)}}});let a=void 0;(i.$$debugValueEditor_debugChannels??(i.$$debugValueEditor_debugChannels={}))[t]=l=>{a=e();s=l;for(const c of n){l.sendNotification(c)}n=[];return o};return np.createClient(r,()=>{if(!a){throw new Error("Not supported")}return a})}function e9(t){let e;const i=n=>{e=n;return{sendNotification:s=>{t.sendNotification(s)},sendRequest:s=>{throw new Error("not supported")}}};return{channel:i,handler:{handleRequest:n=>{if(n.type==="notification"){return e?.handleNotification(n.data)}else{return e?.handleRequest(n.data)}}}}}function FE(t,e){const i=t.split("\n");for(const n of i.slice(1)){if(e&&e.test(n)){continue}const s=t9(n);if(s){return s}}return void 0}function t9(t){const e=t.match(/\((.*):(\d+):(\d+)\)/);if(e){return{fileName:e[1],line:parseInt(e[2]),column:parseInt(e[3]),id:t}}const i=t.match(/at ([^\(\)]*):(\d+):(\d+)/);if(i){return{fileName:i[1],line:parseInt(i[2]),column:parseInt(i[3]),id:t}}return void 0}class i9{constructor(){this._timeout=void 0}throttle(e,i){if(this._timeout===void 0){this._timeout=setTimeout(()=>{this._timeout=void 0;e()},i)}}dispose(){if(this._timeout!==void 0){clearTimeout(this._timeout)}}}function d4(t,e){for(const i in e){if(!!t[i]&&typeof t[i]==="object"&&!!e[i]&&typeof e[i]==="object"){d4(t[i],e[i])}else{t[i]=e[i]}}}function h4(t,e){for(const i in e){if(e[i]===null){delete t[i]}else if(!!t[i]&&typeof t[i]==="object"&&!!e[i]&&typeof e[i]==="object"){h4(t[i],e[i])}else{t[i]=e[i]}}}class pl{static{this._instance=void 0}static getInstance(){if(pl._instance===void 0){pl._instance=new pl}return pl._instance}getTransactionState(){const e=[];const i=[...this._activeTransactions];if(i.length===0){return void 0}const n=i.flatMap(r=>r.debugGetUpdatingObservers()??[]).map(r=>r.observer);const s=new Set;while(n.length>0){const r=n.shift();if(s.has(r)){continue}s.add(r);const o=this._getInfo(r,a=>{if(!s.has(a)){n.push(a)}});if(o){e.push(o)}}return{names:i.map(r=>r.getDebugName()??"tx"),affected:e}}_getObservableInfo(e){const i=this._instanceInfos.get(e);if(!i){Pi(new Ji("No info found"));return void 0}return i}_getAutorunInfo(e){const i=this._instanceInfos.get(e);if(!i){Pi(new Ji("No info found"));return void 0}return i}_getInfo(e,i){if(e instanceof sr){const n=[...e.debugGetObservers()];for(const l of n){i(l)}const s=this._getObservableInfo(e);if(!s){return}const r=e.debugGetState();const o={name:e.debugName,instanceId:s.instanceId,updateCount:r.updateCount};const a=[...s.changedObservables].map(l=>this._instanceInfos.get(l)?.instanceId).filter(ln);if(r.isComputing){return{...o,type:"observable/derived",state:"updating",changedDependencies:a,initialComputation:false}}switch(r.state){case zt.initial:return{...o,type:"observable/derived",state:"noValue"};case zt.upToDate:return{...o,type:"observable/derived",state:"upToDate"};case zt.stale:return{...o,type:"observable/derived",state:"stale",changedDependencies:a};case zt.dependenciesMightHaveChanged:return{...o,type:"observable/derived",state:"possiblyStale"}}}else if(e instanceof B0){const n=this._getAutorunInfo(e);if(!n){return void 0}const s={name:e.debugName,instanceId:n.instanceId,updateCount:n.updateCount};const r=[...n.changedObservables].map(o=>this._instanceInfos.get(o).instanceId);if(e.debugGetState().isRunning){return{...s,type:"autorun",state:"updating",changedDependencies:r}}switch(e.debugGetState().state){case xi.upToDate:return{...s,type:"autorun",state:"upToDate"};case xi.stale:return{...s,type:"autorun",state:"stale",changedDependencies:r};case xi.dependenciesMightHaveChanged:return{...s,type:"autorun",state:"possiblyStale"}}}return void 0}_formatObservable(e){const i=this._getObservableInfo(e);if(!i){return void 0}return{name:e.debugName,instanceId:i.instanceId}}_formatObserver(e){if(e instanceof sr){return{name:e.toString(),instanceId:this._getObservableInfo(e)?.instanceId}}const i=this._getAutorunInfo(e);if(i){return{name:e.toString(),instanceId:i.instanceId}}return void 0}constructor(){this._declarationId=0;this._instanceId=0;this._declarations=new Map;this._instanceInfos=new WeakMap;this._aliveInstances=new Map;this._activeTransactions=new Set;this._channel=Z8("observableDevTools",()=>{return{notifications:{setDeclarationIdFilter:e=>{},logObservableValue:e=>{console.log("logObservableValue",e)},flushUpdates:()=>{this._flushUpdates()},resetUpdates:()=>{this._pendingChanges=null;this._channel.api.notifications.handleChange(this._fullState,true)}},requests:{getDeclarations:()=>{const e={};for(const i of this._declarations.values()){e[i.id]=i}return{decls:e}},getSummarizedInstances:()=>{return null},getObservableValueInfo:e=>{const i=this._aliveInstances.get(e);return{observers:[...i.debugGetObservers()].map(n=>this._formatObserver(n)).filter(ln)}},getDerivedInfo:e=>{const i=this._aliveInstances.get(e);return{dependencies:[...i.debugGetState().dependencies].map(n=>this._formatObservable(n)).filter(ln),observers:[...i.debugGetObservers()].map(n=>this._formatObserver(n)).filter(ln)}},getAutorunInfo:e=>{const i=this._aliveInstances.get(e);return{dependencies:[...i.debugGetState().dependencies].map(n=>this._formatObservable(n)).filter(ln)}},getTransactionState:()=>{return this.getTransactionState()},setValue:(e,i)=>{const n=this._aliveInstances.get(e);if(n instanceof sr){n.debugSetValue(i)}else if(n instanceof R_){n.debugSetValue(i)}else if(n instanceof qo){n.debugSetValue(i)}else{throw new Ji("Observable is not supported")}const s=[...n.debugGetObservers()];for(const r of s){r.beginUpdate(n)}for(const r of s){r.handleChange(n,void 0)}for(const r of s){r.endUpdate(n)}},getValue:e=>{const i=this._aliveInstances.get(e);if(i instanceof sr){return dr(i.debugGetState().value,200)}else if(i instanceof R_){return dr(i.debugGetState().value,200)}return void 0}}}});this._pendingChanges=null;this._changeThrottler=new i9;this._fullState={};this._flushUpdates=()=>{if(this._pendingChanges!==null){this._channel.api.notifications.handleChange(this._pendingChanges,false);this._pendingChanges=null}}}_handleChange(e){h4(this._fullState,e);if(this._pendingChanges===null){this._pendingChanges=e}else{d4(this._pendingChanges,e)}this._changeThrottler.throttle(this._flushUpdates,10)}_getDeclarationId(e){let i=true;let n;const s=Error;while(true){const o=s.stackTraceLimit;s.stackTraceLimit=i?6:20;const a=new Error().stack;s.stackTraceLimit=o;let l=FE(a,/[/\\]observableInternal[/\\]|\.observe|[/\\]util(s)?\./);if(!i&&!l){l=FE(a,/[/\\]observableInternal[/\\]|\.observe/)}if(l){n=l;break}if(!i){console.error("Could not find location for declaration",new Error().stack);n={fileName:"unknown",line:0,column:0,id:"unknown"};break}i=false}let r=this._declarations.get(n.id);if(r===void 0){r={id:this._declarationId++,type:e,url:n.fileName,line:n.line,column:n.column};this._declarations.set(n.id,r);this._handleChange({decls:{[r.id]:r}})}return r.id}handleObservableCreated(e){const i=this._getDeclarationId("observable/value");const n={declarationId:i,instanceId:this._instanceId++,listenerCount:0,lastValue:void 0,updateCount:0,changedObservables:new Set};this._instanceInfos.set(e,n)}handleOnListenerCountChanged(e,i){const n=this._getObservableInfo(e);if(!n){return}if(n.listenerCount===0&&i>0){const s=e instanceof sr?"observable/derived":"observable/value";this._aliveInstances.set(n.instanceId,e);this._handleChange({instances:{[n.instanceId]:{instanceId:n.instanceId,declarationId:n.declarationId,formattedValue:n.lastValue,type:s,name:e.debugName}}})}else if(n.listenerCount>0&&i===0){this._handleChange({instances:{[n.instanceId]:null}});this._aliveInstances.delete(n.instanceId)}n.listenerCount=i}handleObservableUpdated(e,i){if(e instanceof sr){this._handleDerivedRecomputed(e,i);return}const n=this._getObservableInfo(e);if(n){if(i.didChange){n.lastValue=dr(i.newValue,30);if(n.listenerCount>0){this._handleChange({instances:{[n.instanceId]:{formattedValue:n.lastValue}}})}}}}handleAutorunCreated(e){const i=this._getDeclarationId("autorun");const n={declarationId:i,instanceId:this._instanceId++,updateCount:0,changedObservables:new Set};this._instanceInfos.set(e,n);this._aliveInstances.set(n.instanceId,e);if(n){this._handleChange({instances:{[n.instanceId]:{instanceId:n.instanceId,declarationId:n.declarationId,runCount:0,type:"autorun",name:e.debugName}}})}}handleAutorunDisposed(e){const i=this._getAutorunInfo(e);if(!i){return}this._handleChange({instances:{[i.instanceId]:null}});this._instanceInfos.delete(e);this._aliveInstances.delete(i.instanceId)}handleAutorunDependencyChanged(e,i,n){const s=this._getAutorunInfo(e);if(!s){return}s.changedObservables.add(i)}handleAutorunStarted(e){}handleAutorunFinished(e){const i=this._getAutorunInfo(e);if(!i){return}i.changedObservables.clear();i.updateCount++;this._handleChange({instances:{[i.instanceId]:{runCount:i.updateCount}}})}handleDerivedDependencyChanged(e,i,n){const s=this._getObservableInfo(e);if(s){s.changedObservables.add(i)}}_handleDerivedRecomputed(e,i){const n=this._getObservableInfo(e);if(!n){return}const s=dr(i.newValue,30);n.updateCount++;n.changedObservables.clear();n.lastValue=s;if(n.listenerCount>0){this._handleChange({instances:{[n.instanceId]:{formattedValue:s,recomputationCount:n.updateCount}}})}}handleDerivedCleared(e){const i=this._getObservableInfo(e);if(!i){return}i.lastValue=void 0;i.changedObservables.clear();if(i.listenerCount>0){this._handleChange({instances:{[i.instanceId]:{formattedValue:void 0}}})}}handleBeginTransaction(e){this._activeTransactions.add(e)}handleEndTransaction(e){this._activeTransactions.delete(e)}}R8(j8);if(Gu&&Gu["VSCODE_DEV_DEBUG"]){r4(pl.getInstance())}class oi{static fromTo(e,i){return new oi(e,i)}static addRange(e,i){let n=0;while(n<i.length&&i[n].endExclusive<e.start){n++}let s=n;while(s<i.length&&i[s].start<=e.endExclusive){s++}if(n===s){i.splice(n,0,e)}else{const r=Math.min(e.start,i[n].start);const o=Math.max(e.endExclusive,i[s-1].endExclusive);i.splice(n,s-n,new oi(r,o))}}static tryCreate(e,i){if(e>i){return void 0}return new oi(e,i)}static ofLength(e){return new oi(0,e)}static ofStartAndLength(e,i){return new oi(e,e+i)}static emptyAt(e){return new oi(e,e)}constructor(e,i){this.start=e;this.endExclusive=i;if(e>i){throw new Ji(`Invalid range: ${this.toString()}`)}}get isEmpty(){return this.start===this.endExclusive}delta(e){return new oi(this.start+e,this.endExclusive+e)}deltaStart(e){return new oi(this.start+e,this.endExclusive)}deltaEnd(e){return new oi(this.start,this.endExclusive+e)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}equals(e){return this.start===e.start&&this.endExclusive===e.endExclusive}containsRange(e){return this.start<=e.start&&e.endExclusive<=this.endExclusive}contains(e){return this.start<=e&&e<this.endExclusive}join(e){return new oi(Math.min(this.start,e.start),Math.max(this.endExclusive,e.endExclusive))}intersect(e){const i=Math.max(this.start,e.start);const n=Math.min(this.endExclusive,e.endExclusive);if(i<=n){return new oi(i,n)}return void 0}intersectionLength(e){const i=Math.max(this.start,e.start);const n=Math.min(this.endExclusive,e.endExclusive);return Math.max(0,n-i)}intersects(e){const i=Math.max(this.start,e.start);const n=Math.min(this.endExclusive,e.endExclusive);return i<n}intersectsOrTouches(e){const i=Math.max(this.start,e.start);const n=Math.min(this.endExclusive,e.endExclusive);return i<=n}isBefore(e){return this.endExclusive<=e.start}isAfter(e){return this.start>=e.endExclusive}slice(e){return e.slice(this.start,this.endExclusive)}substring(e){return e.substring(this.start,this.endExclusive)}clip(e){if(this.isEmpty){throw new Ji(`Invalid clipping range: ${this.toString()}`)}return Math.max(this.start,Math.min(this.endExclusive-1,e))}clipCyclic(e){if(this.isEmpty){throw new Ji(`Invalid clipping range: ${this.toString()}`)}if(e<this.start){return this.endExclusive-(this.start-e)%this.length}if(e>=this.endExclusive){return this.start+(e-this.start)%this.length}return e}map(e){const i=[];for(let n=this.start;n<this.endExclusive;n++){i.push(e(n))}return i}forEach(e){for(let i=this.start;i<this.endExclusive;i++){e(i)}}}const jo="**";const L_="/";const nf="[/\\\\]";const sf="[^/\\\\]";const n9=/\//g;function ME(t,e){switch(t){case 0:return"";case 1:return`${sf}*?`;default:return`(?:${nf}|${sf}+${nf}${e?`|${nf}${sf}+`:""})*?`}}function N_(t,e){if(!t){return[]}const i=[];let n=false;let s=false;let r="";for(const o of t){switch(o){case e:if(!n&&!s){i.push(r);r="";continue}break;case"{":n=true;break;case"}":n=false;break;case"[":s=true;break;case"]":s=false;break}r+=o}if(r){i.push(r)}return i}function f4(t){if(!t){return""}let e="";const i=N_(t,L_);if(i.every(n=>n===jo)){e=".*"}else{let n=false;i.forEach((s,r)=>{if(s===jo){if(n){return}e+=ME(2,r===i.length-1)}else{let o=false;let a="";let l=false;let c="";for(const u of s){if(u!=="}"&&o){a+=u;continue}if(l&&(u!=="]"||!c)){let d;if(u==="-"){d=u}else if((u==="^"||u==="!")&&!c){d="^"}else if(u===L_){d=""}else{d=ya(u)}c+=d;continue}switch(u){case"{":o=true;continue;case"[":l=true;continue;case"}":{const d=N_(a,",");const p=`(?:${d.map(f=>f4(f)).join("|")})`;e+=p;o=false;a="";break}case"]":{e+="["+c+"]";l=false;c="";break}case"?":e+=sf;continue;case"*":e+=ME(1);continue;default:e+=ya(u)}}if(r<i.length-1&&(i[r+1]!==jo||r+2<i.length)){e+=nf}}n=s===jo})}return e}const s9=/^\*\*\/\*\.[\w\.-]+$/;const r9=/^\*\*\/([\w\.-]+)\/?$/;const o9=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/;const a9=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/;const l9=/^\*\*((\/[\w\.-]+)+)\/?$/;const c9=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/;const UE=new f0(1e4);const $E=function(){return false};const Ps=function(){return null};function q0(t,e){if(!t){return Ps}let i;if(typeof t!=="string"){i=t.pattern}else{i=t}i=i.trim();const n=`${i}_${!!e.trimForExclusions}`;let s=UE.get(n);if(s){return HE(s,t)}let r;if(s9.test(i)){s=u9(i.substr(4),i)}else if(r=r9.exec(S1(i,e))){s=d9(r[1],i)}else if((e.trimForExclusions?a9:o9).test(i)){s=h9(i,e)}else if(r=l9.exec(S1(i,e))){s=BE(r[1].substr(1),i,true)}else if(r=c9.exec(S1(i,e))){s=BE(r[1],i,false)}else{s=f9(i)}UE.set(n,s);return HE(s,t)}function HE(t,e){if(typeof e==="string"){return t}const i=function(n,s){if(!Uf(n,e.base,!Er)){return null}return t(XT(n.substr(e.base.length),os),s)};i.allBasenames=t.allBasenames;i.allPaths=t.allPaths;i.basenames=t.basenames;i.patterns=t.patterns;return i}function S1(t,e){return e.trimForExclusions&&t.endsWith("/**")?t.substr(0,t.length-2):t}function u9(t,e){return function(i,n){return typeof i==="string"&&i.endsWith(t)?e:null}}function d9(t,e){const i=`/${t}`;const n=`\\${t}`;const s=function(o,a){if(typeof o!=="string"){return null}if(a){return a===t?e:null}return o===t||o.endsWith(i)||o.endsWith(n)?e:null};const r=[t];s.basenames=r;s.patterns=[e];s.allBasenames=r;return s}function h9(t,e){const i=p4(t.slice(1,-1).split(",").map(a=>q0(a,e)).filter(a=>a!==Ps),t);const n=i.length;if(!n){return Ps}if(n===1){return i[0]}const s=function(a,l){for(let c=0,u=i.length;c<u;c++){if(i[c](a,l)){return t}}return null};const r=i.find(a=>!!a.allBasenames);if(r){s.allBasenames=r.allBasenames}const o=i.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);if(o.length){s.allPaths=o}return s}function BE(t,e,i){const n=os===ct.sep;const s=n?t:t.replace(n9,os);const r=os+s;const o=ct.sep+t;let a;if(i){a=function(l,c){return typeof l==="string"&&(l===s||l.endsWith(r)||!n&&(l===t||l.endsWith(o)))?e:null}}else{a=function(l,c){return typeof l==="string"&&(l===s||!n&&l===t)?e:null}}a.allPaths=[(i?"*/":"./")+t];return a}function f9(t){try{const e=new RegExp(`^${f4(t)}$`);return function(i){e.lastIndex=0;return typeof i==="string"&&e.test(i)?t:null}}catch(e){return Ps}}function Su(t,e,i){if(!t||typeof e!=="string"){return false}return Yl(t)(e,void 0,i)}function Yl(t,e={}){if(!t){return $E}if(typeof t==="string"||p9(t)){const i=q0(t,e);if(i===Ps){return $E}const n=function(s,r){return!!i(s,r)};if(i.allBasenames){n.allBasenames=i.allBasenames}if(i.allPaths){n.allPaths=i.allPaths}return n}return g9(t,e)}function p9(t){const e=t;if(!e){return false}return typeof e.base==="string"&&typeof e.pattern==="string"}function g9(t,e){const i=p4(Object.getOwnPropertyNames(t).map(a=>m9(a,t[a],e)).filter(a=>a!==Ps));const n=i.length;if(!n){return Ps}if(!i.some(a=>!!a.requiresSiblings)){if(n===1){return i[0]}const a=function(u,d){let p=void 0;for(let f=0,m=i.length;f<m;f++){const v=i[f](u,d);if(typeof v==="string"){return v}if(po(v)){if(!p){p=[]}p.push(v)}}if(p){return(async()=>{for(const f of p){const m=await f;if(typeof m==="string"){return m}}return null})()}return null};const l=i.find(u=>!!u.allBasenames);if(l){a.allBasenames=l.allBasenames}const c=i.reduce((u,d)=>d.allPaths?u.concat(d.allPaths):u,[]);if(c.length){a.allPaths=c}return a}const s=function(a,l,c){let u=void 0;let d=void 0;for(let p=0,f=i.length;p<f;p++){const m=i[p];if(m.requiresSiblings&&c){if(!l){l=rn(a)}if(!u){u=l.substr(0,l.length-o_(a).length)}}const v=m(a,l,u,c);if(typeof v==="string"){return v}if(po(v)){if(!d){d=[]}d.push(v)}}if(d){return(async()=>{for(const p of d){const f=await p;if(typeof f==="string"){return f}}return null})()}return null};const r=i.find(a=>!!a.allBasenames);if(r){s.allBasenames=r.allBasenames}const o=i.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);if(o.length){s.allPaths=o}return s}function m9(t,e,i){if(e===false){return Ps}const n=q0(t,i);if(n===Ps){return Ps}if(typeof e==="boolean"){return n}if(e){const s=e.when;if(typeof s==="string"){const r=(o,a,l,c)=>{if(!c||!n(o,a)){return null}const u=s.replace("$(basename)",()=>l);const d=c(u);return po(d)?d.then(p=>p?t:null):d?t:null};r.requiresSiblings=true;return r}}return n}function p4(t,e){const i=t.filter(a=>!!a.basenames);if(i.length<2){return t}const n=i.reduce((a,l)=>{const c=l.basenames;return c?a.concat(c):a},[]);let s;if(e){s=[];for(let a=0,l=n.length;a<l;a++){s.push(e)}}else{s=i.reduce((a,l)=>{const c=l.patterns;return c?a.concat(c):a},[])}const r=function(a,l){if(typeof a!=="string"){return null}if(!l){let u;for(u=a.length;u>0;u--){const d=a.charCodeAt(u-1);if(d===A.Slash||d===A.Backslash){break}}l=a.substr(u)}const c=n.indexOf(l);return c!==-1?s[c]:null};r.basenames=n;r.patterns=s;r.allBasenames=n;const o=t.filter(a=>!a.basenames);o.push(r);return o}const O_=["W","X","Y","Z","a","b","c","d","e","f"];const _9=new RegExp(`^[${O_.join("")}]+`);const g4=7;function m4(t){if(t.scheme!==ae.vscodeNotebookCell){return void 0}const e=t.fragment.indexOf("s");if(e<0){return void 0}const i=parseInt(t.fragment.substring(0,e).replace(_9,""),g4);const n=Tf(t.fragment.substring(e+1)).toString();if(isNaN(i)){return void 0}return{handle:i,notebook:t.with({scheme:n,fragment:null})}}function v9(t,e){const i=e.toString(g4);const n=i.length<O_.length?O_[i.length-1]:"z";const s=`${n}${i}s${m0(ue.fromString(t.scheme),true,true)}`;return t.with({scheme:ae.vscodeNotebookCell,fragment:s})}function w9(t){if(t.scheme!==ae.vscodeNotebookMetadata){return void 0}const e=Tf(t.fragment).toString();return t.with({scheme:e,fragment:null})}function b9(t){const e=`${m0(ue.fromString(t.scheme),true,true)}`;return t.with({scheme:ae.vscodeNotebookMetadata,fragment:e})}function y9(t){if(t.scheme!==ae.vscodeNotebookCellOutput){return}const e=new URLSearchParams(t.query);const i=e.get("openIn");if(!i){return}const n=e.get("outputId")??void 0;const s=m4(t.with({scheme:ae.vscodeNotebookCell,query:null}));const r=e.get("outputIndex")?parseInt(e.get("outputIndex")||"",10):void 0;const o=s?s.notebook:t.with({scheme:e.get("notebookScheme")||ae.file,fragment:null,query:null});const a=e.get("cellIndex")?parseInt(e.get("cellIndex")||"",10):void 0;return{notebook:o,openIn:i,outputId:n,outputIndex:r,cellHandle:s?.handle,cellFragment:t.fragment,cellIndex:a}}var gl;(function(t){t[t["Markup"]=1]="Markup";t[t["Code"]=2]="Code"})(gl||(gl={}));["application/json","application/javascript","text/html","image/svg+xml",vr.latex,vr.markdown,"image/png","image/jpeg",vr.text];[vr.latex,vr.markdown,"application/json","text/html","image/svg+xml","image/png","image/jpeg",vr.text];var VE;(function(t){t[t["Running"]=1]="Running";t[t["Idle"]=2]="Idle"})(VE||(VE={}));var Du;(function(t){t[t["Unconfirmed"]=1]="Unconfirmed";t[t["Pending"]=2]="Pending";t[t["Executing"]=3]="Executing"})(Du||(Du={}));var WE;(function(t){t[t["Unconfirmed"]=1]="Unconfirmed";t[t["Pending"]=2]="Pending";t[t["Executing"]=3]="Executing"})(WE||(WE={}));var zE;(function(t){t[t["WithHardKernelDependency"]=0]="WithHardKernelDependency";t[t["WithOptionalKernelDependency"]=1]="WithOptionalKernelDependency";t[t["Pure"]=2]="Pure";t[t["Never"]=3]="Never"})(zE||(zE={}));var qE;(function(t){t["Always"]="always";t["Never"]="never";t["Optional"]="optional"})(qE||(qE={}));var qn;(function(t){t[t["ModelChange"]=1]="ModelChange";t[t["Move"]=2]="Move";t[t["ChangeCellLanguage"]=5]="ChangeCellLanguage";t[t["Initialize"]=6]="Initialize";t[t["ChangeCellMetadata"]=7]="ChangeCellMetadata";t[t["Output"]=8]="Output";t[t["OutputItem"]=9]="OutputItem";t[t["ChangeCellContent"]=10]="ChangeCellContent";t[t["ChangeDocumentMetadata"]=11]="ChangeDocumentMetadata";t[t["ChangeCellInternalMetadata"]=12]="ChangeCellInternalMetadata";t[t["ChangeCellMime"]=13]="ChangeCellMime";t[t["Unknown"]=100]="Unknown"})(qn||(qn={}));var jE;(function(t){t[t["Handle"]=0]="Handle";t[t["Index"]=1]="Index"})(jE||(jE={}));var uo;(function(t){t[t["Replace"]=1]="Replace";t[t["Output"]=2]="Output";t[t["Metadata"]=3]="Metadata";t[t["CellLanguage"]=4]="CellLanguage";t[t["DocumentMetadata"]=5]="DocumentMetadata";t[t["Move"]=6]="Move";t[t["OutputItems"]=7]="OutputItems";t[t["PartialMetadata"]=8]="PartialMetadata";t[t["PartialInternalMetadata"]=9]="PartialInternalMetadata"})(uo||(uo={}));var GE;(function(t){t.scheme=ae.vscodeNotebookMetadata;function e(n){return b9(n)}t.generate=e;function i(n){return w9(n)}t.parse=i})(GE||(GE={}));var sp;(function(t){t.scheme=ae.vscodeNotebookCell;function e(c,u){return v9(c,u)}t.generate=e;function i(c){return m4(c)}t.parse=i;function n(c,u){return c.with({scheme:ae.vscodeNotebookCellOutput,query:new URLSearchParams({openIn:"editor",outputId:u??"",notebookScheme:c.scheme!==ae.file?c.scheme:""}).toString()})}t.generateCellOutputUriWithId=n;function s(c,u,d){return c.with({scheme:ae.vscodeNotebookCellOutput,fragment:u.fragment,query:new URLSearchParams({openIn:"notebook",outputIndex:String(d)}).toString()})}t.generateCellOutputUriWithIndex=s;function r(c,u,d,p,f){return c.with({scheme:ae.vscodeNotebookCellOutput,query:new URLSearchParams({openIn:"notebookOutputEditor",notebook:c.toString(),cellIndex:String(d),outputId:p,outputIndex:String(f)}).toString()})}t.generateOutputEditorUri=r;function o(c){return y9(c)}t.parseCellOutputUri=o;function a(c,u,d){return t.generate(c,u).with({scheme:d})}t.generateCellPropertyUri=a;function l(c,u){if(c.scheme!==u){return void 0}return t.parse(c.with({scheme:t.scheme}))}t.parseCellPropertyUri=l})(sp||(sp={}));new T("notebookEditorCursorAtBoundary","none");new T("notebookEditorCursorAtLineBoundary","none");var KE;(function(t){t["default"]="default";t["option"]="option"})(KE||(KE={}));var QE;(function(t){t["Cells"]="cells";t["Text"]="text";t["None"]="none"})(QE||(QE={}));var rp;(function(t){t[t["Left"]=1]="Left";t[t["Right"]=2]="Right"})(rp||(rp={}));function _4(t){return["application/vnd.code.notebook.stdout","application/vnd.code.notebook.stderr"].includes(t)}const x9=new TextDecoder;function E9(t){const e=[];let i=false;for(const o of t){if(e.length===0||i){e.push(o);i=true}}let n=D9(e);const s=ue.concat(e.map(o=>ue.wrap(o)));const r=P9(s);n=n||r.byteLength!==s.byteLength;return{data:r,didCompression:n}}const rf=`${String.fromCharCode(27)}[A`;const D1=rf.split("").map(t=>t.charCodeAt(0));const S9=10;function D9(t){let e=false;t.forEach((i,n)=>{if(n===0||i.length<rf.length){return}const s=t[n-1];const r=i.subarray(0,rf.length);if(r[0]===D1[0]&&r[1]===D1[1]&&r[2]===D1[2]){const o=s.lastIndexOf(S9);if(o===-1){return}e=true;t[n-1]=s.subarray(0,o);t[n]=i.subarray(rf.length)}});return e}function k9(t){let e=t;do{t=e;e=t.replace(/[^\n]\x08/gm,"")}while(e.length<t.length);return t}function I9(t){t=t.replace(/\r+\n/gm,"\n");while(t.search(/\r[^$]/g)>-1){const e=t.match(/^(.*)\r+/m)[1];let i=t.match(/\r+(.*)$/m)[1];i=i+e.slice(i.length,e.length);t=t.replace(/\r+.*$/m,"\r").replace(/^.*\r/m,i)}return t}const C9="\b".charCodeAt(0);const T9="\r".charCodeAt(0);function P9(t){if(!t.buffer.includes(C9)&&!t.buffer.includes(T9)){return t}return ue.fromString(I9(k9(x9.decode(t.buffer))))}const Im=xe("contextKeyService");const A9=xe("productService");var di;(function(t){t[t["APPLICATION"]=1]="APPLICATION";t[t["USER"]=2]="USER";t[t["USER_LOCAL"]=3]="USER_LOCAL";t[t["USER_REMOTE"]=4]="USER_REMOTE";t[t["WORKSPACE"]=5]="WORKSPACE";t[t["WORKSPACE_FOLDER"]=6]="WORKSPACE_FOLDER";t[t["DEFAULT"]=7]="DEFAULT";t[t["MEMORY"]=8]="MEMORY"})(di||(di={}));function F_(t,e){const i=Object.create(null);for(const n in t){v4(i,n,t[n],e)}return i}function v4(t,e,i,n){const s=e.split(".");const r=s.pop();let o=t;for(let a=0;a<s.length;a++){const l=s[a];let c=o[l];switch(typeof c){case"undefined":c=o[l]=Object.create(null);break;case"object":if(c===null){n(`Ignoring ${e} as ${s.slice(0,a+1).join(".")} is null`);return}break;default:n(`Ignoring ${e} as ${s.slice(0,a+1).join(".")} is ${JSON.stringify(c)}`);return}o=c}if(typeof o==="object"&&o!==null){try{o[r]=i}catch(a){n(`Ignoring ${e} as ${s.join(".")} is ${JSON.stringify(o)}`)}}else{n(`Ignoring ${e} as ${s.join(".")} is ${JSON.stringify(o)}`)}}function R9(t,e){const i=e.split(".");w4(t,i)}function w4(t,e){if(!t){return}const i=e.shift();if(e.length===0){delete t[i];return}if(Object.keys(t).indexOf(i)!==-1){const n=t[i];if(typeof n==="object"&&!Array.isArray(n)){w4(n,e);if(Object.keys(n).length===0){delete t[i]}}}}function op(t,e,i){function n(o,a){let l=o;for(const c of a){if(typeof l!=="object"||l===null){return void 0}l=l[c]}return l}const s=e.split(".");const r=n(t,s);return typeof r==="undefined"?i:r}function L9(t){return t.replace(/[\[\]]/g,"")}function N9(t){let e=false;const i=new Map;const n=new Map;const s=u=>{if(t===u){return true}const d=JSON.stringify(u);if(d.length<30){return true}const p=i.get(d);if(!p){const f={schemas:[u]};i.set(d,f);n.set(u,f);return true}p.schemas.push(u);n.set(u,p);e=true;return false};O9(t,s);i.clear();if(!e){return JSON.stringify(t)}let r="$defs";while(t.hasOwnProperty(r)){r+="_"}const o=[];function a(u){return JSON.stringify(u,(d,p)=>{if(p!==u){const f=n.get(p);if(f&&f.schemas.length>1){if(!f.id){f.id=`_${o.length}`;o.push(f.schemas[0])}return{$ref:`#/${r}/${f.id}`}}}return p})}const l=a(t);const c=[];for(let u=0;u<o.length;u++){c.push(`"_${u}":${a(o[u])}`)}if(c.length){return`${l.substring(0,l.length-1)},"${r}":{${c.join(",")}}}`}return l}function Xa(t){return typeof t==="object"&&t!==null}function O9(t,e){if(!t||typeof t!=="object"){return}const i=(...l)=>{for(const c of l){if(Xa(c)){o.push(c)}}};const n=(...l)=>{for(const c of l){if(Xa(c)){for(const u in c){const d=c[u];if(Xa(d)){o.push(d)}}}}};const s=(...l)=>{for(const c of l){if(Array.isArray(c)){for(const u of c){if(Xa(u)){o.push(u)}}}}};const r=l=>{if(Array.isArray(l)){for(const c of l){if(Xa(c)){o.push(c)}}}else if(Xa(l)){o.push(l)}};const o=[t];let a=o.pop();while(a){const l=e(a);if(l){i(a.additionalItems,a.additionalProperties,a.not,a.contains,a.propertyNames,a.if,a.then,a.else,a.unevaluatedItems,a.unevaluatedProperties);n(a.definitions,a.$defs,a.properties,a.patternProperties,a.dependencies,a.dependentSchemas);s(a.anyOf,a.allOf,a.oneOf,a.prefixItems);r(a.items)}a=o.pop()}}const Cm={JSONContribution:"base.contributions.json"};function JE(t){if(t.length>0&&t.charAt(t.length-1)==="#"){return t.substring(0,t.length-1)}return t}class F9 extends Ee{constructor(){super(...arguments);this.schemasById={};this.schemaAssociations={};this._onDidChangeSchema=this._register(new L);this.onDidChangeSchema=this._onDidChangeSchema.event;this._onDidChangeSchemaAssociations=this._register(new L);this.onDidChangeSchemaAssociations=this._onDidChangeSchemaAssociations.event}registerSchema(e,i,n){const s=JE(e);this.schemasById[s]=i;this._onDidChangeSchema.fire(e);if(n){n.add(ge(()=>{delete this.schemasById[s];this._onDidChangeSchema.fire(e)}))}}registerSchemaAssociation(e,i){const n=JE(e);if(!this.schemaAssociations[n]){this.schemaAssociations[n]=[]}if(!this.schemaAssociations[n].includes(i)){this.schemaAssociations[n].push(i);this._onDidChangeSchemaAssociations.fire()}return ge(()=>{const s=this.schemaAssociations[n];if(s){const r=s.indexOf(i);if(r!==-1){s.splice(r,1);if(s.length===0){delete this.schemaAssociations[n]}this._onDidChangeSchemaAssociations.fire()}}})}notifySchemaChanged(e){this._onDidChangeSchema.fire(e)}getSchemaContributions(){return{schemas:this.schemasById}}getSchemaContent(e){const i=this.schemasById[e];return i?N9(i):void 0}hasSchemaContent(e){return!!this.schemasById[e]}getSchemaAssociations(){return this.schemaAssociations}}const M9=new F9;ci.add(Cm.JSONContribution,M9);var XE;(function(t){t["Multiline"]="multilineText";t["Singleline"]="singlelineText"})(XE||(XE={}));const $a={Configuration:"base.contributions.configuration"};var wt;(function(t){t[t["APPLICATION"]=1]="APPLICATION";t[t["MACHINE"]=2]="MACHINE";t[t["APPLICATION_MACHINE"]=3]="APPLICATION_MACHINE";t[t["WINDOW"]=4]="WINDOW";t[t["RESOURCE"]=5]="RESOURCE";t[t["LANGUAGE_OVERRIDABLE"]=6]="LANGUAGE_OVERRIDABLE";t[t["MACHINE_OVERRIDABLE"]=7]="MACHINE_OVERRIDABLE"})(wt||(wt={}));const Ya="vscode://schemas/settings/resourceLanguage";const Th=ci.as(Cm.JSONContribution);class U9 extends Ee{constructor(){super();this.registeredConfigurationDefaults=[];this.overrideIdentifiers=new Set;this._onDidSchemaChange=this._register(new L);this.onDidSchemaChange=this._onDidSchemaChange.event;this._onDidUpdateConfiguration=this._register(new L);this.onDidUpdateConfiguration=this._onDidUpdateConfiguration.event;this.configurationDefaultsOverrides=new Map;this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:h(1708,"Default Language Configuration Overrides"),properties:{}};this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode];this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:true,allowTrailingCommas:true,allowComments:true};this.configurationProperties={};this.policyConfigurations=new Map;this.excludedConfigurationProperties={};Th.registerSchema(Ya,this.resourceLanguageSettingsSchema);this.registerOverridePropertyPatternKey()}registerConfiguration(e,i=true){this.registerConfigurations([e],i);return e}registerConfigurations(e,i=true){const n=new Set;this.doRegisterConfigurations(e,i,n);Th.registerSchema(Ya,this.resourceLanguageSettingsSchema);this._onDidSchemaChange.fire();this._onDidUpdateConfiguration.fire({properties:n})}deregisterConfigurations(e){const i=new Set;this.doDeregisterConfigurations(e,i);Th.registerSchema(Ya,this.resourceLanguageSettingsSchema);this._onDidSchemaChange.fire();this._onDidUpdateConfiguration.fire({properties:i})}updateConfigurations({add:e,remove:i}){const n=new Set;this.doDeregisterConfigurations(i,n);this.doRegisterConfigurations(e,false,n);Th.registerSchema(Ya,this.resourceLanguageSettingsSchema);this._onDidSchemaChange.fire();this._onDidUpdateConfiguration.fire({properties:n})}registerDefaultConfigurations(e){const i=new Set;this.doRegisterDefaultConfigurations(e,i);this._onDidSchemaChange.fire();this._onDidUpdateConfiguration.fire({properties:i,defaultsOverrides:true})}doRegisterDefaultConfigurations(e,i){this.registeredConfigurationDefaults.push(...e);const n=[];for(const{overrides:s,source:r}of e){for(const o in s){i.add(o);const a=this.configurationDefaultsOverrides.get(o)??this.configurationDefaultsOverrides.set(o,{configurationDefaultOverrides:[]}).get(o);const l=s[o];a.configurationDefaultOverrides.push({value:l,source:r});if(As.test(o)){const c=this.mergeDefaultConfigurationsForOverrideIdentifier(o,l,r,a.configurationDefaultOverrideValue);if(!c){continue}a.configurationDefaultOverrideValue=c;this.updateDefaultOverrideProperty(o,c,r);n.push(...ed(o))}else{const c=this.mergeDefaultConfigurationsForConfigurationProperty(o,l,r,a.configurationDefaultOverrideValue);if(!c){continue}a.configurationDefaultOverrideValue=c;const u=this.configurationProperties[o];if(u){this.updatePropertyDefaultValue(o,u);this.updateSchema(o,u)}}}}this.doRegisterOverrideIdentifiers(n)}deregisterDefaultConfigurations(e){const i=new Set;this.doDeregisterDefaultConfigurations(e,i);this._onDidSchemaChange.fire();this._onDidUpdateConfiguration.fire({properties:i,defaultsOverrides:true})}doDeregisterDefaultConfigurations(e,i){for(const n of e){const s=this.registeredConfigurationDefaults.indexOf(n);if(s!==-1){this.registeredConfigurationDefaults.splice(s,1)}}for(const{overrides:n,source:s}of e){for(const r in n){const o=this.configurationDefaultsOverrides.get(r);if(!o){continue}const a=o.configurationDefaultOverrides.findIndex(l=>s?l.source?.id===s.id:l.value===n[r]);if(a===-1){continue}o.configurationDefaultOverrides.splice(a,1);if(o.configurationDefaultOverrides.length===0){this.configurationDefaultsOverrides.delete(r)}if(As.test(r)){let l;for(const c of o.configurationDefaultOverrides){l=this.mergeDefaultConfigurationsForOverrideIdentifier(r,c.value,c.source,l)}if(l&&!Uk(l.value)){o.configurationDefaultOverrideValue=l;this.updateDefaultOverrideProperty(r,l,s)}else{this.configurationDefaultsOverrides.delete(r);delete this.configurationProperties[r];delete this.defaultLanguageConfigurationOverridesNode.properties[r]}}else{let l;for(const u of o.configurationDefaultOverrides){l=this.mergeDefaultConfigurationsForConfigurationProperty(r,u.value,u.source,l)}o.configurationDefaultOverrideValue=l;const c=this.configurationProperties[r];if(c){this.updatePropertyDefaultValue(r,c);this.updateSchema(r,c)}}i.add(r)}}this.updateOverridePropertyPatternKey()}updateDefaultOverrideProperty(e,i,n){const s={type:"object",default:i.value,description:h(1709,"Configure settings to be overridden for the {0} language.",L9(e)),$ref:Ya,defaultDefaultValue:i.value,source:n,defaultValueSource:n};this.configurationProperties[e]=s;this.defaultLanguageConfigurationOverridesNode.properties[e]=s}mergeDefaultConfigurationsForOverrideIdentifier(e,i,n,s){const r=s?.value||{};const o=s?.source??new Map;if(!(o instanceof Map)){console.error("objectConfigurationSources is not a Map");return void 0}for(const a of Object.keys(i)){const l=i[a];const c=Yt(l)&&(iu(r[a])||Yt(r[a]));if(c){r[a]={...r[a]??{},...l};if(n){for(const u in l){o.set(`${a}.${u}`,n)}}}else{r[a]=l;if(n){o.set(a,n)}else{o.delete(a)}}}return{value:r,source:o}}mergeDefaultConfigurationsForConfigurationProperty(e,i,n,s){const r=this.configurationProperties[e];const o=s?.value??r?.defaultDefaultValue;let a=n;const l=Yt(i)&&(r!==void 0&&r.type==="object"||r===void 0&&(iu(o)||Yt(o)));if(l){a=s?.source??new Map;if(!(a instanceof Map)){console.error("defaultValueSource is not a Map");return void 0}for(const c in i){if(n){a.set(`${e}.${c}`,n)}}i={...Yt(o)?o:{},...i}}return{value:i,source:a}}deltaConfiguration(e){let i=false;const n=new Set;if(e.removedDefaults){this.doDeregisterDefaultConfigurations(e.removedDefaults,n);i=true}if(e.addedDefaults){this.doRegisterDefaultConfigurations(e.addedDefaults,n);i=true}if(e.removedConfigurations){this.doDeregisterConfigurations(e.removedConfigurations,n)}if(e.addedConfigurations){this.doRegisterConfigurations(e.addedConfigurations,false,n)}this._onDidSchemaChange.fire();this._onDidUpdateConfiguration.fire({properties:n,defaultsOverrides:i})}notifyConfigurationSchemaUpdated(...e){this._onDidSchemaChange.fire()}registerOverrideIdentifiers(e){this.doRegisterOverrideIdentifiers(e);this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(e){for(const i of e){this.overrideIdentifiers.add(i)}this.updateOverridePropertyPatternKey()}doRegisterConfigurations(e,i,n){e.forEach(s=>{this.validateAndRegisterProperties(s,i,s.extensionInfo,s.restrictedProperties,void 0,n);this.configurationContributors.push(s);this.registerJSONConfiguration(s)})}doDeregisterConfigurations(e,i){const n=s=>{if(s.properties){for(const r in s.properties){i.add(r);const o=this.configurationProperties[r];if(o?.policy?.name){this.policyConfigurations.delete(o.policy.name)}delete this.configurationProperties[r];this.removeFromSchema(r,s.properties[r])}}s.allOf?.forEach(r=>n(r))};for(const s of e){n(s);const r=this.configurationContributors.indexOf(s);if(r!==-1){this.configurationContributors.splice(r,1)}}}validateAndRegisterProperties(e,i=true,n,s,r=wt.WINDOW,o){r=Xt(e.scope)?r:e.scope;const a=e.properties;if(a){for(const c in a){const u=a[c];if(i&&B9(c,u)){delete a[c];continue}u.source=n;u.defaultDefaultValue=a[c].default;this.updatePropertyDefaultValue(c,u);if(As.test(c)){u.scope=void 0}else{u.scope=Xt(u.scope)?r:u.scope;u.restricted=Xt(u.restricted)?!!s?.includes(c):u.restricted}const d=a[c].hasOwnProperty("included")&&!a[c].included;const p=a[c].policy?.name;if(d){this.excludedConfigurationProperties[c]=a[c];if(p){this.policyConfigurations.set(p,c);o.add(c)}delete a[c]}else{o.add(c);if(p){this.policyConfigurations.set(p,c)}this.configurationProperties[c]=a[c];if(!a[c].deprecationMessage&&a[c].markdownDeprecationMessage){a[c].deprecationMessage=a[c].markdownDeprecationMessage}}}}const l=e.allOf;if(l){for(const c of l){this.validateAndRegisterProperties(c,i,n,s,r,o)}}}getConfigurations(){return this.configurationContributors}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}getExcludedConfigurationProperties(){return this.excludedConfigurationProperties}getRegisteredDefaultConfigurations(){return[...this.registeredConfigurationDefaults]}getConfigurationDefaultsOverrides(){const e=new Map;for(const[i,n]of this.configurationDefaultsOverrides){if(n.configurationDefaultOverrideValue){e.set(i,n.configurationDefaultOverrideValue)}}return e}registerJSONConfiguration(e){const i=n=>{const s=n.properties;if(s){for(const o in s){this.updateSchema(o,s[o])}}const r=n.allOf;r?.forEach(i)};i(e)}updateSchema(e,i){switch(i.scope){case wt.APPLICATION:break;case wt.MACHINE:break;case wt.APPLICATION_MACHINE:break;case wt.MACHINE_OVERRIDABLE:break;case wt.WINDOW:break;case wt.RESOURCE:break;case wt.LANGUAGE_OVERRIDABLE:this.resourceLanguageSettingsSchema.properties[e]=i;break}}removeFromSchema(e,i){switch(i.scope){case wt.APPLICATION:break;case wt.MACHINE:break;case wt.APPLICATION_MACHINE:break;case wt.MACHINE_OVERRIDABLE:break;case wt.WINDOW:break;case wt.RESOURCE:case wt.LANGUAGE_OVERRIDABLE:delete this.resourceLanguageSettingsSchema.properties[e];break}}updateOverridePropertyPatternKey(){for(const e of this.overrideIdentifiers.values()){const i=`[${e}]`;const n={type:"object",description:h(1710,"Configure editor settings to be overridden for a language."),errorMessage:h(1711,"This setting does not support per-language configuration."),$ref:Ya};this.updatePropertyDefaultValue(i,n)}}registerOverridePropertyPatternKey(){({description:h(1710,"Configure editor settings to be overridden for a language."),errorMessage:h(1711,"This setting does not support per-language configuration.")});this._onDidSchemaChange.fire()}updatePropertyDefaultValue(e,i){const n=this.configurationDefaultsOverrides.get(e)?.configurationDefaultOverrideValue;let s=void 0;let r=void 0;if(n&&(!i.disallowConfigurationDefault||!n.source)){s=n.value;r=n.source}if(iu(s)){s=i.defaultDefaultValue;r=void 0}if(iu(s)){s=H9(i.type)}i.default=s;i.defaultValueSource=r}}const b4=`\\[([^\\]]+)\\]`;const YE=new RegExp(b4,"g");const $9=`^(${b4})+$`;const As=new RegExp($9);function ed(t){const e=[];if(As.test(t)){let i=YE.exec(t);while(i?.length){const n=i[1].trim();if(n){e.push(n)}i=YE.exec(t)}}return sl(e)}function H9(t){const e=Array.isArray(t)?t[0]:t;switch(e){case"boolean":return false;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}const of=new U9;ci.add($a.Configuration,of);function B9(t,e){if(!t.trim()){return h(1712,"Cannot register an empty property")}if(As.test(t)){return h(1713,"Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",t)}if(of.getConfigurationProperties()[t]!==void 0){return h(1714,"Cannot register '{0}'. This property is already registered.",t)}if(e.policy?.name&&of.getPolicyConfigurations().get(e.policy?.name)!==void 0){return h(1715,"Cannot register '{0}'. The associated policy {1} is already registered with {2}.",t,e.policy?.name,of.getPolicyConfigurations().get(e.policy?.name))}return null}function V9(t){return t.res.statusCode&&t.res.statusCode>=200&&t.res.statusCode<300||t.res.statusCode===1223}function W9(t){return t.res.statusCode===204}async function z9(t){if(!V9(t)){throw new Error("Server returned "+t.res.statusCode)}if(W9(t)){return null}const e=await Z5(t.stream);const i=e.toString();try{return JSON.parse(i)}catch(n){n.message+=":\n"+i;throw n}}let k1=[];let ZE=void 0;let e2=void 0;function q9(t=true,e=true){if(ZE===t&&e2===e){return}ZE=t;e2=e;const i=ci.as($a.Configuration);const n=k1;k1=[{id:"http",order:15,title:h(1969,"HTTP"),type:"object",scope:wt.MACHINE,properties:{"http.useLocalProxyConfiguration":{type:"boolean",default:e,markdownDescription:h(1970,"Controls whether in the remote extension host the local proxy configuration should be used. This setting only applies as a remote setting during [remote development](https://aka.ms/vscode-remote)."),restricted:true}}},{id:"http",order:15,title:h(1969,"HTTP"),type:"object",scope:wt.APPLICATION,properties:{"http.electronFetch":{type:"boolean",default:false,description:h(1971,"Controls whether use of Electron's fetch implementation instead of Node.js' should be enabled. All local extensions will get Electron's fetch implementation for the global fetch API."),restricted:true}}},{id:"http",order:15,title:h(1969,"HTTP"),type:"object",scope:t?wt.APPLICATION:wt.MACHINE,properties:{"http.proxy":{type:"string",pattern:"^(https?|socks|socks4a?|socks5h?)://([^:]*(:[^@]*)?@)?([^:]+|\\[[:0-9a-fA-F]+\\])(:\\d+)?/?$|^$",markdownDescription:h(1972,"The proxy setting to use. If not set, will be inherited from the `http_proxy` and `https_proxy` environment variables. When during [remote development](https://aka.ms/vscode-remote) the {0} setting is disabled this setting can be configured in the local and the remote settings separately.","`#http.useLocalProxyConfiguration#`"),restricted:true},"http.proxyStrictSSL":{type:"boolean",default:true,markdownDescription:h(1973,"Controls whether the proxy server certificate should be verified against the list of supplied CAs. When during [remote development](https://aka.ms/vscode-remote) the {0} setting is disabled this setting can be configured in the local and the remote settings separately.","`#http.useLocalProxyConfiguration#`"),restricted:true},"http.proxyKerberosServicePrincipal":{type:"string",markdownDescription:h(1974,"Overrides the principal service name for Kerberos authentication with the HTTP proxy. A default based on the proxy hostname is used when this is not set. When during [remote development](https://aka.ms/vscode-remote) the {0} setting is disabled this setting can be configured in the local and the remote settings separately.","`#http.useLocalProxyConfiguration#`"),restricted:true},"http.noProxy":{type:"array",items:{type:"string"},markdownDescription:h(1975,"Specifies domain names for which proxy settings should be ignored for HTTP/HTTPS requests. When during [remote development](https://aka.ms/vscode-remote) the {0} setting is disabled this setting can be configured in the local and the remote settings separately.","`#http.useLocalProxyConfiguration#`"),restricted:true},"http.proxyAuthorization":{type:["null","string"],default:null,markdownDescription:h(1976,"The value to send as the `Proxy-Authorization` header for every network request. When during [remote development](https://aka.ms/vscode-remote) the {0} setting is disabled this setting can be configured in the local and the remote settings separately.","`#http.useLocalProxyConfiguration#`"),restricted:true},"http.proxySupport":{type:"string",enum:["off","on","fallback","override"],enumDescriptions:[h(1977,"Disable proxy support for extensions."),h(1978,"Enable proxy support for extensions."),h(1979,"Enable proxy support for extensions, fall back to request options, when no proxy found."),h(1980,"Enable proxy support for extensions, override request options.")],default:"override",markdownDescription:h(1981,"Use the proxy support for extensions. When during [remote development](https://aka.ms/vscode-remote) the {0} setting is disabled this setting can be configured in the local and the remote settings separately.","`#http.useLocalProxyConfiguration#`"),restricted:true},"http.systemCertificates":{type:"boolean",default:true,markdownDescription:h(1982,"Controls whether CA certificates should be loaded from the OS. On Windows and macOS, a reload of the window is required after turning this off. When during [remote development](https://aka.ms/vscode-remote) the {0} setting is disabled this setting can be configured in the local and the remote settings separately.","`#http.useLocalProxyConfiguration#`"),restricted:true},"http.experimental.systemCertificatesV2":{type:"boolean",tags:["experimental"],default:false,markdownDescription:h(1983,"Controls whether experimental loading of CA certificates from the OS should be enabled. This uses a more general approach than the default implementation. When during [remote development](https://aka.ms/vscode-remote) the {0} setting is disabled this setting can be configured in the local and the remote settings separately.","`#http.useLocalProxyConfiguration#`"),restricted:true},"http.fetchAdditionalSupport":{type:"boolean",default:true,markdownDescription:h(1984,"Controls whether Node.js' fetch implementation should be extended with additional support. Currently proxy support ({1}) and system certificates ({2}) are added when the corresponding settings are enabled. When during [remote development](https://aka.ms/vscode-remote) the {0} setting is disabled this setting can be configured in the local and the remote settings separately.","`#http.useLocalProxyConfiguration#`","`#http.proxySupport#`","`#http.systemCertificates#`"),restricted:true}}}];i.updateConfigurations({add:k1,remove:n})}q9();const j9=xe("requestService");var ku;(function(t){t[t["STORAGE_DOES_NOT_EXIST"]=0]="STORAGE_DOES_NOT_EXIST";t[t["STORAGE_IN_MEMORY"]=1]="STORAGE_IN_MEMORY"})(ku||(ku={}));var jn;(function(t){t[t["None"]=0]="None";t[t["Initialized"]=1]="Initialized";t[t["Closed"]=2]="Closed"})(jn||(jn={}));class y4 extends Ee{static{this.DEFAULT_FLUSH_DELAY=100}constructor(e,i=Object.create(null)){super();this.database=e;this.options=i;this._onDidChangeStorage=this._register(new Af);this.onDidChangeStorage=this._onDidChangeStorage.event;this.state=jn.None;this.cache=new Map;this.flushDelayer=this._register(new RP(y4.DEFAULT_FLUSH_DELAY));this.pendingDeletes=new Set;this.pendingInserts=new Map;this.pendingClose=void 0;this.whenFlushedCallbacks=[];this.registerListeners()}registerListeners(){this._register(this.database.onDidChangeItemsExternal(e=>this.onDidChangeItemsExternal(e)))}onDidChangeItemsExternal(e){this._onDidChangeStorage.pause();try{e.changed?.forEach((i,n)=>this.acceptExternal(n,i));e.deleted?.forEach(i=>this.acceptExternal(i,void 0))}finally{this._onDidChangeStorage.resume()}}acceptExternal(e,i){if(this.state===jn.Closed){return}let n=false;if(Xt(i)){n=this.cache.delete(e)}else{const s=this.cache.get(e);if(s!==i){this.cache.set(e,i);n=true}}if(n){this._onDidChangeStorage.fire({key:e,external:true})}}get items(){return this.cache}get size(){return this.cache.size}async init(){if(this.state!==jn.None){return}this.state=jn.Initialized;if(this.options.hint===ku.STORAGE_DOES_NOT_EXIST){return}this.cache=await this.database.getItems()}get(e,i){const n=this.cache.get(e);if(Xt(n)){return i}return n}getBoolean(e,i){const n=this.get(e);if(Xt(n)){return i}return n==="true"}getNumber(e,i){const n=this.get(e);if(Xt(n)){return i}return parseInt(n,10)}getObject(e,i){const n=this.get(e);if(Xt(n)){return i}return QI(n)}async set(e,i,n=false){if(this.state===jn.Closed){return}if(Xt(i)){return this.delete(e,n)}const s=Yt(i)||Array.isArray(i)?oA(i):String(i);const r=this.cache.get(e);if(r===s){return}this.cache.set(e,s);this.pendingInserts.set(e,s);this.pendingDeletes.delete(e);this._onDidChangeStorage.fire({key:e,external:n});return this.doFlush()}async delete(e,i=false){if(this.state===jn.Closed){return}const n=this.cache.delete(e);if(!n){return}if(!this.pendingDeletes.has(e)){this.pendingDeletes.add(e)}this.pendingInserts.delete(e);this._onDidChangeStorage.fire({key:e,external:i});return this.doFlush()}async optimize(){if(this.state===jn.Closed){return}await this.flush(0);return this.database.optimize()}async close(){if(!this.pendingClose){this.pendingClose=this.doClose()}return this.pendingClose}async doClose(){this.state=jn.Closed;try{await this.doFlush(0)}catch(e){}await this.database.close(()=>this.cache)}get hasPending(){return this.pendingInserts.size>0||this.pendingDeletes.size>0}async flushPending(){if(!this.hasPending){return}const e={insert:this.pendingInserts,delete:this.pendingDeletes};this.pendingDeletes=new Set;this.pendingInserts=new Map;return this.database.updateItems(e).finally(()=>{if(!this.hasPending){while(this.whenFlushedCallbacks.length){this.whenFlushedCallbacks.pop()?.()}}})}async flush(e){if(this.state===jn.Closed||this.pendingClose){return}return this.doFlush(e)}async doFlush(e){if(this.options.hint===ku.STORAGE_IN_MEMORY){return this.flushPending()}return this.flushDelayer.trigger(()=>this.flushPending(),e)}async whenFlushed(){if(!this.hasPending){return}return new Promise(e=>this.whenFlushedCallbacks.push(e))}isInMemory(){return this.options.hint===ku.STORAGE_IN_MEMORY}}function td(t){return j0(t,0)}function j0(t,e){switch(typeof t){case"object":if(t===null){return hr(349,e)}else if(Array.isArray(t)){return K9(t,e)}return Q9(t,e);case"string":return x4(t,e);case"boolean":return G9(t,e);case"number":return hr(t,e);case"undefined":return hr(937,e);default:return hr(617,e)}}function hr(t,e){return(e<<5)-e+t|0}function G9(t,e){return hr(t?433:863,e)}function x4(t,e){e=hr(149417,e);for(let i=0,n=t.length;i<n;i++){e=hr(t.charCodeAt(i),e)}return e}function K9(t,e){e=hr(104579,e);return t.reduce((i,n)=>j0(n,i),e)}function Q9(t,e){e=hr(181387,e);return Object.keys(t).sort().reduce((i,n)=>{i=x4(n,i);return j0(t[n],i)},e)}var Rn;(function(t){t[t["BLOCK_SIZE"]=64]="BLOCK_SIZE";t[t["UNICODE_REPLACEMENT"]=65533]="UNICODE_REPLACEMENT"})(Rn||(Rn={}));function I1(t,e,i=32){const n=i-e;const s=~((1<<n)-1);return(t<<e|(s&t)>>>n)>>>0}function jc(t,e=32){if(t instanceof ArrayBuffer){return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")}return(t>>>0).toString(16).padStart(e/4,"0")}class E4{static{this._bigBlock32=new DataView(new ArrayBuffer(320))}constructor(){this._h0=1732584193;this._h1=4023233417;this._h2=2562383102;this._h3=271733878;this._h4=3285377520;this._buff=new Uint8Array(Rn.BLOCK_SIZE+3);this._buffDV=new DataView(this._buff.buffer);this._buffLen=0;this._totalLen=0;this._leftoverHighSurrogate=0;this._finished=false}update(e){const i=e.length;if(i===0){return}const n=this._buff;let s=this._buffLen;let r=this._leftoverHighSurrogate;let o;let a;if(r!==0){o=r;a=-1;r=0}else{o=e.charCodeAt(0);a=0}while(true){let l=o;if(_m(o)){if(a+1<i){const c=e.charCodeAt(a+1);if(Mf(c)){a++;l=S0(o,c)}else{l=Rn.UNICODE_REPLACEMENT}}else{r=o;break}}else if(Mf(o)){l=Rn.UNICODE_REPLACEMENT}s=this._push(n,s,l);a++;if(a<i){o=e.charCodeAt(a)}else{break}}this._buffLen=s;this._leftoverHighSurrogate=r}_push(e,i,n){if(n<128){e[i++]=n}else if(n<2048){e[i++]=192|(n&1984)>>>6;e[i++]=128|(n&63)>>>0}else if(n<65536){e[i++]=224|(n&61440)>>>12;e[i++]=128|(n&4032)>>>6;e[i++]=128|(n&63)>>>0}else{e[i++]=240|(n&1835008)>>>18;e[i++]=128|(n&258048)>>>12;e[i++]=128|(n&4032)>>>6;e[i++]=128|(n&63)>>>0}if(i>=Rn.BLOCK_SIZE){this._step();i-=Rn.BLOCK_SIZE;this._totalLen+=Rn.BLOCK_SIZE;e[0]=e[Rn.BLOCK_SIZE+0];e[1]=e[Rn.BLOCK_SIZE+1];e[2]=e[Rn.BLOCK_SIZE+2]}return i}digest(){if(!this._finished){this._finished=true;if(this._leftoverHighSurrogate){this._leftoverHighSurrogate=0;this._buffLen=this._push(this._buff,this._buffLen,Rn.UNICODE_REPLACEMENT)}this._totalLen+=this._buffLen;this._wrapUp()}return jc(this._h0)+jc(this._h1)+jc(this._h2)+jc(this._h3)+jc(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128;this._buff.subarray(this._buffLen).fill(0);if(this._buffLen>56){this._step();this._buff.fill(0)}const e=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(e/4294967296),false);this._buffDV.setUint32(60,e%4294967296,false);this._step()}_step(){const e=E4._bigBlock32;const i=this._buffDV;for(let d=0;d<64;d+=4){e.setUint32(d,i.getUint32(d,false),false)}for(let d=64;d<320;d+=4){e.setUint32(d,I1(e.getUint32(d-12,false)^e.getUint32(d-32,false)^e.getUint32(d-56,false)^e.getUint32(d-64,false),1),false)}let n=this._h0;let s=this._h1;let r=this._h2;let o=this._h3;let a=this._h4;let l,c;let u;for(let d=0;d<80;d++){if(d<20){l=s&r|~s&o;c=1518500249}else if(d<40){l=s^r^o;c=1859775393}else if(d<60){l=s&r|s&o|r&o;c=2400959708}else{l=s^r^o;c=3395469782}u=I1(n,5)+l+a+c+e.getUint32(d*4,false)&4294967295;a=o;o=r;r=I1(s,30);s=n;n=u}this._h0=this._h0+n&4294967295;this._h1=this._h1+s&4294967295;this._h2=this._h2+r&4294967295;this._h3=this._h3+o&4294967295;this._h4=this._h4+a&4294967295}}const J9=xe("environmentService");const S4=xe("fileService");const D4=xe("IUriIdentityService");var t2;(function(t){t["Settings"]="settings";t["Keybindings"]="keybindings";t["Snippets"]="snippets";t["Prompts"]="prompts";t["Tasks"]="tasks";t["Extensions"]="extensions";t["GlobalState"]="globalState"})(t2||(t2={}));function X9(t){const e=t;return!!(e&&typeof e==="object"&&typeof e.id==="string"&&typeof e.isDefault==="boolean"&&typeof e.name==="string"&&b.isUri(e.location)&&b.isUri(e.globalStorageHome)&&b.isUri(e.settingsResource)&&b.isUri(e.keybindingsResource)&&b.isUri(e.tasksResource)&&b.isUri(e.snippetsHome)&&b.isUri(e.promptsHome)&&b.isUri(e.extensionsResource))}function Ph(t,e,i,n,s,r){return{id:t,name:e,location:i,isDefault:false,icon:s?.icon,globalStorageHome:r&&s?.useDefaultFlags?.globalState?r.globalStorageHome:ki(i,"globalStorage"),settingsResource:r&&s?.useDefaultFlags?.settings?r.settingsResource:ki(i,"settings.json"),keybindingsResource:r&&s?.useDefaultFlags?.keybindings?r.keybindingsResource:ki(i,"keybindings.json"),tasksResource:r&&s?.useDefaultFlags?.tasks?r.tasksResource:ki(i,"tasks.json"),snippetsHome:r&&s?.useDefaultFlags?.snippets?r.snippetsHome:ki(i,"snippets"),promptsHome:r&&s?.useDefaultFlags?.prompts?r.promptsHome:ki(i,"prompts"),extensionsResource:r&&s?.useDefaultFlags?.extensions?r.extensionsResource:ki(i,"extensions.json"),cacheHome:ki(n,t),useDefaultFlags:s?.useDefaultFlags,isTransient:s?.transient,workspaces:s?.workspaces}}let i2=class wM extends Ee{static{this.PROFILES_KEY="userDataProfiles"}static{this.PROFILE_ASSOCIATIONS_KEY="profileAssociations"}get defaultProfile(){return this.profiles[0]}get profiles(){return[...this.profilesObject.profiles,...this.transientProfilesObject.profiles]}constructor(e,i,n,s){super();this.environmentService=e;this.fileService=i;this.uriIdentityService=n;this.logService=s;this._onDidChangeProfiles=this._register(new L);this.onDidChangeProfiles=this._onDidChangeProfiles.event;this._onWillCreateProfile=this._register(new L);this.onWillCreateProfile=this._onWillCreateProfile.event;this._onWillRemoveProfile=this._register(new L);this.onWillRemoveProfile=this._onWillRemoveProfile.event;this._onDidResetWorkspaces=this._register(new L);this.onDidResetWorkspaces=this._onDidResetWorkspaces.event;this.profileCreationPromises=new Map;this.transientProfilesObject={profiles:[],emptyWindows:new Map};this.profilesHome=ki(this.environmentService.userRoamingDataHome,"profiles");this.profilesCacheHome=ki(this.environmentService.cacheHome,"CachedProfilesData")}init(){this._profilesObject=void 0}get profilesObject(){if(!this._profilesObject){const e=this.createDefaultProfile();const i=[e];try{for(const s of this.getStoredProfiles()){if(!s.name||!tt(s.name)||!s.location){this.logService.warn("Skipping the invalid stored profile",s.location||s.name);continue}i.push(Ph($s(s.location),s.name,s.location,this.profilesCacheHome,{icon:s.icon,useDefaultFlags:s.useDefaultFlags},e))}}catch(s){this.logService.error(s)}const n=new Map;if(i.length){try{const s=this.getStoredProfileAssociations();if(s.workspaces){for(const[r,o]of Object.entries(s.workspaces)){const a=b.parse(r);const l=i.find(c=>c.id===o);if(l){const c=l.workspaces?l.workspaces.slice(0):[];c.push(a);l.workspaces=c}}}if(s.emptyWindows){for(const[r,o]of Object.entries(s.emptyWindows)){const a=i.find(l=>l.id===o);if(a){n.set(r,a)}}}}catch(s){this.logService.error(s)}}this._profilesObject={profiles:i,emptyWindows:n}}return this._profilesObject}createDefaultProfile(){const e=Ph("__default__profile__",h(2362,"Default"),this.environmentService.userRoamingDataHome,this.profilesCacheHome);return{...e,extensionsResource:this.getDefaultProfileExtensionsLocation()??e.extensionsResource,isDefault:true}}async createTransientProfile(e){const i=`Temp`;const n=new RegExp(`${ya(i)}\\s(\\d+)`);let s=0;for(const o of this.profiles){const a=n.exec(o.name);const l=a?parseInt(a[1]):0;s=l>s?l:s}const r=`${i} ${s+1}`;return this.createProfile(td(vi()).toString(16),r,{transient:true},e)}async createNamedProfile(e,i,n){return this.createProfile(td(vi()).toString(16),e,i,n)}async createProfile(e,i,n,s){const r=await this.doCreateProfile(e,i,n,s);return r}async doCreateProfile(e,i,n,s){if(!tt(i)||!i){throw new Error("Name of the profile is mandatory and must be of type `string`")}let r=this.profileCreationPromises.get(i);if(!r){r=(async()=>{try{const o=this.profiles.find(u=>u.id===e||!u.isTransient&&!n?.transient&&u.name===i);if(o){throw new Error(`Profile with ${i} name already exists`)}const a=s?this.getWorkspace(s):void 0;if(b.isUri(a)){n={...n,workspaces:[a]}}const l=Ph(e,i,ki(this.profilesHome,e),this.profilesCacheHome,n,this.defaultProfile);await this.fileService.createFolder(l.location);const c=[];this._onWillCreateProfile.fire({profile:l,join(u){c.push(u)}});await Gl.settled(c);if(a&&!b.isUri(a)){this.updateEmptyWindowAssociation(a,l,!!l.isTransient)}this.updateProfiles([l],[],[]);return l}finally{this.profileCreationPromises.delete(i)}})();this.profileCreationPromises.set(i,r)}return r}async updateProfile(e,i){const n=[];for(const r of this.profiles){let o;if(e.id===r.id){if(!r.isDefault){o=Ph(r.id,i.name??r.name,r.location,this.profilesCacheHome,{icon:i.icon===null?void 0:i.icon??r.icon,transient:i.transient??r.isTransient,useDefaultFlags:i.useDefaultFlags??r.useDefaultFlags,workspaces:i.workspaces??r.workspaces},this.defaultProfile)}else if(i.workspaces){o=r;o.workspaces=i.workspaces}}else if(i.workspaces){const a=r.workspaces?.filter(l=>!i.workspaces?.some(c=>this.uriIdentityService.extUri.isEqual(l,c)));if(r.workspaces?.length!==a?.length){o=r;o.workspaces=a}}if(o){n.push(o)}}if(!n.length){if(e.isDefault){throw new Error("Cannot update default profile")}throw new Error(`Profile '${e.name}' does not exist`)}this.updateProfiles([],[],n);const s=this.profiles.find(r=>r.id===e.id);if(!s){throw new Error(`Profile '${e.name}' was not updated`)}return s}async removeProfile(e){if(e.isDefault){throw new Error("Cannot remove default profile")}const i=this.profiles.find(s=>s.id===e.id);if(!i){throw new Error(`Profile '${e.name}' does not exist`)}const n=[];this._onWillRemoveProfile.fire({profile:i,join(s){n.push(s)}});try{await Promise.allSettled(n)}catch(s){this.logService.error(s)}this.updateProfiles([],[i],[]);try{await this.fileService.del(i.cacheHome,{recursive:true})}catch(s){if(s7(s)!==wn.FILE_NOT_FOUND){this.logService.error(s)}}}async setProfileForWorkspace(e,i){const n=this.profiles.find(r=>r.id===i.id);if(!n){throw new Error(`Profile '${i.name}' does not exist`)}const s=this.getWorkspace(e);if(b.isUri(s)){const r=n.workspaces?[...n.workspaces]:[];if(!r.some(o=>this.uriIdentityService.extUri.isEqual(o,s))){r.push(s);await this.updateProfile(n,{workspaces:r})}}else{this.updateEmptyWindowAssociation(s,n,false);this.updateStoredProfiles(this.profiles)}}unsetWorkspace(e,i=false){const n=this.getWorkspace(e);if(b.isUri(n)){const s=this.getProfileForWorkspace(e);if(s){this.updateProfile(s,{workspaces:s.workspaces?.filter(r=>!this.uriIdentityService.extUri.isEqual(r,n))})}}else{this.updateEmptyWindowAssociation(n,void 0,i);this.updateStoredProfiles(this.profiles)}}async resetWorkspaces(){this.transientProfilesObject.emptyWindows.clear();this.profilesObject.emptyWindows.clear();for(const e of this.profiles){e.workspaces=void 0}this.updateProfiles([],[],this.profiles);this._onDidResetWorkspaces.fire()}async cleanUp(){if(await this.fileService.exists(this.profilesHome)){const e=await this.fileService.resolve(this.profilesHome);await Promise.all((e.children||[]).filter(i=>i.isDirectory&&this.profiles.every(n=>!this.uriIdentityService.extUri.isEqual(n.location,i.resource))).map(i=>this.fileService.del(i.resource,{recursive:true})))}}async cleanUpTransientProfiles(){const e=this.transientProfilesObject.profiles.filter(i=>!this.isProfileAssociatedToWorkspace(i));await Promise.allSettled(e.map(i=>this.removeProfile(i)))}getProfileForWorkspace(e){const i=this.getWorkspace(e);return b.isUri(i)?this.profiles.find(n=>n.workspaces?.some(s=>this.uriIdentityService.extUri.isEqual(s,i))):this.profilesObject.emptyWindows.get(i)??this.transientProfilesObject.emptyWindows.get(i)}getWorkspace(e){if(o7(e)){return e.uri}if(a7(e)){return e.configPath}return e.id}isProfileAssociatedToWorkspace(e){if(e.workspaces?.length){return true}if([...this.profilesObject.emptyWindows.values()].some(i=>this.uriIdentityService.extUri.isEqual(i.location,e.location))){return true}if([...this.transientProfilesObject.emptyWindows.values()].some(i=>this.uriIdentityService.extUri.isEqual(i.location,e.location))){return true}return false}updateProfiles(e,i,n){const s=[...this.profiles,...e];const r=this.transientProfilesObject.profiles;this.transientProfilesObject.profiles=[];const o=[];for(let a of s){if(i.some(l=>a.id===l.id)){for(const l of[...this.profilesObject.emptyWindows.keys()]){if(a.id===this.profilesObject.emptyWindows.get(l)?.id){this.profilesObject.emptyWindows.delete(l)}}continue}if(!a.isDefault){a=n.find(c=>a.id===c.id)??a;const l=r.find(c=>a.id===c.id);if(a.isTransient){this.transientProfilesObject.profiles.push(a)}else{if(l){for(const[c,u]of this.transientProfilesObject.emptyWindows.entries()){if(a.id===u.id){this.transientProfilesObject.emptyWindows.delete(c);this.profilesObject.emptyWindows.set(c,a);break}}}}}if(a.workspaces?.length===0){a.workspaces=void 0}o.push(a)}this.updateStoredProfiles(o);this.triggerProfilesChanges(e,i,n)}triggerProfilesChanges(e,i,n){this._onDidChangeProfiles.fire({added:e,removed:i,updated:n,all:this.profiles})}updateEmptyWindowAssociation(e,i,n){n=i?.isTransient?true:n;if(n){if(i){this.transientProfilesObject.emptyWindows.set(e,i)}else{this.transientProfilesObject.emptyWindows.delete(e)}}else{this.transientProfilesObject.emptyWindows.delete(e);if(i){this.profilesObject.emptyWindows.set(e,i)}else{this.profilesObject.emptyWindows.delete(e)}}}updateStoredProfiles(e){const i=[];const n={};const s={};for(const r of e){if(r.isTransient){continue}if(!r.isDefault){i.push({location:r.location,name:r.name,icon:r.icon,useDefaultFlags:r.useDefaultFlags})}if(r.workspaces){for(const o of r.workspaces){n[o.toString()]=r.id}}}for(const[r,o]of this.profilesObject.emptyWindows.entries()){s[r.toString()]=o.id}this.saveStoredProfileAssociations({workspaces:n,emptyWindows:s});this.saveStoredProfiles(i);this._profilesObject=void 0}getStoredProfiles(){return[]}saveStoredProfiles(e){throw new Error("not implemented")}getStoredProfileAssociations(){return{}}saveStoredProfileAssociations(e){throw new Error("not implemented")}getDefaultProfileExtensionsLocation(){return void 0}};i2=z([O(0,J9),O(1,S4),O(2,D4),O(3,at)],i2);const Y9="__$__isNewStorageMarker";const af="__$__targetStorageMarker";var ml;(function(t){t[t["NONE"]=0]="NONE";t[t["SHUTDOWN"]=1]="SHUTDOWN"})(ml||(ml={}));var qt;(function(t){t[t["APPLICATION"]=-1]="APPLICATION";t[t["PROFILE"]=0]="PROFILE";t[t["WORKSPACE"]=1]="WORKSPACE"})(qt||(qt={}));var M_;(function(t){t[t["USER"]=0]="USER";t[t["MACHINE"]=1]="MACHINE"})(M_||(M_={}));function Z9(t){const e=t.get(af);if(e){try{return JSON.parse(e)}catch(i){}}return Object.create(null)}class k4 extends Ee{static{this.DEFAULT_FLUSH_INTERVAL=60*1e3}constructor(e={flushInterval:k4.DEFAULT_FLUSH_INTERVAL}){super();this._onDidChangeValue=this._register(new Af);this._onDidChangeTarget=this._register(new Af);this.onDidChangeTarget=this._onDidChangeTarget.event;this._onWillSaveState=this._register(new L);this.onWillSaveState=this._onWillSaveState.event;this.runFlushWhenIdle=this._register(new eo);this._workspaceKeyTargets=void 0;this._profileKeyTargets=void 0;this._applicationKeyTargets=void 0;this.flushWhenIdleScheduler=this._register(new Ic(()=>this.doFlushWhenIdle(),e.flushInterval))}onDidChangeValue(e,i,n){return Bt.filter(this._onDidChangeValue.event,s=>s.scope===e&&(i===void 0||s.key===i),n)}doFlushWhenIdle(){this.runFlushWhenIdle.value=wI(()=>{if(this.shouldFlushWhenIdle()){this.flush()}this.flushWhenIdleScheduler.schedule()})}shouldFlushWhenIdle(){return true}stopFlushWhenIdle(){yr([this.runFlushWhenIdle,this.flushWhenIdleScheduler])}initialize(){if(!this.initializationPromise){this.initializationPromise=(async()=>{Qi("code/willInitStorage");try{await this.doInitialize()}finally{Qi("code/didInitStorage")}this.flushWhenIdleScheduler.schedule()})()}return this.initializationPromise}emitDidChangeValue(e,i){const{key:n,external:s}=i;if(n===af){switch(e){case qt.APPLICATION:this._applicationKeyTargets=void 0;break;case qt.PROFILE:this._profileKeyTargets=void 0;break;case qt.WORKSPACE:this._workspaceKeyTargets=void 0;break}this._onDidChangeTarget.fire({scope:e})}else{this._onDidChangeValue.fire({scope:e,key:n,target:this.getKeyTargets(e)[n],external:s})}}emitWillSaveState(e){this._onWillSaveState.fire({reason:e})}get(e,i,n){return this.getStorage(i)?.get(e,n)}getBoolean(e,i,n){return this.getStorage(i)?.getBoolean(e,n)}getNumber(e,i,n){return this.getStorage(i)?.getNumber(e,n)}getObject(e,i,n){return this.getStorage(i)?.getObject(e,n)}storeAll(e,i){this.withPausedEmitters(()=>{for(const n of e){this.store(n.key,n.value,n.scope,n.target,i)}})}store(e,i,n,s,r=false){if(Xt(i)){this.remove(e,n,r);return}this.withPausedEmitters(()=>{this.updateKeyTarget(e,n,s);this.getStorage(n)?.set(e,i,r)})}remove(e,i,n=false){this.withPausedEmitters(()=>{this.updateKeyTarget(e,i,void 0);this.getStorage(i)?.delete(e,n)})}withPausedEmitters(e){this._onDidChangeValue.pause();this._onDidChangeTarget.pause();try{e()}finally{this._onDidChangeValue.resume();this._onDidChangeTarget.resume()}}keys(e,i){const n=[];const s=this.getKeyTargets(e);for(const r of Object.keys(s)){const o=s[r];if(o===i){n.push(r)}}return n}updateKeyTarget(e,i,n,s=false){const r=this.getKeyTargets(i);if(typeof n==="number"){if(r[e]!==n){r[e]=n;this.getStorage(i)?.set(af,JSON.stringify(r),s)}}else{if(typeof r[e]==="number"){delete r[e];this.getStorage(i)?.set(af,JSON.stringify(r),s)}}}get workspaceKeyTargets(){if(!this._workspaceKeyTargets){this._workspaceKeyTargets=this.loadKeyTargets(qt.WORKSPACE)}return this._workspaceKeyTargets}get profileKeyTargets(){if(!this._profileKeyTargets){this._profileKeyTargets=this.loadKeyTargets(qt.PROFILE)}return this._profileKeyTargets}get applicationKeyTargets(){if(!this._applicationKeyTargets){this._applicationKeyTargets=this.loadKeyTargets(qt.APPLICATION)}return this._applicationKeyTargets}getKeyTargets(e){switch(e){case qt.APPLICATION:return this.applicationKeyTargets;case qt.PROFILE:return this.profileKeyTargets;default:return this.workspaceKeyTargets}}loadKeyTargets(e){const i=this.getStorage(e);return i?Z9(i):Object.create(null)}isNew(e){return this.getBoolean(Y9,e)===true}async flush(e=ml.NONE){this._onWillSaveState.fire({reason:e});const i=this.getStorage(qt.APPLICATION);const n=this.getStorage(qt.PROFILE);const s=this.getStorage(qt.WORKSPACE);switch(e){case ml.NONE:await Gl.settled([i?.whenFlushed()??Promise.resolve(),n?.whenFlushed()??Promise.resolve(),s?.whenFlushed()??Promise.resolve()]);break;case ml.SHUTDOWN:await Gl.settled([i?.flush(0)??Promise.resolve(),n?.flush(0)??Promise.resolve(),s?.flush(0)??Promise.resolve()]);break}}async log(){const e=this.getStorage(qt.APPLICATION)?.items??new Map;const i=this.getStorage(qt.PROFILE)?.items??new Map;const n=this.getStorage(qt.WORKSPACE)?.items??new Map;return eR(e,i,n,this.getLogDetails(qt.APPLICATION)??"",this.getLogDetails(qt.PROFILE)??"",this.getLogDetails(qt.WORKSPACE)??"")}async optimize(e){await this.flush();return this.getStorage(e)?.optimize()}async switch(e,i){this.emitWillSaveState(ml.NONE);if(X9(e)){return this.switchToProfile(e,i)}return this.switchToWorkspace(e,i)}canSwitchProfile(e,i){if(e.id===i.id){return false}if(n2(i)&&n2(e)){return false}return true}switchData(e,i,n){this.withPausedEmitters(()=>{const s=new Set;for(const[r,o]of e){s.add(r);const a=i.get(r);if(a!==o){this.emitDidChangeValue(n,{key:r,external:true})}}for(const[r]of i.items){if(!s.has(r)){this.emitDidChangeValue(n,{key:r,external:true})}}})}}function n2(t){return t.isDefault||!!t.useDefaultFlags?.globalState}async function eR(t,e,i,n,s,r){const o=v=>{try{return JSON.parse(v)}catch(y){return v}};const a=new Map;const l=new Map;t.forEach((v,y)=>{a.set(y,v);l.set(y,o(v))});const c=new Map;const u=new Map;e.forEach((v,y)=>{c.set(y,v);u.set(y,o(v))});const d=new Map;const p=new Map;i.forEach((v,y)=>{d.set(y,v);p.set(y,o(v))});if(n!==s){console.group(`Storage: Application (path: ${n})`)}else{console.group(`Storage: Application & Profile (path: ${n}, default profile)`)}const f=[];a.forEach((v,y)=>{f.push({key:y,value:v})});console.table(f);console.groupEnd();console.log(l);if(n!==s){console.group(`Storage: Profile (path: ${s}, profile specific)`);const v=[];c.forEach((y,D)=>{v.push({key:D,value:y})});console.table(v);console.groupEnd();console.log(u)}console.group(`Storage: Workspace (path: ${r})`);const m=[];d.forEach((v,y)=>{m.push({key:y,value:v})});console.table(m);console.groupEnd();console.log(p)}const tR=xe("storageService");new T("isMac",Dn,h(1728,"Whether the operating system is macOS"));new T("isLinux",Er,h(1729,"Whether the operating system is Linux"));new T("isWindows",Yi,h(1730,"Whether the operating system is Windows"));const iR=new T("isWeb",oh,h(1731,"Whether the platform is a web browser"));new T("isMacNative",Dn&&!oh,h(1732,"Whether the operating system is macOS on a non-browser platform"));new T("isIOS",ST,h(1733,"Whether the operating system is iOS"));new T("isMobile",DT,h(1734,"Whether the platform is a mobile web browser"));new T("isDevelopment",false,true);new T("productQualityType","",h(1735,"Quality type of VS Code"));const nR="inputFocus";new T(nR,false,h(1736,"Whether keyboard focus is inside an input box"));const sR=xe("languageService");const rR=xe("modelService");var Vn;new T("workbenchState",void 0,{type:"string",description:h(3781,"The kind of workspace opened in the window, either 'empty' (no workspace), 'folder' (single folder) or 'workspace' (multi-root workspace)")});new T("workspaceFolderCount",0,h(3782,"The number of root folders in the workspace"));new T("openFolderWorkspaceSupport",true,true);new T("enterMultiRootWorkspaceSupport",true,true);new T("emptyWorkspaceSupport",true,true);new T("dirtyWorkingCopies",false,h(3783,"Whether there are any working copies with unsaved changes"));const oR=new T("remoteName","",h(3784,"The name of the remote the window is connected to or an empty string if not connected to any remote"));new T("virtualWorkspace","",h(3785,"The scheme of the current workspace is from a virtual file system or an empty string."));new T("temporaryWorkspace",false,h(3786,"The scheme of the current workspace is from a temporary file system."));new T("isFullscreen",false,h(3787,"Whether the main window is in fullscreen mode"));new T("isAuxiliaryWindowFocusedContext",false,h(3788,"Whether an auxiliary window is focused"));new T("hasWebFileSystemAccess",false,true);new T("embedderIdentifier",void 0,h(3789,"The identifier of the embedder according to the product service, if one is defined"));new T("isSandboxWorkspace",false,true);new T("activeEditorIsDirty",false,h(3790,"Whether the active editor has unsaved changes"));new T("activeEditorIsNotPreview",false,h(3791,"Whether the active editor is not in preview mode"));new T("activeEditorIsFirstInGroup",false,h(3792,"Whether the active editor is the first one in its group"));new T("activeEditorIsLastInGroup",false,h(3793,"Whether the active editor is the last one in its group"));new T("activeEditorIsPinned",false,h(3794,"Whether the active editor is pinned"));new T("activeEditorIsReadonly",false,h(3795,"Whether the active editor is read-only"));new T("activeCompareEditorCanSwap",false,h(3796,"Whether the active compare editor can swap sides"));new T("activeEditorCanToggleReadonly",true,h(3797,"Whether the active editor can toggle between being read-only or writeable"));new T("activeEditorCanRevert",false,h(3798,"Whether the active editor can revert"));new T("activeEditorCanSplitInGroup",true);new T("activeEditor",null,{type:"string",description:h(3799,"The identifier of the active editor")});new T("activeEditorAvailableEditorIds","",h(3800,"The available editor identifiers that are usable for the active editor"));new T("textCompareEditorVisible",false,h(3801,"Whether a text compare editor is visible"));new T("textCompareEditorActive",false,h(3802,"Whether a text compare editor is active"));new T("sideBySideEditorActive",false,h(3803,"Whether a side by side editor is active"));new T("groupEditorsCount",0,h(3804,"The number of opened editor groups"));new T("activeEditorGroupEmpty",false,h(3805,"Whether the active editor group is empty"));new T("activeEditorGroupIndex",0,h(3806,"The index of the active editor group"));new T("activeEditorGroupLast",false,h(3807,"Whether the active editor group is the last group"));new T("activeEditorGroupLocked",false,h(3808,"Whether the active editor group is locked"));new T("multipleEditorGroups",false,h(3809,"Whether there are multiple editor groups opened"));new T("multipleEditorsSelectedInGroup",false,h(3810,"Whether multiple editors have been selected in an editor group"));new T("twoEditorsSelectedInGroup",false,h(3811,"Whether exactly two editors have been selected in an editor group"));new T("SelectedEditorsInGroupFileOrUntitledResourceContextKey",true,h(3812,"Whether all selected editors in a group have a file or untitled resource associated"));new T("editorPartMultipleEditorGroups",false,h(3813,"Whether there are multiple editor groups opened in an editor part"));new T("editorPartMaximizedEditorGroup",false,h(3814,"Editor Part has a maximized group"));new T("isAuxiliaryEditorPart",false,h(3815,"Editor Part is in an auxiliary window"));new T("editorIsOpen",false,h(3816,"Whether an editor is open"));new T("inZenMode",false,h(3817,"Whether Zen mode is enabled"));new T("isCenteredLayout",false,h(3818,"Whether centered layout is enabled for the main editor"));new T("splitEditorsVertically",false,h(3819,"Whether editors split vertically"));new T("mainEditorAreaVisible",true,h(3820,"Whether the editor area in the main window is visible"));new T("editorTabsVisible",true,h(3821,"Whether editor tabs are visible"));new T("sideBarVisible",false,h(3822,"Whether the sidebar is visible"));new T("sideBarFocus",false,h(3823,"Whether the sidebar has keyboard focus"));new T("activeViewlet","",h(3824,"The identifier of the active viewlet"));new T("statusBarFocused",false,h(3825,"Whether the status bar has keyboard focus"));new T("titleBarStyle","custom",h(3826,"Style of the window title bar"));new T("titleBarVisible",false,h(3827,"Whether the title bar is visible"));new T("isAuxiliaryTitleBar",false,h(3828,"Title bar is in an auxiliary window"));new T("isCompactTitleBar",false,h(3829,"Title bar is in compact mode"));new T("bannerFocused",false,h(3830,"Whether the banner has keyboard focus"));new T("notificationFocus",true,h(3831,"Whether a notification has keyboard focus"));new T("notificationCenterVisible",false,h(3832,"Whether the notifications center is visible"));new T("notificationToastsVisible",false,h(3833,"Whether a notification toast is visible"));new T("activeAuxiliary","",h(3834,"The identifier of the active auxiliary panel"));new T("auxiliaryBarFocus",false,h(3835,"Whether the auxiliary bar has keyboard focus"));new T("auxiliaryBarVisible",false,h(3836,"Whether the auxiliary bar is visible"));new T("activePanel","",h(3837,"The identifier of the active panel"));new T("panelFocus",false,h(3838,"Whether the panel has keyboard focus"));new T("panelPosition","bottom",h(3839,"The position of the panel, always 'bottom'"));new T("panelAlignment","center",h(3840,"The alignment of the panel, either 'center', 'left', 'right' or 'justify'"));new T("panelVisible",false,h(3841,"Whether the panel is visible"));new T("panelMaximized",false,h(3842,"Whether the panel is maximized"));new T("focusedView","",h(3843,"The identifier of the view that has keyboard focus"));let s2=class bM{static{Vn=this}static{this.Scheme=new T("resourceScheme",void 0,{type:"string",description:h(3844,"The scheme of the resource")})}static{this.Filename=new T("resourceFilename",void 0,{type:"string",description:h(3845,"The file name of the resource")})}static{this.Dirname=new T("resourceDirname",void 0,{type:"string",description:h(3846,"The folder name the resource is contained in")})}static{this.Path=new T("resourcePath",void 0,{type:"string",description:h(3847,"The full path of the resource")})}static{this.LangId=new T("resourceLangId",void 0,{type:"string",description:h(3848,"The language identifier of the resource")})}static{this.Resource=new T("resource",void 0,{type:"URI",description:h(3849,"The full value of the resource including scheme and path")})}static{this.Extension=new T("resourceExtname",void 0,{type:"string",description:h(3850,"The extension name of the resource")})}static{this.HasResource=new T("resourceSet",void 0,{type:"boolean",description:h(3851,"Whether a resource is present or not")})}static{this.IsFileSystemResource=new T("isFileSystemResource",void 0,{type:"boolean",description:h(3852,"Whether the resource is backed by a file system provider")})}constructor(e,i,n,s){this._contextKeyService=e;this._fileService=i;this._languageService=n;this._modelService=s;this._disposables=new Ie;this._schemeKey=Vn.Scheme.bindTo(this._contextKeyService);this._filenameKey=Vn.Filename.bindTo(this._contextKeyService);this._dirnameKey=Vn.Dirname.bindTo(this._contextKeyService);this._pathKey=Vn.Path.bindTo(this._contextKeyService);this._langIdKey=Vn.LangId.bindTo(this._contextKeyService);this._resourceKey=Vn.Resource.bindTo(this._contextKeyService);this._extensionKey=Vn.Extension.bindTo(this._contextKeyService);this._hasResource=Vn.HasResource.bindTo(this._contextKeyService);this._isFileSystemResource=Vn.IsFileSystemResource.bindTo(this._contextKeyService);this._disposables.add(i.onDidChangeFileSystemProviderRegistrations(()=>{const r=this.get();this._isFileSystemResource.set(Boolean(r&&i.hasProvider(r)))}));this._disposables.add(s.onModelAdded(r=>{if(Sl(r.uri,this.get())){this._setLangId()}}));this._disposables.add(s.onModelLanguageChanged(r=>{if(Sl(r.model.uri,this.get())){this._setLangId()}}))}dispose(){this._disposables.dispose()}_setLangId(){const e=this.get();if(!e){this._langIdKey.set(null);return}const i=this._modelService.getModel(e)?.getLanguageId()??this._languageService.guessLanguageIdByFilepathOrFirstLine(e);this._langIdKey.set(i)}set(e){e=e??void 0;if(Sl(this._value,e)){return}this._value=e;this._contextKeyService.bufferChangeEvents(()=>{this._resourceKey.set(e?e.toString():null);this._schemeKey.set(e?e.scheme:null);this._filenameKey.set(e?$s(e):null);this._dirnameKey.set(e?this.uriToPath(vm(e)):null);this._pathKey.set(e?this.uriToPath(e):null);this._setLangId();this._extensionKey.set(e?xP(e):null);this._hasResource.set(Boolean(e));this._isFileSystemResource.set(e?this._fileService.hasProvider(e):false)})}uriToPath(e){if(e.scheme===ae.file){return e.fsPath}return e.path}reset(){this._value=void 0;this._contextKeyService.bufferChangeEvents(()=>{this._resourceKey.reset();this._schemeKey.reset();this._filenameKey.reset();this._dirnameKey.reset();this._pathKey.reset();this._langIdKey.reset();this._extensionKey.reset();this._hasResource.reset();this._isFileSystemResource.reset()})}get(){return this._value}};s2=Vn=z([O(0,Im),O(1,S4),O(2,sR),O(3,rR)],s2);var r2;(function(t){t["UseFileStorage"]="chat.useFileStorage";t["AgentEnabled"]="chat.agent.enabled";t["Edits2Enabled"]="chat.edits2.enabled";t["ExtensionToolsEnabled"]="chat.extensionTools.enabled"})(r2||(r2={}));var Ds;(function(t){t["Ask"]="ask";t["Edit"]="edit";t["Agent"]="agent"})(Ds||(Ds={}));var $i;(function(t){t["Panel"]="panel";t["Terminal"]="terminal";t["Notebook"]="notebook";t["Editor"]="editor"})($i||($i={}));(function(t){function e(i){switch(i){case"panel":return t.Panel;case"terminal":return t.Terminal;case"notebook":return t.Notebook;case"editor":return t.Editor}return t.Panel}t.fromRaw=e})($i||($i={}));var fr;(function(t){t.responseVote=new T("chatSessionResponseVote","",{type:"string",description:h(5005,"When the response has been voted up, is set to 'up'. When voted down, is set to 'down'. Otherwise an empty string.")});t.responseDetectedAgentCommand=new T("chatSessionResponseDetectedAgentOrCommand",false,{type:"boolean",description:h(5006,"When the agent or command was automatically detected")});t.responseSupportsIssueReporting=new T("chatResponseSupportsIssueReporting",false,{type:"boolean",description:h(5007,"True when the current chat response supports issue reporting.")});t.responseIsFiltered=new T("chatSessionResponseFiltered",false,{type:"boolean",description:h(5008,"True when the chat response was filtered out by the server.")});t.responseHasError=new T("chatSessionResponseError",false,{type:"boolean",description:h(5009,"True when the chat response resulted in an error.")});t.requestInProgress=new T("chatSessionRequestInProgress",false,{type:"boolean",description:h(5010,"True when the current request is still in progress.")});t.isRequestPaused=new T("chatRequestIsPaused",false,{type:"boolean",description:h(5011,"True when the current request is paused.")});t.canRequestBePaused=new T("chatCanRequestBePaused",false,{type:"boolean",description:h(5012,"True when the current request can be paused.")});t.isResponse=new T("chatResponse",false,{type:"boolean",description:h(5013,"The chat item is a response.")});t.isRequest=new T("chatRequest",false,{type:"boolean",description:h(5014,"The chat item is a request")});t.itemId=new T("chatItemId","",{type:"string",description:h(5015,"The id of the chat item.")});t.lastItemId=new T("chatLastItemId",[],{type:"string",description:h(5016,"The id of the last chat item.")});t.editApplied=new T("chatEditApplied",false,{type:"boolean",description:h(5017,"True when the chat text edits have been applied.")});t.inputHasText=new T("chatInputHasText",false,{type:"boolean",description:h(5018,"True when the chat input has text.")});t.inputHasFocus=new T("chatInputHasFocus",false,{type:"boolean",description:h(5019,"True when the chat input has focus.")});t.inChatInput=new T("inChatInput",false,{type:"boolean",description:h(5020,"True when focus is in the chat input, false otherwise.")});t.inChatSession=new T("inChat",false,{type:"boolean",description:h(5021,"True when focus is in the chat widget, false otherwise.")});t.hasPromptFile=new T("chatPromptFileAttached",false,{type:"boolean",description:h(5022,"True when the chat has a prompt file attached.")});t.chatMode=new T("chatMode",Ds.Ask,{type:"string",description:h(5023,"The current chat mode.")});t.supported=Kt.or(iR.negate(),oR.notEqualsTo(""));t.enabled=new T("chatIsEnabled",false,{type:"boolean",description:h(5024,"True when chat is enabled because a default chat participant is activated with an implementation.")});t.extensionParticipantRegistered=new T("chatPanelExtensionParticipantRegistered",false,{type:"boolean",description:h(5025,"True when a default chat participant is registered for the panel from an extension.")});t.panelParticipantRegistered=new T("chatPanelParticipantRegistered",false,{type:"boolean",description:h(5026,"True when a default chat participant is registered for the panel.")});t.editingParticipantRegistered=new T("chatEditingParticipantRegistered",false,{type:"boolean",description:h(5027,"True when a default chat participant is registered for editing.")});t.chatEditingCanUndo=new T("chatEditingCanUndo",false,{type:"boolean",description:h(5028,"True when it is possible to undo an interaction in the editing panel.")});t.chatEditingCanRedo=new T("chatEditingCanRedo",false,{type:"boolean",description:h(5029,"True when it is possible to redo an interaction in the editing panel.")});t.extensionInvalid=new T("chatExtensionInvalid",false,{type:"boolean",description:h(5030,"True when the installed chat extension is invalid and needs to be updated.")});t.inputCursorAtTop=new T("chatCursorAtTop",false);t.inputHasAgent=new T("chatInputHasAgent",false);t.location=new T("chatLocation",void 0);t.inQuickChat=new T("quickChatHasFocus",false,{type:"boolean",description:h(5031,"True when the quick chat UI has focus, false otherwise.")});t.hasFileAttachments=new T("chatHasFileAttachments",false,{type:"boolean",description:h(5032,"True when the chat has file attachments.")});t.languageModelsAreUserSelectable=new T("chatModelsAreUserSelectable",false,{type:"boolean",description:h(5033,"True when the chat model can be selected manually by the user.")});t.Setup={hidden:new T("chatSetupHidden",false,true),installed:new T("chatSetupInstalled",false,true),disabled:new T("chatSetupDisabled",false,true)};t.Entitlement={signedOut:new T("chatSetupSignedOut",false,true),canSignUp:new T("chatPlanCanSignUp",false,true),limited:new T("chatPlanLimited",false,true),pro:new T("chatPlanPro",false,true),proPlus:new T("chatPlanProPlus",false,true),business:new T("chatPlanBusiness",false,true),enterprise:new T("chatPlanEnterprise",false,true)};t.chatQuotaExceeded=new T("chatQuotaExceeded",false,true);t.completionsQuotaExceeded=new T("completionsQuotaExceeded",false,true);t.Editing={agentModeDisallowed:new T("chatAgentModeDisallowed",void 0,{type:"boolean",description:h(5034,"True when agent mode is not allowed.")}),hasToolConfirmation:new T("chatHasToolConfirmation",false,{type:"boolean",description:h(5035,"True when a tool confirmation is present.")})};t.Tools={toolsCount:new T("toolsCount",0,{type:"number",description:h(5036,"The count of tools available in the chat.")})}})(fr||(fr={}));var o2;(function(t){t.inEditingMode=Kt.or(fr.chatMode.isEqualTo(Ds.Edit),fr.chatMode.isEqualTo(Ds.Agent))})(o2||(o2={}));var ru;let a2=class yM extends Ee{static{this.AGENT_LEADER="@"}constructor(e){super();this.contextKeyService=e;this._agents=new Map;this._onDidChangeAgents=new L;this.onDidChangeAgents=this._onDidChangeAgents.event;this._agentsContextKeys=new Set;this._hasToolsAgent=false;this._chatParticipantDetectionProviders=new Map;this._agentCompletionProviders=new Map;this._hasDefaultAgent=fr.enabled.bindTo(this.contextKeyService);this._extensionAgentRegistered=fr.extensionParticipantRegistered.bindTo(this.contextKeyService);this._defaultAgentRegistered=fr.panelParticipantRegistered.bindTo(this.contextKeyService);this._editingAgentRegistered=fr.editingParticipantRegistered.bindTo(this.contextKeyService);this._register(e.onDidChangeContext(i=>{if(i.affectsSome(this._agentsContextKeys)){this._updateContextKeys()}}))}registerAgent(e,i){const n=this.getAgent(e);if(n){throw new Error(`Agent already registered: ${JSON.stringify(e)}`)}const s=this;const r=i.slashCommands;i={...i,get slashCommands(){return r.filter(a=>!a.when||s.contextKeyService.contextMatchesRules(Kt.deserialize(a.when)))}};const o={data:i};this._agents.set(e,o);this._updateAgentsContextKeys();this._updateContextKeys();this._onDidChangeAgents.fire(void 0);return ge(()=>{this._agents.delete(e);this._updateAgentsContextKeys();this._updateContextKeys();this._onDidChangeAgents.fire(void 0)})}_updateAgentsContextKeys(){this._agentsContextKeys.clear();for(const e of this._agents.values()){if(e.data.when){const i=Kt.deserialize(e.data.when);for(const n of i?.keys()||[]){this._agentsContextKeys.add(n)}}}}_updateContextKeys(){let e=false;let i=false;let n=false;let s=false;for(const r of this.getAgents()){if(r.isDefault){if(!r.isCore){i=true}if(r.modes.includes(Ds.Agent)){s=true}else if(r.modes.includes(Ds.Edit)){e=true}else{n=true}}}this._editingAgentRegistered.set(e);this._defaultAgentRegistered.set(n);this._extensionAgentRegistered.set(i);if(s!==this._hasToolsAgent){this._hasToolsAgent=s;this._onDidChangeAgents.fire(this.getDefaultAgent($i.Panel,Ds.Agent))}}registerAgentImplementation(e,i){const n=this._agents.get(e);if(!n){throw new Error(`Unknown agent: ${JSON.stringify(e)}`)}if(n.impl){throw new Error(`Agent already has implementation: ${JSON.stringify(e)}`)}if(n.data.isDefault){this._hasDefaultAgent.set(true)}n.impl=i;this._onDidChangeAgents.fire(new Ah(n.data,i));return ge(()=>{n.impl=void 0;this._onDidChangeAgents.fire(void 0);if(n.data.isDefault){this._hasDefaultAgent.set(false)}})}registerDynamicAgent(e,i){e.isDynamic=true;const n={data:e,impl:i};this._agents.set(e.id,n);this._onDidChangeAgents.fire(new Ah(e,i));return ge(()=>{this._agents.delete(e.id);this._onDidChangeAgents.fire(void 0)})}registerAgentCompletionProvider(e,i){this._agentCompletionProviders.set(e,i);return{dispose:()=>{this._agentCompletionProviders.delete(e)}}}async getAgentCompletionItems(e,i,n){return await this._agentCompletionProviders.get(e)?.(i,n)??[]}updateAgent(e,i){const n=this._agents.get(e);if(!n?.impl){throw new Error(`No activated agent with id ${JSON.stringify(e)} registered`)}n.data.metadata={...n.data.metadata,...i};this._onDidChangeAgents.fire(new Ah(n.data,n.impl))}getDefaultAgent(e,i=Ds.Ask){return this._preferExtensionAgent(this.getActivatedAgents().filter(n=>{if(i&&!n.modes.includes(i)){return false}return!!n.isDefault&&n.locations.includes(e)}))}get hasToolsAgent(){return!!this._hasToolsAgent}getContributedDefaultAgent(e){return this._preferExtensionAgent(this.getAgents().filter(i=>!!i.isDefault&&i.locations.includes(e)))}_preferExtensionAgent(e){return y5(e,i=>!i.isCore)??e.at(-1)}getAgent(e,i=false){if(!this._agentIsEnabled(e)&&!i){return}return this._agents.get(e)?.data}_agentIsEnabled(e){const i=typeof e==="string"?this._agents.get(e):e;return!i?.data.when||this.contextKeyService.contextMatchesRules(Kt.deserialize(i.data.when))}getAgentByFullyQualifiedId(e){const i=_i.find(this._agents.values(),n=>aR(n.data)===e)?.data;if(i&&!this._agentIsEnabled(i.id)){return}return i}getAgents(){return Array.from(this._agents.values()).map(e=>e.data).filter(e=>this._agentIsEnabled(e.id))}getActivatedAgents(){return Array.from(this._agents.values()).filter(e=>!!e.impl).filter(e=>this._agentIsEnabled(e.data.id)).map(e=>new Ah(e.data,e.impl))}getAgentsByName(e){return this._preferExtensionAgents(this.getAgents().filter(i=>i.name===e))}_preferExtensionAgents(e){const i=e.filter(n=>!n.isCore);return i.length>0?i:e}agentHasDupeName(e){const i=this.getAgent(e);if(!i){return false}return this.getAgentsByName(i.name).filter(n=>n.extensionId.value!==i.extensionId.value).length>0}async invokeAgent(e,i,n,s,r){const o=this._agents.get(e);if(!o?.impl){throw new Error(`No activated agent with id "${e}"`)}return await o.impl.invoke(i,n,s,r)}setRequestPaused(e,i,n){const s=this._agents.get(e);if(!s?.impl){throw new Error(`No activated agent with id "${e}"`)}s.impl.setRequestPaused?.(i,n)}async getFollowups(e,i,n,s,r){const o=this._agents.get(e);if(!o?.impl?.provideFollowups){return[]}return o.impl.provideFollowups(i,n,s,r)}async getChatTitle(e,i,n){const s=this._agents.get(e);if(!s?.impl){throw new Error(`No activated agent with id "${e}"`)}if(!s.impl?.provideChatTitle){return void 0}return s.impl.provideChatTitle(i,n)}registerChatParticipantDetectionProvider(e,i){this._chatParticipantDetectionProviders.set(e,i);return ge(()=>{this._chatParticipantDetectionProviders.delete(e)})}hasChatParticipantDetectionProviders(){return this._chatParticipantDetectionProviders.size>0}async detectAgentOrCommand(e,i,n,s){const r=_i.first(this._chatParticipantDetectionProviders.values());if(!r){return}const o=this.getAgents().reduce((u,d)=>{if(d.locations.includes(n.location)){u.push({participant:d.id,disambiguation:d.disambiguation??[]});for(const p of d.slashCommands){u.push({participant:d.id,command:p.name,disambiguation:p.disambiguation??[]})}}return u},[]);const a=await r.provideParticipantDetection(e,i,{...n,participants:o},s);if(!a){return}const l=this.getAgent(a.participant);if(!l){return}if(!a.command){return{agent:l}}const c=l?.slashCommands.find(u=>u.name===a.command);if(!c){return}return{agent:l,command:c}}};a2=z([O(0,Im)],a2);class Ah{constructor(e,i){this.data=e;this.impl=i}get id(){return this.data.id}get name(){return this.data.name??""}get fullName(){return this.data.fullName??""}get description(){return this.data.description??""}get extensionId(){return this.data.extensionId}get extensionPublisherId(){return this.data.extensionPublisherId}get extensionPublisherDisplayName(){return this.data.publisherDisplayName}get extensionDisplayName(){return this.data.extensionDisplayName}get isDefault(){return this.data.isDefault}get isCore(){return this.data.isCore}get metadata(){return this.data.metadata}get slashCommands(){return this.data.slashCommands}get locations(){return this.data.locations}get modes(){return this.data.modes}get disambiguation(){return this.data.disambiguation}async invoke(e,i,n,s){return this.impl.invoke(e,i,n,s)}setRequestPaused(e,i){if(this.impl.setRequestPaused){this.impl.setRequestPaused(e,i)}}async provideFollowups(e,i,n,s){if(this.impl.provideFollowups){return this.impl.provideFollowups(e,i,n,s)}return[]}provideSampleQuestions(e,i){if(this.impl.provideSampleQuestions){return this.impl.provideSampleQuestions(e,i)}return void 0}toJSON(){return this.data}}let l2=class xM{static{ru=this}static{this.StorageKey="chat.participantNameRegistry"}constructor(e,i,n,s){this.requestService=i;this.logService=n;this.storageService=s;this.registry=z0(this,Object.create(null));this.disposed=false;if(!e.chatParticipantRegistry){return}this.url=e.chatParticipantRegistry;const r=s.get(ru.StorageKey,qt.APPLICATION);try{this.registry.set(JSON.parse(r??"{}"),void 0)}catch(o){s.remove(ru.StorageKey,qt.APPLICATION)}this.refresh()}refresh(){if(this.disposed){return}this.update().catch(e=>this.logService.warn("Failed to fetch chat participant registry",e)).then(()=>Ts(5*60*1e3)).then(()=>this.refresh())}async update(){const e=await this.requestService.request({type:"GET",url:this.url},bt.None);if(e.res.statusCode!==200){throw new Error("Could not get extensions report.")}const i=await z9(e);if(!i||i.version!==1){throw new Error("Unexpected chat participant registry response.")}const n=i.restrictedChatParticipants;this.registry.set(n,void 0);this.storageService.store(ru.StorageKey,JSON.stringify(n),qt.APPLICATION,M_.MACHINE)}getAgentNameRestriction(e){if(e.isCore){return true}const i=this.checkAgentNameRestriction(e.name,e).get();const n=!e.fullName||this.checkAgentNameRestriction(e.fullName.replace(/\s/g,""),e).get();return i&&n}checkAgentNameRestriction(e,i){const n=this.registry.map(s=>s[e.toLowerCase()]);return n.map(s=>{if(!s){return true}return s.some(r=>io(r,r.includes(".")?i.extensionId.value:i.extensionPublisherId))})}dispose(){this.disposed=true}};l2=ru=z([O(0,A9),O(1,j9),O(2,at),O(3,tR)],l2);function aR(t){return`${t.extensionId.value}.${t.id}`}function I4(t){const e="name"in t?t:{...t,name:t.id};if(!("extensionPublisherId"in e)){e.extensionPublisherId=e.extensionPublisher??""}if(!("extensionDisplayName"in e)){e.extensionDisplayName=""}if(!("extensionId"in e)){e.extensionId=new Ze("")}return ti(e)}const lR=xe("chatAgentService");xe("chatAgentNameService");const cR=xe("chatEditingService");class id{static{this.Kind="text"}constructor(e,i,n){this.range=e;this.editorRange=i;this.text=n;this.kind=id.Kind}get promptText(){return this.text}}const G0="#";const uR="@";const nd="/";class ap{static{this.Kind="var"}constructor(e,i,n,s,r){this.range=e;this.editorRange=i;this.variableName=n;this.variableArg=s;this.variableId=r;this.kind=ap.Kind}get text(){const e=this.variableArg?`:${this.variableArg}`:"";return`${G0}${this.variableName}${e}`}get promptText(){return this.text}}class lp{static{this.Kind="tool"}constructor(e,i,n,s,r,o){this.range=e;this.editorRange=i;this.toolName=n;this.toolId=s;this.displayName=r;this.icon=o;this.kind=lp.Kind}get text(){return`${G0}${this.toolName}`}get promptText(){return this.text}toVariableEntry(){return{kind:"tool",id:this.toolId,name:this.toolName,range:this.range,value:void 0,icon:Zt.isThemeIcon(this.icon)?this.icon:void 0,fullName:this.displayName}}}class cp{static{this.Kind="agent"}constructor(e,i,n){this.range=e;this.editorRange=i;this.agent=n;this.kind=cp.Kind}get text(){return`${uR}${this.agent.name}`}get promptText(){return""}}class up{static{this.Kind="subcommand"}constructor(e,i,n){this.range=e;this.editorRange=i;this.command=n;this.kind=up.Kind}get text(){return`${nd}${this.command.name}`}get promptText(){return""}}class dp{static{this.Kind="slash"}constructor(e,i,n){this.range=e;this.editorRange=i;this.slashCommand=n;this.kind=dp.Kind}get text(){return`${nd}${this.slashCommand.command}`}get promptText(){return`${nd}${this.slashCommand.command}`}}class hp{static{this.Kind="prompt"}constructor(e,i,n){this.range=e;this.editorRange=i;this.slashPromptCommand=n;this.kind=hp.Kind}get text(){return`${nd}${this.slashPromptCommand.command}`}get promptText(){return`${nd}${this.slashPromptCommand.command}`}}class fp{static{this.Kind="dynamic"}constructor(e,i,n,s,r,o,a,l,c,u){this.range=e;this.editorRange=i;this.text=n;this.id=s;this.modelDescription=r;this.data=o;this.fullName=a;this.icon=l;this.isFile=c;this.isDirectory=u;this.kind=fp.Kind}get referenceText(){return this.text.replace(G0,"")}get promptText(){return this.text}toVariableEntry(){if(this.id==="vscode.problems"){return $_.toEntry(this.data.filter)}return{kind:this.isDirectory?"directory":this.isFile?"file":"generic",id:this.id,name:this.referenceText,range:this.range,value:this.data,fullName:this.fullName,icon:this.icon}}}function dR(t){return{text:t.text,parts:t.parts.map(e=>{if(e.kind===id.Kind){return new id(new oi(e.range.start,e.range.endExclusive),e.editorRange,e.text)}else if(e.kind===ap.Kind){return new ap(new oi(e.range.start,e.range.endExclusive),e.editorRange,e.variableName,e.variableArg,e.variableId||"")}else if(e.kind===lp.Kind){return new lp(new oi(e.range.start,e.range.endExclusive),e.editorRange,e.toolName,e.toolId,e.displayName,e.icon)}else if(e.kind===cp.Kind){let i=e.agent;i=I4(i);return new cp(new oi(e.range.start,e.range.endExclusive),e.editorRange,i)}else if(e.kind===up.Kind){return new up(new oi(e.range.start,e.range.endExclusive),e.editorRange,e.command)}else if(e.kind===dp.Kind){return new dp(new oi(e.range.start,e.range.endExclusive),e.editorRange,e.slashCommand)}else if(e.kind===hp.Kind){return new hp(new oi(e.range.start,e.range.endExclusive),e.editorRange,e.slashPromptCommand)}else if(e.kind===fp.Kind){return new fp(new oi(e.range.start,e.range.endExclusive),e.editorRange,e.text,e.id,e.modelDescription,ti(e.data),e.fullName,e.icon,e.isFile,e.isDirectory)}else{throw new Error(`Unknown chat request part: ${e.kind}`)}})}}var c2;(function(t){t[t["Info"]=0]="Info";t[t["Warning"]=1]="Warning";t[t["Error"]=2]="Error"})(c2||(c2={}));function hR(t){return!!t&&typeof t==="object"&&"uri"in t&&t.uri instanceof b&&"version"in t&&typeof t.version==="number"&&"ranges"in t&&Array.isArray(t.ranges)&&t.ranges.every(et.isIRange)}function fR(t){return!!t&&typeof t==="object"&&"documents"in t&&Array.isArray(t.documents)&&t.documents.every(hR)}var u2;(function(t){t[t["Complete"]=1]="Complete";t[t["Partial"]=2]="Partial";t[t["Omitted"]=3]="Omitted"})(u2||(u2={}));var pp;(function(t){t[t["Down"]=0]="Down";t[t["Up"]=1]="Up"})(pp||(pp={}));var d2;(function(t){t["IncorrectCode"]="incorrectCode";t["DidNotFollowInstructions"]="didNotFollowInstructions";t["IncompleteCode"]="incompleteCode";t["MissingContext"]="missingContext";t["PoorlyWrittenOrFormatted"]="poorlyWrittenOrFormatted";t["RefusedAValidRequest"]="refusedAValidRequest";t["OffensiveOrUnsafe"]="offensiveOrUnsafe";t["Other"]="other";t["WillReportIssue"]="willReportIssue"})(d2||(d2={}));var h2;(function(t){t[t["Action"]=1]="Action";t[t["Toolbar"]=2]="Toolbar"})(h2||(h2={}));class K0{static fromFn(e){return new K0(e())}constructor(e){this._value=z0(this,void 0);this.promiseResult=this._value;this.promise=e.then(i=>{ip(n=>{this._value.set(new f2(i,void 0),n)});return i},i=>{ip(n=>{this._value.set(new f2(void 0,i),n)});throw i})}}class f2{constructor(e,i){this.data=e;this.error=i}getDataOrThrow(){if(this.error){throw this.error}return this.data}}var U_;var p2;(function(t){t[t["NotOmitted"]=0]="NotOmitted";t[t["Partial"]=1]="Partial";t[t["Full"]=2]="Full"})(p2||(p2={}));var $_;(function(t){t.icon=ve.error;function e(r){return{filterUri:r.resource,owner:r.owner,problemMessage:r.message,filterRange:{startLineNumber:r.startLineNumber,endLineNumber:r.endLineNumber,startColumn:r.startColumn,endColumn:r.endColumn}}}t.fromMarker=e;function i(r){return{id:n(r),name:s(r),icon:t.icon,value:r,kind:"diagnostic",...r}}t.toEntry=i;function n(r){return[r.filterUri,r.owner,r.filterSeverity,r.filterRange?.startLineNumber].join(":")}t.id=n;function s(r){let o;(function(l){l[l["MaxChars"]=30]="MaxChars";l[l["MaxSpaceLookback"]=10]="MaxSpaceLookback"})(o||(o={}));if(r.problemMessage){if(r.problemMessage.length<o.MaxChars){return r.problemMessage}const l=r.problemMessage.lastIndexOf(" ",o.MaxChars);if(l===-1||l+o.MaxSpaceLookback<o.MaxChars){return r.problemMessage.substring(0,o.MaxChars)+""}return r.problemMessage.substring(0,l)+""}let a=h(5048,"All Problems");if(r.filterUri){a=h(5049,"Problems in {0}",$s(r.filterUri))}return a}t.label=s})($_||($_={}));function pR(t){return t.kind==="image"}const tn={reason:"other"};class g2{get session(){return this._session}get username(){return this.session.requesterUsername}get avatarIconUri(){return this.session.requesterAvatarIconUri}get attempt(){return this._attempt}get variableData(){return this._variableData}set variableData(e){this._variableData=e}get confirmation(){return this._confirmation}get locationData(){return this._locationData}get attachedContext(){return this._attachedContext}get editedFileEvents(){return this._editedFileEvents}constructor(e){this._session=e.session;this.message=e.message;this._variableData=e.variableData;this.timestamp=e.timestamp;this._attempt=e.attempt??0;this._confirmation=e.confirmation;this._locationData=e.locationData;this._attachedContext=e.attachedContext;this.isCompleteAddedRequest=e.isCompleteAddedRequest??false;this.modelId=e.modelId;this.id=e.restoredId??"request_"+vi();this._editedFileEvents=e.editedFileEvents}adoptTo(e){this._session=e}}class C4{get value(){return this._responseParts}constructor(e){this._responseRepr="";this._markdownContent="";this._responseParts=e;this._updateRepr()}toString(){return this._responseRepr}getMarkdown(){return this._markdownContent}_updateRepr(){this._responseRepr=this.partsToRepr(this._responseParts);this._markdownContent=this._responseParts.map(e=>{if(e.kind==="inlineReference"){return this.inlineRefToRepr(e)}else if(e.kind==="markdownContent"||e.kind==="markdownVuln"){return e.content.value}else{return""}}).filter(e=>e.length>0).join("")}partsToRepr(e){const i=[];let n=[];for(const s of e){let r;switch(s.kind){case"treeData":case"progressMessage":case"codeblockUri":case"toolInvocation":case"toolInvocationSerialized":case"extensions":case"undoStop":continue;case"inlineReference":r={text:this.inlineRefToRepr(s)};break;case"command":r={text:s.command.title,isBlock:true};break;case"textEditGroup":case"notebookEditGroup":r={text:h(5050,"Made changes."),isBlock:true};break;case"confirmation":r={text:`${s.title}
${s.message}`,isBlock:true};break;default:r={text:s.content.value};break}if(r.isBlock){if(n.length){i.push(n.join(""));n=[]}i.push(r.text)}else{n.push(r.text)}}if(n.length){i.push(n.join(""))}return i.join("\n\n")}inlineRefToRepr(e){if("uri"in e.inlineReference){return this.uriToRepr(e.inlineReference.uri)}return"name"in e.inlineReference?"`"+e.inlineReference.name+"`":this.uriToRepr(e.inlineReference)}uriToRepr(e){if(e.scheme===ae.http||e.scheme===ae.https){return e.toString(false)}return $s(e)}}class gR extends C4{constructor(e,i){const n=e.value.findIndex(s=>s.kind==="undoStop"&&s.id===i);super(n===-1?e.value.slice():e.value.slice(0,n));this.undoStop=i}}class mR extends C4{get onDidChangeValue(){return this._onDidChangeValue.event}constructor(e){super(Sn(e).map(i=>Ir(i)?{content:i,kind:"markdownContent"}:"kind"in i?i:{kind:"treeData",treeData:i}));this._onDidChangeValue=new L;this._citations=[]}dispose(){this._onDidChangeValue.dispose()}clear(){this._responseParts=[];this._updateRepr(true)}updateContent(e,i){if(e.kind==="markdownContent"){const n=this._responseParts.filter(s=>s.kind!=="textEditGroup").at(-1);if(!n||n.kind!=="markdownContent"||!wR(n.content,e.content)){this._responseParts.push(e)}else{const s=this._responseParts.indexOf(n);this._responseParts[s]={...n,content:bR(n.content,e.content)}}this._updateRepr(i)}else if(e.kind==="textEdit"||e.kind==="notebookEdit"){const n=e.uri.scheme===ae.vscodeNotebookCell&&!this._responseParts.find(c=>c.kind==="notebookEditGroup");const s=n?void 0:sp.parse(e.uri)?.notebook;const r=s??e.uri;let o=false;const a=e.kind==="textEdit"&&!s?"textEditGroup":"notebookEditGroup";const l=a==="textEditGroup"?e.edits:e.edits.map(c=>E8.isTextEdit(c)?{uri:e.uri,edit:c}:c);for(let c=0;!o&&c<this._responseParts.length;c++){const u=this._responseParts[c];if(u.kind===a&&!u.done&&Sl(u.uri,r)){u.edits.push(l);u.done=e.done;o=true}}if(!o){this._responseParts.push({kind:a,uri:r,edits:a==="textEditGroup"?[l]:l,done:e.done})}this._updateRepr(i)}else if(e.kind==="progressTask"){const n=this._responseParts.push(e)-1;this._updateRepr(i);const s=e.onDidAddProgress(()=>{this._updateRepr(false)});e.task?.().then(r=>{s.dispose();if(typeof r==="string"){this._responseParts[n].content=new Xl(r)}this._updateRepr(false)})}else if(e.kind==="toolInvocation"){if(e.confirmationMessages){e.confirmed.p.then(()=>{this._updateRepr(false)})}e.isCompletePromise.then(()=>{this._updateRepr(false)});this._responseParts.push(e);this._updateRepr(i)}else{this._responseParts.push(e);this._updateRepr(i)}}addCitation(e){this._citations.push(e);this._updateRepr()}_updateRepr(e){super._updateRepr();if(!this._onDidChangeValue){return}this._responseRepr+=this._citations.length?"\n\n"+yR(this._citations):"";if(!e){this._onDidChangeValue.fire()}}}class Rh extends Ee{get session(){return this._session}get shouldBeRemovedOnSend(){return this._shouldBeRemovedOnSend}get isComplete(){return this._isComplete}set shouldBeRemovedOnSend(e){this._shouldBeRemovedOnSend=e;this._onDidChange.fire(tn)}get isCanceled(){return this._isCanceled}get vote(){return this._vote}get voteDownReason(){return this._voteDownReason}get followups(){return this._followups}get entireResponse(){return this._finalizedResponse||this._response}get result(){return this._result}get username(){return this.session.responderUsername}get avatarIcon(){return this.session.responderAvatarIcon}get agent(){return this._agent}get slashCommand(){return this._slashCommand}get agentOrSlashCommandDetected(){return this._agentOrSlashCommandDetected??false}get usedContext(){return this._usedContext}get contentReferences(){return Array.from(this._contentReferences)}get codeCitations(){return this._codeCitations}get progressMessages(){return this._progressMessages}get isStale(){return this._isStale}get isPaused(){return this._isPaused}get isPendingConfirmation(){return this._response.value.some(e=>e.kind==="toolInvocation"&&e.isConfirmed===void 0||e.kind==="confirmation"&&e.isUsed===false)}get response(){const e=this._shouldBeRemovedOnSend?.afterUndoStop;if(!e){return this._finalizedResponse||this._response}if(this._responseView?.undoStop!==e){this._responseView=new gR(this._response,e)}return this._responseView}constructor(e){super();this._onDidChange=this._register(new L);this.onDidChange=this._onDidChange.event;this._contentReferences=[];this._codeCitations=[];this._progressMessages=[];this._isStale=false;this._isPaused=z0("isPaused",false);this._session=e.session;this._agent=e.agent;this._slashCommand=e.slashCommand;this.requestId=e.requestId;this._isComplete=e.isComplete??false;this._isCanceled=e.isCanceled??false;this._vote=e.vote;this._voteDownReason=e.voteDownReason;this._result=e.result;this._followups=e.followups?[...e.followups]:void 0;this.isCompleteAddedRequest=e.isCompleteAddedRequest??false;this._shouldBeRemovedOnSend=e.shouldBeRemovedOnSend;this._isStale=Array.isArray(e.responseContent)&&(e.responseContent.length!==0||Ir(e.responseContent)&&e.responseContent.value.length!==0);this._response=this._register(new mR(e.responseContent));this._register(this._response.onDidChangeValue(()=>this._onDidChange.fire(tn)));this.id=e.restoredId??"response_"+vi()}updateContent(e,i){this.bufferWhenPaused(()=>this._response.updateContent(e,i))}addUndoStop(e){this.bufferWhenPaused(()=>{this._onDidChange.fire({reason:"undoStop",id:e.id});this._response.updateContent(e,true)})}applyReference(e){if(e.kind==="usedContext"){this._usedContext=e}else if(e.kind==="reference"){this._contentReferences.push(e);this._onDidChange.fire(tn)}}applyCodeCitation(e){this._codeCitations.push(e);this._response.addCitation(e);this._onDidChange.fire(tn)}setAgent(e,i){this._agent=e;this._slashCommand=i;this._agentOrSlashCommandDetected=!e.isDefault||!!i;this._onDidChange.fire(tn)}setResult(e){this._result=e;this._onDidChange.fire(tn)}complete(){if(this._result?.errorDetails?.responseIsRedacted){this._response.clear()}this._isComplete=true;this._onDidChange.fire(tn)}cancel(){this._isComplete=true;this._isCanceled=true;this._onDidChange.fire(tn)}setFollowups(e){this._followups=e;this._onDidChange.fire(tn)}setVote(e){this._vote=e;this._onDidChange.fire(tn)}setVoteDownReason(e){this._voteDownReason=e;this._onDidChange.fire(tn)}setEditApplied(e,i){if(!this.response.value.includes(e)){return false}if(!e.state){return false}e.state.applied=i;this._onDidChange.fire(tn);return true}adoptTo(e){this._session=e;this._onDidChange.fire(tn)}setPaused(e,i){this._isPaused.set(e,i);this._onDidChange.fire(tn);this.bufferedPauseContent?.forEach(n=>n());this.bufferedPauseContent=void 0}finalizeUndoState(){this._finalizedResponse=this.response;this._responseView=void 0;this._shouldBeRemovedOnSend=void 0}bufferWhenPaused(e){if(!this._isPaused.get()){e()}else{this.bufferedPauseContent??=[];this.bufferedPauseContent.push(e)}}}var _l;(function(t){t[t["NotPausable"]=0]="NotPausable";t[t["Paused"]=1]="Paused";t[t["Unpaused"]=2]="Unpaused"})(_l||(_l={}));function _R(t){const e=t;return typeof e==="object"&&typeof e.requesterUsername==="string"}function vR(t){const e=t;return _R(t)&&typeof e.creationDate==="number"&&typeof e.sessionId==="string"&&t.requests.every(i=>!i.usedContext||fR(i.usedContext))}var gp;(function(t){t[t["Removal"]=0]="Removal";t[t["Resend"]=1]="Resend";t[t["Adoption"]=2]="Adoption"})(gp||(gp={}));var Ln;(function(t){t[t["Created"]=0]="Created";t[t["Initializing"]=1]="Initializing";t[t["Initialized"]=2]="Initialized"})(Ln||(Ln={}));let m2=U_=class EM extends Ee{static getDefaultTitle(e){const i=e.at(0)?.message??"";const n=typeof i==="string"?i:i.text;return n.split("\n")[0].substring(0,50)}get sampleQuestions(){return this._sampleQuestions}get sessionId(){return this._sessionId}get requestInProgress(){const e=this.lastRequest;if(!e?.response){return false}if(e.response.isPendingConfirmation){return false}return!e.response.isComplete}get requestPausibility(){const e=this.lastRequest;if(!e?.response?.agent||e.response.isComplete||e.response.isPendingConfirmation){return _l.NotPausable}return e.response.isPaused.get()?_l.Paused:_l.Unpaused}get hasRequests(){return this._requests.length>0}get lastRequest(){return this._requests.at(-1)}get creationDate(){return this._creationDate}get lastMessageDate(){return this._lastMessageDate}get _defaultAgent(){return this.chatAgentService.getDefaultAgent($i.Panel,Ds.Ask)}get requesterUsername(){return this._defaultAgent?.metadata.requester?.name??this.initialData?.requesterUsername??""}get responderUsername(){return this._defaultAgent?.fullName??this.initialData?.responderUsername??""}get requesterAvatarIconUri(){return this._defaultAgent?.metadata.requester?.icon??this._initialRequesterAvatarIconUri}get responderAvatarIcon(){return this._defaultAgent?.metadata.themeIcon??this._initialResponderAvatarIconUri}get initState(){return this._initState}get isImported(){return this._isImported}get customTitle(){return this._customTitle}get title(){return this._customTitle||U_.getDefaultTitle(this._requests)}get initialLocation(){return this._initialLocation}get editingSessionObs(){return this._editingSession}get editingSession(){return this._editingSession?.promiseResult.get()?.data}constructor(e,i,n,s,r){super();this.initialData=e;this._initialLocation=i;this.logService=n;this.chatAgentService=s;this.chatEditingService=r;this._onDidDispose=this._register(new L);this.onDidDispose=this._onDidDispose.event;this._onDidChange=this._register(new L);this.onDidChange=this._onDidChange.event;this._initState=Ln.Created;this._isInitializedDeferred=new Fs;this._isImported=false;this.currentEditedFileEvents=new Ft;this._checkpoint=void 0;const o=vR(e);if(e&&!o){this.logService.warn(`ChatModel#constructor: Loaded malformed session data: ${JSON.stringify(e)}`)}this._isImported=!!e&&!o||(e?.isImported??false);this._sessionId=o&&e.sessionId||vi();this._requests=e?this._deserialize(e):[];this._creationDate=o&&e.creationDate||Date.now();this._lastMessageDate=o&&e.lastMessageDate||this._creationDate;this._customTitle=o?e.customTitle:void 0;this._initialRequesterAvatarIconUri=e?.requesterAvatarIconUri&&b.revive(e.requesterAvatarIconUri);this._initialResponderAvatarIconUri=Of(e?.responderAvatarIconUri)?b.revive(e.responderAvatarIconUri):e?.responderAvatarIconUri}startEditingSession(e){const i=e?this.chatEditingService.startOrContinueGlobalEditingSession(this):this.chatEditingService.createEditingSession(this);this._editingSession=new K0(i);this._editingSession.promise.then(n=>{this._store.isDisposed?n.dispose():this._register(n)})}notifyEditingAction(e){const i=e.outcome==="accepted"?vl.Keep:e.outcome==="rejected"?vl.Undo:e.outcome==="userModified"?vl.UserModification:null;if(i===null){return}if(!this.currentEditedFileEvents.has(e.uri)||this.currentEditedFileEvents.get(e.uri)?.eventKind===vl.Keep){this.currentEditedFileEvents.set(e.uri,{eventKind:i,uri:e.uri})}}_deserialize(e){const i=e.requests;if(!Array.isArray(i)){this.logService.error(`Ignoring malformed session data: ${JSON.stringify(e)}`);return[]}try{return i.map(n=>{const s=typeof n.message==="string"?this.getParsedRequestFromString(n.message):dR(n.message);const r=this.reviveVariableData(n.variableData);const o=new g2({session:this,message:s,variableData:r,timestamp:n.timestamp??-1,restoredId:n.requestId,confirmation:n.confirmation,editedFileEvents:n.editedFileEvents});o.shouldBeRemovedOnSend=n.isHidden?{requestId:n.requestId}:n.shouldBeRemovedOnSend;if(n.response||n.result||n.responseErrorDetails){const a=n.agent&&"metadata"in n.agent?I4(n.agent):void 0;const l="responseErrorDetails"in n?{errorDetails:n.responseErrorDetails}:n.result;o.response=new Rh({responseContent:n.response??[new Xl(n.response)],session:this,agent:a,slashCommand:n.slashCommand,requestId:o.id,isComplete:true,isCanceled:n.isCanceled,vote:n.vote,voteDownReason:n.voteDownReason,result:l,followups:n.followups,restoredId:n.responseId});o.response.shouldBeRemovedOnSend=n.isHidden?{requestId:n.requestId}:n.shouldBeRemovedOnSend;if(n.usedContext){o.response.applyReference(ti(n.usedContext))}n.contentReferences?.forEach(c=>o.response.applyReference(ti(c)));n.codeCitations?.forEach(c=>o.response.applyCodeCitation(ti(c)))}return o})}catch(n){this.logService.error("Failed to parse chat data",n);return[]}}reviveVariableData(e){const i=e&&Array.isArray(e.variables)?e:{variables:[]};i.variables=i.variables.map(n=>{if(n&&"values"in n&&Array.isArray(n.values)){return{kind:"generic",id:n.id??"",name:n.name,value:n.values[0]?.value,range:n.range,modelDescription:n.modelDescription,references:n.references}}else{return n}});return i}getParsedRequestFromString(e){const i=[new id(new oi(0,e.length),{startColumn:1,startLineNumber:1,endColumn:1,endLineNumber:1},e)];return{text:e,parts:i}}toggleLastRequestPaused(e){if(this.requestPausibility!==_l.NotPausable&&this.lastRequest?.response?.agent){const i=e??!this.lastRequest.response.isPaused.get();this.lastRequest.response.setPaused(i);this.chatAgentService.setRequestPaused(this.lastRequest.response.agent.id,this.lastRequest.id,i);this._onDidChange.fire({kind:"changedRequest",request:this.lastRequest})}}startInitialize(){if(this.initState!==Ln.Created){throw new Error(`ChatModel is in the wrong state for startInitialize: ${Ln[this.initState]}`)}this._initState=Ln.Initializing}deinitialize(){this._initState=Ln.Created;this._isInitializedDeferred=new Fs}initialize(e){if(this.initState!==Ln.Initializing){throw new Error(`ChatModel is in the wrong state for initialize: ${Ln[this.initState]}`)}this._initState=Ln.Initialized;this._sampleQuestions=e;this._isInitializedDeferred.complete();this._onDidChange.fire({kind:"initialize"})}setInitializationError(e){if(this.initState!==Ln.Initializing){throw new Error(`ChatModel is in the wrong state for setInitializationError: ${Ln[this.initState]}`)}if(!this._isInitializedDeferred.isSettled){this._isInitializedDeferred.error(e)}}waitForInitialization(){return this._isInitializedDeferred.p}getRequests(){return this._requests}get checkpoint(){return this._checkpoint}setDisabledRequests(e){this._requests.forEach(i=>{const n=e.find(s=>s.requestId===i.id);i.shouldBeRemovedOnSend=n;if(i.response){i.response.shouldBeRemovedOnSend=n}});this._onDidChange.fire({kind:"setHidden",hiddenRequestIds:e})}addRequest(e,i,n,s,r,o,a,l,c,u){const d=[...this.currentEditedFileEvents.values()];this.currentEditedFileEvents.clear();const p=new g2({session:this,message:e,variableData:i,timestamp:Date.now(),attempt:n,confirmation:o,locationData:a,attachedContext:l,isCompleteAddedRequest:c,modelId:u,editedFileEvents:d.length?d:void 0});p.response=new Rh({responseContent:[],session:this,agent:s,slashCommand:r,requestId:p.id,isCompleteAddedRequest:c});this._requests.push(p);this._lastMessageDate=Date.now();this._onDidChange.fire({kind:"addRequest",request:p});return p}setCustomTitle(e){this._customTitle=e}updateRequest(e,i){e.variableData=i;this._onDidChange.fire({kind:"changedRequest",request:e})}adoptRequest(e){const i=e.session;const n=i._requests.findIndex(s=>s.id===e.id);if(n===-1){return}i._requests.splice(n,1);e.adoptTo(this);e.response?.adoptTo(this);this._requests.push(e);i._onDidChange.fire({kind:"removeRequest",requestId:e.id,responseId:e.response?.id,reason:gp.Adoption});this._onDidChange.fire({kind:"addRequest",request:e})}acceptResponseProgress(e,i,n){if(!e.response){e.response=new Rh({responseContent:[],session:this,requestId:e.id})}if(e.response.isComplete){throw new Error("acceptResponseProgress: Adding progress to a completed response")}if(i.kind==="markdownContent"||i.kind==="treeData"||i.kind==="inlineReference"||i.kind==="codeblockUri"||i.kind==="markdownVuln"||i.kind==="progressMessage"||i.kind==="command"||i.kind==="textEdit"||i.kind==="notebookEdit"||i.kind==="warning"||i.kind==="progressTask"||i.kind==="confirmation"||i.kind==="extensions"||i.kind==="toolInvocation"){e.response.updateContent(i,n)}else if(i.kind==="usedContext"||i.kind==="reference"){e.response.applyReference(i)}else if(i.kind==="codeCitation"){e.response.applyCodeCitation(i)}else if(i.kind==="move"){this._onDidChange.fire({kind:"move",target:i.uri,range:i.range})}else if(i.kind==="undoStop"){e.response.addUndoStop(i)}else{this.logService.error(`Couldn't handle progress: ${JSON.stringify(i)}`)}}removeRequest(e,i=gp.Removal){const n=this._requests.findIndex(r=>r.id===e);const s=this._requests[n];if(n!==-1){this._onDidChange.fire({kind:"removeRequest",requestId:s.id,responseId:s.response?.id,reason:i});this._requests.splice(n,1);s.response?.dispose()}}cancelRequest(e){if(e.response){e.response.cancel()}}setResponse(e,i){if(!e.response){e.response=new Rh({responseContent:[],session:this,requestId:e.id})}e.response.setResult(i)}completeResponse(e){if(!e.response){throw new Error("Call setResponse before completeResponse")}e.response.complete();this._onDidChange.fire({kind:"completedRequest",request:e})}setFollowups(e,i){if(!e.response){return}e.response.setFollowups(i)}setResponseModel(e,i){e.response=i;this._onDidChange.fire({kind:"addResponse",response:i})}toExport(){return{requesterUsername:this.requesterUsername,requesterAvatarIconUri:this.requesterAvatarIconUri,responderUsername:this.responderUsername,responderAvatarIconUri:this.responderAvatarIcon,initialLocation:this.initialLocation,requests:this._requests.map(e=>{const i={...e.message,parts:e.message.parts.map(r=>r&&"toJSON"in r?r.toJSON():r)};const n=e.response?.agent;const s=n&&"toJSON"in n?n.toJSON():n?{...n}:void 0;return{requestId:e.id,message:i,variableData:e.variableData,response:e.response?e.response.entireResponse.value.map(r=>{if(r.kind==="treeData"){return r.treeData}else if(r.kind==="markdownContent"){return r.content}else{return r}}):void 0,responseId:e.response?.id,shouldBeRemovedOnSend:e.shouldBeRemovedOnSend,result:e.response?.result,followups:e.response?.followups,isCanceled:e.response?.isCanceled,vote:e.response?.vote,voteDownReason:e.response?.voteDownReason,agent:s,slashCommand:e.response?.slashCommand,usedContext:e.response?.usedContext,contentReferences:e.response?.contentReferences,codeCitations:e.response?.codeCitations,timestamp:e.timestamp,confirmation:e.confirmation,editedFileEvents:e.editedFileEvents}})}}toJSON(){return{version:3,...this.toExport(),sessionId:this.sessionId,creationDate:this._creationDate,isImported:this._isImported,lastMessageDate:this._lastMessageDate,customTitle:this._customTitle}}dispose(){this._requests.forEach(e=>e.response?.dispose());this._onDidDispose.fire();super.dispose()}};m2=U_=z([O(2,at),O(3,lR),O(4,cR)],m2);function wR(t,e){if(t.baseUri&&e.baseUri){const i=t.baseUri.scheme===e.baseUri.scheme&&t.baseUri.authority===e.baseUri.authority&&t.baseUri.path===e.baseUri.path&&t.baseUri.query===e.baseUri.query&&t.baseUri.fragment===e.baseUri.fragment;if(!i){return false}}else if(t.baseUri||e.baseUri){return false}return Xi(t.isTrusted,e.isTrusted)&&t.supportHtml===e.supportHtml&&t.supportThemeIcons===e.supportThemeIcons}function bR(t,e){const i=typeof e==="string"?e:e.value;return{value:t.value+i,isTrusted:t.isTrusted,supportThemeIcons:t.supportThemeIcons,supportHtml:t.supportHtml,baseUri:t.baseUri}}function yR(t){if(t.length===0){return""}const e=t.reduce((n,s)=>n.add(s.license),new Set);const i=e.size===1?h(5051,"Similar code found with 1 license type",e.size):h(5052,"Similar code found with {0} license types",e.size);return i}var vl;(function(t){t[t["Keep"]=1]="Keep";t[t["Undo"]=2]="Undo";t[t["UserModification"]=3]="UserModification"})(vl||(vl={}));const _2="^([a-z0-9A-Z][a-z0-9-A-Z]*)\\.([a-z0-9A-Z][a-z0-9-A-Z]*)$";var v2;(function(t){t["COMMAND"]="command";t["SETTINGS_SYNC"]="settingsSync"})(v2||(v2={}));var H_;(function(t){t["NoneOrRelevance"]="NoneOrRelevance";t["LastUpdatedDate"]="LastUpdatedDate";t["Title"]="Title";t["PublisherName"]="PublisherName";t["InstallCount"]="InstallCount";t["PublishedDate"]="PublishedDate";t["AverageRating"]="AverageRating";t["WeightedRating"]="WeightedRating"})(H_||(H_={}));var w2;(function(t){t[t["Default"]=0]="Default";t[t["Ascending"]=1]="Ascending";t[t["Descending"]=2]="Descending"})(w2||(w2={}));var b2;(function(t){t["Category"]="Category";t["ExtensionId"]="ExtensionId";t["ExtensionName"]="ExtensionName";t["ExcludeWithFlags"]="ExcludeWithFlags";t["Featured"]="Featured";t["SearchText"]="SearchText";t["Tag"]="Tag";t["Target"]="Target"})(b2||(b2={}));var y2;(function(t){t["Install"]="install";t["Uninstall"]="uninstall"})(y2||(y2={}));var x2;(function(t){t[t["None"]=1]="None";t[t["Install"]=2]="Install";t[t["Update"]=3]="Update";t[t["Migrate"]=4]="Migrate"})(x2||(x2={}));var E2;(function(t){t["Timeout"]="Timeout";t["Cancelled"]="Cancelled";t["Failed"]="Failed";t["DownloadFailedWriting"]="DownloadFailedWriting";t["Offline"]="Offline"})(E2||(E2={}));var S2;(function(t){t["NotFound"]="NotFound";t["Unsupported"]="Unsupported";t["Deprecated"]="Deprecated";t["Malicious"]="Malicious";t["Incompatible"]="Incompatible";t["IncompatibleApi"]="IncompatibleApi";t["IncompatibleTargetPlatform"]="IncompatibleTargetPlatform";t["ReleaseVersionNotFound"]="ReleaseVersionNotFound";t["Invalid"]="Invalid";t["Download"]="Download";t["DownloadSignature"]="DownloadSignature";t["DownloadFailedWriting"]="DownloadFailedWriting";t["UpdateMetadata"]="UpdateMetadata";t["Extract"]="Extract";t["Scanning"]="Scanning";t["ScanningExtension"]="ScanningExtension";t["ReadRemoved"]="ReadRemoved";t["UnsetRemoved"]="UnsetRemoved";t["Delete"]="Delete";t["Rename"]="Rename";t["IntializeDefaultProfile"]="IntializeDefaultProfile";t["AddToProfile"]="AddToProfile";t["InstalledExtensionNotFound"]="InstalledExtensionNotFound";t["PostInstall"]="PostInstall";t["CorruptZip"]="CorruptZip";t["IncompleteZip"]="IncompleteZip";t["PackageNotSigned"]="PackageNotSigned";t["SignatureVerificationInternal"]="SignatureVerificationInternal";t["SignatureVerificationFailed"]="SignatureVerificationFailed";t["NotAllowed"]="NotAllowed";t["Gallery"]="Gallery";t["Cancelled"]="Cancelled";t["Unknown"]="Unknown";t["Internal"]="Internal"})(S2||(S2={}));var D2;(function(t){t["NotSigned"]="NotSigned";t["Success"]="Success";t["RequiredArgumentMissing"]="RequiredArgumentMissing";t["InvalidArgument"]="InvalidArgument";t["PackageIsUnreadable"]="PackageIsUnreadable";t["UnhandledException"]="UnhandledException";t["SignatureManifestIsMissing"]="SignatureManifestIsMissing";t["SignatureManifestIsUnreadable"]="SignatureManifestIsUnreadable";t["SignatureIsMissing"]="SignatureIsMissing";t["SignatureIsUnreadable"]="SignatureIsUnreadable";t["CertificateIsUnreadable"]="CertificateIsUnreadable";t["SignatureArchiveIsUnreadable"]="SignatureArchiveIsUnreadable";t["FileAlreadyExists"]="FileAlreadyExists";t["SignatureArchiveIsInvalidZip"]="SignatureArchiveIsInvalidZip";t["SignatureArchiveHasSameSignatureFile"]="SignatureArchiveHasSameSignatureFile";t["PackageIntegrityCheckFailed"]="PackageIntegrityCheckFailed";t["SignatureIsInvalid"]="SignatureIsInvalid";t["SignatureManifestIsInvalid"]="SignatureManifestIsInvalid";t["SignatureIntegrityCheckFailed"]="SignatureIntegrityCheckFailed";t["EntryIsMissing"]="EntryIsMissing";t["EntryIsTampered"]="EntryIsTampered";t["Untrusted"]="Untrusted";t["CertificateRevoked"]="CertificateRevoked";t["SignatureIsNotValid"]="SignatureIsNotValid";t["UnknownError"]="UnknownError";t["PackageIsInvalidZip"]="PackageIsInvalidZip";t["SignatureArchiveHasTooManyEntries"]="SignatureArchiveHasTooManyEntries"})(D2||(D2={}));gm(1768,"Extensions");gm(1769,"Preferences");const xR="extensions.allowed";ci.as($a.Configuration).registerConfiguration({id:"extensions",order:30,title:h(1770,"Extensions"),type:"object",properties:{[xR]:{type:"object",markdownDescription:h(1771,"Specify a list of extensions that are allowed to use. This helps maintain a secure and consistent development environment by restricting the use of unauthorized extensions. For more information on how to configure this setting, please visit the [Configure Allowed Extensions](https://code.visualstudio.com/docs/setup/enterprise#_configure-allowed-extensions) section."),default:"*",defaultSnippets:[{body:{},description:h(1772,"No extensions are allowed.")},{body:{"*":true},description:h(1773,"All extensions are allowed.")}],scope:wt.APPLICATION,policy:{name:"AllowedExtensions",minimumVersion:"1.96",description:h(1774,"Specify a list of extensions that are allowed to use. This helps maintain a secure and consistent development environment by restricting the use of unauthorized extensions. More information: https://code.visualstudio.com/docs/setup/enterprise#_configure-allowed-extensions")},additionalProperties:false,patternProperties:{"([a-z0-9A-Z][a-z0-9-A-Z]*)\\.([a-z0-9A-Z][a-z0-9-A-Z]*)$":{anyOf:[{type:["boolean","string"],enum:[true,false,"stable"],description:h(1775,"Allow or disallow the extension."),enumDescriptions:[h(1776,"Extension is allowed."),h(1777,"Extension is not allowed."),h(1778,"Allow only stable versions of the extension.")]},{type:"array",items:{type:"string"},description:h(1779,"Allow or disallow specific versions of the extension. To specifcy a platform specific version, use the format `platform@1.2.3`, e.g. `win32-x64@1.2.3`. Supported platforms are `win32-x64`, `win32-arm64`, `linux-x64`, `linux-arm64`, `linux-armhf`, `alpine-x64`, `alpine-arm64`, `darwin-x64`, `darwin-arm64`")}]},"([a-z0-9A-Z][a-z0-9-A-Z]*)$":{type:["boolean","string"],enum:[true,false,"stable"],description:h(1780,"Allow or disallow all extensions from the publisher."),enumDescriptions:[h(1781,"All extensions from the publisher are allowed."),h(1782,"All extensions from the publisher are not allowed."),h(1783,"Allow only stable versions of the extensions from the publisher.")]},"\\*":{type:"boolean",enum:[true,false],description:h(1784,"Allow or disallow all extensions."),enumDescriptions:[h(1785,"Allow all extensions."),h(1786,"Disallow all extensions.")]}}}}});var Xr;(function(t){t[t["NONE"]=0]="NONE";t[t["CRASH"]=1]="CRASH";t[t["ERROR"]=2]="ERROR";t[t["USAGE"]=3]="USAGE"})(Xr||(Xr={}));var k2;(function(t){t["OFF"]="off";t["CRASH"]="crash";t["ERROR"]="error";t["ON"]="all"})(k2||(k2={}));class Q0{constructor(e){this.value=e;this.isTrustedTelemetryValue=true}}class ER{constructor(){this.telemetryLevel=Xr.NONE;this.sessionId="someValue.sessionId";this.machineId="someValue.machineId";this.sqmId="someValue.sqmId";this.devDeviceId="someValue.devDeviceId";this.firstSessionDate="someValue.firstSessionDate";this.sendErrorTelemetry=false}publicLog(){}publicLog2(){}publicLogError(){}publicLogError2(){}setExperimentProperty(){}}new ER;const SR="telemetry";const DR={id:SR,name:h(2005,"Telemetry")};const kR=new Set(["ssh-remote","dev-container","attached-container","wsl","tunnel","codespaces","amlext"]);function IR(t){if(!t){return"none"}const e=k0(t);return kR.has(e)?e:"other"}function CR(t,e){if(!t||!t.includes("/")&&!t.includes("\\")){return t}let i=t;const n=[];for(const a of e){while(true){const l=a.exec(t);if(!l){break}n.push([l.index,a.lastIndex])}}const s=/^[\\\/]?(node_modules|node_modules\.asar)[\\\/]/;const r=/(file:\/\/)?([a-zA-Z]:(\\\\|\\|\/)|(\\\\|\\|\/))?([\w-\._]+(\\\\|\\|\/))+[\w-\._]*/g;let o=0;i="";while(true){const a=r.exec(t);if(!a){break}const l=n.some(([c,u])=>a.index<u&&c<r.lastIndex);if(!s.test(a[0])&&!l){i+=t.substring(o,a.index)+"<REDACTED: user-file-path>";o=r.lastIndex}}if(o<t.length){i+=t.substr(o)}return i}function TR(t){if(!t){return t}const e=[{label:"Google API Key",regex:/AIza[A-Za-z0-9_\\\-]{35}/},{label:"Slack Token",regex:/xox[pbar]\-[A-Za-z0-9]/},{label:"GitHub Token",regex:/(gh[psuro]_[a-zA-Z0-9]{36}|github_pat_[a-zA-Z0-9]{22}_[a-zA-Z0-9]{59})/},{label:"Generic Secret",regex:/(key|token|sig|secret|signature|password|passwd|pwd|android:value)[^a-zA-Z0-9]/i},{label:"CLI Credentials",regex:/((login|psexec|(certutil|psexec)\.exe).{1,50}(\s-u(ser(name)?)?\s+.{3,100})?\s-(admin|user|vm|root)?p(ass(word)?)?\s+["']?[^$\-\/\s]|(^|[\s\r\n\\])net(\.exe)?.{1,5}(user\s+|share\s+\/user:| user -? secrets ? set) \s + [^ $\s \/])/},{label:"Microsoft Entra ID",regex:/eyJ(?:0eXAiOiJKV1Qi|hbGci|[a-zA-Z0-9\-_]+\.[a-zA-Z0-9\-_]+\.)/},{label:"Email",regex:/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/}];for(const i of e){if(i.regex.test(t)){return`<REDACTED: ${i.label}>`}}return t}function I2(t,e){return Kl(t,i=>{if(i instanceof Q0||Object.hasOwnProperty.call(i,"isTrustedTelemetryValue")){return i.value}if(typeof i==="string"){let n=i.replaceAll("%20"," ");n=CR(n,e);for(const s of e){n=n.replace(s,"")}n=TR(n);return n}return void 0})}function PR(t,e){if(t.uuid&&e.uuid){return t.uuid===e.uuid}if(t.id===e.id){return true}return u_(t.id,e.id)===0}new Ze("pprice.better-merge");class AR{constructor(){this._generators=new Map;this._cache=new WeakMap}register(e,i){this._generators.set(e,i)}readActivationEvents(e){if(!this._cache.has(e)){this._cache.set(e,this._readActivationEvents(e))}return this._cache.get(e)}createActivationEventsMap(e){const i=Object.create(null);for(const n of e){const s=this.readActivationEvents(n);if(s.length>0){i[Ze.toKey(n.identifier)]=s}}return i}_readActivationEvents(e){if(typeof e.main==="undefined"&&typeof e.browser==="undefined"){return[]}const i=Array.isArray(e.activationEvents)?e.activationEvents.slice(0):[];for(let n=0;n<i.length;n++){if(i[n]==="onUri"){i[n]=`onUri:${Ze.toKey(e.identifier)}`}}if(!e.contributes){return i}for(const n in e.contributes){const s=this._generators.get(n);if(!s){continue}const r=e.contributes[n];const o=Array.isArray(r)?r:[r];try{s(o,i)}catch(a){Pi(a)}}return i}}const RR=new AR;const LR=Object.freeze({identifier:new Ze("nullExtensionDescription"),name:"Null Extension Description",version:"0.0.0",publisher:"vscode",engines:{vscode:""},extensionLocation:b.parse("void:location"),isBuiltin:false,targetPlatform:m_.UNDEFINED,isUserBuiltin:false,isUnderDevelopment:false,preRelease:false});class C2{constructor(e){this.dependency=e}}var T2;(function(t){t[t["EagerAutoStart"]=1]="EagerAutoStart";t[t["EagerManualStart"]=2]="EagerManualStart";t[t["Lazy"]=3]="Lazy"})(T2||(T2={}));function dt(t,e){if(!t.enabledApiProposals){return false}return t.enabledApiProposals.includes(e)}function $(t,e){if(!dt(t,e)){throw new Error(`Extension '${t.identifier.value}' CANNOT use API proposal: ${e}.
Its package.json#enabledApiProposals-property declares: ${t.enabledApiProposals?.join(", ")??"[]"} but NOT ${e}.
 The missing proposal MUST be added and you must start in extension development mode or use the following command line switch: --enable-proposed-api ${t.identifier.value}`)}}var B_;(function(t){t[t["Normal"]=0]="Normal";t[t["Immediate"]=1]="Immediate"})(B_||(B_={}));const NR=xe("extensionService");const OR="vscode://schemas/vscode-product";const FR={activeComment:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.activeComment.d.ts"},aiRelatedInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiRelatedInformation.d.ts"},aiSettingsSearch:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiSettingsSearch.d.ts"},aiTextSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.aiTextSearchProvider.d.ts",version:2},authLearnMore:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authLearnMore.d.ts"},authSession:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.authSession.d.ts"},canonicalUriProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.canonicalUriProvider.d.ts"},chatEditing:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatEditing.d.ts"},chatParticipantAdditions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipantAdditions.d.ts"},chatParticipantPrivate:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatParticipantPrivate.d.ts",version:9},chatProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatProvider.d.ts"},chatReferenceBinaryData:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatReferenceBinaryData.d.ts"},chatReferenceDiagnostic:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatReferenceDiagnostic.d.ts"},chatStatusItem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatStatusItem.d.ts"},chatTab:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.chatTab.d.ts"},codeActionAI:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionAI.d.ts"},codeActionRanges:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codeActionRanges.d.ts"},codiconDecoration:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.codiconDecoration.d.ts"},commentReactor:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentReactor.d.ts"},commentReveal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentReveal.d.ts"},commentThreadApplicability:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentThreadApplicability.d.ts"},commentingRangeHint:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentingRangeHint.d.ts"},commentsDraftState:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.commentsDraftState.d.ts"},contribAccessibilityHelpContent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribAccessibilityHelpContent.d.ts"},contribCommentEditorActionsMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentEditorActionsMenu.d.ts"},contribCommentPeekContext:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentPeekContext.d.ts"},contribCommentThreadAdditionalMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentThreadAdditionalMenu.d.ts"},contribCommentsViewThreadMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribCommentsViewThreadMenus.d.ts"},contribDebugCreateConfiguration:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribDebugCreateConfiguration.d.ts"},contribDiffEditorGutterToolBarMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribDiffEditorGutterToolBarMenus.d.ts"},contribEditSessions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditSessions.d.ts"},contribEditorContentMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribEditorContentMenu.d.ts"},contribLabelFormatterWorkspaceTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribLabelFormatterWorkspaceTooltip.d.ts"},contribMenuBarHome:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMenuBarHome.d.ts"},contribMergeEditorMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMergeEditorMenus.d.ts"},contribMultiDiffEditorMenus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribMultiDiffEditorMenus.d.ts"},contribNotebookStaticPreloads:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribNotebookStaticPreloads.d.ts"},contribRemoteHelp:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribRemoteHelp.d.ts"},contribShareMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribShareMenu.d.ts"},contribSourceControlHistoryItemMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryItemMenu.d.ts"},contribSourceControlHistoryTitleMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlHistoryTitleMenu.d.ts"},contribSourceControlInputBoxMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlInputBoxMenu.d.ts"},contribSourceControlTitleMenu:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribSourceControlTitleMenu.d.ts"},contribStatusBarItems:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribStatusBarItems.d.ts"},contribViewContainerTitle:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewContainerTitle.d.ts"},contribViewsRemote:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsRemote.d.ts"},contribViewsWelcome:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.contribViewsWelcome.d.ts"},customEditorMove:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.customEditorMove.d.ts"},debugVisualization:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.debugVisualization.d.ts"},defaultChatParticipant:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.defaultChatParticipant.d.ts",version:4},diffCommand:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffCommand.d.ts"},diffContentOptions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.diffContentOptions.d.ts"},documentFiltersExclusive:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.documentFiltersExclusive.d.ts"},editSessionIdentityProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editSessionIdentityProvider.d.ts"},editorHoverVerbosityLevel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorHoverVerbosityLevel.d.ts"},editorInsets:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.editorInsets.d.ts"},embeddings:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.embeddings.d.ts"},extensionRuntime:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionRuntime.d.ts"},extensionsAny:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.extensionsAny.d.ts"},externalUriOpener:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.externalUriOpener.d.ts"},fileSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProvider.d.ts"},fileSearchProvider2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fileSearchProvider2.d.ts"},findFiles2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findFiles2.d.ts",version:2},findTextInFiles:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFiles.d.ts"},findTextInFiles2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.findTextInFiles2.d.ts"},fsChunks:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.fsChunks.d.ts"},idToken:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.idToken.d.ts"},inlineCompletionsAdditions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineCompletionsAdditions.d.ts"},inlineEdit:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.inlineEdit.d.ts"},interactive:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactive.d.ts"},interactiveWindow:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.interactiveWindow.d.ts"},ipc:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.ipc.d.ts"},languageModelCapabilities:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelCapabilities.d.ts"},languageModelDataPart:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelDataPart.d.ts",version:2},languageModelSystem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageModelSystem.d.ts"},languageStatusText:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.languageStatusText.d.ts"},mappedEditsProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.mappedEditsProvider.d.ts"},mcpConfigurationProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.mcpConfigurationProvider.d.ts"},multiDocumentHighlightProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.multiDocumentHighlightProvider.d.ts"},nativeWindowHandle:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.nativeWindowHandle.d.ts"},newSymbolNamesProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.newSymbolNamesProvider.d.ts"},notebookCellExecution:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookCellExecution.d.ts"},notebookCellExecutionState:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookCellExecutionState.d.ts"},notebookControllerAffinityHidden:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookControllerAffinityHidden.d.ts"},notebookDeprecated:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookDeprecated.d.ts"},notebookExecution:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookExecution.d.ts"},notebookKernelSource:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookKernelSource.d.ts"},notebookLiveShare:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookLiveShare.d.ts"},notebookMessaging:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMessaging.d.ts"},notebookMime:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookMime.d.ts"},notebookReplDocument:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookReplDocument.d.ts"},notebookVariableProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.notebookVariableProvider.d.ts"},portsAttributes:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.portsAttributes.d.ts"},profileContentHandlers:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.profileContentHandlers.d.ts"},quickDiffProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickDiffProvider.d.ts"},quickInputButtonLocation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickInputButtonLocation.d.ts"},quickPickItemTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickItemTooltip.d.ts"},quickPickSortByLabel:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.quickPickSortByLabel.d.ts"},resolvers:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.resolvers.d.ts"},scmActionButton:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmActionButton.d.ts"},scmHistoryProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmHistoryProvider.d.ts"},scmMultiDiffEditor:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmMultiDiffEditor.d.ts"},scmSelectedProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmSelectedProvider.d.ts"},scmTextDocument:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmTextDocument.d.ts"},scmValidation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.scmValidation.d.ts"},shareProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.shareProvider.d.ts"},speech:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.speech.d.ts"},statusBarItemTooltip:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.statusBarItemTooltip.d.ts"},tabInputMultiDiff:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputMultiDiff.d.ts"},tabInputTextMerge:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tabInputTextMerge.d.ts"},taskPresentationGroup:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.taskPresentationGroup.d.ts"},taskProblemMatcherStatus:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.taskProblemMatcherStatus.d.ts"},telemetry:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.telemetry.d.ts"},terminalCompletionProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalCompletionProvider.d.ts"},terminalDataWriteEvent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDataWriteEvent.d.ts"},terminalDimensions:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalDimensions.d.ts"},terminalExecuteCommandEvent:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalExecuteCommandEvent.d.ts"},terminalQuickFixProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalQuickFixProvider.d.ts"},terminalSelection:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalSelection.d.ts"},terminalShellEnv:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.terminalShellEnv.d.ts"},testObserver:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testObserver.d.ts"},testRelatedCode:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.testRelatedCode.d.ts"},textEditorDiffInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textEditorDiffInformation.d.ts"},textSearchComplete2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchComplete2.d.ts"},textSearchProvider:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProvider.d.ts"},textSearchProvider2:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.textSearchProvider2.d.ts"},timeline:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.timeline.d.ts"},tokenInformation:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tokenInformation.d.ts"},toolProgress:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.toolProgress.d.ts"},treeViewActiveItem:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewActiveItem.d.ts"},treeViewMarkdownMessage:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewMarkdownMessage.d.ts"},treeViewReveal:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.treeViewReveal.d.ts"},tunnelFactory:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnelFactory.d.ts"},tunnels:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.tunnels.d.ts"},valueSelectionInQuickPick:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.valueSelectionInQuickPick.d.ts"},workspaceTrust:{proposal:"https://raw.githubusercontent.com/microsoft/vscode/main/src/vscode-dts/vscode.proposed.workspaceTrust.d.ts"}};const mp=Object.freeze(FR);const J0=ci.as(Cm.JSONContribution);class Iu{static _toSet(e){const i=new La;for(let n=0,s=e.length;n<s;n++){i.add(e[n].description.identifier)}return i}static compute(e,i){if(!e||!e.length){return new Iu(i,[])}if(!i||!i.length){return new Iu([],e)}const n=this._toSet(e);const s=this._toSet(i);const r=i.filter(a=>!n.has(a.description.identifier));const o=e.filter(a=>!s.has(a.description.identifier));return new Iu(r,o)}constructor(e,i){this.added=e;this.removed=i}}class MR{constructor(e,i,n){this.name=e;this.defaultExtensionKind=i;this.canHandleResolver=n;this._handler=null;this._users=null;this._delta=null}setHandler(e){if(this._handler!==null){throw new Error("Handler already set!")}this._handler=e;this._handle();return{dispose:()=>{this._handler=null}}}acceptUsers(e){this._delta=Iu.compute(this._users,e);this._users=e;this._handle()}_handle(){if(this._handler===null||this._users===null||this._delta===null){return}try{this._handler(this._users,this._delta)}catch(e){Pi(e)}}}const UR={type:"string",enum:["ui","workspace"],enumDescriptions:[h(12307,"UI extension kind. In a remote window, such extensions are enabled only when available on the local machine."),h(12308,"Workspace extension kind. In a remote window, such extensions are enabled only when available on the remote.")]};const T4="vscode://schemas/vscode-extensions";const V_={properties:{engines:{type:"object",description:h(12309,"Engine compatibility."),properties:{"vscode":{type:"string",description:h(12310,"For VS Code extensions, specifies the VS Code version that the extension is compatible with. Cannot be *. For example: ^0.10.5 indicates compatibility with a minimum VS Code version of 0.10.5."),default:"^1.22.0"}}},publisher:{description:h(12311,"The publisher of the VS Code extension."),type:"string"},displayName:{description:h(12312,"The display name for the extension used in the VS Code gallery."),type:"string"},categories:{description:h(12313,"The categories used by the VS Code gallery to categorize the extension."),type:"array",uniqueItems:true,items:{oneOf:[{type:"string",enum:GP},{type:"string",const:"Languages",deprecationMessage:h(12314,"Use 'Programming  Languages' instead")}]}},galleryBanner:{type:"object",description:h(12315,"Banner used in the VS Code marketplace."),properties:{color:{description:h(12316,"The banner color on the VS Code marketplace page header."),type:"string"},theme:{description:h(12317,"The color theme for the font used in the banner."),type:"string",enum:["dark","light"]}}},contributes:{description:h(12318,"All contributions of the VS Code extension represented by this package."),type:"object",properties:{},default:{}},preview:{type:"boolean",description:h(12319,"Sets the extension to be flagged as a Preview in the Marketplace.")},enableProposedApi:{type:"boolean",deprecationMessage:h(12320,"Use `enabledApiProposals` instead.")},enabledApiProposals:{markdownDescription:h(12321,"Enable API proposals to try them out. Only valid **during development**. Extensions **cannot be published** with this property. For more details visit: https://code.visualstudio.com/api/advanced-topics/using-proposed-api"),type:"array",uniqueItems:true,items:{type:"string",enum:Object.keys(mp).map(t=>t),markdownEnumDescriptions:Object.values(mp).map(t=>t.proposal)}},api:{markdownDescription:h(12322,"Describe the API provided by this extension. For more details visit: https://code.visualstudio.com/api/advanced-topics/remote-extensions#handling-dependencies-with-remote-extensions"),type:"string",enum:["none"],enumDescriptions:[h(12323,"Give up entirely the ability to export any APIs. This allows other extensions that depend on this extension to run in a separate extension host process or in a remote machine.")]},activationEvents:{description:h(12324,"Activation events for the VS Code extension."),type:"array",items:{type:"string",defaultSnippets:[{label:"onWebviewPanel",description:h(12325,"An activation event emmited when a webview is loaded of a certain viewType"),body:"onWebviewPanel:viewType"},{label:"onLanguage",description:h(12326,"An activation event emitted whenever a file that resolves to the specified language gets opened."),body:"onLanguage:${1:languageId}"},{label:"onCommand",description:h(12327,"An activation event emitted whenever the specified command gets invoked."),body:"onCommand:${2:commandId}"},{label:"onDebug",description:h(12328,"An activation event emitted whenever a user is about to start debugging or about to setup debug configurations."),body:"onDebug"},{label:"onDebugInitialConfigurations",description:h(12329,'An activation event emitted whenever a "launch.json" needs to be created (and all provideDebugConfigurations methods need to be called).'),body:"onDebugInitialConfigurations"},{label:"onDebugDynamicConfigurations",description:h(12330,'An activation event emitted whenever a list of all debug configurations needs to be created (and all provideDebugConfigurations methods for the "dynamic" scope need to be called).'),body:"onDebugDynamicConfigurations"},{label:"onDebugResolve",description:h(12331,"An activation event emitted whenever a debug session with the specific type is about to be launched (and a corresponding resolveDebugConfiguration method needs to be called)."),body:"onDebugResolve:${6:type}"},{label:"onDebugAdapterProtocolTracker",description:h(12332,"An activation event emitted whenever a debug session with the specific type is about to be launched and a debug protocol tracker might be needed."),body:"onDebugAdapterProtocolTracker:${6:type}"},{label:"workspaceContains",description:h(12333,"An activation event emitted whenever a folder is opened that contains at least a file matching the specified glob pattern."),body:"workspaceContains:${4:filePattern}"},{label:"onStartupFinished",description:h(12334,"An activation event emitted after the start-up finished (after all `*` activated extensions have finished activating)."),body:"onStartupFinished"},{label:"onTaskType",description:h(12335,"An activation event emitted whenever tasks of a certain type need to be listed or resolved."),body:"onTaskType:${1:taskType}"},{label:"onFileSystem",description:h(12336,"An activation event emitted whenever a file or folder is accessed with the given scheme."),body:"onFileSystem:${1:scheme}"},{label:"onEditSession",description:h(12337,"An activation event emitted whenever an edit session is accessed with the given scheme."),body:"onEditSession:${1:scheme}"},{label:"onSearch",description:h(12338,"An activation event emitted whenever a search is started in the folder with the given scheme."),body:"onSearch:${7:scheme}"},{label:"onView",body:"onView:${5:viewId}",description:h(12339,"An activation event emitted whenever the specified view is expanded.")},{label:"onUri",body:"onUri",description:h(12340,"An activation event emitted whenever a system-wide Uri directed towards this extension is open.")},{label:"onOpenExternalUri",body:"onOpenExternalUri",description:h(12341,"An activation event emitted whenever a external uri (such as an http or https link) is being opened.")},{label:"onCustomEditor",body:"onCustomEditor:${9:viewType}",description:h(12342,"An activation event emitted whenever the specified custom editor becomes visible.")},{label:"onNotebook",body:"onNotebook:${1:type}",description:h(12343,"An activation event emitted whenever the specified notebook document is opened.")},{label:"onAuthenticationRequest",body:"onAuthenticationRequest:${11:authenticationProviderId}",description:h(12344,"An activation event emitted whenever sessions are requested from the specified authentication provider.")},{label:"onRenderer",description:h(12345,"An activation event emitted whenever a notebook output renderer is used."),body:"onRenderer:${11:rendererId}"},{label:"onTerminalProfile",body:"onTerminalProfile:${1:terminalId}",description:h(12346,"An activation event emitted when a specific terminal profile is launched.")},{label:"onTerminalQuickFixRequest",body:"onTerminalQuickFixRequest:${1:quickFixId}",description:h(12347,"An activation event emitted when a command matches the selector associated with this ID")},{label:"onWalkthrough",body:"onWalkthrough:${1:walkthroughID}",description:h(12348,"An activation event emitted when a specified walkthrough is opened.")},{label:"onIssueReporterOpened",body:"onIssueReporterOpened",description:h(12349,"An activation event emitted when the issue reporter is opened.")},{label:"onChatParticipant",body:"onChatParticipant:${1:participantId}",description:h(12350,"An activation event emitted when the specified chat participant is invoked.")},{label:"onLanguageModelTool",body:"onLanguageModelTool:${1:toolId}",description:h(12351,"An activation event emitted when the specified language model tool is invoked.")},{label:"onTerminalCompletionsRequested",body:"onTerminalCompletionsRequested",description:h(12352,"An activation event emitted when terminal completions are requested.")},{label:"onMcpCollection",description:h(12353,"An activation event emitted whenver a tool from the MCP server is requested."),body:"onMcpCollection:${2:collectionId}"},{label:"*",description:h(12354,"An activation event emitted on VS Code startup. To ensure a great end user experience, please use this activation event in your extension only when no other activation events combination works in your use-case."),body:"*"}]}},badges:{type:"array",description:h(12355,"Array of badges to display in the sidebar of the Marketplace's extension page."),items:{type:"object",required:["url","href","description"],properties:{url:{type:"string",description:h(12356,"Badge image URL.")},href:{type:"string",description:h(12357,"Badge link.")},description:{type:"string",description:h(12358,"Badge description.")}}}},markdown:{type:"string",description:h(12359,"Controls the Markdown rendering engine used in the Marketplace. Either github (default) or standard."),enum:["github","standard"],default:"github"},qna:{default:"marketplace",description:h(12360,"Controls the Q&A link in the Marketplace. Set to marketplace to enable the default Marketplace Q & A site. Set to a string to provide the URL of a custom Q & A site. Set to false to disable Q & A altogether."),anyOf:[{type:["string","boolean"],enum:["marketplace",false]},{type:"string"}]},extensionDependencies:{description:h(12361,"Dependencies to other extensions. The identifier of an extension is always ${publisher}.${name}. For example: vscode.csharp."),type:"array",uniqueItems:true,items:{type:"string",pattern:_2}},extensionPack:{description:h(12362,"A set of extensions that can be installed together. The identifier of an extension is always ${publisher}.${name}. For example: vscode.csharp."),type:"array",uniqueItems:true,items:{type:"string",pattern:_2}},extensionKind:{description:h(12363,"Define the kind of an extension. `ui` extensions are installed and run on the local machine while `workspace` extensions run on the remote."),type:"array",items:UR,default:["workspace"],defaultSnippets:[{body:["ui"],description:h(12364,"Define an extension which can run only on the local machine when connected to remote window.")},{body:["workspace"],description:h(12365,"Define an extension which can run only on the remote machine when connected remote window.")},{body:["ui","workspace"],description:h(12366,"Define an extension which can run on either side, with a preference towards running on the local machine.")},{body:["workspace","ui"],description:h(12367,"Define an extension which can run on either side, with a preference towards running on the remote machine.")},{body:[],description:h(12368,"Define an extension which cannot run in a remote context, neither on the local, nor on the remote machine.")}]},capabilities:{description:h(12369,"Declare the set of supported capabilities by the extension."),type:"object",properties:{virtualWorkspaces:{description:h(12370,"Declares whether the extension should be enabled in virtual workspaces. A virtual workspace is a workspace which is not backed by any on-disk resources. When false, this extension will be automatically disabled in virtual workspaces. Default is true."),type:["boolean","object"],defaultSnippets:[{label:"limited",body:{supported:"${1:limited}",description:"${2}"}},{label:"false",body:{supported:false,description:"${2}"}}],default:true.valueOf,properties:{supported:{markdownDescription:h(12371,"Declares the level of support for virtual workspaces by the extension."),type:["string","boolean"],enum:["limited",true,false],enumDescriptions:[h(12372,"The extension will be enabled in virtual workspaces with some functionality disabled."),h(12373,"The extension will be enabled in virtual workspaces with all functionality enabled."),h(12374,"The extension will not be enabled in virtual workspaces.")]},description:{type:"string",markdownDescription:h(12375,"A description of how virtual workspaces affects the extensions behavior and why it is needed. This only applies when `supported` is not `true`.")}}},untrustedWorkspaces:{description:h(12376,"Declares how the extension should be handled in untrusted workspaces."),type:"object",required:["supported"],defaultSnippets:[{body:{supported:"${1:limited}",description:"${2}"}}],properties:{supported:{markdownDescription:h(12377,"Declares the level of support for untrusted workspaces by the extension."),type:["string","boolean"],enum:["limited",true,false],enumDescriptions:[h(12378,"The extension will be enabled in untrusted workspaces with some functionality disabled."),h(12379,"The extension will be enabled in untrusted workspaces with all functionality enabled."),h(12380,"The extension will not be enabled in untrusted workspaces.")]},restrictedConfigurations:{description:h(12381,"A list of configuration keys contributed by the extension that should not use workspace values in untrusted workspaces."),type:"array",items:{type:"string"}},description:{type:"string",markdownDescription:h(12382,"A description of how workspace trust affects the extensions behavior and why it is needed. This only applies when `supported` is not `true`.")}}}}},sponsor:{description:h(12383,"Specify the location from where users can sponsor your extension."),type:"object",defaultSnippets:[{body:{url:"${1:https:}"}}],properties:{"url":{description:h(12384,"URL from where users can sponsor your extension. It must be a valid URL with a HTTP or HTTPS protocol. Example value: https://github.com/sponsors/nvaccess"),type:"string"}}},scripts:{type:"object",properties:{"vscode:prepublish":{description:h(12385,"Script executed before the package is published as a VS Code extension."),type:"string"},"vscode:uninstall":{description:h(12386,"Uninstall hook for VS Code extension. Script that gets executed when the extension is completely uninstalled from VS Code which is when VS Code is restarted (shutdown and start) after the extension is uninstalled. Only Node scripts are supported."),type:"string"}}},icon:{type:"string",description:h(12387,"The path to a 128x128 pixel icon.")},l10n:{type:"string",description:h(12388,"The relative path to a folder containing localization (bundle.l10n.*.json) files. Must be specified if you are using the vscode.l10n API.")},pricing:{type:"string",markdownDescription:h(12389,"The pricing information for the extension. Can be Free (default) or Trial. For more details visit: https://code.visualstudio.com/api/working-with-extensions/publishing-extension#extension-pricing-label"),enum:["Free","Trial"],default:"Free"}}};class $R{constructor(){this._extensionPoints=new Map}registerExtensionPoint(e){if(this._extensionPoints.has(e.extensionPoint)){throw new Error("Duplicate extension point: "+e.extensionPoint)}const i=new MR(e.extensionPoint,e.defaultExtensionKind,e.canHandleResolver);this._extensionPoints.set(e.extensionPoint,i);if(e.activationEventsGenerator){RR.register(e.extensionPoint,e.activationEventsGenerator)}V_.properties["contributes"].properties[e.extensionPoint]=e.jsonSchema;J0.registerSchema(T4,V_);return i}getExtensionPoints(){return Array.from(this._extensionPoints.values())}}const P4={ExtensionsRegistry:"ExtensionsRegistry"};ci.add(P4.ExtensionsRegistry,new $R);const A4=ci.as(P4.ExtensionsRegistry);J0.registerSchema(T4,V_);J0.registerSchema(OR,{properties:{extensionEnabledApiProposals:{description:h(12390,"API proposals that the respective extensions can freely use."),type:"object",properties:{},additionalProperties:{anyOf:[{type:"array",uniqueItems:true,items:{type:"string",enum:Object.keys(mp),markdownEnumDescriptions:Object.values(mp).map(t=>t.proposal)}}]}}}});var ir;(function(t){t[t["System"]=0]="System";t[t["User"]=1]="User";t[t["Assistant"]=2]="Assistant"})(ir||(ir={}));var P2;(function(t){t["PNG"]="image/png";t["JPEG"]="image/jpeg";t["GIF"]="image/gif";t["WEBP"]="image/webp";t["BMP"]="image/bmp"})(P2||(P2={}));var A2;(function(t){t["Low"]="low";t["High"]="high"})(A2||(A2={}));const R2={type:"object",properties:{vendor:{type:"string",description:h(5061,"A globally unique vendor of language models.")}}};const HR=A4.registerExtensionPoint({extensionPoint:"languageModels",jsonSchema:{description:h(5062,"Contribute language models of a specific vendor."),oneOf:[R2,{type:"array",items:R2}]},activationEventsGenerator:(t,e)=>{for(const i of t){e.push(`onLanguageModelChat:${i.vendor}`)}}});let L2=class SM{constructor(e,i,n){this._extensionService=e;this._logService=i;this._contextKeyService=n;this._store=new Ie;this._providers=new Map;this._vendors=new Set;this._onDidChangeProviders=this._store.add(new L);this.onDidChangeLanguageModels=this._onDidChangeProviders.event;this._hasUserSelectableModels=fr.languageModelsAreUserSelectable.bindTo(this._contextKeyService);this._store.add(HR.setHandler(s=>{this._vendors.clear();for(const o of s){if(!dt(o.description,"chatProvider")){o.collector.error(h(5063,"This contribution point requires the 'chatProvider' proposal."));continue}for(const a of _i.wrap(o.value)){if(this._vendors.has(a.vendor)){o.collector.error(h(5064,"The vendor '{0}' is already registered and cannot be registered twice",a.vendor));continue}if(Qu(a.vendor)){o.collector.error(h(5065,"The vendor field cannot be empty."));continue}if(a.vendor.trim()!==a.vendor){o.collector.error(h(5066,"The vendor field cannot start or end with whitespace."));continue}this._vendors.add(a.vendor)}}const r=[];for(const[o,a]of this._providers){if(!this._vendors.has(a.metadata.vendor)){this._providers.delete(o);r.push(o)}}if(r.length>0){this._onDidChangeProviders.fire({removed:r})}}))}dispose(){this._store.dispose();this._providers.clear()}getLanguageModelIds(){return Array.from(this._providers.keys())}lookupLanguageModel(e){return this._providers.get(e)?.metadata}async selectLanguageModels(e){if(e.vendor){await this._extensionService.activateByEvent(`onLanguageModelChat:${e.vendor}}`)}else{const n=Array.from(this._vendors).map(s=>this._extensionService.activateByEvent(`onLanguageModelChat:${s}`));await Promise.all(n)}const i=[];for(const[n,s]of this._providers){if((e.vendor===void 0||s.metadata.vendor===e.vendor)&&(e.family===void 0||s.metadata.family===e.family)&&(e.version===void 0||s.metadata.version===e.version)&&(e.id===void 0||s.metadata.id===e.id)&&(!s.metadata.targetExtensions||s.metadata.targetExtensions.some(r=>Ze.equals(r,e.extension)))){i.push(n)}}this._logService.trace("[LM] selected language models",e,i);return i}registerLanguageModelChat(e,i){this._logService.trace("[LM] registering language model chat",e,i.metadata);if(!this._vendors.has(i.metadata.vendor)){throw new Error(`Chat response provider uses UNKNOWN vendor ${i.metadata.vendor}.`)}if(this._providers.has(e)){throw new Error(`Chat response provider with identifier ${e} is already registered.`)}this._providers.set(e,i);this._onDidChangeProviders.fire({added:[{identifier:e,metadata:i.metadata}]});this.updateUserSelectableModelsContext();return ge(()=>{this.updateUserSelectableModelsContext();if(this._providers.delete(e)){this._onDidChangeProviders.fire({removed:[e]});this._logService.trace("[LM] UNregistered language model chat",e,i.metadata)}})}updateUserSelectableModelsContext(){const e=Array.from(this._providers.values()).some(n=>n.metadata.isUserSelectable&&!n.metadata.isDefault);const i=Array.from(this._providers.values()).some(n=>n.metadata.isDefault);this._hasUserSelectableModels.set(e&&i)}async sendChatRequest(e,i,n,s,r){const o=this._providers.get(e);if(!o){throw new Error(`Chat response provider with identifier ${e} is not registered.`)}return o.sendChatRequest(n,i,s,r)}computeTokenLength(e,i,n){const s=this._providers.get(e);if(!s){throw new Error(`Chat response provider with identifier ${e} is not registered.`)}return s.provideTokenCount(i,n)}};L2=z([O(0,NR),O(1,at),O(2,Im)],L2);new T("debugType",void 0,{type:"string",description:h(5988,"Debug type of the active debug session. For example 'python'.")});new T("debugConfigurationType",void 0,{type:"string",description:h(5989,"Debug type of the selected launch configuration. For example 'python'.")});new T("debugState","inactive",{type:"string",description:h(5990,"State that the focused debug session is in. One of the following: 'inactive', 'initializing', 'stopped' or 'running'.")});const BR="debugUx";new T(BR,"default",{type:"string",description:h(5991,"Debug UX state. When there are no debug configurations it is 'simple', otherwise 'default'. Used to decide when to show welcome views in the debug viewlet.")});new T("hasDebugged",false,{type:"boolean",description:h(5992,"True when a debug session has been started at least once, false otherwise.")});new T("inDebugMode",false,{type:"boolean",description:h(5993,"True when debugging, false otherwise.")});new T("inDebugRepl",false,{type:"boolean",description:h(5994,"True when focus is in the debug console, false otherwise.")});new T("breakpointWidgetVisible",false,{type:"boolean",description:h(5995,"True when breakpoint editor zone widget is visible, false otherwise.")});new T("inBreakpointWidget",false,{type:"boolean",description:h(5996,"True when focus is in the breakpoint editor zone widget, false otherwise.")});new T("breakpointsFocused",true,{type:"boolean",description:h(5997,"True when the BREAKPOINTS view is focused, false otherwise.")});new T("watchExpressionsFocused",true,{type:"boolean",description:h(5998,"True when the WATCH view is focused, false otherwise.")});new T("watchExpressionsExist",false,{type:"boolean",description:h(5999,"True when at least one watch expression exists, false otherwise.")});new T("variablesFocused",true,{type:"boolean",description:h(6e3,"True when the VARIABLES views is focused, false otherwise")});new T("expressionSelected",false,{type:"boolean",description:h(6001,"True when an expression input box is open in either the WATCH or the VARIABLES view, false otherwise.")});new T("breakpointInputFocused",false,{type:"boolean",description:h(6002,"True when the input box has focus in the BREAKPOINTS view.")});new T("callStackItemType",void 0,{type:"string",description:h(6003,"Represents the item type of the focused element in the CALL STACK view. For example: 'session', 'thread', 'stackFrame'")});new T("callStackSessionIsAttach",false,{type:"boolean",description:h(6004,"True when the session in the CALL STACK view is attach, false otherwise. Used internally for inline menus in the CALL STACK view.")});new T("callStackItemStopped",false,{type:"boolean",description:h(6005,"True when the focused item in the CALL STACK is stopped. Used internaly for inline menus in the CALL STACK view.")});new T("callStackSessionHasOneThread",false,{type:"boolean",description:h(6006,"True when the focused session in the CALL STACK view has exactly one thread. Used internally for inline menus in the CALL STACK view.")});new T("callStackFocused",true,{type:"boolean",description:h(6007,"True when the CALLSTACK view is focused, false otherwise.")});new T("watchItemType",void 0,{type:"string",description:h(6008,"Represents the item type of the focused element in the WATCH view. For example: 'expression', 'variable'")});new T("canViewMemory",void 0,{type:"boolean",description:h(6009,"Indicates whether the item in the view has an associated memory refrence.")});new T("breakpointItemType",void 0,{type:"string",description:h(6010,"Represents the item type of the focused element in the BREAKPOINTS view. For example: 'breakpoint', 'exceptionBreakppint', 'functionBreakpoint', 'dataBreakpoint'")});new T("breakpointItemBytes",void 0,{type:"boolean",description:h(6011,"Whether the breakpoint item is a data breakpoint on a byte range.")});new T("breakpointHasModes",false,{type:"boolean",description:h(6012,"Whether the breakpoint has multiple modes it can switch to.")});new T("breakpointSupportsCondition",false,{type:"boolean",description:h(6013,"True when the focused breakpoint supports conditions.")});new T("loadedScriptsSupported",false,{type:"boolean",description:h(6014,"True when the focused sessions supports the LOADED SCRIPTS view")});new T("loadedScriptsItemType",void 0,{type:"string",description:h(6015,"Represents the item type of the focused element in the LOADED SCRIPTS view.")});new T("focusedSessionIsAttach",false,{type:"boolean",description:h(6016,"True when the focused session is 'attach'.")});new T("focusedSessionIsNoDebug",false,{type:"boolean",description:h(6017,"True when the focused session is run without debugging.")});new T("stepBackSupported",false,{type:"boolean",description:h(6018,"True when the focused session supports 'stepBack' requests.")});new T("restartFrameSupported",false,{type:"boolean",description:h(6019,"True when the focused session supports 'restartFrame' requests.")});new T("stackFrameSupportsRestart",false,{type:"boolean",description:h(6020,"True when the focused stack frame supports 'restartFrame'.")});new T("jumpToCursorSupported",false,{type:"boolean",description:h(6021,"True when the focused session supports 'jumpToCursor' request.")});new T("stepIntoTargetsSupported",false,{type:"boolean",description:h(6022,"True when the focused session supports 'stepIntoTargets' request.")});new T("breakpointsExist",false,{type:"boolean",description:h(6023,"True when at least one breakpoint exists.")});new T("debuggersAvailable",false,{type:"boolean",description:h(6024,"True when there is at least one debug extensions active.")});new T("debugExtensionAvailable",true,{type:"boolean",description:h(6025,"True when there is at least one debug extension installed and enabled.")});new T("debugProtocolVariableMenuContext",void 0,{type:"string",description:h(6026,"Represents the context the debug adapter sets on the focused variable in the VARIABLES view.")});new T("debugSetVariableSupported",false,{type:"boolean",description:h(6027,"True when the focused session supports 'setVariable' request.")});new T("debugSetDataBreakpointAddressSupported",false,{type:"boolean",description:h(6028,"True when the focused session supports 'getBreakpointInfo' request on an address.")});new T("debugSetExpressionSupported",false,{type:"boolean",description:h(6029,"True when the focused session supports 'setExpression' request.")});new T("breakWhenValueChangesSupported",false,{type:"boolean",description:h(6030,"True when the focused session supports to break when value changes.")});new T("breakWhenValueIsAccessedSupported",false,{type:"boolean",description:h(6031,"True when the focused breakpoint supports to break when value is accessed.")});new T("breakWhenValueIsReadSupported",false,{type:"boolean",description:h(6032,"True when the focused breakpoint supports to break when value is read.")});new T("terminateDebuggeeSupported",false,{type:"boolean",description:h(6033,"True when the focused session supports the terminate debuggee capability.")});new T("suspendDebuggeeSupported",false,{type:"boolean",description:h(6034,"True when the focused session supports the suspend debuggee capability.")});new T("variableEvaluateNamePresent",false,{type:"boolean",description:h(6035,"True when the focused variable has an 'evalauteName' field set.")});new T("variableIsReadonly",false,{type:"boolean",description:h(6036,"True when the focused variable is read-only.")});new T("variableValue",false,{type:"string",description:h(6037,"Value of the variable, present for debug visualization clauses.")});new T("variableType",false,{type:"string",description:h(6038,"Type of the variable, present for debug visualization clauses.")});new T("variableInterfaces",false,{type:"array",description:h(6039,"Any interfaces or contracts that the variable satisfies, present for debug visualization clauses.")});new T("variableName",false,{type:"string",description:h(6040,"Name of the variable, present for debug visualization clauses.")});new T("variableLanguage",false,{type:"string",description:h(6041,"Language of the variable source, present for debug visualization clauses.")});new T("variableExtensionId",false,{type:"string",description:h(6042,"Extension ID of the variable source, present for debug visualization clauses.")});new T("exceptionWidgetVisible",false,{type:"boolean",description:h(6043,"True when the exception widget is visible.")});new T("multiSessionRepl",false,{type:"boolean",description:h(6044,"True when there is more than 1 debug console.")});new T("multiSessionDebug",false,{type:"boolean",description:h(6045,"True when there is more than 1 active debug session.")});new T("disassembleRequestSupported",false,{type:"boolean",description:h(6046,"True when the focused sessions supports disassemble request.")});new T("disassemblyViewFocus",false,{type:"boolean",description:h(6047,"True when the Disassembly View is focused.")});new T("languageSupportsDisassembleRequest",false,{type:"boolean",description:h(6048,"True when the language in the current editor supports disassemble request.")});new T("focusedStackFrameHasInstructionReference",false,{type:"boolean",description:h(6049,"True when the focused stack frame has instruction pointer reference.")});({description:h(6051,"Controls when the internal Debug Console should open.")});var N2;(function(t){t[t["Inactive"]=0]="Inactive";t[t["Initializing"]=1]="Initializing";t[t["Stopped"]=2]="Stopped";t[t["Running"]=3]="Running"})(N2||(N2={}));var O2;(function(t){t[t["Valid"]=0]="Valid";t[t["Unreadable"]=1]="Unreadable";t[t["Error"]=2]="Error"})(O2||(O2={}));var F2;(function(t){t[t["Variable"]=0]="Variable";t[t["Address"]=1]="Address"})(F2||(F2={}));var _p;(function(t){t[t["Initial"]=1]="Initial";t[t["Dynamic"]=2]="Dynamic"})(_p||(_p={}));var M2;(function(t){t["UnverifiedBreakpoints"]="unverifiedBreakpoints"})(M2||(M2={}));var U2;(function(t){t[t["CONDITION"]=0]="CONDITION";t[t["HIT_COUNT"]=1]="HIT_COUNT";t[t["LOG_MESSAGE"]=2]="LOG_MESSAGE";t[t["TRIGGER_POINT"]=3]="TRIGGER_POINT"})(U2||(U2={}));var vp;(function(t){t[t["Command"]=0]="Command";t[t["Tree"]=1]="Tree"})(vp||(vp={}));var W_;(function(t){t[t["None"]=0]="None";t[t["Collapsed"]=1]="Collapsed";t[t["Expanded"]=2]="Expanded"})(W_||(W_={}));var $2;(function(t){t.deserialize=e=>e;t.serialize=e=>e})($2||($2={}));var H2;(function(t){t.deserialize=e=>({id:e.id,name:e.name,iconPath:e.iconPath&&{light:b.revive(e.iconPath.light),dark:b.revive(e.iconPath.dark)},iconClass:e.iconClass,visualization:e.visualization});t.serialize=e=>e})(H2||(H2={}));var mn;(function(t){t["Delimiter"]="\0"})(mn||(mn={}));var Kn;(function(t){t[t["IsSame"]=0]="IsSame";t[t["Disconnected"]=1]="Disconnected";t[t["IsChild"]=2]="IsChild";t[t["IsParent"]=3]="IsParent"})(Kn||(Kn={}));class Re{static fromExtHostTestItem(e,i,n=e.parent){if(e._isRoot){return new Re([i])}const s=[e.id];for(let r=n;r&&r.id!==i;r=r.parent){s.push(r.id)}s.push(i);return new Re(s.reverse())}static isRoot(e){return!e.includes(mn.Delimiter)}static root(e){const i=e.indexOf(mn.Delimiter);return i===-1?e:e.slice(0,i)}static fromString(e){return new Re(e.split(mn.Delimiter))}static join(e,i){return new Re([...e.path,i])}static split(e){return e.split(mn.Delimiter)}static joinToString(e,i){return e.toString()+mn.Delimiter+i}static parentId(e){const i=e.lastIndexOf(mn.Delimiter);return i===-1?void 0:e.slice(0,i)}static localId(e){const i=e.lastIndexOf(mn.Delimiter);return i===-1?e:e.slice(i+mn.Delimiter.length)}static isChild(e,i){return i[e.length]===mn.Delimiter&&i.startsWith(e)}static compare(e,i){if(e===i){return Kn.IsSame}if(Re.isChild(e,i)){return Kn.IsChild}if(Re.isChild(i,e)){return Kn.IsParent}return Kn.Disconnected}static getLengthOfCommonPrefix(e,i){if(e===0){return 0}let n=0;while(n<e-1){for(let s=1;s<e;s++){const r=i(s-1);const o=i(s);if(r.path[n]!==o.path[n]){return n}}n++}return n}constructor(e,i=e.length){this.path=e;this.viewEnd=i;if(e.length===0||i<1){throw new Error("cannot create test with empty path")}}get rootId(){return new Re(this.path,1)}get parentId(){return this.viewEnd>1?new Re(this.path,this.viewEnd-1):void 0}get localId(){return this.path[this.viewEnd-1]}get controllerId(){return this.path[0]}get isRoot(){return this.viewEnd===1}*idsFromRoot(){for(let e=1;e<=this.viewEnd;e++){yield new Re(this.path,e)}}*idsToRoot(){for(let e=this.viewEnd;e>0;e--){yield new Re(this.path,e)}}compare(e){if(typeof e==="string"){return Re.compare(this.toString(),e)}for(let i=0;i<e.viewEnd&&i<this.viewEnd;i++){if(e.path[i]!==this.path[i]){return Kn.Disconnected}}if(e.viewEnd>this.viewEnd){return Kn.IsChild}if(e.viewEnd<this.viewEnd){return Kn.IsParent}return Kn.IsSame}toJSON(){return this.toString()}toString(){if(!this.stringifed){this.stringifed=this.path[0];for(let e=1;e<this.viewEnd;e++){this.stringifed+=mn.Delimiter;this.stringifed+=this.path[e]}}return this.stringifed}}var Jt;(function(t){t[t["Unset"]=0]="Unset";t[t["Queued"]=1]="Queued";t[t["Running"]=2]="Running";t[t["Passed"]=3]="Passed";t[t["Failed"]=4]="Failed";t[t["Skipped"]=5]="Skipped";t[t["Errored"]=6]="Errored"})(Jt||(Jt={}));({[Jt.Unset]:"unset",[Jt.Queued]:"queued",[Jt.Running]:"running",[Jt.Passed]:"passed",[Jt.Failed]:"failed",[Jt.Skipped]:"skipped",[Jt.Errored]:"errored"});var B2;(function(t){t[t["Run"]=1]="Run";t[t["Debug"]=2]="Debug";t[t["Coverage"]=3]="Coverage"})(B2||(B2={}));var Cu;(function(t){t[t["Refresh"]=2]="Refresh";t[t["CodeRelatedToTest"]=4]="CodeRelatedToTest";t[t["TestRelatedToCode"]=8]="TestRelatedToCode"})(Cu||(Cu={}));var Ii;(function(t){t[t["Run"]=2]="Run";t[t["Debug"]=4]="Debug";t[t["Coverage"]=8]="Coverage";t[t["HasNonDefaultProfile"]=16]="HasNonDefaultProfile";t[t["HasConfigurable"]=32]="HasConfigurable";t[t["SupportsContinuousRun"]=64]="SupportsContinuousRun"})(Ii||(Ii={}));({[Ii.Run]:h(11059,"Run"),[Ii.Debug]:h(11060,"Debug"),[Ii.Coverage]:h(11061,"Coverage")});[Ii.Run,Ii.Debug,Ii.Coverage,Ii.HasNonDefaultProfile,Ii.HasConfigurable,Ii.SupportsContinuousRun];const VR=t=>"runId"in t;var Zl;(function(t){t.serialize=e=>({range:e.range.toJSON(),uri:e.uri.toJSON()});t.deserialize=(e,i)=>({range:et.lift(i.range),uri:e.asCanonicalUri(b.revive(i.uri))})})(Zl||(Zl={}));var as;(function(t){t[t["Error"]=0]="Error";t[t["Output"]=1]="Output"})(as||(as={}));var wp;(function(t){t.serialize=e=>({label:e.label,uri:e.uri?.toJSON(),position:e.position?.toJSON()});t.deserialize=(e,i)=>({label:i.label,uri:i.uri?e.asCanonicalUri(b.revive(i.uri)):void 0,position:i.position?En.lift(i.position):void 0})})(wp||(wp={}));var bp;(function(t){t.serialize=e=>({message:e.message,type:as.Error,expected:e.expected,actual:e.actual,contextValue:e.contextValue,location:e.location&&Zl.serialize(e.location),stackTrace:e.stackTrace?.map(wp.serialize)});t.deserialize=(e,i)=>({message:i.message,type:as.Error,expected:i.expected,actual:i.actual,contextValue:i.contextValue,location:i.location&&Zl.deserialize(e,i.location),stackTrace:i.stackTrace&&i.stackTrace.map(n=>wp.deserialize(e,n))})})(bp||(bp={}));var yp;(function(t){t.serialize=e=>({message:e.message,type:as.Output,offset:e.offset,length:e.length,location:e.location&&Zl.serialize(e.location)});t.deserialize=(e,i)=>({message:i.message,type:as.Output,offset:i.offset,length:i.length,location:i.location&&Zl.deserialize(e,i.location)})})(yp||(yp={}));var xp;(function(t){t.serialize=e=>e.type===as.Error?bp.serialize(e):yp.serialize(e);t.deserialize=(e,i)=>i.type===as.Error?bp.deserialize(e,i):yp.deserialize(e,i);t.isDiffable=e=>e.type===as.Error&&e.actual!==void 0&&e.expected!==void 0})(xp||(xp={}));var Tu;(function(t){t.serializeWithoutMessages=e=>({state:e.state,duration:e.duration,messages:[]});t.serialize=e=>({state:e.state,duration:e.duration,messages:e.messages.map(xp.serialize)});t.deserialize=(e,i)=>({state:i.state,duration:i.duration,messages:i.messages.map(n=>xp.deserialize(e,n))})})(Tu||(Tu={}));const R4="\0";const lf=(t,e)=>t+R4+e;const L4=t=>{const e=t.indexOf(R4);return{ctrlId:t.slice(0,e),tagId:t.slice(e+1)}};var Ep;(function(t){t.serialize=e=>({extId:e.extId,label:e.label,tags:e.tags,busy:e.busy,children:void 0,uri:e.uri?.toJSON(),range:e.range?.toJSON()||null,description:e.description,error:e.error,sortText:e.sortText});t.deserialize=(e,i)=>({extId:i.extId,label:i.label,tags:i.tags,busy:i.busy,children:void 0,uri:i.uri?e.asCanonicalUri(b.revive(i.uri)):void 0,range:i.range?et.lift(i.range):null,description:i.description,error:i.error,sortText:i.sortText})})(Ep||(Ep={}));var Si;(function(t){t[t["NotExpandable"]=0]="NotExpandable";t[t["Expandable"]=1]="Expandable";t[t["BusyExpanding"]=2]="BusyExpanding";t[t["Expanded"]=3]="Expanded"})(Si||(Si={}));var ho;(function(t){t.serialize=e=>({expand:e.expand,item:Ep.serialize(e.item)});t.deserialize=(e,i)=>({controllerId:Re.root(i.item.extId),expand:i.expand,item:Ep.deserialize(e,i.item)})})(ho||(ho={}));var sd;(function(t){t.serialize=e=>{let i;if(e.item){i={};if(e.item.label!==void 0){i.label=e.item.label}if(e.item.tags!==void 0){i.tags=e.item.tags}if(e.item.busy!==void 0){i.busy=e.item.busy}if(e.item.uri!==void 0){i.uri=e.item.uri?.toJSON()}if(e.item.range!==void 0){i.range=e.item.range?.toJSON()}if(e.item.description!==void 0){i.description=e.item.description}if(e.item.error!==void 0){i.error=e.item.error}if(e.item.sortText!==void 0){i.sortText=e.item.sortText}}return{extId:e.extId,expand:e.expand,item:i}};t.deserialize=e=>{let i;if(e.item){i={};if(e.item.label!==void 0){i.label=e.item.label}if(e.item.tags!==void 0){i.tags=e.item.tags}if(e.item.busy!==void 0){i.busy=e.item.busy}if(e.item.range!==void 0){i.range=e.item.range?et.lift(e.item.range):null}if(e.item.description!==void 0){i.description=e.item.description}if(e.item.error!==void 0){i.error=e.item.error}if(e.item.sortText!==void 0){i.sortText=e.item.sortText}}return{extId:e.extId,expand:e.expand,item:i}}})(sd||(sd={}));const z_=(t,e)=>{if(e.expand!==void 0){t.expand=e.expand}if(e.item!==void 0){t.item=t.item?Object.assign(t.item,e.item):e.item}};var V2;(function(t){t.serializeWithoutMessages=e=>({...ho.serialize(e),ownComputedState:e.ownComputedState,computedState:e.computedState,tasks:e.tasks.map(Tu.serializeWithoutMessages)});t.serialize=e=>({...ho.serialize(e),ownComputedState:e.ownComputedState,computedState:e.computedState,tasks:e.tasks.map(Tu.serialize)});t.deserialize=(e,i)=>({...ho.deserialize(e,i),ownComputedState:i.ownComputedState,computedState:i.computedState,tasks:i.tasks.map(n=>Tu.deserialize(e,n)),retired:true})})(V2||(V2={}));var q_;(function(t){t.empty=()=>({covered:0,total:0});t.sum=(e,i)=>{e.covered+=i.covered;e.total+=i.total}})(q_||(q_={}));var W2;(function(t){t.serialize=e=>({id:e.id,statement:e.statement,branch:e.branch,declaration:e.declaration,testIds:e.testIds,uri:e.uri.toJSON()});t.deserialize=(e,i)=>({id:i.id,statement:i.statement,branch:i.branch,declaration:i.declaration,testIds:i.testIds,uri:e.asCanonicalUri(b.revive(i.uri))});t.empty=(e,i)=>({id:e,uri:i,statement:q_.empty()})})(W2||(W2={}));function X0(t){return{...t,location:t.location?.toJSON()}}function Y0(t){t.location=t.location?En.isIPosition(t.location)?En.lift(t.location):et.lift(t.location):void 0;return t}var la;(function(t){t[t["Declaration"]=0]="Declaration";t[t["Statement"]=1]="Statement";t[t["Branch"]=2]="Branch"})(la||(la={}));var z2;(function(t){t.serialize=e=>e.type===la.Declaration?Dp.serialize(e):kp.serialize(e);t.deserialize=e=>e.type===la.Declaration?Dp.deserialize(e):kp.deserialize(e)})(z2||(z2={}));var Sp;(function(t){t.serialize=X0;t.deserialize=Y0})(Sp||(Sp={}));var Dp;(function(t){t.serialize=X0;t.deserialize=Y0})(Dp||(Dp={}));var kp;(function(t){t.serialize=e=>({...X0(e),branches:e.branches?.map(Sp.serialize)});t.deserialize=e=>({...Y0(e),branches:e.branches?.map(Sp.deserialize)})})(kp||(kp={}));var kt;(function(t){t[t["Add"]=0]="Add";t[t["Update"]=1]="Update";t[t["DocumentSynced"]=2]="DocumentSynced";t[t["Remove"]=3]="Remove";t[t["IncrementPendingExtHosts"]=4]="IncrementPendingExtHosts";t[t["Retire"]=5]="Retire";t[t["AddTag"]=6]="AddTag";t[t["RemoveTag"]=7]="RemoveTag"})(kt||(kt={}));var Ip;(function(t){t.deserialize=(e,i)=>{if(i.op===kt.Add){return{op:i.op,item:ho.deserialize(e,i.item)}}else if(i.op===kt.Update){return{op:i.op,item:sd.deserialize(i.item)}}else if(i.op===kt.DocumentSynced){return{op:i.op,uri:e.asCanonicalUri(b.revive(i.uri)),docv:i.docv}}else{return i}};t.serialize=e=>{if(e.op===kt.Add){return{op:e.op,item:ho.serialize(e.item)}}else if(e.op===kt.Update){return{op:e.op,item:sd.serialize(e.item)}}else{return e}}})(Ip||(Ip={}));class WR{constructor(e){this.uriIdentity=e;this._tags=new Map;this.items=new Map;this.roots=new Set;this.busyControllerCount=0;this.pendingRootCount=0;this.tags=this._tags}apply(e){const i=this.createChangeCollector();for(const n of e){switch(n.op){case kt.Add:this.add(ho.deserialize(this.uriIdentity,n.item),i);break;case kt.Update:this.update(sd.deserialize(n.item),i);break;case kt.Remove:this.remove(n.itemId,i);break;case kt.Retire:this.retireTest(n.itemId);break;case kt.IncrementPendingExtHosts:this.updatePendingRoots(n.amount);break;case kt.AddTag:this._tags.set(n.tag.id,n.tag);break;case kt.RemoveTag:this._tags.delete(n.id);break}}i.complete?.()}add(e,i){const n=Re.parentId(e.item.extId)?.toString();let s;if(!n){s=this.createItem(e);this.roots.add(s);this.items.set(e.item.extId,s)}else if(this.items.has(n)){const r=this.items.get(n);r.children.add(e.item.extId);s=this.createItem(e,r);this.items.set(e.item.extId,s)}else{console.error(`Test with unknown parent ID: ${JSON.stringify(e)}`);return}i.add?.(s);if(e.expand===Si.BusyExpanding){this.busyControllerCount++}return s}update(e,i){const n=this.items.get(e.extId);if(!n){return}if(e.expand!==void 0){if(n.expand===Si.BusyExpanding){this.busyControllerCount--}if(e.expand===Si.BusyExpanding){this.busyControllerCount++}}z_(n,e);i.update?.(n);return n}remove(e,i){const n=this.items.get(e);if(!n){return}const s=Re.parentId(n.item.extId)?.toString();if(s){const o=this.items.get(s);o.children.delete(n.item.extId)}else{this.roots.delete(n)}const r=[[e]];while(r.length){for(const o of r.pop()){const a=this.items.get(o);if(a){r.push(a.children);this.items.delete(o);i.remove?.(a,a!==n);if(a.expand===Si.BusyExpanding){this.busyControllerCount--}}}}}retireTest(e){}updatePendingRoots(e){this.pendingRootCount+=e}createChangeCollector(){return{}}}var q2;(function(t){t[t["UP"]=0]="UP";t[t["DOWN"]=1]="DOWN";t[t["LEFT"]=2]="LEFT";t[t["RIGHT"]=3]="RIGHT"})(q2||(q2={}));var j2;(function(t){t[t["HORIZONTAL"]=0]="HORIZONTAL";t[t["VERTICAL"]=1]="VERTICAL"})(j2||(j2={}));var G2;(function(t){t[t["FIRST"]=0]="FIRST";t[t["LAST"]=1]="LAST";t[t["NEXT"]=2]="NEXT";t[t["PREVIOUS"]=3]="PREVIOUS"})(G2||(G2={}));var K2;(function(t){t[t["MAXIMIZE"]=0]="MAXIMIZE";t[t["EXPAND"]=1]="EXPAND";t[t["EVEN"]=2]="EVEN"})(K2||(K2={}));var Q2;(function(t){t[t["COPY_EDITORS"]=0]="COPY_EDITORS";t[t["MOVE_EDITORS"]=1]="MOVE_EDITORS"})(Q2||(Q2={}));var J2;(function(t){t[t["CREATION_TIME"]=0]="CREATION_TIME";t[t["MOST_RECENTLY_ACTIVE"]=1]="MOST_RECENTLY_ACTIVE";t[t["GRID_APPEARANCE"]=2]="GRID_APPEARANCE"})(J2||(J2={}));var X2;(function(t){t[t["NEW_EDITOR"]=1]="NEW_EDITOR";t[t["MOVE_EDITOR"]=2]="MOVE_EDITOR";t[t["COPY_EDITOR"]=3]="COPY_EDITOR"})(X2||(X2={}));const zR=-1;const qR=-2;var gi;(function(t){t[t["Upsert"]=0]="Upsert";t[t["SetTags"]=1]="SetTags";t[t["UpdateCanResolveChildren"]=2]="UpdateCanResolveChildren";t[t["RemoveChild"]=3]="RemoveChild";t[t["SetProp"]=4]="SetProp";t[t["Bulk"]=5]="Bulk";t[t["DocumentSynced"]=6]="DocumentSynced"})(gi||(gi={}));const Gc=(t,e)=>t===e;const jR={range:(t,e)=>{if(t===e){return true}if(!t||!e){return false}return t.equalsRange(e)},busy:Gc,label:Gc,description:Gc,error:Gc,sortText:Gc,tags:(t,e)=>{if(t.length!==e.length){return false}if(t.some(i=>!e.includes(i))){return false}return true}};const GR=Object.entries(jR);const KR=(t,e)=>{let i;for(const[n,s]of GR){if(!s(t[n],e[n])){if(i){i[n]=e[n]}else{i={[n]:e[n]}}}}return i};class QR extends Ee{get root(){return this.options.root}constructor(e){super();this.options=e;this.debounceSendDiff=this._register(new Ic(()=>this.flushDiff(),200));this.diffOpEmitter=this._register(new L);this.tree=new Map;this.tags=new Map;this.diff=[];this.onDidGenerateDiff=this.diffOpEmitter.event;this.root.canResolveChildren=true;this.upsertItem(this.root,void 0)}set resolveHandler(e){this._resolveHandler=e;for(const i of this.tree.values()){this.updateExpandability(i)}}get resolveHandler(){return this._resolveHandler}collectDiff(){const e=this.diff;this.diff=[];return e}pushDiff(e){switch(e.op){case kt.DocumentSynced:{for(const i of this.diff){if(i.op===kt.DocumentSynced&&i.uri===e.uri){i.docv=e.docv;return}}break}case kt.Update:{const i=this.diff[this.diff.length-1];if(i){if(i.op===kt.Update&&i.item.extId===e.item.extId){z_(i.item,e.item);return}if(i.op===kt.Add&&i.item.item.extId===e.item.extId){z_(i.item,e.item);return}}break}}this.diff.push(e);if(!this.debounceSendDiff.isScheduled()){this.debounceSendDiff.schedule()}}expand(e,i){const n=this.tree.get(e);if(!n){return}if(n.expandLevels===void 0||i>n.expandLevels){n.expandLevels=i}if(n.expand===Si.Expandable){const s=this.resolveChildren(n);return!s.isOpen()?s.wait().then(()=>this.expandChildren(n,i-1)):this.expandChildren(n,i-1)}else if(n.expand===Si.Expanded){return n.resolveBarrier?.isOpen()===false?n.resolveBarrier.wait().then(()=>this.expandChildren(n,i-1)):this.expandChildren(n,i-1)}}dispose(){for(const e of this.tree.values()){this.options.getApiFor(e.actual).listener=void 0}this.tree.clear();this.diff=[];super.dispose()}onTestItemEvent(e,i){switch(i.op){case gi.RemoveChild:this.removeItem(Re.joinToString(e.fullId,i.id));break;case gi.Upsert:this.upsertItem(i.item,e);break;case gi.Bulk:for(const n of i.ops){this.onTestItemEvent(e,n)}break;case gi.SetTags:this.diffTagRefs(i.new,i.old,e.fullId.toString());break;case gi.UpdateCanResolveChildren:this.updateExpandability(e);break;case gi.SetProp:this.pushDiff({op:kt.Update,item:{extId:e.fullId.toString(),item:i.update}});break;case gi.DocumentSynced:this.documentSynced(e.actual.uri);break;default:t_()}}documentSynced(e){if(e){this.pushDiff({op:kt.DocumentSynced,uri:e,docv:this.options.getDocumentVersion(e)})}}upsertItem(e,i){const n=Re.fromExtHostTestItem(e,this.root.id,i?.actual);const s=this.options.getApiFor(e);if(s.parent&&s.parent!==i?.actual){this.options.getChildren(s.parent).delete(e.id)}let r=this.tree.get(n.toString());if(!r){r={fullId:n,actual:e,expandLevels:i?.expandLevels?i.expandLevels-1:void 0,expand:Si.NotExpandable};e.tags.forEach(this.incrementTagRefs,this);this.tree.set(r.fullId.toString(),r);this.setItemParent(e,i);this.pushDiff({op:kt.Add,item:{controllerId:this.options.controllerId,expand:r.expand,item:this.options.toITestItem(e)}});this.connectItemAndChildren(e,r,i);return}if(r.actual===e){this.connectItem(e,r,i);return}if(r.actual.uri?.toString()!==e.uri?.toString()){this.removeItem(n.toString());return this.upsertItem(e,i)}const o=this.options.getChildren(r.actual);const a=r.actual;const l=KR(this.options.toITestItem(a),this.options.toITestItem(e));this.options.getApiFor(a).listener=void 0;r.actual=e;r.resolveBarrier=void 0;r.expand=Si.NotExpandable;if(l){if(l.hasOwnProperty("tags")){this.diffTagRefs(e.tags,a.tags,n.toString());delete l.tags}this.onTestItemEvent(r,{op:gi.SetProp,update:l})}this.connectItemAndChildren(e,r,i);for(const[u,d]of o){if(!this.options.getChildren(e).get(d.id)){this.removeItem(Re.joinToString(n,d.id))}}const c=r.expandLevels;if(c!==void 0){queueMicrotask(()=>{if(r.expand===Si.Expandable){r.expandLevels=void 0;this.expand(n.toString(),c)}})}this.documentSynced(r.actual.uri)}diffTagRefs(e,i,n){const s=new Set(i.map(r=>r.id));for(const r of e){if(!s.delete(r.id)){this.incrementTagRefs(r)}}this.pushDiff({op:kt.Update,item:{extId:n,item:{tags:e.map(r=>lf(this.options.controllerId,r.id))}}});s.forEach(this.decrementTagRefs,this)}incrementTagRefs(e){const i=this.tags.get(e.id);if(i){i.refCount++}else{this.tags.set(e.id,{refCount:1});this.pushDiff({op:kt.AddTag,tag:{id:lf(this.options.controllerId,e.id)}})}}decrementTagRefs(e){const i=this.tags.get(e);if(i&&!--i.refCount){this.tags.delete(e);this.pushDiff({op:kt.RemoveTag,id:lf(this.options.controllerId,e)})}}setItemParent(e,i){this.options.getApiFor(e).parent=i&&i.actual!==this.root?i.actual:void 0}connectItem(e,i,n){this.setItemParent(e,n);const s=this.options.getApiFor(e);s.parent=n?.actual;s.listener=r=>this.onTestItemEvent(i,r);this.updateExpandability(i)}connectItemAndChildren(e,i,n){this.connectItem(e,i,n);for(const[s,r]of this.options.getChildren(e)){this.upsertItem(r,i)}}updateExpandability(e){let i;if(!this._resolveHandler){i=Si.NotExpandable}else if(e.resolveBarrier){i=e.resolveBarrier.isOpen()?Si.Expanded:Si.BusyExpanding}else{i=e.actual.canResolveChildren?Si.Expandable:Si.NotExpandable}if(i===e.expand){return}e.expand=i;this.pushDiff({op:kt.Update,item:{extId:e.fullId.toString(),expand:i}});if(i===Si.Expandable&&e.expandLevels!==void 0){this.resolveChildren(e)}}expandChildren(e,i){if(i<0){return}const n=[];for(const[s,r]of this.options.getChildren(e.actual)){const o=this.expand(Re.joinToString(e.fullId,r.id),i);if(po(o)){n.push(o)}}if(n.length){return Promise.all(n).then(()=>{})}}resolveChildren(e){if(e.resolveBarrier){return e.resolveBarrier}if(!this._resolveHandler){const r=new xs;r.open();return r}e.expand=Si.BusyExpanding;this.pushExpandStateUpdate(e);const i=e.resolveBarrier=new xs;const n=r=>{console.error(`Unhandled error in resolveHandler of test controller "${this.options.controllerId}"`,r)};let s;try{s=this._resolveHandler(e.actual===this.root?void 0:e.actual)}catch(r){n(r)}if(po(s)){s.catch(n).then(()=>{i.open();this.updateExpandability(e)})}else{i.open();this.updateExpandability(e)}return e.resolveBarrier}pushExpandStateUpdate(e){this.pushDiff({op:kt.Update,item:{extId:e.fullId.toString(),expand:e.expand}})}removeItem(e){const i=this.tree.get(e);if(!i){throw new Error("attempting to remove non-existent child")}this.pushDiff({op:kt.Remove,itemId:e});const n=[i];while(n.length){const s=n.pop();if(!s){continue}this.options.getApiFor(s.actual).listener=void 0;for(const r of s.actual.tags){this.decrementTagRefs(r.id)}this.tree.delete(s.fullId.toString());for(const[r,o]of this.options.getChildren(s.actual)){n.push(this.tree.get(Re.joinToString(s.fullId,o.id)))}}}flushDiff(){const e=this.collectDiff();if(e.length){this.diffOpEmitter.fire(e)}}}class JR extends Error{constructor(e){super(`Attempted to insert a duplicate test item ID ${e}`)}}class Cp extends Error{constructor(e){super(`TestItem with ID "${e}" is invalid. Make sure to create it from the createTestItem method.`)}}class XR extends Error{constructor(e,i,n){super(`TestItem with ID "${e}" is from controller "${i}" and cannot be added as a child of an item from controller "${n}".`)}}const YR=(t,e,i)=>{let n=new Map;return{get size(){return n.size},forEach(s,r){for(const o of n.values()){s.call(r,o,this)}},[Symbol.iterator](){return n.entries()},replace(s){const r=new Map;const o=new Set(n.keys());const a={op:gi.Bulk,ops:[]};for(const l of s){if(!(l instanceof i)){throw new Cp(l.id)}const c=e(l).controllerId;if(c!==t.controllerId){throw new XR(l.id,c,t.controllerId)}if(r.has(l.id)){throw new JR(l.id)}r.set(l.id,l);o.delete(l.id);a.ops.push({op:gi.Upsert,item:l})}for(const l of o.keys()){a.ops.push({op:gi.RemoveChild,id:l})}t.listener?.(a);n=r},add(s){if(!(s instanceof i)){throw new Cp(s.id)}n.set(s.id,s);t.listener?.({op:gi.Upsert,item:s})},delete(s){if(n.delete(s)){t.listener?.({op:gi.RemoveChild,id:s})}},get(s){return n.get(s)},toJSON(){return Array.from(n.values())}}};const N4=new WeakMap;const ZR=(t,e)=>{const i={controllerId:e};N4.set(t,i);return i};const Tm=t=>{const e=N4.get(t);if(!e){throw new Cp(t?.id||"<unknown>")}return e};var Y2;(function(t){t[t["ACTIVATE"]=1]="ACTIVATE";t[t["RESTORE"]=2]="RESTORE";t[t["PRESERVE"]=3]="PRESERVE"})(Y2||(Y2={}));var Z2;(function(t){t[t["PICK"]=0]="PICK";t[t["EXCLUSIVE_ONLY"]=1]="EXCLUSIVE_ONLY"})(Z2||(Z2={}));var eS;(function(t){t[t["API"]=0]="API";t[t["USER"]=1]="USER"})(eS||(eS={}));var tS;(function(t){t[t["Center"]=0]="Center";t[t["CenterIfOutsideViewport"]=1]="CenterIfOutsideViewport";t[t["NearTop"]=2]="NearTop";t[t["NearTopIfOutsideViewport"]=3]="NearTopIfOutsideViewport"})(tS||(tS={}));var Pu;(function(t){t["PROGRAMMATIC"]="api";t["NAVIGATION"]="code.navigation";t["JUMP"]="code.jump"})(Pu||(Pu={}));var Tp;(function(t){t[t["WebSocket"]=0]="WebSocket";t[t["Managed"]=1]="Managed"})(Tp||(Tp={}));class e3{constructor(e){this.id=e;this.type=Tp.Managed}toString(){return`Managed(${this.id})`}}class t3{constructor(e,i){this.host=e;this.port=i;this.type=Tp.WebSocket}toString(){return`WebSocket(${this.host}:${this.port})`}}var pr;(function(t){t["Unknown"]="Unknown";t["NotAvailable"]="NotAvailable";t["TemporarilyNotAvailable"]="TemporarilyNotAvailable";t["NoResolverFound"]="NoResolverFound";t["InvalidAuthority"]="InvalidAuthority"})(pr||(pr={}));function iS(t){const e=t.indexOf("+");if(e===-1){return t}return t.substring(0,e)}var j_;var To;var Js;var G_;var Po;var $r;var Ao;var K_;var Q_;var cf;var ou;var J_;var fs;var ps;var X_;var Gi;var Y_;function me(t){const e={apply:function(...i){if(i.length===0){return Reflect.construct(t,[])}else{const n=i.length===1?[]:i[1];return Reflect.construct(t,n,i[0].constructor)}},call:function(...i){if(i.length===0){return Reflect.construct(t,[])}else{const[n,...s]=i;return Reflect.construct(t,s,n.constructor)}}};return Object.assign(t,e)}var Z_;(function(t){t[t["Top"]=0]="Top";t[t["Bottom"]=1]="Bottom"})(Z_||(Z_={}));var nS;(function(t){t[t["TerminalCommand"]=0]="TerminalCommand";t[t["Opener"]=1]="Opener";t[t["Command"]=3]="Command"})(nS||(nS={}));let qe=j_=class DM{static from(...e){let i=e;return new j_(function(){if(i){for(const n of i){if(n&&typeof n.dispose==="function"){n.dispose()}}i=void 0}})}#e;constructor(e){this.#e=e}dispose(){if(typeof this.#e==="function"){this.#e();this.#e=void 0}}};qe=j_=z([me],qe);let Ve=To=class kM{static Min(...e){if(e.length===0){throw new TypeError}let i=e[0];for(let n=1;n<e.length;n++){const s=e[n];if(s.isBefore(i)){i=s}}return i}static Max(...e){if(e.length===0){throw new TypeError}let i=e[0];for(let n=1;n<e.length;n++){const s=e[n];if(s.isAfter(i)){i=s}}return i}static isPosition(e){if(!e){return false}if(e instanceof To){return true}const{line:i,character:n}=e;if(typeof i==="number"&&typeof n==="number"){return true}return false}static of(e){if(e instanceof To){return e}else if(this.isPosition(e)){return new To(e.line,e.character)}throw new Error("Invalid argument, is NOT a position-like object")}get line(){return this._line}get character(){return this._character}constructor(e,i){if(e<0){throw $e("line must be non-negative")}if(i<0){throw $e("character must be non-negative")}this._line=e;this._character=i}isBefore(e){if(this._line<e._line){return true}if(e._line<this._line){return false}return this._character<e._character}isBeforeOrEqual(e){if(this._line<e._line){return true}if(e._line<this._line){return false}return this._character<=e._character}isAfter(e){return!this.isBeforeOrEqual(e)}isAfterOrEqual(e){return!this.isBefore(e)}isEqual(e){return this._line===e._line&&this._character===e._character}compareTo(e){if(this._line<e._line){return-1}else if(this._line>e.line){return 1}else{if(this._character<e._character){return-1}else if(this._character>e._character){return 1}else{return 0}}}translate(e,i=0){if(e===null||i===null){throw $e()}let n;if(typeof e==="undefined"){n=0}else if(typeof e==="number"){n=e}else{n=typeof e.lineDelta==="number"?e.lineDelta:0;i=typeof e.characterDelta==="number"?e.characterDelta:0}if(n===0&&i===0){return this}return new To(this.line+n,this.character+i)}with(e,i=this.character){if(e===null||i===null){throw $e()}let n;if(typeof e==="undefined"){n=this.line}else if(typeof e==="number"){n=e}else{n=typeof e.line==="number"?e.line:this.line;i=typeof e.character==="number"?e.character:this.character}if(n===this.line&&i===this.character){return this}return new To(n,i)}toJSON(){return{line:this.line,character:this.character}}[Symbol.for("debug.description")](){return`(${this.line}:${this.character})`}};Ve=To=z([me],Ve);let Oe=Js=class IM{static isRange(e){if(e instanceof Js){return true}if(!e){return false}return Ve.isPosition(e.start)&&Ve.isPosition(e.end)}static of(e){if(e instanceof Js){return e}if(this.isRange(e)){return new Js(e.start,e.end)}throw new Error("Invalid argument, is NOT a range-like object")}get start(){return this._start}get end(){return this._end}constructor(e,i,n,s){let r;let o;if(typeof e==="number"&&typeof i==="number"&&typeof n==="number"&&typeof s==="number"){r=new Ve(e,i);o=new Ve(n,s)}else if(Ve.isPosition(e)&&Ve.isPosition(i)){r=Ve.of(e);o=Ve.of(i)}if(!r||!o){throw new Error("Invalid arguments")}if(r.isBefore(o)){this._start=r;this._end=o}else{this._start=o;this._end=r}}contains(e){if(Js.isRange(e)){return this.contains(e.start)&&this.contains(e.end)}else if(Ve.isPosition(e)){if(Ve.of(e).isBefore(this._start)){return false}if(this._end.isBefore(e)){return false}return true}return false}isEqual(e){return this._start.isEqual(e._start)&&this._end.isEqual(e._end)}intersection(e){const i=Ve.Max(e.start,this._start);const n=Ve.Min(e.end,this._end);if(i.isAfter(n)){return void 0}return new Js(i,n)}union(e){if(this.contains(e)){return this}else if(e.contains(this)){return e}const i=Ve.Min(e.start,this._start);const n=Ve.Max(e.end,this.end);return new Js(i,n)}get isEmpty(){return this._start.isEqual(this._end)}get isSingleLine(){return this._start.line===this._end.line}with(e,i=this.end){if(e===null||i===null){throw $e()}let n;if(!e){n=this.start}else if(Ve.isPosition(e)){n=e}else{n=e.start||this.start;i=e.end||this.end}if(n.isEqual(this._start)&&i.isEqual(this.end)){return this}return new Js(n,i)}toJSON(){return[this.start,this.end]}[Symbol.for("debug.description")](){return O4(this)}};Oe=Js=z([me],Oe);let Dr=G_=class CM extends Oe{static isSelection(e){if(e instanceof G_){return true}if(!e){return false}return Oe.isRange(e)&&Ve.isPosition(e.anchor)&&Ve.isPosition(e.active)&&typeof e.isReversed==="boolean"}get anchor(){return this._anchor}get active(){return this._active}constructor(e,i,n,s){let r;let o;if(typeof e==="number"&&typeof i==="number"&&typeof n==="number"&&typeof s==="number"){r=new Ve(e,i);o=new Ve(n,s)}else if(Ve.isPosition(e)&&Ve.isPosition(i)){r=Ve.of(e);o=Ve.of(i)}if(!r||!o){throw new Error("Invalid arguments")}super(r,o);this._anchor=r;this._active=o}get isReversed(){return this._anchor===this._end}toJSON(){return{start:this.start,end:this.end,active:this.active,anchor:this.anchor}}[Symbol.for("debug.description")](){return i3(this)}};Dr=G_=z([me],Dr);function O4(t){return t.isEmpty?`[${t.start.line}:${t.start.character})`:`[${t.start.line}:${t.start.character} -> ${t.end.line}:${t.end.character})`}function i3(t){let e=O4(t);if(!t.isEmpty){if(t.active.isEqual(t.start)){e=`|${e}`}else{e=`${e}|`}}return e}const F4=t=>{if(typeof t!=="string"||t.length===0||!/^[0-9A-Za-z_\-]+$/.test(t)){throw $e("connectionToken")}};class n3{static isResolvedAuthority(e){return e&&typeof e==="object"&&typeof e.host==="string"&&typeof e.port==="number"&&(e.connectionToken===void 0||typeof e.connectionToken==="string")}constructor(e,i,n){if(typeof e!=="string"||e.length===0){throw $e("host")}if(typeof i!=="number"||i===0||Math.round(i)!==i){throw $e("port")}if(typeof n!=="undefined"){F4(n)}this.host=e;this.port=Math.round(i);this.connectionToken=n}}class uf{static isManagedResolvedAuthority(e){return e&&typeof e==="object"&&typeof e.makeConnection==="function"&&(e.connectionToken===void 0||typeof e.connectionToken==="string")}constructor(e,i){this.makeConnection=e;this.connectionToken=i;if(typeof i!=="undefined"){F4(i)}}}class bs extends Error{static NotAvailable(e,i){return new bs(e,pr.NotAvailable,i)}static TemporarilyNotAvailable(e){return new bs(e,pr.TemporarilyNotAvailable)}constructor(e,i=pr.Unknown,n){super(e);this._message=e;this._code=i;this._detail=n;Object.setPrototypeOf(this,bs.prototype)}}var ss;(function(t){t[t["LF"]=1]="LF";t[t["CRLF"]=2]="CRLF"})(ss||(ss={}));var kl;(function(t){t[t["Replace"]=1]="Replace";t[t["Append"]=2]="Append";t[t["Prepend"]=3]="Prepend"})(kl||(kl={}));let go=Po=class TM{static isTextEdit(e){if(e instanceof Po){return true}if(!e){return false}return Oe.isRange(e)&&typeof e.newText==="string"}static replace(e,i){return new Po(e,i)}static insert(e,i){return Po.replace(new Oe(e,e),i)}static delete(e){return Po.replace(e,"")}static setEndOfLine(e){const i=new Po(new Oe(new Ve(0,0),new Ve(0,0)),"");i.newEol=e;return i}get range(){return this._range}set range(e){if(e&&!Oe.isRange(e)){throw $e("range")}this._range=e}get newText(){return this._newText||""}set newText(e){if(e&&typeof e!=="string"){throw $e("newText")}this._newText=e}get newEol(){return this._newEol}set newEol(e){if(e&&typeof e!=="number"){throw $e("newEol")}this._newEol=e}constructor(e,i){this._range=e;this._newText=i}toJSON(){return{range:this.range,newText:this.newText,newEol:this._newEol}}};go=Po=z([me],go);let Pp=$r=class PM{static isNotebookCellEdit(e){if(e instanceof $r){return true}if(!e){return false}return gr.isNotebookRange(e)&&Array.isArray(e.newCells)}static replaceCells(e,i){return new $r(e,i)}static insertCells(e,i){return new $r(new gr(e,e),i)}static deleteCells(e){return new $r(e,[])}static updateCellMetadata(e,i){const n=new $r(new gr(e,e),[]);n.newCellMetadata=i;return n}static updateNotebookMetadata(e){const i=new $r(new gr(0,0),[]);i.newNotebookMetadata=e;return i}constructor(e,i){this.range=e;this.newCells=i}};Pp=$r=z([me],Pp);class ca{static isSnippetTextEdit(e){if(e instanceof ca){return true}if(!e){return false}return Oe.isRange(e.range)&&ka.isSnippetString(e.snippet)}static replace(e,i){return new ca(e,i)}static insert(e,i){return ca.replace(new Oe(e,e),i)}constructor(e,i){this.range=e;this.snippet=i}}var Ut;(function(t){t[t["File"]=1]="File";t[t["Text"]=2]="Text";t[t["Cell"]=3]="Cell";t[t["CellReplace"]=5]="CellReplace";t[t["Snippet"]=6]="Snippet"})(Ut||(Ut={}));let Da=class AM{constructor(){this._edits=[]}_allEntries(){return this._edits}renameFile(e,i,n,s){this._edits.push({_type:Ut.File,from:e,to:i,options:n,metadata:s})}createFile(e,i,n){this._edits.push({_type:Ut.File,from:void 0,to:e,options:i,metadata:n})}deleteFile(e,i,n){this._edits.push({_type:Ut.File,from:e,to:void 0,options:i,metadata:n})}replaceNotebookMetadata(e,i,n){this._edits.push({_type:Ut.Cell,metadata:n,uri:e,edit:{editType:uo.DocumentMetadata,metadata:i}})}replaceNotebookCells(e,i,n,s){const r=i.start;const o=i.end;if(r!==o||n.length>0){this._edits.push({_type:Ut.CellReplace,uri:e,index:r,count:o-r,cells:n,metadata:s})}}replaceNotebookCellMetadata(e,i,n,s){this._edits.push({_type:Ut.Cell,metadata:s,uri:e,edit:{editType:uo.Metadata,index:i,metadata:n}})}replace(e,i,n,s){this._edits.push({_type:Ut.Text,uri:e,edit:new go(i,n),metadata:s})}insert(e,i,n,s){this.replace(e,new Oe(i,i),n,s)}delete(e,i,n){this.replace(e,i,"",n)}has(e){return this._edits.some(i=>i._type===Ut.Text&&i.uri.toString()===e.toString())}set(e,i){if(!i){for(let n=0;n<this._edits.length;n++){const s=this._edits[n];switch(s._type){case Ut.Text:case Ut.Snippet:case Ut.Cell:case Ut.CellReplace:if(s.uri.toString()===e.toString()){this._edits[n]=void 0}break}}D5(this._edits)}else{for(const n of i){if(!n){continue}let s;let r;if(Array.isArray(n)){s=n[0];r=n[1]}else{s=n}if(Pp.isNotebookCellEdit(s)){if(s.newCellMetadata){this.replaceNotebookCellMetadata(e,s.range.start,s.newCellMetadata,r)}else if(s.newNotebookMetadata){this.replaceNotebookMetadata(e,s.newNotebookMetadata,r)}else{this.replaceNotebookCells(e,s.range,s.newCells,r)}}else if(ca.isSnippetTextEdit(s)){this._edits.push({_type:Ut.Snippet,uri:e,range:s.range,edit:s.snippet,metadata:r,keepWhitespace:s.keepWhitespace})}else{this._edits.push({_type:Ut.Text,uri:e,edit:s,metadata:r})}}}}get(e){const i=[];for(const n of this._edits){if(n._type===Ut.Text&&n.uri.toString()===e.toString()){i.push(n.edit)}}return i}entries(){const e=new Ft;for(const i of this._edits){if(i._type===Ut.Text){let n=e.get(i.uri);if(!n){n=[i.uri,[]];e.set(i.uri,n)}n[1].push(i.edit)}}return[...e.values()]}get size(){return this.entries().length}toJSON(){return this.entries()}};Da=z([me],Da);let ka=Ao=class RM{static isSnippetString(e){if(e instanceof Ao){return true}if(!e){return false}return typeof e.value==="string"}static _escape(e){return e.replace(/\$|}|\\/g,"\\$&")}constructor(e){this._tabstop=1;this.value=e||""}appendText(e){this.value+=Ao._escape(e);return this}appendTabstop(e=this._tabstop++){this.value+="$";this.value+=e;return this}appendPlaceholder(e,i=this._tabstop++){if(typeof e==="function"){const n=new Ao;n._tabstop=this._tabstop;e(n);this._tabstop=n._tabstop;e=n.value}else{e=Ao._escape(e)}this.value+="${";this.value+=i;this.value+=":";this.value+=e;this.value+="}";return this}appendChoice(e,i=this._tabstop++){const n=e.map(s=>s.replaceAll(/[|\\,]/g,"\\$&")).join(",");this.value+="${";this.value+=i;this.value+="|";this.value+=n;this.value+="|}";return this}appendVariable(e,i){if(typeof i==="function"){const n=new Ao;n._tabstop=this._tabstop;i(n);this._tabstop=n._tabstop;i=n.value}else if(typeof i==="string"){i=i.replace(/\$|}/g,"\\$&")}this.value+="${";this.value+=e;if(i){this.value+=":";this.value+=i}this.value+="}";return this}};ka=Ao=z([me],ka);var Go;(function(t){t[t["Unnecessary"]=1]="Unnecessary";t[t["Deprecated"]=2]="Deprecated"})(Go||(Go={}));var Di;(function(t){t[t["Hint"]=3]="Hint";t[t["Information"]=2]="Information";t[t["Warning"]=1]="Warning";t[t["Error"]=0]="Error"})(Di||(Di={}));let kn=K_=class LM{static isLocation(e){if(e instanceof K_){return true}if(!e){return false}return Oe.isRange(e.range)&&b.isUri(e.uri)}constructor(e,i){this.uri=e;if(!i);else if(Oe.isRange(i)){this.range=Oe.of(i)}else if(Ve.isPosition(i)){this.range=new Oe(i,i)}else{throw new Error("Illegal argument")}}toJSON(){return{uri:this.uri,range:this.range}}};kn=K_=z([me],kn);let rd=class NM{static is(e){if(!e){return false}return typeof e.message==="string"&&e.location&&Oe.isRange(e.location.range)&&b.isUri(e.location.uri)}constructor(e,i){this.location=e;this.message=i}static isEqual(e,i){if(e===i){return true}if(!e||!i){return false}return e.message===i.message&&e.location.range.isEqual(i.location.range)&&e.location.uri.toString()===i.location.uri.toString()}};rd=z([me],rd);let Ap=class OM{constructor(e,i,n=Di.Error){if(!Oe.isRange(e)){throw new TypeError("range must be set")}if(!i){throw new TypeError("message must be set")}this.range=e;this.message=i;this.severity=n}toJSON(){return{severity:Di[this.severity],message:this.message,range:this.range,source:this.source,code:this.code}}static isEqual(e,i){if(e===i){return true}if(!e||!i){return false}return e.message===i.message&&e.severity===i.severity&&e.code===i.code&&e.severity===i.severity&&e.source===i.source&&e.range.isEqual(i.range)&&Is(e.tags,i.tags)&&Is(e.relatedInformation,i.relatedInformation,rd.isEqual)}};Ap=z([me],Ap);let Rp=class FM{constructor(e,i){if(!e){throw new Error("Illegal argument, contents must be defined")}if(Array.isArray(e)){this.contents=e}else{this.contents=[e]}this.range=i}};Rp=z([me],Rp);let Lp=class MM extends Rp{constructor(e,i,n,s){super(e,i);this.canIncreaseVerbosity=n;this.canDecreaseVerbosity=s}};Lp=z([me],Lp);var ev;(function(t){t[t["Increase"]=0]="Increase";t[t["Decrease"]=1]="Decrease"})(ev||(ev={}));var od;(function(t){t[t["Text"]=0]="Text";t[t["Read"]=1]="Read";t[t["Write"]=2]="Write"})(od||(od={}));let Np=class UM{constructor(e,i=od.Text){this.range=e;this.kind=i}toJSON(){return{range:this.range,kind:od[this.kind]}}};Np=z([me],Np);let Op=class $M{constructor(e,i){this.uri=e;this.highlights=i}toJSON(){return{uri:this.uri,highlights:this.highlights.map(e=>e.toJSON())}}};Op=z([me],Op);var gt;(function(t){t[t["File"]=0]="File";t[t["Module"]=1]="Module";t[t["Namespace"]=2]="Namespace";t[t["Package"]=3]="Package";t[t["Class"]=4]="Class";t[t["Method"]=5]="Method";t[t["Property"]=6]="Property";t[t["Field"]=7]="Field";t[t["Constructor"]=8]="Constructor";t[t["Enum"]=9]="Enum";t[t["Interface"]=10]="Interface";t[t["Function"]=11]="Function";t[t["Variable"]=12]="Variable";t[t["Constant"]=13]="Constant";t[t["String"]=14]="String";t[t["Number"]=15]="Number";t[t["Boolean"]=16]="Boolean";t[t["Array"]=17]="Array";t[t["Object"]=18]="Object";t[t["Key"]=19]="Key";t[t["Null"]=20]="Null";t[t["EnumMember"]=21]="EnumMember";t[t["Struct"]=22]="Struct";t[t["Event"]=23]="Event";t[t["Operator"]=24]="Operator";t[t["TypeParameter"]=25]="TypeParameter"})(gt||(gt={}));var ad;(function(t){t[t["Deprecated"]=1]="Deprecated"})(ad||(ad={}));let ld=Q_=class HM{static validate(e){if(!e.name){throw new Error("name must not be falsy")}}constructor(e,i,n,s,r){this.name=e;this.kind=i;this.containerName=r;if(typeof n==="string"){this.containerName=n}if(s instanceof kn){this.location=s}else if(n instanceof Oe){this.location=new kn(s,n)}Q_.validate(this)}toJSON(){return{name:this.name,kind:gt[this.kind],location:this.location,containerName:this.containerName}}};ld=Q_=z([me],ld);let cd=cf=class BM{static validate(e){if(!e.name){throw new Error("name must not be falsy")}if(!e.range.contains(e.selectionRange)){throw new Error("selectionRange must be contained in fullRange")}e.children?.forEach(cf.validate)}constructor(e,i,n,s,r){this.name=e;this.detail=i;this.kind=n;this.range=s;this.selectionRange=r;this.children=[];cf.validate(this)}};cd=cf=z([me],cd);var ud;(function(t){t[t["Invoke"]=1]="Invoke";t[t["Automatic"]=2]="Automatic"})(ud||(ud={}));let dd=class VM{constructor(e,i){this.title=e;this.kind=i}};dd=z([me],dd);let Pt=class WM{static{ou=this}static{this.sep="."}constructor(e){this.value=e}append(e){return new ou(this.value?this.value+ou.sep+e:e)}intersects(e){return this.contains(e)||e.contains(this)}contains(e){return this.value===e.value||e.value.startsWith(this.value+ou.sep)}};Pt=ou=z([me],Pt);Pt.Empty=new Pt("");Pt.QuickFix=Pt.Empty.append("quickfix");Pt.Refactor=Pt.Empty.append("refactor");Pt.RefactorExtract=Pt.Refactor.append("extract");Pt.RefactorInline=Pt.Refactor.append("inline");Pt.RefactorMove=Pt.Refactor.append("move");Pt.RefactorRewrite=Pt.Refactor.append("rewrite");Pt.Source=Pt.Empty.append("source");Pt.SourceOrganizeImports=Pt.Source.append("organizeImports");Pt.SourceFixAll=Pt.Source.append("fixAll");Pt.Notebook=Pt.Empty.append("notebook");let hd=class zM{constructor(e,i){this.range=e;this.parent=i;if(i&&!i.range.contains(this.range)){throw new Error("Invalid argument: parent must contain this range")}}};hd=z([me],hd);let Z0=class qM{constructor(e,i,n,s,r,o){this.kind=e;this.name=i;this.detail=n;this.uri=s;this.range=r;this.selectionRange=o}};let M4=class jM{constructor(e,i){this.fromRanges=i;this.from=e}};let U4=class GM{constructor(e,i){this.fromRanges=i;this.to=e}};var Il;(function(t){t[t["Information"]=0]="Information";t[t["Warning"]=1]="Warning";t[t["Error"]=2]="Error"})(Il||(Il={}));let Fp=class KM{constructor(e,i){this.range=e;this.command=i}get isResolved(){return!!this.command}};Fp=z([me],Fp);let cn=J_=class QM{#e;static isMarkdownString(e){if(e instanceof J_){return true}return e&&e.appendCodeblock&&e.appendMarkdown&&e.appendText&&e.value!==void 0}constructor(e,i=false){this.#e=new Xl(e,{supportThemeIcons:i})}get value(){return this.#e.value}set value(e){this.#e.value=e}get isTrusted(){return this.#e.isTrusted}set isTrusted(e){this.#e.isTrusted=e}get supportThemeIcons(){return this.#e.supportThemeIcons}set supportThemeIcons(e){this.#e.supportThemeIcons=e}get supportHtml(){return this.#e.supportHtml}set supportHtml(e){this.#e.supportHtml=e}get baseUri(){return this.#e.baseUri}set baseUri(e){this.#e.baseUri=e}appendText(e){this.#e.appendText(e);return this}appendMarkdown(e){this.#e.appendMarkdown(e);return this}appendCodeblock(e,i){this.#e.appendCodeblock(i??"",e);return this}};cn=J_=z([me],cn);let tv=class JM{constructor(e,i){this.label=e;this.documentation=i}};tv=z([me],tv);let iv=class XM{constructor(e,i){this.label=e;this.documentation=i;this.parameters=[]}};iv=z([me],iv);let nv=class YM{constructor(){this.activeSignature=0;this.activeParameter=0;this.signatures=[]}};nv=z([me],nv);var sv;(function(t){t[t["Invoke"]=1]="Invoke";t[t["TriggerCharacter"]=2]="TriggerCharacter";t[t["ContentChange"]=3]="ContentChange"})(sv||(sv={}));var rv;(function(t){t[t["Type"]=1]="Type";t[t["Parameter"]=2]="Parameter"})(rv||(rv={}));let Mp=class ZM{constructor(e){this.value=e}};Mp=z([me],Mp);let Up=class eU{constructor(e,i,n){this.position=e;this.label=i;this.kind=n}};Up=z([me],Up);var Cl;(function(t){t[t["Invoke"]=0]="Invoke";t[t["TriggerCharacter"]=1]="TriggerCharacter";t[t["TriggerForIncompleteCompletions"]=2]="TriggerForIncompleteCompletions"})(Cl||(Cl={}));var ke;(function(t){t[t["Text"]=0]="Text";t[t["Method"]=1]="Method";t[t["Function"]=2]="Function";t[t["Constructor"]=3]="Constructor";t[t["Field"]=4]="Field";t[t["Variable"]=5]="Variable";t[t["Class"]=6]="Class";t[t["Interface"]=7]="Interface";t[t["Module"]=8]="Module";t[t["Property"]=9]="Property";t[t["Unit"]=10]="Unit";t[t["Value"]=11]="Value";t[t["Enum"]=12]="Enum";t[t["Keyword"]=13]="Keyword";t[t["Snippet"]=14]="Snippet";t[t["Color"]=15]="Color";t[t["File"]=16]="File";t[t["Reference"]=17]="Reference";t[t["Folder"]=18]="Folder";t[t["EnumMember"]=19]="EnumMember";t[t["Constant"]=20]="Constant";t[t["Struct"]=21]="Struct";t[t["Event"]=22]="Event";t[t["Operator"]=23]="Operator";t[t["TypeParameter"]=24]="TypeParameter";t[t["User"]=25]="User";t[t["Issue"]=26]="Issue"})(ke||(ke={}));var fd;(function(t){t[t["Deprecated"]=1]="Deprecated"})(fd||(fd={}));let $p=class tU{constructor(e,i){this.label=e;this.kind=i}toJSON(){return{label:this.label,kind:this.kind&&ke[this.kind],detail:this.detail,documentation:this.documentation,sortText:this.sortText,filterText:this.filterText,preselect:this.preselect,insertText:this.insertText,textEdit:this.textEdit}}};$p=z([me],$p);let ec=class iU{constructor(e=[],i=false){this.items=e;this.isIncomplete=i}};ec=z([me],ec);let ov=class nU{constructor(e,i,n){this.insertText=e;this.range=i;this.command=n}};ov=z([me],ov);let av=class sU{constructor(e){this.commands=void 0;this.suppressSuggestions=void 0;this.items=e}};av=z([me],av);var Ko;(function(t){t[t["Unknown"]=0]="Unknown";t[t["Word"]=1]="Word";t[t["Line"]=2]="Line";t[t["Suggest"]=3]="Suggest"})(Ko||(Ko={}));var Tl;(function(t){t[t["Accepted"]=0]="Accepted";t[t["Rejected"]=1]="Rejected";t[t["Ignored"]=2]="Ignored"})(Tl||(Tl={}));var pd;(function(t){t[t["Active"]=-1]="Active";t[t["Beside"]=-2]="Beside";t[t["One"]=1]="One";t[t["Two"]=2]="Two";t[t["Three"]=3]="Three";t[t["Four"]=4]="Four";t[t["Five"]=5]="Five";t[t["Six"]=6]="Six";t[t["Seven"]=7]="Seven";t[t["Eight"]=8]="Eight";t[t["Nine"]=9]="Nine"})(pd||(pd={}));var no;(function(t){t[t["Left"]=1]="Left";t[t["Right"]=2]="Right"})(no||(no={}));function s3(t,e){return`${Ze.toKey(t)}.${e}`}var Qn;(function(t){t[t["Off"]=0]="Off";t[t["On"]=1]="On";t[t["Relative"]=2]="Relative";t[t["Interval"]=3]="Interval"})(Qn||(Qn={}));var Pl;(function(t){t[t["Manual"]=1]="Manual";t[t["AfterDelay"]=2]="AfterDelay";t[t["FocusOut"]=3]="FocusOut"})(Pl||(Pl={}));var Hp;(function(t){t[t["Default"]=0]="Default";t[t["InCenter"]=1]="InCenter";t[t["InCenterIfOutsideViewport"]=2]="InCenterIfOutsideViewport";t[t["AtTop"]=3]="AtTop"})(Hp||(Hp={}));var tc;(function(t){t[t["Keyboard"]=1]="Keyboard";t[t["Mouse"]=2]="Mouse";t[t["Command"]=3]="Command"})(tc||(tc={}));var Al;(function(t){t[t["Addition"]=1]="Addition";t[t["Deletion"]=2]="Deletion";t[t["Modification"]=3]="Modification"})(Al||(Al={}));var gd;(function(t){t[t["Undo"]=1]="Undo";t[t["Redo"]=2]="Redo"})(gd||(gd={}));var Qo;(function(t){t[t["OpenOpen"]=0]="OpenOpen";t[t["ClosedClosed"]=1]="ClosedClosed";t[t["OpenClosed"]=2]="OpenClosed";t[t["ClosedOpen"]=3]="ClosedOpen"})(Qo||(Qo={}));(function(t){function e(i){switch(i){case"keyboard":return t.Keyboard;case"mouse":return t.Mouse;case Pu.PROGRAMMATIC:case Pu.JUMP:case Pu.NAVIGATION:return t.Command}return void 0}t.fromValue=e})(tc||(tc={}));var ic;(function(t){t[t["Other"]=0]="Other";t[t["Comment"]=1]="Comment";t[t["String"]=2]="String";t[t["RegEx"]=3]="RegEx"})(ic||(ic={}));(function(t){function e(i){switch(i){case t.Other:return"other";case t.Comment:return"comment";case t.String:return"string";case t.RegEx:return"regex"}return"other"}t.toString=e})(ic||(ic={}));let Bp=class rU{constructor(e,i){if(i&&!b.isUri(i)){throw $e("target")}if(!Oe.isRange(e)||e.isEmpty){throw $e("range")}this.range=e;this.target=i}};Bp=z([me],Bp);let nc=class oU{constructor(e,i,n,s){this.red=e;this.green=i;this.blue=n;this.alpha=s}};nc=z([me],nc);let Vp=class aU{constructor(e,i){if(i&&!(i instanceof nc)){throw $e("color")}if(!Oe.isRange(e)||e.isEmpty){throw $e("range")}this.range=e;this.color=i}};Vp=z([me],Vp);let Wp=class lU{constructor(e){if(!e||typeof e!=="string"){throw $e("label")}this.label=e}};Wp=z([me],Wp);var sS;(function(t){t[t["RGB"]=0]="RGB";t[t["HEX"]=1]="HEX";t[t["HSL"]=2]="HSL"})(sS||(sS={}));var lv;(function(t){t[t["Error"]=0]="Error";t[t["Warning"]=1]="Warning";t[t["Information"]=2]="Information"})(lv||(lv={}));var cv;(function(t){t[t["Unknown"]=0]="Unknown";t[t["Shutdown"]=1]="Shutdown";t[t["Process"]=2]="Process";t[t["User"]=3]="User";t[t["Extension"]=4]="Extension"})(cv||(cv={}));var md;(function(t){t[t["Low"]=0]="Low";t[t["Medium"]=1]="Medium";t[t["High"]=2]="High"})(md||(md={}));var uv;(function(t){t[t["Sh"]=1]="Sh";t[t["Bash"]=2]="Bash";t[t["Fish"]=3]="Fish";t[t["Csh"]=4]="Csh";t[t["Ksh"]=5]="Ksh";t[t["Zsh"]=6]="Zsh";t[t["CommandPrompt"]=7]="CommandPrompt";t[t["GitBash"]=8]="GitBash";t[t["PowerShell"]=9]="PowerShell";t[t["Python"]=10]="Python";t[t["Julia"]=11]="Julia";t[t["NuShell"]=12]="NuShell";t[t["Node"]=13]="Node"})(uv||(uv={}));class r3{constructor(e,i,n){this.startIndex=e;this.length=i;this.tooltip=n;if(typeof e!=="number"||e<0){throw $e("startIndex")}if(typeof i!=="number"||i<1){throw $e("length")}if(n!==void 0&&typeof n!=="string"){throw $e("tooltip")}}}class o3{constructor(e){this.uri=e}}class a3{constructor(e){this.terminalCommand=e}}var dv;(function(t){t[t["Panel"]=1]="Panel";t[t["Editor"]=2]="Editor"})(dv||(dv={}));class l3{constructor(e){this.options=e;if(typeof e!=="object"){throw $e("options")}}}var hv;(function(t){t[t["File"]=0]="File";t[t["Folder"]=1]="Folder";t[t["Method"]=2]="Method";t[t["Alias"]=3]="Alias";t[t["Argument"]=4]="Argument";t[t["Option"]=5]="Option";t[t["OptionValue"]=6]="OptionValue";t[t["Flag"]=7]="Flag"})(hv||(hv={}));class c3{constructor(e,i,n,s,r,o,a,l,c){this.label=e;this.icon=i;this.detail=n;this.documentation=s;this.isFile=r;this.isDirectory=o;this.isKeyword=a;this.replacementIndex=l??0;this.replacementLength=c??0}}let u3=class cU{constructor(e,i){this.items=e??[];this.resourceRequestConfig=i}};var fv;(function(t){t[t["Always"]=1]="Always";t[t["Silent"]=2]="Silent";t[t["Never"]=3]="Never"})(fv||(fv={}));var pv;(function(t){t["Changed"]="changed";t["ProcessStarted"]="processStarted";t["ProcessEnded"]="processEnded";t["Terminated"]="terminated";t["Start"]="start";t["AcquiredInput"]="acquiredInput";t["DependsOnStarted"]="dependsOnStarted";t["Active"]="active";t["Inactive"]="inactive";t["End"]="end";t["ProblemMatcherStarted"]="problemMatcherStarted";t["ProblemMatcherEnded"]="problemMatcherEnded";t["ProblemMatcherFoundErrors"]="problemMatcherFoundErrors"})(pv||(pv={}));var gv;(function(t){t[t["Shared"]=1]="Shared";t[t["Dedicated"]=2]="Dedicated";t[t["New"]=3]="New"})(gv||(gv={}));let _d=class uU{static{fs=this}static{this.Clean=new fs("clean","Clean")}static{this.Build=new fs("build","Build")}static{this.Rebuild=new fs("rebuild","Rebuild")}static{this.Test=new fs("test","Test")}static from(e){switch(e){case"clean":return fs.Clean;case"build":return fs.Build;case"rebuild":return fs.Rebuild;case"test":return fs.Test;default:return void 0}}constructor(e,i){this.label=i;if(typeof e!=="string"){throw $e("name")}if(typeof i!=="string"){throw $e("name")}this._id=e}get id(){return this._id}};_d=fs=z([me],_d);function $4(t){let e="";for(let i=0;i<t.length;i++){e+=t[i].replace(/,/g,",,")+","}return e}let sc=class dU{constructor(e,i,n){if(typeof e!=="string"){throw $e("process")}this._args=[];this._process=e;if(i!==void 0){if(Array.isArray(i)){this._args=i;this._options=n}else{this._options=i}}}get process(){return this._process}set process(e){if(typeof e!=="string"){throw $e("process")}this._process=e}get args(){return this._args}set args(e){if(!Array.isArray(e)){e=[]}this._args=e}get options(){return this._options}set options(e){this._options=e}computeId(){const e=[];e.push("process");if(this._process!==void 0){e.push(this._process)}if(this._args&&this._args.length>0){for(const i of this._args){e.push(i)}}return $4(e)}};sc=z([me],sc);let Ia=class hU{constructor(e,i,n){this._args=[];if(Array.isArray(i)){if(!e){throw $e("command can't be undefined or null")}if(typeof e!=="string"&&typeof e.value!=="string"){throw $e("command")}this._command=e;if(i){this._args=i}this._options=n}else{if(typeof e!=="string"){throw $e("commandLine")}this._commandLine=e;this._options=i}}get commandLine(){return this._commandLine}set commandLine(e){if(typeof e!=="string"){throw $e("commandLine")}this._commandLine=e}get command(){return this._command?this._command:""}set command(e){if(typeof e!=="string"&&typeof e.value!=="string"){throw $e("command")}this._command=e}get args(){return this._args}set args(e){this._args=e||[]}get options(){return this._options}set options(e){this._options=e}computeId(){const e=[];e.push("shell");if(this._commandLine!==void 0){e.push(this._commandLine)}if(this._command!==void 0){e.push(typeof this._command==="string"?this._command:this._command.value)}if(this._args&&this._args.length>0){for(const i of this._args){e.push(typeof i==="string"?i:i.value)}}return $4(e)}};Ia=z([me],Ia);var mv;(function(t){t[t["Escape"]=1]="Escape";t[t["Strong"]=2]="Strong";t[t["Weak"]=3]="Weak"})(mv||(mv={}));var mo;(function(t){t[t["Global"]=1]="Global";t[t["Workspace"]=2]="Workspace"})(mo||(mo={}));class ey{constructor(e){this._callback=e}computeId(){return"customExecution"+vi()}set callback(e){this._callback=e}get callback(){return this._callback}}let zp=class fU{static{ps=this}static{this.ExtensionCallbackType="customExecution"}static{this.ProcessType="process"}static{this.ShellType="shell"}static{this.EmptyType="$empty"}constructor(e,i,n,s,r,o){this.__deprecated=false;this._definition=this.definition=e;let a;if(typeof i==="string"){this._name=this.name=i;this._source=this.source=n;this.execution=s;a=r;this.__deprecated=true}else if(i===mo.Global||i===mo.Workspace){this.target=i;this._name=this.name=n;this._source=this.source=s;this.execution=r;a=o}else{this.target=i;this._name=this.name=n;this._source=this.source=s;this.execution=r;a=o}if(typeof a==="string"){this._problemMatchers=[a];this._hasDefinedMatchers=true}else if(Array.isArray(a)){this._problemMatchers=a;this._hasDefinedMatchers=true}else{this._problemMatchers=[];this._hasDefinedMatchers=false}this._isBackground=false;this._presentationOptions=Object.create(null);this._runOptions=Object.create(null)}get _id(){return this.__id}set _id(e){this.__id=e}get _deprecated(){return this.__deprecated}clear(){if(this.__id===void 0){return}this.__id=void 0;this._scope=void 0;this.computeDefinitionBasedOnExecution()}computeDefinitionBasedOnExecution(){if(this._execution instanceof sc){this._definition={type:ps.ProcessType,id:this._execution.computeId()}}else if(this._execution instanceof Ia){this._definition={type:ps.ShellType,id:this._execution.computeId()}}else if(this._execution instanceof ey){this._definition={type:ps.ExtensionCallbackType,id:this._execution.computeId()}}else{this._definition={type:ps.EmptyType,id:vi()}}}get definition(){return this._definition}set definition(e){if(e===void 0||e===null){throw $e("Kind can't be undefined or null")}this.clear();this._definition=e}get scope(){return this._scope}set target(e){this.clear();this._scope=e}get name(){return this._name}set name(e){if(typeof e!=="string"){throw $e("name")}this.clear();this._name=e}get execution(){return this._execution}set execution(e){if(e===null){e=void 0}this.clear();this._execution=e;const i=this._definition.type;if(ps.EmptyType===i||ps.ProcessType===i||ps.ShellType===i||ps.ExtensionCallbackType===i){this.computeDefinitionBasedOnExecution()}}get problemMatchers(){return this._problemMatchers}set problemMatchers(e){if(!Array.isArray(e)){this.clear();this._problemMatchers=[];this._hasDefinedMatchers=false;return}else{this.clear();this._problemMatchers=e;this._hasDefinedMatchers=true}}get hasDefinedMatchers(){return this._hasDefinedMatchers}get isBackground(){return this._isBackground}set isBackground(e){if(e!==true&&e!==false){e=false}this.clear();this._isBackground=e}get source(){return this._source}set source(e){if(typeof e!=="string"||e.length===0){throw $e("source must be a string of length > 0")}this.clear();this._source=e}get group(){return this._group}set group(e){if(e===null){e=void 0}this.clear();this._group=e}get detail(){return this._detail}set detail(e){if(e===null){e=void 0}this._detail=e}get presentationOptions(){return this._presentationOptions}set presentationOptions(e){if(e===null||e===void 0){e=Object.create(null)}this.clear();this._presentationOptions=e}get runOptions(){return this._runOptions}set runOptions(e){if(e===null||e===void 0){e=Object.create(null)}this.clear();this._runOptions=e}};zp=ps=z([me],zp);var ua;(function(t){t[t["SourceControl"]=1]="SourceControl";t[t["Window"]=10]="Window";t[t["Notification"]=15]="Notification"})(ua||(ua={}));var _v;(function(t){function e(i){const n=i;if(!ia(n.value)){console.log("INVALID view badge, invalid value",n.value);return false}if(n.tooltip&&!tt(n.tooltip)){console.log("INVALID view badge, invalid tooltip",n.tooltip);return false}return true}t.isViewBadge=e})(_v||(_v={}));let qp=X_=class pU{static isTreeItem(e,i){const n=e;if(n.checkboxState!==void 0){const s=ia(n.checkboxState)?n.checkboxState:Yt(n.checkboxState)&&ia(n.checkboxState.state)?n.checkboxState.state:void 0;const r=!ia(n.checkboxState)&&Yt(n.checkboxState)?n.checkboxState.tooltip:void 0;if(s===void 0||s!==ys.Checked&&s!==ys.Unchecked||r!==void 0&&!tt(r)){console.log("INVALID tree item, invalid checkboxState",n.checkboxState);return false}}if(e instanceof X_){return true}if(n.label!==void 0&&!tt(n.label)&&!n.label?.label){console.log("INVALID tree item, invalid label",n.label);return false}if(n.id!==void 0&&!tt(n.id)){console.log("INVALID tree item, invalid id",n.id);return false}if(n.iconPath!==void 0&&!tt(n.iconPath)&&!b.isUri(n.iconPath)&&(!n.iconPath||!tt(n.iconPath.id))){const s=n.iconPath;if(!s||!tt(s.light)&&!b.isUri(s.light)&&!tt(s.dark)&&!b.isUri(s.dark)){console.log("INVALID tree item, invalid iconPath",n.iconPath);return false}}if(n.description!==void 0&&!tt(n.description)&&typeof n.description!=="boolean"){console.log("INVALID tree item, invalid description",n.description);return false}if(n.resourceUri!==void 0&&!b.isUri(n.resourceUri)){console.log("INVALID tree item, invalid resourceUri",n.resourceUri);return false}if(n.tooltip!==void 0&&!tt(n.tooltip)&&!(n.tooltip instanceof cn)){console.log("INVALID tree item, invalid tooltip",n.tooltip);return false}if(n.command!==void 0&&!n.command.command){console.log("INVALID tree item, invalid command",n.command);return false}if(n.collapsibleState!==void 0&&n.collapsibleState<da.None&&n.collapsibleState>da.Expanded){console.log("INVALID tree item, invalid collapsibleState",n.collapsibleState);return false}if(n.contextValue!==void 0&&!tt(n.contextValue)){console.log("INVALID tree item, invalid contextValue",n.contextValue);return false}if(n.accessibilityInformation!==void 0&&!n.accessibilityInformation?.label){console.log("INVALID tree item, invalid accessibilityInformation",n.accessibilityInformation);return false}return true}constructor(e,i=da.None){this.collapsibleState=i;if(b.isUri(e)){this.resourceUri=e}else{this.label=e}}};qp=X_=z([me],qp);var da;(function(t){t[t["None"]=0]="None";t[t["Collapsed"]=1]="Collapsed";t[t["Expanded"]=2]="Expanded"})(da||(da={}));var ys;(function(t){t[t["Unchecked"]=0]="Unchecked";t[t["Checked"]=1]="Checked"})(ys||(ys={}));let jp=class gU{async asString(){return typeof this.value==="string"?this.value:JSON.stringify(this.value)}asFile(){return void 0}constructor(e){this.value=e}};jp=z([me],jp);class Gp extends jp{}class d3 extends Gp{#e;constructor(e){super("");this.#e=e}asFile(){return this.#e}}class h3{constructor(e,i,n,s){this.name=e;this.uri=i;this._itemId=n;this._getData=s}data(){return this._getData()}}let rc=class mU{#e=new Map;constructor(e){for(const[i,n]of e??[]){const s=this.#e.get(this.#t(i));if(s){s.push(n)}else{this.#e.set(this.#t(i),[n])}}}get(e){return this.#e.get(this.#t(e))?.[0]}set(e,i){this.#e.set(this.#t(e),[i])}forEach(e,i){for(const[n,s]of this.#e){for(const r of s){e.call(i,r,n,this)}}}*[Symbol.iterator](){for(const[e,i]of this.#e){for(const n of i){yield[e,n]}}}#t(e){return e.toLowerCase()}};rc=z([me],rc);let vv=class _U{constructor(e,i,n){this.insertText=e;this.title=i;this.kind=n}};vv=z([me],vv);var wv;(function(t){t[t["Automatic"]=0]="Automatic";t[t["PasteAs"]=1]="PasteAs"})(wv||(wv={}));class Mn{static{this.sep="."}constructor(e){this.value=e}append(...e){return new Mn((this.value?[this.value,...e]:e).join(Mn.sep))}intersects(e){return this.contains(e)||e.contains(this)}contains(e){return this.value===e.value||e.value.startsWith(this.value+Mn.sep)}}Mn.Empty=new Mn("");Mn.Text=new Mn("text");Mn.TextUpdateImports=Mn.Text.append("updateImports");class f3{constructor(e,i,n){this.title=i;this.insertText=e;this.kind=n}}let Vi=class vU{constructor(e,i){this.id=e;this.color=i}static isThemeIcon(e){if(typeof e.id!=="string"){console.log("INVALID ThemeIcon, invalid id",e.id);return false}return true}};Vi=z([me],Vi);Vi.File=new Vi("file");Vi.Folder=new Vi("folder");let vd=class wU{constructor(e){this.id=e}};vd=z([me],vd);var Rl;(function(t){t[t["Global"]=1]="Global";t[t["Workspace"]=2]="Workspace";t[t["WorkspaceFolder"]=3]="WorkspaceFolder"})(Rl||(Rl={}));let Ll=class bU{get base(){return this._base}set base(e){this._base=e;this._baseUri=b.file(e)}get baseUri(){return this._baseUri}set baseUri(e){this._baseUri=e;this._base=e.fsPath}constructor(e,i){if(typeof e!=="string"){if(!e||!b.isUri(e)&&!b.isUri(e.uri)){throw $e("base")}}if(typeof i!=="string"){throw $e("pattern")}if(typeof e==="string"){this.baseUri=b.file(e)}else if(b.isUri(e)){this.baseUri=e}else{this.baseUri=e.uri}this.pattern=i}toJSON(){return{pattern:this.pattern,base:this.base,baseUri:this.baseUri.toJSON()}}};Ll=z([me],Ll);const H4=new WeakMap;function p3(t,e){H4.set(t,e)}let oc=class yU{constructor(e,i,n,s,r){this.enabled=typeof e==="boolean"?e:true;if(typeof i==="string"){this.condition=i}if(typeof n==="string"){this.hitCondition=n}if(typeof s==="string"){this.logMessage=s}if(typeof r==="string"){this.mode=r}}get id(){if(!this._id){this._id=H4.get(this)??vi()}return this._id}};oc=z([me],oc);let Jo=class xU extends oc{constructor(e,i,n,s,r,o){super(i,n,s,r,o);if(e===null){throw $e("location")}this.location=e}};Jo=z([me],Jo);let Xo=class EU extends oc{constructor(e,i,n,s,r,o){super(i,n,s,r,o);this.functionName=e}};Xo=z([me],Xo);let Kp=class SU extends oc{constructor(e,i,n,s,r,o,a,l){super(s,r,o,a,l);if(!i){throw $e("dataId")}this.label=e;this.dataId=i;this.canPersist=n}};Kp=z([me],Kp);let Qp=class DU{constructor(e,i,n){this.command=e;this.args=i||[];this.options=n}};Qp=z([me],Qp);let wd=class kU{constructor(e,i){this.port=e;this.host=i}};wd=z([me],wd);let Jp=class IU{constructor(e){this.path=e}};Jp=z([me],Jp);let bd=class CU{constructor(e){this.implementation=e}};bd=z([me],bd);class B4{constructor(e,i,n){this.session=e;this.threadId=i;this.frameId=n}}class V4{constructor(e,i){this.session=e;this.threadId=i}}let Xp=class TU{constructor(e,i){this.range=e;this.expression=i}};Xp=z([me],Xp);var yd;(function(t){t[t["Invoke"]=0]="Invoke";t[t["Automatic"]=1]="Automatic"})(yd||(yd={}));let Yp=class PU{constructor(e,i){this.range=e;this.text=i}};Yp=z([me],Yp);let Zp=class AU{constructor(e,i,n=true){this.range=e;this.variableName=i;this.caseSensitiveLookup=n}};Zp=z([me],Zp);let eg=class RU{constructor(e,i){this.range=e;this.expression=i}};eg=z([me],eg);let bv=class LU{constructor(e,i){this.frameId=e;this.stoppedLocation=i}};bv=z([me],bv);var yv;(function(t){t[t["AIGenerated"]=1]="AIGenerated"})(yv||(yv={}));var xd;(function(t){t[t["Invoke"]=0]="Invoke";t[t["Automatic"]=1]="Automatic"})(xd||(xd={}));class g3{constructor(e,i){this.newSymbolName=e;this.tags=i}}var Nl;(function(t){t[t["Changed"]=1]="Changed";t[t["Created"]=2]="Created";t[t["Deleted"]=3]="Deleted"})(Nl||(Nl={}));let si=Gi=class NU extends Error{static FileExists(e){return new Gi(e,Le.FileExists,Gi.FileExists)}static FileNotFound(e){return new Gi(e,Le.FileNotFound,Gi.FileNotFound)}static FileNotADirectory(e){return new Gi(e,Le.FileNotADirectory,Gi.FileNotADirectory)}static FileIsADirectory(e){return new Gi(e,Le.FileIsADirectory,Gi.FileIsADirectory)}static NoPermissions(e){return new Gi(e,Le.NoPermissions,Gi.NoPermissions)}static Unavailable(e){return new Gi(e,Le.Unavailable,Gi.Unavailable)}constructor(e,i=Le.Unknown,n){super(b.isUri(e)?e.toString(true):e);this.code=n?.name??"Unknown";TI(this,i);Object.setPrototypeOf(this,Gi.prototype);if(typeof Error.captureStackTrace==="function"&&typeof n==="function"){Error.captureStackTrace(this,n)}}};si=Gi=z([me],si);let xv=class OU{constructor(e,i,n){this.start=e;this.end=i;this.kind=n}};xv=z([me],xv);var rr;(function(t){t[t["Comment"]=1]="Comment";t[t["Imports"]=2]="Imports";t[t["Region"]=3]="Region"})(rr||(rr={}));var Ed;(function(t){t[t["Collapsed"]=0]="Collapsed";t[t["Expanded"]=1]="Expanded"})(Ed||(Ed={}));var Ev;(function(t){t[t["Editing"]=0]="Editing";t[t["Preview"]=1]="Preview"})(Ev||(Ev={}));var Sv;(function(t){t[t["Published"]=0]="Published";t[t["Draft"]=1]="Draft"})(Sv||(Sv={}));var Sd;(function(t){t[t["Unresolved"]=0]="Unresolved";t[t["Resolved"]=1]="Resolved"})(Sd||(Sd={}));var Dd;(function(t){t[t["Current"]=0]="Current";t[t["Outdated"]=1]="Outdated"})(Dd||(Dd={}));var kd;(function(t){t[t["Reply"]=1]="Reply";t[t["Comment"]=2]="Comment"})(kd||(kd={}));class Dv{constructor(e,i=[]){this.tokenTypes=e;this.tokenModifiers=i}}function m3(t){return typeof t==="undefined"||N5(t)}class ty{constructor(e){this._prevLine=0;this._prevChar=0;this._dataIsSortedAndDeltaEncoded=true;this._data=[];this._dataLen=0;this._tokenTypeStrToInt=new Map;this._tokenModifierStrToInt=new Map;this._hasLegend=false;if(e){this._hasLegend=true;for(let i=0,n=e.tokenTypes.length;i<n;i++){this._tokenTypeStrToInt.set(e.tokenTypes[i],i)}for(let i=0,n=e.tokenModifiers.length;i<n;i++){this._tokenModifierStrToInt.set(e.tokenModifiers[i],i)}}}push(e,i,n,s,r){if(typeof e==="number"&&typeof i==="number"&&typeof n==="number"&&typeof s==="number"&&(typeof r==="number"||typeof r==="undefined")){if(typeof r==="undefined"){r=0}return this._pushEncoded(e,i,n,s,r)}if(Oe.isRange(e)&&typeof i==="string"&&m3(n)){return this._push(e,i,n)}throw $e()}_push(e,i,n){if(!this._hasLegend){throw new Error("Legend must be provided in constructor")}if(e.start.line!==e.end.line){throw new Error("`range` cannot span multiple lines")}if(!this._tokenTypeStrToInt.has(i)){throw new Error("`tokenType` is not in the provided legend")}const s=e.start.line;const r=e.start.character;const o=e.end.character-e.start.character;const a=this._tokenTypeStrToInt.get(i);let l=0;if(n){for(const c of n){if(!this._tokenModifierStrToInt.has(c)){throw new Error("`tokenModifier` is not in the provided legend")}const u=this._tokenModifierStrToInt.get(c);l|=1<<u>>>0}}this._pushEncoded(s,r,o,a,l)}_pushEncoded(e,i,n,s,r){if(this._dataIsSortedAndDeltaEncoded&&(e<this._prevLine||e===this._prevLine&&i<this._prevChar)){this._dataIsSortedAndDeltaEncoded=false;const l=this._data.length/5|0;let c=0;let u=0;for(let d=0;d<l;d++){let p=this._data[5*d];let f=this._data[5*d+1];if(p===0){p=c;f+=u}else{p+=c}this._data[5*d]=p;this._data[5*d+1]=f;c=p;u=f}}let o=e;let a=i;if(this._dataIsSortedAndDeltaEncoded&&this._dataLen>0){o-=this._prevLine;if(o===0){a-=this._prevChar}}this._data[this._dataLen++]=o;this._data[this._dataLen++]=a;this._data[this._dataLen++]=n;this._data[this._dataLen++]=s;this._data[this._dataLen++]=r;this._prevLine=e;this._prevChar=i}static _sortAndDeltaEncode(e){const i=[];const n=e.length/5|0;for(let a=0;a<n;a++){i[a]=a}i.sort((a,l)=>{const c=e[5*a];const u=e[5*l];if(c===u){const d=e[5*a+1];const p=e[5*l+1];return d-p}return c-u});const s=new Uint32Array(e.length);let r=0;let o=0;for(let a=0;a<n;a++){const l=5*i[a];const c=e[l+0];const u=e[l+1];const d=e[l+2];const p=e[l+3];const f=e[l+4];const m=c-r;const v=m===0?u-o:u;const y=5*a;s[y+0]=m;s[y+1]=v;s[y+2]=d;s[y+3]=p;s[y+4]=f;r=c;o=u}return s}build(e){if(!this._dataIsSortedAndDeltaEncoded){return new ac(ty._sortAndDeltaEncode(this._data),e)}return new ac(new Uint32Array(this._data),e)}}class ac{constructor(e,i){this.resultId=i;this.data=e}}class W4{constructor(e,i,n){this.start=e;this.deleteCount=i;this.data=n}}class df{constructor(e,i){this.resultId=i;this.edits=e}}var tg;(function(t){t[t["Separate"]=0]="Separate";t[t["MergeWithParent"]=1]="MergeWithParent"})(tg||(tg={}));class _3{constructor(e){this.name=e}}var kv;(function(t){t[t["Title"]=1]="Title";t[t["Inline"]=2]="Inline"})(kv||(kv={}));let Id=class FU{static{this.Back={iconPath:new Vi("arrow-left")}}constructor(){}};Id=z([me],Id);var Cd;(function(t){t[t["Separator"]=-1]="Separator";t[t["Default"]=0]="Default"})(Cd||(Cd={}));var Ol;(function(t){t[t["Info"]=1]="Info";t[t["Warning"]=2]="Warning";t[t["Error"]=3]="Error"})(Ol||(Ol={}));var ha;(function(t){t[t["UI"]=1]="UI";t[t["Workspace"]=2]="Workspace"})(ha||(ha={}));class Iv{static validate(e){if(typeof e.badge==="string"){let i=gx(e.badge,0);if(i<e.badge.length){i+=gx(e.badge,i)}if(e.badge.length>i){throw new Error(`The 'badge'-property must be undefined or a short character`)}}else if(e.badge){if(!Vi.isThemeIcon(e.badge)){throw new Error(`The 'badge'-property is not a valid ThemeIcon`)}}if(!e.color&&!e.badge&&!e.tooltip){throw new Error(`The decoration is empty`)}return true}constructor(e,i,n){this.badge=e;this.tooltip=i;this.color=n}}let ig=class MU{constructor(e){this.kind=e}};ig=z([me],ig);var Yr;(function(t){t[t["Light"]=1]="Light";t[t["Dark"]=2]="Dark";t[t["HighContrast"]=3]="HighContrast";t[t["HighContrastLight"]=4]="HighContrastLight"})(Yr||(Yr={}));let gr=class Cv{static isNotebookRange(e){if(e instanceof Cv){return true}if(!e){return false}return typeof e.start==="number"&&typeof e.end==="number"}get start(){return this._start}get end(){return this._end}get isEmpty(){return this._start===this._end}constructor(e,i){if(e<0){throw $e("start must be positive")}if(i<0){throw $e("end must be positive")}if(e<=i){this._start=e;this._end=i}else{this._start=i;this._end=e}}with(e){let i=this._start;let n=this._end;if(e.start!==void 0){i=e.start}if(e.end!==void 0){n=e.end}if(i===this._start&&n===this._end){return this}return new Cv(i,n)}};let Pm=class Tv{static validate(e){if(typeof e.kind!=="number"){throw new Error("NotebookCellData MUST have 'kind' property")}if(typeof e.value!=="string"){throw new Error("NotebookCellData MUST have 'value' property")}if(typeof e.languageId!=="string"){throw new Error("NotebookCellData MUST have 'languageId' property")}}static isNotebookCellDataArray(e){return Array.isArray(e)&&e.every(i=>Tv.isNotebookCellData(i))}static isNotebookCellData(e){return true}constructor(e,i,n,s,r,o,a){this.kind=e;this.value=i;this.languageId=n;this.mime=s;this.outputs=r??[];this.metadata=o;this.executionSummary=a;Tv.validate(this)}};let z4=class UU{constructor(e){this.cells=e}};let q4=class Xs{static isNotebookCellOutputItem(e){if(e instanceof Xs){return true}if(!e){return false}return typeof e.mime==="string"&&e.data instanceof Uint8Array}static error(e){const i={name:e.name,message:e.message,stack:e.stack};return Xs.json(i,"application/vnd.code.notebook.error")}static stdout(e){return Xs.text(e,"application/vnd.code.notebook.stdout")}static stderr(e){return Xs.text(e,"application/vnd.code.notebook.stderr")}static bytes(e,i="application/octet-stream"){return new Xs(e,i)}static#e=new TextEncoder;static text(e,i=vr.text){const n=Xs.#e.encode(String(e));return new Xs(n,i)}static json(e,i="text/x-json"){const n=JSON.stringify(e,void 0,"	");return Xs.text(n,i)}constructor(e,i){this.data=e;this.mime=i;const n=JI(i,true);if(!n){throw new Error(`INVALID mime type: ${i}. Must be in the format "type/subtype[;optionalparameter]"`)}this.mime=n}};let ng=class Pv{static isNotebookCellOutput(e){if(e instanceof Pv){return true}if(!e||typeof e!=="object"){return false}return typeof e.id==="string"&&Array.isArray(e.items)}static ensureUniqueMimeTypes(e,i=false){const n=new Set;const s=new Set;for(let r=0;r<e.length;r++){const o=e[r];const a=JI(o.mime);if(!n.has(a)||_4(a)){n.add(a);continue}s.add(r);if(i){console.warn(`DUPLICATED mime type '${o.mime}' will be dropped`)}}if(s.size===0){return e}return e.filter((r,o)=>!s.has(o))}constructor(e,i,n){this.items=Pv.ensureUniqueMimeTypes(e,true);if(typeof i==="string"){this.id=i;this.metadata=n}else{this.id=vi();this.metadata=i??n}}};class v3{constructor(e,i,n){this.label=e;this.uri=i;this.position=n}}var Yo;(function(t){t[t["Markup"]=1]="Markup";t[t["Code"]=2]="Code"})(Yo||(Yo={}));var lc;(function(t){t[t["Idle"]=1]="Idle";t[t["Pending"]=2]="Pending";t[t["Executing"]=3]="Executing"})(lc||(lc={}));var sg;(function(t){t[t["Left"]=1]="Left";t[t["Right"]=2]="Right"})(sg||(sg={}));var rg;(function(t){t[t["Default"]=0]="Default";t[t["InCenter"]=1]="InCenter";t[t["InCenterIfOutsideViewport"]=2]="InCenterIfOutsideViewport";t[t["AtTop"]=3]="AtTop"})(rg||(rg={}));class w3{constructor(e,i){this.text=e;this.alignment=i}}var Av;(function(t){t[t["Default"]=1]="Default";t[t["Preferred"]=2]="Preferred"})(Av||(Av={}));var og;(function(t){t[t["Default"]=1]="Default";t[t["Preferred"]=2]="Preferred";t[t["Hidden"]=-1]="Hidden"})(og||(og={}));let j4=class $U{constructor(e,i=[]){this.uri=e;this.provides=Sn(i)}};let b3=class HU{constructor(e){this.label=e}};var Td;(function(t){t[t["Named"]=1]="Named";t[t["Indexed"]=2]="Indexed"})(Td||(Td={}));let Rv=class BU{constructor(e,i){this.label=e;this.timestamp=i}};Rv=z([me],Rv);var Fl;(function(t){t[t["Production"]=1]="Production";t[t["Development"]=2]="Development";t[t["Test"]=3]="Test"})(Fl||(Fl={}));var ag;(function(t){t[t["Node"]=1]="Node";t[t["Webworker"]=2]="Webworker"})(ag||(ag={}));var so;(function(t){t[t["Other"]=0]="Other";t[t["Comment"]=1]="Comment";t[t["String"]=2]="String";t[t["RegEx"]=3]="RegEx"})(so||(so={}));class y3{constructor(e,i){this.ranges=e;this.wordPattern=i}}class x3{constructor(e){this._autoForwardAction=e}get autoForwardAction(){return this._autoForwardAction}}var Lv;(function(t){t[t["Queued"]=1]="Queued";t[t["Running"]=2]="Running";t[t["Passed"]=3]="Passed";t[t["Failed"]=4]="Failed";t[t["Skipped"]=5]="Skipped";t[t["Errored"]=6]="Errored"})(Lv||(Lv={}));var Ml;(function(t){t[t["Run"]=1]="Run";t[t["Debug"]=2]="Debug";t[t["Coverage"]=3]="Coverage"})(Ml||(Ml={}));class G4{constructor(e,i,n){this.controllerId=e;this.profileId=i;this.kind=n}}let lg=class VU{constructor(e=void 0,i=void 0,n=void 0,s=false,r=true){this.include=e;this.exclude=i;this.profile=n;this.continuous=s;this.preserveFocus=r}};lg=z([me],lg);let cg=Y_=class WU{static diff(e,i,n){const s=new Y_(e);s.expectedOutput=i;s.actualOutput=n;return s}constructor(e){this.message=e}};cg=Y_=z([me],cg);let Pd=class zU{constructor(e){this.id=e}};Pd=z([me],Pd);class E3{constructor(e,i,n){this.label=e;this.uri=i;this.position=n}}class hf{constructor(e,i){this.covered=e;this.total=i;ff(this)}}function ff(t){if(!t){return}if(t.covered>t.total){throw new Error(`The total number of covered items (${t.covered}) cannot be greater than the total (${t.total})`)}if(t.total<0){throw new Error(`The number of covered items (${t.total}) cannot be negative`)}}class cc{static fromDetails(e,i){const n=new hf(0,0);const s=new hf(0,0);const r=new hf(0,0);for(const a of i){if("branches"in a){n.total+=1;n.covered+=a.executed?1:0;for(const l of a.branches){s.total+=1;s.covered+=l.executed?1:0}}else{r.total+=1;r.covered+=a.executed?1:0}}const o=new cc(e,n,s.total>0?s:void 0,r.total>0?r:void 0);o.detailedCoverage=i;return o}constructor(e,i,n,s,r=[]){this.uri=e;this.statementCoverage=i;this.branchCoverage=n;this.declarationCoverage=s;this.includesTests=r}}class K4{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,i,n=[]){this.executed=e;this.location=i;this.branches=n}}class Q4{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,i,n){this.executed=e;this.location=i;this.label=n}}class J4{get executionCount(){return+this.executed}set executionCount(e){this.executed=e}constructor(e,i,n){this.name=e;this.executed=i;this.location=n}}var Nv;(function(t){t[t["None"]=0]="None";t[t["Option"]=1]="Option";t[t["Default"]=2]="Default";t[t["Preferred"]=3]="Preferred"})(Nv||(Nv={}));var Ov;(function(t){t[t["Untrusted"]=0]="Untrusted";t[t["Trusted"]=1]="Trusted";t[t["Unspecified"]=2]="Unspecified"})(Ov||(Ov={}));var Fv;(function(t){t[t["Notify"]=1]="Notify";t[t["OpenBrowser"]=2]="OpenBrowser";t[t["OpenPreview"]=3]="OpenPreview";t[t["Silent"]=4]="Silent";t[t["Ignore"]=5]="Ignore";t[t["OpenBrowserOnce"]=6]="OpenBrowserOnce"})(Fv||(Fv={}));let iy=class qU{constructor(e,i,n,s,r,o){this.kind=e;this.name=i;this.detail=n;this.uri=s;this.range=r;this.selectionRange=o}};class ny{constructor(e){this.uri=e}}class ug{constructor(e,i){this.original=e;this.modified=i}}class X4{constructor(e,i,n,s){this.base=e;this.input1=i;this.input2=n;this.result=s}}class sy{constructor(e,i){this.uri=e;this.viewType=i}}class Y4{constructor(e){this.viewType=e}}class ry{constructor(e,i){this.uri=e;this.notebookType=i}}class oy{constructor(e,i,n){this.original=e;this.modified=i;this.notebookType=n}}class Z4{constructor(){}}class eC{constructor(e,i){this.uri=e;this.inputBoxUri=i}}class tC{constructor(){}}class iC{constructor(e){this.textDiffs=e}}var Mv;(function(t){t[t["Down"]=0]="Down";t[t["Up"]=1]="Up"})(Mv||(Mv={}));var Uv;(function(t){t[t["Action"]=1]="Action";t[t["Toolbar"]=2]="Toolbar"})(Uv||(Uv={}));var $v;(function(t){t[t["Short"]=1]="Short";t[t["Medium"]=2]="Medium";t[t["Full"]=3]="Full"})($v||($v={}));class S3{constructor(e,i,n){this.id=e;this.label=i;this.values=n}}var Zo;(function(t){t[t["Accepted"]=1]="Accepted";t[t["Rejected"]=2]="Rejected";t[t["Saved"]=3]="Saved"})(Zo||(Zo={}));var Hv;(function(t){t[t["Keep"]=1]="Keep";t[t["Undo"]=2]="Undo";t[t["UserModification"]=3]="UserModification"})(Hv||(Hv={}));var Bv;(function(t){t[t["Unhelpful"]=0]="Unhelpful";t[t["Helpful"]=1]="Helpful";t[t["Undone"]=2]="Undone";t[t["Accepted"]=3]="Accepted";t[t["Bug"]=4]="Bug"})(Bv||(Bv={}));var Ad;(function(t){t[t["Unhelpful"]=0]="Unhelpful";t[t["Helpful"]=1]="Helpful"})(Ad||(Ad={}));let Am=class jU{constructor(e){if(typeof e!=="string"&&e.isTrusted===true){throw new Error("The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.")}this.value=typeof e==="string"?new cn(e):e}};let Rd=class GU{constructor(e,i){if(typeof e!=="string"&&e.isTrusted===true){throw new Error("The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.")}this.value=typeof e==="string"?new cn(e):e;this.vulnerabilities=i}};let dg=class KU{constructor(e,i,n,s){this.title=e;this.message=i;this.data=n;this.buttons=s}};class Rm{constructor(e,i){this.value=e;this.baseUri=i}}let Ld=class QU{constructor(e,i){this.value=e;this.value2=e;this.title=i}};let ay=class JU{constructor(e){this.value=e}};class pf{constructor(e,i){this.value=e;this.task=i}}let Nd=class XU{constructor(e){if(typeof e!=="string"&&e.isTrusted===true){throw new Error("The boolean form of MarkdownString.isTrusted is NOT supported for chat participants.")}this.value=typeof e==="string"?new cn(e):e}};let Lm=class YU{constructor(e){this.value=e}};let fa=class ZU{constructor(e,i,n){this.value=e;this.iconPath=i;this.options=n}};let Nm=class e${constructor(e,i){this.value=e;this.isEdit=i}};let hg=class t${constructor(e,i,n){this.value=e;this.license=i;this.snippet=n}};let Om=class i${constructor(e,i){this.uri=e;this.range=i}};let ly=class n${constructor(e){this.extensions=e}};let Od=class s${constructor(e,i){this.uri=e;if(i===true){this.isDone=true;this.edits=[]}else{this.edits=Array.isArray(i)?i:[i]}}};let fg=class r${constructor(e,i){this.uri=e;if(i===true){this.isDone=true;this.edits=[]}else{this.edits=Array.isArray(i)?i:[i]}}};class Vv{constructor(e,i,n,s,r,o){this.prompt=e;this.command=i;this.references=n;this.participant=s;this.toolReferences=r;this.editedFileEvents=o}}class nC{constructor(e,i,n,s){this.response=e;this.result=i;this.participant=n;this.command=s}}var Jn;(function(t){t[t["Panel"]=1]="Panel";t[t["Terminal"]=2]="Terminal";t[t["Notebook"]=3]="Notebook";t[t["Editor"]=4]="Editor"})(Jn||(Jn={}));var Wv;(function(t){t[t["Complete"]=1]="Complete";t[t["Partial"]=2]="Partial";t[t["Omitted"]=3]="Omitted"})(Wv||(Wv={}));class sC{constructor(e,i,n){this.document=e;this.selection=i;this.wholeRange=n}}class rC{constructor(e){this.cell=e}}class oC{constructor(e,i,n){this.mimeType=e;this.data=i;this.reference=n}}class aC{constructor(e){this.diagnostics=e}}var on;(function(t){t[t["User"]=1]="User";t[t["Assistant"]=2]="Assistant";t[t["System"]=3]="System"})(on||(on={}));class pg{constructor(e,i,n){this.callId=e;this.content=i;this.isError=n??false}}class zv{constructor(e,i,n){this.callId=e;this.content=i;this.isError=n??false}}class D3{constructor(e,i,n){this.command=e;this.language=i;this.confirmationMessages=n}}var qv;(function(t){t[t["Info"]=0]="Info";t[t["Warning"]=1]="Warning";t[t["Error"]=2]="Error"})(qv||(qv={}));let lC=class jv{static User(e,i){return new jv(on.User,e,i)}static Assistant(e,i){return new jv(on.Assistant,e,i)}set content(e){if(typeof e==="string"){this._content=[new Ht(e)]}else{this._content=e}}get content(){return this._content}constructor(e,i,n){this._content=[];this.role=e;this.content=i;this.name=n}};let cC=class Gv{static User(e,i){return new Gv(on.User,e,i)}static Assistant(e,i){return new Gv(on.Assistant,e,i)}set content(e){if(typeof e==="string"){this._content=[new Ht(e)]}else{this._content=e}}get content(){return this._content}set content2(e){if(e){this.content=e.map(i=>{if(typeof i==="string"){return new Ht(i)}return i})}}get content2(){return this.content.map(e=>{if(e instanceof Ht){return e.value}return e})}constructor(e,i,n){this._content=[];this.role=e;this.content=i;this.name=n}};class Ca{constructor(e,i,n){this.callId=e;this.name=i;this.input=n}}class Ht{constructor(e){this.value=e}toJSON(){return{$mid:it.LanguageModelTextPart,value:this.value}}}class On{constructor(e,i){this.mimeType=i;this.data=e}static image(e,i){return new On(e,i)}static json(e){const i=JSON.stringify(e,void 0,"	");return new On(ue.fromString(i).buffer,"json")}static text(e){return new On(ue.fromString(e).buffer,"text/plain")}toJSON(){return{$mid:it.LanguageModelDataPart,mimeType:this.mimeType,data:this.data}}}var gg;(function(t){t["PNG"]="image/png";t["JPEG"]="image/jpeg";t["GIF"]="image/gif";t["WEBP"]="image/webp";t["BMP"]="image/bmp"})(gg||(gg={}));class Kv{constructor(e,i){this.kind=e;this.data=i}toJSON(){return{$mid:it.LanguageModelExtraDataPart,kind:this.kind,data:this.data}}}class Ms{constructor(e){this.value=e}toJSON(){return{$mid:it.LanguageModelPromptTsxPart,value:this.value}}}class pi extends Error{static#e="LanguageModelError";static NotFound(e){return new pi(e,pi.NotFound.name)}static NoPermissions(e){return new pi(e,pi.NoPermissions.name)}static Blocked(e){return new pi(e,pi.Blocked.name)}static tryDeserialize(e){if(e.name!==pi.#e){return void 0}return new pi(e.message,e.code,e.cause)}constructor(e,i,n){super(e,{cause:n});this.name=pi.#e;this.code=i??""}}let Fm=class o${constructor(e){this.content=e}toJSON(){return{$mid:it.LanguageModelToolResult,content:this.content}}};let uC=class a${constructor(e){this.content=e}toJSON(){return{$mid:it.LanguageModelToolResult,content:this.content}}};class k3 extends Fm{}var Qv;(function(t){t[t["Auto"]=1]="Auto";t[t["Required"]=2]="Required"})(Qv||(Qv={}));var Jv;(function(t){t[t["SymbolInformation"]=1]="SymbolInformation";t[t["CommandInformation"]=2]="CommandInformation";t[t["SearchInformation"]=3]="SearchInformation";t[t["SettingInformation"]=4]="SettingInformation"})(Jv||(Jv={}));var Xv;(function(t){t[t["EMBEDDED"]=1]="EMBEDDED";t[t["LLM_RANKED"]=2]="LLM_RANKED";t[t["CANCELED"]=3]="CANCELED"})(Xv||(Xv={}));var Yv;(function(t){t[t["Started"]=1]="Started";t[t["Recognizing"]=2]="Recognizing";t[t["Recognized"]=3]="Recognized";t[t["Stopped"]=4]="Stopped";t[t["Error"]=5]="Error"})(Yv||(Yv={}));var Zv;(function(t){t[t["Started"]=1]="Started";t[t["Stopped"]=2]="Stopped";t[t["Error"]=3]="Error"})(Zv||(Zv={}));var ew;(function(t){t[t["Recognized"]=1]="Recognized";t[t["Stopped"]=2]="Stopped"})(ew||(ew={}));class I3{constructor(e,i){this.text=e;this.range=i}}var Fd;(function(t){t[t["Invoke"]=0]="Invoke";t[t["Automatic"]=1]="Automatic"})(Fd||(Fd={}));class C3{constructor(e,i,n,s={},r){this.label=e;this.command=i;this.args=n;this.env=s;this.version=r}}class T3{constructor(e,i,n={},s){this.label=e;this.uri=i;this.headers=n;this.version=s}}var Br;(function(t){t[t["EMBEDDED"]=1]="EMBEDDED";t[t["LLM_RANKED"]=2]="LLM_RANKED";t[t["CANCELED"]=3]="CANCELED"})(Br||(Br={}));function P3(t,e){return Ze.toKey(t)+"/"+e}var rS;(function(t){t[t["WorkspaceFolder"]=0]="WorkspaceFolder";t[t["Workspace"]=100]="Workspace";t[t["User"]=200]="User";t[t["Extension"]=300]="Extension";t[t["Filesystem"]=400]="Filesystem";t[t["RemoteBoost"]=-50]="RemoteBoost"})(rS||(rS={}));var oS;(function(t){function e(i,n){return i.id===n.id&&i.remoteAuthority===n.remoteAuthority&&i.label===n.label&&i.isTrustedByDefault===n.isTrustedByDefault}t.equals=e})(oS||(oS={}));var aS;(function(t){function e(s){return s}t.toSerialized=e;function i(s){return{id:s.id,label:s.label,cacheNonce:s.cacheNonce,launch:Md.fromSerialized(s.launch),variableReplacement:s.variableReplacement?tw.fromSerialized(s.variableReplacement):void 0}}t.fromSerialized=i;function n(s,r){return s.id===r.id&&s.label===r.label&&Is(s.roots,r.roots,(o,a)=>o.toString()===a.toString())&&Xi(s.launch,r.launch)&&Xi(s.presentation,r.presentation)&&Xi(s.variableReplacement,r.variableReplacement)}t.equals=n})(aS||(aS={}));var tw;(function(t){function e(n){return n}t.toSerialized=e;function i(n){return{section:n.section,folder:n.folder?{...n.folder,uri:b.revive(n.folder.uri)}:void 0,target:n.target}}t.fromSerialized=i})(tw||(tw={}));var lS;(function(t){t[t["HasUnknown"]=0]="HasUnknown";t[t["LoadingUnknown"]=1]="LoadingUnknown";t[t["AllKnown"]=2]="AllKnown"})(lS||(lS={}));var cS;(function(t){t[t["Unknown"]=0]="Unknown";t[t["Cached"]=1]="Cached";t[t["Outdated"]=2]="Outdated";t[t["RefreshingFromUnknown"]=3]="RefreshingFromUnknown";t[t["RefreshingFromCached"]=4]="RefreshingFromCached";t[t["Live"]=5]="Live"})(cS||(cS={}));var Ta;(function(t){t[t["Stdio"]=1]="Stdio";t[t["HTTP"]=2]="HTTP"})(Ta||(Ta={}));var Md;(function(t){function e(n){return n}t.toSerialized=e;function i(n){switch(n.type){case Ta.HTTP:return{type:n.type,uri:b.revive(n.uri),headers:n.headers};case Ta.Stdio:return{type:n.type,cwd:n.cwd?b.revive(n.cwd):void 0,command:n.command,args:n.args,env:n.env,envFile:n.envFile}}}t.fromSerialized=i})(Md||(Md={}));var or;(function(t){let e;(function(i){i[i["Stopped"]=0]="Stopped";i[i["Starting"]=1]="Starting";i[i["Running"]=2]="Running";i[i["Error"]=3]="Error"})(e=t.Kind||(t.Kind={}));t.toString=i=>{switch(i.state){case e.Stopped:return h(7759,"Stopped");case e.Starting:return h(7760,"Starting");case e.Running:return h(7761,"Running");case e.Error:return h(7762,"Error {0}",i.message);default:t_()}};t.toKindString=i=>{switch(i){case e.Stopped:return"stopped";case e.Starting:return"starting";case e.Running:return"running";case e.Error:return"error";default:t_()}};t.canBeStarted=i=>i===e.Error||i===e.Stopped;t.isRunning=i=>!t.canBeStarted(i.state)})(or||(or={}));var ls;(function(t){function e(n){const{selectionStartLineNumber:s,selectionStartColumn:r,positionLineNumber:o,positionColumn:a}=n;const l=new Ve(s-1,r-1);const c=new Ve(o-1,a-1);return new Dr(l,c)}t.to=e;function i(n){const{anchor:s,active:r}=n;return{selectionStartLineNumber:s.line+1,selectionStartColumn:s.character+1,positionLineNumber:r.line+1,positionColumn:r.character+1}}t.from=i})(ls||(ls={}));var W;(function(t){function e(n){if(!n){return void 0}const{start:s,end:r}=n;return{startLineNumber:s.line+1,startColumn:s.character+1,endLineNumber:r.line+1,endColumn:r.character+1}}t.from=e;function i(n){if(!n){return void 0}const{startLineNumber:s,startColumn:r,endLineNumber:o,endColumn:a}=n;return new Oe(s-1,r-1,o-1,a-1)}t.to=i})(W||(W={}));var Rs;(function(t){function e(n){return{uri:n.uri,range:W.from(n.range)}}t.from=e;function i(n){return new kn(b.revive(n.uri),W.to(n.range))}t.to=i})(Rs||(Rs={}));var iw;(function(t){function e(i){switch(i){case ll.Comment:return so.Comment;case ll.Other:return so.Other;case ll.RegEx:return so.RegEx;case ll.String:return so.String}}t.to=e})(iw||(iw={}));var rt;(function(t){function e(n){return new Ve(n.lineNumber-1,n.column-1)}t.to=e;function i(n){return{lineNumber:n.line+1,column:n.character+1}}t.from=i})(rt||(rt={}));var uc;(function(t){function e(s,r,o){return ei(Sn(s).map(a=>i(a,r,o)))}t.from=e;function i(s,r,o){if(typeof s==="string"){return{$serialized:true,language:s,isBuiltin:o?.isBuiltin}}if(s){return{$serialized:true,language:s.language,scheme:n(s.scheme,r),pattern:an.from(s.pattern)??void 0,exclusive:s.exclusive,notebookType:s.notebookType,isBuiltin:o?.isBuiltin}}return void 0}function n(s,r){if(r&&typeof s==="string"){return r.transformOutgoingScheme(s)}return s}})(uc||(uc={}));var mg;(function(t){function e(n){switch(n){case Go.Unnecessary:return hl.Unnecessary;case Go.Deprecated:return hl.Deprecated}return void 0}t.from=e;function i(n){switch(n){case hl.Unnecessary:return Go.Unnecessary;case hl.Deprecated:return Go.Deprecated;default:return void 0}}t.to=i})(mg||(mg={}));var dc;(function(t){function e(n){let s;if(n.code){if(tt(n.code)||ia(n.code)){s=String(n.code)}else{s={value:String(n.code.value),target:n.code.target}}}return{...W.from(n.range),message:n.message,source:n.source,code:s,severity:Ud.from(n.severity),relatedInformation:n.relatedInformation&&n.relatedInformation.map(_g.from),tags:Array.isArray(n.tags)?ei(n.tags.map(mg.from)):void 0}}t.from=e;function i(n){const s=new Ap(W.to(n),n.message,Ud.to(n.severity));s.source=n.source;s.code=tt(n.code)?n.code:n.code?.value;s.relatedInformation=n.relatedInformation&&n.relatedInformation.map(_g.to);s.tags=n.tags&&ei(n.tags.map(mg.to));return s}t.to=i})(dc||(dc={}));var _g;(function(t){function e(n){return{...W.from(n.location.range),message:n.message,resource:n.location.uri}}t.from=e;function i(n){return new rd(new kn(n.resource,W.to(n)),n.message)}t.to=i})(_g||(_g={}));var Ud;(function(t){function e(n){switch(n){case Di.Error:return Ki.Error;case Di.Warning:return Ki.Warning;case Di.Information:return Ki.Info;case Di.Hint:return Ki.Hint}return Ki.Error}t.from=e;function i(n){switch(n){case Ki.Info:return Di.Information;case Ki.Warning:return Di.Warning;case Ki.Error:return Di.Error;case Ki.Hint:return Di.Hint;default:return Di.Error}}t.to=i})(Ud||(Ud={}));var ai;(function(t){function e(n){if(typeof n==="number"&&n>=pd.One){return n-1}if(n===pd.Beside){return qR}return zR}t.from=e;function i(n){if(typeof n==="number"&&n>=0){return n+1}throw new Error(`invalid 'EditorGroupColumn'`)}t.to=i})(ai||(ai={}));function A3(t){return typeof t.range!=="undefined"}function dC(t){if(t.length===0){return true}return A3(t[0])?true:false}var Pe;(function(t){function e(a){return a.map(t.from)}t.fromMany=e;function i(a){return a&&typeof a==="object"&&typeof a.language==="string"&&typeof a.value==="string"}function n(a){let l;if(i(a)){const{language:d,value:p}=a;l={value:"```"+d+"\n"+p+"\n```\n"}}else if(cn.isMarkdownString(a)){l={value:a.value,isTrusted:a.isTrusted,supportThemeIcons:a.supportThemeIcons,supportHtml:a.supportHtml,baseUri:a.baseUri}}else if(typeof a==="string"){l={value:a}}else{l={value:""}}const c=Object.create(null);l.uris=c;const u=({href:d})=>{try{let p=b.parse(d,true);p=p.with({query:s(p.query,c)});c[d]=p}catch(p){}return""};yt.walkTokens(yt.lexer(l.value),d=>{if(d.type==="link"){u({href:d.href})}else if(d.type==="image"){if(typeof d.href==="string"){u(k7(d.href))}}});return l}t.from=n;function s(a,l){if(!a){return a}let c;try{c=QI(a)}catch(d){}if(!c){return a}let u=false;c=Kl(c,d=>{if(b.isUri(d)){const p=`__uri_${Math.random().toString(16).slice(2,8)}`;l[p]=d;u=true;return p}else{return void 0}});if(!u){return a}return JSON.stringify(c)}function r(a){const l=new cn(a.value,a.supportThemeIcons);l.isTrusted=a.isTrusted;l.supportHtml=a.supportHtml;l.baseUri=a.baseUri?b.from(a.baseUri):void 0;return l}t.to=r;function o(a){if(!a){return void 0}return typeof a==="string"?a:t.from(a)}t.fromStrict=o})(Pe||(Pe={}));function R3(t){if(dC(t)){return t.map(e=>{return{range:W.from(e.range),hoverMessage:Array.isArray(e.hoverMessage)?Pe.fromMany(e.hoverMessage):e.hoverMessage?Pe.from(e.hoverMessage):void 0,renderOptions:e.renderOptions}})}else{return t.map(e=>{return{range:W.from(e)}})}}function Mm(t){if(typeof t==="undefined"){return t}if(typeof t==="string"){return b.file(t)}else{return t}}var hc;(function(t){function e(i){if(typeof i==="undefined"){return i}return{contentText:i.contentText,contentIconPath:i.contentIconPath?Mm(i.contentIconPath):void 0,border:i.border,borderColor:i.borderColor,fontStyle:i.fontStyle,fontWeight:i.fontWeight,textDecoration:i.textDecoration,color:i.color,backgroundColor:i.backgroundColor,margin:i.margin,width:i.width,height:i.height}}t.from=e})(hc||(hc={}));var vg;(function(t){function e(i){if(typeof i==="undefined"){return i}return{backgroundColor:i.backgroundColor,outline:i.outline,outlineColor:i.outlineColor,outlineStyle:i.outlineStyle,outlineWidth:i.outlineWidth,border:i.border,borderColor:i.borderColor,borderRadius:i.borderRadius,borderSpacing:i.borderSpacing,borderStyle:i.borderStyle,borderWidth:i.borderWidth,fontStyle:i.fontStyle,fontWeight:i.fontWeight,textDecoration:i.textDecoration,cursor:i.cursor,color:i.color,opacity:i.opacity,letterSpacing:i.letterSpacing,gutterIconPath:i.gutterIconPath?Mm(i.gutterIconPath):void 0,gutterIconSize:i.gutterIconSize,overviewRulerColor:i.overviewRulerColor,before:i.before?hc.from(i.before):void 0,after:i.after?hc.from(i.after):void 0}}t.from=e})(vg||(vg={}));var nw;(function(t){function e(i){if(typeof i==="undefined"){return i}switch(i){case Qo.OpenOpen:return dl.AlwaysGrowsWhenTypingAtEdges;case Qo.ClosedClosed:return dl.NeverGrowsWhenTypingAtEdges;case Qo.OpenClosed:return dl.GrowsOnlyWhenTypingBefore;case Qo.ClosedOpen:return dl.GrowsOnlyWhenTypingAfter}}t.from=e})(nw||(nw={}));var sw;(function(t){function e(i){return{isWholeLine:i.isWholeLine,rangeBehavior:i.rangeBehavior?nw.from(i.rangeBehavior):void 0,overviewRulerLane:i.overviewRulerLane,light:i.light?vg.from(i.light):void 0,dark:i.dark?vg.from(i.dark):void 0,backgroundColor:i.backgroundColor,outline:i.outline,outlineColor:i.outlineColor,outlineStyle:i.outlineStyle,outlineWidth:i.outlineWidth,border:i.border,borderColor:i.borderColor,borderRadius:i.borderRadius,borderSpacing:i.borderSpacing,borderStyle:i.borderStyle,borderWidth:i.borderWidth,fontStyle:i.fontStyle,fontWeight:i.fontWeight,textDecoration:i.textDecoration,cursor:i.cursor,color:i.color,opacity:i.opacity,letterSpacing:i.letterSpacing,gutterIconPath:i.gutterIconPath?Mm(i.gutterIconPath):void 0,gutterIconSize:i.gutterIconSize,overviewRulerColor:i.overviewRulerColor,before:i.before?hc.from(i.before):void 0,after:i.after?hc.from(i.after):void 0}}t.from=e})(sw||(sw={}));var li;(function(t){function e(n){return{text:n.newText,eol:n.newEol&&gc.from(n.newEol),range:W.from(n.range)}}t.from=e;function i(n){const s=new go(W.to(n.range),n.text);s.newEol=typeof n.eol==="undefined"?void 0:gc.to(n.eol);return s}t.to=i})(li||(li={}));var un;(function(t){function e(n,s){const r={edits:[]};if(n instanceof Da){const o=new Nk;for(const a of n._allEntries()){if(a._type===Ut.File&&b.isUri(a.to)&&a.from===void 0){o.add(a.to)}}for(const a of n._allEntries()){if(a._type===Ut.File){let l;if(a.options?.contents){if(ArrayBuffer.isView(a.options.contents)){l={type:"base64",value:m0(ue.wrap(a.options.contents))}}else{l={type:"dataTransferItem",id:a.options.contents._itemId}}}r.edits.push({oldResource:a.from,newResource:a.to,options:{...a.options,contents:l},metadata:a.metadata})}else if(a._type===Ut.Text){r.edits.push({resource:a.uri,textEdit:li.from(a.edit),versionId:!o.has(a.uri)?s?.getTextDocumentVersion(a.uri):void 0,metadata:a.metadata})}else if(a._type===Ut.Snippet){r.edits.push({resource:a.uri,textEdit:{range:W.from(a.range),text:a.edit.value,insertAsSnippet:true,keepWhitespace:a.keepWhitespace},versionId:!o.has(a.uri)?s?.getTextDocumentVersion(a.uri):void 0,metadata:a.metadata})}else if(a._type===Ut.Cell){r.edits.push({metadata:a.metadata,resource:a.uri,cellEdit:a.edit,notebookVersionId:s?.getNotebookDocumentVersion(a.uri)})}else if(a._type===Ut.CellReplace){r.edits.push({metadata:a.metadata,resource:a.uri,notebookVersionId:s?.getNotebookDocumentVersion(a.uri),cellEdit:{editType:uo.Replace,index:a.index,count:a.count,cells:a.cells.map(_c.from)}})}}}return r}t.from=e;function i(n){const s=new Da;const r=new Ft;for(const o of n.edits){if(o.textEdit){const a=o;const l=b.revive(a.resource);const c=W.to(a.textEdit.range);const u=a.textEdit.text;const d=a.textEdit.insertAsSnippet;let p;if(d){p=ca.replace(c,new ka(u))}else{p=go.replace(c,u)}const f=r.get(l);if(!f){r.set(l,[p])}else{f.push(p)}}else{s.renameFile(b.revive(o.oldResource),b.revive(o.newResource),o.options)}}for(const[o,a]of r){s.set(o,a)}return s}t.to=i})(un||(un={}));var Un;(function(t){const e=Object.create(null);e[gt.File]=j.File;e[gt.Module]=j.Module;e[gt.Namespace]=j.Namespace;e[gt.Package]=j.Package;e[gt.Class]=j.Class;e[gt.Method]=j.Method;e[gt.Property]=j.Property;e[gt.Field]=j.Field;e[gt.Constructor]=j.Constructor;e[gt.Enum]=j.Enum;e[gt.Interface]=j.Interface;e[gt.Function]=j.Function;e[gt.Variable]=j.Variable;e[gt.Constant]=j.Constant;e[gt.String]=j.String;e[gt.Number]=j.Number;e[gt.Boolean]=j.Boolean;e[gt.Array]=j.Array;e[gt.Object]=j.Object;e[gt.Key]=j.Key;e[gt.Null]=j.Null;e[gt.EnumMember]=j.EnumMember;e[gt.Struct]=j.Struct;e[gt.Event]=j.Event;e[gt.Operator]=j.Operator;e[gt.TypeParameter]=j.TypeParameter;function i(s){return typeof e[s]==="number"?e[s]:j.Property}t.from=i;function n(s){for(const r in e){if(e[r]===s){return Number(r)}}return gt.Property}t.to=n})(Un||(Un={}));var kr;(function(t){function e(n){switch(n){case ad.Deprecated:return Zf.Deprecated}}t.from=e;function i(n){switch(n){case Zf.Deprecated:return ad.Deprecated}}t.to=i})(kr||(kr={}));var Pa;(function(t){function e(n){return{name:n.name,kind:Un.from(n.kind),tags:n.tags&&n.tags.map(kr.from),containerName:n.containerName,location:Zi.from(n.location)}}t.from=e;function i(n){const s=new ld(n.name,Un.to(n.kind),n.containerName,Zi.to(n.location));s.tags=n.tags&&n.tags.map(kr.to);return s}t.to=i})(Pa||(Pa={}));var rw;(function(t){function e(n){const s={name:n.name||"!!MISSING: name!!",detail:n.detail,range:W.from(n.range),selectionRange:W.from(n.selectionRange),kind:Un.from(n.kind),tags:n.tags?.map(kr.from)??[]};if(n.children){s.children=n.children.map(e)}return s}t.from=e;function i(n){const s=new cd(n.name,n.detail,Un.to(n.kind),W.to(n.range),W.to(n.selectionRange));if(kc(n.tags)){s.tags=n.tags.map(kr.to)}if(n.children){s.children=n.children.map(i)}return s}t.to=i})(rw||(rw={}));var Aa;(function(t){function e(n){const s=new Z0(Un.to(n.kind),n.name,n.detail||"",b.revive(n.uri),W.to(n.range),W.to(n.selectionRange));s._sessionId=n._sessionId;s._itemId=n._itemId;return s}t.to=e;function i(n,s,r){s=s??n._sessionId;r=r??n._itemId;if(s===void 0||r===void 0){throw new Error("invalid item")}return{_sessionId:s,_itemId:r,name:n.name,detail:n.detail,kind:Un.from(n.kind),uri:n.uri,range:W.from(n.range),selectionRange:W.from(n.selectionRange),tags:n.tags?.map(kr.from)}}t.from=i})(Aa||(Aa={}));var ow;(function(t){function e(i){return new M4(Aa.to(i.from),i.fromRanges.map(n=>W.to(n)))}t.to=e})(ow||(ow={}));var aw;(function(t){function e(i){return new U4(Aa.to(i.to),i.fromRanges.map(n=>W.to(n)))}t.to=e})(aw||(aw={}));var Zi;(function(t){function e(n){return{range:n.range&&W.from(n.range),uri:n.uri}}t.from=e;function i(n){return new kn(b.revive(n.uri),W.to(n.range))}t.to=i})(Zi||(Zi={}));var $d;(function(t){function e(n){const s=n;const r=n;return{originSelectionRange:s.originSelectionRange?W.from(s.originSelectionRange):void 0,uri:s.targetUri?s.targetUri:r.uri,range:W.from(s.targetRange?s.targetRange:r.range),targetSelectionRange:s.targetSelectionRange?W.from(s.targetSelectionRange):void 0}}t.from=e;function i(n){return{targetUri:b.revive(n.uri),targetRange:W.to(n.range),targetSelectionRange:n.targetSelectionRange?W.to(n.targetSelectionRange):void 0,originSelectionRange:n.originSelectionRange?W.to(n.originSelectionRange):void 0}}t.to=i})($d||($d={}));var Hd;(function(t){function e(n){const s={range:W.from(n.range),contents:Pe.fromMany(n.contents),canIncreaseVerbosity:n.canIncreaseVerbosity,canDecreaseVerbosity:n.canDecreaseVerbosity};return s}t.from=e;function i(n){const s=n.contents.map(Pe.to);const r=W.to(n.range);const o=n.canIncreaseVerbosity;const a=n.canDecreaseVerbosity;return new Lp(s,r,o,a)}t.to=i})(Hd||(Hd={}));var lw;(function(t){function e(n){return{range:W.from(n.range),expression:n.expression}}t.from=e;function i(n){return new Xp(W.to(n.range),n.expression)}t.to=i})(lw||(lw={}));var wg;(function(t){function e(n){if(n instanceof Yp){return{type:"text",range:W.from(n.range),text:n.text}}else if(n instanceof Zp){return{type:"variable",range:W.from(n.range),variableName:n.variableName,caseSensitiveLookup:n.caseSensitiveLookup}}else if(n instanceof eg){return{type:"expression",range:W.from(n.range),expression:n.expression}}else{throw new Error(`Unknown 'InlineValue' type`)}}t.from=e;function i(n){switch(n.type){case"text":return{range:W.to(n.range),text:n.text};case"variable":return{range:W.to(n.range),variableName:n.variableName,caseSensitiveLookup:n.caseSensitiveLookup};case"expression":return{range:W.to(n.range),expression:n.expression}}}t.to=i})(wg||(wg={}));var bg;(function(t){function e(n){return{frameId:n.frameId,stoppedLocation:W.from(n.stoppedLocation)}}t.from=e;function i(n){return new bv(n.frameId,W.to(n.stoppedLocation))}t.to=i})(bg||(bg={}));var fc;(function(t){function e(n){return{range:W.from(n.range),kind:n.kind}}t.from=e;function i(n){return new Np(W.to(n.range),n.kind)}t.to=i})(fc||(fc={}));var cw;(function(t){function e(n){return{uri:n.uri,highlights:n.highlights.map(fc.from)}}t.from=e;function i(n){return new Op(b.revive(n.uri),n.highlights.map(fc.to))}t.to=i})(cw||(cw={}));var uw;(function(t){function e(i){switch(i){case bu.TriggerCharacter:return Cl.TriggerCharacter;case bu.TriggerForIncompleteCompletions:return Cl.TriggerForIncompleteCompletions;case bu.Invoke:default:return Cl.Invoke}}t.to=e})(uw||(uw={}));var dw;(function(t){function e(i){return{triggerKind:uw.to(i.triggerKind),triggerCharacter:i.triggerCharacter}}t.to=e})(dw||(dw={}));var yg;(function(t){function e(n){switch(n){case fd.Deprecated:return Qf.Deprecated}}t.from=e;function i(n){switch(n){case Qf.Deprecated:return fd.Deprecated}}t.to=i})(yg||(yg={}));var xg;(function(t){const e=new Map([[ke.Method,M.Method],[ke.Function,M.Function],[ke.Constructor,M.Constructor],[ke.Field,M.Field],[ke.Variable,M.Variable],[ke.Class,M.Class],[ke.Interface,M.Interface],[ke.Struct,M.Struct],[ke.Module,M.Module],[ke.Property,M.Property],[ke.Unit,M.Unit],[ke.Value,M.Value],[ke.Constant,M.Constant],[ke.Enum,M.Enum],[ke.EnumMember,M.EnumMember],[ke.Keyword,M.Keyword],[ke.Snippet,M.Snippet],[ke.Text,M.Text],[ke.Color,M.Color],[ke.File,M.File],[ke.Reference,M.Reference],[ke.Folder,M.Folder],[ke.Event,M.Event],[ke.Operator,M.Operator],[ke.TypeParameter,M.TypeParameter],[ke.Issue,M.Issue],[ke.User,M.User]]);function i(r){return e.get(r)??M.Property}t.from=i;const n=new Map([[M.Method,ke.Method],[M.Function,ke.Function],[M.Constructor,ke.Constructor],[M.Field,ke.Field],[M.Variable,ke.Variable],[M.Class,ke.Class],[M.Interface,ke.Interface],[M.Struct,ke.Struct],[M.Module,ke.Module],[M.Property,ke.Property],[M.Unit,ke.Unit],[M.Value,ke.Value],[M.Constant,ke.Constant],[M.Enum,ke.Enum],[M.EnumMember,ke.EnumMember],[M.Keyword,ke.Keyword],[M.Snippet,ke.Snippet],[M.Text,ke.Text],[M.Color,ke.Color],[M.File,ke.File],[M.Reference,ke.Reference],[M.Folder,ke.Folder],[M.Event,ke.Event],[M.Operator,ke.Operator],[M.TypeParameter,ke.TypeParameter],[M.User,ke.User],[M.Issue,ke.Issue]]);function s(r){return n.get(r)??ke.Property}t.to=s})(xg||(xg={}));var hw;(function(t){function e(i,n){const s=new $p(i.label);s.insertText=i.insertText;s.kind=xg.to(i.kind);s.tags=i.tags?.map(yg.to);s.detail=i.detail;s.documentation=Ir(i.documentation)?Pe.to(i.documentation):i.documentation;s.sortText=i.sortText;s.filterText=i.filterText;s.preselect=i.preselect;s.commitCharacters=i.commitCharacters;if(et.isIRange(i.range)){s.range=W.to(i.range)}else if(typeof i.range==="object"){s.range={inserting:W.to(i.range.insert),replacing:W.to(i.range.replace)}}s.keepWhitespace=typeof i.insertTextRules==="undefined"?false:Boolean(i.insertTextRules&aa.KeepWhitespace);if(typeof i.insertTextRules!=="undefined"&&i.insertTextRules&aa.InsertAsSnippet){s.insertText=new ka(i.insertText)}else{s.insertText=i.insertText;s.textEdit=s.range instanceof Oe?new go(s.range,s.insertText):void 0}if(i.additionalTextEdits&&i.additionalTextEdits.length>0){s.additionalTextEdits=i.additionalTextEdits.map(r=>li.to(r))}s.command=n&&i.command?n.fromInternal(i.command):void 0;return s}t.to=e})(hw||(hw={}));var Eg;(function(t){function e(n){if(typeof n.label!=="string"&&!Array.isArray(n.label)){throw new TypeError("Invalid label")}return{label:n.label,documentation:Pe.fromStrict(n.documentation)}}t.from=e;function i(n){return{label:n.label,documentation:Ir(n.documentation)?Pe.to(n.documentation):n.documentation}}t.to=i})(Eg||(Eg={}));var Sg;(function(t){function e(n){return{label:n.label,documentation:Pe.fromStrict(n.documentation),parameters:Array.isArray(n.parameters)?n.parameters.map(Eg.from):[],activeParameter:n.activeParameter}}t.from=e;function i(n){return{label:n.label,documentation:Ir(n.documentation)?Pe.to(n.documentation):n.documentation,parameters:Array.isArray(n.parameters)?n.parameters.map(Eg.to):[],activeParameter:n.activeParameter}}t.to=i})(Sg||(Sg={}));var Bd;(function(t){function e(n){return{activeSignature:n.activeSignature,activeParameter:n.activeParameter,signatures:Array.isArray(n.signatures)?n.signatures.map(Sg.from):[]}}t.from=e;function i(n){return{activeSignature:n.activeSignature,activeParameter:n.activeParameter,signatures:Array.isArray(n.signatures)?n.signatures.map(Sg.to):[]}}t.to=i})(Bd||(Bd={}));var fw;(function(t){function e(i,n){const s=new Up(rt.to(n.position),typeof n.label==="string"?n.label:n.label.map(pw.to.bind(void 0,i)),n.kind&&Dg.to(n.kind));s.textEdits=n.textEdits&&n.textEdits.map(li.to);s.tooltip=Ir(n.tooltip)?Pe.to(n.tooltip):n.tooltip;s.paddingLeft=n.paddingLeft;s.paddingRight=n.paddingRight;return s}t.to=e})(fw||(fw={}));var pw;(function(t){function e(i,n){const s=new Mp(n.label);s.tooltip=Ir(n.tooltip)?Pe.to(n.tooltip):n.tooltip;if(S_.is(n.command)){s.command=i.fromInternal(n.command)}if(n.location){s.location=Zi.to(n.location)}return s}t.to=e})(pw||(pw={}));var Dg;(function(t){function e(n){return n}t.from=e;function i(n){return n}t.to=i})(Dg||(Dg={}));var pa;(function(t){function e(n){return{range:W.from(n.range),url:n.target,tooltip:n.tooltip}}t.from=e;function i(n){let s=void 0;if(n.url){try{s=typeof n.url==="string"?b.parse(n.url,true):b.revive(n.url)}catch(o){}}const r=new Bp(W.to(n.range),s);r.tooltip=n.tooltip;return r}t.to=i})(pa||(pa={}));var kg;(function(t){function e(n){const s=new Wp(n.label);if(n.textEdit){s.textEdit=li.to(n.textEdit)}if(n.additionalTextEdits){s.additionalTextEdits=n.additionalTextEdits.map(r=>li.to(r))}return s}t.to=e;function i(n){return{label:n.label,textEdit:n.textEdit?li.from(n.textEdit):void 0,additionalTextEdits:n.additionalTextEdits?n.additionalTextEdits.map(s=>li.from(s)):void 0}}t.from=i})(kg||(kg={}));var pc;(function(t){function e(n){return new nc(n[0],n[1],n[2],n[3])}t.to=e;function i(n){return[n.red,n.green,n.blue,n.alpha]}t.from=i})(pc||(pc={}));var gw;(function(t){function e(n){return{range:W.from(n.range)}}t.from=e;function i(n){return new hd(W.to(n.range))}t.to=i})(gw||(gw={}));var Ig;(function(t){function e(i){switch(i){case fl.AUTO:return Pl.AfterDelay;case fl.EXPLICIT:return Pl.Manual;case fl.FOCUS_CHANGE:case fl.WINDOW_CHANGE:return Pl.FocusOut}}t.to=e})(Ig||(Ig={}));var Ul;(function(t){function e(n){switch(n){case Qn.Off:return Li.Off;case Qn.Relative:return Li.Relative;case Qn.Interval:return Li.Interval;case Qn.On:default:return Li.On}}t.from=e;function i(n){switch(n){case Li.Off:return Qn.Off;case Li.Relative:return Qn.Relative;case Li.Interval:return Qn.Interval;case Li.On:default:return Qn.On}}t.to=i})(Ul||(Ul={}));var gc;(function(t){function e(n){if(n===ss.CRLF){return ul.CRLF}else if(n===ss.LF){return ul.LF}return void 0}t.from=e;function i(n){if(n===ul.CRLF){return ss.CRLF}else if(n===ul.LF){return ss.LF}return void 0}t.to=i})(gc||(gc={}));var mw;(function(t){function e(i){if(typeof i==="object"){return i.viewId}switch(i){case ua.SourceControl:return Eu.Scm;case ua.Window:return Eu.Window;case ua.Notification:return Eu.Notification}throw new Error(`Unknown 'ProgressLocation'`)}t.from=e})(mw||(mw={}));var Cg;(function(t){function e(n){const s={start:n.start+1,end:n.end+1};if(n.kind){s.kind=Tg.from(n.kind)}return s}t.from=e;function i(n){const s={start:n.start-1,end:n.end-1};if(n.kind){s.kind=Tg.to(n.kind)}return s}t.to=i})(Cg||(Cg={}));var Tg;(function(t){function e(n){if(n){switch(n){case rr.Comment:return Ka.Comment;case rr.Imports:return Ka.Imports;case rr.Region:return Ka.Region}}return void 0}t.from=e;function i(n){if(n){switch(n.value){case Ka.Comment.value:return rr.Comment;case Ka.Imports.value:return rr.Imports;case Ka.Region.value:return rr.Region}}return void 0}t.to=i})(Tg||(Tg={}));var Au;(function(t){function e(i){if(i){return{pinned:typeof i.preview==="boolean"?!i.preview:void 0,inactive:i.background,preserveFocus:i.preserveFocus,selection:typeof i.selection==="object"?W.from(i.selection):void 0,override:typeof i.override==="boolean"?P8.id:void 0}}return void 0}t.from=e})(Au||(Au={}));var an;(function(t){function e(r){if(r instanceof Ll){return r.toJSON()}if(typeof r==="string"){return r}if(i(r)||n(r)){return new Ll(r.baseUri??r.base,r.pattern).toJSON()}return r}t.from=e;function i(r){const o=r;if(!o){return false}return b.isUri(o.baseUri)&&typeof o.pattern==="string"}function n(r){const o=r;if(!o){return false}return typeof o.base==="string"&&typeof o.pattern==="string"}function s(r){if(typeof r==="string"){return r}return new Ll(b.revive(r.baseUri),r.pattern)}t.to=s})(an||(an={}));var _w;(function(t){function e(i){if(!i){return void 0}else if(Array.isArray(i)){return i.map(e)}else if(typeof i==="string"){return i}else{const n=i;return{language:n.language,scheme:n.scheme,pattern:an.from(n.pattern)??void 0,exclusive:n.exclusive,notebookType:n.notebookType}}}t.from=e})(_w||(_w={}));var Ls;(function(t){function e(n){return{start:n.start,end:n.end}}t.from=e;function i(n){return new gr(n.start,n.end)}t.to=i})(Ls||(Ls={}));var mc;(function(t){function e(n){return{timing:typeof n.runStartTime==="number"&&typeof n.runEndTime==="number"?{startTime:n.runStartTime,endTime:n.runEndTime}:void 0,executionOrder:n.executionOrder,success:n.lastRunSuccess}}t.to=e;function i(n){return{lastRunSuccess:n.success,runStartTime:n.timing?.startTime,runEndTime:n.timing?.endTime,executionOrder:n.executionOrder}}t.from=i})(mc||(mc={}));var vw;(function(t){function e(i){if(i===Du.Unconfirmed){return lc.Pending}else if(i===Du.Pending){return void 0}else if(i===Du.Executing){return lc.Executing}else{throw new Error(`Unknown state: ${i}`)}}t.to=e})(vw||(vw={}));var Vd;(function(t){function e(n){switch(n){case Yo.Markup:return gl.Markup;case Yo.Code:default:return gl.Code}}t.from=e;function i(n){switch(n){case gl.Markup:return Yo.Markup;case gl.Code:default:return Yo.Code}}t.to=i})(Vd||(Vd={}));var Vr;(function(t){function e(n){const s={metadata:n.metadata??Object.create(null),cells:[]};for(const r of n.cells){Pm.validate(r);s.cells.push(_c.from(r))}return s}t.from=e;function i(n){const s=new z4(n.cells.map(_c.to));if(!Uk(n.metadata)){s.metadata=n.metadata}return s}t.to=i})(Vr||(Vr={}));var _c;(function(t){function e(n){return{cellKind:Vd.from(n.kind),language:n.languageId,mime:n.mime,source:n.value,metadata:n.metadata,internalMetadata:mc.from(n.executionSummary??{}),outputs:n.outputs?n.outputs.map(_o.from):[]}}t.from=e;function i(n){return new Pm(Vd.to(n.cellKind),n.source,n.language,n.mime,n.outputs?n.outputs.map(_o.to):void 0,n.metadata,n.internalMetadata?mc.to(n.internalMetadata):void 0)}t.to=i})(_c||(_c={}));var vc;(function(t){function e(n){return{mime:n.mime,valueBytes:ue.wrap(n.data)}}t.from=e;function i(n){return new q4(n.valueBytes.buffer,n.mime)}t.to=i})(vc||(vc={}));var _o;(function(t){function e(n){return{outputId:n.id,items:n.items.map(vc.from),metadata:n.metadata}}t.from=e;function i(n){const s=n.items.map(vc.to);return new ng(s,n.outputId,n.metadata)}t.to=i})(_o||(_o={}));var Pg;(function(t){function e(s){if(n(s)){return{include:an.from(s.include)??void 0,exclude:an.from(s.exclude)??void 0}}return an.from(s)??void 0}t.from=e;function i(s){if(n(s)){return{include:an.to(s.include),exclude:an.to(s.exclude)}}return an.to(s)}t.to=i;function n(s){const r=s;if(!r){return false}return!Xt(r.include)&&!Xt(r.exclude)}})(Pg||(Pg={}));var ww;(function(t){function e(i,n,s){const r=typeof i.command==="string"?{title:"",command:i.command}:i.command;return{alignment:i.alignment===sg.Left?rp.Left:rp.Right,command:n.toInternal(r,s),text:i.text,tooltip:i.tooltip,accessibilityInformation:i.accessibilityInformation,priority:i.priority}}t.from=e})(ww||(ww={}));var bw;(function(t){function e(i,n,s){const r=typeof i.command==="string"?{title:"",command:i.command}:i.command;return{command:n.toInternal(r,s),label:i.label,description:i.description,detail:i.detail,documentation:i.documentation}}t.from=e})(bw||(bw={}));var yw;(function(t){function e(i){return{transientOutputs:i?.transientOutputs??false,transientCellMetadata:i?.transientCellMetadata??{},transientDocumentMetadata:i?.transientDocumentMetadata??{},cellContentMetadata:i?.cellContentMetadata??{}}}t.from=e})(yw||(yw={}));var Ag;(function(t){function e(n){return{uri:n.uri,provides:n.provides}}t.from=e;function i(n){return new j4(b.revive(n.uri),n.provides)}t.to=i})(Ag||(Ag={}));var wc;(function(t){function e(n){return{message:Pe.fromStrict(n.message)||"",type:as.Error,expected:n.expectedOutput,actual:n.actualOutput,contextValue:n.contextValue,location:n.location&&{range:W.from(n.location.range),uri:n.location.uri},stackTrace:n.stackTrace?.map(s=>({label:s.label,position:s.position&&rt.from(s.position),uri:s.uri&&b.revive(s.uri).toJSON()}))}}t.from=e;function i(n){const s=new cg(typeof n.message==="string"?n.message:Pe.to(n.message));s.actualOutput=n.actual;s.expectedOutput=n.expected;s.contextValue=n.contextValue;s.location=n.location?Zi.to(n.location):void 0;return s}t.to=i})(wc||(wc={}));var cs;(function(t){t.namespace=lf;t.denamespace=L4})(cs||(cs={}));var xw;(function(t){function e(i){return{controllerId:i.controllerId,profileId:i.profileId,group:bc.from(i.kind)}}t.from=e})(xw||(xw={}));var bc;(function(t){const e={[Ml.Coverage]:Ii.Coverage,[Ml.Debug]:Ii.Debug,[Ml.Run]:Ii.Run};function i(n){return e.hasOwnProperty(n)?e[n]:Ii.Run}t.from=i})(bc||(bc={}));var vo;(function(t){function e(n){const s=Tm(n).controllerId;return{extId:Re.fromExtHostTestItem(n,s).toString(),label:n.label,uri:b.revive(n.uri),busy:n.busy,tags:n.tags.map(r=>cs.namespace(s,r.id)),range:et.lift(W.from(n.range)),description:n.description||null,sortText:n.sortText||null,error:n.error?Pe.fromStrict(n.error)||null:null}}t.from=e;function i(n){return{parent:void 0,error:void 0,id:Re.fromString(n.extId).localId,label:n.label,uri:b.revive(n.uri),tags:(n.tags||[]).map(s=>{const{tagId:r}=cs.denamespace(s);return new Pd(r)}),children:{add:()=>{},delete:()=>{},forEach:()=>{},*[Symbol.iterator](){},get:()=>void 0,replace:()=>{},size:0},range:W.to(n.range||void 0),canResolveChildren:false,busy:n.busy,description:n.description||void 0,sortText:n.sortText||void 0}}t.toPlain=i})(vo||(vo={}));(function(t){function e(n){return{id:n.id}}t.from=e;function i(n){return new Pd(n.id)}t.to=i})(cs||(cs={}));var Ew;(function(t){const e=(n,s)=>{const r=n.value;if(!r){return void 0}const o={...vo.toPlain(r.item),parent:s,taskStates:r.tasks.map(a=>({state:a.state,duration:a.duration,messages:a.messages.filter(l=>l.type===as.Error).map(wc.to)})),children:[]};if(n.children){for(const a of n.children.values()){const l=e(a,o);if(l){o.children.push(l)}}}return o};function i(n){const s=new cA;for(const a of n.items){s.insert(Re.fromString(a.item.extId).path,a)}const r=[s.nodes];const o=[];while(r.length){for(const a of r.pop()){if(a.value){o.push(a)}else if(a.children){r.push(a.children.values())}}}return{completedAt:n.completedAt,results:o.map(a=>e(a)).filter(ln)}}t.to=i})(Ew||(Ew={}));var Wd;(function(t){function e(a){return{covered:a.covered,total:a.total}}function i(a){return"line"in a?rt.from(a):W.from(a)}function n(a){if(!a){return void 0}return"endLineNumber"in a?W.to(a):rt.to(a)}function s(a){if(a.type===la.Statement){const l=[];if(a.branches){for(const c of a.branches){l.push({executed:c.count,location:n(c.location),label:c.label})}}return new K4(a.count,n(a.location),a.branches?.map(c=>new Q4(c.count,n(c.location),c.label)))}else{return new J4(a.name,a.count,n(a.location))}}t.to=s;function r(a){if(typeof a.executed==="number"&&a.executed<0){throw new Error(`Invalid coverage count ${a.executed}`)}if("branches"in a){return{count:a.executed,location:i(a.location),type:la.Statement,branches:a.branches.length?a.branches.map(l=>({count:l.executed,location:l.location&&i(l.location),label:l.label})):void 0}}else{return{type:la.Declaration,name:a.name,count:a.executed,location:i(a.location)}}}t.fromDetails=r;function o(a,l,c){ff(c.statementCoverage);ff(c.branchCoverage);ff(c.declarationCoverage);return{id:l,uri:c.uri,statement:e(c.statementCoverage),branch:c.branchCoverage&&e(c.branchCoverage),declaration:c.declarationCoverage&&e(c.declarationCoverage),testIds:c instanceof cc&&c.includesTests.length?c.includesTests.map(u=>Re.fromExtHostTestItem(u,a).toString()):void 0}}t.fromFile=o})(Wd||(Wd={}));var Sw;(function(t){function e(i){switch(i){case Yf.Invoke:return ud.Invoke;case Yf.Auto:return ud.Automatic}}t.to=e})(Sw||(Sw={}));var ga;(function(t){function e(n){const s=new iy(Un.to(n.kind),n.name,n.detail||"",b.revive(n.uri),W.to(n.range),W.to(n.selectionRange));s._sessionId=n._sessionId;s._itemId=n._itemId;return s}t.to=e;function i(n,s,r){s=s??n._sessionId;r=r??n._itemId;if(s===void 0||r===void 0){throw new Error("invalid item")}return{_sessionId:s,_itemId:r,kind:Un.from(n.kind),name:n.name,detail:n.detail??"",uri:n.uri,range:W.from(n.range),selectionRange:W.from(n.selectionRange),tags:n.tags?.map(kr.from)}}t.from=i})(ga||(ga={}));var Rg;(function(t){function e(i){if(!i){return void 0}return{value:i.value,tooltip:i.tooltip}}t.from=e})(Rg||(Rg={}));var ma;(function(t){function e(r,o,a){const l=o.fileData;if(l){return new d3(new h3(l.name,b.revive(l.uri),l.id,p0(()=>a(l.id))))}if(r===vr.uriList&&o.uriListData){return new Gp(s(o.uriListData))}return new Gp(o.asString)}t.to=e;async function i(r,o,a=vi()){const l=await o.asString();if(r===vr.uriList){return{id:a,asString:l,fileData:void 0,uriListData:n(l)}}const c=o.asFile();return{id:a,asString:l,fileData:c?{name:c.name,uri:c.uri,id:c._itemId??c.id}:void 0}}t.from=i;function n(r){return w_.split(r).map(o=>{if(o.startsWith("#")){return o}try{return b.parse(o)}catch{}return o})}function s(r){return w_.create(r.map(o=>{return typeof o==="string"?o:b.revive(o)}))}})(ma||(ma={}));var yc;(function(t){function e(s,r){const o=s.items.map(([a,l])=>{return[a,ma.to(a,l,r)]});return new rc(o)}t.toDataTransfer=e;async function i(s){const r=await Promise.all(Array.from(s,async([o,a])=>{return[o,await ma.from(o,a)]}));return{items:r}}t.from=i;async function n(s){const r=await Promise.all(Array.from(s,async([o,a])=>{return[o,await ma.from(o,a,a.id)]}));return{items:r}}t.fromList=n})(yc||(yc={}));var zd;(function(t){function e(n,s){return{kind:"reply",agentId:n.participant??s?.agentId??"",subCommand:n.command??s?.command,message:n.prompt,title:n.label}}t.from=e;function i(n){return{prompt:n.message,label:n.title,participant:n.agentId,command:n.subCommand}}t.to=i})(zd||(zd={}));var xc;(function(t){function e(n){switch(n){case ir.System:return on.System;case ir.User:return on.User;case ir.Assistant:return on.Assistant}}t.to=e;function i(n){switch(n){case on.System:return ir.System;case on.User:return ir.User;case on.Assistant:return ir.Assistant}return ir.User}t.from=i})(xc||(xc={}));var uS;(function(t){function e(n){const s=n.content.map(a=>{if(a.type==="text"){return new Ht(a.value)}else if(a.type==="tool_result"){const l=a.value.map(c=>{if(c.type==="text"){return new Ht(c.value)}else{return new Ms(c.value)}});return new pg(a.toolCallId,l,a.isError)}else if(a.type==="image_url"||a.type==="extra_data"){return void 0}else{return new Ca(a.toolCallId,a.name,a.parameters)}}).filter(a=>a!==void 0);const r=xc.to(n.role);const o=new lC(r,s,n.name);return o}t.to=e;function i(n){const s=xc.from(n.role);const r=n.name;let o=n.content;if(typeof o==="string"){o=[new Ht(o)]}const a=o.map(l=>{if(l instanceof pg){return{type:"tool_result",toolCallId:l.callId,value:ei(l.content.map(c=>{if(c instanceof Ht){return{type:"text",value:c.value}}else if(c instanceof Ms){return{type:"prompt_tsx",value:c.value}}else{return void 0}})),isError:l.isError}}else if(l instanceof Ca){return{type:"tool_use",toolCallId:l.callId,name:l.name,parameters:l.input}}else if(l instanceof Ht){return{type:"text",value:l.value}}else{if(typeof l!=="string"){throw new Error("Unexpected chat message content type")}return{type:"text",value:l}}});return{role:s,name:r,content:a}}t.from=i})(uS||(uS={}));var Ru;(function(t){function e(n){const s=n.content.map(a=>{if(a.type==="text"){return new Ht(a.value)}else if(a.type==="tool_result"){const l=a.value.map(c=>{if(c.type==="text"){return new Ht(c.value)}else if(c.type==="data"){return new On(c.value.data.buffer,c.value.mimeType)}else{return new Ms(c.value)}});return new zv(a.toolCallId,l,a.isError)}else if(a.type==="image_url"){return new On(a.value.data.buffer,a.value.mimeType)}else if(a.type==="extra_data"){return new Kv(a.kind,a.data)}else{return new Ca(a.toolCallId,a.name,a.parameters)}});const r=xc.to(n.role);const o=new cC(r,s,n.name);return o}t.to=e;function i(n){const s=xc.from(n.role);const r=n.name;let o=n.content;if(typeof o==="string"){o=[new Ht(o)]}const a=o.map(l=>{if(l instanceof zv||l instanceof pg){return{type:"tool_result",toolCallId:l.callId,value:ei(l.content.map(c=>{if(c instanceof Ht){return{type:"text",value:c.value}}else if(c instanceof Ms){return{type:"prompt_tsx",value:c.value}}else if(c instanceof On){return{type:"data",value:{mimeType:c.mimeType,data:ue.wrap(c.data)}}}else{return void 0}})),isError:l.isError}}else if(l instanceof On){const c={mimeType:l.mimeType,data:ue.wrap(l.data)};return{type:"image_url",value:c}}else if(l instanceof Ca){return{type:"tool_use",toolCallId:l.callId,name:l.name,parameters:l.input}}else if(l instanceof Ht){return{type:"text",value:l.value}}else if(l instanceof Kv){return{type:"extra_data",kind:l.kind,data:l.data}}else{if(typeof l!=="string"){throw new Error("Unexpected chat message content type llm 2")}return{type:"text",value:l}}});return{role:s,name:r,content:a}}t.from=i})(Ru||(Ru={}));var qd;(function(t){function e(n){return{kind:"markdownContent",content:Pe.from(n.value)}}t.from=e;function i(n){return new Am(Pe.to(n.content))}t.to=i})(qd||(qd={}));var Lg;(function(t){function e(n){return{kind:"codeblockUri",uri:n.value,isEdit:n.isEdit}}t.from=e;function i(n){return new Nm(b.revive(n.uri),n.isEdit)}t.to=i})(Lg||(Lg={}));var Ng;(function(t){function e(n){return{kind:"markdownVuln",content:Pe.from(n.value),vulnerabilities:n.vulnerabilities}}t.from=e;function i(n){return new Rd(Pe.to(n.content),n.vulnerabilities)}t.to=i})(Ng||(Ng={}));var Og;(function(t){function e(i){return{kind:"confirmation",title:i.title,message:i.message,data:i.data,buttons:i.buttons}}t.from=e})(Og||(Og={}));var jd;(function(t){function e(n){const{value:s,baseUri:r}=n;function o(a,l){return a.map(c=>{const u=b.joinPath(l,c.name);return{label:c.name,uri:u,children:c.children&&o(c.children,u)}})}return{kind:"treeData",treeData:{label:$s(r),uri:r,children:o(s,r)}}}t.from=e;function i(n){const s=ti(n.treeData);function r(l){return l.map(c=>{return{name:c.label,children:c.children&&r(c.children)}})}const o=s.uri;const a=s.children?r(s.children):[];return new Rm(a,o)}t.to=i})(jd||(jd={}));var Ec;(function(t){function e(n){const s=o=>b.isUri(o);const r=o=>"name"in o;return{kind:"inlineReference",name:n.title,inlineReference:s(n.value)?n.value:r(n.value)?Pa.from(n.value):Rs.from(n.value)}}t.from=e;function i(n){const s=ti(n);return new Ld(b.isUri(s.inlineReference)?s.inlineReference:"location"in s.inlineReference?Pa.to(s.inlineReference):Rs.to(s.inlineReference),n.name)}t.to=i})(Ec||(Ec={}));var Gd;(function(t){function e(n){return{kind:"progressMessage",content:Pe.from(n.value)}}t.from=e;function i(n){return new ay(n.content.value)}t.to=i})(Gd||(Gd={}));var Kd;(function(t){function e(n){return{kind:"warning",content:Pe.from(n.value)}}t.from=e;function i(n){return new Nd(n.content.value)}t.to=i})(Kd||(Kd={}));var Dw;(function(t){function e(i){return{kind:"extensions",extensions:i.extensions}}t.from=e})(Dw||(Dw={}));var kw;(function(t){function e(n){return{kind:"move",uri:n.uri,range:W.from(n.range)}}t.from=e;function i(n){return new Om(b.revive(n.uri),W.to(n.range))}t.to=i})(kw||(kw={}));var Fg;(function(t){function e(i){return{kind:"progressTask",content:Pe.from(i.value)}}t.from=e})(Fg||(Fg={}));var Iw;(function(t){function e(i){return{kind:"progressTaskResult",content:typeof i==="string"?Pe.from(i):void 0}}t.from=e})(Iw||(Iw={}));var Qd;(function(t){function e(n,s,r){const o=s.toInternal(n.value,r)??{command:n.value.command,title:n.value.title};return{kind:"command",command:o}}t.from=e;function i(n,s){return new Lm(s.fromInternal(n.command)??{command:n.command.id,title:n.command.title})}t.to=i})(Qd||(Qd={}));var Mg;(function(t){function e(n){return{kind:"textEdit",uri:n.uri,edits:n.edits.map(s=>li.from(s)),done:n.isDone}}t.from=e;function i(n){const s=new Od(b.revive(n.uri),n.edits.map(r=>li.to(r)));s.isDone=n.done;return s}t.to=i})(Mg||(Mg={}));var Ug;(function(t){function e(i){if(i.newCellMetadata){return{editType:uo.Metadata,index:i.range.start,metadata:i.newCellMetadata}}else if(i.newNotebookMetadata){return{editType:uo.DocumentMetadata,metadata:i.newNotebookMetadata}}else{return{editType:uo.Replace,index:i.range.start,count:i.range.end-i.range.start,cells:i.newCells.map(_c.from)}}}t.from=e})(Ug||(Ug={}));var $g;(function(t){function e(i){return{kind:"notebookEdit",uri:i.uri,edits:i.edits.map(Ug.from),done:i.isDone}}t.from=e})($g||($g={}));var _a;(function(t){function e(n){const s=Zt.isThemeIcon(n.iconPath)?n.iconPath:b.isUri(n.iconPath)?{light:b.revive(n.iconPath)}:n.iconPath&&"light"in n.iconPath&&"dark"in n.iconPath&&b.isUri(n.iconPath.light)&&b.isUri(n.iconPath.dark)?{light:b.revive(n.iconPath.light),dark:b.revive(n.iconPath.dark)}:void 0;if(typeof n.value==="object"&&"variableName"in n.value){return{kind:"reference",reference:{variableName:n.value.variableName,value:b.isUri(n.value.value)||!n.value.value?n.value.value:Rs.from(n.value.value)},iconPath:s,options:n.options}}return{kind:"reference",reference:b.isUri(n.value)||typeof n.value==="string"?n.value:Rs.from(n.value),iconPath:s,options:n.options}}t.from=e;function i(n){const s=ti(n);const r=o=>b.isUri(o)?o:Rs.to(o);return new fa(typeof s.reference==="string"?s.reference:"variableName"in s.reference?{variableName:s.reference.variableName,value:s.reference.value&&r(s.reference.value)}:r(s.reference))}t.to=i})(_a||(_a={}));var Hg;(function(t){function e(i){return{kind:"codeCitation",value:i.value,license:i.license,snippet:i.snippet}}t.from=e})(Hg||(Hg={}));var Bg;(function(t){function e(s,r,o){if(s instanceof Am){return qd.from(s)}else if(s instanceof Ld){return Ec.from(s)}else if(s instanceof fa){return _a.from(s)}else if(s instanceof ay){return Gd.from(s)}else if(s instanceof Rm){return jd.from(s)}else if(s instanceof Lm){return Qd.from(s,r,o)}else if(s instanceof Od){return Mg.from(s)}else if(s instanceof fg){return $g.from(s)}else if(s instanceof Rd){return Ng.from(s)}else if(s instanceof Nm){return Lg.from(s)}else if(s instanceof Nd){return Kd.from(s)}else if(s instanceof dg){return Og.from(s)}else if(s instanceof hg){return Hg.from(s)}else if(s instanceof Om){return kw.from(s)}else if(s instanceof ly){return Dw.from(s)}return{kind:"markdownContent",content:Pe.from("")}}t.from=e;function i(s,r){switch(s.kind){case"reference":return _a.to(s);case"markdownContent":case"inlineReference":case"progressMessage":case"treeData":case"command":return n(s,r)}return void 0}t.to=i;function n(s,r){switch(s.kind){case"markdownContent":return qd.to(s);case"inlineReference":return Ec.to(s);case"progressMessage":return void 0;case"treeData":return jd.to(s);case"command":return Qd.to(s,r)}return void 0}t.toContent=n})(Bg||(Bg={}));var Vg;(function(t){function e(i,n,s,r,o,a,l,c){const u=i.variables.variables.filter(f=>f.kind==="tool");const d=i.variables.variables.filter(f=>f.kind!=="tool");const p={id:i.requestId,prompt:i.message,command:i.command,attempt:i.attempt??0,enableCommandDetection:i.enableCommandDetection??true,isParticipantDetected:i.isParticipantDetected??false,references:d.map(f=>Wg.to(f,r,c)).filter(ln),toolReferences:u.map(zg.to),location:Jd.to(i.location),acceptedConfirmationData:i.acceptedConfirmationData,rejectedConfirmationData:i.rejectedConfirmationData,location2:n,toolInvocationToken:Object.freeze({sessionId:i.sessionId}),toolSelection:o,tools:a,model:s,editedFileEvents:i.editedFileEvents};if(!dt(l,"chatParticipantPrivate")){delete p.id;delete p.attempt;delete p.enableCommandDetection;delete p.isParticipantDetected;delete p.location;delete p.location2;delete p.editedFileEvents}if(!dt(l,"chatParticipantAdditions")){delete p.acceptedConfirmationData;delete p.rejectedConfirmationData;delete p.tools}return p}t.to=e})(Vg||(Vg={}));var Cw;(function(t){function e(i){return{prompt:i.prompt,files:i.files.map(n=>b.revive(n))}}t.to=e})(Cw||(Cw={}));var Jd;(function(t){function e(n){switch(n){case $i.Notebook:return Jn.Notebook;case $i.Terminal:return Jn.Terminal;case $i.Panel:return Jn.Panel;case $i.Editor:return Jn.Editor}}t.to=e;function i(n){switch(n){case Jn.Notebook:return $i.Notebook;case Jn.Terminal:return $i.Terminal;case Jn.Panel:return $i.Panel;case Jn.Editor:return $i.Editor}}t.from=i})(Jd||(Jd={}));var Wg;(function(t){function e(i,n,s){let r=i.value;if(!r){let o;try{o=JSON.stringify(i)}catch{o=`kind=${i.kind}, id=${i.id}, name=${i.name}`}s.error(`[ChatPromptReference] Ignoring invalid reference in variable: ${o}`);return void 0}if(Of(r)){r=b.revive(r)}else if(r&&typeof r==="object"&&"uri"in r&&"range"in r&&Of(r.uri)){r=Rs.to(ti(r))}else if(pR(i)){const o=i.references?.[0]?.reference;r=new oC(i.mimeType??"image/png",()=>Promise.resolve(new Uint8Array(Object.values(i.value))),o&&b.isUri(o)?o:void 0)}else if(i.kind==="diagnostic"){const o=i.filterSeverity&&Ud.to(i.filterSeverity);const a=i.filterUri&&b.revive(i.filterUri).toString();r=new aC(n.map(([l,c])=>{if(i.filterUri&&l.toString()!==a){return[l,[]]}return[l,c.filter(u=>{if(o&&u.severity>o){return false}if(i.filterRange&&!et.areIntersectingOrTouching(i.filterRange,W.from(u.range))){return false}return true})]}).filter(([,l])=>l.length>0))}return{id:i.id,name:i.name,range:i.range&&[i.range.start,i.range.endExclusive],value:r,modelDescription:i.modelDescription}}t.to=e})(Wg||(Wg={}));var zg;(function(t){function e(i){const n=i.value;if(n){throw new Error("Invalid tool reference")}return{name:i.id,range:i.range&&[i.range.start,i.range.endExclusive]}}t.to=e})(zg||(zg={}));var Tw;(function(t){function e(i,n,s){return{id:i.id,label:i.label,fullName:i.fullName,icon:i.icon?.id,value:i.values[0].value,insertText:i.insertText,detail:i.detail,documentation:i.documentation,command:n.toInternal(i.command,s)}}t.from=e})(Tw||(Tw={}));var $l;(function(t){function e(s){return{errorDetails:s.errorDetails,metadata:n(s.metadata),nextQuestion:s.nextQuestion}}t.to=e;function i(s){return{errorDetails:s.errorDetails,metadata:s.metadata,nextQuestion:s.nextQuestion}}t.from=i;function n(s){return Kl(s,r=>{if(r.$mid===it.LanguageModelToolResult){return new Fm(Kl(r.content,n))}else if(r.$mid===it.LanguageModelTextPart){return new Ht(r.value)}else if(r.$mid===it.LanguageModelPromptTsxPart){return new Ms(r.value)}return void 0})}})($l||($l={}));var Pw;(function(t){function e(i,n,s){if(n.action.kind==="vote"){return}const r=$l.to(i);if(n.action.kind==="command"){const o=n.action.commandButton.command;const a={command:s.fromInternal(o)??{command:o.id,title:o.title}};const l={kind:"command",commandButton:a};return{action:l,result:r}}else if(n.action.kind==="followUp"){const o={kind:"followUp",followup:zd.to(n.action.followup)};return{action:o,result:r}}else if(n.action.kind==="inlineChat"){return{action:{kind:"editor",accepted:n.action.action==="accepted"},result:r}}else if(n.action.kind==="chatEditingSessionAction"){const o=new Map([["accepted",Zo.Accepted],["rejected",Zo.Rejected],["saved",Zo.Saved]]);return{action:{kind:"chatEditingSessionAction",outcome:o.get(n.action.outcome)??Zo.Rejected,uri:b.revive(n.action.uri),hasRemainingEdits:n.action.hasRemainingEdits},result:r}}else{return{action:n.action,result:r}}}t.to=e})(Pw||(Pw={}));var qg;(function(t){function e(i,n,s){if("terminalCommand"in i){return{terminalCommand:i.terminalCommand,shouldExecute:i.shouldExecute}}if("uri"in i){return{uri:i.uri}}return n.toInternal(i,s)}t.from=e})(qg||(qg={}));var jg;(function(t){function e(i){return{...i,documentation:Pe.fromStrict(i.documentation)}}t.from=e})(jg||(jg={}));var Aw;(function(t){function e(i){if(Array.isArray(i)){return{items:i.map(n=>jg.from(n))}}return{items:i.items.map(n=>jg.from(n)),resourceRequestConfig:i.resourceRequestConfig?Rw.from(i.resourceRequestConfig):void 0}}t.from=e})(Aw||(Aw={}));var Rw;(function(t){function e(i){return{...i,pathSeparator:Yi?"\\":"/",cwd:i.cwd?b.revive(i.cwd):void 0}}t.from=e})(Rw||(Rw={}));var Lw;(function(t){function e(i){return{kind:Nw.to(i.kind),acceptedLength:i.acceptedLength}}t.to=e})(Lw||(Lw={}));var Nw;(function(t){function e(i){switch(i){case wu.Word:return Ko.Word;case wu.Line:return Ko.Line;case wu.Suggest:return Ko.Suggest;default:return Ko.Unknown}}t.to=e})(Nw||(Nw={}));var Ow;(function(t){function e(i,n){if(i.kind===Xf.Ignored){const s=i.supersededBy?n(i.supersededBy):void 0;return{kind:Tl.Ignored,supersededBy:s,userTypingDisagreed:i.userTypingDisagreed}}else if(i.kind===Xf.Accepted){return{kind:Tl.Accepted}}return{kind:Tl.Rejected}}t.to=e})(Ow||(Ow={}));var Fw;(function(t){function e(i,n){return{id:n,label:i.label,description:i.description,canEdit:i.canEdit,collapsibleState:i.collapsibleState||W_.None,contextValue:i.contextValue}}t.from=e})(Fw||(Fw={}));var dS;(function(t){function e(i){return{name:i.id,description:i.modelDescription,inputSchema:i.inputSchema,tags:i.tags??[]}}t.to=e})(dS||(dS={}));var hS;(function(t){function e(n){return new Fm(n.content.map(s=>{if(s.kind==="text"){return new Ht(s.value)}else{return new Ms(s.value)}}))}t.to=e;function i(n,s){if(n.toolResultMessage){$(s,"chatParticipantPrivate")}return{content:n.content.map(r=>{if(r instanceof Ht){return{kind:"text",value:r.value}}else if(r instanceof Ms){return{kind:"promptTsx",value:r.value}}else{throw new Error("Unknown LanguageModelToolResult part type")}}),toolResultMessage:Pe.fromStrict(n.toolResultMessage),toolResultDetails:n.toolResultDetails?.map(r=>b.isUri(r)?r:Rs.from(r))}}t.from=i})(hS||(hS={}));var Gg;(function(t){function e(n){return new uC(n.content.map(s=>{if(s.kind==="text"){return new Ht(s.value)}else if(s.kind==="data"){const r=Object.values(gg).includes(s.value.mimeType)?s.value.mimeType:void 0;if(!r){throw new Error("Invalid MIME type")}return new On(s.value.data.buffer,r)}else{return new Ms(s.value)}}))}t.to=e;function i(n,s){if(n.toolResultMessage){$(s,"chatParticipantPrivate")}let r=false;const o={content:n.content.map(a=>{if(a instanceof Ht){return{kind:"text",value:a.value}}else if(a instanceof Ms){return{kind:"promptTsx",value:a.value}}else if(a instanceof On){r=true;return{kind:"data",value:{mimeType:a.mimeType,data:ue.wrap(a.data)}}}else{throw new Error("Unknown LanguageModelToolResult part type")}}),toolResultMessage:Pe.fromStrict(n.toolResultMessage),toolResultDetails:n.toolResultDetails?.map(a=>b.isUri(a)?a:Rs.from(a))};return r?new Bi(o):o}t.from=i})(Gg||(Gg={}));var Mw;(function(t){function e(i){return i}t.fromThemeIcon=e})(Mw||(Mw={}));var Uw;(function(t){function e(n){return{query:n.query,kind:i(n.kind),settings:n.settings}}t.fromSettingsSearchResult=e;function i(n){switch(n){case Br.EMBEDDED:return Br.EMBEDDED;case Br.LLM_RANKED:return Br.LLM_RANKED;case Br.CANCELED:return Br.CANCELED;default:throw new Error("Unknown AiSettingsSearchResultKind")}}})(Uw||(Uw={}));var Lu;(function(t){function e(n){return!!n.uri}function i(n){return Md.toSerialized(e(n)?{type:Ta.HTTP,uri:n.uri,headers:Object.entries(n.headers)}:{type:Ta.Stdio,cwd:n.cwd,args:n.args,command:n.command,env:n.env,envFile:void 0})}t.from=i})(Lu||(Lu={}));class ro{constructor(e,i,n){this.uri=e;this.ranges=i;this.previewText=n}}class cy{constructor(e,i,n){this.uri=e;this.text=i;this.lineNumber=n}}class $w{constructor(e){this.keyword=e}}var ar;(function(t){t[t["None"]=1]="None";t[t["FilesExclude"]=2]="FilesExclude";t[t["SearchAndFilesExclude"]=3]="SearchAndFilesExclude"})(ar||(ar={}));var Kg;(function(t){t[t["Information"]=1]="Information";t[t["Warning"]=2]="Warning"})(Kg||(Kg={}));const hC=2e4;const fC=" ";const pC=" characters skipped ";const L3=(fC.length+pC.length+5)*2;var fS;(function(t){t[t["file"]=0]="file";t[t["text"]=1]="text";t[t["aiText"]=2]="aiText"})(fS||(fS={}));var va;(function(t){t[t["File"]=1]="File";t[t["Text"]=2]="Text";t[t["aiText"]=3]="aiText"})(va||(va={}));function pS(t){return!!t.rangeLocations&&!!t.previewText}var gS;(function(t){t[t["Normal"]=0]="Normal";t[t["NewSearchStarted"]=1]="NewSearchStarted"})(gS||(gS={}));class N3{constructor(e,i,n,s){this.rangeLocations=[];this.webviewIndex=s;const r=Array.isArray(i)?i:[i];if(n&&n.matchLines===1&&O3(r)){e=uP(e,n.matchLines);let o="";let a=0;let l=0;const c=Math.floor(n.charsPerLine/5);for(const u of r){const d=Math.max(u.startColumn-c,0);const p=u.startColumn+n.charsPerLine;if(d>l+c+L3){const f=fC+(d-l)+pC;o+=f+e.slice(d,p);a+=d-(l+f.length)}else{o+=e.slice(l,p)}l=p;this.rangeLocations.push({source:u,preview:new F3(0,u.startColumn-a,u.endColumn-a)})}this.previewText=o}else{const o=Array.isArray(i)?i[0].startLineNumber:i.startLineNumber;const a=Z1(i,l=>({preview:new gC(l.startLineNumber-o,l.startColumn,l.endLineNumber-o,l.endColumn),source:l}));this.rangeLocations=Array.isArray(a)?a:[a];this.previewText=e}}}function O3(t){const e=t[0].startLineNumber;for(const i of t){if(i.startLineNumber!==e||i.endLineNumber!==e){return false}}return true}class gC{constructor(e,i,n,s){this.startLineNumber=e;this.startColumn=i;this.endLineNumber=n;this.endColumn=s}}class F3 extends gC{constructor(e,i,n){super(e,i,e,n)}}var mS;(function(t){t["List"]="list";t["Tree"]="tree"})(mS||(mS={}));var _S;(function(t){t["Default"]="default";t["FileNames"]="fileNames";t["Type"]="type";t["Modified"]="modified";t["CountDescending"]="countDescending";t["CountAscending"]="countAscending"})(_S||(_S={}));function M3(t,e=true){const i=t&&t.files&&t.files.exclude;const n=e&&t&&t.search&&t.search.exclude;if(!i&&!n){return void 0}if(!i||!n){return i||n||void 0}let s=Object.create(null);s=Ea(s,vt(i));s=Ea(s,vt(n),true);return s}function vS(t,e){if(t.excludePattern&&Su(t.excludePattern,e)){return false}if(t.includePattern||t.usingSearchPaths){if(t.includePattern&&Su(t.includePattern,e)){return true}if(t.usingSearchPaths){return!!t.folderQueries&&t.folderQueries.some(i=>{const n=i.folder.fsPath;if(Uf(e,n)){const s=Ku(n,e);return!i.includePattern||!!Su(i.includePattern,s)}else{return false}})}return false}return true}var wS;(function(t){t[t["unknownEncoding"]=1]="unknownEncoding";t[t["regexParseError"]=2]="regexParseError";t[t["globParseError"]=3]="globParseError";t[t["invalidLiteral"]=4]="invalidLiteral";t[t["rgProcessError"]=5]="rgProcessError";t[t["other"]=6]="other";t[t["canceled"]=7]="canceled"})(wS||(wS={}));function Hl(t,e){const i={...t||{},...e||{}};return Object.keys(i).filter(n=>{const s=i[n];return typeof s==="boolean"&&s})}class mC{constructor(e,i){this._parsedIncludeExpression=null;this._excludeExpression=i.excludePattern?.map(s=>{return{...e.excludePattern||{},...s.pattern||{}}})??[];if(this._excludeExpression.length===0){this._excludeExpression=[e.excludePattern||{}]}this._parsedExcludeExpression=this._excludeExpression.map(s=>Yl(s));let n=e.includePattern;if(i.includePattern){if(n){n={...n,...i.includePattern}}else{n=i.includePattern}}if(n){this._parsedIncludeExpression=Yl(n)}}_evalParsedExcludeExpression(e,i,n){let s=null;for(const r of this._parsedExcludeExpression){const o=r(e,i,n);if(typeof o==="string"){s=o;break}}return s}matchesExcludesSync(e,i,n){if(this._parsedExcludeExpression&&this._evalParsedExcludeExpression(e,i,n)){return true}return false}includedInQuerySync(e,i,n){if(this._parsedExcludeExpression&&this._evalParsedExcludeExpression(e,i,n)){return false}if(this._parsedIncludeExpression&&!this._parsedIncludeExpression(e,i,n)){return false}return true}includedInQuery(e,i,n){const s=()=>{return this._parsedIncludeExpression?!!this._parsedIncludeExpression(e,i,n):true};return Promise.all(this._parsedExcludeExpression.map(r=>{const o=r(e,i,n);if(po(o)){return o.then(a=>{if(a){return false}return s()})}return s()})).then(r=>r.some(o=>!!o))}hasSiblingExcludeClauses(){return this._excludeExpression.reduce((e,i)=>U3(i)||e,false)}}function U3(t){for(const e in t){if(typeof t[e]!=="boolean"){return true}}return false}function $3(t){if(!t){return void 0}let e;return i=>{if(!e){e=(t()||Promise.resolve([])).then(n=>n?_C(n):{})}return e.then(n=>!!n[i])}}function H3(t){if(!t){return void 0}let e;return i=>{if(!e){const n=t();e=n?_C(n):{}}return!!e[i]}}function _C(t){const e={};for(const i of t){e[i]=true}return e}function vC(t){return t.flatMap(e=>e.patterns.map(i=>{return e.baseUri?{baseUri:e.baseUri,pattern:i}:i}))}const Hw={matchLines:100,charsPerLine:1e4};const Um="utf8";const uy="utf8bom";const Qg="utf16be";const Jg="utf16le";const gf=[254,255];const Bw=[255,254];const au=[239,187,191];const B3=512;const V3=512;const W3=512*8;const z3=512*128;var Vw;(function(t){t[t["STREAM_IS_BINARY"]=1]="STREAM_IS_BINARY"})(Vw||(Vw={}));class q3 extends Error{constructor(e,i){super(e);this.decodeStreamErrorKind=i}}class dy{static async create(e){let i=void 0;if(e!==Um){const n=await import("./iconv-lite-umd-DbvBzBJR.js").then(function(s){return s.i}).then(s=>s.default??s);i=n.getDecoder(wC(e))}else{const n=new TextDecoder;i={write(s){return n.decode(s,{stream:true})},end(){return n.decode()}}}return new dy(i)}constructor(e){this.iconvLiteDecoder=e}write(e){return this.iconvLiteDecoder.write(e)}end(){return this.iconvLiteDecoder.end()}}function j3(t,e){const i=e.minBytesRequiredForDetection??e.guessEncoding?W3:V3;return new Promise((n,s)=>{const r=Wk(d=>d.join(""));const o=[];let a=0;let l=void 0;const c=new Ot;const u=async()=>{try{const d=await t6({buffer:ue.concat(o),bytesRead:a},e.guessEncoding,e.candidateGuessEncodings);if(d.seemsBinary&&e.acceptTextOnly){throw new q3("Stream is binary but only text is accepted for decoding",Vw.STREAM_IS_BINARY)}d.encoding=await e.overwriteEncoding(d.encoding);l=await dy.create(d.encoding);const p=l.write(ue.concat(o).buffer);r.write(p);o.length=0;a=0;n({stream:r,detected:d})}catch(d){c.cancel();r.destroy();s(d)}};qk(t,{onData:async d=>{if(l){r.write(l.write(d.buffer))}else{o.push(d);a+=d.byteLength;if(a>=i){t.pause();await u();setTimeout(()=>t.resume())}}},onError:d=>r.error(d),onEnd:async()=>{if(!l){await u()}r.end(l?.end())}},c.token)})}async function G3(t,e,i){const n=await import("./iconv-lite-umd-DbvBzBJR.js").then(function(a){return a.i}).then(a=>a.default??a);const s=n.getEncoder(wC(e),i);let r=false;let o=false;return{read(){if(o){return null}const a=t.read();if(typeof a!=="string"){o=true;if(!r&&i?.addBOM){switch(e){case Um:case uy:return ue.wrap(Uint8Array.from(au));case Qg:return ue.wrap(Uint8Array.from(gf));case Jg:return ue.wrap(Uint8Array.from(Bw))}}const l=s.end();if(l&&l.length>0){r=true;return ue.wrap(l)}return null}r=true;return ue.wrap(s.write(a))}}}function wC(t){if(t===uy||t===null){return Um}return t}function K3(t,e){if(!t||e<gf.length){return null}const i=t.readUInt8(0);const n=t.readUInt8(1);if(i===gf[0]&&n===gf[1]){return Qg}if(i===Bw[0]&&n===Bw[1]){return Jg}if(e<au.length){return null}const s=t.readUInt8(2);if(i===au[0]&&n===au[1]&&s===au[2]){return uy}return null}const Q3=["ascii","utf-16","utf-32"];async function J3(t,e){const i=await import("./index-CZnbfzTA.js").then(function(a){return a.i}).then(a=>a.default??a);const n=t.slice(0,z3);const s=e6(n.buffer);if(e){e=ei(e.map(a=>Z3(a)));if(e.length===0){e=void 0}}let r;try{r=i.detect(s,e?{detectEncodings:e}:void 0)}catch(a){return null}if(!r||!r.encoding){return null}const o=r.encoding.toLowerCase();if(0<=Q3.indexOf(o)){return null}return Y3(r.encoding)}const X3={"ibm866":"cp866","big5":"cp950"};function bC(t){return t.replace(/[^a-zA-Z0-9]/g,"").toLowerCase()}function Y3(t){const e=bC(t);const i=X3[e];return i||e}function Z3(t){const e=bC(t);const i=i6[e];return i?i.guessableName:void 0}function e6(t){let e="";for(let i=0;i<t.length;i++){e+=String.fromCharCode(t[i])}return e}function t6({buffer:t,bytesRead:e},i,n){let s=K3(t,e);let r=false;if(s!==Qg&&s!==Jg&&t){let o=true;let a=true;let l=false;for(let c=0;c<e&&c<B3;c++){const u=c%2===1;const d=t.readUInt8(c)===0;if(d){l=true}if(o&&(u&&!d||!u&&d)){o=false}if(a&&(u&&d||!u&&!d)){a=false}if(d&&!o&&!a){break}}if(l){if(o){s=Jg}else if(a){s=Qg}else{r=true}}}if(i&&!r&&!s&&t){return J3(t.slice(0,e),n).then(o=>{return{seemsBinary:false,encoding:o}})}return{seemsBinary:r,encoding:s}}const C1={utf8:{labelLong:"UTF-8",labelShort:"UTF-8",order:1,alias:"utf8bom",guessableName:"UTF-8"},utf8bom:{labelLong:"UTF-8 with BOM",labelShort:"UTF-8 with BOM",encodeOnly:true,order:2,alias:"utf8"},utf16le:{labelLong:"UTF-16 LE",labelShort:"UTF-16 LE",order:3,guessableName:"UTF-16LE"},utf16be:{labelLong:"UTF-16 BE",labelShort:"UTF-16 BE",order:4,guessableName:"UTF-16BE"},windows1252:{labelLong:"Western (Windows 1252)",labelShort:"Windows 1252",order:5,guessableName:"windows-1252"},iso88591:{labelLong:"Western (ISO 8859-1)",labelShort:"ISO 8859-1",order:6},iso88593:{labelLong:"Western (ISO 8859-3)",labelShort:"ISO 8859-3",order:7},iso885915:{labelLong:"Western (ISO 8859-15)",labelShort:"ISO 8859-15",order:8},macroman:{labelLong:"Western (Mac Roman)",labelShort:"Mac Roman",order:9},cp437:{labelLong:"DOS (CP 437)",labelShort:"CP437",order:10},windows1256:{labelLong:"Arabic (Windows 1256)",labelShort:"Windows 1256",order:11},iso88596:{labelLong:"Arabic (ISO 8859-6)",labelShort:"ISO 8859-6",order:12},windows1257:{labelLong:"Baltic (Windows 1257)",labelShort:"Windows 1257",order:13},iso88594:{labelLong:"Baltic (ISO 8859-4)",labelShort:"ISO 8859-4",order:14},iso885914:{labelLong:"Celtic (ISO 8859-14)",labelShort:"ISO 8859-14",order:15},windows1250:{labelLong:"Central European (Windows 1250)",labelShort:"Windows 1250",order:16,guessableName:"windows-1250"},iso88592:{labelLong:"Central European (ISO 8859-2)",labelShort:"ISO 8859-2",order:17,guessableName:"ISO-8859-2"},cp852:{labelLong:"Central European (CP 852)",labelShort:"CP 852",order:18},windows1251:{labelLong:"Cyrillic (Windows 1251)",labelShort:"Windows 1251",order:19,guessableName:"windows-1251"},cp866:{labelLong:"Cyrillic (CP 866)",labelShort:"CP 866",order:20,guessableName:"IBM866"},cp1125:{labelLong:"Cyrillic (CP 1125)",labelShort:"CP 1125",order:21,guessableName:"IBM1125"},iso88595:{labelLong:"Cyrillic (ISO 8859-5)",labelShort:"ISO 8859-5",order:22,guessableName:"ISO-8859-5"},koi8r:{labelLong:"Cyrillic (KOI8-R)",labelShort:"KOI8-R",order:23,guessableName:"KOI8-R"},koi8u:{labelLong:"Cyrillic (KOI8-U)",labelShort:"KOI8-U",order:24},iso885913:{labelLong:"Estonian (ISO 8859-13)",labelShort:"ISO 8859-13",order:25},windows1253:{labelLong:"Greek (Windows 1253)",labelShort:"Windows 1253",order:26,guessableName:"windows-1253"},iso88597:{labelLong:"Greek (ISO 8859-7)",labelShort:"ISO 8859-7",order:27,guessableName:"ISO-8859-7"},windows1255:{labelLong:"Hebrew (Windows 1255)",labelShort:"Windows 1255",order:28,guessableName:"windows-1255"},iso88598:{labelLong:"Hebrew (ISO 8859-8)",labelShort:"ISO 8859-8",order:29,guessableName:"ISO-8859-8"},iso885910:{labelLong:"Nordic (ISO 8859-10)",labelShort:"ISO 8859-10",order:30},iso885916:{labelLong:"Romanian (ISO 8859-16)",labelShort:"ISO 8859-16",order:31},windows1254:{labelLong:"Turkish (Windows 1254)",labelShort:"Windows 1254",order:32},iso88599:{labelLong:"Turkish (ISO 8859-9)",labelShort:"ISO 8859-9",order:33},windows1258:{labelLong:"Vietnamese (Windows 1258)",labelShort:"Windows 1258",order:34},gbk:{labelLong:"Simplified Chinese (GBK)",labelShort:"GBK",order:35},gb18030:{labelLong:"Simplified Chinese (GB18030)",labelShort:"GB18030",order:36},cp950:{labelLong:"Traditional Chinese (Big5)",labelShort:"Big5",order:37,guessableName:"Big5"},big5hkscs:{labelLong:"Traditional Chinese (Big5-HKSCS)",labelShort:"Big5-HKSCS",order:38},shiftjis:{labelLong:"Japanese (Shift JIS)",labelShort:"Shift JIS",order:39,guessableName:"SHIFT_JIS"},eucjp:{labelLong:"Japanese (EUC-JP)",labelShort:"EUC-JP",order:40,guessableName:"EUC-JP"},euckr:{labelLong:"Korean (EUC-KR)",labelShort:"EUC-KR",order:41,guessableName:"EUC-KR"},windows874:{labelLong:"Thai (Windows 874)",labelShort:"Windows 874",order:42},iso885911:{labelLong:"Latin/Thai (ISO 8859-11)",labelShort:"ISO 8859-11",order:43},koi8ru:{labelLong:"Cyrillic (KOI8-RU)",labelShort:"KOI8-RU",order:44},koi8t:{labelLong:"Tajik (KOI8-T)",labelShort:"KOI8-T",order:45},gb2312:{labelLong:"Simplified Chinese (GB 2312)",labelShort:"GB 2312",order:46,guessableName:"GB2312"},cp865:{labelLong:"Nordic DOS (CP 865)",labelShort:"CP 865",order:47},cp850:{labelLong:"Western European DOS (CP 850)",labelShort:"CP 850",order:48}};const i6=(()=>{const t={};for(const e in C1){if(C1[e].guessableName){t[e]=C1[e]}}return t})();var bS;(function(t){t[t["FILE_IS_BINARY"]=0]="FILE_IS_BINARY"})(bS||(bS={}));var yS;(function(t){t[t["SAVED"]=0]="SAVED";t[t["DIRTY"]=1]="DIRTY";t[t["PENDING_SAVE"]=2]="PENDING_SAVE";t[t["CONFLICT"]=3]="CONFLICT";t[t["ORPHAN"]=4]="ORPHAN";t[t["ERROR"]=5]="ERROR"})(yS||(yS={}));var xS;(function(t){t[t["EDITOR"]=1]="EDITOR";t[t["REFERENCE"]=2]="REFERENCE";t[t["OTHER"]=3]="OTHER"})(xS||(xS={}));var ES;(function(t){t[t["Encode"]=0]="Encode";t[t["Decode"]=1]="Decode"})(ES||(ES={}));function n6(t){let e=false;return{read(){if(!e){e=true;return t}return null}}}function Xd(t,e,i){return new lh(n=>hy(n,i)).isEqual(t,e)}function s6(t,e,i){return Xd(t.uri,e.uri,i)?0:xa(t.uri.toString(),e.uri.toString())}function r6(t,e,i){if(t.index!==e.index){return t.index<e.index?-1:1}return Xd(t.uri,e.uri,i)?xa(t.name,e.name):xa(t.uri.toString(),e.uri.toString())}function yC(t,e,i,n){const s=t.slice(0).sort((o,a)=>i(o,a,n));const r=e.slice(0).sort((o,a)=>i(o,a,n));return S5(s,r,(o,a)=>i(o,a,n))}function hy(t,e){const i=e.getCapabilities(t.scheme);return!(i&&i&ws.PathCaseSensitive)}class Bl extends l7{static toExtHostWorkspace(e,i,n,s){if(!e){return{workspace:null,added:[],removed:[]}}const{id:r,name:o,folders:a,configuration:l,transient:c,isUntitled:u}=e;const d=[];const p=i;if(i){a.forEach((y,D)=>{const I=b.revive(y.uri);const R=Bl._findFolder(n||i,I,s);if(R){R.name=y.name;R.index=y.index;d.push(R)}else{d.push({uri:I,name:y.name,index:D})}})}else{d.push(...a.map(({uri:y,name:D,index:I})=>({uri:b.revive(y),name:D,index:I})))}d.sort((y,D)=>y.index<D.index?-1:1);const f=new Bl(r,o,d,!!c,l?b.revive(l):null,!!u,y=>hy(y,s));const{added:m,removed:v}=yC(p?p.workspaceFolders:[],f.workspaceFolders,s6,s);return{workspace:f,added:m,removed:v}}static _findFolder(e,i,n){for(let s=0;s<e.folders.length;s++){const r=e.workspaceFolders[s];if(Xd(r.uri,i,n)){return r}}return void 0}constructor(e,i,n,s,r,o,a){super(e,n.map(l=>new PI(l)),s,r,a);this._name=i;this._isUntitled=o;this._workspaceFolders=[];this._structure=xn.forUris(a,()=>true);n.forEach(l=>{this._workspaceFolders.push(l);this._structure.set(l.uri,l)})}get name(){return this._name}get isUntitled(){return this._isUntitled}get workspaceFolders(){return this._workspaceFolders.slice(0)}getWorkspaceFolder(e,i){if(i&&this._structure.get(e)){e=vm(e)}return this._structure.findSubstr(e)}resolveWorkspaceFolder(e){return this._structure.get(e)}}let Ww=class l${constructor(e,i,n,s,r){this._onDidChangeWorkspace=new L;this.onDidChangeWorkspace=this._onDidChangeWorkspace.event;this._onDidGrantWorkspaceTrust=new L;this.onDidGrantWorkspaceTrust=this._onDidGrantWorkspaceTrust.event;this._activeSearchCallbacks=[];this._trusted=false;this._editSessionIdentityProviders=new Map;this._providerHandlePool=0;this._onWillCreateEditSessionIdentityEvent=new hu;this._canonicalUriProviders=new Map;this._logService=s;this._extHostFileSystemInfo=n;this._uriTransformerService=r;this._requestIdProvider=new n7;this._barrier=new xs;this._proxy=e.getProxy(Y.MainThreadWorkspace);this._messageService=e.getProxy(Y.MainThreadMessageService);const o=i.workspace;this._confirmedWorkspace=o?new Bl(o.id,o.name,[],!!o.transient,o.configuration?b.revive(o.configuration):null,!!o.isUntitled,a=>hy(a,n)):void 0}$initializeWorkspace(e,i){this._trusted=i;this.$acceptWorkspaceData(e);this._barrier.open()}waitForInitializeCall(){return this._barrier.wait()}get workspace(){return this._actualWorkspace}get name(){return this._actualWorkspace?this._actualWorkspace.name:void 0}get workspaceFile(){if(this._actualWorkspace){if(this._actualWorkspace.configuration){if(this._actualWorkspace.isUntitled){return b.from({scheme:ae.untitled,path:$s(vm(this._actualWorkspace.configuration))})}return this._actualWorkspace.configuration}}return void 0}get _actualWorkspace(){return this._unconfirmedWorkspace||this._confirmedWorkspace}getWorkspaceFolders(){if(!this._actualWorkspace){return void 0}return this._actualWorkspace.workspaceFolders.slice(0)}async getWorkspaceFolders2(){await this._barrier.wait();if(!this._actualWorkspace){return void 0}return this._actualWorkspace.workspaceFolders.slice(0)}updateWorkspaceFolders(e,i,n,...s){const r=[];if(Array.isArray(s)){s.forEach(u=>{if(b.isUri(u.uri)&&!r.some(d=>Xd(d.uri,u.uri,this._extHostFileSystemInfo))){r.push({uri:u.uri,name:u.name||f_(u.uri)})}})}if(!!this._unconfirmedWorkspace){return false}if([i,n].some(u=>typeof u!=="number"||u<0)){return false}if(n===0&&r.length===0){return false}const o=this._actualWorkspace?this._actualWorkspace.workspaceFolders:[];if(i+n>o.length){return false}const a=o.slice(0);a.splice(i,n,...r.map(u=>({uri:u.uri,name:u.name||f_(u.uri),index:void 0})));for(let u=0;u<a.length;u++){const d=a[u];if(a.some((p,f)=>f!==u&&Xd(d.uri,p.uri,this._extHostFileSystemInfo))){return false}}a.forEach((u,d)=>u.index=d);const{added:l,removed:c}=yC(o,a,r6,this._extHostFileSystemInfo);if(l.length===0&&c.length===0){return false}if(this._proxy){const u=e.displayName||e.name;this._proxy.$updateWorkspaceFolders(u,i,n,r).then(void 0,d=>{this._unconfirmedWorkspace=void 0;const p={source:{identifier:e.identifier,label:e.displayName||e.name}};this._messageService.$showMessage(jt.Error,h(2573,"Extension '{0}' failed to update workspace folders: {1}",u,d.toString()),p,[])})}this.trySetWorkspaceFolders(a);return true}getWorkspaceFolder(e,i){if(!this._actualWorkspace){return void 0}return this._actualWorkspace.getWorkspaceFolder(e,i)}async getWorkspaceFolder2(e,i){await this._barrier.wait();if(!this._actualWorkspace){return void 0}return this._actualWorkspace.getWorkspaceFolder(e,i)}async resolveWorkspaceFolder(e){await this._barrier.wait();if(!this._actualWorkspace){return void 0}return this._actualWorkspace.resolveWorkspaceFolder(e)}getPath(){if(!this._actualWorkspace){return void 0}const{folders:e}=this._actualWorkspace;if(e.length===0){return void 0}return e[0].uri.fsPath}getRelativePath(e,i){let n;let s="";if(typeof e==="string"){n=b.file(e);s=e}else if(typeof e!=="undefined"){n=e;s=e.fsPath}if(!n){return s}const r=this.getWorkspaceFolder(n,true);if(!r){return s}if(typeof i==="undefined"&&this._actualWorkspace){i=this._actualWorkspace.folders.length>1}let o=mI(r.uri,n);if(i&&r.name){o=`${r.name}/${o}`}return o}trySetWorkspaceFolders(e){if(this._actualWorkspace){this._unconfirmedWorkspace=Bl.toExtHostWorkspace({id:this._actualWorkspace.id,name:this._actualWorkspace.name,configuration:this._actualWorkspace.configuration,folders:e,isUntitled:this._actualWorkspace.isUntitled},this._actualWorkspace,void 0,this._extHostFileSystemInfo).workspace||void 0}}$acceptWorkspaceData(e){const{workspace:i,added:n,removed:s}=Bl.toExtHostWorkspace(e,this._confirmedWorkspace,this._unconfirmedWorkspace,this._extHostFileSystemInfo);this._confirmedWorkspace=i||void 0;this._unconfirmedWorkspace=void 0;this._onDidChangeWorkspace.fire(Object.freeze({added:n,removed:s}))}findFiles(e,i,n,s,r=bt.None){this._logService.trace(`extHostWorkspace#findFiles: fileSearch, extension: ${s.value}, entryPoint: findFiles`);let o="";let a=true;if(i===null){a=false}else if(i!==void 0){if(typeof i==="string"){o=i}else{o=i.pattern}}return this._findFilesImpl({type:"include",value:e},{exclude:[o],maxResults:n,useExcludeSettings:a?ar.FilesExclude:ar.None,useIgnoreFiles:{local:false}},r)}findFiles2(e,i={},n,s=bt.None){this._logService.trace(`extHostWorkspace#findFiles2New: fileSearch, extension: ${n.value}, entryPoint: findFiles2New`);return this._findFilesImpl({type:"filePatterns",value:e},i,s)}async _findFilesImpl(e,i,n){if(n.isCancellationRequested){return Promise.resolve([])}const s=e.type==="include"?[e.value]:e.value??[];if(!Array.isArray(s)){console.error("Invalid file pattern provided",s);throw new Error(`Invalid file pattern provided ${JSON.stringify(s)}`)}const r=s.map(o=>{const a=SS(i.exclude);const l={ignoreSymlinks:typeof i.followSymlinks==="boolean"?!i.followSymlinks:void 0,disregardIgnoreFiles:typeof i.useIgnoreFiles?.local==="boolean"?!i.useIgnoreFiles.local:void 0,disregardGlobalIgnoreFiles:typeof i.useIgnoreFiles?.global==="boolean"?!i.useIgnoreFiles.global:void 0,disregardParentIgnoreFiles:typeof i.useIgnoreFiles?.parent==="boolean"?!i.useIgnoreFiles.parent:void 0,disregardExcludeSettings:i.useExcludeSettings!==void 0&&i.useExcludeSettings===ar.None,disregardSearchExcludeSettings:i.useExcludeSettings!==void 0&&i.useExcludeSettings!==ar.SearchAndFilesExclude,maxResults:i.maxResults,excludePattern:a.length>0?a:void 0,_reason:"startFileSearch",shouldGlobSearch:e.type==="include"?void 0:true};const c=mf(an.from(o));const u=c?.folder;if(e.type==="include"){l.includePattern=c?.pattern}else{l.filePattern=c?.pattern}return{folder:u,options:l}});return this._findFilesBase(r,n)}async _findFilesBase(e,i){const n=await Promise.all(e?.map(s=>this._proxy.$startFileSearch(s.folder??null,s.options,i).then(r=>Array.isArray(r)?r.map(o=>b.revive(o)):[]))??[]);return n.flat()}findTextInFiles2(e,i,n,s=bt.None){this._logService.trace(`extHostWorkspace#findTextInFiles2: textSearch, extension: ${n.value}, entryPoint: findTextInFiles2`);const r=p=>{if(!i){return{folder:void 0,options:{}}}const f=p?mf(an.from(p)):void 0;const m=i.exclude?SS(i.exclude):void 0;return{options:{ignoreSymlinks:typeof i.followSymlinks==="boolean"?!i.followSymlinks:void 0,disregardIgnoreFiles:typeof i.useIgnoreFiles==="boolean"?!i.useIgnoreFiles:void 0,disregardGlobalIgnoreFiles:typeof i.useIgnoreFiles?.global==="boolean"?!i.useIgnoreFiles?.global:void 0,disregardParentIgnoreFiles:typeof i.useIgnoreFiles?.parent==="boolean"?!i.useIgnoreFiles?.parent:void 0,disregardExcludeSettings:i.useExcludeSettings!==void 0&&i.useExcludeSettings===ar.None,disregardSearchExcludeSettings:i.useExcludeSettings!==void 0&&i.useExcludeSettings!==ar.SearchAndFilesExclude,fileEncoding:i.encoding,maxResults:i.maxResults,previewOptions:i.previewOptions?{matchLines:i.previewOptions?.numMatchLines??100,charsPerLine:i.previewOptions?.charsPerLine??1e4}:void 0,surroundingContext:i.surroundingContext,includePattern:f?.pattern,excludePattern:m},folder:f?.folder}};const o=i?.include?.map(p=>r(p))??[r(void 0)];const a=o.filter(p=>!!p);const l=new Ie;const c=l.add(new L);const u=this.findTextInFilesBase(e,a,(p,f)=>c.fire({result:p,uri:f}),s);const d=new Ei(async p=>{l.add(c.event(f=>{const m=f.result;const v=f.uri;if(pS(m)){p.emitOne(new ro(v,m.rangeLocations.map(y=>({previewRange:new Oe(y.preview.startLineNumber,y.preview.startColumn,y.preview.endLineNumber,y.preview.endColumn),sourceRange:new Oe(y.source.startLineNumber,y.source.startColumn,y.source.endLineNumber,y.source.endColumn)})),m.previewText))}else{p.emitOne(new cy(v,m.text,m.lineNumber))}}));await u});return{results:d,complete:u.then(p=>{l.dispose();return{limitHit:p?.limitHit??false}})}}async findTextInFilesBase(e,i,n,s=bt.None){const r=this._requestIdProvider.getNext();let o=false;s.onCancellationRequested(a=>{o=true});this._activeSearchCallbacks[r]=a=>{if(o){return}const l=b.revive(a.resource);a.results.forEach(c=>{const u=ti(c);n(u,l)})};if(s.isCancellationRequested){return{}}try{const a=await Promise.all(i?.map(l=>this._proxy.$startTextSearch(e,l.folder??null,l.options,r,s)||{})??[]);delete this._activeSearchCallbacks[r];return a.reduce((l,c)=>{return{limitHit:l?.limitHit||(c?.limitHit??false),message:[l?.message??[],c?.message??[]].flat()}},{})??{limitHit:false}}catch(a){delete this._activeSearchCallbacks[r];throw a}}async findTextInFiles(e,i,n,s,r=bt.None){this._logService.trace(`extHostWorkspace#findTextInFiles: textSearch, extension: ${s.value}, entryPoint: findTextInFiles`);const o=typeof i.previewOptions==="undefined"?{matchLines:100,charsPerLine:1e4}:i.previewOptions;const a=mf(an.from(i.include));const l=typeof i.exclude==="string"?i.exclude:i.exclude?i.exclude.pattern:void 0;const c={ignoreSymlinks:typeof i.followSymlinks==="boolean"?!i.followSymlinks:void 0,disregardIgnoreFiles:typeof i.useIgnoreFiles==="boolean"?!i.useIgnoreFiles:void 0,disregardGlobalIgnoreFiles:typeof i.useGlobalIgnoreFiles==="boolean"?!i.useGlobalIgnoreFiles:void 0,disregardParentIgnoreFiles:typeof i.useParentIgnoreFiles==="boolean"?!i.useParentIgnoreFiles:void 0,disregardExcludeSettings:typeof i.useDefaultExcludes==="boolean"?!i.useDefaultExcludes:true,disregardSearchExcludeSettings:typeof i.useSearchExclude==="boolean"?!i.useSearchExclude:true,fileEncoding:i.encoding,maxResults:i.maxResults,previewOptions:o,surroundingContext:i.afterContext,includePattern:a?.pattern,excludePattern:l?[{pattern:l}]:void 0};const u=(d,p)=>{if(pS(d)){n({uri:p,preview:{text:d.previewText,matches:Z1(d.rangeLocations,f=>new Oe(f.preview.startLineNumber,f.preview.startColumn,f.preview.endLineNumber,f.preview.endColumn))},ranges:Z1(d.rangeLocations,f=>new Oe(f.source.startLineNumber,f.source.startColumn,f.source.endLineNumber,f.source.endColumn))})}else{n({uri:p,text:d.text,lineNumber:d.lineNumber})}};return this.findTextInFilesBase(e,[{options:c,folder:a?.folder}],u,r)}$handleTextSearchResult(e,i){this._activeSearchCallbacks[i]?.(e)}async save(e){const i=await this._proxy.$save(e,{saveAs:false});return b.revive(i)}async saveAs(e){const i=await this._proxy.$save(e,{saveAs:true});return b.revive(i)}saveAll(e){return this._proxy.$saveAll(e)}resolveProxy(e){return this._proxy.$resolveProxy(e)}lookupAuthorization(e){return this._proxy.$lookupAuthorization(e)}lookupKerberosAuthorization(e){return this._proxy.$lookupKerberosAuthorization(e)}loadCertificates(){return this._proxy.$loadCertificates()}get trusted(){return this._trusted}requestWorkspaceTrust(e){return this._proxy.$requestWorkspaceTrust(e)}$onDidGrantWorkspaceTrust(){if(!this._trusted){this._trusted=true;this._onDidGrantWorkspaceTrust.fire()}}registerEditSessionIdentityProvider(e,i){if(this._editSessionIdentityProviders.has(e)){throw new Error(`A provider has already been registered for scheme ${e}`)}this._editSessionIdentityProviders.set(e,i);const n=this._uriTransformerService.transformOutgoingScheme(e);const s=this._providerHandlePool++;this._proxy.$registerEditSessionIdentityProvider(s,n);return ge(()=>{this._editSessionIdentityProviders.delete(e);this._proxy.$unregisterEditSessionIdentityProvider(s)})}async $getEditSessionIdentifier(e,i){this._logService.info("Getting edit session identifier for workspaceFolder",e);const n=await this.resolveWorkspaceFolder(b.revive(e));if(!n){this._logService.warn("Unable to resolve workspace folder");return void 0}this._logService.info("Invoking #provideEditSessionIdentity for workspaceFolder",n);const s=this._editSessionIdentityProviders.get(n.uri.scheme);this._logService.info(`Provider for scheme ${n.uri.scheme} is defined: `,!!s);if(!s){return void 0}const r=await s.provideEditSessionIdentity(n,i);this._logService.info("Provider returned edit session identifier: ",r);if(!r){return void 0}return r}async $provideEditSessionIdentityMatch(e,i,n,s){this._logService.info("Getting edit session identifier for workspaceFolder",e);const r=await this.resolveWorkspaceFolder(b.revive(e));if(!r){this._logService.warn("Unable to resolve workspace folder");return void 0}this._logService.info("Invoking #provideEditSessionIdentity for workspaceFolder",r);const o=this._editSessionIdentityProviders.get(r.uri.scheme);this._logService.info(`Provider for scheme ${r.uri.scheme} is defined: `,!!o);if(!o){return void 0}const a=await o.provideEditSessionIdentityMatch?.(i,n,s);this._logService.info("Provider returned edit session identifier match result: ",a);if(!a){return void 0}return a}getOnWillCreateEditSessionIdentityEvent(e){return(i,n,s)=>{const r=function o(a){i.call(n,a)};r.extension=e;return this._onWillCreateEditSessionIdentityEvent.event(r,void 0,s)}}async $onWillCreateEditSessionIdentity(e,i,n){const s=await this.resolveWorkspaceFolder(b.revive(e));if(s===void 0){throw new Error("Unable to resolve workspace folder")}await this._onWillCreateEditSessionIdentityEvent.fireAsync({workspaceFolder:s},i,async(r,o)=>{const a=Date.now();await Promise.resolve(r);if(Date.now()-a>n){this._logService.warn("SLOW edit session create-participant",o.extension.identifier)}});if(i.isCancellationRequested){return void 0}}registerCanonicalUriProvider(e,i){if(this._canonicalUriProviders.has(e)){throw new Error(`A provider has already been registered for scheme ${e}`)}this._canonicalUriProviders.set(e,i);const n=this._uriTransformerService.transformOutgoingScheme(e);const s=this._providerHandlePool++;this._proxy.$registerCanonicalUriProvider(s,n);return ge(()=>{this._canonicalUriProviders.delete(e);this._proxy.$unregisterCanonicalUriProvider(s)})}async provideCanonicalUri(e,i,n){const s=this._canonicalUriProviders.get(e.scheme);if(!s){return void 0}const r=await s.provideCanonicalUri?.(b.revive(e),i,n);if(!r){return void 0}return r}async $provideCanonicalUri(e,i,n){return this.provideCanonicalUri(b.revive(e),{targetScheme:i},n)}async decode(e,i){const[n,s]=this.toEncodeDecodeParameters(i);const r=await this._proxy.$resolveDecoding(n,s);const o=(await j3(eT(ue.wrap(e)),{...r,acceptTextOnly:true,overwriteEncoding:a=>{if(a===null||a===r.preferredEncoding){return Promise.resolve(r.preferredEncoding)}return this._proxy.$validateDetectedEncoding(n,a,s)}})).stream;return zk(o,a=>a.join(""))}async encode(e,i){const[n,s]=this.toEncodeDecodeParameters(i);const{encoding:r,addBOM:o}=await this._proxy.$resolveEncoding(n,s);if(r===Um&&!o){return ue.fromString(e).buffer}const a=await G3(n6(e),r,{addBOM:o});return Y5(a).buffer}toEncodeDecodeParameters(e){const i=Of(e?.uri)?e.uri:void 0;const n=typeof e?.encoding==="string"?e.encoding:void 0;return[i,n?{encoding:n}:void 0]}};Ww=z([O(0,st),O(1,Ai),O(2,Tc),O(3,at),O(4,wm)],Ww);const Cr=xe("IExtHostWorkspace");function mf(t){let e;let i;if(t){if(typeof t==="string"){e=t}else{e=t.pattern;i=b.revive(t.baseUri)}return{pattern:e,folder:i}}return void 0}function SS(t){return(t?.map(e=>{if(typeof e==="string"){if(e===""){return void 0}return{pattern:e,uri:void 0}}else{const i=mf(e);if(!i){return void 0}return{pattern:i.pattern,uri:i.folder}}})??[]).filter(e=>!!e)}var ui;(function(t){t[t["None"]=0]="None";t[t["UnexpectedEndOfComment"]=1]="UnexpectedEndOfComment";t[t["UnexpectedEndOfString"]=2]="UnexpectedEndOfString";t[t["UnexpectedEndOfNumber"]=3]="UnexpectedEndOfNumber";t[t["InvalidUnicode"]=4]="InvalidUnicode";t[t["InvalidEscapeCharacter"]=5]="InvalidEscapeCharacter";t[t["InvalidCharacter"]=6]="InvalidCharacter"})(ui||(ui={}));var we;(function(t){t[t["OpenBraceToken"]=1]="OpenBraceToken";t[t["CloseBraceToken"]=2]="CloseBraceToken";t[t["OpenBracketToken"]=3]="OpenBracketToken";t[t["CloseBracketToken"]=4]="CloseBracketToken";t[t["CommaToken"]=5]="CommaToken";t[t["ColonToken"]=6]="ColonToken";t[t["NullKeyword"]=7]="NullKeyword";t[t["TrueKeyword"]=8]="TrueKeyword";t[t["FalseKeyword"]=9]="FalseKeyword";t[t["StringLiteral"]=10]="StringLiteral";t[t["NumericLiteral"]=11]="NumericLiteral";t[t["LineCommentTrivia"]=12]="LineCommentTrivia";t[t["BlockCommentTrivia"]=13]="BlockCommentTrivia";t[t["LineBreakTrivia"]=14]="LineBreakTrivia";t[t["Trivia"]=15]="Trivia";t[t["Unknown"]=16]="Unknown";t[t["EOF"]=17]="EOF"})(we||(we={}));var Rt;(function(t){t[t["InvalidSymbol"]=1]="InvalidSymbol";t[t["InvalidNumberFormat"]=2]="InvalidNumberFormat";t[t["PropertyNameExpected"]=3]="PropertyNameExpected";t[t["ValueExpected"]=4]="ValueExpected";t[t["ColonExpected"]=5]="ColonExpected";t[t["CommaExpected"]=6]="CommaExpected";t[t["CloseBraceExpected"]=7]="CloseBraceExpected";t[t["CloseBracketExpected"]=8]="CloseBracketExpected";t[t["EndOfFileExpected"]=9]="EndOfFileExpected";t[t["InvalidCommentToken"]=10]="InvalidCommentToken";t[t["UnexpectedEndOfComment"]=11]="UnexpectedEndOfComment";t[t["UnexpectedEndOfString"]=12]="UnexpectedEndOfString";t[t["UnexpectedEndOfNumber"]=13]="UnexpectedEndOfNumber";t[t["InvalidUnicode"]=14]="InvalidUnicode";t[t["InvalidEscapeCharacter"]=15]="InvalidEscapeCharacter";t[t["InvalidCharacter"]=16]="InvalidCharacter"})(Rt||(Rt={}));var zw;(function(t){t.DEFAULT={allowTrailingComma:true}})(zw||(zw={}));function o6(t,e=false){let i=0;const n=t.length;let s="";let r=0;let o=we.Unknown;let a=ui.None;function l(v){let y=0;let D=0;while(y<v){const I=t.charCodeAt(i);if(I>=oe._0&&I<=oe._9){D=D*16+I-oe._0}else if(I>=oe.A&&I<=oe.F){D=D*16+I-oe.A+10}else if(I>=oe.a&&I<=oe.f){D=D*16+I-oe.a+10}else{break}i++;y++}if(y<v){D=-1}return D}function c(v){i=v;s="";r=0;o=we.Unknown;a=ui.None}function u(){const v=i;if(t.charCodeAt(i)===oe._0){i++}else{i++;while(i<t.length&&Za(t.charCodeAt(i))){i++}}if(i<t.length&&t.charCodeAt(i)===oe.dot){i++;if(i<t.length&&Za(t.charCodeAt(i))){i++;while(i<t.length&&Za(t.charCodeAt(i))){i++}}else{a=ui.UnexpectedEndOfNumber;return t.substring(v,i)}}let y=i;if(i<t.length&&(t.charCodeAt(i)===oe.E||t.charCodeAt(i)===oe.e)){i++;if(i<t.length&&t.charCodeAt(i)===oe.plus||t.charCodeAt(i)===oe.minus){i++}if(i<t.length&&Za(t.charCodeAt(i))){i++;while(i<t.length&&Za(t.charCodeAt(i))){i++}y=i}else{a=ui.UnexpectedEndOfNumber}}return t.substring(v,y)}function d(){let v="",y=i;while(true){if(i>=n){v+=t.substring(y,i);a=ui.UnexpectedEndOfString;break}const D=t.charCodeAt(i);if(D===oe.doubleQuote){v+=t.substring(y,i);i++;break}if(D===oe.backslash){v+=t.substring(y,i);i++;if(i>=n){a=ui.UnexpectedEndOfString;break}const I=t.charCodeAt(i++);switch(I){case oe.doubleQuote:v+='"';break;case oe.backslash:v+="\\";break;case oe.slash:v+="/";break;case oe.b:v+="\b";break;case oe.f:v+="\f";break;case oe.n:v+="\n";break;case oe.r:v+="\r";break;case oe.t:v+="	";break;case oe.u:{const R=l(4);if(R>=0){v+=String.fromCharCode(R)}else{a=ui.InvalidUnicode}break}default:a=ui.InvalidEscapeCharacter}y=i;continue}if(D>=0&&D<=31){if(Lh(D)){v+=t.substring(y,i);a=ui.UnexpectedEndOfString;break}else{a=ui.InvalidCharacter}}i++}return v}function p(){s="";a=ui.None;r=i;if(i>=n){r=n;return o=we.EOF}let v=t.charCodeAt(i);if(T1(v)){do{i++;s+=String.fromCharCode(v);v=t.charCodeAt(i)}while(T1(v));return o=we.Trivia}if(Lh(v)){i++;s+=String.fromCharCode(v);if(v===oe.carriageReturn&&t.charCodeAt(i)===oe.lineFeed){i++;s+="\n"}return o=we.LineBreakTrivia}switch(v){case oe.openBrace:i++;return o=we.OpenBraceToken;case oe.closeBrace:i++;return o=we.CloseBraceToken;case oe.openBracket:i++;return o=we.OpenBracketToken;case oe.closeBracket:i++;return o=we.CloseBracketToken;case oe.colon:i++;return o=we.ColonToken;case oe.comma:i++;return o=we.CommaToken;case oe.doubleQuote:i++;s=d();return o=we.StringLiteral;case oe.slash:{const y=i-1;if(t.charCodeAt(i+1)===oe.slash){i+=2;while(i<n){if(Lh(t.charCodeAt(i))){break}i++}s=t.substring(y,i);return o=we.LineCommentTrivia}if(t.charCodeAt(i+1)===oe.asterisk){i+=2;const D=n-1;let I=false;while(i<D){const R=t.charCodeAt(i);if(R===oe.asterisk&&t.charCodeAt(i+1)===oe.slash){i+=2;I=true;break}i++}if(!I){i++;a=ui.UnexpectedEndOfComment}s=t.substring(y,i);return o=we.BlockCommentTrivia}s+=String.fromCharCode(v);i++;return o=we.Unknown}case oe.minus:s+=String.fromCharCode(v);i++;if(i===n||!Za(t.charCodeAt(i))){return o=we.Unknown}case oe._0:case oe._1:case oe._2:case oe._3:case oe._4:case oe._5:case oe._6:case oe._7:case oe._8:case oe._9:s+=u();return o=we.NumericLiteral;default:while(i<n&&f(v)){i++;v=t.charCodeAt(i)}if(r!==i){s=t.substring(r,i);switch(s){case"true":return o=we.TrueKeyword;case"false":return o=we.FalseKeyword;case"null":return o=we.NullKeyword}return o=we.Unknown}s+=String.fromCharCode(v);i++;return o=we.Unknown}}function f(v){if(T1(v)||Lh(v)){return false}switch(v){case oe.closeBrace:case oe.closeBracket:case oe.openBrace:case oe.openBracket:case oe.doubleQuote:case oe.colon:case oe.comma:case oe.slash:return false}return true}function m(){let v;do{v=p()}while(v>=we.LineCommentTrivia&&v<=we.Trivia);return v}return{setPosition:c,getPosition:()=>i,scan:e?m:p,getToken:()=>o,getTokenValue:()=>s,getTokenOffset:()=>r,getTokenLength:()=>i-r,getTokenError:()=>a}}function T1(t){return t===oe.space||t===oe.tab||t===oe.verticalTab||t===oe.formFeed||t===oe.nonBreakingSpace||t===oe.ogham||t>=oe.enQuad&&t<=oe.zeroWidthSpace||t===oe.narrowNoBreakSpace||t===oe.mathematicalSpace||t===oe.ideographicSpace||t===oe.byteOrderMark}function Lh(t){return t===oe.lineFeed||t===oe.carriageReturn||t===oe.lineSeparator||t===oe.paragraphSeparator}function Za(t){return t>=oe._0&&t<=oe._9}var oe;(function(t){t[t["nullCharacter"]=0]="nullCharacter";t[t["maxAsciiCharacter"]=127]="maxAsciiCharacter";t[t["lineFeed"]=10]="lineFeed";t[t["carriageReturn"]=13]="carriageReturn";t[t["lineSeparator"]=8232]="lineSeparator";t[t["paragraphSeparator"]=8233]="paragraphSeparator";t[t["nextLine"]=133]="nextLine";t[t["space"]=32]="space";t[t["nonBreakingSpace"]=160]="nonBreakingSpace";t[t["enQuad"]=8192]="enQuad";t[t["emQuad"]=8193]="emQuad";t[t["enSpace"]=8194]="enSpace";t[t["emSpace"]=8195]="emSpace";t[t["threePerEmSpace"]=8196]="threePerEmSpace";t[t["fourPerEmSpace"]=8197]="fourPerEmSpace";t[t["sixPerEmSpace"]=8198]="sixPerEmSpace";t[t["figureSpace"]=8199]="figureSpace";t[t["punctuationSpace"]=8200]="punctuationSpace";t[t["thinSpace"]=8201]="thinSpace";t[t["hairSpace"]=8202]="hairSpace";t[t["zeroWidthSpace"]=8203]="zeroWidthSpace";t[t["narrowNoBreakSpace"]=8239]="narrowNoBreakSpace";t[t["ideographicSpace"]=12288]="ideographicSpace";t[t["mathematicalSpace"]=8287]="mathematicalSpace";t[t["ogham"]=5760]="ogham";t[t["_"]=95]="_";t[t["$"]=36]="$";t[t["_0"]=48]="_0";t[t["_1"]=49]="_1";t[t["_2"]=50]="_2";t[t["_3"]=51]="_3";t[t["_4"]=52]="_4";t[t["_5"]=53]="_5";t[t["_6"]=54]="_6";t[t["_7"]=55]="_7";t[t["_8"]=56]="_8";t[t["_9"]=57]="_9";t[t["a"]=97]="a";t[t["b"]=98]="b";t[t["c"]=99]="c";t[t["d"]=100]="d";t[t["e"]=101]="e";t[t["f"]=102]="f";t[t["g"]=103]="g";t[t["h"]=104]="h";t[t["i"]=105]="i";t[t["j"]=106]="j";t[t["k"]=107]="k";t[t["l"]=108]="l";t[t["m"]=109]="m";t[t["n"]=110]="n";t[t["o"]=111]="o";t[t["p"]=112]="p";t[t["q"]=113]="q";t[t["r"]=114]="r";t[t["s"]=115]="s";t[t["t"]=116]="t";t[t["u"]=117]="u";t[t["v"]=118]="v";t[t["w"]=119]="w";t[t["x"]=120]="x";t[t["y"]=121]="y";t[t["z"]=122]="z";t[t["A"]=65]="A";t[t["B"]=66]="B";t[t["C"]=67]="C";t[t["D"]=68]="D";t[t["E"]=69]="E";t[t["F"]=70]="F";t[t["G"]=71]="G";t[t["H"]=72]="H";t[t["I"]=73]="I";t[t["J"]=74]="J";t[t["K"]=75]="K";t[t["L"]=76]="L";t[t["M"]=77]="M";t[t["N"]=78]="N";t[t["O"]=79]="O";t[t["P"]=80]="P";t[t["Q"]=81]="Q";t[t["R"]=82]="R";t[t["S"]=83]="S";t[t["T"]=84]="T";t[t["U"]=85]="U";t[t["V"]=86]="V";t[t["W"]=87]="W";t[t["X"]=88]="X";t[t["Y"]=89]="Y";t[t["Z"]=90]="Z";t[t["ampersand"]=38]="ampersand";t[t["asterisk"]=42]="asterisk";t[t["at"]=64]="at";t[t["backslash"]=92]="backslash";t[t["bar"]=124]="bar";t[t["caret"]=94]="caret";t[t["closeBrace"]=125]="closeBrace";t[t["closeBracket"]=93]="closeBracket";t[t["closeParen"]=41]="closeParen";t[t["colon"]=58]="colon";t[t["comma"]=44]="comma";t[t["dot"]=46]="dot";t[t["doubleQuote"]=34]="doubleQuote";t[t["equals"]=61]="equals";t[t["exclamation"]=33]="exclamation";t[t["greaterThan"]=62]="greaterThan";t[t["lessThan"]=60]="lessThan";t[t["minus"]=45]="minus";t[t["openBrace"]=123]="openBrace";t[t["openBracket"]=91]="openBracket";t[t["openParen"]=40]="openParen";t[t["percent"]=37]="percent";t[t["plus"]=43]="plus";t[t["question"]=63]="question";t[t["semicolon"]=59]="semicolon";t[t["singleQuote"]=39]="singleQuote";t[t["slash"]=47]="slash";t[t["tilde"]=126]="tilde";t[t["backspace"]=8]="backspace";t[t["formFeed"]=12]="formFeed";t[t["byteOrderMark"]=65279]="byteOrderMark";t[t["tab"]=9]="tab";t[t["verticalTab"]=11]="verticalTab"})(oe||(oe={}));function a6(t,e,i=zw.DEFAULT){const n=o6(t,false);function s(le){return le?()=>le(n.getTokenOffset(),n.getTokenLength()):()=>true}function r(le){return le?Ce=>le(Ce,n.getTokenOffset(),n.getTokenLength()):()=>true}const o=s(e.onObjectBegin),a=r(e.onObjectProperty),l=s(e.onObjectEnd),c=s(e.onArrayBegin),u=s(e.onArrayEnd),d=r(e.onLiteralValue),p=r(e.onSeparator),f=s(e.onComment),m=r(e.onError);const v=i&&i.disallowComments;const y=i&&i.allowTrailingComma;function D(){while(true){const le=n.scan();switch(n.getTokenError()){case ui.InvalidUnicode:I(Rt.InvalidUnicode);break;case ui.InvalidEscapeCharacter:I(Rt.InvalidEscapeCharacter);break;case ui.UnexpectedEndOfNumber:I(Rt.UnexpectedEndOfNumber);break;case ui.UnexpectedEndOfComment:if(!v){I(Rt.UnexpectedEndOfComment)}break;case ui.UnexpectedEndOfString:I(Rt.UnexpectedEndOfString);break;case ui.InvalidCharacter:I(Rt.InvalidCharacter);break}switch(le){case we.LineCommentTrivia:case we.BlockCommentTrivia:if(v){I(Rt.InvalidCommentToken)}else{f()}break;case we.Unknown:I(Rt.InvalidSymbol);break;case we.Trivia:case we.LineBreakTrivia:break;default:return le}}}function I(le,Ce=[],Je=[]){m(le);if(Ce.length+Je.length>0){let We=n.getToken();while(We!==we.EOF){if(Ce.indexOf(We)!==-1){D();break}else if(Je.indexOf(We)!==-1){break}We=D()}}}function R(le){const Ce=n.getTokenValue();if(le){d(Ce)}else{a(Ce)}D();return true}function J(){switch(n.getToken()){case we.NumericLiteral:{let le=0;try{le=JSON.parse(n.getTokenValue());if(typeof le!=="number"){I(Rt.InvalidNumberFormat);le=0}}catch(Ce){I(Rt.InvalidNumberFormat)}d(le);break}case we.NullKeyword:d(null);break;case we.TrueKeyword:d(true);break;case we.FalseKeyword:d(false);break;default:return false}D();return true}function H(){if(n.getToken()!==we.StringLiteral){I(Rt.PropertyNameExpected,[],[we.CloseBraceToken,we.CommaToken]);return false}R(false);if(n.getToken()===we.ColonToken){p(":");D();if(!te()){I(Rt.ValueExpected,[],[we.CloseBraceToken,we.CommaToken])}}else{I(Rt.ColonExpected,[],[we.CloseBraceToken,we.CommaToken])}return true}function Q(){o();D();let le=false;while(n.getToken()!==we.CloseBraceToken&&n.getToken()!==we.EOF){if(n.getToken()===we.CommaToken){if(!le){I(Rt.ValueExpected,[],[])}p(",");D();if(n.getToken()===we.CloseBraceToken&&y){break}}else if(le){I(Rt.CommaExpected,[],[])}if(!H()){I(Rt.ValueExpected,[],[we.CloseBraceToken,we.CommaToken])}le=true}l();if(n.getToken()!==we.CloseBraceToken){I(Rt.CloseBraceExpected,[we.CloseBraceToken],[])}else{D()}return true}function ne(){c();D();let le=false;while(n.getToken()!==we.CloseBracketToken&&n.getToken()!==we.EOF){if(n.getToken()===we.CommaToken){if(!le){I(Rt.ValueExpected,[],[])}p(",");D();if(n.getToken()===we.CloseBracketToken&&y){break}}else if(le){I(Rt.CommaExpected,[],[])}if(!te()){I(Rt.ValueExpected,[],[we.CloseBracketToken,we.CommaToken])}le=true}u();if(n.getToken()!==we.CloseBracketToken){I(Rt.CloseBracketExpected,[we.CloseBracketToken],[])}else{D()}return true}function te(){switch(n.getToken()){case we.OpenBracketToken:return ne();case we.OpenBraceToken:return Q();case we.StringLiteral:return R(true);default:return J()}}D();if(n.getToken()===we.EOF){if(i.allowEmptyContent){return true}I(Rt.ValueExpected,[],[]);return false}if(!te()){I(Rt.ValueExpected,[],[]);return false}if(n.getToken()!==we.EOF){I(Rt.EndOfFileExpected,[],[])}return true}function lu(t){return Object.isFrozen(t)?t:II(t)}class yn{static createEmptyModel(e){return new yn({},[],[],void 0,e)}constructor(e,i,n,s,r){this._contents=e;this._keys=i;this._overrides=n;this.raw=s;this.logService=r;this.overrideConfigurations=new Map}get rawConfiguration(){if(!this._rawConfiguration){if(this.raw){const e=(Array.isArray(this.raw)?this.raw:[this.raw]).map(i=>{if(i instanceof yn){return i}const n=new l6("",this.logService);n.parseRaw(i);return n.configurationModel});this._rawConfiguration=e.reduce((i,n)=>n===i?n:i.merge(n),e[0])}else{this._rawConfiguration=this}}return this._rawConfiguration}get contents(){return this._contents}get overrides(){return this._overrides}get keys(){return this._keys}isEmpty(){return this._keys.length===0&&Object.keys(this._contents).length===0&&this._overrides.length===0}getValue(e){return e?op(this.contents,e):this.contents}inspect(e,i){const n=this;return{get value(){return lu(n.rawConfiguration.getValue(e))},get override(){return i?lu(n.rawConfiguration.getOverrideValue(e,i)):void 0},get merged(){return lu(i?n.rawConfiguration.override(i).getValue(e):n.rawConfiguration.getValue(e))},get overrides(){const s=[];for(const{contents:r,identifiers:o,keys:a}of n.rawConfiguration.overrides){const l=new yn(r,a,[],void 0,n.logService).getValue(e);if(l!==void 0){s.push({identifiers:o,value:l})}}return s.length?lu(s):void 0}}}getOverrideValue(e,i){const n=this.getContentsForOverrideIdentifer(i);return n?e?op(n,e):n:void 0}getKeysForOverrideIdentifier(e){const i=[];for(const n of this.overrides){if(n.identifiers.includes(e)){i.push(...n.keys)}}return sl(i)}getAllOverrideIdentifiers(){const e=[];for(const i of this.overrides){e.push(...i.identifiers)}return sl(e)}override(e){let i=this.overrideConfigurations.get(e);if(!i){i=this.createOverrideConfigurationModel(e);this.overrideConfigurations.set(e,i)}return i}merge(...e){const i=vt(this.contents);const n=vt(this.overrides);const s=[...this.keys];const r=this.raw?Array.isArray(this.raw)?[...this.raw]:[this.raw]:[this];for(const o of e){r.push(...o.raw?Array.isArray(o.raw)?o.raw:[o.raw]:[o]);if(o.isEmpty()){continue}this.mergeContents(i,o.contents);for(const a of o.overrides){const[l]=n.filter(c=>Is(c.identifiers,a.identifiers));if(l){this.mergeContents(l.contents,a.contents);l.keys.push(...a.keys);l.keys=sl(l.keys)}else{n.push(vt(a))}}for(const a of o.keys){if(s.indexOf(a)===-1){s.push(a)}}}return new yn(i,s,n,!r.length||r.every(o=>o instanceof yn)?void 0:r,this.logService)}createOverrideConfigurationModel(e){const i=this.getContentsForOverrideIdentifer(e);if(!i||typeof i!=="object"||!Object.keys(i).length){return this}const n={};for(const s of sl([...Object.keys(this.contents),...Object.keys(i)])){let r=this.contents[s];const o=i[s];if(o){if(typeof r==="object"&&typeof o==="object"){r=vt(r);this.mergeContents(r,o)}else{r=o}}n[s]=r}return new yn(n,this.keys,this.overrides,void 0,this.logService)}mergeContents(e,i){for(const n of Object.keys(i)){if(n in e){if(Yt(e[n])&&Yt(i[n])){this.mergeContents(e[n],i[n]);continue}}e[n]=vt(i[n])}}getContentsForOverrideIdentifer(e){let i=null;let n=null;const s=r=>{if(r){if(n){this.mergeContents(n,r)}else{n=vt(r)}}};for(const r of this.overrides){if(r.identifiers.length===1&&r.identifiers[0]===e){i=r.contents}else if(r.identifiers.includes(e)){s(r.contents)}}s(i);return n}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}addValue(e,i){this.updateValue(e,i,true)}setValue(e,i){this.updateValue(e,i,false)}removeValue(e){const i=this.keys.indexOf(e);if(i===-1){return}this.keys.splice(i,1);R9(this.contents,e);if(As.test(e)){this.overrides.splice(this.overrides.findIndex(n=>Is(n.identifiers,ed(e))),1)}}updateValue(e,i,n){v4(this.contents,e,i,s=>this.logService.error(s));n=n||this.keys.indexOf(e)===-1;if(n){this.keys.push(e)}if(As.test(e)){const s=ed(e);const r={identifiers:s,keys:Object.keys(this.contents[e]),contents:F_(this.contents[e],a=>this.logService.error(a))};const o=this.overrides.findIndex(a=>Is(a.identifiers,s));if(o!==-1){this.overrides[o]=r}else{this.overrides.push(r)}}}}class l6{constructor(e,i){this._name=e;this.logService=i;this._raw=null;this._configurationModel=null;this._restrictedConfigurations=[];this._parseErrors=[]}get configurationModel(){return this._configurationModel||yn.createEmptyModel(this.logService)}get restrictedConfigurations(){return this._restrictedConfigurations}get errors(){return this._parseErrors}parse(e,i){if(!Xt(e)){const n=this.doParseContent(e);this.parseRaw(n,i)}}reparse(e){if(this._raw){this.parseRaw(this._raw,e)}}parseRaw(e,i){this._raw=e;const{contents:n,keys:s,overrides:r,restricted:o,hasExcludedProperties:a}=this.doParseRaw(e,i);this._configurationModel=new yn(n,s,r,a?[e]:void 0,this.logService);this._restrictedConfigurations=o||[]}doParseContent(e){let i={};let n=null;let s=[];const r=[];function o(l){if(Array.isArray(s)){s.push(l)}else if(n!==null){s[n]=l}}const a={onObjectBegin:()=>{const l={};o(l);r.push(s);s=l;n=null},onObjectProperty:l=>{n=l},onObjectEnd:()=>{s=r.pop()},onArrayBegin:()=>{const l=[];o(l);r.push(s);s=l;n=null},onArrayEnd:()=>{s=r.pop()},onLiteralValue:o,onError:(l,c,u)=>{}};if(e){try{a6(e,a);i=s[0]||{}}catch(l){this.logService.error(`Error while parsing settings file ${this._name}: ${l}`);this._parseErrors=[l]}}return i}doParseRaw(e,i){const n=ci.as($a.Configuration).getConfigurationProperties();const s=this.filter(e,n,true,i);e=s.raw;const r=F_(e,l=>this.logService.error(`Conflict in settings file ${this._name}: ${l}`));const o=Object.keys(e);const a=this.toOverrides(e,l=>this.logService.error(`Conflict in settings file ${this._name}: ${l}`));return{contents:r,keys:o,overrides:a,restricted:s.restricted,hasExcludedProperties:s.hasExcludedProperties}}filter(e,i,n,s){let r=false;if(!s?.scopes&&!s?.skipRestricted&&!s?.exclude?.length){return{raw:e,restricted:[],hasExcludedProperties:r}}const o={};const a=[];for(const l in e){if(As.test(l)&&n){const c=this.filter(e[l],i,false,s);o[l]=c.raw;r=r||c.hasExcludedProperties;a.push(...c.restricted)}else{const c=i[l];if(c?.restricted){a.push(l)}if(this.shouldInclude(l,c,s)){o[l]=e[l]}else{r=true}}}return{raw:o,restricted:a,hasExcludedProperties:r}}shouldInclude(e,i,n){if(n.exclude?.includes(e)){return false}if(n.include?.includes(e)){return true}if(n.skipRestricted&&i?.restricted){return false}if(n.skipUnregistered&&!i){return false}const s=i?typeof i.scope!=="undefined"?i.scope:wt.WINDOW:void 0;if(s===void 0||n.scopes===void 0){return true}return n.scopes.includes(s)}toOverrides(e,i){const n=[];for(const s of Object.keys(e)){if(As.test(s)){const r={};for(const o in e[s]){r[o]=e[s][o]}n.push({identifiers:ed(s),keys:Object.keys(r),contents:F_(r,i)})}}return n}}class c6{constructor(e,i,n,s,r,o,a,l,c,u,d,p,f){this.key=e;this.overrides=i;this._value=n;this.overrideIdentifiers=s;this.defaultConfiguration=r;this.policyConfiguration=o;this.applicationConfiguration=a;this.userConfiguration=l;this.localUserConfiguration=c;this.remoteUserConfiguration=u;this.workspaceConfiguration=d;this.folderConfigurationModel=p;this.memoryConfigurationModel=f}get value(){return lu(this._value)}toInspectValue(e){return e?.value!==void 0||e?.override!==void 0||e?.overrides!==void 0?e:void 0}get defaultInspectValue(){if(!this._defaultInspectValue){this._defaultInspectValue=this.defaultConfiguration.inspect(this.key,this.overrides.overrideIdentifier)}return this._defaultInspectValue}get defaultValue(){return this.defaultInspectValue.merged}get default(){return this.toInspectValue(this.defaultInspectValue)}get policyInspectValue(){if(this._policyInspectValue===void 0){this._policyInspectValue=this.policyConfiguration?this.policyConfiguration.inspect(this.key):null}return this._policyInspectValue}get policyValue(){return this.policyInspectValue?.merged}get policy(){return this.policyInspectValue?.value!==void 0?{value:this.policyInspectValue.value}:void 0}get applicationInspectValue(){if(this._applicationInspectValue===void 0){this._applicationInspectValue=this.applicationConfiguration?this.applicationConfiguration.inspect(this.key):null}return this._applicationInspectValue}get applicationValue(){return this.applicationInspectValue?.merged}get application(){return this.toInspectValue(this.applicationInspectValue)}get userInspectValue(){if(!this._userInspectValue){this._userInspectValue=this.userConfiguration.inspect(this.key,this.overrides.overrideIdentifier)}return this._userInspectValue}get userValue(){return this.userInspectValue.merged}get user(){return this.toInspectValue(this.userInspectValue)}get userLocalInspectValue(){if(!this._userLocalInspectValue){this._userLocalInspectValue=this.localUserConfiguration.inspect(this.key,this.overrides.overrideIdentifier)}return this._userLocalInspectValue}get userLocalValue(){return this.userLocalInspectValue.merged}get userLocal(){return this.toInspectValue(this.userLocalInspectValue)}get userRemoteInspectValue(){if(!this._userRemoteInspectValue){this._userRemoteInspectValue=this.remoteUserConfiguration.inspect(this.key,this.overrides.overrideIdentifier)}return this._userRemoteInspectValue}get userRemoteValue(){return this.userRemoteInspectValue.merged}get userRemote(){return this.toInspectValue(this.userRemoteInspectValue)}get workspaceInspectValue(){if(this._workspaceInspectValue===void 0){this._workspaceInspectValue=this.workspaceConfiguration?this.workspaceConfiguration.inspect(this.key,this.overrides.overrideIdentifier):null}return this._workspaceInspectValue}get workspaceValue(){return this.workspaceInspectValue?.merged}get workspace(){return this.toInspectValue(this.workspaceInspectValue)}get workspaceFolderInspectValue(){if(this._workspaceFolderInspectValue===void 0){this._workspaceFolderInspectValue=this.folderConfigurationModel?this.folderConfigurationModel.inspect(this.key,this.overrides.overrideIdentifier):null}return this._workspaceFolderInspectValue}get workspaceFolderValue(){return this.workspaceFolderInspectValue?.merged}get workspaceFolder(){return this.toInspectValue(this.workspaceFolderInspectValue)}get memoryInspectValue(){if(this._memoryInspectValue===void 0){this._memoryInspectValue=this.memoryConfigurationModel.inspect(this.key,this.overrides.overrideIdentifier)}return this._memoryInspectValue}get memoryValue(){return this.memoryInspectValue.merged}get memory(){return this.toInspectValue(this.memoryInspectValue)}}let qw=class xC{constructor(e,i,n,s,r,o,a,l,c,u){this._defaultConfiguration=e;this._policyConfiguration=i;this._applicationConfiguration=n;this._localUserConfiguration=s;this._remoteUserConfiguration=r;this._workspaceConfiguration=o;this._folderConfigurations=a;this._memoryConfiguration=l;this._memoryConfigurationByResource=c;this.logService=u;this._workspaceConsolidatedConfiguration=null;this._foldersConsolidatedConfigurations=new Ft;this._userConfiguration=null}getValue(e,i,n){const s=this.getConsolidatedConfigurationModel(e,i,n);return s.getValue(e)}updateValue(e,i,n={}){let s;if(n.resource){s=this._memoryConfigurationByResource.get(n.resource);if(!s){s=yn.createEmptyModel(this.logService);this._memoryConfigurationByResource.set(n.resource,s)}}else{s=this._memoryConfiguration}if(i===void 0){s.removeValue(e)}else{s.setValue(e,i)}if(!n.resource){this._workspaceConsolidatedConfiguration=null}}inspect(e,i,n){const s=this.getConsolidatedConfigurationModel(e,i,n);const r=this.getFolderConfigurationModelForResource(i.resource,n);const o=i.resource?this._memoryConfigurationByResource.get(i.resource)||this._memoryConfiguration:this._memoryConfiguration;const a=new Set;for(const l of s.overrides){for(const c of l.identifiers){if(s.getOverrideValue(e,c)!==void 0){a.add(c)}}}return new c6(e,i,s.getValue(e),a.size?[...a]:void 0,this._defaultConfiguration,this._policyConfiguration.isEmpty()?void 0:this._policyConfiguration,this.applicationConfiguration.isEmpty()?void 0:this.applicationConfiguration,this.userConfiguration,this.localUserConfiguration,this.remoteUserConfiguration,n?this._workspaceConfiguration:void 0,r?r:void 0,o)}keys(e){const i=this.getFolderConfigurationModelForResource(void 0,e);return{default:this._defaultConfiguration.keys.slice(0),user:this.userConfiguration.keys.slice(0),workspace:this._workspaceConfiguration.keys.slice(0),workspaceFolder:i?i.keys.slice(0):[]}}updateDefaultConfiguration(e){this._defaultConfiguration=e;this._workspaceConsolidatedConfiguration=null;this._foldersConsolidatedConfigurations.clear()}updatePolicyConfiguration(e){this._policyConfiguration=e}updateApplicationConfiguration(e){this._applicationConfiguration=e;this._workspaceConsolidatedConfiguration=null;this._foldersConsolidatedConfigurations.clear()}updateLocalUserConfiguration(e){this._localUserConfiguration=e;this._userConfiguration=null;this._workspaceConsolidatedConfiguration=null;this._foldersConsolidatedConfigurations.clear()}updateRemoteUserConfiguration(e){this._remoteUserConfiguration=e;this._userConfiguration=null;this._workspaceConsolidatedConfiguration=null;this._foldersConsolidatedConfigurations.clear()}updateWorkspaceConfiguration(e){this._workspaceConfiguration=e;this._workspaceConsolidatedConfiguration=null;this._foldersConsolidatedConfigurations.clear()}updateFolderConfiguration(e,i){this._folderConfigurations.set(e,i);this._foldersConsolidatedConfigurations.delete(e)}deleteFolderConfiguration(e){this.folderConfigurations.delete(e);this._foldersConsolidatedConfigurations.delete(e)}compareAndUpdateDefaultConfiguration(e,i){const n=[];if(!i){const{added:s,updated:r,removed:o}=Nr(this._defaultConfiguration,e);i=[...s,...r,...o]}for(const s of i){for(const r of ed(s)){const o=this._defaultConfiguration.getKeysForOverrideIdentifier(r);const a=e.getKeysForOverrideIdentifier(r);const l=[...a.filter(c=>o.indexOf(c)===-1),...o.filter(c=>a.indexOf(c)===-1),...o.filter(c=>!Xi(this._defaultConfiguration.override(r).getValue(c),e.override(r).getValue(c)))];n.push([r,l])}}this.updateDefaultConfiguration(e);return{keys:i,overrides:n}}compareAndUpdatePolicyConfiguration(e){const{added:i,updated:n,removed:s}=Nr(this._policyConfiguration,e);const r=[...i,...n,...s];if(r.length){this.updatePolicyConfiguration(e)}return{keys:r,overrides:[]}}compareAndUpdateApplicationConfiguration(e){const{added:i,updated:n,removed:s,overrides:r}=Nr(this.applicationConfiguration,e);const o=[...i,...n,...s];if(o.length){this.updateApplicationConfiguration(e)}return{keys:o,overrides:r}}compareAndUpdateLocalUserConfiguration(e){const{added:i,updated:n,removed:s,overrides:r}=Nr(this.localUserConfiguration,e);const o=[...i,...n,...s];if(o.length){this.updateLocalUserConfiguration(e)}return{keys:o,overrides:r}}compareAndUpdateRemoteUserConfiguration(e){const{added:i,updated:n,removed:s,overrides:r}=Nr(this.remoteUserConfiguration,e);const o=[...i,...n,...s];if(o.length){this.updateRemoteUserConfiguration(e)}return{keys:o,overrides:r}}compareAndUpdateWorkspaceConfiguration(e){const{added:i,updated:n,removed:s,overrides:r}=Nr(this.workspaceConfiguration,e);const o=[...i,...n,...s];if(o.length){this.updateWorkspaceConfiguration(e)}return{keys:o,overrides:r}}compareAndUpdateFolderConfiguration(e,i){const n=this.folderConfigurations.get(e);const{added:s,updated:r,removed:o,overrides:a}=Nr(n,i);const l=[...s,...r,...o];if(l.length||!n){this.updateFolderConfiguration(e,i)}return{keys:l,overrides:a}}compareAndDeleteFolderConfiguration(e){const i=this.folderConfigurations.get(e);if(!i){throw new Error("Unknown folder")}this.deleteFolderConfiguration(e);const{added:n,updated:s,removed:r,overrides:o}=Nr(i,void 0);return{keys:[...n,...s,...r],overrides:o}}get defaults(){return this._defaultConfiguration}get applicationConfiguration(){return this._applicationConfiguration}get userConfiguration(){if(!this._userConfiguration){if(this._remoteUserConfiguration.isEmpty()){this._userConfiguration=this._localUserConfiguration}else{const e=this._localUserConfiguration.merge(this._remoteUserConfiguration);this._userConfiguration=new yn(e.contents,e.keys,e.overrides,void 0,this.logService)}}return this._userConfiguration}get localUserConfiguration(){return this._localUserConfiguration}get remoteUserConfiguration(){return this._remoteUserConfiguration}get workspaceConfiguration(){return this._workspaceConfiguration}get folderConfigurations(){return this._folderConfigurations}getConsolidatedConfigurationModel(e,i,n){let s=this.getConsolidatedConfigurationModelForResource(i,n);if(i.overrideIdentifier){s=s.override(i.overrideIdentifier)}if(!this._policyConfiguration.isEmpty()&&this._policyConfiguration.getValue(e)!==void 0){s=s.merge();for(const r of this._policyConfiguration.keys){s.setValue(r,this._policyConfiguration.getValue(r))}}return s}getConsolidatedConfigurationModelForResource({resource:e},i){let n=this.getWorkspaceConsolidatedConfiguration();if(i&&e){const s=i.getFolder(e);if(s){n=this.getFolderConsolidatedConfiguration(s.uri)||n}const r=this._memoryConfigurationByResource.get(e);if(r){n=n.merge(r)}}return n}getWorkspaceConsolidatedConfiguration(){if(!this._workspaceConsolidatedConfiguration){this._workspaceConsolidatedConfiguration=this._defaultConfiguration.merge(this.applicationConfiguration,this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration)}return this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(e){let i=this._foldersConsolidatedConfigurations.get(e);if(!i){const n=this.getWorkspaceConsolidatedConfiguration();const s=this._folderConfigurations.get(e);if(s){i=n.merge(s);this._foldersConsolidatedConfigurations.set(e,i)}else{i=n}}return i}getFolderConfigurationModelForResource(e,i){if(i&&e){const n=i.getFolder(e);if(n){return this._folderConfigurations.get(n.uri)}}return void 0}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},policy:{contents:this._policyConfiguration.contents,overrides:this._policyConfiguration.overrides,keys:this._policyConfiguration.keys},application:{contents:this.applicationConfiguration.contents,overrides:this.applicationConfiguration.overrides,keys:this.applicationConfiguration.keys,raw:Array.isArray(this.applicationConfiguration.raw)?void 0:this.applicationConfiguration.raw},userLocal:{contents:this.localUserConfiguration.contents,overrides:this.localUserConfiguration.overrides,keys:this.localUserConfiguration.keys,raw:Array.isArray(this.localUserConfiguration.raw)?void 0:this.localUserConfiguration.raw},userRemote:{contents:this.remoteUserConfiguration.contents,overrides:this.remoteUserConfiguration.overrides,keys:this.remoteUserConfiguration.keys,raw:Array.isArray(this.remoteUserConfiguration.raw)?void 0:this.remoteUserConfiguration.raw},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce((e,i)=>{const{contents:n,overrides:s,keys:r}=this._folderConfigurations.get(i);e.push([i,{contents:n,overrides:s,keys:r}]);return e},[])}}allKeys(){const e=new Set;this._defaultConfiguration.keys.forEach(i=>e.add(i));this.userConfiguration.keys.forEach(i=>e.add(i));this._workspaceConfiguration.keys.forEach(i=>e.add(i));this._folderConfigurations.forEach(i=>i.keys.forEach(n=>e.add(n)));return[...e.values()]}allOverrideIdentifiers(){const e=new Set;this._defaultConfiguration.getAllOverrideIdentifiers().forEach(i=>e.add(i));this.userConfiguration.getAllOverrideIdentifiers().forEach(i=>e.add(i));this._workspaceConfiguration.getAllOverrideIdentifiers().forEach(i=>e.add(i));this._folderConfigurations.forEach(i=>i.getAllOverrideIdentifiers().forEach(n=>e.add(n)));return[...e.values()]}getAllKeysForOverrideIdentifier(e){const i=new Set;this._defaultConfiguration.getKeysForOverrideIdentifier(e).forEach(n=>i.add(n));this.userConfiguration.getKeysForOverrideIdentifier(e).forEach(n=>i.add(n));this._workspaceConfiguration.getKeysForOverrideIdentifier(e).forEach(n=>i.add(n));this._folderConfigurations.forEach(n=>n.getKeysForOverrideIdentifier(e).forEach(s=>i.add(s)));return[...i.values()]}static parse(e,i){const n=this.parseConfigurationModel(e.defaults,i);const s=this.parseConfigurationModel(e.policy,i);const r=this.parseConfigurationModel(e.application,i);const o=this.parseConfigurationModel(e.userLocal,i);const a=this.parseConfigurationModel(e.userRemote,i);const l=this.parseConfigurationModel(e.workspace,i);const c=e.folders.reduce((u,d)=>{u.set(b.revive(d[0]),this.parseConfigurationModel(d[1],i));return u},new Ft);return new xC(n,s,r,o,a,l,c,yn.createEmptyModel(i),new Ft,i)}static parseConfigurationModel(e,i){return new yn(e.contents,e.keys,e.overrides,e.raw,i)}};class u6{constructor(e,i,n,s,r){this.change=e;this.previous=i;this.currentConfiguraiton=n;this.currentWorkspace=s;this.logService=r;this._marker="\n";this._markerCode1=this._marker.charCodeAt(0);this._markerCode2=".".charCodeAt(0);this.affectedKeys=new Set;this._previousConfiguration=void 0;for(const o of e.keys){this.affectedKeys.add(o)}for(const[,o]of e.overrides){for(const a of o){this.affectedKeys.add(a)}}this._affectsConfigStr=this._marker;for(const o of this.affectedKeys){this._affectsConfigStr+=o+this._marker}}get previousConfiguration(){if(!this._previousConfiguration&&this.previous){this._previousConfiguration=qw.parse(this.previous.data,this.logService)}return this._previousConfiguration}affectsConfiguration(e,i){const n=this._marker+e;const s=this._affectsConfigStr.indexOf(n);if(s<0){return false}const r=s+n.length;if(r>=this._affectsConfigStr.length){return false}const o=this._affectsConfigStr.charCodeAt(r);if(o!==this._markerCode1&&o!==this._markerCode2){return false}if(i){const a=this.previousConfiguration?this.previousConfiguration.getValue(e,i,this.previous?.workspace):void 0;const l=this.currentConfiguraiton.getValue(e,i,this.currentWorkspace);return!Xi(a,l)}return true}}function Nr(t,e){const{added:i,removed:n,updated:s}=DS(e?.rawConfiguration,t?.rawConfiguration);const r=[];const o=t?.getAllOverrideIdentifiers()||[];const a=e?.getAllOverrideIdentifiers()||[];if(e){const l=a.filter(c=>!o.includes(c));for(const c of l){r.push([c,e.getKeysForOverrideIdentifier(c)])}}if(t){const l=o.filter(c=>!a.includes(c));for(const c of l){r.push([c,t.getKeysForOverrideIdentifier(c)])}}if(e&&t){for(const l of o){if(a.includes(l)){const c=DS({contents:t.getOverrideValue(void 0,l)||{},keys:t.getKeysForOverrideIdentifier(l)},{contents:e.getOverrideValue(void 0,l)||{},keys:e.getKeysForOverrideIdentifier(l)});r.push([l,[...c.added,...c.removed,...c.updated]])}}}return{added:i,removed:n,updated:s,overrides:r}}function DS(t,e){const i=t?e?t.keys.filter(r=>e.keys.indexOf(r)===-1):[...t.keys]:[];const n=e?t?e.keys.filter(r=>t.keys.indexOf(r)===-1):[...e.keys]:[];const s=[];if(t&&e){for(const r of e.keys){if(t.keys.indexOf(r)!==-1){const o=op(e.contents,r);const a=op(t.contents,r);if(!Xi(o,a)){s.push(r)}}}}return{added:i,removed:n,updated:s}}function Nh(t,e){if(e){const i=e.split(".");let n=t;for(let s=0;n&&s<i.length;s++){n=n[i[s]]}return n}}function d6(t){return t instanceof b}function h6(t){return t&&t.uri instanceof b&&(t.languageId&&typeof t.languageId==="string")}function f6(t){return t&&!t.uri&&(t.languageId&&typeof t.languageId==="string")}function p6(t){return t&&t.uri instanceof b&&(!t.name||typeof t.name==="string")&&(!t.index||typeof t.index==="number")}function kS(t){if(d6(t)){return{resource:t}}if(h6(t)){return{resource:t.uri,overrideIdentifier:t.languageId}}if(f6(t)){return{overrideIdentifier:t.languageId}}if(p6(t)){return{resource:t.uri}}if(t===null){return{resource:null}}return void 0}let jw=class c${constructor(e,i,n){this._proxy=e.getProxy(Y.MainThreadConfiguration);this._extHostWorkspace=i;this._logService=n;this._barrier=new xs;this._actual=null}getConfigProvider(){return this._barrier.wait().then(e=>this._actual)}$initializeConfiguration(e){this._actual=new g6(this._proxy,this._extHostWorkspace,e,this._logService);this._barrier.open()}$acceptConfigurationChanged(e,i){this.getConfigProvider().then(n=>n.$acceptConfigurationChanged(e,i))}};jw=z([O(0,st),O(1,Cr),O(2,at)],jw);class g6{constructor(e,i,n,s){this._onDidChangeConfiguration=new L;this._proxy=e;this._logService=s;this._extHostWorkspace=i;this._configuration=qw.parse(n,s);this._configurationScopes=this._toMap(n.configurationScopes)}get onDidChangeConfiguration(){return this._onDidChangeConfiguration&&this._onDidChangeConfiguration.event}$acceptConfigurationChanged(e,i){const n={data:this._configuration.toData(),workspace:this._extHostWorkspace.workspace};this._configuration=qw.parse(e,this._logService);this._configurationScopes=this._toMap(e.configurationScopes);this._onDidChangeConfiguration.fire(this._toConfigurationChangeEvent(i,n))}getConfiguration(e,i,n){const s=kS(i)||{};const r=this._toReadonlyValue(this._configuration.getValue(e,s,this._extHostWorkspace.workspace));if(e){this._validateConfigurationAccess(e,s,n?.identifier)}function o(l){if(l===void 0||l===null){return null}if(typeof l==="boolean"){return l?di.USER:di.WORKSPACE}switch(l){case Rl.Global:return di.USER;case Rl.Workspace:return di.WORKSPACE;case Rl.WorkspaceFolder:return di.WORKSPACE_FOLDER}}const a={has(l){return typeof Nh(r,l)!=="undefined"},get:(l,c)=>{this._validateConfigurationAccess(e?`${e}.${l}`:l,s,n?.identifier);let u=Nh(r,l);if(typeof u==="undefined"){u=c}else{let d=void 0;const p=(f,m)=>{if(Yt(f)){let v=void 0;const y=()=>{d=d?d:vt(r);v=v?v:Nh(d,m)};return new Proxy(f,{get:(D,I)=>{if(typeof I==="string"&&I.toLowerCase()==="tojson"){y();return()=>v}if(d){v=v?v:Nh(d,m);return v[I]}const R=D[I];if(typeof I==="string"){return p(R,`${m}.${I}`)}return R},set:(D,I,R)=>{y();if(v){v[I]=R}return true},deleteProperty:(D,I)=>{y();if(v){delete v[I]}return true},defineProperty:(D,I,R)=>{y();if(v){Object.defineProperty(v,I,R)}return true}})}if(Array.isArray(f)){return vt(f)}return f};u=p(u,l)}return u},update:(l,c,u,d)=>{l=e?`${e}.${l}`:l;const p=o(u);if(c!==void 0){return this._proxy.$updateConfigurationOption(p,l,c,s,d)}else{return this._proxy.$removeConfigurationOption(p,l,s,d)}},inspect:l=>{l=e?`${e}.${l}`:l;const c=this._configuration.inspect(l,s,this._extHostWorkspace.workspace);if(c){return{key:l,defaultValue:vt(c.policy?.value??c.default?.value),globalLocalValue:vt(c.userLocal?.value),globalRemoteValue:vt(c.userRemote?.value),globalValue:vt(c.user?.value??c.application?.value),workspaceValue:vt(c.workspace?.value),workspaceFolderValue:vt(c.workspaceFolder?.value),defaultLanguageValue:vt(c.default?.override),globalLocalLanguageValue:vt(c.userLocal?.override),globalRemoteLanguageValue:vt(c.userRemote?.override),globalLanguageValue:vt(c.user?.override??c.application?.override),workspaceLanguageValue:vt(c.workspace?.override),workspaceFolderLanguageValue:vt(c.workspaceFolder?.override),languageIds:vt(c.overrideIdentifiers)}}return void 0}};if(typeof r==="object"){Ea(a,r,false)}return Object.freeze(a)}_toReadonlyValue(e){const i=n=>{return Yt(n)?new Proxy(n,{get:(s,r)=>i(s[r]),set:(s,r,o)=>{throw new Error(`TypeError: Cannot assign to read only property '${String(r)}' of object`)},deleteProperty:(s,r)=>{throw new Error(`TypeError: Cannot delete read only property '${String(r)}' of object`)},defineProperty:(s,r)=>{throw new Error(`TypeError: Cannot define property '${String(r)}' for a readonly object`)},setPrototypeOf:s=>{throw new Error(`TypeError: Cannot set prototype for a readonly object`)},isExtensible:()=>false,preventExtensions:()=>true}):n};return i(e)}_validateConfigurationAccess(e,i,n){const s=As.test(e)?wt.RESOURCE:this._configurationScopes.get(e);const r=n?`[${n.value}] `:"";if(wt.RESOURCE===s){if(typeof i?.resource==="undefined"){this._logService.warn(`${r}Accessing a resource scoped configuration without providing a resource is not expected. To get the effective value for '${e}', provide the URI of a resource or 'null' for any resource.`)}return}if(wt.WINDOW===s){if(i?.resource){this._logService.warn(`${r}Accessing a window scoped configuration for a resource is not expected. To associate '${e}' to a resource, define its scope to 'resource' in configuration contributions in 'package.json'.`)}return}}_toConfigurationChangeEvent(e,i){const n=new u6(e,i,this._configuration,this._extHostWorkspace.workspace,this._logService);return Object.freeze({affectsConfiguration:(s,r)=>n.affectsConfiguration(s,kS(r))})}_toMap(e){return e.reduce((i,n)=>{i.set(n[0],n[1]);return i},new Map)}}const Tr=xe("IExtHostConfiguration");class m6{constructor(e,i){this.versionId=e;this.removedDueToLooping=i}}class wa extends Ee{static isHostExtension(e,i,n){if(i.getExtensionDescription(e)){return false}const s=n.getExtensionDescription(e);if(!s){return false}if((s.main||s.browser)&&s.api==="none"){return true}return false}constructor(e,i){super();this._activationEventsReader=e;this._onDidChange=this._register(new L);this.onDidChange=this._onDidChange.event;this._versionId=0;this._extensionDescriptions=i;this._initialize()}_initialize(){this._extensionDescriptions.sort(v6);this._extensionsMap=new Sr;this._extensionsArr=[];this._activationMap=new Map;for(const e of this._extensionDescriptions){if(this._extensionsMap.has(e.identifier)){console.error("Extension `"+e.identifier.value+"` is already registered");continue}this._extensionsMap.set(e.identifier,e);this._extensionsArr.push(e);const i=this._activationEventsReader.readActivationEvents(e);for(const n of i){if(!this._activationMap.has(n)){this._activationMap.set(n,[])}this._activationMap.get(n).push(e)}}}set(e){this._extensionDescriptions=e;this._initialize();this._versionId++;this._onDidChange.fire(void 0);return{versionId:this._versionId}}deltaExtensions(e,i){this._extensionDescriptions=IS(this._extensionDescriptions,i);this._extensionDescriptions=this._extensionDescriptions.concat(e);const n=wa._findLoopingExtensions(this._extensionDescriptions);this._extensionDescriptions=IS(this._extensionDescriptions,n.map(s=>s.identifier));this._initialize();this._versionId++;this._onDidChange.fire(void 0);return new m6(this._versionId,n)}static _findLoopingExtensions(e){const i=new class{constructor(){this._arcs=new Map;this._nodesSet=new Set;this._nodesArr=[]}addNode(a){if(!this._nodesSet.has(a)){this._nodesSet.add(a);this._nodesArr.push(a)}}addArc(a,l){this.addNode(a);this.addNode(l);if(this._arcs.has(a)){this._arcs.get(a).push(l)}else{this._arcs.set(a,[l])}}getArcs(a){if(this._arcs.has(a)){return this._arcs.get(a)}return[]}hasOnlyGoodArcs(a,l){const c=i.getArcs(a);for(let u=0;u<c.length;u++){if(!l.has(c[u])){return false}}return true}getNodes(){return this._nodesArr}};const n=new Sr;for(const a of e){n.set(a.identifier,a);if(a.extensionDependencies){for(const l of a.extensionDependencies){i.addArc(Ze.toKey(a.identifier),Ze.toKey(l))}}}const s=new Set;i.getNodes().filter(a=>i.getArcs(a).length===0).forEach(a=>s.add(a));const r=i.getNodes().filter(a=>!s.has(a));let o;do{o=false;for(let a=0;a<r.length;a++){const l=r[a];if(i.hasOnlyGoodArcs(l,s)){r.splice(a,1);a--;s.add(l);o=true}}}while(o);return r.map(a=>n.get(a))}containsActivationEvent(e){return this._activationMap.has(e)}containsExtension(e){return this._extensionsMap.has(e)}getExtensionDescriptionsForActivationEvent(e){const i=this._activationMap.get(e);return i?i.slice(0):[]}getAllExtensionDescriptions(){return this._extensionsArr.slice(0)}getSnapshot(){return new _6(this._versionId,this.getAllExtensionDescriptions())}getExtensionDescription(e){const i=this._extensionsMap.get(e);return i?i:void 0}getExtensionDescriptionByUUID(e){for(const i of this._extensionsArr){if(i.uuid===e){return i}}return void 0}getExtensionDescriptionByIdOrUUID(e,i){return this.getExtensionDescription(e)??(i?this.getExtensionDescriptionByUUID(i):void 0)}}class _6{constructor(e,i){this.versionId=e;this.extensions=i}}var Wr;(function(t){t[t["Builtin"]=0]="Builtin";t[t["User"]=1]="User";t[t["Dev"]=2]="Dev"})(Wr||(Wr={}));function v6(t,e){const i=t.isBuiltin?Wr.Builtin:t.isUnderDevelopment?Wr.Dev:Wr.User;const n=e.isBuiltin?Wr.Builtin:e.isUnderDevelopment?Wr.Dev:Wr.User;if(i!==n){return i-n}const s=ct.basename(t.extensionLocation.path);const r=ct.basename(e.extensionLocation.path);if(s<r){return-1}if(s>r){return 1}return 0}function IS(t,e){const i=new La(e);return t.filter(n=>!i.has(n.identifier))}class Lc{static{this.NONE=new Lc(false,-1,-1,-1)}constructor(e,i,n,s){this.startup=e;this.codeLoadingTime=i;this.activateCallTime=n;this.activateResolvedTime=s}}class P1{constructor(e){this._startup=e;this._codeLoadingStart=-1;this._codeLoadingStop=-1;this._activateCallStart=-1;this._activateCallStop=-1;this._activateResolveStart=-1;this._activateResolveStop=-1}_delta(e,i){if(e===-1||i===-1){return-1}return i-e}build(){return new Lc(this._startup,this._delta(this._codeLoadingStart,this._codeLoadingStop),this._delta(this._activateCallStart,this._activateCallStop),this._delta(this._activateResolveStart,this._activateResolveStop))}codeLoadingStart(){this._codeLoadingStart=Date.now()}codeLoadingStop(){this._codeLoadingStop=Date.now()}activateCallStart(){this._activateCallStart=Date.now()}activateCallStop(){this._activateCallStop=Date.now()}activateResolveStart(){this._activateResolveStart=Date.now()}activateResolveStop(){this._activateResolveStop=Date.now()}}class $m{constructor(e,i,n,s,r,o){this.activationFailed=e;this.activationFailedError=i;this.activationTimes=n;this.module=s;this.exports=r;this.disposable=o}}class w6 extends $m{constructor(e){super(false,null,e,{activate:void 0,deactivate:void 0},void 0,Ee.None)}}class b6 extends $m{constructor(){super(false,null,Lc.NONE,{activate:void 0,deactivate:void 0},void 0,Ee.None)}}class Xg extends $m{constructor(e){super(true,e,Lc.NONE,{activate:void 0,deactivate:void 0},void 0,Ee.None)}}let Gw=class u${constructor(e,i,n,s){this._logService=s;this._registry=e;this._globalRegistry=i;this._host=n;this._operations=new Sr;this._alreadyActivatedEvents=Object.create(null)}dispose(){for(const[e,i]of this._operations){i.dispose()}}async waitForActivatingExtensions(){const e=[];for(const[i,n]of this._operations){e.push(n.wait())}await Promise.all(e)}isActivated(e){const i=this._operations.get(e);return Boolean(i&&i.value)}getActivatedExtension(e){const i=this._operations.get(e);if(!i||!i.value){throw new Error(`Extension '${e.value}' is not known or not activated`)}return i.value}async activateByEvent(e,i){if(this._alreadyActivatedEvents[e]){return}const n=this._registry.getExtensionDescriptionsForActivationEvent(e);await this._activateExtensions(n.map(s=>({id:s.identifier,reason:{startup:i,extensionId:s.identifier,activationEvent:e}})));this._alreadyActivatedEvents[e]=true}activateById(e,i){const n=this._registry.getExtensionDescription(e);if(!n){throw new Error(`Extension '${e.value}' is not known`)}return this._activateExtensions([{id:n.identifier,reason:i}])}async _activateExtensions(e){const i=e.filter(n=>!this.isActivated(n.id)).map(n=>this._handleActivationRequest(n));await Promise.all(i.map(n=>n.wait()))}_handleActivationRequest(e){if(this._operations.has(e.id)){return this._operations.get(e.id)}if(this._isHostExtension(e.id)){return this._createAndSaveOperation(e,null,[],null)}const i=this._registry.getExtensionDescription(e.id);if(!i){const r=new Error(`Cannot activate unknown extension '${e.id.value}'`);const o=this._createAndSaveOperation(e,null,[],new Xg(r));this._host.onExtensionActivationError(e.id,r,new C2(e.id.value));return o}const n=[];const s=typeof i.extensionDependencies==="undefined"?[]:i.extensionDependencies;for(const r of s){if(this._isResolvedExtension(r)){continue}const o=this._operations.get(r);if(o){n.push(o);continue}if(this._isHostExtension(r)){n.push(this._handleActivationRequest({id:this._globalRegistry.getExtensionDescription(r).identifier,reason:e.reason}));continue}const a=this._registry.getExtensionDescription(r);if(a){if(!a.main&&!a.browser){continue}n.push(this._handleActivationRequest({id:a.identifier,reason:e.reason}));continue}const l=i.displayName||i.identifier.value;const c=new Error(`Cannot activate the '${l}' extension because it depends on unknown extension '${r}'`);const u=this._createAndSaveOperation(e,i.displayName,[],new Xg(c));this._host.onExtensionActivationError(i.identifier,c,new C2(r));return u}return this._createAndSaveOperation(e,i.displayName,n,null)}_createAndSaveOperation(e,i,n,s){const r=new Kw(e.id,i,e.reason,n,s,this._host,this._logService);this._operations.set(e.id,r);return r}_isHostExtension(e){return wa.isHostExtension(e,this._registry,this._globalRegistry)}_isResolvedExtension(e){const i=this._globalRegistry.getExtensionDescription(e);if(!i){return false}return!i.main&&!i.browser}};Gw=z([O(3,at)],Gw);let Kw=class d${get value(){return this._value}get friendlyName(){return this._displayName||this._id.value}constructor(e,i,n,s,r,o,a){this._id=e;this._displayName=i;this._reason=n;this._deps=s;this._value=r;this._host=o;this._logService=a;this._barrier=new xs;this._isDisposed=false;this._initialize()}dispose(){this._isDisposed=true}wait(){return this._barrier.wait()}async _initialize(){await this._waitForDepsThenActivate();this._barrier.open()}async _waitForDepsThenActivate(){if(this._value){return}while(this._deps.length>0){for(let e=0;e<this._deps.length;e++){const i=this._deps[e];if(i.value&&!i.value.activationFailed){this._deps.splice(e,1);e--;continue}if(i.value&&i.value.activationFailed){const n=new Error(`Cannot activate the '${this.friendlyName}' extension because its dependency '${i.friendlyName}' failed to activate`);n.detail=i.value.activationFailedError;this._value=new Xg(n);this._host.onExtensionActivationError(this._id,n,null);return}}if(this._deps.length>0){await Promise.race(this._deps.map(e=>e.wait()))}}await this._activate()}async _activate(){try{this._value=await this._host.actualActivateExtension(this._id,this._reason)}catch(e){const i=new Error;if(e&&e.name){i.name=e.name}if(e&&e.message){i.message=`Activating extension '${this._id.value}' failed: ${e.message}.`}else{i.message=`Activating extension '${this._id.value}' failed: ${e}.`}if(e&&e.stack){i.stack=e.stack}this._value=new Xg(i);if(this._isDisposed&&fo(e)){return}this._host.onExtensionActivationError(this._id,i,null);this._logService.error(`Activating extension ${this._id.value} failed due to an error:`);this._logService.error(e)}}};Kw=z([O(6,at)],Kw);class EC{constructor(e,i){this._logService=i;this._onDidChangeStorage=new L;this.onDidChangeStorage=this._onDidChangeStorage.event;this._proxy=e.getProxy(Y.MainThreadStorage)}registerExtensionStorageKeysToSync(e,i){this._proxy.$registerExtensionStorageKeysToSync(e,i)}async initializeExtensionStorage(e,i,n){const s=await this._proxy.$initializeExtensionStorage(e,i);let r;if(s){r=this.safeParseValue(e,i,s)}return r||n}setValue(e,i,n){return this._proxy.$setValue(e,i,n)}$acceptValue(e,i,n){const s=this.safeParseValue(e,i,n);if(s){this._onDidChangeStorage.fire({shared:e,key:i,value:s})}}safeParseValue(e,i,n){try{return JSON.parse(n)}catch(s){this._logService.error(`[extHostStorage] unexpected error parsing storage contents (extensionId: ${i}, global: ${e}): ${s}`)}return void 0}}const fy=xe("IExtHostStorage");class SC{constructor(e,i,n){this._deferredPromises=new Map;this._id=e;this._shared=i;this._storage=n;this._init=this._storage.initializeExtensionStorage(this._shared,this._id,Object.create(null)).then(s=>{this._value=s;return this});this._storageListener=this._storage.onDidChangeStorage(s=>{if(s.shared===this._shared&&s.key===this._id){this._value=s.value}});this._scheduler=new Ic(()=>{const s=this._deferredPromises;this._deferredPromises=new Map;(async()=>{try{await this._storage.setValue(this._shared,this._id,this._value);for(const r of s.values()){r.complete()}}catch(r){for(const o of s.values()){o.error(r)}}})()},0)}keys(){return Object.entries(this._value??{}).filter(([,e])=>e!==void 0).map(([e])=>e)}get whenReady(){return this._init}get(e,i){let n=this._value[e];if(typeof n==="undefined"){n=i}return n}update(e,i){if(i!==null&&typeof i==="object"){this._value[e]=JSON.parse(JSON.stringify(i))}else{this._value[e]=i}const n=this._deferredPromises.get(e);if(n!==void 0){return n.p}const s=new Fs;this._deferredPromises.set(e,s);if(!this._scheduler.isScheduled()){this._scheduler.schedule()}return s.p}dispose(){this._storageListener.dispose()}}class y6 extends SC{setKeysForSync(e){this._storage.registerExtensionStorageKeysToSync({id:this._id,version:this._extension.version},e)}constructor(e,i){super(e.identifier.value,true,i);this._extension=e}}var gs;let Qw=gs=class h${constructor(e,i){this._fileSystemProvider=new Map;this._writeQueue=new FP;this._proxy=e.getProxy(Y.MainThreadFileSystem);const n=this;this.value=Object.freeze({async stat(s){try{let r;const o=n._fileSystemProvider.get(s.scheme);if(o){await n._proxy.$ensureActivation(s.scheme);r=await o.impl.stat(s)}else{r=await n._proxy.$stat(s)}return{type:r.type,ctime:r.ctime,mtime:r.mtime,size:r.size,permissions:r.permissions===Ql.Readonly?1:void 0}}catch(r){gs._handleError(r)}},async readDirectory(s){try{const r=n._fileSystemProvider.get(s.scheme);if(r){await n._proxy.$ensureActivation(s.scheme);return(await r.impl.readDirectory(s)).slice()}else{return await n._proxy.$readdir(s)}}catch(r){return gs._handleError(r)}},async createDirectory(s){try{const r=n._fileSystemProvider.get(s.scheme);if(r&&!r.isReadonly){await n._proxy.$ensureActivation(s.scheme);return await n.mkdirp(r.impl,r.extUri,s)}else{return await n._proxy.$mkdir(s)}}catch(r){return gs._handleError(r)}},async readFile(s){try{const r=n._fileSystemProvider.get(s.scheme);if(r){await n._proxy.$ensureActivation(s.scheme);return(await r.impl.readFile(s)).slice()}else{const o=await n._proxy.$readFile(s);return o.buffer}}catch(r){return gs._handleError(r)}},async writeFile(s,r){try{const o=n._fileSystemProvider.get(s.scheme);if(o&&!o.isReadonly){await n._proxy.$ensureActivation(s.scheme);await n.mkdirp(o.impl,o.extUri,o.extUri.dirname(s));return await n._writeQueue.queueFor(s,()=>Promise.resolve(o.impl.writeFile(s,r,{create:true,overwrite:true})))}else{return await n._proxy.$writeFile(s,ue.wrap(r))}}catch(o){return gs._handleError(o)}},async delete(s,r){try{const o=n._fileSystemProvider.get(s.scheme);if(o&&!o.isReadonly&&!r?.useTrash){await n._proxy.$ensureActivation(s.scheme);return await o.impl.delete(s,{recursive:false,...r})}else{return await n._proxy.$delete(s,{recursive:false,useTrash:false,atomic:false,...r})}}catch(o){return gs._handleError(o)}},async rename(s,r,o){try{return await n._proxy.$rename(s,r,{...{overwrite:false},...o})}catch(a){return gs._handleError(a)}},async copy(s,r,o){try{return await n._proxy.$copy(s,r,{...{overwrite:false},...o})}catch(a){return gs._handleError(a)}},isWritableFileSystem(s){const r=i.getCapabilities(s);if(typeof r==="number"){return!(r&ws.Readonly)}return void 0}})}async mkdirp(e,i,n){const s=[];while(!i.isEqual(n,i.dirname(n))){try{const r=await e.stat(n);if((r.type&ra.Directory)===0){throw si.FileExists(`Unable to create folder '${n.scheme===ae.file?n.fsPath:n.toString(true)}' that already exists but is not a directory`)}break}catch(r){if(Bf(r)!==Le.FileNotFound){throw r}s.push(i.basename(n));n=i.dirname(n)}}for(let r=s.length-1;r>=0;r--){n=i.joinPath(n,s[r]);try{await e.createDirectory(n)}catch(o){if(Bf(o)!==Le.FileExists){throw o}}}}static _handleError(e){if(e instanceof si){throw e}if(e instanceof bm){switch(e.code){case Le.FileExists:throw si.FileExists(e.message);case Le.FileNotFound:throw si.FileNotFound(e.message);case Le.FileNotADirectory:throw si.FileNotADirectory(e.message);case Le.FileIsADirectory:throw si.FileIsADirectory(e.message);case Le.NoPermissions:throw si.NoPermissions(e.message);case Le.Unavailable:throw si.Unavailable(e.message);default:throw new si(e.message,e.name)}}if(!(e instanceof Error)){throw new si(String(e))}if(e.name==="ENOPRO"||e.message.includes("ENOPRO")){throw si.Unavailable(e.message)}switch(e.name){case Le.FileExists:throw si.FileExists(e.message);case Le.FileNotFound:throw si.FileNotFound(e.message);case Le.FileNotADirectory:throw si.FileNotADirectory(e.message);case Le.FileIsADirectory:throw si.FileIsADirectory(e.message);case Le.NoPermissions:throw si.NoPermissions(e.message);case Le.Unavailable:throw si.Unavailable(e.message);default:throw new si(e.message,e.name)}}addFileSystemProvider(e,i,n){this._fileSystemProvider.set(e,{impl:i,extUri:n?.isCaseSensitive?nt:yP,isReadonly:!!n?.isReadonly});return ge(()=>this._fileSystemProvider.delete(e))}getFileSystemProviderExtUri(e){return this._fileSystemProvider.get(e)?.extUri??nt}};Qw=gs=z([O(0,st),O(1,Tc)],Qw);const Hm=xe("IExtHostConsumerFileSystem");const py=xe("IExtensionStoragePaths");let Jw=class f${constructor(e,i,n){this._logService=i;this._extHostFileSystem=n;this._workspace=e.workspace??void 0;this._environment=e.environment;this.whenReady=this._getOrCreateWorkspaceStoragePath().then(s=>this._value=s)}async _getWorkspaceStorageURI(e){return b.joinPath(this._environment.workspaceStorageHome,e)}async _getOrCreateWorkspaceStoragePath(){if(!this._workspace){return Promise.resolve(void 0)}const e=this._workspace.id;const i=await this._getWorkspaceStorageURI(e);try{await this._extHostFileSystem.value.stat(i);this._logService.trace("[ExtHostStorage] storage dir already exists",i);return i}catch{}try{this._logService.trace("[ExtHostStorage] creating dir and metadata-file",i);await this._extHostFileSystem.value.createDirectory(i);await this._extHostFileSystem.value.writeFile(b.joinPath(i,"meta.json"),new TextEncoder().encode(JSON.stringify({id:this._workspace.id,configuration:b.revive(this._workspace.configuration)?.toString(),name:this._workspace.name},void 0,2)));return i}catch(n){this._logService.error("[ExtHostStorage]",n);return void 0}}workspaceValue(e){if(this._value){return b.joinPath(this._value,e.identifier.value)}return void 0}globalValue(e){return b.joinPath(this._environment.globalStorageHome,e.identifier.value.toLowerCase())}onWillDeactivateAll(){}};Jw=z([O(0,Ai),O(1,at),O(2,Hm)],Jw);const Bm=xe("configurationService");var CS;(function(t){t["Http"]="http";t["Https"]="https"})(CS||(CS={}));var ea;(function(t){t["ConstantPrivate"]="constantPrivate";t["Private"]="private";t["Public"]="public"})(ea||(ea={}));var TS;(function(t){t[t["Notify"]=1]="Notify";t[t["OpenBrowser"]=2]="OpenBrowser";t[t["OpenPreview"]=3]="OpenPreview";t[t["Silent"]=4]="Silent";t[t["Ignore"]=5]="Ignore";t[t["OpenBrowserOnce"]=6]="OpenBrowserOnce"})(TS||(TS={}));function x6(t){if(t.scheme!=="http"&&t.scheme!=="https"){return void 0}const e=/^(localhost|127\.0\.0\.1|0\.0\.0\.0):(\d+)$/.exec(t.authority);if(!e){return void 0}return{address:e[1],port:+e[2]}}const Xw=["localhost","127.0.0.1","0:0:0:0:0:0:0:1","::1"];function PS(t){return Xw.indexOf(t)>=0}const Yw=["0.0.0.0","0:0:0:0:0:0:0:0","::"];function AS(t){return Yw.indexOf(t)>=0}class E6{constructor(e,i,n){this.remoteAddress=e;this.localAddress=i;this._dispose=n;this._onDispose=new L;this.onDidDispose=this._onDispose.event}dispose(){this._onDispose.fire();return this._dispose()}}let RS=class p$ extends Ee{constructor(e,i){super();this.logService=e;this.configurationService=i;this._onTunnelOpened=new L;this.onTunnelOpened=this._onTunnelOpened.event;this._onTunnelClosed=new L;this.onTunnelClosed=this._onTunnelClosed.event;this._onAddedTunnelProvider=new L;this.onAddedTunnelProvider=this._onAddedTunnelProvider.event;this._tunnels=new Map;this._canElevate=false;this._canChangeProtocol=true;this._privacyOptions=[];this._factoryInProgress=new Set}get hasTunnelProvider(){return!!this._tunnelProvider}get defaultTunnelHost(){const e=this.configurationService.getValue("remote.localPortHost");return!e||e==="localhost"?"127.0.0.1":"0.0.0.0"}setTunnelProvider(e){this._tunnelProvider=e;if(!e){this._canElevate=false;this._privacyOptions=[];this._onAddedTunnelProvider.fire();return{dispose:()=>{}}}this._onAddedTunnelProvider.fire();return{dispose:()=>{this._tunnelProvider=void 0;this._canElevate=false;this._privacyOptions=[]}}}setTunnelFeatures(e){this._canElevate=e.elevation;this._privacyOptions=e.privacyOptions;this._canChangeProtocol=e.protocol}get canChangeProtocol(){return this._canChangeProtocol}get canElevate(){return this._canElevate}get canChangePrivacy(){return this._privacyOptions.length>0}get privacyOptions(){return this._privacyOptions}get tunnels(){return this.getTunnels()}async getTunnels(){const e=[];const i=Array.from(this._tunnels.values());for(const n of i){const s=Array.from(n.values());for(const r of s){const o=await r.value;if(o&&typeof o!=="string"){e.push(o)}}}return e}async dispose(){super.dispose();for(const e of this._tunnels.values()){for(const{value:i}of e.values()){await i.then(n=>typeof n!=="string"?n?.dispose():void 0)}e.clear()}this._tunnels.clear()}setEnvironmentTunnel(e,i,n,s,r){this.addTunnelToMap(e,i,Promise.resolve({tunnelRemoteHost:e,tunnelRemotePort:i,localAddress:n,privacy:s,protocol:r,dispose:()=>Promise.resolve()}))}async getExistingTunnel(e,i){if(AS(e)||PS(e)){e=Xw[0]}const n=this.getTunnelFromMap(e,i);if(n){++n.refcount;return n.value}return void 0}openTunnel(e,i,n,s,r,o=false,a,l){this.logService.trace(`ForwardedPorts: (TunnelService) openTunnel request for ${i}:${n} on local port ${r}.`);const c=this._tunnelProvider??e;if(!c){return void 0}if(!i){i="localhost"}if(!s){s=this.defaultTunnelHost}if(this._tunnelProvider&&this._factoryInProgress.has(n)){this.logService.debug(`ForwardedPorts: (TunnelService) Another call to create a tunnel with the same address has occurred before the last one completed. This call will be ignored.`);return}const u=this.retainOrCreateTunnel(c,i,n,s,r,o,a,l);if(!u){this.logService.trace(`ForwardedPorts: (TunnelService) Tunnel was not created.`);return u}return u.then(d=>{if(!d){this.logService.trace("ForwardedPorts: (TunnelService) New tunnel is undefined.");this.removeEmptyOrErrorTunnelFromMap(i,n);return void 0}else if(typeof d==="string"){this.logService.trace("ForwardedPorts: (TunnelService) The tunnel provider returned an error when creating the tunnel.");this.removeEmptyOrErrorTunnelFromMap(i,n);return d}this.logService.trace("ForwardedPorts: (TunnelService) New tunnel established.");const p=this.makeTunnel(d);if(d.tunnelRemoteHost!==i||d.tunnelRemotePort!==n){this.logService.warn("ForwardedPorts: (TunnelService) Created tunnel does not match requirements of requested tunnel. Host or port mismatch.")}if(a&&d.privacy!==a){this.logService.warn("ForwardedPorts: (TunnelService) Created tunnel does not match requirements of requested tunnel. Privacy mismatch.")}this._onTunnelOpened.fire(p);return p})}makeTunnel(e){return{tunnelRemotePort:e.tunnelRemotePort,tunnelRemoteHost:e.tunnelRemoteHost,tunnelLocalPort:e.tunnelLocalPort,localAddress:e.localAddress,privacy:e.privacy,protocol:e.protocol,dispose:async()=>{this.logService.trace(`ForwardedPorts: (TunnelService) dispose request for ${e.tunnelRemoteHost}:${e.tunnelRemotePort} `);const i=this._tunnels.get(e.tunnelRemoteHost);if(i){const n=i.get(e.tunnelRemotePort);if(n){n.refcount--;await this.tryDisposeTunnel(e.tunnelRemoteHost,e.tunnelRemotePort,n)}}}}}async tryDisposeTunnel(e,i,n){if(n.refcount<=0){this.logService.trace(`ForwardedPorts: (TunnelService) Tunnel is being disposed ${e}:${i}.`);const s=n.value.then(async r=>{if(r&&typeof r!=="string"){await r.dispose(true);this._onTunnelClosed.fire({host:r.tunnelRemoteHost,port:r.tunnelRemotePort})}});if(this._tunnels.has(e)){this._tunnels.get(e).delete(i)}return s}}async closeTunnel(e,i){this.logService.trace(`ForwardedPorts: (TunnelService) close request for ${e}:${i} `);const n=this._tunnels.get(e);if(n&&n.has(i)){const s=n.get(i);s.refcount=0;await this.tryDisposeTunnel(e,i,s)}}addTunnelToMap(e,i,n){if(!this._tunnels.has(e)){this._tunnels.set(e,new Map)}this._tunnels.get(e).set(i,{refcount:1,value:n})}async removeEmptyOrErrorTunnelFromMap(e,i){const n=this._tunnels.get(e);if(n){const s=n.get(i);const r=s?await s.value:void 0;if(!r||typeof r==="string"){n.delete(i)}if(n.size===0){this._tunnels.delete(e)}}}getTunnelFromMap(e,i){const n=[e];if(PS(e)){n.push(...Xw);n.push(...Yw)}else if(AS(e)){n.push(...Yw)}const s=n.map(r=>this._tunnels.get(r));for(const r of s){const o=r?.get(i);if(o){return o}}return void 0}canTunnel(e){return!!x6(e)}createWithProvider(e,i,n,s,r,o,a){this.logService.trace(`ForwardedPorts: (TunnelService) Creating tunnel with provider ${i}:${n} on local port ${s}.`);const l=n;this._factoryInProgress.add(l);const c=s===void 0?n:s;const u={elevationRequired:r?this.isPortPrivileged(c):false};const d={remoteAddress:{host:i,port:n},localAddressPort:s,privacy:o,public:o?o!==ea.Private:void 0,protocol:a};const p=e.forwardPort(d,u);if(p){this.addTunnelToMap(i,n,p);p.finally(()=>{this.logService.trace("ForwardedPorts: (TunnelService) Tunnel created by provider.");this._factoryInProgress.delete(l)})}else{this._factoryInProgress.delete(l)}return p}};RS=z([O(0,at),O(1,Bm)],RS);class S6 extends E6{}var Zw;(function(t){function e(n){return{remoteAddress:n.remoteAddress,localAddress:n.localAddress,public:!!n.public,privacy:n.privacy??(n.public?ea.Public:ea.Private),protocol:n.protocol}}t.fromApiTunnel=e;function i(n){return{remoteAddress:{host:n.tunnelRemoteHost,port:n.tunnelRemotePort},localAddress:n.localAddress,public:n.privacy!==ea.ConstantPrivate&&n.privacy!==ea.ConstantPrivate,privacy:n.privacy,protocol:n.protocol}}t.fromServiceTunnel=i})(Zw||(Zw={}));const gy=xe("IExtHostTunnelService");let eb=class g$ extends Ee{constructor(e,i,n){super();this.logService=n;this._showCandidatePort=()=>{return Promise.resolve(true)};this._extensionTunnels=new Map;this._onDidChangeTunnels=new L;this.onDidChangeTunnels=this._onDidChangeTunnels.event;this._providerHandleCounter=0;this._portAttributesProviders=new Map;this._proxy=e.getProxy(Y.MainThreadTunnelService)}async openTunnel(e,i){this.logService.trace(`ForwardedPorts: (ExtHostTunnelService) ${e.identifier.value} called openTunnel API for ${i.remoteAddress.host}:${i.remoteAddress.port}.`);const n=await this._proxy.$openTunnel(i,e.displayName);if(n){const s=new S6(n.remoteAddress,n.localAddress,()=>{return this._proxy.$closeTunnel(n.remoteAddress)});this._register(s);return s}return void 0}async getTunnels(){return this._proxy.$getTunnels()}nextPortAttributesProviderHandle(){return this._providerHandleCounter++}registerPortsAttributesProvider(e,i){if(e.portRange===void 0&&e.commandPattern===void 0){this.logService.error("PortAttributesProvider must specify either a portRange or a commandPattern")}const n=this.nextPortAttributesProviderHandle();this._portAttributesProviders.set(n,{selector:e,provider:i});this._proxy.$registerPortsAttributesProvider(e,n);return new qe(()=>{this._portAttributesProviders.delete(n);this._proxy.$unregisterPortsAttributesProvider(n)})}async $providePortAttributes(e,i,n,s,r){const o=[];for(const l of e){const c=this._portAttributesProviders.get(l);if(!c){return[]}o.push(...await Promise.all(i.map(async u=>{let d;try{d=await c.provider.providePortAttributes({port:u,pid:n,commandLine:s},r)}catch(p){d=await c.provider.providePortAttributes(u,n,s,r)}return{providedAttributes:d,port:u}})))}const a=o.filter(l=>!!l.providedAttributes);return a.length>0?a.map(l=>{return{autoForwardAction:l.providedAttributes.autoForwardAction,port:l.port}}):[]}async $registerCandidateFinder(e){}registerTunnelProvider(e,i){if(this._forwardPortProvider){throw new Error("A tunnel provider has already been registered. Only the first tunnel provider to be registered will be used.")}this._forwardPortProvider=async(s,r)=>{const o=await e.provideTunnel(s,r,bt.None);return o??void 0};const n=i.tunnelFeatures?{elevation:!!i.tunnelFeatures?.elevation,privacyOptions:i.tunnelFeatures?.privacyOptions,protocol:i.tunnelFeatures.protocol===void 0?true:i.tunnelFeatures.protocol}:void 0;this._proxy.$setTunnelProvider(n,true);return Promise.resolve(ge(()=>{this._forwardPortProvider=void 0;this._proxy.$setTunnelProvider(void 0,false)}))}async setTunnelFactory(e,i){if(e){if(e.candidatePortSource!==void 0){this._proxy.$setCandidatePortSource(e.candidatePortSource)}if(e.showCandidatePort){this._showCandidatePort=e.showCandidatePort;this._proxy.$setCandidateFilter()}const n=e.tunnelFactory??(i?this.makeManagedTunnelFactory(i):void 0);if(n){this._forwardPortProvider=n;let s=e.tunnelFeatures?.privacyOptions??[];if(e.tunnelFeatures?.public&&s.length===0){s=[{id:"private",label:h(2571,"Private"),themeIcon:"lock"},{id:"public",label:h(2572,"Public"),themeIcon:"eye"}]}const r=e.tunnelFeatures?{elevation:!!e.tunnelFeatures?.elevation,public:!!e.tunnelFeatures?.public,privacyOptions:s,protocol:true}:void 0;this._proxy.$setTunnelProvider(r,!!e.tunnelFactory)}}else{this._forwardPortProvider=void 0}return ge(()=>{this._forwardPortProvider=void 0})}makeManagedTunnelFactory(e){return void 0}async $closeTunnel(e,i){if(this._extensionTunnels.has(e.host)){const n=this._extensionTunnels.get(e.host);if(n.has(e.port)){if(i){n.get(e.port).disposeListener.dispose()}await n.get(e.port).tunnel.dispose();n.delete(e.port)}}}async $onDidTunnelsChange(){this._onDidChangeTunnels.fire()}async $forwardPort(e,i){if(this._forwardPortProvider){try{this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Getting tunnel from provider.");const n=this._forwardPortProvider(e,i);this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Got tunnel promise from provider.");if(n!==void 0){const s=await n;this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Successfully awaited tunnel from provider.");if(s===void 0){this.logService.error("ForwardedPorts: (ExtHostTunnelService) Resolved tunnel is undefined");return void 0}if(!this._extensionTunnels.has(e.remoteAddress.host)){this._extensionTunnels.set(e.remoteAddress.host,new Map)}const r=this._register(s.onDidDispose(()=>{this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Extension fired tunnel's onDidDispose.");return this._proxy.$closeTunnel(s.remoteAddress)}));this._extensionTunnels.get(e.remoteAddress.host).set(e.remoteAddress.port,{tunnel:s,disposeListener:r});return Zw.fromApiTunnel(s)}else{this.logService.trace("ForwardedPorts: (ExtHostTunnelService) Tunnel is undefined")}}catch(n){this.logService.trace("ForwardedPorts: (ExtHostTunnelService) tunnel provider error");if(n instanceof Error){return n.message}}}return void 0}async $applyCandidateFilter(e){const i=await Promise.all(e.map(s=>this._showCandidatePort(s.host,s.port,s.detail??"")));const n=e.filter((s,r)=>i[r]);this.logService.trace(`ForwardedPorts: (ExtHostTunnelService) filtered from ${e.map(s=>s.port).join(", ")} to ${n.map(s=>s.port).join(", ")}`);return n}};eb=z([O(0,st),O(1,Ai),O(2,at)],eb);function D6(t){return[...t.entries()]}function k6(t){return t?[...t.entries()]:[]}var LS;(function(t){t["AutomationProfile"]="terminal.integrated.automationProfile.";t["DefaultProfile"]="terminal.integrated.defaultProfile.";t["Profiles"]="terminal.integrated.profiles."})(LS||(LS={}));var NS;(function(t){t["SendKeybindingsToShell"]="terminal.integrated.sendKeybindingsToShell";t["AutomationProfileLinux"]="terminal.integrated.automationProfile.linux";t["AutomationProfileMacOs"]="terminal.integrated.automationProfile.osx";t["AutomationProfileWindows"]="terminal.integrated.automationProfile.windows";t["ProfilesWindows"]="terminal.integrated.profiles.windows";t["ProfilesMacOs"]="terminal.integrated.profiles.osx";t["ProfilesLinux"]="terminal.integrated.profiles.linux";t["DefaultProfileLinux"]="terminal.integrated.defaultProfile.linux";t["DefaultProfileMacOs"]="terminal.integrated.defaultProfile.osx";t["DefaultProfileWindows"]="terminal.integrated.defaultProfile.windows";t["UseWslProfiles"]="terminal.integrated.useWslProfiles";t["TabsDefaultColor"]="terminal.integrated.tabs.defaultColor";t["TabsDefaultIcon"]="terminal.integrated.tabs.defaultIcon";t["TabsEnabled"]="terminal.integrated.tabs.enabled";t["TabsEnableAnimation"]="terminal.integrated.tabs.enableAnimation";t["TabsHideCondition"]="terminal.integrated.tabs.hideCondition";t["TabsShowActiveTerminal"]="terminal.integrated.tabs.showActiveTerminal";t["TabsShowActions"]="terminal.integrated.tabs.showActions";t["TabsLocation"]="terminal.integrated.tabs.location";t["TabsFocusMode"]="terminal.integrated.tabs.focusMode";t["MacOptionIsMeta"]="terminal.integrated.macOptionIsMeta";t["MacOptionClickForcesSelection"]="terminal.integrated.macOptionClickForcesSelection";t["AltClickMovesCursor"]="terminal.integrated.altClickMovesCursor";t["CopyOnSelection"]="terminal.integrated.copyOnSelection";t["EnableMultiLinePasteWarning"]="terminal.integrated.enableMultiLinePasteWarning";t["DrawBoldTextInBrightColors"]="terminal.integrated.drawBoldTextInBrightColors";t["FontFamily"]="terminal.integrated.fontFamily";t["FontSize"]="terminal.integrated.fontSize";t["LetterSpacing"]="terminal.integrated.letterSpacing";t["LineHeight"]="terminal.integrated.lineHeight";t["MinimumContrastRatio"]="terminal.integrated.minimumContrastRatio";t["TabStopWidth"]="terminal.integrated.tabStopWidth";t["FastScrollSensitivity"]="terminal.integrated.fastScrollSensitivity";t["MouseWheelScrollSensitivity"]="terminal.integrated.mouseWheelScrollSensitivity";t["BellDuration"]="terminal.integrated.bellDuration";t["FontWeight"]="terminal.integrated.fontWeight";t["FontWeightBold"]="terminal.integrated.fontWeightBold";t["CursorBlinking"]="terminal.integrated.cursorBlinking";t["CursorStyle"]="terminal.integrated.cursorStyle";t["CursorStyleInactive"]="terminal.integrated.cursorStyleInactive";t["CursorWidth"]="terminal.integrated.cursorWidth";t["Scrollback"]="terminal.integrated.scrollback";t["DetectLocale"]="terminal.integrated.detectLocale";t["DefaultLocation"]="terminal.integrated.defaultLocation";t["GpuAcceleration"]="terminal.integrated.gpuAcceleration";t["TerminalTitleSeparator"]="terminal.integrated.tabs.separator";t["TerminalTitle"]="terminal.integrated.tabs.title";t["TerminalDescription"]="terminal.integrated.tabs.description";t["RightClickBehavior"]="terminal.integrated.rightClickBehavior";t["MiddleClickBehavior"]="terminal.integrated.middleClickBehavior";t["Cwd"]="terminal.integrated.cwd";t["ConfirmOnExit"]="terminal.integrated.confirmOnExit";t["ConfirmOnKill"]="terminal.integrated.confirmOnKill";t["EnableBell"]="terminal.integrated.enableBell";t["EnableVisualBell"]="terminal.integrated.enableVisualBell";t["CommandsToSkipShell"]="terminal.integrated.commandsToSkipShell";t["AllowChords"]="terminal.integrated.allowChords";t["AllowMnemonics"]="terminal.integrated.allowMnemonics";t["TabFocusMode"]="terminal.integrated.tabFocusMode";t["EnvMacOs"]="terminal.integrated.env.osx";t["EnvLinux"]="terminal.integrated.env.linux";t["EnvWindows"]="terminal.integrated.env.windows";t["EnvironmentChangesIndicator"]="terminal.integrated.environmentChangesIndicator";t["EnvironmentChangesRelaunch"]="terminal.integrated.environmentChangesRelaunch";t["ShowExitAlert"]="terminal.integrated.showExitAlert";t["SplitCwd"]="terminal.integrated.splitCwd";t["WindowsEnableConpty"]="terminal.integrated.windowsEnableConpty";t["WindowsUseConptyDll"]="terminal.integrated.windowsUseConptyDll";t["WordSeparators"]="terminal.integrated.wordSeparators";t["EnableFileLinks"]="terminal.integrated.enableFileLinks";t["AllowedLinkSchemes"]="terminal.integrated.allowedLinkSchemes";t["UnicodeVersion"]="terminal.integrated.unicodeVersion";t["EnablePersistentSessions"]="terminal.integrated.enablePersistentSessions";t["PersistentSessionReviveProcess"]="terminal.integrated.persistentSessionReviveProcess";t["HideOnStartup"]="terminal.integrated.hideOnStartup";t["HideOnLastClosed"]="terminal.integrated.hideOnLastClosed";t["CustomGlyphs"]="terminal.integrated.customGlyphs";t["RescaleOverlappingGlyphs"]="terminal.integrated.rescaleOverlappingGlyphs";t["PersistentSessionScrollback"]="terminal.integrated.persistentSessionScrollback";t["InheritEnv"]="terminal.integrated.inheritEnv";t["ShowLinkHover"]="terminal.integrated.showLinkHover";t["IgnoreProcessNames"]="terminal.integrated.ignoreProcessNames";t["ShellIntegrationEnabled"]="terminal.integrated.shellIntegration.enabled";t["ShellIntegrationShowWelcome"]="terminal.integrated.shellIntegration.showWelcome";t["ShellIntegrationDecorationsEnabled"]="terminal.integrated.shellIntegration.decorationsEnabled";t["ShellIntegrationEnvironmentReporting"]="terminal.integrated.shellIntegration.environmentReporting";t["EnableImages"]="terminal.integrated.enableImages";t["SmoothScrolling"]="terminal.integrated.smoothScrolling";t["IgnoreBracketedPasteMode"]="terminal.integrated.ignoreBracketedPasteMode";t["FocusAfterRun"]="terminal.integrated.focusAfterRun";t["FontLigaturesEnabled"]="terminal.integrated.fontLigatures.enabled";t["FontLigaturesFeatureSettings"]="terminal.integrated.fontLigatures.featureSettings";t["FontLigaturesFallbackLigatures"]="terminal.integrated.fontLigatures.fallbackLigatures";t["DeveloperPtyHostLatency"]="terminal.integrated.developer.ptyHost.latency";t["DeveloperPtyHostStartupDelay"]="terminal.integrated.developer.ptyHost.startupDelay";t["DevMode"]="terminal.integrated.developer.devMode"})(NS||(NS={}));var OS;(function(t){t["Bash"]="bash";t["Fish"]="fish";t["Sh"]="sh";t["Csh"]="csh";t["Ksh"]="ksh";t["Zsh"]="zsh"})(OS||(OS={}));var FS;(function(t){t["CommandPrompt"]="cmd";t["Wsl"]="wsl";t["GitBash"]="gitbash"})(FS||(FS={}));var MS;(function(t){t["PowerShell"]="pwsh";t["Python"]="python";t["Julia"]="julia";t["NuShell"]="nu";t["Node"]="node"})(MS||(MS={}));var US;(function(t){t[t["Api"]=0]="Api";t[t["Process"]=1]="Process";t[t["Sequence"]=2]="Sequence";t[t["Config"]=3]="Config"})(US||(US={}));var $S;(function(t){t["LocalPty"]="localPty";t["PtyHost"]="ptyHost";t["PtyHostWindow"]="ptyHostWindow";t["Logger"]="logger";t["Heartbeat"]="heartbeat"})($S||($S={}));var Sc;(function(t){t["Cwd"]="cwd";t["InitialCwd"]="initialCwd";t["FixedDimensions"]="fixedDimensions";t["Title"]="title";t["ShellType"]="shellType";t["HasChildProcesses"]="hasChildProcesses";t["ResolvedShellLaunchConfig"]="resolvedShellLaunchConfig";t["OverrideDimensions"]="overrideDimensions";t["FailedShellIntegrationActivation"]="failedShellIntegrationActivation";t["UsedShellIntegrationInjection"]="usedShellIntegrationInjection";t["ShellIntegrationInjectionFailureReason"]="shellIntegrationInjectionFailureReason"})(Sc||(Sc={}));var HS;(function(t){t[t["BeatInterval"]=5e3]="BeatInterval";t[t["ConnectingBeatInterval"]=2e4]="ConnectingBeatInterval";t[t["FirstWaitMultiplier"]=1.2]="FirstWaitMultiplier";t[t["SecondWaitMultiplier"]=1]="SecondWaitMultiplier";t[t["CreateProcessTimeout"]=5e3]="CreateProcessTimeout"})(HS||(HS={}));var BS;(function(t){t[t["Panel"]=1]="Panel";t[t["Editor"]=2]="Editor"})(BS||(BS={}));var VS;(function(t){t["TerminalView"]="view";t["Editor"]="editor"})(VS||(VS={}));var WS;(function(t){t[t["GraceTime"]=6e4]="GraceTime";t[t["ShortGraceTime"]=6e3]="ShortGraceTime"})(WS||(WS={}));var zS;(function(t){t[t["HighWatermarkChars"]=1e5]="HighWatermarkChars";t[t["LowWatermarkChars"]=5e3]="LowWatermarkChars";t[t["CharCountAckSize"]=5e3]="CharCountAckSize"})(zS||(zS={}));var qS;(function(t){t["GitBash"]="Git Bash";t["Pwsh"]="PowerShell"})(qS||(qS={}));var jS;(function(t){t[t["Off"]=0]="Off";t[t["FinalTerm"]=1]="FinalTerm";t[t["VSCode"]=2]="VSCode"})(jS||(jS={}));var GS;(function(t){t["InjectionSettingDisabled"]="injectionSettingDisabled";t["NoExecutable"]="noExecutable";t["FeatureTerminal"]="featureTerminal";t["IgnoreShellIntegrationFlag"]="ignoreShellIntegrationFlag";t["Winpty"]="winpty";t["UnsupportedArgs"]="unsupportedArgs";t["UnsupportedShell"]="unsupportedShell";t["FailedToSetStickyBit"]="failedToSetStickyBit";t["FailedToCreateTmpDir"]="failedToCreateTmpDir"})(GS||(GS={}));var KS;(function(t){t[t["Unknown"]=0]="Unknown";t[t["Shutdown"]=1]="Shutdown";t[t["Process"]=2]="Process";t[t["User"]=3]="User";t[t["Extension"]=4]="Extension"})(KS||(KS={}));const I6={Backend:"workbench.contributions.terminal.processBackend"};function tb(t){return t?.toLowerCase()??""}class C6{constructor(e){this.remoteAuthority=e}affects(e){return tb(e)===this.remoteAuthority}}class T6{constructor(){this._backends=new Map;this._onDidChangeBackends=new L;this.onDidChangeBackends=this._onDidChangeBackends.event}get backends(){return this._backends}registerTerminalBackend(e){const i=tb(e.remoteAuthority);if(this._backends.has(i)){throw new Error(`A terminal backend with remote authority '${i}' was already registered.`)}this._backends.set(i,e);this._onDidChangeBackends.fire(new C6(i))}getTerminalBackend(e){return this._backends.get(tb(e))}}ci.add(I6.Backend,new T6);class P6{constructor(e){this._callback=e;this._terminalBufferMap=new Map}dispose(){for(const e of this._terminalBufferMap.values()){e.dispose()}}startBuffering(e,i,n=5){const s=i(r=>{const o=typeof r==="string"?r:r.data;let a=this._terminalBufferMap.get(e);if(a){a.data.push(o);return}const l=setTimeout(()=>this.flushBuffer(e),n);a={data:[o],timeoutId:l,dispose:()=>{clearTimeout(l);this.flushBuffer(e);s.dispose()}};this._terminalBufferMap.set(e,a)});return s}stopBuffering(e){const i=this._terminalBufferMap.get(e);i?.dispose()}flushBuffer(e){const i=this._terminalBufferMap.get(e);if(i){this._terminalBufferMap.delete(e);this._callback(e,i.data.join(""))}}}const ko=(t,e,i,n)=>{let s=e;return{enumerable:true,configurable:false,get(){return s},set(r){if(!i(s,r)){const o=s;s=r;t.listener?.(n(r,o))}}}};const el=(t,e)=>t===e;const Or={range:(t,e)=>{if(t===e){return true}if(!t||!e){return false}return t.isEqual(e)},label:el,description:el,sortText:el,busy:el,error:el,canResolveChildren:el,tags:(t,e)=>{if(t.length!==e.length){return false}if(t.some(i=>!e.find(n=>i.id===n.id))){return false}return true}};const tl=t=>e=>({op:gi.SetProp,update:t(e)});const A6=(t,e)=>({range:(()=>{let i;const n=tl(s=>({range:et.lift(W.from(s))}));return{enumerable:true,configurable:false,get(){return i},set(s){t.listener?.({op:gi.DocumentSynced});if(!Or.range(i,s)){i=s;t.listener?.(n(s))}}}})(),label:ko(t,e,Or.label,tl(i=>({label:i}))),description:ko(t,void 0,Or.description,tl(i=>({description:i}))),sortText:ko(t,void 0,Or.sortText,tl(i=>({sortText:i}))),canResolveChildren:ko(t,false,Or.canResolveChildren,i=>({op:gi.UpdateCanResolveChildren,state:i})),busy:ko(t,false,Or.busy,tl(i=>({busy:i}))),error:ko(t,void 0,Or.error,tl(i=>({error:Pe.fromStrict(i)||null}))),tags:ko(t,[],Or.tags,(i,n)=>({op:gi.SetTags,new:i.map(cs.from),old:n.map(cs.from)}))});const R6=t=>{const e=Re.fromString(t.extId);const i=new Ha(e.controllerId,e.localId,t.label,b.revive(t.uri)||void 0);i.range=W.to(t.range||void 0);i.description=t.description||void 0;i.sortText=t.sortText||void 0;i.tags=t.tags.map(n=>cs.to({id:L4(n).tagId}));return i};const QS=t=>{let e;for(const i of t.tests){const n=R6(i.item);Tm(n).parent=e;e=n}return e};class Ha{constructor(e,i,n,s){if(i.includes(mn.Delimiter)){throw new Error(`Test IDs may not include the ${JSON.stringify(i)} symbol`)}const r=ZR(this,e);Object.defineProperties(this,{id:{value:i,enumerable:true,writable:false},uri:{value:s,enumerable:true,writable:false},parent:{enumerable:false,get(){return r.parent instanceof my?void 0:r.parent}},children:{value:YR(r,Tm,Ha),enumerable:true,writable:false},...A6(r,n)})}}class my extends Ha{constructor(e,i){super(e,e,i,void 0);this._isRoot=true}}class L6 extends QR{constructor(e,i,n){super({controllerId:e,getDocumentVersion:s=>s&&n.getDocument(s)?.version,getApiFor:Tm,getChildren:s=>s.children,root:new my(e,i),toITestItem:vo.from})}}let ib=class m$ extends Ee{constructor(e,i,n){super();this.initData=i;this._onDidChangeTelemetryEnabled=this._register(new L);this.onDidChangeTelemetryEnabled=this._onDidChangeTelemetryEnabled.event;this._onDidChangeTelemetryConfiguration=this._register(new L);this.onDidChangeTelemetryConfiguration=this._onDidChangeTelemetryConfiguration.event;this._productConfig={usage:true,error:true};this._level=Xr.NONE;this._inLoggingOnlyMode=false;this._telemetryLoggers=new Map;this._inLoggingOnlyMode=this.initData.environment.isExtensionTelemetryLoggingOnly;const s=i.remote.isRemote?"remoteExtHostTelemetry":e?"workerExtHostTelemetry":"extHostTelemetry";this._outputLogger=this._register(n.createLogger(s,{name:h(2568,"Extension Telemetry{0}",this._inLoggingOnlyMode?" (Not Sent)":""),hidden:true,group:DR}))}getTelemetryConfiguration(){return this._level===Xr.USAGE}getTelemetryDetails(){return{isCrashEnabled:this._level>=Xr.CRASH,isErrorsEnabled:this._productConfig.error?this._level>=Xr.ERROR:false,isUsageEnabled:this._productConfig.usage?this._level>=Xr.USAGE:false}}instantiateLogger(e,i,n){const s=this.getTelemetryDetails();const r=new DC(i,n,e,this._outputLogger,this._inLoggingOnlyMode,this.getBuiltInCommonProperties(e),{isUsageEnabled:s.isUsageEnabled,isErrorsEnabled:s.isErrorsEnabled});const o=this._telemetryLoggers.get(e.identifier.value)??[];this._telemetryLoggers.set(e.identifier.value,[...o,r]);return r.apiTelemetryLogger}$initializeTelemetryLevel(e,i,n){this._level=e;this._productConfig=n??{usage:true,error:true}}getBuiltInCommonProperties(e){const i=Object.create(null);i["common.extname"]=`${e.publisher}.${e.name}`;i["common.extversion"]=e.version;i["common.vscodemachineid"]=this.initData.telemetryInfo.machineId;i["common.vscodesessionid"]=this.initData.telemetryInfo.sessionId;i["common.vscodecommithash"]=this.initData.commit;i["common.sqmid"]=this.initData.telemetryInfo.sqmId;i["common.devDeviceId"]=this.initData.telemetryInfo.devDeviceId;i["common.vscodeversion"]=this.initData.version;i["common.isnewappinstall"]=kC(this.initData.telemetryInfo.firstSessionDate);i["common.product"]=this.initData.environment.appHost;switch(this.initData.uiKind){case Wu.Web:i["common.uikind"]="web";break;case Wu.Desktop:i["common.uikind"]="desktop";break;default:i["common.uikind"]="unknown"}i["common.remotename"]=k0(IR(this.initData.remote.authority));return i}$onDidChangeTelemetryLevel(e){this._oldTelemetryEnablement=this.getTelemetryConfiguration();this._level=e;const i=this.getTelemetryDetails();this._telemetryLoggers.forEach((n,s)=>{const r=n.filter(o=>!o.isDisposed);if(r.length===0){this._telemetryLoggers.delete(s)}else{this._telemetryLoggers.set(s,r)}});this._telemetryLoggers.forEach(n=>{for(const s of n){s.updateTelemetryEnablements(i.isUsageEnabled,i.isErrorsEnabled)}});if(this._oldTelemetryEnablement!==this.getTelemetryConfiguration()){this._onDidChangeTelemetryEnabled.fire(this.getTelemetryConfiguration())}this._onDidChangeTelemetryConfiguration.fire(this.getTelemetryDetails())}onExtensionError(e,i){const n=this._telemetryLoggers.get(e.value);const s=n?.filter(o=>!o.isDisposed);if(!s){this._telemetryLoggers.delete(e.value);return false}let r=false;for(const o of s){if(o.ignoreUnhandledExtHostErrors){continue}o.logError(i);r=true}return r}};ib=z([O(1,Ai),O(2,Cc)],ib);class DC{static validateSender(e){if(typeof e!=="object"){throw new TypeError("TelemetrySender argument is invalid")}if(typeof e.sendEventData!=="function"){throw new TypeError("TelemetrySender.sendEventData must be a function")}if(typeof e.sendErrorData!=="function"){throw new TypeError("TelemetrySender.sendErrorData must be a function")}if(typeof e.flush!=="undefined"&&typeof e.flush!=="function"){throw new TypeError("TelemetrySender.flush must be a function or undefined")}}constructor(e,i,n,s,r,o,a){this._extension=n;this._logger=s;this._inLoggingOnlyMode=r;this._commonProperties=o;this._onDidChangeEnableStates=new L;this.ignoreUnhandledExtHostErrors=i?.ignoreUnhandledErrors??false;this._ignoreBuiltinCommonProperties=i?.ignoreBuiltInCommonProperties??false;this._additionalCommonProperties=i?.additionalCommonProperties;this._sender=e;this._telemetryEnablements={isUsageEnabled:a.isUsageEnabled,isErrorsEnabled:a.isErrorsEnabled}}updateTelemetryEnablements(e,i){if(this._apiObject){this._telemetryEnablements={isUsageEnabled:e,isErrorsEnabled:i};this._onDidChangeEnableStates.fire(this._apiObject)}}mixInCommonPropsAndCleanData(e){let i="properties"in e?e.properties??{}:e;i=I2(i,[]);if(this._additionalCommonProperties){i=Ea(i,this._additionalCommonProperties)}if(!this._ignoreBuiltinCommonProperties){i=Ea(i,this._commonProperties)}if("properties"in e){e.properties=i}else{e=i}return e}logEvent(e,i){if(!this._sender){return}if(this._extension.publisher==="vscode"){e=this._extension.name+"/"+e}else{e=this._extension.identifier.value+"/"+e}i=this.mixInCommonPropsAndCleanData(i||{});if(!this._inLoggingOnlyMode){this._sender?.sendEventData(e,i)}this._logger.trace(e,i)}logUsage(e,i){if(!this._telemetryEnablements.isUsageEnabled){return}this.logEvent(e,i)}logError(e,i){if(!this._telemetryEnablements.isErrorsEnabled||!this._sender){return}if(typeof e==="string"){this.logEvent(e,i)}else{const n={name:e.name,message:e.message,stack:e.stack,cause:e.cause};const s=I2(n,[]);const r=new Error(s.message,{cause:s.cause});r.stack=s.stack;r.name=s.name;i=this.mixInCommonPropsAndCleanData(i||{});if(!this._inLoggingOnlyMode){this._sender.sendErrorData(r,i)}this._logger.trace("exception",i)}}get apiTelemetryLogger(){if(!this._apiObject){const e=this;const i={logUsage:e.logUsage.bind(e),get isUsageEnabled(){return e._telemetryEnablements.isUsageEnabled},get isErrorsEnabled(){return e._telemetryEnablements.isErrorsEnabled},logError:e.logError.bind(e),dispose:e.dispose.bind(e),onDidChangeEnableStates:e._onDidChangeEnableStates.event.bind(e)};this._apiObject=Object.freeze(i)}return this._apiObject}get isDisposed(){return!this._sender}dispose(){if(this._sender?.flush){let e=this._sender;this._sender=void 0;Promise.resolve(e.flush()).then(e=void 0);this._apiObject=void 0}else{this._sender=void 0}}}function kC(t){const e=Date.now()-new Date(t).getTime();return isNaN(e)?false:e<1e3*60*60*24}const Vm=xe("IExtHostTelemetry");let nb=class _${#e;#t;#i;constructor(e,i,n){this._commands=new Map;this._apiCommands=new Map;this.#e=e.getProxy(Y.MainThreadCommands);this._logService=i;this.#i=n;this.#t=e.getProxy(Y.MainThreadTelemetry);this.converter=new N6(this,s=>{const r=this._apiCommands.get(s);return r?.result===Se.Void?r:void 0},i);this._argumentProcessors=[{processArgument(s){return ti(s)}},{processArgument(s){return Kl(s,function(r){if(et.isIRange(r)){return W.to(r)}if(En.isIPosition(r)){return rt.to(r)}if(et.isIRange(r.range)&&b.isUri(r.uri)){return Zi.to(r)}if(r instanceof ue){return r.buffer.buffer}if(!Array.isArray(r)){return r}})}}]}registerArgumentProcessor(e){this._argumentProcessors.push(e)}registerApiCommand(e){const i=this.registerCommand(false,e.id,async(...n)=>{const s=e.args.map((o,a)=>{if(!o.validate(n[a])){throw new Error(`Invalid argument '${o.name}' when running '${e.id}', received: ${typeof n[a]==="object"?JSON.stringify(n[a],null,"	"):n[a]} `)}return o.convert(n[a])});const r=await this.executeCommand(e.internalId,...s);return e.result.convert(r,n,this.converter)},void 0,{description:e.description,args:e.args,returns:e.result.description});this._apiCommands.set(e.id,e);return new qe(()=>{i.dispose();this._apiCommands.delete(e.id)})}registerCommand(e,i,n,s,r,o){this._logService.trace("ExtHostCommands#registerCommand",i);if(!i.trim().length){throw new Error("invalid id")}if(this._commands.has(i)){throw new Error(`command '${i}' already exists`)}this._commands.set(i,{callback:n,thisArg:s,metadata:r,extension:o});if(e){this.#e.$registerCommand(i)}return new qe(()=>{if(this._commands.delete(i)){if(e){this.#e.$unregisterCommand(i)}}})}executeCommand(e,...i){this._logService.trace("ExtHostCommands#executeCommand",e);return this._doExecuteCommand(e,i,true)}async _doExecuteCommand(e,i,n){if(this._commands.has(e)){this.#e.$fireCommandActivationEvent(e);return this._executeContributedCommand(e,i,false)}else{let s=false;const r=Kl(i,function(o){if(o instanceof Ve){return rt.from(o)}else if(o instanceof Oe){return W.from(o)}else if(o instanceof kn){return Zi.from(o)}else if(gr.isNotebookRange(o)){return Ls.from(o)}else if(o instanceof ArrayBuffer){s=true;return ue.wrap(new Uint8Array(o))}else if(o instanceof Uint8Array){s=true;return ue.wrap(o)}else if(o instanceof ue){s=true;return o}if(!Array.isArray(o)){return o}});try{const o=await this.#e.$executeCommand(e,s?new Bi(r):r,n);return ti(o)}catch(o){if(o instanceof Error&&o.message==="$executeCommand:retry"){return this._doExecuteCommand(e,i,false)}else{throw o}}}}async _executeContributedCommand(e,i,n){const s=this._commands.get(e);if(!s){throw new Error("Unknown command")}const{callback:r,thisArg:o,metadata:a}=s;if(a?.args){for(let c=0;c<a.args.length;c++){try{Hk(i[c],a.args[c].constraint)}catch(u){throw new Error(`Running the contributed command: '${e}' failed. Illegal argument '${a.args[c].name}' - ${a.args[c].description}`)}}}const l=xr.create();try{return await r.apply(o,i)}catch(c){if(e===this.converter.delegatingCommandId){const u=this.converter.getActualCommand(...i);if(u){e=u.command}}if(!fo(c)){this._logService.error(c,e,s.extension?.identifier)}if(!n){throw c}if(s.extension?.identifier){const u=this.#i.onExtensionError(s.extension.identifier,c);this._logService.trace("forwarded error to extension?",u,s.extension?.identifier)}throw new class v$ extends Error{constructor(){super(Rc(c));this.id=e;this.source=s.extension?.displayName??s.extension?.name}}}finally{this._reportTelemetry(s,e,l.elapsed())}}_reportTelemetry(e,i,n){if(!e.extension){return}this.#t.$publicLog2("Extension:ActionExecuted",{extensionId:e.extension.identifier.value,id:new Q0(i),duration:n})}$executeContributedCommand(e,...i){this._logService.trace("ExtHostCommands#$executeContributedCommand",e);const n=this._commands.get(e);if(!n){return Promise.reject(new Error(`Contributed command '${e}' does not exist.`))}else{i=i.map(s=>this._argumentProcessors.reduce((r,o)=>o.processArgument(r,n.extension),s));return this._executeContributedCommand(e,i,true)}}getCommands(e=false){this._logService.trace("ExtHostCommands#getCommands",e);return this.#e.$getCommands().then(i=>{if(e){i=i.filter(n=>n[0]!=="_")}return i})}$getContributedCommandMetadata(){const e=Object.create(null);for(const[i,n]of this._commands){const{metadata:s}=n;if(s){e[i]=s}}return Promise.resolve(e)}};nb=z([O(0,st),O(1,at),O(2,Vm)],nb);const Ba=xe("IExtHostCommands");class N6{constructor(e,i,n){this._commands=e;this._lookupApiCommand=i;this._logService=n;this.delegatingCommandId=`__vsc${vi()}`;this._cache=new Map;this._cachIdPool=0;this._commands.registerCommand(true,this.delegatingCommandId,this._executeConvertedCommand,this)}toInternal(e,i){if(!e){return void 0}const n={$ident:void 0,id:e.command,title:e.title,tooltip:e.tooltip};if(!e.command){return n}const s=this._lookupApiCommand(e.command);if(s){n.id=s.internalId;n.arguments=s.args.map((r,o)=>r.convert(e.arguments&&e.arguments[o]))}else if(kc(e.arguments)){const r=`${e.command} /${++this._cachIdPool}`;this._cache.set(r,e);i.add(ge(()=>{this._cache.delete(r);this._logService.trace("CommandsConverter#DISPOSE",r)}));n.$ident=r;n.id=this.delegatingCommandId;n.arguments=[r];this._logService.trace("CommandsConverter#CREATE",e.command,r)}return n}fromInternal(e){if(typeof e.$ident==="string"){return this._cache.get(e.$ident)}else{return{command:e.id,title:e.title,arguments:e.arguments}}}getActualCommand(...e){return this._cache.get(e[0])}_executeConvertedCommand(...e){const i=this.getActualCommand(...e);this._logService.trace("CommandsConverter#EXECUTE",e[0],i?i.command:"MISSING");if(!i){return Promise.reject(`Actual command not found, wanted to execute ${e[0]}`)}return this._commands.executeCommand(i.command,...i.arguments||[])}}class q{static{this.Uri=new q("uri","Uri of a text document",e=>b.isUri(e),e=>e)}static{this.Position=new q("position","A position in a text document",e=>Ve.isPosition(e),rt.from)}static{this.Range=new q("range","A range in a text document",e=>Oe.isRange(e),W.from)}static{this.Selection=new q("selection","A selection in a text document",e=>Dr.isSelection(e),ls.from)}static{this.Number=new q("number","",e=>typeof e==="number",e=>e)}static{this.String=new q("string","",e=>typeof e==="string",e=>e)}static Arr(e){return new q(`${e.name}_array`,`Array of ${e.name}, ${e.description}`,i=>Array.isArray(i)&&i.every(n=>e.validate(n)),i=>i.map(n=>e.convert(n)))}static{this.CallHierarchyItem=new q("item","A call hierarchy item",e=>e instanceof Z0,Aa.from)}static{this.TypeHierarchyItem=new q("item","A type hierarchy item",e=>e instanceof iy,ga.from)}static{this.TestItem=new q("testItem","A VS Code TestItem",e=>e instanceof Ha,vo.from)}static{this.TestProfile=new q("testProfile","A VS Code test profile",e=>e instanceof G4,xw.from)}constructor(e,i,n,s){this.name=e;this.description=i;this.validate=n;this.convert=s}optional(){return new q(this.name,`(optional) ${this.description}`,e=>e===void 0||e===null||this.validate(e),e=>e===void 0?void 0:e===null?null:this.convert(e))}with(e,i){return new q(e??this.name,i??this.description,this.validate,this.convert)}}class Se{static{this.Void=new Se("no result",e=>e)}constructor(e,i){this.description=e;this.convert=i}}class Te{constructor(e,i,n,s,r){this.id=e;this.internalId=i;this.description=n;this.args=s;this.result=r}}const Nc=xe("IExtHostTerminalService");class JS extends Ee{constructor(e,i,n,s){super();this._proxy=e;this._id=i;this._creationOptions=n;this._name=s;this._disposed=false;this._state={isInteractedWith:false,shell:void 0};this.isOpen=false;this._onWillDispose=this._register(new L);this.onWillDispose=this._onWillDispose.event;this._creationOptions=Object.freeze(this._creationOptions);this._pidPromise=new Promise(o=>this._pidPromiseComplete=o);const r=this;this.value={get name(){return r._name||""},get processId(){return r._pidPromise},get creationOptions(){return r._creationOptions},get exitStatus(){return r._exitStatus},get state(){return r._state},get selection(){return r._selection},get shellIntegration(){return r.shellIntegration},sendText(o,a=true){r._checkDisposed();r._proxy.$sendText(r._id,o,a)},show(o){r._checkDisposed();r._proxy.$show(r._id,o)},hide(){r._checkDisposed();r._proxy.$hide(r._id)},dispose(){if(!r._disposed){r._disposed=true;r._proxy.$dispose(r._id)}},get dimensions(){if(r._cols===void 0||r._rows===void 0){return void 0}return{columns:r._cols,rows:r._rows}}}}dispose(){this._onWillDispose.fire();super.dispose()}async create(e,i){if(typeof this._id!=="string"){throw new Error("Terminal has already been created")}await this._proxy.$createTerminal(this._id,{name:e.name,shellPath:e.shellPath??void 0,shellArgs:e.shellArgs??void 0,cwd:e.cwd??i?.cwd??void 0,env:e.env??void 0,icon:IC(e.iconPath)??void 0,color:Jl.isThemeColor(e.color)?e.color.id:void 0,initialText:e.message??void 0,strictEnv:e.strictEnv??void 0,hideFromUser:e.hideFromUser??void 0,forceShellIntegration:i?.forceShellIntegration??void 0,isFeatureTerminal:i?.isFeatureTerminal??void 0,isExtensionOwnedTerminal:true,useShellEnvironment:i?.useShellEnvironment??void 0,location:i?.location||this._serializeParentTerminal(e.location,i?.resolvedExtHostIdentifier),isTransient:e.isTransient??void 0})}async createExtensionTerminal(e,i,n,s,r){if(typeof this._id!=="string"){throw new Error("Terminal has already been created")}await this._proxy.$createTerminal(this._id,{name:this._name,isExtensionCustomPtyTerminal:true,icon:s,color:Jl.isThemeColor(r)?r.id:void 0,location:i?.location||this._serializeParentTerminal(e,n),isTransient:true});if(typeof this._id==="string"){throw new Error("Terminal creation failed")}return this._id}_serializeParentTerminal(e,i){if(typeof e==="object"){if("parentTerminal"in e&&e.parentTerminal&&i){return{parentTerminal:i}}if("viewColumn"in e){return{viewColumn:ai.from(e.viewColumn),preserveFocus:e.preserveFocus}}return void 0}return e}_checkDisposed(){if(this._disposed){throw new Error("Terminal has already been disposed")}}set name(e){this._name=e}setExitStatus(e,i){this._exitStatus=Object.freeze({code:e,reason:i})}setDimensions(e,i){if(e===this._cols&&i===this._rows){return false}if(e===0||i===0){return false}this._cols=e;this._rows=i;return true}setInteractedWith(){if(!this._state.isInteractedWith){this._state={...this._state,isInteractedWith:true};return true}return false}setShellType(e){if(this._state.shell!==e){this._state={...this._state,shell:e};return true}return false}setSelection(e){this._selection=e}_setProcessId(e){if(this._pidPromiseComplete){this._pidPromiseComplete(e);this._pidPromiseComplete=void 0}else{this._pidPromise.then(i=>{if(i!==e){this._pidPromise=Promise.resolve(e)}})}}}class A1{get onProcessReady(){return this._onProcessReady.event}constructor(e){this._pty=e;this.id=0;this.shouldPersist=false;this._onProcessData=new L;this.onProcessData=this._onProcessData.event;this._onProcessReady=new L;this._onDidChangeProperty=new L;this.onDidChangeProperty=this._onDidChangeProperty.event;this._onProcessExit=new L;this.onProcessExit=this._onProcessExit.event}refreshProperty(e){throw new Error(`refreshProperty is not suppported in extension owned terminals. property: ${e}`)}updateProperty(e,i){throw new Error(`updateProperty is not suppported in extension owned terminals. property: ${e}, value: ${i}`)}async start(){return void 0}shutdown(){this._pty.close()}input(e){this._pty.handleInput?.(e)}resize(e,i){this._pty.setDimensions?.({columns:e,rows:i})}clearBuffer(){}async processBinary(e){}acknowledgeDataEvent(e){}async setUnicodeVersion(e){}getInitialCwd(){return Promise.resolve("")}getCwd(){return Promise.resolve("")}startSendingEvents(e){this._pty.onDidWrite(i=>this._onProcessData.fire(i));this._pty.onDidClose?.((i=void 0)=>{this._onProcessExit.fire(i===void 0?void 0:i)});this._pty.onDidOverrideDimensions?.(i=>{if(i){this._onDidChangeProperty.fire({type:Sc.OverrideDimensions,value:{cols:i.columns,rows:i.rows}})}});this._pty.onDidChangeName?.(i=>{this._onDidChangeProperty.fire({type:Sc.Title,value:i})});this._pty.open(e?e:void 0);if(e){this._pty.setDimensions?.(e)}this._onProcessReady.fire({pid:-1,cwd:"",windowsPty:void 0})}}let O6=1;let sb=class w$ extends Ee{get activeTerminal(){return this._activeTerminal?.value}get terminals(){return this._terminals.map(e=>e.value)}constructor(e,i,n){super();this._extHostCommands=i;this._terminals=[];this._terminalProcesses=new Map;this._terminalProcessDisposables={};this._extensionTerminalAwaitingStart={};this._getTerminalPromises={};this._environmentVariableCollections=new Map;this._lastQuickFixCommands=this._register(new eo);this._linkProviders=new Set;this._completionProviders=new Map;this._profileProviders=new Map;this._quickFixProviders=new Map;this._terminalLinkCache=new Map;this._terminalLinkCancellationSource=new Map;this._onDidCloseTerminal=new L;this.onDidCloseTerminal=this._onDidCloseTerminal.event;this._onDidOpenTerminal=new L;this.onDidOpenTerminal=this._onDidOpenTerminal.event;this._onDidChangeActiveTerminal=new L;this.onDidChangeActiveTerminal=this._onDidChangeActiveTerminal.event;this._onDidChangeTerminalDimensions=new L;this.onDidChangeTerminalDimensions=this._onDidChangeTerminalDimensions.event;this._onDidChangeTerminalState=new L;this.onDidChangeTerminalState=this._onDidChangeTerminalState.event;this._onDidChangeShell=new L;this.onDidChangeShell=this._onDidChangeShell.event;this._onDidWriteTerminalData=new L({onWillAddFirstListener:()=>this._proxy.$startSendingDataEvents(),onDidRemoveLastListener:()=>this._proxy.$stopSendingDataEvents()});this.onDidWriteTerminalData=this._onDidWriteTerminalData.event;this._onDidExecuteCommand=new L({onWillAddFirstListener:()=>this._proxy.$startSendingCommandEvents(),onDidRemoveLastListener:()=>this._proxy.$stopSendingCommandEvents()});this.onDidExecuteTerminalCommand=this._onDidExecuteCommand.event;this._proxy=n.getProxy(Y.MainThreadTerminalService);this._bufferer=new P6(this._proxy.$sendProcessData);this._proxy.$registerProcessSupport(e);this._extHostCommands.registerArgumentProcessor({processArgument:s=>{const r=o=>{const a=o;return this.getTerminalById(a.instanceId)?.value};switch(s?.$mid){case it.TerminalContext:return r(s);default:{if(Array.isArray(s)){for(let o=0;o<s.length;o++){if(s[o].$mid===it.TerminalContext){s[o]=r(s[o])}else{break}}}return s}}}});this._register({dispose:()=>{for(const[s,r]of this._terminalProcesses){r.shutdown(true)}}})}getDefaultShell(e){const i=e?this._defaultAutomationProfile:this._defaultProfile;return i?.path||""}getDefaultShellArgs(e){const i=e?this._defaultAutomationProfile:this._defaultProfile;return i?.args||[]}createExtensionTerminal(e,i){const n=new JS(this._proxy,vi(),e,e.name);const s=new A1(e.pty);n.createExtensionTerminal(e.location,i,this._serializeParentTerminal(e,i).resolvedExtHostIdentifier,IC(e.iconPath),M6(e.color)).then(r=>{const o=this._setupExtHostProcessListeners(r,s);this._terminalProcessDisposables[r]=o});this._terminals.push(n);return n.value}_serializeParentTerminal(e,i){i=i?i:{};if(e.location&&typeof e.location==="object"&&"parentTerminal"in e.location){const n=e.location.parentTerminal;if(n){const s=this._terminals.find(r=>r.value===n);if(s){i.resolvedExtHostIdentifier=s._id}}}else if(e.location&&typeof e.location!=="object"){i.location=e.location}else if(i.location&&typeof i.location==="object"&&"splitActiveTerminal"in i.location){i.location={splitActiveTerminal:true}}return i}attachPtyToTerminal(e,i){const n=this.getTerminalById(e);if(!n){throw new Error(`Cannot resolve terminal with id ${e} for virtual process`)}const s=new A1(i);const r=this._setupExtHostProcessListeners(e,s);this._terminalProcessDisposables[e]=r}async $acceptActiveTerminalChanged(e){const i=this._activeTerminal;if(e===null){this._activeTerminal=void 0;if(i!==this._activeTerminal){this._onDidChangeActiveTerminal.fire(this._activeTerminal)}return}const n=this.getTerminalById(e);if(n){this._activeTerminal=n;if(i!==this._activeTerminal){this._onDidChangeActiveTerminal.fire(this._activeTerminal.value)}}}async $acceptTerminalProcessData(e,i){const n=this.getTerminalById(e);if(n){this._onDidWriteTerminalData.fire({terminal:n.value,data:i})}}async $acceptTerminalDimensions(e,i,n){const s=this.getTerminalById(e);if(s){if(s.setDimensions(i,n)){this._onDidChangeTerminalDimensions.fire({terminal:s.value,dimensions:s.value.dimensions})}}}async $acceptDidExecuteCommand(e,i){const n=this.getTerminalById(e);if(n){this._onDidExecuteCommand.fire({terminal:n.value,...i})}}async $acceptTerminalMaximumDimensions(e,i,n){this._terminalProcesses.get(e)?.resize(i,n)}async $acceptTerminalTitleChange(e,i){const n=this.getTerminalById(e);if(n){n.name=i}}async $acceptTerminalClosed(e,i,n){const s=this._getTerminalObjectIndexById(this._terminals,e);if(s!==null){const r=this._terminals.splice(s,1)[0];r.setExitStatus(i,n);this._onDidCloseTerminal.fire(r.value)}}$acceptTerminalOpened(e,i,n,s){if(i){const a=this._getTerminalObjectIndexById(this._terminals,i);if(a!==null){this._terminals[a]._id=e;this._onDidOpenTerminal.fire(this.terminals[a]);this._terminals[a].isOpen=true;return}}const r={name:s.name,shellPath:s.executable,shellArgs:s.args,cwd:typeof s.cwd==="string"?s.cwd:b.revive(s.cwd),env:s.env,hideFromUser:s.hideFromUser};const o=new JS(this._proxy,e,r,n);this._terminals.push(o);this._onDidOpenTerminal.fire(o.value);o.isOpen=true}async $acceptTerminalProcessId(e,i){const n=this.getTerminalById(e);n?._setProcessId(i)}async $startExtensionTerminal(e,i){const n=this.getTerminalById(e);if(!n){return{message:h(2569,"Could not find the terminal with id {0} on the extension host",e)}}if(!n.isOpen){await new Promise(r=>{const o=this.onDidOpenTerminal(async a=>{if(a===n.value){o.dispose();r()}})})}const s=this._terminalProcesses.get(e);if(s){s.startSendingEvents(i)}else{this._extensionTerminalAwaitingStart[e]={initialDimensions:i}}return void 0}_setupExtHostProcessListeners(e,i){const n=new Ie;n.add(i.onProcessReady(r=>this._proxy.$sendProcessReady(e,r.pid,r.cwd,r.windowsPty)));n.add(i.onDidChangeProperty(r=>this._proxy.$sendProcessProperty(e,r)));this._bufferer.startBuffering(e,i.onProcessData);n.add(i.onProcessExit(r=>this._onProcessExit(e,r)));this._terminalProcesses.set(e,i);const s=this._extensionTerminalAwaitingStart[e];if(s&&i instanceof A1){i.startSendingEvents(s.initialDimensions);delete this._extensionTerminalAwaitingStart[e]}return n}$acceptProcessAckDataEvent(e,i){this._terminalProcesses.get(e)?.acknowledgeDataEvent(i)}$acceptProcessInput(e,i){this._terminalProcesses.get(e)?.input(i)}$acceptTerminalInteraction(e){const i=this.getTerminalById(e);if(i?.setInteractedWith()){this._onDidChangeTerminalState.fire(i.value)}}$acceptTerminalSelection(e,i){this.getTerminalById(e)?.setSelection(i)}$acceptProcessResize(e,i,n){try{this._terminalProcesses.get(e)?.resize(i,n)}catch(s){if(s.code!=="EPIPE"&&s.code!=="ERR_IPC_CHANNEL_CLOSED"){throw s}}}$acceptProcessShutdown(e,i){this._terminalProcesses.get(e)?.shutdown(i)}$acceptProcessRequestInitialCwd(e){this._terminalProcesses.get(e)?.getInitialCwd().then(i=>this._proxy.$sendProcessProperty(e,{type:Sc.InitialCwd,value:i}))}$acceptProcessRequestCwd(e){this._terminalProcesses.get(e)?.getCwd().then(i=>this._proxy.$sendProcessProperty(e,{type:Sc.Cwd,value:i}))}$acceptProcessRequestLatency(e){return Promise.resolve(e)}registerProfileProvider(e,i,n){if(this._profileProviders.has(i)){throw new Error(`Terminal profile provider "${i}" already registered`)}this._profileProviders.set(i,n);this._proxy.$registerProfileProvider(i,e.identifier.value);return new qe(()=>{this._profileProviders.delete(i);this._proxy.$unregisterProfileProvider(i)})}registerTerminalCompletionProvider(e,i,...n){if(this._completionProviders.has(i.id)){throw new Error(`Terminal completion provider "${i.id}" already registered`)}this._completionProviders.set(i.id,i);this._proxy.$registerCompletionProvider(i.id,e.identifier.value,...n);return new qe(()=>{this._completionProviders.delete(i.id);this._proxy.$unregisterCompletionProvider(i.id)})}async $provideTerminalCompletions(e,i){const n=new Ot().token;if(n.isCancellationRequested||!this.activeTerminal){return void 0}const s=this._completionProviders.get(e);if(!s){return}const r=await s.provideTerminalCompletions(this.activeTerminal,i,n);if(r===null||r===void 0){return void 0}return Aw.from(r)}$acceptTerminalShellType(e,i){const n=this.getTerminalById(e);if(n?.setShellType(i)){this._onDidChangeTerminalState.fire(n.value)}}registerTerminalQuickFixProvider(e,i,n){if(this._quickFixProviders.has(e)){throw new Error(`Terminal quick fix provider "${e}" is already registered`)}this._quickFixProviders.set(e,n);this._proxy.$registerQuickFixProvider(e,i);return new qe(()=>{this._quickFixProviders.delete(e);this._proxy.$unregisterQuickFixProvider(e)})}async $provideTerminalQuickFixes(e,i){const n=new Ot().token;if(n.isCancellationRequested){return}const s=this._quickFixProviders.get(e);if(!s){return}const r=await s.provideTerminalQuickFixes(i,n);if(r===null||Array.isArray(r)&&r.length===0){return void 0}const o=new Ie;this._lastQuickFixCommands.value=o;if(!Array.isArray(r)){return r?qg.from(r,this._extHostCommands.converter,o):void 0}const a=[];for(const l of r){const c=qg.from(l,this._extHostCommands.converter,o);if(c){a.push(c)}}return a}async $createContributedProfileTerminal(e,i){const n=new Ot().token;let s=await this._profileProviders.get(e)?.provideTerminalProfile(n);if(n.isCancellationRequested){return}if(s&&!("options"in s)){s={options:s}}if(!s||!("options"in s)){throw new Error(`No terminal profile options provided for id "${e}"`)}if("pty"in s.options){this.createExtensionTerminal(s.options,i);return}this.createTerminalFromOptions(s.options,i)}registerLinkProvider(e){this._linkProviders.add(e);if(this._linkProviders.size===1){this._proxy.$startLinkProvider()}return new qe(()=>{this._linkProviders.delete(e);if(this._linkProviders.size===0){this._proxy.$stopLinkProvider()}})}async $provideLinks(e,i){const n=this.getTerminalById(e);if(!n){return[]}this._terminalLinkCache.delete(e);const s=this._terminalLinkCancellationSource.get(e);s?.dispose(true);const r=new Ot;this._terminalLinkCancellationSource.set(e,r);const o=[];const a={terminal:n.value,line:i};const l=[];for(const d of this._linkProviders){l.push(Gl.withAsyncBody(async p=>{r.token.onCancellationRequested(()=>p({provider:d,links:[]}));const f=await d.provideTerminalLinks(a,r.token)||[];if(!r.token.isCancellationRequested){p({provider:d,links:f})}}))}const c=await Promise.all(l);if(r.token.isCancellationRequested){return[]}const u=new Map;for(const d of c){if(d&&d.links.length>0){o.push(...d.links.map(p=>{const f={id:O6++,startIndex:p.startIndex,length:p.length,label:p.tooltip};u.set(f.id,{provider:d.provider,link:p});return f}))}}this._terminalLinkCache.set(e,u);return o}$activateLink(e,i){const n=this._terminalLinkCache.get(e)?.get(i);if(!n){return}n.provider.handleTerminalLink(n.link)}_onProcessExit(e,i){this._bufferer.stopBuffering(e);this._terminalProcesses.delete(e);delete this._extensionTerminalAwaitingStart[e];const n=this._terminalProcessDisposables[e];if(n){n.dispose();delete this._terminalProcessDisposables[e]}this._proxy.$sendProcessExit(e,i)}getTerminalById(e){return this._getTerminalObjectById(this._terminals,e)}getTerminalIdByApiObject(e){const i=this._terminals.findIndex(n=>{return n.value===e});return i>=0?i:null}_getTerminalObjectById(e,i){const n=this._getTerminalObjectIndexById(e,i);return n!==null?e[n]:null}_getTerminalObjectIndexById(e,i){const n=e.findIndex(s=>{return s._id===i});return n>=0?n:null}getEnvironmentVariableCollection(e){let i=this._environmentVariableCollections.get(e.identifier.value);if(!i){i=this._register(new XS);this._setEnvironmentVariableCollection(e.identifier.value,i)}return i.getScopedEnvironmentVariableCollection(void 0)}_syncEnvironmentVariableCollection(e,i){const n=D6(i.map);const s=k6(i.descriptionMap);this._proxy.$setEnvironmentVariableCollection(e,i.persistent,n.length===0?void 0:n,s)}$initEnvironmentVariableCollections(e){e.forEach(i=>{const n=i[0];const s=this._register(new XS(i[1]));this._setEnvironmentVariableCollection(n,s)})}$acceptDefaultProfile(e,i){const n=this._defaultProfile;this._defaultProfile=e;this._defaultAutomationProfile=i;if(n?.path!==e.path){this._onDidChangeShell.fire(e.path)}}_setEnvironmentVariableCollection(e,i){this._environmentVariableCollections.set(e,i);this._register(i.onDidChangeCollection(()=>{this._syncEnvironmentVariableCollection(e,i)}))}};sb=z([O(1,Ba),O(2,st)],sb);class XS extends Ee{get persistent(){return this._persistent}set persistent(e){this._persistent=e;this._onDidChangeCollection.fire()}get onDidChangeCollection(){return this._onDidChangeCollection&&this._onDidChangeCollection.event}constructor(e){super();this.map=new Map;this.scopedCollections=new Map;this.descriptionMap=new Map;this._persistent=true;this._onDidChangeCollection=new L;this.map=new Map(e)}getScopedEnvironmentVariableCollection(e){const i=this.getScopeKey(e);let n=this.scopedCollections.get(i);if(!n){n=new F6(this,e);this.scopedCollections.set(i,n);this._register(n.onDidChangeCollection(()=>this._onDidChangeCollection.fire()))}return n}replace(e,i,n,s){this._setIfDiffers(e,{value:i,type:kl.Replace,options:n??{applyAtProcessCreation:true},scope:s})}append(e,i,n,s){this._setIfDiffers(e,{value:i,type:kl.Append,options:n??{applyAtProcessCreation:true},scope:s})}prepend(e,i,n,s){this._setIfDiffers(e,{value:i,type:kl.Prepend,options:n??{applyAtProcessCreation:true},scope:s})}_setIfDiffers(e,i){if(i.options&&i.options.applyAtProcessCreation===false&&!i.options.applyAtShellIntegration){throw new Error("EnvironmentVariableMutatorOptions must apply at either process creation or shell integration")}const n=this.getKey(e,i.scope);const s=this.map.get(n);const r=i.options?{applyAtProcessCreation:i.options.applyAtProcessCreation??false,applyAtShellIntegration:i.options.applyAtShellIntegration??false}:{applyAtProcessCreation:true};if(!s||s.value!==i.value||s.type!==i.type||s.options?.applyAtProcessCreation!==r.applyAtProcessCreation||s.options?.applyAtShellIntegration!==r.applyAtShellIntegration||s.scope?.workspaceFolder?.index!==i.scope?.workspaceFolder?.index){const o=this.getKey(e,i.scope);const a={variable:e,...i,options:r};this.map.set(o,a);this._onDidChangeCollection.fire()}}get(e,i){const n=this.getKey(e,i);const s=this.map.get(n);return s?YS(s):void 0}getKey(e,i){const n=this.getScopeKey(i);return n.length?`${e}:::${n}`:e}getScopeKey(e){return this.getWorkspaceKey(e?.workspaceFolder)??""}getWorkspaceKey(e){return e?e.uri.toString():void 0}getVariableMap(e){const i=new Map;for(const[n,s]of this.map){if(this.getScopeKey(s.scope)===this.getScopeKey(e)){i.set(s.variable,YS(s))}}return i}delete(e,i){const n=this.getKey(e,i);this.map.delete(n);this._onDidChangeCollection.fire()}clear(e){if(e?.workspaceFolder){for(const[i,n]of this.map){if(n.scope?.workspaceFolder?.index===e.workspaceFolder.index){this.map.delete(i)}}this.clearDescription(e)}else{this.map.clear();this.descriptionMap.clear()}this._onDidChangeCollection.fire()}setDescription(e,i){const n=this.getScopeKey(i);const s=this.descriptionMap.get(n);if(!s||s.description!==e){let r;if(typeof e==="string"){r=e}else{r=e?.value.split("\n\n")[0]}const o={description:r,scope:i};this.descriptionMap.set(n,o);this._onDidChangeCollection.fire()}}getDescription(e){const i=this.getScopeKey(e);return this.descriptionMap.get(i)?.description}clearDescription(e){const i=this.getScopeKey(e);this.descriptionMap.delete(i)}}class F6{get persistent(){return this.collection.persistent}set persistent(e){this.collection.persistent=e}get onDidChangeCollection(){return this._onDidChangeCollection&&this._onDidChangeCollection.event}constructor(e,i){this.collection=e;this.scope=i;this._onDidChangeCollection=new L}getScoped(e){return this.collection.getScopedEnvironmentVariableCollection(e)}replace(e,i,n){this.collection.replace(e,i,n,this.scope)}append(e,i,n){this.collection.append(e,i,n,this.scope)}prepend(e,i,n){this.collection.prepend(e,i,n,this.scope)}get(e){return this.collection.get(e,this.scope)}forEach(e,i){this.collection.getVariableMap(this.scope).forEach((n,s)=>e.call(i,s,n,this),this.scope)}[Symbol.iterator](){return this.collection.getVariableMap(this.scope).entries()}delete(e){this.collection.delete(e,this.scope);this._onDidChangeCollection.fire(void 0)}clear(){this.collection.clear(this.scope)}set description(e){this.collection.setDescription(e,this.scope)}get description(){return this.collection.getDescription(this.scope)}}let rb=class b$ extends sb{constructor(e,i){super(false,e,i)}createTerminal(e,i,n){throw new Y1}createTerminalFromOptions(e,i){throw new Y1}};rb=z([O(0,Ba),O(1,st)],rb);function IC(t){if(!t||typeof t==="string"){return void 0}if(!("id"in t)){return t}return{id:t.id,color:t.color}}function M6(t){return Jl.isThemeColor(t)?t:void 0}function YS(t){const e={...t};delete e.scope;e.options=e.options??void 0;delete e.variable;return e}const CC="__";const _y=xe("IExtHostAuthentication");let ob=class y${constructor(e){this._authenticationProviders=new Map;this._onDidChangeSessions=new L;this._getSessionTaskSingler=new U6;this._proxy=e.getProxy(Y.MainThreadAuthentication)}getExtensionScopedSessionsEvent(e){const i=e.toLowerCase();return Bt.chain(this._onDidChangeSessions.event,n=>n.filter(s=>!s.extensionIdFilter||s.extensionIdFilter.includes(i)).map(s=>({provider:s.provider})))}async getSession(e,i,n,s={}){const r=Ze.toKey(e.identifier);const o=[...n].sort().join(" ");const a=Object.keys(s);const l=a.sort().map(c=>`${c}:${!!s[c]}`).join(", ");return await this._getSessionTaskSingler.getOrCreate(`${r} ${i} ${o} ${l}`,async()=>{await this._proxy.$ensureProvider(i);const c=e.displayName||e.name;return this._proxy.$getSession(i,n,r,c,s)})}async getAccounts(e){await this._proxy.$ensureProvider(e);return await this._proxy.$getAccounts(e)}async removeSession(e,i){const n=this._authenticationProviders.get(e);if(!n){return this._proxy.$removeSession(e,i)}return n.provider.removeSession(i)}registerAuthenticationProvider(e,i,n,s){if(this._authenticationProviders.get(e)){throw new Error(`An authentication provider with id '${e}' is already registered.`)}this._authenticationProviders.set(e,{label:i,provider:n,options:s??{supportsMultipleAccounts:false}});const r=n.onDidChangeSessions(o=>this._proxy.$sendDidChangeSessions(e,o));this._proxy.$registerAuthenticationProvider(e,i,s?.supportsMultipleAccounts??false);return new qe(()=>{r.dispose();this._authenticationProviders.delete(e);this._proxy.$unregisterAuthenticationProvider(e)})}async $createSession(e,i,n){const s=this._authenticationProviders.get(e);if(s){return await s.provider.createSession(i,n)}throw new Error(`Unable to find authentication provider with handle: ${e}`)}async $removeSession(e,i){const n=this._authenticationProviders.get(e);if(n){return await n.provider.removeSession(i)}throw new Error(`Unable to find authentication provider with handle: ${e}`)}async $getSessions(e,i,n){const s=this._authenticationProviders.get(e);if(s){return await s.provider.getSessions(i,n)}throw new Error(`Unable to find authentication provider with handle: ${e}`)}$onDidChangeAuthenticationSessions(e,i,n){if(!e.startsWith(CC)){this._onDidChangeSessions.fire({provider:{id:e,label:i},extensionIdFilter:n})}return Promise.resolve()}};ob=z([O(0,st)],ob);class U6{constructor(){this._inFlightPromises=new Map}getOrCreate(e,i){const n=this._inFlightPromises.get(e);if(n){return n}const s=i().finally(()=>this._inFlightPromises.delete(e));this._inFlightPromises.set(e,s);return s}}const $6={label:h(5067,"Other Models"),order:Number.MAX_SAFE_INTEGER};var _f;const vy=xe("IExtHostLanguageModels");class ZS{constructor(e,i){this.option=e;this.stream=new p_;this.stream=i??new p_}}class H6{constructor(){this._responseStreams=new Map;this._defaultStream=new p_;this._isDone=false;const e=this;this.apiObject={get stream(){return e._defaultStream.asyncIterable},get text(){return Ei.map(e._defaultStream.asyncIterable,i=>{if(i instanceof Ht){return i.value}else{return void 0}}).coalesce()}}}*_streams(){if(this._responseStreams.size>0){for(const[,e]of this._responseStreams){yield e.stream}}else{yield this._defaultStream}}handleFragment(e){if(this._isDone){return}let i=this._responseStreams.get(e.index);if(!i){if(this._responseStreams.size===0){i=new ZS(e.index,this._defaultStream)}else{i=new ZS(e.index)}this._responseStreams.set(e.index,i)}let n;if(e.part.type==="text"){n=new Ht(e.part.value)}else if(e.part.type==="data"){n=new Ht("")}else{n=new Ca(e.part.toolCallId,e.part.name,e.part.parameters)}i.stream.emitOne(n)}reject(e){this._isDone=true;for(const i of this._streams()){i.reject(e)}}resolve(){this._isDone=true;for(const e of this._streams()){e.resolve()}}}let ab=class x${static{_f=this}static{this._idPool=1}constructor(e,i,n){this._logService=i;this._extHostAuthentication=n;this._onDidChangeModelAccess=new L;this._onDidChangeProviders=new L;this.onDidChangeProviders=this._onDidChangeProviders.event;this._languageModels=new Map;this._allLanguageModelData=new Map;this._modelAccessList=new Sr;this._pendingRequest=new Map;this._ignoredFileProviders=new Map;this._languageAccessInformationExtensions=new Set;this._proxy=e.getProxy(Y.MainThreadLanguageModels)}dispose(){this._onDidChangeModelAccess.dispose();this._onDidChangeProviders.dispose()}registerLanguageModel(e,i,n,s){const r=_f._idPool++;this._languageModels.set(r,{extension:e.identifier,provider:n,languageModelId:i});let o;if(s.auth){o={providerLabel:e.displayName||e.name,accountLabel:typeof s.auth==="object"?s.auth.label:void 0}}this._proxy.$registerLanguageModelProvider(r,`${Ze.toKey(e.identifier)}/${i}`,{extension:e.identifier,id:i,vendor:s.vendor??Ze.toKey(e.identifier),name:s.name??"",family:s.family??"",cost:s.cost,description:s.description,version:s.version,maxInputTokens:s.maxInputTokens,maxOutputTokens:s.maxOutputTokens,auth:o,targetExtensions:s.extensions,isDefault:s.isDefault,isUserSelectable:s.isUserSelectable,modelPickerCategory:s.category??$6,capabilities:s.capabilities});const a=n.onDidReceiveLanguageModelResponse2?.(({extensionId:l,participant:c,tokenCount:u})=>{this._proxy.$whenLanguageModelChatRequestMade(i,new Ze(l),c,u)});return ge(()=>{this._languageModels.delete(r);this._proxy.$unregisterProvider(r);a?.dispose()})}async $startChatRequest(e,i,n,s,r,o){const a=this._languageModels.get(e);if(!a){throw new Error("Provider not found")}const l=new $0(async u=>{if(o.isCancellationRequested){this._logService.warn(`[CHAT](${a.extension.value}) CANNOT send progress because the REQUEST IS CANCELLED`);return}let d;if(u.part instanceof Ca){d={type:"tool_use",name:u.part.name,parameters:u.part.input,toolCallId:u.part.callId}}else if(u.part instanceof Ht){d={type:"text",value:u.part.value}}else if(u.part instanceof On){d={type:"data",value:{mimeType:u.part.mimeType,data:ue.wrap(u.part.data)}}}if(!d){this._logService.warn(`[CHAT](${a.extension.value}) UNKNOWN part ${JSON.stringify(u)}`);return}this._proxy.$reportResponsePart(i,{index:u.index,part:d})});let c;try{c=a.provider.provideLanguageModelResponse(s.value.map(Ru.to),r,Ze.toKey(n),l,o)}catch(u){throw u}Promise.resolve(c).then(()=>{this._proxy.$reportResponseDone(i,void 0)},u=>{this._proxy.$reportResponseDone(i,Wl(u))})}$provideTokenLength(e,i,n){const s=this._languageModels.get(e);if(!s){return Promise.resolve(0)}return Promise.resolve(s.provider.provideTokenCount(i,n))}$acceptChatModelMetadata(e){if(e.added){for(const{identifier:i,metadata:n}of e.added){this._allLanguageModelData.set(i,{metadata:n,apiObjects:new Sr})}}if(e.removed){for(const i of e.removed){this._allLanguageModelData.delete(i);for(const[n,s]of this._pendingRequest){if(s.languageModelId===i){s.res.reject(new Us);this._pendingRequest.delete(n)}}}}e.added?.forEach(i=>this._fakeAuthPopulate(i.metadata));this._onDidChangeProviders.fire(void 0)}async getDefaultLanguageModel(e){const i=_i.find(this._allLanguageModelData.entries(),([,n])=>!!n.metadata.isDefault)?.[0];if(!i){return}return this.getLanguageModelByIdentifier(e,i)}async getLanguageModelByIdentifier(e,i){const n=this._allLanguageModelData.get(i);if(!n){return}if(this._isUsingAuth(e.identifier,n.metadata)){await this._fakeAuthPopulate(n.metadata)}let s=n.apiObjects.get(e.identifier);if(!s){const r=this;s={id:n.metadata.id,vendor:n.metadata.vendor,family:n.metadata.family,version:n.metadata.version,name:n.metadata.name,capabilities:{supportsImageToText:n.metadata.capabilities?.vision??false,supportsToolCalling:n.metadata.capabilities?.toolCalling??false},maxInputTokens:n.metadata.maxInputTokens,countTokens(o,a){if(!r._allLanguageModelData.has(i)){throw pi.NotFound(i)}return r._computeTokenLength(i,o,a??bt.None)},sendRequest(o,a,l){if(!r._allLanguageModelData.has(i)){throw pi.NotFound(i)}return r._sendChatRequest(e,i,o,a??{},l??bt.None)}};n.apiObjects.set(e.identifier,s)}return s}async selectLanguageModels(e,i){const n=await this._proxy.$selectChatModels({...i,extension:e.identifier});const s=[];for(const r of n){const o=await this.getLanguageModelByIdentifier(e,r);if(o){s.push(o)}}return s}async _sendChatRequest(e,i,n,s,r){const o=this._convertMessages(e,n);const a=e.identifier;const l=this._allLanguageModelData.get(i)?.metadata;if(!l||!this._allLanguageModelData.has(i)){throw pi.NotFound(`Language model '${i}' is unknown.`)}if(this._isUsingAuth(a,l)){const d=await this._getAuthAccess(e,{identifier:l.extension,displayName:l.auth.providerLabel},s.justification,false);if(!d||!this._modelAccessList.get(a)?.has(l.extension)){throw pi.NoPermissions(`Language model '${i}' cannot be used by '${a.value}'.`)}}const c=Math.random()*1e6|0;const u=new H6;this._pendingRequest.set(c,{languageModelId:i,res:u});try{await this._proxy.$tryStartChatRequest(a,i,c,new Bi(o),s,r)}catch(d){this._pendingRequest.delete(c);throw pi.tryDeserialize(d)??d}return u.apiObject}_convertMessages(e,i){const n=[];for(const s of i){if(s.role===on.System){$(e,"languageModelSystem")}n.push(Ru.from(s))}return n}async $acceptResponsePart(e,i){const n=this._pendingRequest.get(e);if(n){n.res.handleFragment(i)}}async $acceptResponseDone(e,i){const n=this._pendingRequest.get(e);if(!n){return}this._pendingRequest.delete(e);if(i){n.res.reject(pi.tryDeserialize(i)??Ak(i))}else{n.res.resolve()}}async _getAuthAccess(e,i,n,s){const r=CC+i.identifier.value;const o=await this._extHostAuthentication.getSession(e,r,[],{silent:true});if(o){this.$updateModelAccesslist([{from:e.identifier,to:i.identifier,enabled:true}]);return true}if(s){return false}try{const a=n?h(2560,"Justification: {1}",i.displayName,n):void 0;await this._extHostAuthentication.getSession(e,r,[],{forceNewSession:{detail:a}});this.$updateModelAccesslist([{from:e.identifier,to:i.identifier,enabled:true}]);return true}catch(a){return false}}_isUsingAuth(e,i){return!!i.auth&&!Ze.equals(i.extension,e)}async _fakeAuthPopulate(e){if(!e.auth){return}for(const i of this._languageAccessInformationExtensions){try{await this._getAuthAccess(i,{identifier:e.extension,displayName:""},void 0,true)}catch(n){this._logService.error("Fake Auth request failed");this._logService.error(n)}}}async _computeTokenLength(e,i,n){const s=this._allLanguageModelData.get(e);if(!s){throw pi.NotFound(`Language model '${e}' is unknown.`)}const r=_i.find(this._languageModels.values(),o=>o.languageModelId===e);if(r){return r.provider.provideTokenCount(i,n)}return this._proxy.$countTokens(e,typeof i==="string"?i:Ru.from(i),n)}$updateModelAccesslist(e){const i=new Array;for(const{from:n,to:s,enabled:r}of e){const o=this._modelAccessList.get(n)??new La;const a=o.has(s);if(a!==r){if(r){o.add(s)}else{o.delete(s)}this._modelAccessList.set(n,o);const l={from:n,to:s};i.push(l);this._onDidChangeModelAccess.fire(l)}}}createLanguageModelAccessInformation(e){this._languageAccessInformationExtensions.add(e);const i=this;const n=Bt.signal(Bt.filter(this._onDidChangeModelAccess.event,r=>Ze.equals(r.from,e.identifier)));const s=Bt.signal(this._onDidChangeProviders.event);return{get onDidChange(){return Bt.any(n,s)},canSendRequest(r){let o;e:for(const[l,c]of i._allLanguageModelData){for(const u of c.apiObjects.values()){if(u===r){o=c.metadata;break e}}}if(!o){return void 0}if(!i._isUsingAuth(e.identifier,o)){return true}const a=i._modelAccessList.get(e.identifier);if(!a){return void 0}return a.has(o.extension)}}}fileIsIgnored(e,i,n=bt.None){$(e,"chatParticipantAdditions");return this._proxy.$fileIsIgnored(i,n)}async $isFileIgnored(e,i,n){const s=this._ignoredFileProviders.get(e);if(!s){throw new Error("Unknown LanguageModelIgnoredFileProvider")}return await s.provideFileIgnored(b.revive(i),n)??false}registerIgnoredFileProvider(e,i){$(e,"chatParticipantPrivate");const n=_f._idPool++;this._proxy.$registerFileIgnoreProvider(n);this._ignoredFileProviders.set(n,i);return ge(()=>{this._proxy.$unregisterFileIgnoreProvider(n);this._ignoredFileProviders.delete(n)})}};ab=_f=z([O(0,st),O(1,at),O(2,_y)],ab);function Kc(t,e=Yi){if(fP(t,e)){return t.charAt(0).toUpperCase()+t.slice(1)}return t}function B6(t,e){return t.replace(/^~($|\/|\\)/,`${e}$1`)}var eD;(function(t){t[t["TEXT"]=0]="TEXT";t[t["VARIABLE"]=1]="VARIABLE";t[t["SEPARATOR"]=2]="SEPARATOR"})(eD||(eD={}));function V6(t){return t.getFullYear()+"-"+String(t.getMonth()+1).padStart(2,"0")+"-"+String(t.getDate()).padStart(2,"0")+"T"+String(t.getHours()).padStart(2,"0")+":"+String(t.getMinutes()).padStart(2,"0")+":"+String(t.getSeconds()).padStart(2,"0")+"."+(t.getMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}const W6={DateTimeFormat(t,e){try{return new Intl.DateTimeFormat(t,e)}catch{return new Intl.DateTimeFormat(void 0,e)}},Collator(t,e){try{return new Intl.Collator(t,e)}catch{return new Intl.Collator(void 0,e)}},Segmenter(t,e){try{return new Intl.Segmenter(t,e)}catch{return new Intl.Segmenter(void 0,e)}},Locale(t,e){try{return new Intl.Locale(t,e)}catch{return new Intl.Locale(to,e)}}};class Wm{constructor(e){const i=hx(e);this._defaultValue=i;this._asciiMap=Wm._createAsciiMap(i);this._map=new Map}static _createAsciiMap(e){const i=new Uint8Array(256);i.fill(e);return i}set(e,i){const n=hx(i);if(e>=0&&e<256){this._asciiMap[e]=n}else{this._map.set(e,n)}}get(e){if(e>=0&&e<256){return this._asciiMap[e]}else{return this._map.get(e)||this._defaultValue}}clear(){this._asciiMap.fill(this._defaultValue);this._map.clear()}}var tD;(function(t){t[t["False"]=0]="False";t[t["True"]=1]="True"})(tD||(tD={}));var ks;(function(t){t[t["Regular"]=0]="Regular";t[t["Whitespace"]=1]="Whitespace";t[t["WordSeparator"]=2]="WordSeparator"})(ks||(ks={}));class z6 extends Wm{constructor(e,i){super(ks.Regular);this._segmenter=null;this._cachedLine=null;this._cachedSegments=[];this.intlSegmenterLocales=i;if(this.intlSegmenterLocales.length>0){this._segmenter=W6.Segmenter(this.intlSegmenterLocales,{granularity:"word"})}else{this._segmenter=null}for(let n=0,s=e.length;n<s;n++){this.set(e.charCodeAt(n),ks.WordSeparator)}this.set(A.Space,ks.Whitespace);this.set(A.Tab,ks.Whitespace)}findPrevIntlWordBeforeOrAtOffset(e,i){let n=null;for(const s of this._getIntlSegmenterWordsOnLine(e)){if(s.index>i){break}n=s}return n}findNextIntlWordAtOrAfterOffset(e,i){for(const n of this._getIntlSegmenterWordsOnLine(e)){if(n.index<i){continue}return n}return null}_getIntlSegmenterWordsOnLine(e){if(!this._segmenter){return[]}if(this._cachedLine===e){return this._cachedSegments}this._cachedLine=e;this._cachedSegments=this._filterWordSegments(this._segmenter.segment(e));return this._cachedSegments}_filterWordSegments(e){const i=[];for(const n of e){if(this._isWordLike(n)){i.push(n)}}return i}_isWordLike(e){if(e.isWordLike){return true}return false}}const iD=new f0(10);function q6(t,e){const i=`${t}/${e.join(",")}`;let n=iD.get(i);if(!n){n=new z6(t,e);iD.set(i,n)}return n}class nD{constructor(e,i,n,s){this.searchString=e;this.isRegex=i;this.matchCase=n;this.wordSeparators=s}parseSearchRequest(){if(this.searchString===""){return null}let e;if(this.isRegex){e=TC(this.searchString)}else{e=this.searchString.indexOf("\n")>=0}let i=null;try{i=YT(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:false,multiline:e,global:true,unicode:true})}catch(s){return null}if(!i){return null}let n=!this.isRegex&&!e;if(n&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()){n=this.matchCase}return new S8(i,this.wordSeparators?q6(this.wordSeparators,[]):null,n?this.searchString:null)}}function TC(t){if(!t||t.length===0){return false}for(let e=0,i=t.length;e<i;e++){const n=t.charCodeAt(e);if(n===A.LineFeed){return true}if(n===A.Backslash){e++;if(e>=i){break}const s=t.charCodeAt(e);if(s===A.n||s===A.r||s===A.W){return true}}}return false}function sD(t,e,i){if(!i){return new k_(t,null)}const n=[];for(let s=0,r=e.length;s<r;s++){n[s]=e[s]}return new k_(t,n)}function j6(t,e,i,n,s){if(n===0){return true}const r=e.charCodeAt(n-1);if(t.get(r)!==ks.Regular){return true}if(r===A.CarriageReturn||r===A.LineFeed){return true}if(s>0){const o=e.charCodeAt(n);if(t.get(o)!==ks.Regular){return true}}return false}function G6(t,e,i,n,s){if(n+s===i){return true}const r=e.charCodeAt(n+s);if(t.get(r)!==ks.Regular){return true}if(r===A.CarriageReturn||r===A.LineFeed){return true}if(s>0){const o=e.charCodeAt(n+s-1);if(t.get(o)!==ks.Regular){return true}}return false}function PC(t,e,i,n,s){return j6(t,e,i,n,s)&&G6(t,e,i,n,s)}class K6{constructor(e,i){this._wordSeparators=e;this._searchRegex=i;this._prevMatchStartIndex=-1;this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e;this._prevMatchStartIndex=-1;this._prevMatchLength=0}next(e){const i=e.length;let n;do{if(this._prevMatchStartIndex+this._prevMatchLength===i){return null}n=this._searchRegex.exec(e);if(!n){return null}const s=n.index;const r=n[0].length;if(s===this._prevMatchStartIndex&&r===this._prevMatchLength){if(r===0){if(dI(e,i,this._searchRegex.lastIndex)>65535){this._searchRegex.lastIndex+=2}else{this._searchRegex.lastIndex+=1}continue}return null}this._prevMatchStartIndex=s;this._prevMatchLength=r;if(!this._wordSeparators||PC(this._wordSeparators,e,i,s,r)){return n}}while(n);return null}}const AC=xe("contextService");const Q6=xe("editorGroupsService");const J6=xe("pathService");function X6(t){return typeof t==="object"&&"uri"in t&&"pattern"in t}let rD=class E${constructor(e,i,n,s,r,o){this.configurationService=e;this.workspaceContextService=i;this.editorGroupsService=n;this.logService=s;this.pathService=r;this.uriIdentityService=o}aiText(e,i,n={}){const s=this.commonQuery(i?.map(b1),n);return{...s,type:va.aiText,contentPattern:e}}text(e,i,n={}){e=this.getContentPattern(e,n);const s=this.configurationService.getValue();const r=i&&i.some(a=>{const l=this.configurationService.getValue({resource:a});return!l.search.useRipgrep});const o=this.commonQuery(i?.map(b1),n);return{...o,type:va.Text,contentPattern:e,previewOptions:n.previewOptions,maxFileSize:n.maxFileSize,usePCRE2:s.search.usePCRE2||r||false,surroundingContext:n.surroundingContext,userDisabledExcludesAndIgnoreFiles:n.disregardExcludeSettings&&n.disregardIgnoreFiles}}getContentPattern(e,i){const n=this.configurationService.getValue();if(e.isRegExp){e.pattern=e.pattern.replace(/\r?\n/g,"\\n")}const s={...e,wordSeparators:n.editor.wordSeparators};if(this.isCaseSensitive(e,i)){s.isCaseSensitive=true}if(this.isMultiline(e)){s.isMultiline=true}if(i.notebookSearchConfig?.includeMarkupInput){if(!s.notebookInfo){s.notebookInfo={}}s.notebookInfo.isInNotebookMarkdownInput=i.notebookSearchConfig.includeMarkupInput}if(i.notebookSearchConfig?.includeMarkupPreview){if(!s.notebookInfo){s.notebookInfo={}}s.notebookInfo.isInNotebookMarkdownPreview=i.notebookSearchConfig.includeMarkupPreview}if(i.notebookSearchConfig?.includeCodeInput){if(!s.notebookInfo){s.notebookInfo={}}s.notebookInfo.isInNotebookCellInput=i.notebookSearchConfig.includeCodeInput}if(i.notebookSearchConfig?.includeOutput){if(!s.notebookInfo){s.notebookInfo={}}s.notebookInfo.isInNotebookCellOutput=i.notebookSearchConfig.includeOutput}return s}file(e,i={}){const n=this.commonQuery(e,i);return{...n,type:va.File,filePattern:i.filePattern?i.filePattern.trim():i.filePattern,exists:i.exists,sortByScore:i.sortByScore,cacheKey:i.cacheKey,shouldGlobMatchFilePattern:i.shouldGlobSearch}}handleIncludeExclude(e,i){if(!e){return{}}if(Array.isArray(e)){e=e.filter(n=>n.length>0).map(vf);if(!e.length){return{}}}else{e=vf(e)}return i?this.parseSearchPaths(e):{pattern:R1(...Array.isArray(e)?e:[e])}}commonQuery(e=[],i={}){let n=Array.isArray(i.excludePattern)?i.excludePattern.map(u=>u.pattern).flat():i.excludePattern;n=n?.length===1?n[0]:n;const s=this.handleIncludeExclude(i.includePattern,i.expandPatterns);const r=this.handleIncludeExclude(n,i.expandPatterns);const o=e.length>1;const a=(s.searchPaths&&s.searchPaths.length?s.searchPaths.map(u=>this.getFolderQueryForSearchPath(u,i,r)):e.map(u=>this.getFolderQueryForRoot(u,i,r,o))).filter(u=>!!u);const l={_reason:i._reason,folderQueries:a,usingSearchPaths:!!(s.searchPaths&&s.searchPaths.length),extraFileResources:i.extraFileResources,excludePattern:r.pattern,includePattern:s.pattern,onlyOpenEditors:i.onlyOpenEditors,maxResults:i.maxResults,onlyFileScheme:i.onlyFileScheme};if(i.onlyOpenEditors){const u=ei(this.editorGroupsService.groups.flatMap(f=>f.editors.map(m=>m.resource)));this.logService.trace("QueryBuilder#commonQuery - openEditor URIs",JSON.stringify(u));const d=u.filter(f=>vS(l,f.fsPath));const p=this.commonQueryFromFileList(d);this.logService.trace("QueryBuilder#commonQuery - openEditor Query",JSON.stringify(p));return{...l,...p}}const c=i.extraFileResources&&i.extraFileResources.filter(u=>vS(l,u.fsPath));l.extraFileResources=c&&c.length?c:void 0;return l}commonQueryFromFileList(e){const i=[];const n=new Ft;const s={};let r=false;e.forEach(o=>{if(o.scheme===ae.walkThrough){return}const a=EP(o);if(a){const l=this.workspaceContextService.getWorkspaceFolder(o)?.uri??this.uriIdentityService.extUri.dirname(o);let c=n.get(l);if(!c){r=true;c={folder:l,includePattern:{}};i.push(c);n.set(l,c)}const u=Ku(l.fsPath,o.fsPath);zl(c.includePattern)[u.replace(/\\/g,"/")]=true}else{if(o.fsPath){r=true;s[o.fsPath]=true}}});return{folderQueries:i,includePattern:s,usingSearchPaths:true,excludePattern:r?void 0:{"**/*":true}}}isCaseSensitive(e,i){if(i.isSmartCase){if(e.isRegExp){if(mx(e.pattern,true)){return true}}else if(mx(e.pattern)){return true}}return!!e.isCaseSensitive}isMultiline(e){if(e.isMultiline){return true}if(e.isRegExp&&TC(e.pattern)){return true}if(e.pattern.indexOf("\n")>=0){return true}return!!e.isMultiline}parseSearchPaths(e){const i=d=>{return Nf(d)||/^\.\.?([\/\\]|$)/.test(d)};const n=Array.isArray(e)?e:Z6(e);const s=n.map(d=>{const p=this.pathService.resolvedUserHome;if(p){return B6(d,p.scheme===ae.file?p.fsPath:p.path)}return d});const r=Lk(s,d=>i(d)?"searchPaths":"exprSegments");const o=(r.exprSegments||[]).map(d=>c_(d,"/")).map(d=>c_(d,"\\")).map(d=>{if(d[0]==="."){d="*"+d}return eL(d)});const a={};const l=this.expandSearchPathPatterns(r.searchPaths||[]);if(l&&l.length){a.searchPaths=l}const c=o.flat();const u=R1(...c);if(u){a.pattern=u}return a}getExcludesForFolder(e,i){return i.disregardExcludeSettings?void 0:M3(e,!i.disregardSearchExcludeSettings)}expandSearchPathPatterns(e){if(!e||!e.length){return[]}const i=e.flatMap(s=>{let{pathPortion:r,globPortion:o}=Y6(s);if(o){o=L1(o)}const a=this.expandOneSearchPath(r);return a.flatMap(l=>this.resolveOneSearchPathPattern(l,o))});const n=new Map;i.forEach(s=>{const r=s.searchPath.toString();const o=n.get(r);if(o){if(s.pattern){o.pattern=o.pattern||{};o.pattern[s.pattern]=true}}else{n.set(r,{searchPath:s.searchPath,pattern:s.pattern?R1(s.pattern):void 0})}});return Array.from(n.values())}expandOneSearchPath(e){if(Nf(e)){const i=this.workspaceContextService.getWorkspace().folders;if(i[0]&&i[0].uri.scheme!==ae.file){return[{searchPath:i[0].uri.with({path:e})}]}return[{searchPath:b.file(jl(e))}]}if(this.workspaceContextService.getWorkbenchState()===Vf.FOLDER){const i=this.workspaceContextService.getWorkspace().folders[0].uri;e=vf(e);if(e.startsWith("../")||e===".."){const s=ct.resolve(i.path,e);return[{searchPath:i.with({path:s})}]}const n=L1(e);return[{searchPath:i,pattern:n}]}else if(e==="./"||e===".\\"){return[]}else{const i=e.replace(/^\.[\/\\]/,"");const n=this.workspaceContextService.getWorkspace().folders;const s=n.map(r=>{const o=i.match(new RegExp(`^${ya(r.name)}(?:/(.*)|$)`));return o?{match:o,folder:r}:null}).filter(ln);if(s.length){return s.map(r=>{const o=r.match[1];return{searchPath:r.folder.uri,pattern:o&&L1(o)}})}else{const r=e.match(/\.[\/\\](.+)[\/\\]?/);const o=r?r[1]:e;const a=h(12555,"Workspace folder does not exist: {0}",o);throw new Error(a)}}}resolveOneSearchPathPattern(e,i){const n=e.pattern&&i?`${e.pattern}/${i}`:e.pattern||i;const s=[{searchPath:e.searchPath,pattern:n}];if(n&&!n.endsWith("**")){s.push({searchPath:e.searchPath,pattern:n+"/**"})}return s}getFolderQueryForSearchPath(e,i,n){const s=this.getFolderQueryForRoot(b1(e.searchPath),i,n,false);if(!s){return null}return{...s,...{includePattern:e.pattern}}}getFolderQueryForRoot(e,i,n,s){let r;const o=b.isUri(e)?e:e.uri;let a=i.excludePattern?.map(f=>{const m=i.excludePattern&&X6(f)?f.uri:void 0;const v=!m||!(b.isUri(e)&&this.uriIdentityService.extUri.isEqual(e,m));return v?m:void 0});if(!a?.length){a=[void 0]}if(n.searchPaths){const f=n.searchPaths.filter(m=>Sl(m.searchPath,o))[0];if(f&&!f.pattern){return null}else if(f){r=f.pattern}}const l=this.configurationService.getValue({resource:o});const c=this.getExcludesForFolder(l,i);const u={...c||{},...r||{}};const d=b.isUri(e)?$s(e):e.name;const p=a.map(f=>{return Object.keys(u).length>0?{folder:f,pattern:u}:void 0}).filter(f=>f);return{folder:o,folderName:s?d:void 0,excludePattern:p,fileEncoding:l.files&&l.files.encoding,disregardIgnoreFiles:typeof i.disregardIgnoreFiles==="boolean"?i.disregardIgnoreFiles:!l.search?.useIgnoreFiles,disregardGlobalIgnoreFiles:typeof i.disregardGlobalIgnoreFiles==="boolean"?i.disregardGlobalIgnoreFiles:!l.search?.useGlobalIgnoreFiles,disregardParentIgnoreFiles:typeof i.disregardParentIgnoreFiles==="boolean"?i.disregardParentIgnoreFiles:!l.search?.useParentIgnoreFiles,ignoreSymlinks:typeof i.ignoreSymlinks==="boolean"?i.ignoreSymlinks:!l.search?.followSymlinks}}};rD=z([O(0,Bm),O(1,AC),O(2,Q6),O(3,at),O(4,J6),O(5,D4)],rD);function Y6(t){const e=t.match(/[\*\{\}\(\)\[\]\?]/);if(e){const i=e.index;const n=t.substr(0,i).match(/[/|\\][^/\\]*$/);if(n){let s=t.substr(0,n.index);if(!s.match(/[/\\]/)){s+="/"}return{pathPortion:s,globPortion:t.substr((n.index||0)+1)}}}return{pathPortion:t}}function R1(...t){return t.length?t.reduce((e,i)=>{e[i]=true;return e},Object.create(null)):void 0}function Z6(t){return N_(t,",").map(e=>e.trim()).filter(e=>!!e.length)}function eL(t){const e=[`**/${t}/**`,`**/${t}`];return e.map(i=>i.replace(/\*\*\/\*\*/g,"**"))}function vf(t){return t.replace(/\\/g,"/")}function L1(t){return vf(t).replace(/^\.\//,"").replace(/\/+$/g,"")}xe("searchService");const tL=7e3;function iL(t,e){const i=e.activationEvents;if(!i){return Promise.resolve(void 0)}const n=[];const s=[];for(const u of i){if(/^workspaceContains:/.test(u)){const d=u.substr("workspaceContains:".length);if(d.indexOf("*")>=0||d.indexOf("?")>=0||t.forceUsingSearch){s.push(d)}else{n.push(d)}}}if(n.length===0&&s.length===0){return Promise.resolve(void 0)}const{promise:r,resolve:o}=kP();const a=u=>o({activationEvent:u});const l=Promise.all(n.map(u=>nL(t,u,a))).then(()=>{});const c=sL(t,e.identifier,s,a);Promise.all([l,c]).then(()=>{o(void 0)});return r}async function nL(t,e,i){for(const n of t.folders){if(await t.exists(ki(b.revive(n),e))){i(`workspaceContains:${e}`);return}}}async function sL(t,e,i,n){if(i.length===0){return Promise.resolve(void 0)}const s=new Ot;const r=t.checkExists(t.folders,i,s.token);const o=setTimeout(async()=>{s.cancel();t.logService.info(`Not activating extension '${e.value}': Timed out while searching for 'workspaceContains' pattern ${i.join(",")}`)},tL);let a=false;try{a=await r}catch(l){if(!fo(l)){Pi(l)}}s.dispose();clearTimeout(o);if(a){n(`workspaceContains:${i.join(",")}`)}}class RC{constructor(e){this._onDidChangePassword=new L;this.onDidChangePassword=this._onDidChangePassword.event;this._proxy=e.getProxy(Y.MainThreadSecretState)}async $onDidChangePassword(e){this._onDidChangePassword.fire(e)}get(e,i){return this._proxy.$getPassword(e,i)}store(e,i,n){return this._proxy.$setPassword(e,i,n)}delete(e,i){return this._proxy.$deletePassword(e,i)}}const wy=xe("IExtHostSecretState");class rL{#e;constructor(e,i){this.disposables=new Ie;this._id=Ze.toKey(e.identifier);this.#e=i;this.onDidChange=Bt.map(Bt.filter(this.#e.onDidChangePassword,n=>n.extensionId===this._id),n=>({key:n.key}),this.disposables)}dispose(){this.disposables.dispose()}get(e){return this.#e.get(this._id,e)}store(e,i){return this.#e.store(this._id,e,i)}delete(e){return this.#e.delete(this._id,e)}}let lb=class S${constructor(e,i,n){this.logService=n;this.bundleCache=new Map;this._proxy=i.getProxy(Y.MainThreadLocalization);this.currentLanguage=e.environment.appLanguage;this.isDefaultLanguage=this.currentLanguage===to}getMessage(e,i){const{message:n,args:s,comment:r}=i;if(this.isDefaultLanguage){return fx(n,s??{})}let o=n;if(r&&r.length>0){o+=`/${Array.isArray(r)?r.join(""):r}`}const a=this.bundleCache.get(e)?.contents[o];if(!a){this.logService.warn(`Using default string since no string found in i18n bundle that has the key: ${o}`)}return fx(a??n,s??{})}getBundle(e){return this.bundleCache.get(e)?.contents}getBundleUri(e){return this.bundleCache.get(e)?.uri}async initializeLocalizedMessages(e){if(this.isDefaultLanguage||!e.l10n&&!e.isBuiltin){return}if(this.bundleCache.has(e.identifier.value)){return}let i;const n=await this.getBundleLocation(e);if(!n){this.logService.error(`No bundle location found for extension ${e.identifier.value}`);return}try{const s=await this._proxy.$fetchBundleContents(n);const r=JSON.parse(s);i=e.isBuiltin?r.contents?.bundle:r}catch(s){this.logService.error(`Failed to load translations for ${e.identifier.value} from ${n}: ${s.message}`);return}if(i){this.bundleCache.set(e.identifier.value,{contents:i,uri:n})}}async getBundleLocation(e){if(e.isBuiltin){const i=await this._proxy.$fetchBuiltInBundleUri(e.identifier.value,this.currentLanguage);return b.revive(i)}return e.l10n?b.joinPath(e.extensionLocation,e.l10n,`bundle.l10n.${this.currentLanguage}.json`):void 0}};lb=z([O(0,Ai),O(1,st),O(2,at)],lb);const by=xe("IExtHostLocalizationService");const yy=xe("IExtHostManagedSockets");let cb=class D${constructor(e){this._remoteSocketIdCounter=0;this._factory=null;this._managedRemoteSockets=new Map;this._proxy=e.getProxy(Y.MainThreadManagedSockets)}setFactory(e,i){for(const n of this._managedRemoteSockets.values()){n.dispose()}if(this._factory){this._proxy.$unregisterSocketFactory(this._factory.socketFactoryId)}this._factory=new oL(e,i);this._proxy.$registerSocketFactory(this._factory.socketFactoryId)}async $openRemoteSocket(e){if(!this._factory||this._factory.socketFactoryId!==e){throw new Error(`No socket factory with id ${e}`)}const i=++this._remoteSocketIdCounter;const n=await this._factory.makeConnection();const s=new Ie;this._managedRemoteSockets.set(i,new aL(i,n,s));s.add(ge(()=>this._managedRemoteSockets.delete(i)));s.add(n.onDidEnd(()=>{this._proxy.$onDidManagedSocketEnd(i);s.dispose()}));s.add(n.onDidClose(r=>{this._proxy.$onDidManagedSocketClose(i,r?.stack??r?.message);s.dispose()}));s.add(n.onDidReceiveMessage(r=>this._proxy.$onDidManagedSocketHaveData(i,ue.wrap(r))));return i}$remoteSocketWrite(e,i){this._managedRemoteSockets.get(e)?.actual.send(i.buffer)}$remoteSocketEnd(e){const i=this._managedRemoteSockets.get(e);if(i){i.actual.end();i.dispose()}}async $remoteSocketDrain(e){await this._managedRemoteSockets.get(e)?.actual.drain?.()}};cb=z([O(0,st)],cb);class oL{constructor(e,i){this.socketFactoryId=e;this.makeConnection=i}}class aL extends Ee{constructor(e,i,n){super();this.socketId=e;this.actual=i;this._register(n)}}var ub;const LC=xe("IHostUtils");let db=ub=class k$ extends Ee{constructor(e,i,n,s,r,o,a,l,c,u,d,p,f){super();this._extHostManagedSockets=p;this._extHostLanguageModels=f;this._onDidChangeRemoteConnectionData=this._register(new L);this.onDidChangeRemoteConnectionData=this._onDidChangeRemoteConnectionData.event;this._realPathCache=new Map;this._isTerminating=false;this._hostUtils=i;this._extHostContext=n;this._initData=a;this._extHostWorkspace=s;this._extHostConfiguration=r;this._logService=o;this._extHostTunnelService=c;this._extHostTerminalService=u;this._extHostLocalizationService=d;this._mainThreadWorkspaceProxy=this._extHostContext.getProxy(Y.MainThreadWorkspace);this._mainThreadTelemetryProxy=this._extHostContext.getProxy(Y.MainThreadTelemetry);this._mainThreadExtensionsProxy=this._extHostContext.getProxy(Y.MainThreadExtensionService);this._almostReadyToRunExtensions=new xs;this._readyToStartExtensionHost=new xs;this._readyToRunExtensions=new xs;this._eagerExtensionsActivated=new xs;this._activationEventsReader=new cL(this._initData.extensions.activationEvents);this._globalRegistry=new wa(this._activationEventsReader,this._initData.extensions.allExtensions);const m=new La(this._initData.extensions.myExtensions);this._myRegistry=new wa(this._activationEventsReader,NC(this._globalRegistry,m));if(So){this._logService.info(`Creating extension host with the following global extensions: ${il(this._globalRegistry)}`);this._logService.info(`Creating extension host with the following local extensions: ${il(this._myRegistry)}`)}this._storage=new EC(this._extHostContext,this._logService);this._secretState=new RC(this._extHostContext);this._storagePath=l;this._instaService=this._store.add(e.createChild(new I0([fy,this._storage],[wy,this._secretState])));this._activator=this._register(new Gw(this._myRegistry,this._globalRegistry,{onExtensionActivationError:(v,y,D)=>{this._mainThreadExtensionsProxy.$onExtensionActivationError(v,Wl(y),D)},actualActivateExtension:async(v,y)=>{if(wa.isHostExtension(v,this._myRegistry,this._globalRegistry)){await this._mainThreadExtensionsProxy.$activateExtension(v,y);return new b6}const D=this._myRegistry.getExtensionDescription(v);return this._activateExtension(D,y)}},this._logService));this._extensionPathIndex=null;this._resolvers=Object.create(null);this._started=false;this._remoteConnectionData=this._initData.remote.connectionData}getRemoteConnectionData(){return this._remoteConnectionData}async initialize(){try{await this._beforeAlmostReadyToRunExtensions();this._almostReadyToRunExtensions.open();await this._extHostWorkspace.waitForInitializeCall();Qi("code/extHost/ready");this._readyToStartExtensionHost.open();if(this._initData.autoStart){this._startExtensionHost()}}catch(e){Pi(e)}}async _deactivateAll(){this._storagePath.onWillDeactivateAll();let e=[];try{const i=this._myRegistry.getAllExtensionDescriptions();const n=i.map(r=>r.identifier);const s=n.filter(r=>this.isActivated(r));e=s.map(r=>{return this._deactivate(r)})}catch(i){}await Promise.all(e)}terminate(e,i=0){if(this._isTerminating){return}this._isTerminating=true;this._logService.info(`Extension host terminating: ${e}`);this._logService.flush();this._extHostTerminalService.dispose();this._activator.dispose();if(ju){X1(s=>{this._logService.error(s)})}this._extHostContext.dispose();const n=this._deactivateAll();Promise.race([Ts(5e3),n]).finally(()=>{if(this._hostUtils.pid){this._logService.info(`Extension host with pid ${this._hostUtils.pid} exiting with code ${i}`)}else{this._logService.info(`Extension host exiting with code ${i}`)}this._logService.flush();this._logService.dispose();this._hostUtils.exit(i)})}isActivated(e){if(this._readyToRunExtensions.isOpen()){return this._activator.isActivated(e)}return false}async getExtension(e){const i=await this._mainThreadExtensionsProxy.$getExtension(e);return i&&{...i,identifier:new Ze(i.identifier.value),extensionLocation:b.revive(i.extensionLocation)}}_activateByEvent(e,i){return this._activator.activateByEvent(e,i)}_activateById(e,i){return this._activator.activateById(e,i)}activateByIdWithErrors(e,i){return this._activateById(e,i).then(()=>{const n=this._activator.getActivatedExtension(e);if(n.activationFailed){return Promise.reject(n.activationFailedError)}return void 0})}getExtensionRegistry(){return this._readyToRunExtensions.wait().then(e=>this._myRegistry)}getExtensionExports(e){if(this._readyToRunExtensions.isOpen()){return this._activator.getActivatedExtension(e).exports}else{try{return this._activator.getActivatedExtension(e).exports}catch(i){return null}}}async _realPathExtensionUri(e){if(e.scheme===ae.file&&this._hostUtils.fsRealpath){const i=e.fsPath;if(!this._realPathCache.has(i)){this._realPathCache.set(i,this._hostUtils.fsRealpath(i))}const n=await this._realPathCache.get(i);return b.file(n)}return e}async getExtensionPathIndex(){if(!this._extensionPathIndex){this._extensionPathIndex=this._createExtensionPathIndex(this._myRegistry.getAllExtensionDescriptions()).then(e=>{return new lL(e)})}return this._extensionPathIndex}async _createExtensionPathIndex(e){const i=xn.forUris(n=>{return bP.ignorePathCasing(n)});await Promise.all(e.map(async n=>{if(this._getEntryPoint(n)){const s=await this._realPathExtensionUri(n.extensionLocation);i.set(s,n)}}));return i}_deactivate(e){let i=Promise.resolve(void 0);if(!this._readyToRunExtensions.isOpen()){return i}if(!this._activator.isActivated(e)){return i}const n=this._activator.getActivatedExtension(e);if(!n){return i}try{if(typeof n.module.deactivate==="function"){i=Promise.resolve(n.module.deactivate()).then(void 0,s=>{this._logService.error(s);return Promise.resolve(void 0)})}}catch(s){this._logService.error(`An error occurred when deactivating the extension '${e.value}':`);this._logService.error(s)}try{n.disposable.dispose()}catch(s){this._logService.error(`An error occurred when disposing the subscriptions for extension '${e.value}':`);this._logService.error(s)}return i}async _activateExtension(e,i){if(!this._initData.remote.isRemote){await this._mainThreadExtensionsProxy.$onWillActivateExtension(e.identifier)}else{this._mainThreadExtensionsProxy.$onWillActivateExtension(e.identifier)}return this._doActivateExtension(e,i).then(n=>{const s=n.activationTimes;this._mainThreadExtensionsProxy.$onDidActivateExtension(e.identifier,s.codeLoadingTime,s.activateCallTime,s.activateResolvedTime,i);this._logExtensionActivationTimes(e,i,"success",s);return n},n=>{this._logExtensionActivationTimes(e,i,"failure");throw n})}_logExtensionActivationTimes(e,i,n,s){const r=aD(e,i);this._mainThreadTelemetryProxy.$publicLog2("extensionActivationTimes",{...r,...s||{},outcome:n})}_doActivateExtension(e,i){const n=aD(e,i);this._mainThreadTelemetryProxy.$publicLog2("activatePlugin",n);const s=this._getEntryPoint(e);if(!s){return Promise.resolve(new w6(Lc.NONE))}this._logService.info(`ExtensionService#_doActivateExtension ${e.identifier.value}, startup: ${i.startup}, activationEvent: '${i.activationEvent}'${e.identifier.value!==i.extensionId.value?`, root cause: ${i.extensionId.value}`:``}`);this._logService.flush();const r=this._isESM(e);const o=new Ie;const a=new P1(i.startup);return Promise.all([r?this._loadESMModule(e,ki(e.extensionLocation,s),a):this._loadCommonJSModule(e,ki(e.extensionLocation,s),a),this._loadExtensionContext(e,o)]).then(l=>{Qi(`code/extHost/willActivateExtension/${e.identifier.value}`);return ub._callActivate(this._logService,e.identifier,l[0],l[1],o,a)}).then(l=>{Qi(`code/extHost/didActivateExtension/${e.identifier.value}`);return l})}_loadExtensionContext(e,i){const n=this._extHostLanguageModels.createLanguageModelAccessInformation(e);const s=i.add(new y6(e,this._storage));const r=i.add(new SC(e.identifier.value,false,this._storage));const o=i.add(new rL(e,this._secretState));const a=e.isUnderDevelopment?this._initData.environment.extensionTestsLocationURI?Fl.Test:Fl.Development:Fl.Production;const l=this._initData.remote.isRemote?ha.Workspace:ha.UI;this._logService.trace(`ExtensionService#loadExtensionContext ${e.identifier.value}`);return Promise.all([s.whenReady,r.whenReady,this._storagePath.whenReady]).then(()=>{const c=this;let u;let d;const p=dt(e,"ipc")?this._initData.messagePorts?.get(Ze.toKey(e.identifier)):void 0;return Object.freeze({globalState:s,workspaceState:r,secrets:o,subscriptions:[],get languageModelAccessInformation(){return n},get extensionUri(){return e.extensionLocation},get extensionPath(){return e.extensionLocation.fsPath},asAbsolutePath(f){return r_(e.extensionLocation.fsPath,f)},get storagePath(){return c._storagePath.workspaceValue(e)?.fsPath},get globalStoragePath(){return c._storagePath.globalValue(e).fsPath},get logPath(){return r_(c._initData.logsLocation.fsPath,e.identifier.value)},get logUri(){return b.joinPath(c._initData.logsLocation,e.identifier.value)},get storageUri(){return c._storagePath.workspaceValue(e)},get globalStorageUri(){return c._storagePath.globalValue(e)},get extensionMode(){return a},get extension(){if(u===void 0){u=new cu(c,e.identifier,e,l,false)}return u},get extensionRuntime(){$(e,"extensionRuntime");return c.extensionRuntime},get environmentVariableCollection(){return c._extHostTerminalService.getEnvironmentVariableCollection(e)},get messagePassingProtocol(){if(!d){if(!p){return void 0}const f=Bt.buffer(Bt.fromDOMEventEmitter(p,"message",m=>m.data));p.start();d={onDidReceiveMessage:f,postMessage:p.postMessage.bind(p)}}return d}})})}static _callActivate(e,i,n,s,r,o){n=n||{activate:void 0,deactivate:void 0};return this._callActivateOptional(e,i,n,s,o).then(a=>{return new $m(false,null,o.build(),n,a,ge(()=>{r.dispose();yr(s.subscriptions)}))})}static _callActivateOptional(e,i,n,s,r){if(typeof n.activate==="function"){try{r.activateCallStart();e.trace(`ExtensionService#_callActivateOptional ${i.value}`);const o=typeof global==="object"?global:self;const a=n.activate.apply(o,[s]);r.activateCallStop();r.activateResolveStart();return Promise.resolve(a).then(l=>{r.activateResolveStop();return l})}catch(o){return Promise.reject(o)}}else{return Promise.resolve(n)}}_activateOneStartupFinished(e,i){this._activateById(e.identifier,{startup:false,extensionId:e.identifier,activationEvent:i}).then(void 0,n=>{this._logService.error(n)})}_activateAllStartupFinishedDeferred(e,i=0){const n=50;const s=Date.now();Zk(()=>{for(let r=i;r<e.length;r+=1){const o=e[r];for(const a of o.activationEvents??[]){if(a==="onStartupFinished"){if(Date.now()-s>n){this._activateAllStartupFinishedDeferred(e,r);break}else{this._activateOneStartupFinished(o,a)}}}}})}_activateAllStartupFinished(){this._mainThreadExtensionsProxy.$setPerformanceMarks(mT());this._extHostConfiguration.getConfigProvider().then(e=>{const i=e.getConfiguration("extensions.experimental").get("deferredStartupFinishedActivation");const n=this._myRegistry.getAllExtensionDescriptions();if(i){this._activateAllStartupFinishedDeferred(n)}else{for(const s of n){if(s.activationEvents){for(const r of s.activationEvents){if(r==="onStartupFinished"){this._activateOneStartupFinished(s,r)}}}}}})}_handleEagerExtensions(){const e=this._activateByEvent("*",true).then(void 0,o=>{this._logService.error(o)});this._register(this._extHostWorkspace.onDidChangeWorkspace(o=>this._handleWorkspaceContainsEagerExtensions(o.added)));const i=this._extHostWorkspace.workspace?this._extHostWorkspace.workspace.folders:[];const n=this._handleWorkspaceContainsEagerExtensions(i);const s=this._handleRemoteResolverEagerExtensions();const r=Promise.all([s,e,n]).then(()=>{});Promise.race([r,Ts(1e4)]).then(()=>{this._activateAllStartupFinished()});return r}_handleWorkspaceContainsEagerExtensions(e){if(e.length===0){return Promise.resolve(void 0)}return Promise.all(this._myRegistry.getAllExtensionDescriptions().map(i=>{return this._handleWorkspaceContainsEagerExtension(e,i)})).then(()=>{})}async _handleWorkspaceContainsEagerExtension(e,i){if(this.isActivated(i.identifier)){return}const n=!this._initData.remote.isRemote&&!!this._initData.remote.authority;const s={logService:this._logService,folders:e.map(o=>o.uri),forceUsingSearch:n||!this._hostUtils.fsExists,exists:o=>this._hostUtils.fsExists(o.fsPath),checkExists:(o,a,l)=>this._mainThreadWorkspaceProxy.$checkExists(o,a,l)};const r=await iL(s,i);if(!r){return}return this._activateById(i.identifier,{startup:true,extensionId:i.identifier,activationEvent:r.activationEvent}).then(void 0,o=>this._logService.error(o))}async _handleRemoteResolverEagerExtensions(){if(this._initData.remote.authority){return this._activateByEvent(`onResolveRemoteAuthority:${this._initData.remote.authority}`,false)}}async $extensionTestsExecute(){await this._eagerExtensionsActivated.wait();try{return await this._doHandleExtensionTests()}catch(e){console.error(e);throw e}}async _doHandleExtensionTests(){const{extensionDevelopmentLocationURI:e,extensionTestsLocationURI:i}=this._initData.environment;if(!e||!i){throw new Error(h(2556,"Cannot load test runner."))}const n=(await this.getExtensionPathIndex()).findSubstr(i);const s=this._isESM(n,i.path);const r=await(s?this._loadESMModule(null,i,new P1(false)):this._loadCommonJSModule(null,i,new P1(false)));if(!r||typeof r.run!=="function"){throw new Error(h(2557,"Path {0} does not point to a valid extension test runner.",i.toString()))}return new Promise((o,a)=>{const l=(d,p)=>{if(d){if(So){this._logService.error(`Test runner called back with error`,d)}a(d)}else{if(So){if(p){this._logService.info(`Test runner called back with ${p} failures.`)}else{this._logService.info(`Test runner called back with successful outcome.`)}}o(typeof p==="number"&&p>0?1:0)}};const c=Wn(i);const u=r.run(c,l);if(u&&u.then){u.then(()=>{if(So){this._logService.info(`Test runner finished successfully.`)}o(0)}).catch(d=>{if(So){this._logService.error(`Test runner finished with error`,d)}a(d instanceof Error&&d.stack?d.stack:String(d))})}})}_startExtensionHost(){if(this._started){throw new Error(`Extension host is already started!`)}this._started=true;return this._readyToStartExtensionHost.wait().then(()=>this._readyToRunExtensions.open()).then(()=>{return Promise.race([this._activator.waitForActivatingExtensions(),Ts(1e3)])}).then(()=>this._handleEagerExtensions()).then(()=>{this._eagerExtensionsActivated.open();this._logService.info(`Eager extensions activated`)})}registerRemoteAuthorityResolver(e,i){this._resolvers[e]=i;return ge(()=>{delete this._resolvers[e]})}async getRemoteExecServer(e){const{resolver:i}=await this._activateAndGetResolver(e);return i?.resolveExecServer?.(e,{resolveAttempt:0})}async _activateAndGetResolver(e){const i=e.indexOf("+");if(i===-1){throw new bs(`Not an authority that can be resolved!`,pr.InvalidAuthority)}const n=e.substr(0,i);await this._almostReadyToRunExtensions.wait();await this._activateByEvent(`onResolveRemoteAuthority:${n}`,false);return{authorityPrefix:n,resolver:this._resolvers[n]}}async $resolveAuthority(e,i){const n=xr.create(false);const s=()=>`[resolveAuthority(${iS(e)},${i})][${n.elapsed()}ms] `;const r=I=>this._logService.info(`${s()}${I}`);const o=I=>this._logService.warn(`${s()}${I}`);const a=(I,R=void 0)=>this._logService.error(`${s()}${I}`,R);const l=I=>{if(I instanceof bs){return{type:"error",error:{code:I._code,message:I._message,detail:I._detail}}}throw I};const c=async I=>{r(`activating resolver for ${I}...`);const{resolver:R,authorityPrefix:J}=await this._activateAndGetResolver(I);if(!R){a(`no resolver for ${J}`);throw new bs(`No remote extension installed to resolve ${J}.`,pr.NoResolverFound)}return{resolver:R,authorityPrefix:J,remoteAuthority:I}};const u=e.split(/@|%40/g).reverse();r(`activating remote resolvers ${u.join(" -> ")}`);let d;try{d=await Promise.all(u.map(c)).catch(async I=>{if(!(I instanceof bs)||I._code!==pr.InvalidAuthority){throw I}o(`resolving nested authorities failed: ${I.message}`);return[await c(e)]})}catch(I){return l(I)}const p=new MP;p.cancelAndSet(()=>r("waiting..."),1e3);let f;let m;for(const[I,{authorityPrefix:R,resolver:J,remoteAuthority:H}]of d.entries()){try{if(I===d.length-1){r(`invoking final resolve()...`);Qi(`code/extHost/willResolveAuthority/${R}`);f=await J.resolve(H,{resolveAttempt:i,execServer:m});Qi(`code/extHost/didResolveAuthorityOK/${R}`);r(`setting tunnel factory...`);this._register(await this._extHostTunnelService.setTunnelFactory(J,uf.isManagedResolvedAuthority(f)?f:void 0))}else{r(`invoking resolveExecServer() for ${H}`);Qi(`code/extHost/willResolveExecServer/${R}`);m=await J.resolveExecServer?.(H,{resolveAttempt:i,execServer:m});if(!m){throw new bs(`Exec server was not available for ${H}`,pr.NoResolverFound)}Qi(`code/extHost/didResolveExecServerOK/${R}`)}}catch(Q){Qi(`code/extHost/didResolveAuthorityError/${R}`);a(`returned an error`,Q);p.dispose();return l(Q)}}p.dispose();const v={environmentTunnels:f.environmentTunnels,features:f.tunnelFeatures?{elevation:f.tunnelFeatures.elevation,privacyOptions:f.tunnelFeatures.privacyOptions,protocol:f.tunnelFeatures.protocol===void 0?true:f.tunnelFeatures.protocol}:void 0};const y={extensionHostEnv:f.extensionHostEnv,isTrusted:f.isTrusted,authenticationSession:f.authenticationSessionForInitializingExtensions?{id:f.authenticationSessionForInitializingExtensions.id,providerId:f.authenticationSessionForInitializingExtensions.providerId}:void 0};r(`returned ${uf.isManagedResolvedAuthority(f)?"managed authority":`${f.host}:${f.port}`}`);let D;if(uf.isManagedResolvedAuthority(f)){const I=i;this._extHostManagedSockets.setFactory(I,f.makeConnection);D={authority:e,connectTo:new e3(I),connectionToken:f.connectionToken}}else{D={authority:e,connectTo:new t3(f.host,f.port),connectionToken:f.connectionToken}}return{type:"ok",value:{authority:D,options:y,tunnelInformation:v}}}async $getCanonicalURI(e,i){this._logService.info(`$getCanonicalURI invoked for authority (${iS(e)})`);const{resolver:n}=await this._activateAndGetResolver(e);if(!n){return null}const s=b.revive(i);if(typeof n.getCanonicalURI==="undefined"){return s}const r=await Ci(()=>n.getCanonicalURI(s));if(!r){return s}return r}async $startExtensionHost(e){e.toAdd.forEach(o=>o.extensionLocation=b.revive(o.extensionLocation));const{globalRegistry:i,myExtensions:n}=oD(this._activationEventsReader,this._globalRegistry,this._myRegistry,e);const s=await this._createExtensionPathIndex(n);const r=await this.getExtensionPathIndex();r.setSearchTree(s);this._globalRegistry.set(i.getAllExtensionDescriptions());this._myRegistry.set(n);if(So){this._logService.info(`$startExtensionHost: global extensions: ${il(this._globalRegistry)}`);this._logService.info(`$startExtensionHost: local extensions: ${il(this._myRegistry)}`)}return this._startExtensionHost()}$activateByEvent(e,i){if(i===B_.Immediate){return this._almostReadyToRunExtensions.wait().then(n=>this._activateByEvent(e,false))}return this._readyToRunExtensions.wait().then(n=>this._activateByEvent(e,false))}async $activate(e,i){await this._readyToRunExtensions.wait();if(!this._myRegistry.getExtensionDescription(e)){return false}await this._activateById(e,i);return true}async $deltaExtensions(e){e.toAdd.forEach(o=>o.extensionLocation=b.revive(o.extensionLocation));const{globalRegistry:i,myExtensions:n}=oD(this._activationEventsReader,this._globalRegistry,this._myRegistry,e);const s=await this._createExtensionPathIndex(n);const r=await this.getExtensionPathIndex();r.setSearchTree(s);this._globalRegistry.set(i.getAllExtensionDescriptions());this._myRegistry.set(n);if(So){this._logService.info(`$deltaExtensions: global extensions: ${il(this._globalRegistry)}`);this._logService.info(`$deltaExtensions: local extensions: ${il(this._myRegistry)}`)}return Promise.resolve(void 0)}async $test_latency(e){return e}async $test_up(e){return e.byteLength}async $test_down(e){const i=ue.alloc(e);const n=Math.random()%256;for(let s=0;s<e;s++){i.writeUInt8(n,s)}return i}async $updateRemoteConnectionData(e){this._remoteConnectionData=e;this._onDidChangeRemoteConnectionData.fire()}_isESM(e,i){i??=e?.main;return i?.endsWith(".mjs")||e?.type==="module"&&!i?.endsWith(".cjs")}};db=ub=z([O(0,ch),O(1,LC),O(2,st),O(3,Cr),O(4,Tr),O(5,at),O(6,Ai),O(7,py),O(8,gy),O(9,Nc),O(10,by),O(11,yy),O(12,vy)],db);function oD(t,e,i,n){t.addActivationEvents(n.addActivationEvents);const s=new wa(t,e.getAllExtensionDescriptions());s.deltaExtensions(n.toAdd,n.toRemove);const r=new La(i.getAllExtensionDescriptions().map(a=>a.identifier));for(const a of n.myToRemove){r.delete(a)}for(const a of n.myToAdd){r.add(a)}const o=NC(s,r);return{globalRegistry:s,myExtensions:o}}function aD(t,e){const i={id:t.identifier.value,name:t.name,extensionVersion:t.version,publisherDisplayName:t.publisher,activationEvents:t.activationEvents?t.activationEvents.join(","):null,isBuiltin:t.isBuiltin,reason:e.activationEvent,reasonId:e.extensionId.value};return i}function il(t){return t.getAllExtensionDescriptions().map(e=>e.identifier.value).join(",")}const bo=xe("IExtHostExtensionService");class cu{#e;#t;#i;constructor(e,i,n,s,r){this.#e=e;this.#t=i;this.#i=n.identifier;this.id=n.identifier.value;this.extensionUri=n.extensionLocation;this.extensionPath=jl(Wn(n.extensionLocation));this.packageJSON=n;this.extensionKind=s;this.isFromDifferentExtensionHost=r}get isActive(){return this.#e.isActivated(this.#i)}get exports(){if(this.packageJSON.api==="none"||this.isFromDifferentExtensionHost){return void 0}return this.#e.getExtensionExports(this.#i)}async activate(){if(this.isFromDifferentExtensionHost){throw new Error("Cannot activate foreign extension")}await this.#e.activateByIdWithErrors(this.#i,{startup:false,extensionId:this.#t,activationEvent:"api"});return this.exports}}function NC(t,e){return t.getAllExtensionDescriptions().filter(i=>e.has(i.identifier))}class lL{constructor(e){this._searchTree=e}setSearchTree(e){this._searchTree=e}findSubstr(e){return this._searchTree.findSubstr(e)}forEach(e){return this._searchTree.forEach(e)}}class cL{constructor(e){this._map=new Sr;this.addActivationEvents(e)}readActivationEvents(e){return this._map.get(e.identifier)??[]}addActivationEvents(e){for(const i of Object.keys(e)){this._map.set(i,e[i])}}}var Be;(function(t){t[t["Off"]=0]="Off";t[t["Trace"]=1]="Trace";t[t["Debug"]=2]="Debug";t[t["Info"]=3]="Info";t[t["Warning"]=4]="Warning";t[t["Error"]=5]="Error"})(Be||(Be={}));const uL=Be.Info;function dL(t,e){return t!==Be.Off&&t<=e}function hL(t,e,i){switch(e){case Be.Trace:t.trace(i);break;case Be.Debug:t.debug(i);break;case Be.Info:t.info(i);break;case Be.Warning:t.warn(i);break;case Be.Error:t.error(i);break;case Be.Off:break;default:throw new Error(`Invalid log level ${e}`)}}function nl(t,e=false){let i="";for(let n=0;n<t.length;n++){let s=t[n];if(s instanceof Error){s=Rc(s,e)}if(typeof s==="object"){try{s=JSON.stringify(s)}catch(r){}}i+=(n>0?" ":"")+s}return i}class OC extends Ee{constructor(){super(...arguments);this.level=uL;this._onDidChangeLogLevel=this._register(new L);this.onDidChangeLogLevel=this._onDidChangeLogLevel.event}setLevel(e){if(this.level!==e){this.level=e;this._onDidChangeLogLevel.fire(this.level)}}getLevel(){return this.level}checkLogLevel(e){return dL(this.level,e)}canLog(e){if(this._store.isDisposed){return false}return this.checkLogLevel(e)}}class FC extends OC{constructor(e){super();this.logAlways=e}checkLogLevel(e){return this.logAlways||super.checkLogLevel(e)}trace(e,...i){if(this.canLog(Be.Trace)){this.log(Be.Trace,nl([e,...i],true))}}debug(e,...i){if(this.canLog(Be.Debug)){this.log(Be.Debug,nl([e,...i]))}}info(e,...i){if(this.canLog(Be.Info)){this.log(Be.Info,nl([e,...i]))}}warn(e,...i){if(this.canLog(Be.Warning)){this.log(Be.Warning,nl([e,...i]))}}error(e,...i){if(this.canLog(Be.Error)){if(e instanceof Error){const n=Array.prototype.slice.call(arguments);n[0]=e.stack;this.log(Be.Error,nl(n))}else{this.log(Be.Error,nl([e,...i]))}}}flush(){}}class fL extends OC{constructor(e){super();this.loggers=e;if(e.length){this.setLevel(e[0].getLevel())}}setLevel(e){for(const i of this.loggers){i.setLevel(e)}super.setLevel(e)}trace(e,...i){for(const n of this.loggers){n.trace(e,...i)}}debug(e,...i){for(const n of this.loggers){n.debug(e,...i)}}info(e,...i){for(const n of this.loggers){n.info(e,...i)}}warn(e,...i){for(const n of this.loggers){n.warn(e,...i)}}error(e,...i){for(const n of this.loggers){n.error(e,...i)}}flush(){for(const e of this.loggers){e.flush()}}dispose(){for(const e of this.loggers){e.dispose()}super.dispose()}}class pL extends Ee{constructor(e,i,n){super();this.logLevel=e;this.logsHome=i;this._loggers=new Ft;this._onDidChangeLoggers=this._register(new L);this.onDidChangeLoggers=this._onDidChangeLoggers.event;this._onDidChangeLogLevel=this._register(new L);this.onDidChangeLogLevel=this._onDidChangeLogLevel.event;this._onDidChangeVisibility=this._register(new L);this.onDidChangeVisibility=this._onDidChangeVisibility.event;if(n){for(const s of n){this._loggers.set(s.resource,{logger:void 0,info:s})}}}getLoggerEntry(e){if(tt(e)){return[...this._loggers.values()].find(i=>i.info.id===e)}return this._loggers.get(e)}getLogger(e){return this.getLoggerEntry(e)?.logger}createLogger(e,i){const n=this.toResource(e);const s=tt(e)?e:i?.id??td(n.toString()).toString(16);let r=this._loggers.get(n)?.logger;const o=i?.logLevel==="always"?Be.Trace:i?.logLevel;if(!r){r=this.doCreateLogger(n,o??this.getLogLevel(n)??this.logLevel,{...i,id:s})}const a={logger:r,info:{resource:n,id:s,logLevel:o,name:i?.name,hidden:i?.hidden,group:i?.group,extensionId:i?.extensionId,when:i?.when}};this.registerLogger(a.info);this._loggers.set(n,a);return r}toResource(e){return tt(e)?ki(this.logsHome,`${e}.log`):e}setLogLevel(e,i){if(b.isUri(e)){const n=e;const s=i;const r=this._loggers.get(n);if(r&&s!==r.info.logLevel){r.info.logLevel=s===this.logLevel?void 0:s;r.logger?.setLevel(s);this._loggers.set(r.info.resource,r);this._onDidChangeLogLevel.fire([n,s])}}else{this.logLevel=e;for(const[n,s]of this._loggers.entries()){if(this._loggers.get(n)?.info.logLevel===void 0){s.logger?.setLevel(this.logLevel)}}this._onDidChangeLogLevel.fire(this.logLevel)}}setVisibility(e,i){const n=this.getLoggerEntry(e);if(n&&i!==!n.info.hidden){n.info.hidden=!i;this._loggers.set(n.info.resource,n);this._onDidChangeVisibility.fire([n.info.resource,i])}}getLogLevel(e){let i;if(e){i=this._loggers.get(e)?.info.logLevel}return i??this.logLevel}registerLogger(e){const i=this._loggers.get(e.resource);if(i){if(i.info.hidden!==e.hidden){this.setVisibility(e.resource,!e.hidden)}}else{this._loggers.set(e.resource,{info:e,logger:void 0});this._onDidChangeLoggers.fire({added:[e],removed:[]})}}deregisterLogger(e){const i=this.toResource(e);const n=this._loggers.get(i);if(n){if(n.logger){n.logger.dispose()}this._loggers.delete(i);this._onDidChangeLoggers.fire({added:[],removed:[n.info]})}}*getRegisteredLoggers(){for(const e of this._loggers.values()){yield e.info}}getRegisteredLogger(e){return this._loggers.get(e)?.info}dispose(){this._loggers.forEach(e=>e.logger?.dispose());this._loggers.clear();super.dispose()}}function gL(t){switch(t){case Be.Trace:return"trace";case Be.Debug:return"debug";case Be.Info:return"info";case Be.Warning:return"warn";case Be.Error:return"error";case Be.Off:return"off"}}function mL(t){switch(t){case"trace":return Be.Trace;case"debug":return Be.Debug;case"info":return Be.Info;case"warn":return Be.Warning;case"error":return Be.Error;case"critical":return Be.Error;case"off":return Be.Off}return void 0}new T("logLevel",gL(Be.Info));let Yg=class I$ extends pL{constructor(e,i){super(i.logLevel,i.logsLocation,i.loggers.map(n=>ti(n)));this._proxy=e.getProxy(Y.MainThreadLogger)}$setLogLevel(e,i){if(i){this.setLogLevel(b.revive(i),e)}else{this.setLogLevel(e)}}setVisibility(e,i){super.setVisibility(e,i);this._proxy.$setVisibility(e,i)}doCreateLogger(e,i,n){return new _L(this._proxy,e,i,n)}};Yg=z([O(0,st),O(1,Ai)],Yg);class _L extends FC{constructor(e,i,n,s){super(s?.logLevel==="always");this.proxy=e;this.file=i;this.isLoggerCreated=false;this.buffer=[];this.setLevel(n);this.proxy.$createLogger(i,s).then(()=>{this.doLog(this.buffer);this.isLoggerCreated=true})}log(e,i){const n=[[e,i]];if(this.isLoggerCreated){this.doLog(n)}else{this.buffer.push(...n)}}doLog(e){this.proxy.$log(this.file,e)}flush(){this.proxy.$flush(this.file)}}class vL extends Ee{constructor(e,i=[]){super();this.logger=new fL([e,...i]);this._register(e.onDidChangeLogLevel(n=>this.setLevel(n)))}get onDidChangeLogLevel(){return this.logger.onDidChangeLogLevel}setLevel(e){this.logger.setLevel(e)}getLevel(){return this.logger.getLevel()}trace(e,...i){this.logger.trace(e,...i)}debug(e,...i){this.logger.debug(e,...i)}info(e,...i){this.logger.info(e,...i)}warn(e,...i){this.logger.warn(e,...i)}error(e,...i){this.logger.error(e,...i)}flush(){this.logger.flush()}}let hb=class C$ extends vL{constructor(e,i,n){const s=n.remote.isRemote?"remoteexthost":e?"workerexthost":"exthost";const r=n.remote.isRemote?h(2561,"Extension Host (Remote)"):e?h(2562,"Extension Host (Worker)"):h(2563,"Extension Host");super(i.createLogger(s,{name:r}))}};hb=z([O(1,Cc),O(2,Ai)],hb);class lD{static async installEarlyHandler(e){Error.stackTraceLimit=100;const i=e.get(at);const n=e.get(st);const s=n.getProxy(Y.MainThreadErrors);X1(r=>{i.error(r);const o=Wl(r);s.$onUnexpectedError(o)})}static async installFullHandler(e){const i=e.get(at);const n=e.get(st);const s=e.get(bo);const r=e.get(Vm);const o=n.getProxy(Y.MainThreadExtensionService);const a=n.getProxy(Y.MainThreadErrors);const l=await s.getExtensionPathIndex();const c=new WeakMap;function u(f,m){if(c.has(f)){return c.get(f).stack}let v="";let y;let D;for(const R of m){v+=`
	at ${R.toString()}`;D=R.getFileName();if(!y&&D){y=l.findSubstr(b.file(D))}}const I=`${f.name||"Error"}: ${f.message||""}${v}`;c.set(f,{extensionIdentifier:y?.identifier,stack:I});return I}const d=Symbol("prepareStackTrace wrapped");let p=u;Object.defineProperty(Error,"prepareStackTrace",{configurable:false,get(){return p},set(f){if(f===u||!f||f[d]){p=f||u;return}p=function(m,v){u(m,v);return f.call(Error,m,v)};Object.assign(p,{[d]:true})}});X1(f=>{i.error(f);const m=Wl(f);let v;if(f instanceof EI){v=f.extension}else{const y=c.get(f);v=y?.extensionIdentifier}if(v){o.$onExtensionRuntimeError(v,m);const y=r.onExtensionError(v,f);i.trace("forwarded error to extension?",y,v)}});rh.addListener(f=>{a.$onUnexpectedError(f)})}}class xy{constructor(e,i,n,s,r){this._hostUtils=n;this._rpcProtocol=new $f(e,null,s);i=xy._transform(i,this._rpcProtocol);const o=new I0(...QP());o.set(Ai,{_serviceBrand:void 0,...i,messagePorts:r});o.set(st,new YP(this._rpcProtocol));o.set(wm,new ZP(s));o.set(LC,n);o.set(at,new Zn(hb,[true],true));o.set(Cc,new Zn(Yg,[],true));const a=new Hf(o,true);if(ju){a.invokeFunction(lD.installEarlyHandler)}this._logService=a.invokeFunction(l=>l.get(at));Qi(`code/extHost/didCreateServices`);if(this._hostUtils.pid){this._logService.info(`Extension host with pid ${this._hostUtils.pid} started`)}else{this._logService.info(`Extension host started`)}this._logService.trace("initData",i);this._extensionService=a.invokeFunction(l=>l.get(bo));this._extensionService.initialize();if(ju){a.invokeFunction(lD.installFullHandler)}}async asBrowserUri(e){const i=this._rpcProtocol.getProxy(Y.MainThreadExtensionService);return b.revive(await i.$asBrowserUri(e))}async getAllStaticBrowserUris(){const e=this._rpcProtocol.getProxy(Y.MainThreadExtensionService);return(await e.$getAllStaticBrowserUris()).map(([i,n])=>[b.revive(i),b.revive(n)])}terminate(e){this._extensionService.terminate(e)}getExtHostExtensionService(){return this._extensionService}static _transform(e,i){e.extensions.allExtensions.forEach(s=>{s.extensionLocation=b.revive(i.transformIncomingURIs(s.extensionLocation))});e.environment.appRoot=b.revive(i.transformIncomingURIs(e.environment.appRoot));const n=e.environment.extensionDevelopmentLocationURI;if(n){e.environment.extensionDevelopmentLocationURI=n.map(s=>b.revive(i.transformIncomingURIs(s)))}e.environment.extensionTestsLocationURI=b.revive(i.transformIncomingURIs(e.environment.extensionTestsLocationURI));e.environment.globalStorageHome=b.revive(i.transformIncomingURIs(e.environment.globalStorageHome));e.environment.workspaceStorageHome=b.revive(i.transformIncomingURIs(e.environment.workspaceStorageHome));e.nlsBaseUrl=b.revive(i.transformIncomingURIs(e.nlsBaseUrl));e.logsLocation=b.revive(i.transformIncomingURIs(e.logsLocation));e.workspace=i.transformIncomingURIs(e.workspace);return e}}const wL=function t(e){const i=n=>{globalThis.removeEventListener("message",i);const s=n.data;Object.defineProperties(globalThis,{"postMessage":{value(r,o){s.postMessage(r,o)}},"onmessage":{get(){return s.onmessage},set(r){s.onmessage=r}}});s.addEventListener("message",r=>{globalThis.dispatchEvent(new MessageEvent("message",{data:r.data,ports:r.ports?[...r.ports]:void 0}))});s.start();globalThis.Worker=class{constructor(){throw new TypeError("Nested workers from within nested worker are NOT supported.")}};importScripts(e)};globalThis.addEventListener("message",i)}.toString();class bL extends EventTarget{constructor(e,i,n){super();this.onmessage=null;this.onmessageerror=null;this.onerror=null;const s=`((${wL})('${i}'))`;const r=new Blob([s],{type:"application/javascript"});const o=URL.createObjectURL(r);const a=new MessageChannel;const l=o;const c={type:"_newWorker",id:l,port:a.port2,url:o,options:n};e(c,[a.port2]);this.postMessage=a.port1.postMessage.bind(a.port1);this.terminate=()=>{const u={type:"_terminateWorker",id:l};e(u);URL.revokeObjectURL(o);a.port1.close();a.port2.close()};Object.defineProperties(this,{"onmessage":{get(){return a.port1.onmessage},set(u){a.port1.onmessage=u}},"onmessageerror":{get(){return a.port1.onmessageerror},set(u){a.port1.onmessageerror=u}}});a.port1.addEventListener("messageerror",u=>{const d=new MessageEvent("messageerror",{data:u.data});this.dispatchEvent(d)});a.port1.addEventListener("message",u=>{const d=new MessageEvent("message",{data:u.data});this.dispatchEvent(d)});a.port1.start()}}new T("inOutput",false);new T("activeLogOutput",false);new T("activeLogOutput.isLog",false);new T("activeLogOutput.levelSettable",false);new T("activeLogOutput.level","");new T("activeLogOutput.levelIsDefault",false);new T(`outputView.scrollLock`,false);new T("activeOutputChannel","");new T("output.filter.trace",true);new T("output.filter.debug",true);new T("output.filter.info",true);new T("output.filter.warning",true);new T("output.filter.error",true);new T("outputFilterFocus",false);new T("output.filter.categories","");var Nu;(function(t){t[t["Append"]=1]="Append";t[t["Replace"]=2]="Replace";t[t["Clear"]=3]="Clear"})(Nu||(Nu={}));const yL={OutputChannels:"workbench.contributions.outputChannels"};function xL(t){return Array.isArray(t.source)}class EL extends Ee{constructor(){super(...arguments);this.channels=new Map;this._onDidRegisterChannel=this._register(new L);this.onDidRegisterChannel=this._onDidRegisterChannel.event;this._onDidRemoveChannel=this._register(new L);this.onDidRemoveChannel=this._onDidRemoveChannel.event;this._onDidUpdateChannelFiles=this._register(new L);this.onDidUpdateChannelSources=this._onDidUpdateChannelFiles.event}registerChannel(e){if(!this.channels.has(e.id)){this.channels.set(e.id,e);this._onDidRegisterChannel.fire(e.id)}}getChannels(){const e=[];this.channels.forEach(i=>e.push(i));return e}getChannel(e){return this.channels.get(e)}updateChannelSources(e,i){const n=this.channels.get(e);if(n&&xL(n)){n.source=i;this._onDidUpdateChannelFiles.fire(n)}}removeChannel(e){const i=this.channels.get(e);if(i){this.channels.delete(e);this._onDidRemoveChannel.fire(i)}}}ci.add(yL.OutputChannels,new EL);class MC extends FC{constructor(e,i,n,s,r){super();this.id=e;this.name=i;this.logger=n;this.proxy=s;this.extension=r;this.offset=0;this.visible=false;this.setLevel(n.getLevel());this._register(n.onDidChangeLogLevel(o=>this.setLevel(o)));this._register(ge(()=>this.proxy.$dispose(this.id)))}get logLevel(){return this.getLevel()}appendLine(e){this.append(e+"\n")}append(e){this.info(e)}clear(){const e=this.offset;this.logger.flush();this.proxy.$update(this.id,Nu.Clear,e)}replace(e){const i=this.offset;this.info(e);this.proxy.$update(this.id,Nu.Replace,i);if(this.visible){this.logger.flush()}}show(e,i){this.logger.flush();this.proxy.$reveal(this.id,!!(typeof e==="boolean"?e:i))}hide(){this.proxy.$close(this.id)}log(e,i){this.offset+=ue.fromString(i).byteLength;hL(this.logger,e,i);if(this.visible){this.logger.flush();this.proxy.$update(this.id,Nu.Append)}}}class SL extends MC{appendLine(e){this.append(e)}}let fb=class T${constructor(e,i,n,s,r,o){this.initData=i;this.extHostFileSystem=n;this.extHostFileSystemInfo=s;this.loggerService=r;this.logService=o;this.extensionLogDirectoryPromise=new Map;this.namePool=1;this.channels=new Map;this.visibleChannelId=null;this.proxy=e.getProxy(Y.MainThreadOutputService);this.outputsLocation=this.extHostFileSystemInfo.extUri.joinPath(i.logsLocation,`output_logging_${V6(new Date).replace(/-|:|\.\d+Z$/g,"")}`)}$setVisibleChannel(e){this.visibleChannelId=e;for(const[i,n]of this.channels){n.visible=i===this.visibleChannelId}}createOutputChannel(e,i,n){e=e.trim();if(!e){throw new Error("illegal argument `name`. must not be falsy")}const s=typeof i==="object"&&i.log;const r=tt(i)?i:void 0;if(tt(r)&&!r.trim()){throw new Error("illegal argument `languageId`. must not be empty")}let o;const a=this.initData.environment.extensionLogLevel?.find(([u])=>Ze.equals(n.identifier,u))?.[1];if(a){o=mL(a)}const l=new Ie;const c=s?this.doCreateLogOutputChannel(e,o,n,l):this.doCreateOutputChannel(e,r,n,l);c.then(u=>{this.channels.set(u.id,u);u.visible=u.id===this.visibleChannelId;l.add(ge(()=>this.channels.delete(u.id)))});return s?this.createExtHostLogOutputChannel(e,o??this.logService.getLevel(),c,l):this.createExtHostOutputChannel(e,c,l)}async doCreateOutputChannel(e,i,n,s){if(!this.outputDirectoryPromise){this.outputDirectoryPromise=this.extHostFileSystem.value.createDirectory(this.outputsLocation).then(()=>this.outputsLocation)}const r=await this.outputDirectoryPromise;const o=this.extHostFileSystemInfo.extUri.joinPath(r,`${this.namePool++}-${e.replace(/[\\/:\*\?"<>\|]/g,"")}.log`);const a=s.add(this.loggerService.createLogger(o,{logLevel:"always",donotRotate:true,donotUseFormatters:true,hidden:true}));const l=await this.proxy.$register(e,o,i,n.identifier.value);s.add(ge(()=>this.loggerService.deregisterLogger(o)));return new MC(l,e,a,this.proxy,n)}async doCreateLogOutputChannel(e,i,n,s){const r=await this.createExtensionLogDirectory(n);const o=e.replace(/[\\/:\*\?"<>\|]/g,"");const a=this.extHostFileSystemInfo.extUri.joinPath(r,`${o}.log`);const l=`${n.identifier.value}.${o}`;const c=s.add(this.loggerService.createLogger(a,{id:l,name:e,logLevel:i,extensionId:n.identifier.value}));s.add(ge(()=>this.loggerService.deregisterLogger(a)));return new SL(l,e,c,this.proxy,n)}createExtensionLogDirectory(e){let i=this.extensionLogDirectoryPromise.get(e.identifier.value);if(!i){const n=this.extHostFileSystemInfo.extUri.joinPath(this.initData.logsLocation,e.identifier.value);this.extensionLogDirectoryPromise.set(e.identifier.value,i=(async()=>{try{await this.extHostFileSystem.value.createDirectory(n)}catch(s){if(Bf(s)!==Le.FileExists){throw s}}return n})())}return i}createExtHostOutputChannel(e,i,n){const s=()=>{if(n.isDisposed){throw new Error("Channel has been closed")}};i.then(r=>n.add(r));return{get name(){return e},append(r){s();i.then(o=>o.append(r))},appendLine(r){s();i.then(o=>o.appendLine(r))},clear(){s();i.then(r=>r.clear())},replace(r){s();i.then(o=>o.replace(r))},show(r,o){s();i.then(a=>a.show(r,o))},hide(){s();i.then(r=>r.hide())},dispose(){n.dispose()}}}createExtHostLogOutputChannel(e,i,n,s){const r=()=>{if(s.isDisposed){throw new Error("Channel has been closed")}};const o=s.add(new L);function a(l){i=l;o.fire(l)}n.then(l=>{if(l.logLevel!==i){a(l.logLevel)}s.add(l.onDidChangeLogLevel(c=>a(c)))});return{...this.createExtHostOutputChannel(e,n,s),get logLevel(){return i},onDidChangeLogLevel:o.event,trace(l,...c){r();n.then(u=>u.trace(l,...c))},debug(l,...c){r();n.then(u=>u.debug(l,...c))},info(l,...c){r();n.then(u=>u.info(l,...c))},warn(l,...c){r();n.then(u=>u.warn(l,...c))},error(l,...c){r();n.then(u=>u.error(l,...c))}}}};fb=z([O(0,st),O(1,Ai),O(2,Hm),O(3,Tc),O(4,Cc),O(5,at)],fb);const UC=xe("IExtHostOutputService");var uu;let pb=class P${static{uu=this}static{this._handlePool=0}static{this._maxEventSize=250}constructor(e,i){this._logService=i;this._provider=new Map;this._proxy=e.getProxy(Y.MainThreadDecorations)}registerFileDecorationProvider(e,i){const n=uu._handlePool++;this._provider.set(n,{provider:e,extensionDescription:i});this._proxy.$registerDecorationProvider(n,i.identifier.value);const s=e.onDidChangeFileDecorations&&e.onDidChangeFileDecorations(r=>{if(!r){this._proxy.$onDidChange(n,null);return}const o=Sn(r);if(o.length<=uu._maxEventSize){this._proxy.$onDidChange(n,o);return}this._logService.warn("[Decorations] CAPPING events from decorations provider",i.identifier.value,o.length);const a=o.map(u=>({uri:u,rank:JT(u.path,"/")}));const l=E5(a,(u,d)=>u.rank-d.rank||xa(u.uri.path,d.uri.path));const c=[];e:for(const u of l){let d;for(const p of u){const f=El(p.uri.path);if(d!==f){d=f;if(c.push(p.uri)>=uu._maxEventSize){break e}}}}this._proxy.$onDidChange(n,c)});return new qe(()=>{s?.dispose();this._proxy.$unregisterDecorationProvider(n);this._provider.delete(n)})}async $provideDecorations(e,i,n){if(!this._provider.has(e)){return Object.create(null)}const s=Object.create(null);const{provider:r,extensionDescription:o}=this._provider.get(e);await Promise.all(i.map(async a=>{try{const{uri:l,id:c}=a;const u=await Promise.resolve(r.provideFileDecoration(b.revive(l),n));if(!u){return}try{Iv.validate(u);if(u.badge&&typeof u.badge!=="string"){$(o,"codiconDecoration")}s[c]=[u.propagate,u.tooltip,u.badge,u.color]}catch(d){this._logService.warn(`INVALID decoration from extension '${o.identifier.value}': ${d}`)}}catch(l){this._logService.error(l)}}));return s}};pb=uu=z([O(0,st),O(1,at)],pb);const $C=xe("IExtHostDecorations");class DL{constructor(e){this.values=e;this.prefixSum=new Uint32Array(e.length);this.prefixSumValidIndex=new Int32Array(1);this.prefixSumValidIndex[0]=-1}getCount(){return this.values.length}insertValues(e,i){e=Ga(e);const n=this.values;const s=this.prefixSum;const r=i.length;if(r===0){return false}this.values=new Uint32Array(n.length+r);this.values.set(n.subarray(0,e),0);this.values.set(n.subarray(e),e+r);this.values.set(i,e);if(e-1<this.prefixSumValidIndex[0]){this.prefixSumValidIndex[0]=e-1}this.prefixSum=new Uint32Array(this.values.length);if(this.prefixSumValidIndex[0]>=0){this.prefixSum.set(s.subarray(0,this.prefixSumValidIndex[0]+1))}return true}setValue(e,i){e=Ga(e);i=Ga(i);if(this.values[e]===i){return false}this.values[e]=i;if(e-1<this.prefixSumValidIndex[0]){this.prefixSumValidIndex[0]=e-1}return true}removeValues(e,i){e=Ga(e);i=Ga(i);const n=this.values;const s=this.prefixSum;if(e>=n.length){return false}const r=n.length-e;if(i>=r){i=r}if(i===0){return false}this.values=new Uint32Array(n.length-i);this.values.set(n.subarray(0,e),0);this.values.set(n.subarray(e+i),e);this.prefixSum=new Uint32Array(this.values.length);if(e-1<this.prefixSumValidIndex[0]){this.prefixSumValidIndex[0]=e-1}if(this.prefixSumValidIndex[0]>=0){this.prefixSum.set(s.subarray(0,this.prefixSumValidIndex[0]+1))}return true}getTotalSum(){if(this.values.length===0){return 0}return this._getPrefixSum(this.values.length-1)}getPrefixSum(e){if(e<0){return 0}e=Ga(e);return this._getPrefixSum(e)}_getPrefixSum(e){if(e<=this.prefixSumValidIndex[0]){return this.prefixSum[e]}let i=this.prefixSumValidIndex[0]+1;if(i===0){this.prefixSum[0]=this.values[0];i++}if(e>=this.values.length){e=this.values.length-1}for(let n=i;n<=e;n++){this.prefixSum[n]=this.prefixSum[n-1]+this.values[n]}this.prefixSumValidIndex[0]=Math.max(this.prefixSumValidIndex[0],e);return this.prefixSum[e]}getIndexOf(e){e=Math.floor(e);this.getTotalSum();let i=0;let n=this.values.length-1;let s=0;let r=0;let o=0;while(i<=n){s=i+(n-i)/2|0;r=this.prefixSum[s];o=r-this.values[s];if(e<o){n=s-1}else if(e>=r){i=s+1}else{break}}return new kL(s,e-o)}}class kL{constructor(e,i){this.index=e;this.remainder=i;this._prefixSumIndexOfResultBrand=void 0;this.index=e;this.remainder=i}}class IL{constructor(e,i,n,s){this._uri=e;this._lines=i;this._eol=n;this._versionId=s;this._lineStarts=null;this._cachedTextValue=null}dispose(){this._lines.length=0}get version(){return this._versionId}getText(){if(this._cachedTextValue===null){this._cachedTextValue=this._lines.join(this._eol)}return this._cachedTextValue}onEvents(e){if(e.eol&&e.eol!==this._eol){this._eol=e.eol;this._lineStarts=null}const i=e.changes;for(const n of i){this._acceptDeleteRange(n.range);this._acceptInsertText(new En(n.range.startLineNumber,n.range.startColumn),n.text)}this._versionId=e.versionId;this._cachedTextValue=null}_ensureLineStarts(){if(!this._lineStarts){const e=this._eol.length;const i=this._lines.length;const n=new Uint32Array(i);for(let s=0;s<i;s++){n[s]=this._lines[s].length+e}this._lineStarts=new DL(n)}}_setLineText(e,i){this._lines[e]=i;if(this._lineStarts){this._lineStarts.setValue(e,this._lines[e].length+this._eol.length)}}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn){return}this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.startLineNumber-1].substring(e.endColumn-1));return}this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.endLineNumber-1].substring(e.endColumn-1));this._lines.splice(e.startLineNumber,e.endLineNumber-e.startLineNumber);if(this._lineStarts){this._lineStarts.removeValues(e.startLineNumber,e.endLineNumber-e.startLineNumber)}}_acceptInsertText(e,i){if(i.length===0){return}const n=uI(i);if(n.length===1){this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+n[0]+this._lines[e.lineNumber-1].substring(e.column-1));return}n[n.length-1]+=this._lines[e.lineNumber-1].substring(e.column-1);this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+n[0]);const s=new Uint32Array(n.length-1);for(let r=1;r<n.length;r++){this._lines.splice(e.lineNumber+r-1,0,n[r]);s[r-1]=n[r].length+this._eol.length}if(this._lineStarts){this._lineStarts.insertValues(e.lineNumber,s)}}}const gb=new Map;function CL(t,e){if(!e){gb.delete(t)}else{gb.set(t,e)}}function TL(t){return gb.get(t)}class PL extends IL{constructor(e,i,n,s,r,o,a,l){super(i,n,s,r);this._proxy=e;this._languageId=o;this._isDirty=a;this._encoding=l;this._isDisposed=false}dispose(){Hi(!this._isDisposed);this._isDisposed=true;this._isDirty=false}equalLines(e){return Is(this._lines,e)}get document(){if(!this._document){const e=this;this._document={get uri(){return e._uri},get fileName(){return e._uri.fsPath},get isUntitled(){return e._uri.scheme===ae.untitled},get languageId(){return e._languageId},get version(){return e._versionId},get isClosed(){return e._isDisposed},get isDirty(){return e._isDirty},get encoding(){return e._encoding},save(){return e._save()},getText(i){return i?e._getTextInRange(i):e.getText()},get eol(){return e._eol==="\n"?ss.LF:ss.CRLF},get lineCount(){return e._lines.length},lineAt(i){return e._lineAt(i)},offsetAt(i){return e._offsetAt(i)},positionAt(i){return e._positionAt(i)},validateRange(i){return e._validateRange(i)},validatePosition(i){return e._validatePosition(i)},getWordRangeAtPosition(i,n){return e._getWordRangeAtPosition(i,n)},[Symbol.for("debug.description")](){return`TextDocument(${e._uri.toString()})`}}}return Object.freeze(this._document)}_acceptLanguageId(e){Hi(!this._isDisposed);this._languageId=e}_acceptIsDirty(e){Hi(!this._isDisposed);this._isDirty=e}_acceptEncoding(e){Hi(!this._isDisposed);this._encoding=e}_save(){if(this._isDisposed){return Promise.reject(new Error("Document has been closed"))}return this._proxy.$trySaveDocument(this._uri)}_getTextInRange(e){const i=this._validateRange(e);if(i.isEmpty){return""}if(i.isSingleLine){return this._lines[i.start.line].substring(i.start.character,i.end.character)}const n=this._eol,s=i.start.line,r=i.end.line,o=[];o.push(this._lines[s].substring(i.start.character));for(let a=s+1;a<r;a++){o.push(this._lines[a])}o.push(this._lines[r].substring(0,i.end.character));return o.join(n)}_lineAt(e){let i;if(e instanceof Ve){i=e.line}else if(typeof e==="number"){i=e}if(typeof i!=="number"||i<0||i>=this._lines.length||Math.floor(i)!==i){throw new Error("Illegal value for `line`")}return new AL(i,this._lines[i],i===this._lines.length-1)}_offsetAt(e){e=this._validatePosition(e);this._ensureLineStarts();return this._lineStarts.getPrefixSum(e.line-1)+e.character}_positionAt(e){e=Math.floor(e);e=Math.max(0,e);this._ensureLineStarts();const i=this._lineStarts.getIndexOf(e);const n=this._lines[i.index].length;return new Ve(i.index,Math.min(i.remainder,n))}_validateRange(e){if(!(e instanceof Oe)){throw new Error("Invalid argument")}const i=this._validatePosition(e.start);const n=this._validatePosition(e.end);if(i===e.start&&n===e.end){return e}return new Oe(i.line,i.character,n.line,n.character)}_validatePosition(e){if(!(e instanceof Ve)){throw new Error("Invalid argument")}if(this._lines.length===0){return e.with(0,0)}let{line:i,character:n}=e;let s=false;if(i<0){i=0;n=0;s=true}else if(i>=this._lines.length){i=this._lines.length-1;n=this._lines[i].length;s=true}else{const r=this._lines[i].length;if(n<0){n=0;s=true}else if(n>r){n=r;s=true}}if(!s){return e}return new Ve(i,n)}_getWordRangeAtPosition(e,i){const n=this._validatePosition(e);if(!i){i=TL(this._languageId)}else if(cI(i)){throw new Error(`[getWordRangeAtPosition]: ignoring custom regexp '${i.source}' because it matches the empty string.`)}const s=e4(n.character+1,YI(i),this._lines[n.line],0);if(s){return new Oe(n.line,s.startColumn-1,n.line,s.endColumn-1)}return void 0}}class AL{constructor(e,i,n){this._line=e;this._text=i;this._isLastLine=n}get lineNumber(){return this._line}get text(){return this._text}get range(){return new Oe(this._line,0,this._line,this._text.length)}get rangeIncludingLineBreak(){if(this._isLastLine){return this.range}return new Oe(this._line,0,this._line+1,0)}get firstNonWhitespaceCharacterIndex(){return/^(\s*)/.exec(this._text)[1].length}get isEmptyOrWhitespace(){return this.firstNonWhitespaceCharacterIndex===this._text.length}}class Ey{constructor(e){this._prefix=e;this._lastId=0}nextId(){return this._prefix+ ++this._lastId}}class Sy{static{this._Keys=new Ey("TextEditorDecorationType")}constructor(e,i,n){const s=Sy._Keys.nextId();e.$registerTextEditorDecorationType(i.identifier,s,sw.from(n));this.value=Object.freeze({key:s,dispose(){e.$removeTextEditorDecorationType(s)}})}}class RL{constructor(e,i){this._collectedEdits=[];this._setEndOfLine=void 0;this._finalized=false;this._document=e;this._documentVersionId=e.version;this._undoStopBefore=i.undoStopBefore;this._undoStopAfter=i.undoStopAfter}finalize(){this._finalized=true;return{documentVersionId:this._documentVersionId,edits:this._collectedEdits,setEndOfLine:this._setEndOfLine,undoStopBefore:this._undoStopBefore,undoStopAfter:this._undoStopAfter}}_throwIfFinalized(){if(this._finalized){throw new Error("Edit is only valid while callback runs")}}replace(e,i){this._throwIfFinalized();let n=null;if(e instanceof Ve){n=new Oe(e,e)}else if(e instanceof Oe){n=e}else{throw new Error("Unrecognized location")}this._pushEdit(n,i,false)}insert(e,i){this._throwIfFinalized();this._pushEdit(new Oe(e,e),i,true)}delete(e){this._throwIfFinalized();let i=null;if(e instanceof Oe){i=e}else{throw new Error("Unrecognized location")}this._pushEdit(i,null,true)}_pushEdit(e,i,n){const s=this._document.validateRange(e);this._collectedEdits.push({range:s,text:i,forceMoveMarkers:n})}setEndOfLine(e){this._throwIfFinalized();if(e!==ss.LF&&e!==ss.CRLF){throw $e("endOfLine")}this._setEndOfLine=e}}class LL{constructor(e,i,n,s){this._proxy=e;this._id=i;this._accept(n);this._logService=s;const r=this;this.value={get tabSize(){return r._tabSize},set tabSize(o){r._setTabSize(o)},get indentSize(){return r._indentSize},set indentSize(o){r._setIndentSize(o)},get insertSpaces(){return r._insertSpaces},set insertSpaces(o){r._setInsertSpaces(o)},get cursorStyle(){return r._cursorStyle},set cursorStyle(o){r._setCursorStyle(o)},get lineNumbers(){return r._lineNumbers},set lineNumbers(o){r._setLineNumbers(o)}}}_accept(e){this._tabSize=e.tabSize;this._indentSize=e.indentSize;this._originalIndentSize=e.originalIndentSize;this._insertSpaces=e.insertSpaces;this._cursorStyle=e.cursorStyle;this._lineNumbers=Ul.to(e.lineNumbers)}_validateTabSize(e){if(e==="auto"){return"auto"}if(typeof e==="number"){const i=Math.floor(e);return i>0?i:null}if(typeof e==="string"){const i=parseInt(e,10);if(isNaN(i)){return null}return i>0?i:null}return null}_setTabSize(e){const i=this._validateTabSize(e);if(i===null){return}if(typeof i==="number"){if(this._tabSize===i){return}this._tabSize=i}this._warnOnError("setTabSize",this._proxy.$trySetOptions(this._id,{tabSize:i}))}_validateIndentSize(e){if(e==="tabSize"){return"tabSize"}if(typeof e==="number"){const i=Math.floor(e);return i>0?i:null}if(typeof e==="string"){const i=parseInt(e,10);if(isNaN(i)){return null}return i>0?i:null}return null}_setIndentSize(e){const i=this._validateIndentSize(e);if(i===null){return}if(typeof i==="number"){if(this._originalIndentSize===i){return}this._indentSize=i;this._originalIndentSize=i}this._warnOnError("setIndentSize",this._proxy.$trySetOptions(this._id,{indentSize:i}))}_validateInsertSpaces(e){if(e==="auto"){return"auto"}return e==="false"?false:Boolean(e)}_setInsertSpaces(e){const i=this._validateInsertSpaces(e);if(typeof i==="boolean"){if(this._insertSpaces===i){return}this._insertSpaces=i}this._warnOnError("setInsertSpaces",this._proxy.$trySetOptions(this._id,{insertSpaces:i}))}_setCursorStyle(e){if(this._cursorStyle===e){return}this._cursorStyle=e;this._warnOnError("setCursorStyle",this._proxy.$trySetOptions(this._id,{cursorStyle:e}))}_setLineNumbers(e){if(this._lineNumbers===e){return}this._lineNumbers=e;this._warnOnError("setLineNumbers",this._proxy.$trySetOptions(this._id,{lineNumbers:Ul.from(e)}))}assign(e){const i={};let n=false;if(typeof e.tabSize!=="undefined"){const s=this._validateTabSize(e.tabSize);if(s==="auto"){n=true;i.tabSize=s}else if(typeof s==="number"&&this._tabSize!==s){this._tabSize=s;n=true;i.tabSize=s}}if(typeof e.indentSize!=="undefined"){const s=this._validateIndentSize(e.indentSize);if(s==="tabSize"){n=true;i.indentSize=s}else if(typeof s==="number"&&this._originalIndentSize!==s){this._indentSize=s;this._originalIndentSize=s;n=true;i.indentSize=s}}if(typeof e.insertSpaces!=="undefined"){const s=this._validateInsertSpaces(e.insertSpaces);if(s==="auto"){n=true;i.insertSpaces=s}else if(this._insertSpaces!==s){this._insertSpaces=s;n=true;i.insertSpaces=s}}if(typeof e.cursorStyle!=="undefined"){if(this._cursorStyle!==e.cursorStyle){this._cursorStyle=e.cursorStyle;n=true;i.cursorStyle=e.cursorStyle}}if(typeof e.lineNumbers!=="undefined"){if(this._lineNumbers!==e.lineNumbers){this._lineNumbers=e.lineNumbers;n=true;i.lineNumbers=Ul.from(e.lineNumbers)}}if(n){this._warnOnError("setOptions",this._proxy.$trySetOptions(this._id,i))}}_warnOnError(e,i){i.catch(n=>{this._logService.warn(`ExtHostTextEditorOptions '${e}' failed:'`);this._logService.warn(n)})}}class NL{constructor(e,i,n,s,r,o,a,l){this.id=e;this._proxy=i;this._logService=n;this._disposed=false;this._hasDecorationsForKey=new Set;this._selections=r;this._options=new LL(this._proxy,this.id,o,n);this._visibleRanges=a;this._viewColumn=l;const c=this;this.value=Object.freeze({get document(){return s.value},set document(u){throw new Vo("document")},get selection(){return c._selections&&c._selections[0]},set selection(u){if(!(u instanceof Dr)){throw $e("selection")}c._selections=[u];c._trySetSelection()},get selections(){return c._selections},set selections(u){if(!Array.isArray(u)||u.some(d=>!(d instanceof Dr))){throw $e("selections")}c._selections=u;c._trySetSelection()},get visibleRanges(){return c._visibleRanges},set visibleRanges(u){throw new Vo("visibleRanges")},get diffInformation(){return c._diffInformation},get options(){return c._options.value},set options(u){if(!c._disposed){c._options.assign(u)}},get viewColumn(){return c._viewColumn},set viewColumn(u){throw new Vo("viewColumn")},edit(u,d={undoStopBefore:true,undoStopAfter:true}){if(c._disposed){return Promise.reject(new Error("TextEditor#edit not possible on closed editors"))}const p=new RL(s.value,d);u(p);return c._applyEdit(p)},insertSnippet(u,d,p={undoStopBefore:true,undoStopAfter:true}){if(c._disposed){return Promise.reject(new Error("TextEditor#insertSnippet not possible on closed editors"))}let f;if(!d||Array.isArray(d)&&d.length===0){f=c._selections.map(m=>W.from(m))}else if(d instanceof Ve){const{lineNumber:m,column:v}=rt.from(d);f=[{startLineNumber:m,startColumn:v,endLineNumber:m,endColumn:v}]}else if(d instanceof Oe){f=[W.from(d)]}else{f=[];for(const m of d){if(m instanceof Oe){f.push(W.from(m))}else{const{lineNumber:v,column:y}=rt.from(m);f.push({startLineNumber:v,startColumn:y,endLineNumber:v,endColumn:y})}}}if(p.keepWhitespace===void 0){p.keepWhitespace=false}return i.$tryInsertSnippet(e,s.value.version,u.value,f,p)},setDecorations(u,d){const p=d.length===0;if(p&&!c._hasDecorationsForKey.has(u.key)){return}if(p){c._hasDecorationsForKey.delete(u.key)}else{c._hasDecorationsForKey.add(u.key)}c._runOnProxy(()=>{if(dC(d)){return i.$trySetDecorations(e,u.key,R3(d))}else{const f=new Array(4*d.length);for(let m=0,v=d.length;m<v;m++){const y=d[m];f[4*m]=y.start.line+1;f[4*m+1]=y.start.character+1;f[4*m+2]=y.end.line+1;f[4*m+3]=y.end.character+1}return i.$trySetDecorationsFast(e,u.key,f)}})},revealRange(u,d){c._runOnProxy(()=>i.$tryRevealRange(e,W.from(u),d||Hp.Default))},show(u){i.$tryShowEditor(e,ai.from(u))},hide(){i.$tryHideEditor(e)},[Symbol.for("debug.description")](){return`TextEditor(${this.document.uri.toString()})`}})}dispose(){Hi(!this._disposed);this._disposed=true}_acceptOptions(e){Hi(!this._disposed);this._options._accept(e)}_acceptVisibleRanges(e){Hi(!this._disposed);this._visibleRanges=e}_acceptViewColumn(e){Hi(!this._disposed);this._viewColumn=e}_acceptSelections(e){Hi(!this._disposed);this._selections=e}_acceptDiffInformation(e){Hi(!this._disposed);this._diffInformation=e}async _trySetSelection(){const e=this._selections.map(ls.from);await this._runOnProxy(()=>this._proxy.$trySetSelections(this.id,e));return this.value}_applyEdit(e){const i=e.finalize();if(i.edits.length===0&&!i.setEndOfLine){return Promise.resolve(true)}const n=i.edits.map(r=>r.range);n.sort((r,o)=>{if(r.end.line===o.end.line){if(r.end.character===o.end.character){if(r.start.line===o.start.line){return r.start.character-o.start.character}return r.start.line-o.start.line}return r.end.character-o.end.character}return r.end.line-o.end.line});for(let r=0,o=n.length-1;r<o;r++){const a=n[r].end;const l=n[r+1].start;if(l.isBefore(a)){return Promise.reject(new Error("Overlapping ranges are not allowed!"))}}const s=i.edits.map(r=>{return{range:W.from(r.range),text:r.text,forceMoveMarkers:r.forceMoveMarkers}});return this._proxy.$tryApplyEdits(this.id,i.documentVersionId,s,{setEndOfLine:typeof i.setEndOfLine==="number"?gc.from(i.setEndOfLine):void 0,undoStopBefore:i.undoStopBefore,undoStopAfter:i.undoStopAfter})}_runOnProxy(e){if(this._disposed){this._logService.warn("TextEditor is closed/disposed");return Promise.resolve(void 0)}return e().then(()=>this,i=>{if(!(i instanceof Error&&i.name==="DISPOSED")){this._logService.warn(i)}return null})}}class OL{constructor(e){this.value=e;this._count=0}ref(){this._count++}unref(){return--this._count===0}}let mb=class A${constructor(e,i){this._extHostRpc=e;this._logService=i;this._activeEditorId=null;this._editors=new Map;this._documents=new Ft;this._onDidAddDocuments=new L;this._onDidRemoveDocuments=new L;this._onDidChangeVisibleTextEditors=new L;this._onDidChangeActiveTextEditor=new L;this.onDidAddDocuments=this._onDidAddDocuments.event;this.onDidRemoveDocuments=this._onDidRemoveDocuments.event;this.onDidChangeVisibleTextEditors=this._onDidChangeVisibleTextEditors.event;this.onDidChangeActiveTextEditor=this._onDidChangeActiveTextEditor.event}$acceptDocumentsAndEditorsDelta(e){this.acceptDocumentsAndEditorsDelta(e)}acceptDocumentsAndEditorsDelta(e){const i=[];const n=[];const s=[];if(e.removedDocuments){for(const r of e.removedDocuments){const o=b.revive(r);const a=this._documents.get(o);if(a?.unref()){this._documents.delete(o);i.push(a.value)}}}if(e.addedDocuments){for(const r of e.addedDocuments){const o=b.revive(r.uri);let a=this._documents.get(o);if(a){if(o.scheme!==ae.vscodeNotebookCell&&o.scheme!==ae.vscodeInteractiveInput){throw new Error(`document '${o} already exists!'`)}}if(!a){a=new OL(new PL(this._extHostRpc.getProxy(Y.MainThreadDocuments),o,r.lines,r.EOL,r.versionId,r.languageId,r.isDirty,r.encoding));this._documents.set(o,a);n.push(a.value)}a.ref()}}if(e.removedEditors){for(const r of e.removedEditors){const o=this._editors.get(r);this._editors.delete(r);if(o){s.push(o)}}}if(e.addedEditors){for(const r of e.addedEditors){const o=b.revive(r.documentUri);Hi(this._documents.has(o),`document '${o}' does not exist`);Hi(!this._editors.has(r.id),`editor '${r.id}' already exists!`);const a=this._documents.get(o).value;const l=new NL(r.id,this._extHostRpc.getProxy(Y.MainThreadTextEditors),this._logService,new Fn(()=>a.document),r.selections.map(ls.to),r.options,r.visibleRanges.map(c=>W.to(c)),typeof r.editorPosition==="number"?ai.to(r.editorPosition):void 0);this._editors.set(r.id,l)}}if(e.newActiveEditor!==void 0){Hi(e.newActiveEditor===null||this._editors.has(e.newActiveEditor),`active editor '${e.newActiveEditor}' does not exist`);this._activeEditorId=e.newActiveEditor}yr(i);yr(s);if(e.removedDocuments){this._onDidRemoveDocuments.fire(i)}if(e.addedDocuments){this._onDidAddDocuments.fire(n)}if(e.removedEditors||e.addedEditors){this._onDidChangeVisibleTextEditors.fire(this.allEditors().map(r=>r.value))}if(e.newActiveEditor!==void 0){this._onDidChangeActiveTextEditor.fire(this.activeEditor())}}getDocument(e){return this._documents.get(e)?.value}allDocuments(){return _i.map(this._documents.values(),e=>e.value)}getEditor(e){return this._editors.get(e)}activeEditor(e){if(!this._activeEditorId){return void 0}const i=this._editors.get(this._activeEditorId);if(e){return i}else{return i?.value}}allEditors(){return[...this._editors.values()]}};mb=z([O(0,st),O(1,at)],mb);const Oc=xe("IExtHostDocumentsAndEditors");const zm=xe("IExtHostApiDeprecationService");let _b=class R${constructor(e,i){this._extHostLogService=i;this._reportedUsages=new Set;this._telemetryShape=e.getProxy(Y.MainThreadTelemetry)}report(e,i,n){const s=this.getUsageKey(e,i);if(this._reportedUsages.has(s)){return}this._reportedUsages.add(s);if(i.isUnderDevelopment){this._extHostLogService.warn(`[Deprecation Warning] '${e}' is deprecated. ${n}`)}this._telemetryShape.$publicLog2("extHostDeprecatedApiUsage",{extensionId:i.identifier.value,apiId:e})}getUsageKey(e,i){return`${e}-${i.identifier.value}`}};_b=z([O(0,st),O(1,at)],_b);const FL={type:"object",additionalProperties:false,properties:{type:{type:"string",description:h(10055,"The actual task type. Please note that types starting with a '$' are reserved for internal usage.")},required:{type:"array",items:{type:"string"}},properties:{type:"object",description:h(10056,"Additional properties of the task type"),additionalProperties:{$ref:"http://json-schema.org/draft-07/schema#"}},when:{type:"string",markdownDescription:h(10057,"Condition which must be true to enable this type of task. Consider using `shellExecutionSupported`, `processExecutionSupported`, and `customExecutionSupported` as appropriate for this task definition. See the [API documentation](https://code.visualstudio.com/api/extension-guides/task-provider#when-clause) for more information."),default:""}}};var vb;(function(t){function e(i,n,s){if(!i){return void 0}const r=tt(i.type)?i.type:void 0;if(!r||r.length===0){s.error(h(10058,"The task type configuration is missing the required 'taskType' property"));return void 0}const o=[];if(Array.isArray(i.required)){for(const a of i.required){if(tt(a)){o.push(a)}}}return{extensionId:n.value,taskType:r,required:o,properties:i.properties?vt(i.properties):{},when:i.when?Kt.deserialize(i.when):void 0}}t.from=e})(vb||(vb={}));const ML=A4.registerExtensionPoint({extensionPoint:"taskDefinitions",activationEventsGenerator:(t,e)=>{for(const i of t){if(i.type){e.push(`onTaskType:${i.type}`)}}},jsonSchema:{description:h(10059,"Contributes task kinds"),type:"array",items:FL}});class UL{constructor(){this._onDefinitionsChanged=new L;this.onDefinitionsChanged=this._onDefinitionsChanged.event;this.taskTypes=Object.create(null);this.readyPromise=new Promise((e,i)=>{ML.setHandler((n,s)=>{this._schema=void 0;try{for(const r of s.removed){const o=r.value;for(const a of o){if(this.taskTypes&&a.type&&this.taskTypes[a.type]){delete this.taskTypes[a.type]}}}for(const r of s.added){const o=r.value;for(const a of o){const l=vb.from(a,r.description.identifier,r.collector);if(l){this.taskTypes[l.taskType]=l}}}if(s.removed.length>0||s.added.length>0){this._onDefinitionsChanged.fire()}}catch(r){}e(void 0)})})}onReady(){return this.readyPromise}get(e){return this.taskTypes[e]}all(){return Object.keys(this.taskTypes).map(e=>this.taskTypes[e])}getJsonSchema(){if(this._schema===void 0){const e=[];for(const i of this.all()){const n={type:"object",additionalProperties:false};if(i.required.length>0){n.required=i.required.slice(0)}if(i.properties!==void 0){n.properties=vt(i.properties)}else{n.properties=Object.create(null)}n.properties.type={type:"string",enum:[i.taskType]};e.push(n)}this._schema={oneOf:e}}return this._schema}}const $L=new UL;const HL="settings";new T("taskRunning",false,h(10069,"Whether a task is currently running."));new T("taskTerminalActive",false,h(10070,"Whether the active terminal is a task terminal."));gm(10071,"Tasks");var Zg;(function(t){t[t["Escape"]=1]="Escape";t[t["Strong"]=2]="Strong";t[t["Weak"]=3]="Weak"})(Zg||(Zg={}));(function(t){function e(i){if(!i){return t.Strong}switch(i.toLowerCase()){case"escape":return t.Escape;case"strong":return t.Strong;case"weak":return t.Weak;default:return t.Strong}}t.from=e})(Zg||(Zg={}));var cD;(function(t){t.defaults={cwd:"${workspaceFolder}"}})(cD||(cD={}));var Yd;(function(t){t[t["Always"]=1]="Always";t[t["Silent"]=2]="Silent";t[t["Never"]=3]="Never"})(Yd||(Yd={}));(function(t){function e(i){switch(i.toLowerCase()){case"always":return t.Always;case"silent":return t.Silent;case"never":return t.Never;default:return t.Always}}t.fromString=e})(Yd||(Yd={}));var Zd;(function(t){t[t["Never"]=1]="Never";t[t["OnProblem"]=2]="OnProblem";t[t["Always"]=3]="Always"})(Zd||(Zd={}));(function(t){function e(i){switch(i.toLowerCase()){case"always":return t.Always;case"never":return t.Never;case"onproblem":return t.OnProblem;default:return t.OnProblem}}t.fromString=e})(Zd||(Zd={}));var eh;(function(t){t[t["Shared"]=1]="Shared";t[t["Dedicated"]=2]="Dedicated";t[t["New"]=3]="New"})(eh||(eh={}));(function(t){function e(i){switch(i.toLowerCase()){case"shared":return t.Shared;case"dedicated":return t.Dedicated;case"new":return t.New;default:return t.Shared}}t.fromString=e})(eh||(eh={}));var uD;(function(t){t.defaults={echo:true,reveal:Yd.Always,revealProblems:Zd.Never,focus:false,panel:eh.Shared,showReuseMessage:true,clear:false}})(uD||(uD={}));var em;(function(t){t[t["Shell"]=1]="Shell";t[t["Process"]=2]="Process";t[t["CustomExecution"]=3]="CustomExecution"})(em||(em={}));(function(t){function e(n){switch(n.toLowerCase()){case"shell":return t.Shell;case"process":return t.Process;case"customExecution":return t.CustomExecution;default:return t.Process}}t.fromString=e;function i(n){switch(n){case t.Shell:return"shell";case t.Process:return"process";case t.CustomExecution:return"customExecution";default:return"process"}}t.toString=i})(em||(em={}));var dD;(function(t){function e(i){if(tt(i)){return i}else{return i.value}}t.value=e})(dD||(dD={}));var hD;(function(t){t.Clean={_id:"clean",isDefault:false};t.Build={_id:"build",isDefault:false};t.Rebuild={_id:"rebuild",isDefault:false};t.Test={_id:"test",isDefault:false};function e(n){return n===t.Clean._id||n===t.Build._id||n===t.Rebuild._id||n===t.Test._id}t.is=e;function i(n){if(n===void 0){return void 0}else if(tt(n)){if(e(n)){return{_id:n,isDefault:false}}return void 0}else{return n}}t.from=i})(hD||(hD={}));var fD;(function(t){t[t["Global"]=1]="Global";t[t["Workspace"]=2]="Workspace";t[t["Folder"]=3]="Folder"})(fD||(fD={}));var pD;(function(t){t.Workspace="workspace";t.Extension="extension";t.InMemory="inMemory";t.WorkspaceFile="workspaceFile";t.User="user";function e(i){switch(i){case t.User:return di.USER;case t.WorkspaceFile:return di.WORKSPACE;default:return di.WORKSPACE_FOLDER}}t.toConfigurationTarget=e})(pD||(pD={}));var gD;(function(t){t["parallel"]="parallel";t["sequence"]="sequence"})(gD||(gD={}));var wb;(function(t){t[t["default"]=1]="default";t[t["folderOpen"]=2]="folderOpen"})(wb||(wb={}));var mD;(function(t){t.defaults={reevaluateOnRerun:true,runOn:wb.default,instanceLimit:1}})(mD||(mD={}));var tm;(function(t){t[t["Process"]=1]="Process";t[t["Terminal"]=2]="Terminal"})(tm||(tm={}));(function(t){t._default=t.Terminal})(tm||(tm={}));var _D;(function(t){t[t["V0_1_0"]=1]="V0_1_0";t[t["V2_0_0"]=2]="V2_0_0"})(_D||(_D={}));var im;(function(t){t["SingleRun"]="singleRun";t["Background"]="background"})(im||(im={}));var Uo;(function(t){t["Changed"]="changed";t["ProcessStarted"]="processStarted";t["ProcessEnded"]="processEnded";t["Terminated"]="terminated";t["Start"]="start";t["AcquiredInput"]="acquiredInput";t["DependsOnStarted"]="dependsOnStarted";t["Active"]="active";t["Inactive"]="inactive";t["End"]="end";t["ProblemMatcherStarted"]="problemMatcherStarted";t["ProblemMatcherEnded"]="problemMatcherEnded";t["ProblemMatcherFoundErrors"]="problemMatcherFoundErrors"})(Uo||(Uo={}));var vD;(function(t){t[t["System"]=0]="System";t[t["User"]=1]="User";t[t["FolderOpen"]=2]="FolderOpen";t[t["ConfigurationChange"]=3]="ConfigurationChange";t[t["Reconnect"]=4]="Reconnect"})(vD||(vD={}));var wD;(function(t){function e(l){return{taskId:l._id,taskName:l.configurationProperties.name,runType:l.configurationProperties.isBackground?im.Background:im.SingleRun,group:l.configurationProperties.group,__task:l}}function i(l,c,u){return{...e(l),kind:Uo.Start,terminalId:c,resolvedVariables:u}}t.start=i;function n(l,c,u){return{...e(l),kind:Uo.ProcessStarted,terminalId:c,processId:u}}t.processStarted=n;function s(l,c,u){return{...e(l),kind:Uo.ProcessEnded,terminalId:c,exitCode:u}}t.processEnded=s;function r(l,c,u){return{...e(l),kind:Uo.Terminated,exitReason:u,terminalId:c}}t.terminated=r;function o(l,c,u){return{...e(c),kind:l,terminalId:u}}t.general=o;function a(){return{kind:Uo.Changed}}t.changed=a})(wD||(wD={}));var nm;(function(t){function e(n){const s=Object.keys(n).sort();let r="";for(const o of s){let a=n[o];if(a instanceof Object){a=e(a)}else if(typeof a==="string"){a=a.replace(/,/g,",,")}r+=o+","+a+","}return r}function i(n){const s=e(n);const r={_key:s,type:n.taskType};Object.assign(r,n);return r}t.create=i})(nm||(nm={}));var bD;(function(t){t["AutoDetect"]="task.autoDetect";t["SaveBeforeRun"]="task.saveBeforeRun";t["ShowDecorations"]="task.showDecorations";t["ProblemMatchersNeverPrompt"]="task.problemMatchers.neverPrompt";t["SlowProviderWarning"]="task.slowProviderWarning";t["QuickOpenHistory"]="task.quickOpen.history";t["QuickOpenDetail"]="task.quickOpen.detail";t["QuickOpenSkip"]="task.quickOpen.skip";t["QuickOpenShowAll"]="task.quickOpen.showAll";t["AllowAutomaticTasks"]="task.allowAutomaticTasks";t["Reconnection"]="task.reconnection";t["VerboseLogging"]="task.verboseLogging"})(bD||(bD={}));var yD;(function(t){t["Tasks"]="tasks";t["SuppressTaskName"]="tasks.suppressTaskName";t["Windows"]="tasks.windows";t["Osx"]="tasks.osx";t["Linux"]="tasks.linux";t["ShowOutput"]="tasks.showOutput";t["IsShellCommand"]="tasks.isShellCommand";t["ServiceTestSetting"]="tasks.service.testSetting"})(yD||(yD={}));var xD;(function(t){function e(i,n){const s=$L.get(i.type);if(s===void 0){const l=vt(i);delete l._key;return nm.create(l)}const r=Object.create(null);r.type=s.taskType;const o=new Set;s.required.forEach(l=>o.add(l));const a=s.properties;for(const l of Object.keys(a)){const c=i[l];if(c!==void 0&&c!==null){r[l]=c}else if(o.has(l)){const u=a[l];if(u.default!==void 0){r[l]=vt(u.default)}else{switch(u.type){case"boolean":r[l]=false;break;case"number":case"integer":r[l]=0;break;case"string":r[l]="";break;default:n.error(h(10072,"Error: the task identifier '{0}' is missing the required property '{1}'. The task identifier will be ignored.",JSON.stringify(i,void 0,0),l));return void 0}}}}return nm.create(r)}t.createTaskIdentifier=e})(xD||(xD={}));var sm;(function(t){function e(n){if(n===void 0||n===null){return void 0}return n}t.from=e;function i(n){if(n===void 0||n===null){return void 0}return n}t.to=i})(sm||(sm={}));var rm;(function(t){function e(n){if(n===void 0||n===null){return void 0}return n}t.from=e;function i(n){if(n===void 0||n===null){return void 0}return n}t.to=i})(rm||(rm={}));var bb;(function(t){function e(n){if(n===void 0||n===null){return void 0}return n}t.from=e;function i(n){if(n===void 0||n===null){return void 0}return n}t.to=i})(bb||(bb={}));var Ou;(function(t){function e(s){if(s){const r=s;return r&&!!r.process}else{return false}}t.is=e;function i(s){if(s===void 0||s===null){return void 0}const r={process:s.process,args:s.args};if(s.options){r.options=bb.from(s.options)}return r}t.from=i;function n(s){if(s===void 0||s===null){return void 0}return new sc(s.process,s.args,s.options)}t.to=n})(Ou||(Ou={}));var yb;(function(t){function e(n){if(n===void 0||n===null){return void 0}return n}t.from=e;function i(n){if(n===void 0||n===null){return void 0}return n}t.to=i})(yb||(yb={}));var Fu;(function(t){function e(s){if(s){const r=s;return r&&(!!r.commandLine||!!r.command)}else{return false}}t.is=e;function i(s){if(s===void 0||s===null){return void 0}const r={};if(s.commandLine!==void 0){r.commandLine=s.commandLine}else{r.command=s.command;r.args=s.args}if(s.options){r.options=yb.from(s.options)}return r}t.from=i;function n(s){if(s===void 0||s===null||s.command===void 0&&s.commandLine===void 0){return void 0}if(s.commandLine){return new Ia(s.commandLine,s.options)}else{return new Ia(s.command,s.args?s.args:[],s.options)}}t.to=n})(Fu||(Fu={}));var br;(function(t){function e(s){if(s){const r=s;return r&&r.customExecution==="customExecution"}else{return false}}t.is=e;function i(s){return{customExecution:"customExecution"}}t.from=i;function n(s,r){return r.get(s)}t.to=n})(br||(br={}));var ED;(function(t){function e(i,n){let s;if(i.scope!==void 0&&typeof i.scope!=="number"){s=i.scope.uri}else if(i.scope!==void 0&&typeof i.scope==="number"){if(i.scope===mo.Workspace&&n&&n.workspaceFile){s=n.workspaceFile}else{s=HL}}return{id:i._id,workspaceFolder:s}}t.from=e})(ED||(ED={}));var xb;(function(t){function e(i){if(i===void 0||i===null){return void 0}return{_id:i.id,isDefault:i.isDefault}}t.from=e})(xb||(xb={}));var oo;(function(t){function e(s,r){if(s===void 0||s===null){return[]}const o=[];for(const a of s){const l=i(a,r);if(l){o.push(l)}}return o}t.fromMany=e;function i(s,r){if(s===void 0||s===null){return void 0}let o;if(s.execution instanceof sc){o=Ou.from(s.execution)}else if(s.execution instanceof Ia){o=Fu.from(s.execution)}else if(s.execution&&s.execution instanceof ey){o=br.from(s.execution)}const a=sm.from(s.definition);let l;if(s.scope){if(typeof s.scope==="number"){l=s.scope}else{l=s.scope.uri}}else{l=mo.Workspace}if(!a||!l){return void 0}const c={_id:s._id,definition:a,name:s.name,source:{extensionId:r.identifier.value,label:s.source,scope:l},execution:o,isBackground:s.isBackground,group:xb.from(s.group),presentationOptions:rm.from(s.presentationOptions),problemMatchers:Sn(s.problemMatchers),hasDefinedMatchers:s.hasDefinedMatchers,runOptions:s.runOptions?s.runOptions:{reevaluateOnRerun:true},detail:s.detail};return c}t.from=i;async function n(s,r,o){if(s===void 0||s===null){return void 0}let a;if(Ou.is(s.execution)){a=Ou.to(s.execution)}else if(Fu.is(s.execution)){a=Fu.to(s.execution)}else if(br.is(s.execution)){a=br.to(s._id,o)}const l=sm.to(s.definition);let c;if(s.source){if(s.source.scope!==void 0){if(typeof s.source.scope==="number"){c=s.source.scope}else{c=await r.resolveWorkspaceFolder(b.revive(s.source.scope))}}else{c=mo.Workspace}}if(!l||!c){return void 0}const u=new zp(l,c,s.name,s.source.label,a,s.problemMatchers);if(s.isBackground!==void 0){u.isBackground=s.isBackground}if(s.group!==void 0){u.group=_d.from(s.group._id);if(u.group&&s.group.isDefault){u.group=new _d(u.group.id,u.group.label);if(s.group.isDefault===true){u.group.isDefault=s.group.isDefault}}}if(s.presentationOptions){u.presentationOptions=rm.to(s.presentationOptions)}if(s._id){u._id=s._id}if(s.detail){u.detail=s.detail}return u}t.to=n})(oo||(oo={}));var Eb;(function(t){function e(n){return n}t.from=e;function i(n){if(!n){return void 0}return Object.assign(Object.create(null),n)}t.to=i})(Eb||(Eb={}));class N1{#e;constructor(e,i,n){this._id=i;this._task=n;this.#e=e}get task(){return this._task}terminate(){this.#e.terminateTask(this)}fireDidStartProcess(e){}fireDidEndProcess(e){}}let Sb=class L${constructor(e,i,n,s,r,o,a,l){this._onDidExecuteTask=new L;this._onDidTerminateTask=new L;this._onDidTaskProcessStarted=new L;this._onDidTaskProcessEnded=new L;this._onDidStartTaskProblemMatchers=new L;this._onDidEndTaskProblemMatchers=new L;this._proxy=e.getProxy(Y.MainThreadTask);this._workspaceProvider=n;this._editorService=s;this._configurationService=r;this._terminalService=o;this._handleCounter=0;this._handlers=new Map;this._taskExecutions=new Map;this._taskExecutionPromises=new Map;this._providedCustomExecutions2=new Map;this._notProvidedCustomExecutions=new Set;this._activeCustomExecutions2=new Map;this._logService=a;this._deprecationService=l;this._proxy.$registerSupportedExecutions(true)}registerTaskProvider(e,i,n){if(!n){return new qe(()=>{})}const s=this.nextHandle();this._handlers.set(s,{type:i,provider:n,extension:e});this._proxy.$registerTaskProvider(s,i);return new qe(()=>{this._handlers.delete(s);this._proxy.$unregisterTaskProvider(s)})}registerTaskSystem(e,i){this._proxy.$registerTaskSystem(e,i)}fetchTasks(e){return this._proxy.$fetchTasks(Eb.from(e)).then(async i=>{const n=[];for(const s of i){const r=await oo.to(s,this._workspaceProvider,this._providedCustomExecutions2);if(r){n.push(r)}}return n})}get taskExecutions(){const e=[];this._taskExecutions.forEach(i=>e.push(i));return e}terminateTask(e){if(!(e instanceof N1)){throw new Error("No valid task execution provided")}return this._proxy.$terminateTask(e._id)}get onDidStartTask(){return this._onDidExecuteTask.event}async $onDidStartTask(e,i,n){const s=this._providedCustomExecutions2.get(e.id);if(s){this._activeCustomExecutions2.set(e.id,s);this._terminalService.attachPtyToTerminal(i,await s.callback(n))}this._lastStartedTask=e.id;this._onDidExecuteTask.fire({execution:await this.getTaskExecution(e)})}get onDidEndTask(){return this._onDidTerminateTask.event}async $OnDidEndTask(e){if(!this._taskExecutionPromises.has(e.id)){return}const i=await this.getTaskExecution(e);this._taskExecutionPromises.delete(e.id);this._taskExecutions.delete(e.id);this.customExecutionComplete(e);this._onDidTerminateTask.fire({execution:i})}get onDidStartTaskProcess(){return this._onDidTaskProcessStarted.event}async $onDidStartTaskProcess(e){const i=await this.getTaskExecution(e.id);this._onDidTaskProcessStarted.fire({execution:i,processId:e.processId})}get onDidEndTaskProcess(){return this._onDidTaskProcessEnded.event}async $onDidEndTaskProcess(e){const i=await this.getTaskExecution(e.id);this._onDidTaskProcessEnded.fire({execution:i,exitCode:e.exitCode})}get onDidStartTaskProblemMatchers(){return this._onDidStartTaskProblemMatchers.event}async $onDidStartTaskProblemMatchers(e){let i;try{i=await this.getTaskExecution(e.execution.id)}catch(n){return}this._onDidStartTaskProblemMatchers.fire({execution:i})}get onDidEndTaskProblemMatchers(){return this._onDidEndTaskProblemMatchers.event}async $onDidEndTaskProblemMatchers(e){let i;try{i=await this.getTaskExecution(e.execution.id)}catch(n){return}this._onDidEndTaskProblemMatchers.fire({execution:i,hasErrors:e.hasErrors})}$provideTasks(e,i){const n=this._handlers.get(e);if(!n){return Promise.reject(new Error("no handler found"))}const s=[];const r=Ci(()=>n.provider.provideTasks(bt.None)).then(o=>{return this.provideTasksInternal(i,s,n,o)});return new Promise(o=>{r.then(a=>{Promise.all(s).then(()=>{o(a)})})})}async $resolveTask(e,i){const n=this._handlers.get(e);if(!n){return Promise.reject(new Error("no handler found"))}if(i.definition.type!==n.type){throw new Error(`Unexpected: Task of type [${i.definition.type}] cannot be resolved by provider of type [${n.type}].`)}const s=await oo.to(i,this._workspaceProvider,this._providedCustomExecutions2);if(!s){throw new Error("Unexpected: Task cannot be resolved.")}const r=await n.provider.resolveTask(s,bt.None);if(!r){return}this.checkDeprecation(r,n);const o=oo.from(r,n.extension);if(!o){throw new Error("Unexpected: Task cannot be resolved.")}if(r.definition!==s.definition){throw new Error("Unexpected: The resolved task definition must be the same object as the original task definition. The task definition cannot be changed.")}if(br.is(o.execution)){await this.addCustomExecution(o,r,true)}return await this.resolveTaskInternal(o)}nextHandle(){return this._handleCounter++}async addCustomExecution(e,i,n){const s=await this._proxy.$createTaskId(e);if(!n&&!this._providedCustomExecutions2.has(s)){this._notProvidedCustomExecutions.add(s);this._activeCustomExecutions2.set(s,i.execution)}this._providedCustomExecutions2.set(s,i.execution)}async getTaskExecution(e,i){if(typeof e==="string"){const r=this._taskExecutionPromises.get(e);if(!r){throw new Ns("Unexpected: The specified task is missing an execution")}return r}const n=this._taskExecutionPromises.get(e.id);if(n){return n}let s;if(!i){s=oo.to(e.task,this._workspaceProvider,this._providedCustomExecutions2).then(r=>{if(!r){throw new Ns("Unexpected: Task does not exist.")}return new N1(this,e.id,r)})}else{s=Promise.resolve(new N1(this,e.id,i))}this._taskExecutionPromises.set(e.id,s);return s.then(r=>{this._taskExecutions.set(e.id,r);return r})}checkDeprecation(e,i){const n=e;if(n._deprecated){this._deprecationService.report("Task.constructor",i.extension,"Use the Task constructor that takes a `scope` instead.")}}customExecutionComplete(e){const i=this._activeCustomExecutions2.get(e.id);if(i){this._activeCustomExecutions2.delete(e.id)}if(this._notProvidedCustomExecutions.has(e.id)&&this._lastStartedTask!==e.id){this._providedCustomExecutions2.delete(e.id);this._notProvidedCustomExecutions.delete(e.id)}const n=this._notProvidedCustomExecutions.values();let s=n.next();while(!s.done){if(!this._activeCustomExecutions2.has(s.value)&&this._lastStartedTask!==s.value){this._providedCustomExecutions2.delete(s.value);this._notProvidedCustomExecutions.delete(s.value)}s=n.next()}}};Sb=z([O(0,st),O(1,Ai),O(2,Cr),O(3,Oc),O(4,Tr),O(5,Nc),O(6,at),O(7,zm)],Sb);let Db=class N$ extends Sb{constructor(e,i,n,s,r,o,a,l){super(e,i,n,s,r,o,a,l);this.registerTaskSystem(ae.vscodeRemote,{scheme:ae.vscodeRemote,authority:"",platform:xT(is.Web)})}async executeTask(e,i){if(!i.execution){throw new Error("Tasks to execute must include an execution")}const n=oo.from(i,e);if(n===void 0){throw new Error("Task is not valid")}if(br.is(n.execution)){await this.addCustomExecution(n,i,false)}else{throw new Y1}const s=await this.getTaskExecution(await this._proxy.$getTaskExecution(n),i);this._proxy.$executeTask(n).catch(r=>{throw new Error(r)});return s}provideTasksInternal(e,i,n,s){const r=[];if(s){for(const o of s){this.checkDeprecation(o,n);if(!o.definition||!e[o.definition.type]){const l=o.source?o.source:"No task source";this._logService.warn(`The task [${l}, ${o.name}] uses an undefined task type. The task will be ignored in the future.`)}const a=oo.from(o,n.extension);if(a&&br.is(a.execution)){r.push(a);i.push(this.addCustomExecution(a,o,true))}else{this._logService.warn("Only custom execution tasks supported.")}}}return{tasks:r,extension:n.extension}}async resolveTaskInternal(e){if(br.is(e.execution)){return e}else{this._logService.warn("Only custom execution tasks supported.")}return void 0}async $resolveVariables(e,i){const n={process:void 0,variables:Object.create(null)};return n}async $jsonTasksSupported(){return false}async $findExecutable(e,i,n){return void 0}};Db=z([O(0,st),O(1,Ai),O(2,Cr),O(3,Oc),O(4,Tr),O(5,Nc),O(6,at),O(7,zm)],Db);const HC=xe("IExtHostTask");class BL{constructor(){this.pendingRequests=new Map;this.queue=[];this._onError=new L;this._onExit=new L;this.sequence=1}get onError(){return this._onError.event}get onExit(){return this._onExit.event}onMessage(e){if(this.messageCallback){this._onError.fire(new Error(`attempt to set more than one 'Message' callback`))}this.messageCallback=e}onEvent(e){if(this.eventCallback){this._onError.fire(new Error(`attempt to set more than one 'Event' callback`))}this.eventCallback=e}onRequest(e){if(this.requestCallback){this._onError.fire(new Error(`attempt to set more than one 'Request' callback`))}this.requestCallback=e}sendResponse(e){if(e.seq>0){this._onError.fire(new Error(`attempt to send more than one response for command ${e.command}`))}else{this.internalSend("response",e)}}sendRequest(e,i,n,s){const r={command:e};if(i&&Object.keys(i).length>0){r.arguments=i}this.internalSend("request",r);if(typeof s==="number"){const o=setTimeout(()=>{clearTimeout(o);const a=this.pendingRequests.get(r.seq);if(a){this.pendingRequests.delete(r.seq);const l={type:"response",seq:0,request_seq:r.seq,success:false,command:e,message:h(5987,"Timeout after {0} ms for '{1}'",s,e)};a(l)}},s)}if(n){this.pendingRequests.set(r.seq,n)}return r.seq}acceptMessage(e){if(this.messageCallback){this.messageCallback(e)}else{this.queue.push(e);if(this.queue.length===1){this.processQueue()}}}needsTaskBoundaryBetween(e,i){return e.type!=="event"||i.type!=="event"}async processQueue(){let e;while(this.queue.length){if(!e||this.needsTaskBoundaryBetween(this.queue[0],e)){await Ts(0)}e=this.queue.shift();if(!e){return}switch(e.type){case"event":this.eventCallback?.(e);break;case"request":this.requestCallback?.(e);break;case"response":{const i=e;const n=this.pendingRequests.get(i.request_seq);if(n){this.pendingRequests.delete(i.request_seq);n(i)}break}}}}internalSend(e,i){i.type=e;i.seq=this.sequence++;this.sendMessage(i)}async cancelPendingRequests(){if(this.pendingRequests.size===0){return Promise.resolve()}const e=new Map;this.pendingRequests.forEach((i,n)=>e.set(n,i));await Ts(500);e.forEach((i,n)=>{const s={type:"response",seq:0,request_seq:n,success:false,command:"canceled",message:"canceled"};i(s);this.pendingRequests.delete(n)})}getPendingRequestIds(){return Array.from(this.pendingRequests.keys())}dispose(){this.queue=[]}}function VL(t){return t.type&&(t.label||t.program||t.runtime)}const WL=/^[a-zA-Z][a-zA-Z0-9\+\-\.]+:/;function zL(t){return!!(t&&t.match(WL))}function qL(t){if(typeof t.path==="string"){if(typeof t.sourceReference==="number"&&t.sourceReference>0);else{if(zL(t.path)){return b.parse(t.path)}else{if(Nf(t.path)){return b.file(t.path)}}}}return t.path}function jL(t){if(typeof t.path==="object"){const e=b.revive(t.path);if(e){if(e.scheme===ae.file){return e.fsPath}else{return e.toString()}}}return t.path}function GL(t,e){const i=jL;const n=vt(t);BC(n,(s,r)=>{if(s&&r){r.path=i(r)}});return n}function KL(t,e){const i=qL;const n=vt(t);BC(n,(s,r)=>{if(!s&&r){r.path=i(r)}});return n}function BC(t,e){switch(t.type){case"event":{const i=t;switch(i.event){case"output":e(false,i.body.source);break;case"loadedSource":e(false,i.body.source);break;case"breakpoint":e(false,i.body.breakpoint.source);break}break}case"request":{const i=t;switch(i.command){case"setBreakpoints":e(true,i.arguments.source);break;case"breakpointLocations":e(true,i.arguments.source);break;case"source":e(true,i.arguments.source);break;case"gotoTargets":e(true,i.arguments.source);break;case"launchVSCode":i.arguments.args.forEach(n=>e(false,n));break}break}case"response":{const i=t;if(i.success&&i.body){switch(i.command){case"stackTrace":i.body.stackFrames.forEach(n=>e(false,n.source));break;case"loadedSources":i.body.sources.forEach(n=>e(false,n));break;case"scopes":i.body.scopes.forEach(n=>e(false,n.source));break;case"setFunctionBreakpoints":i.body.breakpoints.forEach(n=>e(false,n.source));break;case"setBreakpoints":i.body.breakpoints.forEach(n=>e(false,n.source));break;case"disassemble":{const n=i;n.body?.instructions.forEach(s=>e(false,s.location))}break;case"locations":e(false,i.body?.source);break}}break}}}const _h=xe("IExtHostEditorTabs");class SD{constructor(e,i,n){this._activeTabIdGetter=n;this._parentGroup=i;this.acceptDtoUpdate(e)}get apiObject(){if(!this._apiObject){const e=this;const i={get isActive(){return e._dto.id===e._activeTabIdGetter()},get label(){return e._dto.label},get input(){return e._input},get isDirty(){return e._dto.isDirty},get isPinned(){return e._dto.isPinned},get isPreview(){return e._dto.isPreview},get group(){return e._parentGroup.apiObject}};this._apiObject=Object.freeze(i)}return this._apiObject}get tabId(){return this._dto.id}acceptDtoUpdate(e){this._dto=e;this._input=this._initInput()}_initInput(){switch(this._dto.input.kind){case fn.TextInput:return new ny(b.revive(this._dto.input.uri));case fn.TextDiffInput:return new ug(b.revive(this._dto.input.original),b.revive(this._dto.input.modified));case fn.TextMergeInput:return new X4(b.revive(this._dto.input.base),b.revive(this._dto.input.input1),b.revive(this._dto.input.input2),b.revive(this._dto.input.result));case fn.CustomEditorInput:return new sy(b.revive(this._dto.input.uri),this._dto.input.viewType);case fn.WebviewEditorInput:return new Y4(this._dto.input.viewType);case fn.NotebookInput:return new ry(b.revive(this._dto.input.uri),this._dto.input.notebookType);case fn.NotebookDiffInput:return new oy(b.revive(this._dto.input.original),b.revive(this._dto.input.modified),this._dto.input.notebookType);case fn.TerminalEditorInput:return new Z4;case fn.InteractiveEditorInput:return new eC(b.revive(this._dto.input.uri),b.revive(this._dto.input.inputBoxUri));case fn.ChatEditorInput:return new tC;case fn.MultiDiffEditorInput:return new iC(this._dto.input.diffEditors.map(e=>new ug(b.revive(e.original),b.revive(e.modified))));default:return void 0}}}class QL{constructor(e,i){this._tabs=[];this._activeTabId="";this._dto=e;this._activeGroupIdGetter=i;for(const n of e.tabs){if(n.isActive){this._activeTabId=n.id}this._tabs.push(new SD(n,this,()=>this.activeTabId()))}}get apiObject(){if(!this._apiObject){const e=this;const i={get isActive(){return e._dto.groupId===e._activeGroupIdGetter()},get viewColumn(){return ai.to(e._dto.viewColumn)},get activeTab(){return e._tabs.find(n=>n.tabId===e._activeTabId)?.apiObject},get tabs(){return Object.freeze(e._tabs.map(n=>n.apiObject))}};this._apiObject=Object.freeze(i)}return this._apiObject}get groupId(){return this._dto.groupId}get tabs(){return this._tabs}acceptGroupDtoUpdate(e){this._dto=e}acceptTabOperation(e){if(e.kind===ur.TAB_OPEN){const n=new SD(e.tabDto,this,()=>this.activeTabId());this._tabs.splice(e.index,0,n);if(e.tabDto.isActive){this._activeTabId=n.tabId}return n}else if(e.kind===ur.TAB_CLOSE){const n=this._tabs.splice(e.index,1)[0];if(!n){throw new Error(`Tab close updated received for index ${e.index} which does not exist`)}if(n.tabId===this._activeTabId){this._activeTabId=""}return n}else if(e.kind===ur.TAB_MOVE){if(e.oldIndex===void 0){throw new Error("Invalid old index on move IPC")}const n=this._tabs.splice(e.oldIndex,1)[0];if(!n){throw new Error(`Tab move updated received for index ${e.oldIndex} which does not exist`)}this._tabs.splice(e.index,0,n);return n}const i=this._tabs.find(n=>n.tabId===e.tabDto.id);if(!i){throw new Error("INVALID tab")}if(e.tabDto.isActive){this._activeTabId=e.tabDto.id}else if(this._activeTabId===e.tabDto.id&&!e.tabDto.isActive){this._activeTabId=""}i.acceptDtoUpdate(e.tabDto);return i}activeTabId(){return this._activeTabId}}let kb=class O${constructor(e){this._onDidChangeTabs=new L;this._onDidChangeTabGroups=new L;this._extHostTabGroups=[];this._proxy=e.getProxy(Y.MainThreadEditorTabs)}get tabGroups(){if(!this._apiObject){const e=this;const i={onDidChangeTabGroups:e._onDidChangeTabGroups.event,onDidChangeTabs:e._onDidChangeTabs.event,get all(){return Object.freeze(e._extHostTabGroups.map(n=>n.apiObject))},get activeTabGroup(){const n=e._activeGroupId;const s=zl(e._extHostTabGroups.find(r=>r.groupId===n)?.apiObject);return s},close:async(n,s)=>{const r=Array.isArray(n)?n:[n];if(!r.length){return true}if(JL(r[0])){return this._closeGroups(r,s)}else{return this._closeTabs(r,s)}}};this._apiObject=Object.freeze(i)}return this._apiObject}$acceptEditorTabModel(e){const i=new Set(this._extHostTabGroups.map(c=>c.groupId));const n=new Set(e.map(c=>c.groupId));const s=C5(i,n);const r=this._extHostTabGroups.filter(c=>s.removed.includes(c.groupId)).map(c=>c.apiObject);const o=[];const a=[];this._extHostTabGroups=e.map(c=>{const u=new QL(c,()=>this._activeGroupId);if(s.added.includes(u.groupId)){o.push(u.apiObject)}else{a.push(u.apiObject)}return u});const l=zl(e.find(c=>c.isActive===true)?.groupId);if(l!==void 0&&this._activeGroupId!==l){this._activeGroupId=l}this._onDidChangeTabGroups.fire(Object.freeze({opened:o,closed:r,changed:a}))}$acceptTabGroupUpdate(e){const i=this._extHostTabGroups.find(n=>n.groupId===e.groupId);if(!i){throw new Error("Update Group IPC call received before group creation.")}i.acceptGroupDtoUpdate(e);if(e.isActive){this._activeGroupId=e.groupId}this._onDidChangeTabGroups.fire(Object.freeze({changed:[i.apiObject],opened:[],closed:[]}))}$acceptTabOperation(e){const i=this._extHostTabGroups.find(s=>s.groupId===e.groupId);if(!i){throw new Error("Update Tabs IPC call received before group creation.")}const n=i.acceptTabOperation(e);switch(e.kind){case ur.TAB_OPEN:this._onDidChangeTabs.fire(Object.freeze({opened:[n.apiObject],closed:[],changed:[]}));return;case ur.TAB_CLOSE:this._onDidChangeTabs.fire(Object.freeze({opened:[],closed:[n.apiObject],changed:[]}));return;case ur.TAB_MOVE:case ur.TAB_UPDATE:this._onDidChangeTabs.fire(Object.freeze({opened:[],closed:[],changed:[n.apiObject]}));return}}_findExtHostTabFromApi(e){for(const i of this._extHostTabGroups){for(const n of i.tabs){if(n.apiObject===e){return n}}}return}_findExtHostTabGroupFromApi(e){return this._extHostTabGroups.find(i=>i.apiObject===e)}async _closeTabs(e,i){const n=[];for(const s of e){const r=this._findExtHostTabFromApi(s);if(!r){throw new Error("Tab close: Invalid tab not found!")}n.push(r.tabId)}return this._proxy.$closeTab(n,i)}async _closeGroups(e,i){const n=[];for(const s of e){const r=this._findExtHostTabGroupFromApi(s);if(!r){throw new Error("Group close: Invalid group not found!")}n.push(r.groupId)}return this._proxy.$closeGroup(n,i)}};kb=z([O(0,st)],kb);function JL(t){const e=t;if(e.tabs!==void 0){return true}return false}var DD;(function(t){t["ViewletId"]="workbench.view.extension.test";t["ExplorerViewId"]="workbench.view.testing";t["OutputPeekContributionId"]="editor.contrib.testingOutputPeek";t["DecorationsContributionId"]="editor.contrib.testingDecorations";t["CoverageDecorationsContributionId"]="editor.contrib.coverageDecorations";t["CoverageViewId"]="workbench.view.testCoverage";t["ResultsPanelId"]="workbench.panel.testResults";t["ResultsViewId"]="workbench.panel.testResults.view";t["MessageLanguageId"]="vscodeInternalTestMessage"})(DD||(DD={}));var kD;(function(t){t["List"]="list";t["Tree"]="true"})(kD||(kD={}));var ID;(function(t){t["ByLocation"]="location";t["ByStatus"]="status";t["ByDuration"]="duration"})(ID||(ID={}));({[Jt.Errored]:h(11044,"Errored"),[Jt.Failed]:h(11045,"Failed"),[Jt.Passed]:h(11046,"Passed"),[Jt.Queued]:h(11047,"Queued"),[Jt.Running]:h(11048,"Running"),[Jt.Skipped]:h(11049,"Skipped"),[Jt.Unset]:h(11050,"Not yet run")});({[Ii.Debug]:h(11052,"Debug"),[Ii.Run]:h(11053,"Run"),[Ii.Coverage]:h(11054,"Coverage")});var Ib;(function(t){t["CancelTestRefreshAction"]="testing.cancelTestRefresh";t["CancelTestRunAction"]="testing.cancelRun";t["ClearTestResultsAction"]="testing.clearTestResults";t["CollapseAllAction"]="testing.collapseAll";t["ConfigureTestProfilesAction"]="testing.configureProfile";t["ContinousRunUsingForTest"]="testing.continuousRunUsingForTest";t["CoverageAtCursor"]="testing.coverageAtCursor";t["CoverageByUri"]="testing.coverage.uri";t["CoverageClear"]="testing.coverage.close";t["CoverageCurrentFile"]="testing.coverageCurrentFile";t["CoverageFilterToTest"]="testing.coverageFilterToTest";t["CoverageFilterToTestInEditor"]="testing.coverageFilterToTestInEditor";t["CoverageLastRun"]="testing.coverageLastRun";t["CoverageSelectedAction"]="testing.coverageSelected";t["CoverageToggleToolbar"]="testing.coverageToggleToolbar";t["CoverageViewChangeSorting"]="testing.coverageViewChangeSorting";t["DebugAction"]="testing.debug";t["DebugAllAction"]="testing.debugAll";t["DebugAtCursor"]="testing.debugAtCursor";t["DebugByUri"]="testing.debug.uri";t["DebugCurrentFile"]="testing.debugCurrentFile";t["DebugFailedTests"]="testing.debugFailTests";t["DebugLastRun"]="testing.debugLastRun";t["DebugSelectedAction"]="testing.debugSelected";t["FilterAction"]="workbench.actions.treeView.testExplorer.filter";t["GetExplorerSelection"]="_testing.getExplorerSelection";t["GetSelectedProfiles"]="testing.getSelectedProfiles";t["GoToTest"]="testing.editFocusedTest";t["GoToRelatedTest"]="testing.goToRelatedTest";t["PeekRelatedTest"]="testing.peekRelatedTest";t["GoToRelatedCode"]="testing.goToRelatedCode";t["PeekRelatedCode"]="testing.peekRelatedCode";t["HideTestAction"]="testing.hideTest";t["OpenCoverage"]="testing.openCoverage";t["OpenOutputPeek"]="testing.openOutputPeek";t["RefreshTestsAction"]="testing.refreshTests";t["ReRunFailedTests"]="testing.reRunFailTests";t["ReRunLastRun"]="testing.reRunLastRun";t["RunAction"]="testing.run";t["RunAllAction"]="testing.runAll";t["RunAllWithCoverageAction"]="testing.coverageAll";t["RunAtCursor"]="testing.runAtCursor";t["RunByUri"]="testing.run.uri";t["RunCurrentFile"]="testing.runCurrentFile";t["RunSelectedAction"]="testing.runSelected";t["RunUsingProfileAction"]="testing.runUsing";t["RunWithCoverageAction"]="testing.coverage";t["SearchForTestExtension"]="testing.searchForTestExtension";t["SelectDefaultTestProfiles"]="testing.selectDefaultTestProfiles";t["ShowMostRecentOutputAction"]="testing.showMostRecentOutput";t["StartContinousRun"]="testing.startContinuousRun";t["StartContinousRunFromExtension"]="testing.startContinuousRunFromExtension";t["StopContinousRunFromExtension"]="testing.stopContinuousRunFromExtension";t["StopContinousRun"]="testing.stopContinuousRun";t["TestingSortByDurationAction"]="testing.sortByDuration";t["TestingSortByLocationAction"]="testing.sortByLocation";t["TestingSortByStatusAction"]="testing.sortByStatus";t["TestingViewAsListAction"]="testing.viewAsList";t["TestingViewAsTreeAction"]="testing.viewAsTree";t["ToggleContinousRunForTest"]="testing.toggleContinuousRunForTest";t["ToggleInlineTestOutput"]="testing.toggleInlineTestOutput";t["UnhideAllTestsAction"]="testing.unhideAllTests";t["UnhideTestAction"]="testing.unhideTest"})(Ib||(Ib={}));let XL=0;const CD=new WeakMap;const qm=xe("IExtHostTesting");let Cb=class F$ extends Ee{constructor(e,i,n,s){super();this.logService=i;this.commands=n;this.editors=s;this.resultsChangedEmitter=this._register(new L);this.controllers=new Map;this.defaultProfilesChangedEmitter=this._register(new L);this.followupProviders=new Set;this.testFollowups=new Map;this.onResultsChanged=this.resultsChangedEmitter.event;this.results=[];this.proxy=e.getProxy(Y.MainThreadTesting);this.observer=new nN(this.proxy);this.runTracker=new eN(this.proxy,i);n.registerArgumentProcessor({processArgument:r=>{switch(r?.$mid){case it.TestItemContext:{const o=r;const a=o.tests[o.tests.length-1].item.extId;const l=this.controllers.get(Re.root(a));return l?.collection.tree.get(a)?.actual??QS(r)}case it.TestMessageMenuArgs:{const{test:o,message:a}=r;const l=o.item.extId;return{test:this.controllers.get(Re.root(l))?.collection.tree.get(l)?.actual??QS({tests:[o]}),message:wc.to(a)}}default:return r}}});n.registerCommand(false,"testing.getExplorerSelection",async()=>{const r=await n.executeCommand(Ib.GetExplorerSelection);const o=a=>{const l=this.controllers.get(Re.root(a));if(!l){return void 0}return Re.isRoot(a)?l.controller:l.collection.tree.get(a)?.actual};return{include:r?.include.map(o).filter(ln)||[],exclude:r?.exclude.map(o).filter(ln)||[]}})}createTestController(e,i,n,s){if(this.controllers.has(i)){throw new Error(`Attempt to insert a duplicate controller with ID "${i}"`)}const r=new Ie;const o=r.add(new L6(i,n,this.editors));o.root.label=n;const a=new Map;const l=new Set;const c=this.proxy;const u=()=>{let f=0;if(s){f|=Cu.Refresh}const m=p.relatedCodeProvider;if(m){if(m?.provideRelatedTests){f|=Cu.TestRelatedToCode}if(m?.provideRelatedCode){f|=Cu.CodeRelatedToTest}}return f};const d={items:o.root.children,get label(){return n},set label(f){n=f;o.root.label=f;c.$updateController(i,{label:n})},get refreshHandler(){return s},set refreshHandler(f){s=f;c.$updateController(i,{capabilities:u()})},get id(){return i},get relatedCodeProvider(){return p.relatedCodeProvider},set relatedCodeProvider(f){$(e,"testRelatedCode");p.relatedCodeProvider=f;c.$updateController(i,{capabilities:u()})},createRunProfile:(f,m,v,y,D,I)=>{let R=td(f);while(a.has(R)){R++}return new WC(this.proxy,a,l,this.defaultProfilesChangedEmitter.event,i,R,f,m,v,y,D,I)},createTestItem(f,m,v){return new Ha(i,f,m,v)},createTestRun:(f,m,v=true)=>{return this.runTracker.createTestRun(e,i,o,f,m,v)},invalidateTestResults:f=>{if(f===void 0){this.proxy.$markTestRetired(void 0)}else{const m=f instanceof Array?f:[f];this.proxy.$markTestRetired(m.map(v=>Re.fromExtHostTestItem(v,i).toString()))}},set resolveHandler(f){o.resolveHandler=f},get resolveHandler(){return o.resolveHandler},dispose:()=>{r.dispose()}};const p={controller:d,collection:o,profiles:a,extension:e,activeProfiles:l};c.$registerTestController(i,n,u());r.add(ge(()=>c.$unregisterTestController(i)));this.controllers.set(i,p);r.add(ge(()=>this.controllers.delete(i)));r.add(o.onDidGenerateDiff(f=>c.$publishDiff(i,f.map(Ip.serialize))));return d}createTestObserver(){return this.observer.checkout()}async runTests(e,i=bt.None){const n=VC(e);if(!n){throw new Error("The request passed to `vscode.test.runTests` must include a profile")}const s=this.controllers.get(n.controllerId);if(!s){throw new Error("Controller not found")}await this.proxy.$runTests({preserveFocus:e.preserveFocus??true,group:bc.from(n.kind),targets:[{testIds:e.include?.map(r=>Re.fromExtHostTestItem(r,s.collection.root.id).toString())??[s.collection.root.id],profileId:n.profileId,controllerId:n.controllerId}],exclude:e.exclude?.map(r=>r.id)},i)}registerTestFollowupProvider(e){this.followupProviders.add(e);return{dispose:()=>{this.followupProviders.delete(e)}}}async $getTestsRelatedToCode(e,i,n){const s=this.editors.getDocument(b.revive(e));if(!s){return[]}const r=rt.to(i);const o=[];await Promise.all([...this.controllers.values()].map(async a=>{let l;try{l=await a.relatedCodeProvider?.provideRelatedTests?.(s.document,r,n)}catch(c){if(!n.isCancellationRequested){this.logService.warn(`Error thrown while providing related tests for ${a.controller.label}`,c)}}if(l){for(const c of l){o.push(Re.fromExtHostTestItem(c,a.controller.id).toString())}a.collection.flushDiff()}}));return o}async $getCodeRelatedToTest(e,i){const n=this.controllers.get(Re.root(e));if(!n){return[]}const s=n.collection.tree.get(e);if(!s){return[]}const r=await n.relatedCodeProvider?.provideRelatedCode?.(s.actual,i);return r?.map(Zi.from)??[]}$syncTests(){for(const{collection:e}of this.controllers.values()){e.flushDiff()}return Promise.resolve()}async $getCoverageDetails(e,i,n){const s=await this.runTracker.getCoverageDetails(e,i,n);return s?.map(Wd.fromDetails)}async $disposeRun(e){this.runTracker.disposeTestRun(e)}$configureRunProfile(e,i){this.controllers.get(e)?.profiles.get(i)?.configureHandler?.()}$setDefaultRunProfiles(e){const i=new Map;for(const[n,s]of Object.entries(e)){const r=this.controllers.get(n);if(!r){continue}const o=new Map;const a=s.filter(c=>!r.activeProfiles.has(c));const l=[...r.activeProfiles].filter(c=>!s.includes(c));for(const c of a){o.set(c,true);r.activeProfiles.add(c)}for(const c of l){o.set(c,false);r.activeProfiles.delete(c)}if(o.size){i.set(n,o)}}this.defaultProfilesChangedEmitter.fire(i)}async $refreshTests(e,i){await this.controllers.get(e)?.controller.refreshHandler?.(i)}$publishTestResults(e){this.results=Object.freeze(e.map(i=>{const n=Ew.to(i);const s=i.tasks.findIndex(r=>r.hasCoverage);if(s!==-1){n.getDetailedCoverage=(r,o=bt.None)=>this.proxy.$getCoverageDetails(i.id,s,r,o).then(a=>a.map(Wd.to))}CD.set(n,i.id);return n}).concat(this.results).sort((i,n)=>n.completedAt-i.completedAt).slice(0,32));this.resultsChangedEmitter.fire()}async $expandTest(e,i){const n=this.controllers.get(Re.fromString(e).controllerId)?.collection;if(n){await n.expand(e,i<0?Infinity:i);n.flushDiff()}}$acceptDiff(e){this.observer.applyDiff(e.map(i=>Ip.deserialize({asCanonicalUri:n=>n},i)))}async $runControllerTests(e,i){return Promise.all(e.map(n=>this.runControllerTestRequest(n,false,i)))}async $startContinuousRun(e,i){const n=new Ot(i);const s=await Promise.all(e.map(r=>this.runControllerTestRequest(r,true,n.token)));if(!i.isCancellationRequested&&!s.some(r=>r.error)){await new Promise(r=>i.onCancellationRequested(r))}n.dispose(true);return s}async $provideTestFollowups(e,i){const n=this.results.find(o=>CD.get(o)===e.resultId);const s=n&&sN(Re.fromString(e.extId),n?.results);if(!s){return[]}let r=[];await Promise.all([...this.followupProviders].map(async o=>{try{const a=await o.provideFollowup(n,s,e.taskIndex,e.messageIndex,i);if(a){r=r.concat(a)}}catch(a){this.logService.error(`Error thrown while providing followup for test message`,a)}}));if(i.isCancellationRequested){return[]}return r.map(o=>{const a=XL++;this.testFollowups.set(a,o);return{title:o.title,id:a}})}$disposeTestFollowups(e){for(const i of e){this.testFollowups.delete(i)}}$executeTestFollowup(e){const i=this.testFollowups.get(e);if(!i){return Promise.resolve()}return this.commands.executeCommand(i.command,...i.arguments||[])}$cancelExtensionTestRun(e,i){if(e===void 0){this.runTracker.cancelAllRuns()}else{this.runTracker.cancelRunById(e,i)}}getMetadataForRun(e){for(const i of this.runTracker.trackers){const n=i.getTaskIdForRun(e);if(n){return{taskId:n,runId:i.id}}}return void 0}async runControllerTestRequest(e,i,n){const s=this.controllers.get(e.controllerId);if(!s){return{}}const{collection:r,profiles:o,extension:a}=s;const l=o.get(e.profileId);if(!l){return{}}const c=e.testIds.map(f=>r.tree.get(f)).filter(ln);const u=e.excludeExtIds.map(f=>s.collection.tree.get(f)).filter(ln).filter(f=>c.some(m=>m.fullId.compare(f.fullId)===Kn.IsChild));if(!c.length){return{}}const d=new lg(c.some(f=>f.actual instanceof my)?void 0:c.map(f=>f.actual),u.map(f=>f.actual),l,i);const p=VR(e)&&this.runTracker.prepareForMainThreadTestRun(a,d,th.fromInternal(e,s.collection),l,n);try{await l.runHandler(d,n);return{}}catch(f){return{error:String(f)}}finally{if(p){if(p.hasRunningTasks&&!n.isCancellationRequested){await Bt.toPromise(p.onEnd)}}}}};Cb=z([O(0,st),O(1,at),O(2,Ba),O(3,Oc)],Cb);const YL=1e4;var zr;(function(t){t[t["Running"]=0]="Running";t[t["Cancelling"]=1]="Cancelling";t[t["Ended"]=2]="Ended"})(zr||(zr={}));class ZL extends Ee{get hasRunningTasks(){return this.running>0}get id(){return this.dto.id}constructor(e,i,n,s,r,o){super();this.dto=e;this.proxy=i;this.logService=n;this.profile=s;this.extension=r;this.state=zr.Running;this.running=0;this.tasks=new Map;this.sharedTestIds=new Set;this.endEmitter=this._register(new L);this.publishedCoverage=new Map;this.onEnd=this.endEmitter.event;this.cts=this._register(new Ot(o));const a=this._register(new Ic(()=>this.forciblyEndTasks(),YL));this._register(this.cts.token.onCancellationRequested(()=>a.schedule()));const l=new L;this.onDidDispose=l.event;this._register(ge(()=>{l.fire();l.dispose()}))}getTaskIdForRun(e){for(const[i,{run:n}]of this.tasks){if(n===e){return i}}return void 0}cancel(e){if(e){this.tasks.get(e)?.cts.cancel()}else if(this.state===zr.Running){this.cts.cancel();this.state=zr.Cancelling}else if(this.state===zr.Cancelling){this.forciblyEndTasks()}}async getCoverageDetails(e,i,n){const[,s]=Re.fromString(e).path;const r=this.publishedCoverage.get(e);if(!r){return[]}const{report:o,extIds:a}=r;const l=this.tasks.get(s);if(!l){throw new Error("unreachable: run task was not found")}let c;if(i&&o instanceof cc){const d=a.indexOf(i);if(d===-1){return[]}c=o.includesTests[d]}const u=c?this.profile?.loadDetailedCoverageForTest?.(l.run,o,c,n):this.profile?.loadDetailedCoverage?.(l.run,o,n);return await u??[]}createRun(e){const i=this.dto.id;const n=this.dto.controllerId;const s=vi();const r=u=>(d,...p)=>{if(a){this.logService.warn(`Setting the state of test "${d.id}" is a no-op after the run ends.`);return}this.ensureTestIsKnown(d);u(d,...p)};const o=(u,d)=>{const p=d instanceof Array?d.map(wc.from):[wc.from(d)];if(u.uri&&u.range){const f={range:W.from(u.range),uri:u.uri};for(const m of p){m.location=m.location||f}}this.proxy.$appendTestMessagesInRun(i,s,Re.fromExtHostTestItem(u,n).toString(),p)};let a=false;const l=this._register(new Ot(this.cts.token));const c={isPersisted:this.dto.isPersisted,token:l.token,name:e,onDidDispose:this.onDidDispose,addCoverage:u=>{if(a){return}const d=u instanceof cc?u.includesTests:[];if(d.length){for(const m of d){this.ensureTestIsKnown(m)}}const p=u.uri.toString();const f=new Re([i,s,p]).toString();this.publishedCoverage.set(f,{report:u,extIds:d.map(m=>Re.fromExtHostTestItem(m,n).toString())});this.proxy.$appendCoverage(i,s,Wd.fromFile(n,f,u))},enqueued:r(u=>{this.proxy.$updateTestStateInRun(i,s,Re.fromExtHostTestItem(u,n).toString(),Jt.Queued)}),skipped:r(u=>{this.proxy.$updateTestStateInRun(i,s,Re.fromExtHostTestItem(u,n).toString(),Jt.Skipped)}),started:r(u=>{this.proxy.$updateTestStateInRun(i,s,Re.fromExtHostTestItem(u,n).toString(),Jt.Running)}),errored:r((u,d,p)=>{o(u,d);this.proxy.$updateTestStateInRun(i,s,Re.fromExtHostTestItem(u,n).toString(),Jt.Errored,p)}),failed:r((u,d,p)=>{o(u,d);this.proxy.$updateTestStateInRun(i,s,Re.fromExtHostTestItem(u,n).toString(),Jt.Failed,p)}),passed:r((u,d)=>{this.proxy.$updateTestStateInRun(i,s,Re.fromExtHostTestItem(u,this.dto.controllerId).toString(),Jt.Passed,d)}),appendOutput:(u,d,p)=>{if(a){return}if(p){this.ensureTestIsKnown(p)}this.proxy.$appendOutputToRun(i,s,ue.fromString(u),d&&Zi.from(d),p&&Re.fromExtHostTestItem(p,n).toString())},end:()=>{if(a){return}a=true;this.proxy.$finishedTestRunTask(i,s);if(!--this.running){this.markEnded()}}};this.running++;this.tasks.set(s,{run:c,cts:l});this.proxy.$startedTestRunTask(i,{id:s,ctrlId:this.dto.controllerId,name:e||this.extension.displayName||this.extension.identifier.value,running:true});return c}forciblyEndTasks(){for(const{run:e}of this.tasks.values()){e.end()}}markEnded(){if(this.state!==zr.Ended){this.state=zr.Ended;this.endEmitter.fire()}}ensureTestIsKnown(e){if(!(e instanceof Ha)){throw new Cp(e.id)}if(this.sharedTestIds.has(Re.fromExtHostTestItem(e,this.dto.controllerId).toString())){return}const i=[];const n=this.dto.colllection.root;while(true){const s=vo.from(e);i.unshift(s);if(this.sharedTestIds.has(s.extId)){break}this.sharedTestIds.add(s.extId);if(e===n){break}e=e.parent||n}this.proxy.$addTestsToRun(this.dto.controllerId,this.dto.id,i)}dispose(){this.markEnded();super.dispose()}}class eN{get trackers(){return this.tracked.values()}constructor(e,i){this.proxy=e;this.logService=i;this.tracked=new Map;this.trackedById=new Map}getCoverageDetails(e,i,n){const s=Re.root(e);return this.trackedById.get(s)?.getCoverageDetails(e,i,n)||[]}disposeTestRun(e){this.trackedById.get(e)?.dispose();this.trackedById.delete(e);for(const[i,{id:n}]of this.tracked){if(n===e){this.tracked.delete(i)}}}prepareForMainThreadTestRun(e,i,n,s,r){return this.getTracker(i,n,s,e,r)}cancelRunById(e,i){this.trackedById.get(e)?.cancel(i)}cancelAllRuns(){for(const e of this.tracked.values()){e.cancel()}}createTestRun(e,i,n,s,r,o){const a=this.tracked.get(s);if(a){return a.createRun(r)}const l=th.fromPublic(i,n,s,o);const c=VC(s);this.proxy.$startedExtensionTestRun({controllerId:i,continuous:!!s.continuous,profile:c&&{group:bc.from(c.kind),id:c.profileId},exclude:s.exclude?.map(d=>Re.fromExtHostTestItem(d,n.root.id).toString())??[],id:l.id,include:s.include?.map(d=>Re.fromExtHostTestItem(d,n.root.id).toString())??[n.root.id],preserveFocus:s.preserveFocus??true,persist:o});const u=this.getTracker(s,l,s.profile,e);Bt.once(u.onEnd)(()=>{this.proxy.$finishedExtensionTestRun(l.id)});return u.createRun(r)}getTracker(e,i,n,s,r){const o=new ZL(i,this.proxy,this.logService,n,s,r);this.tracked.set(e,o);this.trackedById.set(o.id,o);return o}}const VC=t=>{if(!t.profile){return void 0}if(!(t.profile instanceof WC)){throw new Error(`TestRunRequest.profile is not an instance created from TestController.createRunProfile`)}return t.profile};class th{static fromPublic(e,i,n,s){return new th(e,vi(),s,i)}static fromInternal(e,i){return new th(e.controllerId,e.runId,true,i)}constructor(e,i,n,s){this.controllerId=e;this.id=i;this.isPersisted=n;this.colllection=s}}class tN{get isEmpty(){return this.added.size===0&&this.removed.size===0&&this.updated.size===0}constructor(e){this.emitter=e;this.added=new Set;this.updated=new Set;this.removed=new Set;this.alreadyRemoved=new Set}add(e){this.added.add(e)}update(e){Object.assign(e.revived,vo.toPlain(e.item));if(!this.added.has(e)){this.updated.add(e)}}remove(e){if(this.added.has(e)){this.added.delete(e);return}this.updated.delete(e);const i=Re.parentId(e.item.extId);if(i&&this.alreadyRemoved.has(i.toString())){this.alreadyRemoved.add(e.item.extId);return}this.removed.add(e)}getChangeEvent(){const{added:e,updated:i,removed:n}=this;return{get added(){return[...e].map(s=>s.revived)},get updated(){return[...i].map(s=>s.revived)},get removed(){return[...n].map(s=>s.revived)}}}complete(){if(!this.isEmpty){this.emitter.fire(this.getChangeEvent())}}}class iN extends WR{constructor(){super(...arguments);this.changeEmitter=new L;this.onDidChangeTests=this.changeEmitter.event}get rootTests(){return this.roots}getMirroredTestDataById(e){return this.items.get(e)}getMirroredTestDataByReference(e){return this.items.get(e.id)}createItem(e,i){return{...e,revived:vo.toPlain(e.item),depth:i?i.depth+1:0,children:new Set}}createChangeCollector(){return new tN(this.changeEmitter)}}class nN{constructor(e){this.proxy=e}checkout(){if(!this.current){this.current=this.createObserverData()}const e=this.current;e.observers++;return{onDidChangeTest:e.tests.onDidChangeTests,get tests(){return[...e.tests.rootTests].map(i=>i.revived)},dispose:p0(()=>{if(--e.observers===0){this.proxy.$unsubscribeFromDiffs();this.current=void 0}})}}getMirroredTestDataByReference(e){return this.current?.tests.getMirroredTestDataByReference(e)}applyDiff(e){this.current?.tests.apply(e)}createObserverData(){const e=new iN({asCanonicalUri:i=>i});this.proxy.$subscribeToDiffs();return{observers:0,tests:e}}}const Qc=(t,e,i,n)=>{if(i){Object.assign(i,n)}else{e.$updateTestRunConfig(t.controllerId,t.profileId,n)}};class WC extends G4{#e;#t;#i;#n;#r;get label(){return this._label}set label(e){if(e!==this._label){this._label=e;Qc(this,this.#e,this.#n,{label:e})}}get supportsContinuousRun(){return this._supportsContinuousRun}set supportsContinuousRun(e){if(e!==this._supportsContinuousRun){this._supportsContinuousRun=e;Qc(this,this.#e,this.#n,{supportsContinuousRun:e})}}get isDefault(){return this.#t.has(this.profileId)}set isDefault(e){if(e!==this.isDefault){if(e){this.#t.add(this.profileId)}else{this.#t.delete(this.profileId)}Qc(this,this.#e,this.#n,{isDefault:e})}}get tag(){return this._tag}set tag(e){if(e?.id!==this._tag?.id){this._tag=e;Qc(this,this.#e,this.#n,{tag:e?cs.namespace(this.controllerId,e.id):null})}}get configureHandler(){return this._configureHandler}set configureHandler(e){if(e!==this._configureHandler){this._configureHandler=e;Qc(this,this.#e,this.#n,{hasConfigurationHandler:!!e})}}get onDidChangeDefault(){return Bt.chain(this.#i,e=>e.map(i=>i.get(this.controllerId)?.get(this.profileId)).filter(ln))}constructor(e,i,n,s,r,o,a,l,c,u=false,d=void 0,p=false){super(r,o,l);this._label=a;this.runHandler=c;this._tag=d;this._supportsContinuousRun=p;this.#e=e;this.#r=i;this.#t=n;this.#i=s;i.set(o,this);const f=bc.from(l);if(u){n.add(o)}this.#n={profileId:o,controllerId:r,tag:d?cs.namespace(this.controllerId,d.id):null,label:a,group:f,isDefault:u,hasConfigurationHandler:false,supportsContinuousRun:p};queueMicrotask(()=>{if(this.#n){this.#e.$publishTestRunProfile(this.#n);this.#n=void 0}})}dispose(){if(this.#r?.delete(this.profileId)){this.#r=void 0;this.#e.$removeTestProfile(this.controllerId,this.profileId)}this.#n=void 0}}function sN(t,e){for(let i=0;i<t.path.length;i++){const n=e.find(s=>s.id===t.path[i]);if(!n){return void 0}if(i===t.path.length-1){return n}e=n.children}return void 0}var pt;(function(t){t["Unknown"]="unknown";t["Env"]="env";t["Config"]="config";t["Command"]="command";t["Input"]="input";t["ExtensionInstallFolder"]="extensionInstallFolder";t["WorkspaceFolder"]="workspaceFolder";t["Cwd"]="cwd";t["WorkspaceFolderBasename"]="workspaceFolderBasename";t["UserHome"]="userHome";t["LineNumber"]="lineNumber";t["ColumnNumber"]="columnNumber";t["SelectedText"]="selectedText";t["File"]="file";t["FileWorkspaceFolder"]="fileWorkspaceFolder";t["FileWorkspaceFolderBasename"]="fileWorkspaceFolderBasename";t["RelativeFile"]="relativeFile";t["RelativeFileDirname"]="relativeFileDirname";t["FileDirname"]="fileDirname";t["FileExtname"]="fileExtname";t["FileBasename"]="fileBasename";t["FileBasenameNoExtension"]="fileBasenameNoExtension";t["FileDirnameBasename"]="fileDirnameBasename";t["ExecPath"]="execPath";t["ExecInstallFolder"]="execInstallFolder";t["PathSeparator"]="pathSeparator";t["PathSeparatorAlias"]="/"})(pt||(pt={}));const rN=Object.values(pt).filter(t=>typeof t==="string");class zi extends Ns{constructor(e,i){super(i);this.variable=e}}class ih{static{this.VARIABLE_LHS="${"}constructor(e){this.locations=new Map;this.newReplacementNotifiers=new Set;if(typeof e==="string"){this.stringRoot=true;this.root={value:e}}else{this.stringRoot=false;this.root=structuredClone(e)}}static parse(e){if(e instanceof ih){return e}const i=new ih(e);i.applyPlatformSpecificKeys();i.parseObject(i.root);return i}applyPlatformSpecificKeys(){const e=this.root;const i=Yi?"windows":Dn?"osx":Er?"linux":void 0;if(i&&e&&typeof e==="object"&&e.hasOwnProperty(i)){Object.keys(e[i]).forEach(n=>e[n]=e[i][n])}delete e.windows;delete e.osx;delete e.linux}parseVariable(e,i){if(e[i]!=="$"||e[i+1]!=="{"){return void 0}let n=i+2;let s=1;while(n<e.length){if(e[n]==="{"){s++}else if(e[n]==="}"){s--;if(s===0){break}}n++}if(s!==0){return void 0}const r=e.slice(i,n+1);const o=e.substring(i+2,n);const a=o.indexOf(":");if(a===-1){return{replacement:{id:r,name:o,inner:o},end:n}}return{replacement:{id:r,inner:o,name:o.slice(0,a),arg:o.slice(a+1)},end:n}}parseObject(e){if(typeof e!=="object"||e===null){return}if(Array.isArray(e)){for(let i=0;i<e.length;i++){const n=e[i];if(typeof n==="string"){this.parseString(e,i,n)}else{this.parseObject(n)}}return}for(const[i,n]of Object.entries(e)){if(typeof n==="string"){this.parseString(e,i,n)}else{this.parseObject(n)}}for(const[i]of Object.entries(e)){this.parseString(e,i,i,true)}}parseString(e,i,n,s,r){let o=0;while(o<n.length){const a=n.indexOf("${",o);if(a===-1){break}const l=this.parseVariable(n,a);if(l){o=l.end+1;if(r?.includes(l.replacement.id)){continue}const c=this.locations.get(l.replacement.id)||{locations:[],replacement:l.replacement};const u={object:e,propertyName:i,replaceKeyName:s};c.locations.push(u);this.locations.set(l.replacement.id,c);if(c.resolved){this._resolveAtLocation(l.replacement,u,c.resolved,r)}else{this.newReplacementNotifiers.forEach(d=>d(l.replacement))}}else{o=a+2}}}*unresolved(){const e=new Map;const i=n=>{e.set(n.id,n)};for(const n of this.locations.values()){if(n.resolved===void 0){e.set(n.replacement.id,n.replacement)}}this.newReplacementNotifiers.add(i);while(true){const n=_i.first(e);if(!n){break}const[s,r]=n;yield r;e.delete(s)}this.newReplacementNotifiers.delete(i)}resolved(){return _i.map(_i.filter(this.locations.values(),e=>!!e.resolved),e=>[e.replacement,e.resolved])}resolve(e,i){if(typeof i!=="object"){i={value:String(i)}}const n=this.locations.get(e.id);if(!n){return}n.resolved=i;if(i.value!==void 0){for(const s of n.locations||_i.empty()){this._resolveAtLocation(e,s,i)}}}_resolveAtLocation(e,{replaceKeyName:i,propertyName:n,object:s},r,o=[]){if(r.value===void 0){return}o.push(e.id);if(i&&typeof n==="string"){const a=s[n];const l=n.replaceAll(e.id,r.value);delete s[n];s[l]=a;this.parseString(s,l,r.value,true,o)}else{this.parseString(s,n,r.value,false,o);s[n]=s[n].replaceAll(e.id,r.value)}o.pop()}toObject(){if(this.stringRoot){return this.root.value}return this.root}}class oN{constructor(e,i,n,s){this._contributedVariables=new Map;this.resolvableVariables=new Set(rN);this._context=e;this._labelService=i;this._userHomePromise=n;if(s){this._envVariablesPromise=s.then(r=>{return this.prepareEnv(r)})}}prepareEnv(e){if(Yi){const i=Object.create(null);Object.keys(e).forEach(n=>{i[n.toLowerCase()]=e[n]});return i}return e}async resolveWithEnvironment(e,i,n){const s=ih.parse(n);for(const r of s.unresolved()){const o=await this.evaluateSingleVariable(r,i?.uri,e);if(o!==void 0){s.resolve(r,String(o))}}return s.toObject()}async resolveAsync(e,i){const n=ih.parse(i);for(const s of n.unresolved()){const r=await this.evaluateSingleVariable(s,e?.uri);if(r!==void 0){n.resolve(s,String(r))}}return n.toObject()}resolveWithInteractionReplace(e,i){throw new Error("resolveWithInteractionReplace not implemented.")}resolveWithInteraction(e,i){throw new Error("resolveWithInteraction not implemented.")}contributeVariable(e,i){if(this._contributedVariables.has(e)){throw new Error("Variable "+e+" is contributed twice.")}else{this.resolvableVariables.add(e);this._contributedVariables.set(e,i)}}fsPath(e){return this._labelService?this._labelService.getUriLabel(e,{noPrefix:true}):e.fsPath}async evaluateSingleVariable(e,i,n,s){const r={env:n!==void 0?this.prepareEnv(n):await this._envVariablesPromise,userHome:n!==void 0?void 0:await this._userHomePromise};const{name:o,arg:a}=e;const l=d=>{const p=this._context.getFilePath();if(p){return Kc(p)}throw new zi(d,h(12123,"Variable {0} can not be resolved. Please open an editor.",e.id))};const c=d=>{const p=l(d);if(this._context.getWorkspaceFolderPathForFile){const f=this._context.getWorkspaceFolderPathForFile();if(f){return Kc(f)}}throw new zi(d,h(12124,"Variable {0}: can not find workspace folder of '{1}'.",e.id,rn(p)))};const u=d=>{if(a){const p=this._context.getFolderUri(a);if(p){return p}throw new zi(d,h(12125,"Variable {0} can not be resolved. No such folder '{1}'.",d,a))}if(i){return i}if(this._context.getWorkspaceFolderCount()>1){throw new zi(d,h(12126,"Variable {0} can not be resolved in a multi folder workspace. Scope this variable using ':' and a workspace folder name.",d))}throw new zi(d,h(12127,"Variable {0} can not be resolved. Please open a folder.",d))};switch(o){case"env":if(a){if(r.env){const d=r.env[Yi?a.toLowerCase():a];if(tt(d)){return d}}return""}throw new zi(pt.Env,h(12128,"Variable {0} can not be resolved because no environment variable name is given.",e.id));case"config":if(a){const d=this._context.getConfigurationValue(i,a);if(Xt(d)){throw new zi(pt.Config,h(12129,"Variable {0} can not be resolved because setting '{1}' not found.",e.id,a))}if(Yt(d)){throw new zi(pt.Config,h(12130,"Variable {0} can not be resolved because '{1}' is a structured value.",e.id,a))}return d}throw new zi(pt.Config,h(12131,"Variable {0} can not be resolved because no settings name is given.",e.id));case"command":return this.resolveFromMap(pt.Command,e.id,a,s,"command");case"input":return this.resolveFromMap(pt.Input,e.id,a,s,"input");case"extensionInstallFolder":if(a){const d=await this._context.getExtension(a);if(!d){throw new zi(pt.ExtensionInstallFolder,h(12132,"Variable {0} can not be resolved because the extension {1} is not installed.",e.id,a))}return this.fsPath(d.extensionLocation)}throw new zi(pt.ExtensionInstallFolder,h(12133,"Variable {0} can not be resolved because no extension name is given.",e.id));default:{switch(o){case"workspaceRoot":case"workspaceFolder":{const d=u(pt.WorkspaceFolder);return d?Kc(this.fsPath(d)):void 0}case"cwd":{if(!i&&!a){return ql()}const d=u(pt.Cwd);return d?Kc(this.fsPath(d)):void 0}case"workspaceRootFolderName":case"workspaceFolderBasename":{const d=u(pt.WorkspaceFolderBasename);return d?Kc(rn(this.fsPath(d))):void 0}case"userHome":if(r.userHome){return r.userHome}throw new zi(pt.UserHome,h(12134,"Variable {0} can not be resolved. UserHome path is not defined",e.id));case"lineNumber":{const d=this._context.getLineNumber();if(d){return d}throw new zi(pt.LineNumber,h(12135,"Variable {0} can not be resolved. Make sure to have a line selected in the active editor.",e.id))}case"columnNumber":{const d=this._context.getColumnNumber();if(d){return d}throw new Error(h(12136,"Variable {0} can not be resolved. Make sure to have a column selected in the active editor.",e.id))}case"selectedText":{const d=this._context.getSelectedText();if(d){return d}throw new zi(pt.SelectedText,h(12137,"Variable {0} can not be resolved. Make sure to have some text selected in the active editor.",e.id))}case"file":return l(pt.File);case"fileWorkspaceFolder":return c(pt.FileWorkspaceFolder);case"fileWorkspaceFolderBasename":return rn(c(pt.FileWorkspaceFolderBasename));case"relativeFile":if(i||a){return Ku(this.fsPath(u(pt.RelativeFile)),l(pt.RelativeFile))}return l(pt.RelativeFile);case"relativeFileDirname":{const d=El(l(pt.RelativeFileDirname));if(i||a){const p=Ku(this.fsPath(u(pt.RelativeFileDirname)),d);return p.length===0?".":p}return d}case"fileDirname":return El(l(pt.FileDirname));case"fileExtname":return o_(l(pt.FileExtname));case"fileBasename":return rn(l(pt.FileBasename));case"fileBasenameNoExtension":{const d=rn(l(pt.FileBasenameNoExtension));return d.slice(0,d.length-o_(d).length)}case"fileDirnameBasename":return rn(El(l(pt.FileDirnameBasename)));case"execPath":{const d=this._context.getExecPath();if(d){return d}return e.id}case"execInstallFolder":{const d=this._context.getAppRoot();if(d){return d}return e.id}case"pathSeparator":case"/":return os;default:{try{return this.resolveFromMap(pt.Unknown,e.id,a,s,void 0)}catch{return e.id}}}}}}resolveFromMap(e,i,n,s,r){if(n&&s){const o=r===void 0?s[n]:s[r+":"+n];if(typeof o==="string"){return o}throw new zi(e,h(12138,"Variable {0} can not be resolved because the command has no value.",i))}return i}}const Dy=xe("IExtHostVariableResolverProvider");class aN extends oN{constructor(e,i,n,s,r,o,a){function l(){if(n){const c=n.activeEditor();if(c){return c.document.uri}const u=s.tabGroups.all.find(d=>d.isActive)?.activeTab;if(u!==void 0){if(u.input instanceof ug||u.input instanceof oy){return u.input.modified}else if(u.input instanceof ny||u.input instanceof ry||u.input instanceof sy){return u.input.uri}}}return void 0}super({getFolderUri:c=>{const u=o.folders.filter(d=>d.name===c);if(u&&u.length>0){return u[0].uri}return void 0},getWorkspaceFolderCount:()=>{return o.folders.length},getConfigurationValue:(c,u)=>{return r.getConfiguration(void 0,c).get(u)},getAppRoot:()=>{return ql()},getExecPath:()=>{return Gu["VSCODE_EXEC_PATH"]},getFilePath:()=>{const c=l();if(c){return jl(c.fsPath)}return void 0},getWorkspaceFolderPathForFile:()=>{if(i){const c=l();if(c){const u=i.getWorkspaceFolder(c);if(u){return jl(u.uri.fsPath)}}}return void 0},getSelectedText:()=>{if(n){const c=n.activeEditor();if(c&&!c.selection.isEmpty){return c.document.getText(c.selection)}}return void 0},getLineNumber:()=>{if(n){const c=n.activeEditor();if(c){return String(c.selection.end.line+1)}}return void 0},getColumnNumber:()=>{if(n){const c=n.activeEditor();if(c){return String(c.selection.end.character+1)}}return void 0},getExtension:c=>{return e.getExtension(c)}},void 0,a?Promise.resolve(a):void 0,Promise.resolve(Gu))}}let Tb=class M$ extends Ee{constructor(e,i,n,s,r){super();this.extensionService=e;this.workspaceService=i;this.editorService=n;this.configurationService=s;this.editorTabs=r;this._resolver=new Fn(async()=>{const o=await this.configurationService.getConfigProvider();const a=await this.workspaceService.getWorkspaceFolders2()||[];const l={folders:a};this._register(this.workspaceService.onDidChangeWorkspace(async c=>{l.folders=await this.workspaceService.getWorkspaceFolders2()||[]}));return new aN(this.extensionService,this.workspaceService,this.editorService,this.editorTabs,o,l,this.homeDir())})}getResolver(){return this._resolver.value}homeDir(){return void 0}};Tb=z([O(0,bo),O(1,Cr),O(2,Oc),O(3,Tr),O(4,_h)],Tb);const zC=xe("IExtHostDebugService");let Pb=class U$ extends Ee{get onDidStartDebugSession(){return this._onDidStartDebugSession.event}get onDidTerminateDebugSession(){return this._onDidTerminateDebugSession.event}get onDidChangeActiveDebugSession(){return this._onDidChangeActiveDebugSession.event}get activeDebugSession(){return this._activeDebugSession?.api}get onDidReceiveDebugSessionCustomEvent(){return this._onDidReceiveDebugSessionCustomEvent.event}get activeDebugConsole(){return this._activeDebugConsole.value}constructor(e,i,n,s,r,o,a,l){super();this._workspaceService=i;this._extensionService=n;this._configurationService=s;this._editorTabs=r;this._variableResolver=o;this._commands=a;this._testing=l;this._debugSessions=new Map;this._debugVisualizationTreeItemIdsCounter=0;this._debugVisualizationProviders=new Map;this._debugVisualizationTrees=new Map;this._debugVisualizationTreeItemIds=new WeakMap;this._debugVisualizationElements=new Map;this._visualizers=new Map;this._visualizerIdCounter=0;this._configProviderHandleCounter=0;this._configProviders=[];this._adapterFactoryHandleCounter=0;this._adapterFactories=[];this._trackerFactoryHandleCounter=0;this._trackerFactories=[];this._debugAdapters=new Map;this._debugAdaptersTrackers=new Map;this._onDidStartDebugSession=this._register(new L);this._onDidTerminateDebugSession=this._register(new L);this._onDidChangeActiveDebugSession=this._register(new L);this._onDidReceiveDebugSessionCustomEvent=this._register(new L);this._debugServiceProxy=e.getProxy(Y.MainThreadDebugService);this._onDidChangeBreakpoints=this._register(new L);this._onDidChangeActiveStackItem=this._register(new L);this._activeDebugConsole=new cN(this._debugServiceProxy);this._breakpoints=new Map;this._extensionService.getExtensionRegistry().then(c=>{this._register(c.onDidChange(u=>{this.registerAllDebugTypes(c)}));this.registerAllDebugTypes(c)});this._telemetryProxy=e.getProxy(Y.MainThreadTelemetry)}async $getVisualizerTreeItem(e,i){const n=this.hydrateVisualizationContext(i);if(!n){return void 0}const s=await this._debugVisualizationTrees.get(e)?.getTreeItem?.(n);return s?this.convertVisualizerTreeItem(e,s):void 0}registerDebugVisualizationTree(e,i,n){const s=Ze.toKey(e.identifier);const r=this.extensionVisKey(s,i);if(this._debugVisualizationProviders.has(r)){throw new Error(`A debug visualization provider with id '${i}' is already registered`)}this._debugVisualizationTrees.set(r,n);this._debugServiceProxy.$registerDebugVisualizerTree(r,!!n.editItem);return ge(()=>{this._debugServiceProxy.$unregisterDebugVisualizerTree(r);this._debugVisualizationTrees.delete(i)})}async $getVisualizerTreeItemChildren(e,i){const n=this._debugVisualizationElements.get(i)?.item;if(!n){return[]}const s=await this._debugVisualizationTrees.get(e)?.getChildren?.(n);return s?.map(r=>this.convertVisualizerTreeItem(e,r))||[]}async $editVisualizerTreeItem(e,i){const n=this._debugVisualizationElements.get(e);if(!n){return void 0}const s=await this._debugVisualizationTrees.get(n.provider)?.editItem?.(n.item,i);return this.convertVisualizerTreeItem(n.provider,s||n.item)}$disposeVisualizedTree(e){const i=this._debugVisualizationElements.get(e);if(!i){return}const n=[i.children];for(const s of n){if(s){for(const r of s){n.push(this._debugVisualizationElements.get(r)?.children);this._debugVisualizationElements.delete(r)}}}}convertVisualizerTreeItem(e,i){let n=this._debugVisualizationTreeItemIds.get(i);if(!n){n=this._debugVisualizationTreeItemIdsCounter++;this._debugVisualizationTreeItemIds.set(i,n);this._debugVisualizationElements.set(n,{provider:e,item:i})}return Fw.from(i,n)}asDebugSourceUri(e,i){const n=e;if(typeof n.sourceReference==="number"&&n.sourceReference>0){let s=`debug:${encodeURIComponent(n.path||"")}`;let r="?";if(i){s+=`${r}session=${encodeURIComponent(i.id)}`;r="&"}s+=`${r}ref=${n.sourceReference}`;return b.parse(s)}else if(n.path){return b.file(n.path)}else{throw new Error(`cannot create uri from DAP 'source' object; properties 'path' and 'sourceReference' are both missing.`)}}registerAllDebugTypes(e){const i=[];for(const n of e.getAllExtensionDescriptions()){if(n.contributes){const s=n.contributes["debuggers"];if(s&&s.length>0){for(const r of s){if(VL(r)){i.push(r.type)}}}}}this._debugServiceProxy.$registerDebugTypes(i)}get activeStackItem(){return this._activeStackItem}get onDidChangeActiveStackItem(){return this._onDidChangeActiveStackItem.event}get onDidChangeBreakpoints(){return this._onDidChangeBreakpoints.event}get breakpoints(){const e=[];this._breakpoints.forEach(i=>e.push(i));return e}async $resolveDebugVisualizer(e,i){const n=this._visualizers.get(e);if(!n){throw new Error(`No debug visualizer found with id '${e}'`)}let{v:s,provider:r,extensionId:o}=n;if(!s.visualization){s=await r.resolveDebugVisualization?.(s,i)||s;n.v=s}if(!s.visualization){throw new Error(`No visualization returned from resolveDebugVisualization in '${r}'`)}return this.serializeVisualization(o,s.visualization)}async $executeDebugVisualizerCommand(e){const i=this._visualizers.get(e);if(!i){throw new Error(`No debug visualizer found with id '${e}'`)}const n=i.v.visualization;if(n&&"command"in n){this._commands.executeCommand(n.command,...n.arguments||[])}}hydrateVisualizationContext(e){const i=this._debugSessions.get(e.sessionId);return i&&{session:i.api,variable:e.variable,containerId:e.containerId,frameId:e.frameId,threadId:e.threadId}}async $provideDebugVisualizers(e,i,n,s){const r=this.hydrateVisualizationContext(n);const o=this.extensionVisKey(e,i);const a=this._debugVisualizationProviders.get(o);if(!r||!a){return[]}const l=await a.provideDebugVisualization(r,s);if(!l){return[]}return l.map(c=>{const u=++this._visualizerIdCounter;this._visualizers.set(u,{v:c,provider:a,extensionId:e});const d=c.iconPath?this.getIconPathOrClass(c.iconPath):void 0;return{id:u,name:c.name,iconClass:d?.iconClass,iconPath:d?.iconPath,visualization:this.serializeVisualization(e,c.visualization)}})}$disposeDebugVisualizers(e){for(const i of e){this._visualizers.delete(i)}}registerDebugVisualizationProvider(e,i,n){if(!e.contributes?.debugVisualizers?.some(o=>o.id===i)){throw new Error(`Extensions may only call registerDebugVisualizationProvider() for renderers they contribute (got ${i})`)}const s=Ze.toKey(e.identifier);const r=this.extensionVisKey(s,i);if(this._debugVisualizationProviders.has(r)){throw new Error(`A debug visualization provider with id '${i}' is already registered`)}this._debugVisualizationProviders.set(r,n);this._debugServiceProxy.$registerDebugVisualizer(s,i);return ge(()=>{this._debugServiceProxy.$unregisterDebugVisualizer(s,i);this._debugVisualizationProviders.delete(i)})}addBreakpoints(e){const i=e.filter(r=>{const o=r.id;if(!this._breakpoints.has(o)){this._breakpoints.set(o,r);return true}return false});this.fireBreakpointChanges(i,[],[]);const n=[];const s=new Map;for(const r of i){if(r instanceof Jo){let o=s.get(r.location.uri.toString());if(!o){o={type:"sourceMulti",uri:r.location.uri,lines:[]};s.set(r.location.uri.toString(),o);n.push(o)}o.lines.push({id:r.id,enabled:r.enabled,condition:r.condition,hitCondition:r.hitCondition,logMessage:r.logMessage,line:r.location.range.start.line,character:r.location.range.start.character,mode:r.mode})}else if(r instanceof Xo){n.push({type:"function",id:r.id,enabled:r.enabled,hitCondition:r.hitCondition,logMessage:r.logMessage,condition:r.condition,functionName:r.functionName,mode:r.mode})}}return this._debugServiceProxy.$registerBreakpoints(n)}removeBreakpoints(e){const i=e.filter(o=>this._breakpoints.delete(o.id));this.fireBreakpointChanges([],i,[]);const n=i.filter(o=>o instanceof Jo).map(o=>o.id);const s=i.filter(o=>o instanceof Xo).map(o=>o.id);const r=i.filter(o=>o instanceof Kp).map(o=>o.id);return this._debugServiceProxy.$unregisterBreakpoints(n,s,r)}startDebugging(e,i,n){const s=n.testRun&&this._testing.getMetadataForRun(n.testRun);return this._debugServiceProxy.$startDebugging(e?e.uri:void 0,i,{parentSessionID:n.parentSession?n.parentSession.id:void 0,lifecycleManagedByParent:n.lifecycleManagedByParent,repl:n.consoleMode===tg.MergeWithParent?"mergeWithParent":"separate",noDebug:n.noDebug,compact:n.compact,suppressSaveBeforeStart:n.suppressSaveBeforeStart,testRun:s&&{runId:s.runId,taskId:s.taskId},suppressDebugStatusbar:n.suppressDebugStatusbar??n.debugUI?.simple,suppressDebugToolbar:n.suppressDebugToolbar??n.debugUI?.simple,suppressDebugView:n.suppressDebugView??n.debugUI?.simple})}stopDebugging(e){return this._debugServiceProxy.$stopDebugging(e?e.id:void 0)}registerDebugConfigurationProvider(e,i,n){if(!i){return new qe(()=>{})}const s=this._configProviderHandleCounter++;this._configProviders.push({type:e,handle:s,provider:i});this._debugServiceProxy.$registerDebugConfigurationProvider(e,n,!!i.provideDebugConfigurations,!!i.resolveDebugConfiguration,!!i.resolveDebugConfigurationWithSubstitutedVariables,s);return new qe(()=>{this._configProviders=this._configProviders.filter(r=>r.provider!==i);this._debugServiceProxy.$unregisterDebugConfigurationProvider(s)})}registerDebugAdapterDescriptorFactory(e,i,n){if(!n){return new qe(()=>{})}if(!this.definesDebugType(e,i)){throw new Error(`a DebugAdapterDescriptorFactory can only be registered from the extension that defines the '${i}' debugger.`)}if(this.getAdapterDescriptorFactoryByType(i)){throw new Error(`a DebugAdapterDescriptorFactory can only be registered once per a type.`)}const s=this._adapterFactoryHandleCounter++;this._adapterFactories.push({type:i,handle:s,factory:n});this._debugServiceProxy.$registerDebugAdapterDescriptorFactory(i,s);return new qe(()=>{this._adapterFactories=this._adapterFactories.filter(r=>r.factory!==n);this._debugServiceProxy.$unregisterDebugAdapterDescriptorFactory(s)})}registerDebugAdapterTrackerFactory(e,i){if(!i){return new qe(()=>{})}const n=this._trackerFactoryHandleCounter++;this._trackerFactories.push({type:e,handle:n,factory:i});return new qe(()=>{this._trackerFactories=this._trackerFactories.filter(s=>s.factory!==i)})}async $runInTerminal(e,i){return Promise.resolve(void 0)}async $substituteVariables(e,i){let n;const s=await this.getFolder(e);if(s){n={uri:s.uri,name:s.name,index:s.index,toResource:()=>{throw new Error("Not implemented")}}}const r=await this._variableResolver.getResolver();return r.resolveAsync(n,i)}createDebugAdapter(e,i){if(e instanceof bd){return new dN(e.implementation)}return void 0}createSignService(){return void 0}async $startDASession(e,i){const n=this;const s=await this.getSession(i);return this.getAdapterDescriptor(this.getAdapterDescriptorFactoryByType(s.type),s).then(r=>{if(!r){throw new Error(`Couldn't find a debug adapter descriptor for debug type '${s.type}' (extension might have failed to activate)`)}const o=this.createDebugAdapter(r,s);if(!o){throw new Error(`Couldn't create a debug adapter for type '${s.type}'.`)}const a=o;this._debugAdapters.set(e,a);return this.getDebugAdapterTrackers(s).then(l=>{if(l){this._debugAdaptersTrackers.set(e,l)}a.onMessage(async c=>{if(c.type==="request"&&c.command==="handshake"){const u=c;const d={type:"response",seq:0,command:u.command,request_seq:u.seq,success:true};if(!this._signService){this._signService=this.createSignService()}try{if(this._signService){const p=await this._signService.sign(u.arguments.value);d.body={signature:p};a.sendResponse(d)}else{throw new Error("no signer")}}catch(p){d.success=false;d.message=p.message;a.sendResponse(d)}}else{if(l&&l.onDidSendMessage){l.onDidSendMessage(c)}try{c=KL(c,true)}catch(u){const d=c.type+"_"+(c.command??c.event??"");this._telemetryProxy.$publicLog2("debugProtocolMessageError",{type:d,from:s.type});throw u}n._debugServiceProxy.$acceptDAMessage(e,c)}});a.onError(c=>{if(l&&l.onError){l.onError(c)}this._debugServiceProxy.$acceptDAError(e,c.name,c.message,c.stack)});a.onExit(c=>{if(l&&l.onExit){l.onExit(c??void 0,void 0)}this._debugServiceProxy.$acceptDAExit(e,c??void 0,void 0)});if(l&&l.onWillStartSession){l.onWillStartSession()}return a.startSession()})})}$sendDAMessage(e,i){i=GL(i);const n=this._debugAdaptersTrackers.get(e);if(n&&n.onWillReceiveMessage){n.onWillReceiveMessage(i)}const s=this._debugAdapters.get(e);s?.sendMessage(i)}$stopDASession(e){const i=this._debugAdaptersTrackers.get(e);this._debugAdaptersTrackers.delete(e);if(i&&i.onWillStopSession){i.onWillStopSession()}const n=this._debugAdapters.get(e);this._debugAdapters.delete(e);if(n){return n.stopSession()}else{return Promise.resolve(void 0)}}$acceptBreakpointsDelta(e){const i=[];const n=[];const s=[];if(e.added){for(const r of e.added){const o=r.id;if(o&&!this._breakpoints.has(o)){let a;if(r.type==="function"){a=new Xo(r.functionName,r.enabled,r.condition,r.hitCondition,r.logMessage,r.mode)}else if(r.type==="data"){a=new Kp(r.label,r.dataId,r.canPersist,r.enabled,r.hitCondition,r.condition,r.logMessage,r.mode)}else{const l=b.revive(r.uri);a=new Jo(new kn(l,new Ve(r.line,r.character)),r.enabled,r.condition,r.hitCondition,r.logMessage,r.mode)}p3(a,o);this._breakpoints.set(o,a);i.push(a)}}}if(e.removed){for(const r of e.removed){const o=this._breakpoints.get(r);if(o){this._breakpoints.delete(r);n.push(o)}}}if(e.changed){for(const r of e.changed){if(r.id){const o=this._breakpoints.get(r.id);if(o){if(o instanceof Xo&&r.type==="function"){const a=o;a.enabled=r.enabled;a.condition=r.condition;a.hitCondition=r.hitCondition;a.logMessage=r.logMessage;a.functionName=r.functionName}else if(o instanceof Jo&&r.type==="source"){const a=o;a.enabled=r.enabled;a.condition=r.condition;a.hitCondition=r.hitCondition;a.logMessage=r.logMessage;a.location=new kn(b.revive(r.uri),new Ve(r.line,r.character))}s.push(o)}}}}this.fireBreakpointChanges(i,n,s)}async $acceptStackFrameFocus(e){let i;if(e){const n=await this.getSession(e.sessionId);if(e.kind==="thread"){i=new V4(n.api,e.threadId)}else{i=new B4(n.api,e.threadId,e.frameId)}}this._activeStackItem=i;this._onDidChangeActiveStackItem.fire(this._activeStackItem)}$provideDebugConfigurations(e,i,n){return Ci(async()=>{const s=this.getConfigProviderByHandle(e);if(!s){throw new Error("no DebugConfigurationProvider found")}if(!s.provideDebugConfigurations){throw new Error("DebugConfigurationProvider has no method provideDebugConfigurations")}const r=await this.getFolder(i);return s.provideDebugConfigurations(r,n)}).then(s=>{if(!s){throw new Error("nothing returned from DebugConfigurationProvider.provideDebugConfigurations")}return s})}$resolveDebugConfiguration(e,i,n,s){return Ci(async()=>{const r=this.getConfigProviderByHandle(e);if(!r){throw new Error("no DebugConfigurationProvider found")}if(!r.resolveDebugConfiguration){throw new Error("DebugConfigurationProvider has no method resolveDebugConfiguration")}const o=await this.getFolder(i);return r.resolveDebugConfiguration(o,n,s)})}$resolveDebugConfigurationWithSubstitutedVariables(e,i,n,s){return Ci(async()=>{const r=this.getConfigProviderByHandle(e);if(!r){throw new Error("no DebugConfigurationProvider found")}if(!r.resolveDebugConfigurationWithSubstitutedVariables){throw new Error("DebugConfigurationProvider has no method resolveDebugConfigurationWithSubstitutedVariables")}const o=await this.getFolder(i);return r.resolveDebugConfigurationWithSubstitutedVariables(o,n,s)})}async $provideDebugAdapter(e,i){const n=this.getAdapterDescriptorFactoryByHandle(e);if(!n){return Promise.reject(new Error("no adapter descriptor factory found for handle"))}const s=await this.getSession(i);return this.getAdapterDescriptor(n,s).then(r=>{if(!r){throw new Error(`Couldn't find a debug adapter descriptor for debug type '${s.type}'`)}return this.convertToDto(r)})}async $acceptDebugSessionStarted(e){const i=await this.getSession(e);this._onDidStartDebugSession.fire(i.api)}async $acceptDebugSessionTerminated(e){const i=await this.getSession(e);if(i){this._onDidTerminateDebugSession.fire(i.api);this._debugSessions.delete(i.id)}}async $acceptDebugSessionActiveChanged(e){this._activeDebugSession=e?await this.getSession(e):void 0;this._onDidChangeActiveDebugSession.fire(this._activeDebugSession?.api)}async $acceptDebugSessionNameChanged(e,i){const n=await this.getSession(e);n?._acceptNameChanged(i)}async $acceptDebugSessionCustomEvent(e,i){const n=await this.getSession(e);const s={session:n.api,event:i.event,body:i.body};this._onDidReceiveDebugSessionCustomEvent.fire(s)}convertToDto(e){if(e instanceof Qp){return this.convertExecutableToDto(e)}else if(e instanceof wd){return this.convertServerToDto(e)}else if(e instanceof Jp){return this.convertPipeServerToDto(e)}else if(e instanceof bd){return this.convertImplementationToDto(e)}else{throw new Error("convertToDto unexpected type")}}convertExecutableToDto(e){return{type:"executable",command:e.command,args:e.args,options:e.options}}convertServerToDto(e){return{type:"server",port:e.port,host:e.host}}convertPipeServerToDto(e){return{type:"pipeServer",path:e.path}}convertImplementationToDto(e){return{type:"implementation"}}getAdapterDescriptorFactoryByType(e){const i=this._adapterFactories.filter(n=>n.type===e);if(i.length>0){return i[0].factory}return void 0}getAdapterDescriptorFactoryByHandle(e){const i=this._adapterFactories.filter(n=>n.handle===e);if(i.length>0){return i[0].factory}return void 0}getConfigProviderByHandle(e){const i=this._configProviders.filter(n=>n.handle===e);if(i.length>0){return i[0].provider}return void 0}definesDebugType(e,i){if(e.contributes){const n=e.contributes["debuggers"];if(n&&n.length>0){for(const s of n){if(s.label&&s.type){if(s.type===i){return true}}}}}return false}getDebugAdapterTrackers(e){const i=e.configuration;const n=i.type;const s=this._trackerFactories.filter(r=>r.type===n||r.type==="*").map(r=>Ci(()=>r.factory.createDebugAdapterTracker(e.api)).then(o=>o,o=>null));return Promise.race([Promise.all(s).then(r=>{const o=ei(r);if(o.length>0){return new uN(o)}return void 0}),new Promise(r=>setTimeout(()=>r(void 0),1e3))]).catch(r=>{return void 0})}async getAdapterDescriptor(e,i){const n=i.configuration.debugServer;if(typeof n==="number"){return Promise.resolve(new wd(n))}if(e){const r=await this._extensionService.getExtensionRegistry();return Ci(()=>e.createDebugAdapterDescriptor(i.api,this.daExecutableFromPackage(i,r))).then(o=>{if(o){return o}return void 0})}const s=await this._extensionService.getExtensionRegistry();return Promise.resolve(this.daExecutableFromPackage(i,s))}daExecutableFromPackage(e,i){return void 0}fireBreakpointChanges(e,i,n){if(e.length>0||i.length>0||n.length>0){this._onDidChangeBreakpoints.fire(Object.freeze({added:e,removed:i,changed:n}))}}async getSession(e){if(e){if(typeof e==="string"){const i=this._debugSessions.get(e);if(i){return i}}else{let i=this._debugSessions.get(e.id);if(!i){const n=await this.getFolder(e.folderUri);const s=e.parent?this._debugSessions.get(e.parent):void 0;i=new lN(this._debugServiceProxy,e.id,e.type,e.name,n,e.configuration,s?.api);this._debugSessions.set(i.id,i);this._debugServiceProxy.$sessionCached(i.id)}return i}}throw new Error("cannot find session")}getFolder(e){if(e){const i=b.revive(e);return this._workspaceService.resolveWorkspaceFolder(i)}return Promise.resolve(void 0)}extensionVisKey(e,i){return`${e}\0${i}`}serializeVisualization(e,i){if(!i){return void 0}if("title"in i&&"command"in i){return{type:vp.Command}}if("treeId"in i){return{type:vp.Tree,id:`${e}\0${i.treeId}`}}throw new Error("Unsupported debug visualization type")}getIconPathOrClass(e){const i=this.getIconUris(e);let n;let s;if("id"in i){s=Zt.asClassName(i)}else{n=i}return{iconPath:n,iconClass:s}}getIconUris(e){if(e instanceof Vi){return{id:e.id}}const i=typeof e==="object"&&"dark"in e?e.dark:e;const n=typeof e==="object"&&"light"in e?e.light:e;return{dark:typeof i==="string"?b.file(i):i,light:typeof n==="string"?b.file(n):n}}};Pb=z([O(0,st),O(1,Cr),O(2,bo),O(3,Tr),O(4,_h),O(5,Dy),O(6,Ba),O(7,qm)],Pb);class lN{constructor(e,i,n,s,r,o,a){this._debugServiceProxy=e;this._id=i;this._type=n;this._name=s;this._workspaceFolder=r;this._configuration=o;this._parentSession=a}get api(){const e=this;return this.apiSession??=Object.freeze({id:e._id,type:e._type,get name(){return e._name},set name(i){e._name=i;e._debugServiceProxy.$setDebugSessionName(e._id,i)},parentSession:e._parentSession,workspaceFolder:e._workspaceFolder,configuration:e._configuration,customRequest(i,n){return e._debugServiceProxy.$customDebugAdapterRequest(e._id,i,n)},getDebugProtocolBreakpoint(i){return e._debugServiceProxy.$getDebugProtocolBreakpoint(e._id,i.id)}})}get id(){return this._id}get type(){return this._type}_acceptNameChanged(e){this._name=e}get configuration(){return this._configuration}}class cN{constructor(e){this.value=Object.freeze({append(i){e.$appendDebugConsole(i)},appendLine(i){this.append(i+"\n")}})}}class uN{constructor(e){this.trackers=e}onWillStartSession(){this.trackers.forEach(e=>e.onWillStartSession?e.onWillStartSession():void 0)}onWillReceiveMessage(e){this.trackers.forEach(i=>i.onWillReceiveMessage?i.onWillReceiveMessage(e):void 0)}onDidSendMessage(e){this.trackers.forEach(i=>i.onDidSendMessage?i.onDidSendMessage(e):void 0)}onWillStopSession(){this.trackers.forEach(e=>e.onWillStopSession?e.onWillStopSession():void 0)}onError(e){this.trackers.forEach(i=>i.onError?i.onError(e):void 0)}onExit(e,i){this.trackers.forEach(n=>n.onExit?n.onExit(e,i):void 0)}}class dN extends BL{constructor(e){super();this.implementation=e;e.onDidSendMessage(i=>{this.acceptMessage(i)})}startSession(){return Promise.resolve(void 0)}sendMessage(e){this.implementation.handleMessage(e)}stopSession(){this.implementation.dispose();return Promise.resolve(void 0)}}let Ab=class $$ extends Pb{constructor(e,i,n,s,r,o,a,l){super(e,i,n,s,r,o,a,l)}};Ab=z([O(0,st),O(1,Cr),O(2,bo),O(3,Tr),O(4,_h),O(5,Dy),O(6,Ba),O(7,qm)],Ab);function hN(t){return"uri"in t&&"ranges"in t&&"preview"in t}function fN(t){return t.folderOptions.map(e=>({folder:e.folder,excludes:e.excludes.map(i=>typeof i==="string"?i:i.pattern),includes:e.includes,useGlobalIgnoreFiles:e.useIgnoreFiles.global,useIgnoreFiles:e.useIgnoreFiles.local,useParentIgnoreFiles:e.useIgnoreFiles.parent,followSymlinks:e.followSymlinks,maxResults:t.maxResults,session:t.session}))}class qC{constructor(e){this.provider=e}provideFileSearchResults(e,i,n){const s=async()=>{const r=fN(i);return Promise.all(r.map(o=>this.provider.provideFileSearchResults({pattern:e},o,n)))};return s().then(r=>ei(r).flat())}}function pN(t){return t.folderOptions.map(e=>({folder:e.folder,excludes:e.excludes.map(i=>typeof i==="string"?i:i.pattern),includes:e.includes,useGlobalIgnoreFiles:e.useIgnoreFiles.global,useIgnoreFiles:e.useIgnoreFiles.local,useParentIgnoreFiles:e.useIgnoreFiles.parent,followSymlinks:e.followSymlinks,maxResults:t.maxResults,previewOptions:gN(t.previewOptions),maxFileSize:t.maxFileSize,encoding:e.encoding,afterContext:t.surroundingContext,beforeContext:t.surroundingContext}))}function gN(t){return{matchLines:t?.matchLines??Hw.matchLines,charsPerLine:t?.charsPerLine??Hw.charsPerLine}}function mN(t){if(hN(t)){const e=Sn(t.ranges).map((i,n)=>{const s=Sn(t.preview.matches);const r=s[n];return{sourceRange:i,previewRange:r}});return new ro(t.uri,e,t.preview.text)}else{return new cy(t.uri,t.text,t.lineNumber)}}class _N{constructor(e){this.provider=e}provideTextSearchResults(e,i,n,s){const r=l=>{if(!vN(l)){return}n.report(mN(l))};const o=async()=>{return ei(await Promise.all(pN(i).map(l=>this.provider.provideTextSearchResults(e,l,{report:c=>r(c)},s)))).reduce((l,c)=>({limitHit:l.limitHit||c.limitHit}),{limitHit:false})};const a=o();return a.then(l=>{return{limitHit:l.limitHit,message:ei(Sn(l.message))}})}}function vN(t){if(wN(t)){if(Array.isArray(t.ranges)){if(!Array.isArray(t.preview.matches)){console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same type.");return false}if(t.preview.matches.length!==t.ranges.length){console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same length.");return false}}else{if(Array.isArray(t.preview.matches)){console.warn("INVALID - A text search provider match's`ranges` and`matches` properties must have the same length.");return false}}}return true}function wN(t){return!!t.preview}class jC extends xn{constructor(e,i,n=()=>false){const s=new kI(n,()=>false);super(s);const r=new Ft;e.forEach((o,a)=>{const l=o.folder.with({query:"",fragment:""});if(r.has(l)){r.get(l).push({fq:o,i:a})}else{r.set(l,[{fq:o,i:a}])}});r.forEach((o,a)=>{const l=new Map;for(const c of o){const u=i(c.fq,c.i);l.set(this.encodeKey(c.fq.folder),u)}super.set(a,l)})}findQueryFragmentAwareSubstr(e){const i=super.findSubstr(e.with({query:"",fragment:""}));if(!i){return void 0}const n=this.encodeKey(e);return i.get(n)}forEachFolderQueryInfo(e){return this.forEach(i=>i.forEach(n=>e(n)))}encodeKey(e){let i="";if(e.query){i+=e.query}if(e.fragment){i+="#"+e.fragment}return i}}class bN{constructor(e,i,n){this.config=e;this.provider=i;this.sessionLifecycle=n;this.isLimitHit=false;this.resultCount=0;this.isCanceled=false;this.filePattern=e.filePattern;this.includePattern=e.includePattern&&Yl(e.includePattern);this.maxResults=e.maxResults||void 0;this.exists=e.exists;this.activeCancellationTokens=new Set;this.globalExcludePattern=e.excludePattern&&Yl(e.excludePattern)}cancel(){this.isCanceled=true;this.activeCancellationTokens.forEach(e=>e.cancel());this.activeCancellationTokens=new Set}search(e){const i=this.config.folderQueries||[];return new Promise((n,s)=>{const r=o=>{this.resultCount++;e(o)};if(this.isCanceled){return n({limitHit:this.isLimitHit})}if(this.config.extraFileResources){this.config.extraFileResources.forEach(o=>{const a=o.toString();const l=rn(a);if(this.globalExcludePattern&&this.globalExcludePattern(a,l)){return}this.matchFile(r,{base:o,basename:l})})}this.doSearch(i,r).then(o=>{n({limitHit:this.isLimitHit,stats:o||void 0})},o=>{s(new Error(Rc(o)))})})}async doSearch(e,i){const n=new Ot;const s=e.map(u=>this.getSearchOptionsForFolder(u));const r=this.provider instanceof qC?this.sessionLifecycle?.tokenSource.token:this.sessionLifecycle?.obj;const o={folderOptions:s,maxResults:this.config.maxResults??hC,session:r};const a=u=>{const d=new mC(this.config,u);const p=!d.hasSiblingExcludeClauses();return{queryTester:d,noSiblingsClauses:p,folder:u.folder,tree:this.initDirectoryTree()}};const l=new jC(e,a);let c;try{this.activeCancellationTokens.add(n);c=xr.create();const u=await this.provider.provideFileSearchResults(this.config.filePattern||"",o,n.token);const d=c.elapsed();const p=xr.create();if(this.isCanceled&&!this.isLimitHit){return null}if(u){u.forEach(f=>{const m=l.findQueryFragmentAwareSubstr(f);const v=ct.relative(m.folder.path,f.path);if(m.noSiblingsClauses){const y=rn(f.path);this.matchFile(i,{base:m.folder,relativePath:v,basename:y});return}this.addDirectoryEntries(m.tree,m.folder,v,i)})}if(this.isCanceled&&!this.isLimitHit){return null}l.forEachFolderQueryInfo(f=>{this.matchDirectoryTree(f.tree,f.queryTester,i)});return{providerTime:d,postProcessTime:p.elapsed()}}finally{n.dispose();this.activeCancellationTokens.delete(n)}}getSearchOptionsForFolder(e){const i=Hl(this.config.includePattern,e.includePattern);let n=e.excludePattern?.map(r=>({folder:r.folder,patterns:Hl(this.config.excludePattern,r.pattern)}));if(!n?.length){n=[{folder:void 0,patterns:Hl(this.config.excludePattern,void 0)}]}const s=vC(n);return{folder:e.folder,excludes:s,includes:i,useIgnoreFiles:{local:!e.disregardIgnoreFiles,parent:!e.disregardParentIgnoreFiles,global:!e.disregardGlobalIgnoreFiles},followSymlinks:!e.ignoreSymlinks}}initDirectoryTree(){const e={rootEntries:[],pathToEntries:Object.create(null)};e.pathToEntries["."]=e.rootEntries;return e}addDirectoryEntries({pathToEntries:e},i,n,s){if(n===this.filePattern){const o=rn(this.filePattern);this.matchFile(s,{base:i,relativePath:this.filePattern,basename:o})}function r(o){const a=rn(o);const l=El(o);let c=e[l];if(!c){c=e[l]=[];r(l)}c.push({base:i,relativePath:o,basename:a})}r(n)}matchDirectoryTree({rootEntries:e,pathToEntries:i},n,s){const r=this;const o=this.filePattern;function a(l){const c=H3(()=>l.map(u=>u.basename));for(let u=0,d=l.length;u<d;u++){const p=l[u];const{relativePath:f,basename:m}=p;if(n.matchesExcludesSync(f,m,o!==m?c:void 0)){continue}const v=i[f];if(v){a(v)}else{if(f===o){continue}r.matchFile(s,p)}if(r.isLimitHit){break}}}a(e)}matchFile(e,i){if(!this.includePattern||i.relativePath&&this.includePattern(i.relativePath,i.basename)){if(this.exists||this.maxResults&&this.resultCount>=this.maxResults){this.isLimitHit=true;this.cancel()}if(!this.isLimitHit){e(i)}}}}class yN{constructor(){this._obj=new Object;this.tokenSource=new Ot}get obj(){if(this._obj){return this._obj}throw new Error("Session object has been dereferenced.")}cancel(){this.tokenSource.cancel();this._obj=void 0}}class ky{constructor(){this.sessions=new Map}static{this.BATCH_SIZE=512}fileSearch(e,i,n,s){const r=this.getSessionTokenSource(e.cacheKey);const o=new bN(e,i,r);let a=0;const l=c=>{a+=c.length;n(c.map(u=>this.rawMatchToSearchItem(u)))};return this.doSearch(o,ky.BATCH_SIZE,l,s).then(c=>{return{limitHit:c.limitHit,stats:c.stats?{fromCache:false,type:"fileSearchProvider",resultCount:a,detailStats:c.stats}:void 0,messages:[]}})}clearCache(e){this.sessions.get(e)?.cancel();this.sessions.delete(e)}getSessionTokenSource(e){if(!e){return void 0}if(!this.sessions.has(e)){this.sessions.set(e,new yN)}return this.sessions.get(e)}rawMatchToSearchItem(e){if(e.relativePath){return{resource:ki(e.base,e.relativePath)}}else{return{resource:e.base}}}doSearch(e,i,n,s){const r=s.onCancellationRequested(()=>{e.cancel()});const o=l=>{if(l){a.push(l);if(i>0&&a.length>=i){n(a);a=[]}}};let a=[];return e.search(o).then(l=>{if(a.length){n(a)}r.dispose();return l},l=>{if(a.length){n(a)}r.dispose();return Promise.reject(l)})}}class TD{constructor(e,i,n){this.queryProviderPair=e;this.fileUtils=i;this.processType=n;this.collector=null;this.isLimitHit=false;this.resultCount=0}get query(){return this.queryProviderPair.query}search(e,i,n){const s=this.query.folderQueries||[];const r=new Ot(i);return new Promise((o,a)=>{this.collector=new EN(e);let l=false;const c=(u,d)=>{if(u instanceof $w){return}if(l){return}if(!this.isLimitHit){const p=this.resultSize(u);if(u instanceof ro&&typeof this.query.maxResults==="number"&&this.resultCount+p>this.query.maxResults){this.isLimitHit=true;l=true;r.cancel();u=this.trimResultToSize(u,this.query.maxResults-this.resultCount)}const f=this.resultSize(u);this.resultCount+=f;const m=u instanceof ro;if(f>0||!m){this.collector.add(u,d)}}};this.doSearch(s,c,r.token,n).then(u=>{r.dispose();this.collector.flush();o({limitHit:this.isLimitHit||u?.limitHit,messages:this.getMessagesFromResults(u),stats:{type:this.processType}})},u=>{r.dispose();const d=Rc(u);a(new Error(d))})})}getMessagesFromResults(e){if(!e?.message){return[]}if(Array.isArray(e.message)){return e.message}return[e.message]}resultSize(e){if(e instanceof ro){return Array.isArray(e.ranges)?e.ranges.length:1}else{return 0}}trimResultToSize(e,i){return new ro(e.uri,e.ranges.slice(0,i),e.previewText)}async doSearch(e,i,n,s){const r=new jC(e,(d,p)=>{const f=new mC(this.query,d);return{queryTester:f,folder:d.folder,folderIdx:p}},()=>true);const o=[];const a={report:d=>{if(d instanceof $w){s?.(d)}else{if(d.uri===void 0){throw Error("Text search result URI is undefined. Please check provider implementation.")}const p=r.findQueryFragmentAwareSubstr(d.uri);const f=p.folder.scheme===ae.file?$3(()=>{return this.fileUtils.readdir(vm(d.uri))}):void 0;const m=mI(p.folder,d.uri);if(m){const v=p.queryTester.includedInQuery(m,rn(m),f);if(po(v)){o.push(v.then(y=>{if(y){i(d,p.folderIdx)}}))}else if(v){i(d,p.folderIdx)}}}}};const l=e.map(d=>this.getSearchOptionsForFolder(d));const c={folderOptions:l,maxFileSize:this.query.maxFileSize,maxResults:this.query.maxResults??hC,previewOptions:this.query.previewOptions??Hw,surroundingContext:this.query.surroundingContext??0};if("usePCRE2"in this.query){c.usePCRE2=this.query.usePCRE2}let u;if(this.queryProviderPair.query.type===va.aiText){u=await this.queryProviderPair.provider.provideAITextSearchResults(this.queryProviderPair.query.contentPattern,c,a,n)}else{u=await this.queryProviderPair.provider.provideTextSearchResults(xN(this.queryProviderPair.query.contentPattern),c,a,n)}if(o.length){await Promise.all(o)}return u}getSearchOptionsForFolder(e){const i=Hl(this.query.includePattern,e.includePattern);let n=e.excludePattern?.map(o=>({folder:o.folder,patterns:Hl(this.query.excludePattern,o.pattern)}));if(!n||n.length===0){n=[{folder:void 0,patterns:Hl(this.query.excludePattern,void 0)}]}const s=vC(n);const r={folder:b.from(e.folder),excludes:s,includes:i,useIgnoreFiles:{local:!e.disregardIgnoreFiles,parent:!e.disregardParentIgnoreFiles,global:!e.disregardGlobalIgnoreFiles},followSymlinks:!e.ignoreSymlinks,encoding:(e.fileEncoding&&this.fileUtils.toCanonicalName(e.fileEncoding))??""};return r}}function xN(t){return{isCaseSensitive:t.isCaseSensitive||false,isRegExp:t.isRegExp||false,isWordMatch:t.isWordMatch||false,isMultiline:t.isMultiline||false,pattern:t.pattern}}class EN{constructor(e){this._onResult=e;this._currentFolderIdx=-1;this._currentFileMatch=null;this._batchedCollector=new om(512,i=>this.sendItems(i))}add(e,i){if(this._currentFileMatch&&(this._currentFolderIdx!==i||!Sl(this._currentUri,e.uri))){this.pushToCollector();this._currentFileMatch=null}if(!this._currentFileMatch){this._currentFolderIdx=i;this._currentFileMatch={resource:e.uri,results:[]}}this._currentFileMatch.results.push(SN(e))}pushToCollector(){const e=this._currentFileMatch&&this._currentFileMatch.results?this._currentFileMatch.results.length:0;this._batchedCollector.addItem(this._currentFileMatch,e)}flush(){this.pushToCollector();this._batchedCollector.flush()}sendItems(e){this._onResult(e)}}function SN(t){if(t instanceof ro){return{previewText:t.previewText,rangeLocations:t.ranges.map(e=>({preview:{startLineNumber:e.previewRange.start.line,startColumn:e.previewRange.start.character,endLineNumber:e.previewRange.end.line,endColumn:e.previewRange.end.character},source:{startLineNumber:e.sourceRange.start.line,startColumn:e.sourceRange.start.character,endLineNumber:e.sourceRange.end.line,endColumn:e.sourceRange.end.character}}))}}else{return{text:t.text,lineNumber:t.lineNumber}}}class om{static{this.TIMEOUT=4e3}static{this.START_BATCH_AFTER_COUNT=50}constructor(e,i){this.maxBatchSize=e;this.cb=i;this.totalNumberCompleted=0;this.batch=[];this.batchSize=0}addItem(e,i){if(!e){return}this.addItemToBatch(e,i)}addItems(e,i){if(!e){return}this.addItemsToBatch(e,i)}addItemToBatch(e,i){this.batch.push(e);this.batchSize+=i;this.onUpdate()}addItemsToBatch(e,i){this.batch=this.batch.concat(e);this.batchSize+=i;this.onUpdate()}onUpdate(){if(this.totalNumberCompleted<om.START_BATCH_AFTER_COUNT){this.flush()}else if(this.batchSize>=this.maxBatchSize){this.flush()}else if(!this.timeoutHandle){this.timeoutHandle=setTimeout(()=>{this.flush()},om.TIMEOUT)}}flush(){if(this.batchSize){this.totalNumberCompleted+=this.batchSize;this.cb(this.batch);this.batch=[];this.batchSize=0;if(this.timeoutHandle){clearTimeout(this.timeoutHandle);this.timeoutHandle=0}}}}const GC=xe("IExtHostSearch");let Rb=class H${constructor(e,i,n){this.extHostRpc=e;this._uriTransformer=i;this._logService=n;this._proxy=this.extHostRpc.getProxy(Y.MainThreadSearch);this._handlePool=0;this._textSearchProvider=new Map;this._textSearchUsedSchemes=new Set;this._aiTextSearchProvider=new Map;this._aiTextSearchUsedSchemes=new Set;this._fileSearchProvider=new Map;this._fileSearchUsedSchemes=new Set;this._fileSearchManager=new ky}_transformScheme(e){return this._uriTransformer.transformOutgoingScheme(e)}registerTextSearchProviderOld(e,i){if(this._textSearchUsedSchemes.has(e)){throw new Error(`a text search provider for the scheme '${e}' is already registered`)}this._textSearchUsedSchemes.add(e);const n=this._handlePool++;this._textSearchProvider.set(n,new _N(i));this._proxy.$registerTextSearchProvider(n,this._transformScheme(e));return ge(()=>{this._textSearchUsedSchemes.delete(e);this._textSearchProvider.delete(n);this._proxy.$unregisterProvider(n)})}registerTextSearchProvider(e,i){if(this._textSearchUsedSchemes.has(e)){throw new Error(`a text search provider for the scheme '${e}' is already registered`)}this._textSearchUsedSchemes.add(e);const n=this._handlePool++;this._textSearchProvider.set(n,i);this._proxy.$registerTextSearchProvider(n,this._transformScheme(e));return ge(()=>{this._textSearchUsedSchemes.delete(e);this._textSearchProvider.delete(n);this._proxy.$unregisterProvider(n)})}registerAITextSearchProvider(e,i){if(this._aiTextSearchUsedSchemes.has(e)){throw new Error(`an AI text search provider for the scheme '${e}'is already registered`)}this._aiTextSearchUsedSchemes.add(e);const n=this._handlePool++;this._aiTextSearchProvider.set(n,i);this._proxy.$registerAITextSearchProvider(n,this._transformScheme(e));return ge(()=>{this._aiTextSearchUsedSchemes.delete(e);this._aiTextSearchProvider.delete(n);this._proxy.$unregisterProvider(n)})}registerFileSearchProviderOld(e,i){if(this._fileSearchUsedSchemes.has(e)){throw new Error(`a file search provider for the scheme '${e}' is already registered`)}this._fileSearchUsedSchemes.add(e);const n=this._handlePool++;this._fileSearchProvider.set(n,new qC(i));this._proxy.$registerFileSearchProvider(n,this._transformScheme(e));return ge(()=>{this._fileSearchUsedSchemes.delete(e);this._fileSearchProvider.delete(n);this._proxy.$unregisterProvider(n)})}registerFileSearchProvider(e,i){if(this._fileSearchUsedSchemes.has(e)){throw new Error(`a file search provider for the scheme '${e}' is already registered`)}this._fileSearchUsedSchemes.add(e);const n=this._handlePool++;this._fileSearchProvider.set(n,i);this._proxy.$registerFileSearchProvider(n,this._transformScheme(e));return ge(()=>{this._fileSearchUsedSchemes.delete(e);this._fileSearchProvider.delete(n);this._proxy.$unregisterProvider(n)})}$provideFileSearchResults(e,i,n,s){const r=O1(n);const o=this._fileSearchProvider.get(e);if(o){return this._fileSearchManager.fileSearch(r,o,a=>{this._proxy.$handleFileMatch(e,i,a.map(l=>l.resource))},s)}else{throw new Error("unknown provider: "+e)}}async doInternalFileSearchWithCustomCallback(e,i,n){return{messages:[]}}$clearCache(e){this._fileSearchManager.clearCache(e);return Promise.resolve(void 0)}$provideTextSearchResults(e,i,n,s){const r=this._textSearchProvider.get(e);if(!r||!r.provideTextSearchResults){throw new Error(`Unknown Text Search Provider ${e}`)}const o=O1(n);const a=this.createTextSearchManager(o,r);return a.search(l=>this._proxy.$handleTextMatch(e,i,l),s)}$provideAITextSearchResults(e,i,n,s){const r=this._aiTextSearchProvider.get(e);if(!r||!r.provideAITextSearchResults){throw new Error(`Unknown AI Text Search Provider ${e}`)}const o=O1(n);const a=this.createAITextSearchManager(o,r);return a.search(l=>this._proxy.$handleTextMatch(e,i,l),s,l=>this._proxy.$handleKeywordResult(e,i,l))}$enableExtensionHostSearch(){}async $getAIName(e){const i=this._aiTextSearchProvider.get(e);if(!i||!i.provideAITextSearchResults){return void 0}return i.name??"AI"}createTextSearchManager(e,i){return new TD({query:e,provider:i},{readdir:n=>Promise.resolve([]),toCanonicalName:n=>n},"textSearchProvider")}createAITextSearchManager(e,i){return new TD({query:e,provider:i},{readdir:n=>Promise.resolve([]),toCanonicalName:n=>n},"aiTextSearchProvider")}};Rb=z([O(0,st),O(1,wm),O(2,at)],Rb);function O1(t){return{...t,...{folderQueries:t.folderQueries&&t.folderQueries.map(DN),extraFileResources:t.extraFileResources&&t.extraFileResources.map(e=>b.revive(e))}}}function DN(t){return ti(t)}var Lb;let Nb=class B${static{Lb=this}static{this.InitialState={focused:true,active:true}}getState(){const e=this._state;return{get focused(){return e.focused},get active(){return e.active}}}constructor(e,i){this._onDidChangeWindowState=new L;this.onDidChangeWindowState=this._onDidChangeWindowState.event;this._state=Lb.InitialState;if(e.handle){this._nativeHandle=Tf(e.handle).buffer}this._proxy=i.getProxy(Y.MainThreadWindow);this._proxy.$getInitialState().then(({isFocused:n,isActive:s})=>{this.onDidChangeWindowProperty("focused",n);this.onDidChangeWindowProperty("active",s)})}get nativeHandle(){return this._nativeHandle}$onDidChangeActiveNativeWindowHandle(e){this._nativeHandle=e?Tf(e).buffer:void 0}$onDidChangeWindowFocus(e){this.onDidChangeWindowProperty("focused",e)}$onDidChangeWindowActive(e){this.onDidChangeWindowProperty("active",e)}onDidChangeWindowProperty(e,i){if(i===this._state[e]){return}this._state={...this._state,[e]:i};this._onDidChangeWindowState.fire(this._state)}openUri(e,i){let n;if(typeof e==="string"){n=e;try{e=b.parse(e)}catch(s){return Promise.reject(`Invalid uri - '${e}'`)}}if(Qu(e.scheme)){return Promise.reject("Invalid scheme - cannot be empty")}else if(e.scheme===ae.command){return Promise.reject(`Invalid scheme '${e.scheme}'`)}return this._proxy.$openUri(e,n,i)}async asExternalUri(e,i){if(Qu(e.scheme)){return Promise.reject("Invalid scheme - cannot be empty")}const n=await this._proxy.$asExternalUri(e,i);return b.from(n)}};Nb=Lb=z([O(0,Ai),O(1,st)],Nb);const KC=xe("IExtHostWindow");const QC=xe("IExtHostTerminalShellIntegration");let Ob=class V$ extends Ee{constructor(e,i){super();this._extHostTerminalService=i;this._activeShellIntegrations=new Map;this._onDidChangeTerminalShellIntegration=new L;this.onDidChangeTerminalShellIntegration=this._onDidChangeTerminalShellIntegration.event;this._onDidStartTerminalShellExecution=new L;this.onDidStartTerminalShellExecution=this._onDidStartTerminalShellExecution.event;this._onDidEndTerminalShellExecution=new L;this.onDidEndTerminalShellExecution=this._onDidEndTerminalShellExecution.event;this._proxy=e.getProxy(Y.MainThreadTerminalShellIntegration);this._register(ge(()=>{for(const[n,s]of this._activeShellIntegrations){s.dispose()}this._activeShellIntegrations.clear()}))}$shellIntegrationChange(e){const i=this._extHostTerminalService.getTerminalById(e);if(!i){return}const n=i.value;let s=this._activeShellIntegrations.get(e);if(!s){s=new kN(i.value,this._onDidStartTerminalShellExecution);this._activeShellIntegrations.set(e,s);s.store.add(i.onWillDispose(()=>this._activeShellIntegrations.get(e)?.dispose()));s.store.add(s.onDidRequestShellExecution(r=>this._proxy.$executeCommand(e,r)));s.store.add(s.onDidRequestEndExecution(r=>this._onDidEndTerminalShellExecution.fire(r)));s.store.add(s.onDidRequestChangeShellIntegration(r=>this._onDidChangeTerminalShellIntegration.fire(r)));i.shellIntegration=s.value}this._onDidChangeTerminalShellIntegration.fire({terminal:n,shellIntegration:s.value})}$shellExecutionStart(e,i,n,s,r){if(!this._activeShellIntegrations.has(e)){this.$shellIntegrationChange(e)}const o={value:i,confidence:n,isTrusted:s};this._activeShellIntegrations.get(e)?.startShellExecution(o,b.revive(r))}$shellExecutionEnd(e,i,n,s,r){const o={value:i,confidence:n,isTrusted:s};this._activeShellIntegrations.get(e)?.endShellExecution(o,r)}$shellExecutionData(e,i){this._activeShellIntegrations.get(e)?.emitData(i)}$shellEnvChange(e,i,n,s){this._activeShellIntegrations.get(e)?.setEnv(i,n,s)}$cwdChange(e,i){this._activeShellIntegrations.get(e)?.setCwd(b.revive(i))}$closeTerminal(e){this._activeShellIntegrations.get(e)?.dispose();this._activeShellIntegrations.delete(e)}};Ob=z([O(0,st),O(1,Nc)],Ob);class kN extends Ee{get currentExecution(){return this._currentExecution}constructor(e,i){super();this._terminal=e;this._onDidStartTerminalShellExecution=i;this._pendingExecutions=[];this.store=this._register(new Ie);this._onDidRequestChangeShellIntegration=this._register(new L);this.onDidRequestChangeShellIntegration=this._onDidRequestChangeShellIntegration.event;this._onDidRequestShellExecution=this._register(new L);this.onDidRequestShellExecution=this._onDidRequestShellExecution.event;this._onDidRequestEndExecution=this._register(new L);this.onDidRequestEndExecution=this._onDidRequestEndExecution.event;this._onDidRequestNewExecution=this._register(new L);this.onDidRequestNewExecution=this._onDidRequestNewExecution.event;const n=this;this.value={get cwd(){return n._cwd},get env(){if(!n._env){return void 0}return Object.freeze({isTrusted:n._env.isTrusted,value:Object.freeze({...n._env.value})})},executeCommand(s,r){let o=s;if(r){for(const c of r){const u=!c.match(/["'`]/)&&c.match(/\s/);if(u){o+=` "${c}"`}else{o+=` ${c}`}}}n._onDidRequestShellExecution.fire(o);const a={value:o,confidence:md.High,isTrusted:true};const l=n.requestNewShellExecution(a,n._cwd).value;return l}}}requestNewShellExecution(e,i){const n=new PD(e,i??this._cwd);const s=wf(e.value);if(s.length>1){this._currentExecutionProperties={isMultiLine:true,unresolvedCommandLines:wf(e.value)}}this._pendingExecutions.push(n);this._onDidRequestNewExecution.fire(e.value);return n}startShellExecution(e,i){if(this._pendingEndingExecution){this._onDidRequestEndExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:this._pendingEndingExecution.value,exitCode:void 0});this._pendingEndingExecution=void 0}if(this._currentExecution){if(this._currentExecutionProperties?.isMultiLine&&this._currentExecutionProperties.unresolvedCommandLines){const s=AD(this._currentExecutionProperties.unresolvedCommandLines,e);if(s){this._currentExecutionProperties.unresolvedCommandLines=s.unresolvedCommandLines;return}}this._currentExecution.endExecution(void 0);this._currentExecution.flush();this._onDidRequestEndExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:this._currentExecution.value,exitCode:void 0})}let n;if(e.confidence===md.High){for(const[s,r]of this._pendingExecutions.entries()){if(r.value.commandLine.value===e.value){n=r;this._currentExecutionProperties={isMultiLine:false,unresolvedCommandLines:void 0};n=r;this._pendingExecutions.splice(s,1);break}else{const o=AD(wf(r.value.commandLine.value),e);if(o){this._currentExecutionProperties={isMultiLine:true,unresolvedCommandLines:o.unresolvedCommandLines};n=r;this._pendingExecutions.splice(s,1);break}}}}else{n=this._pendingExecutions.shift()}if(!n){n=new PD(e,i??this._cwd)}this._currentExecution=n;this._onDidStartTerminalShellExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:this._currentExecution.value})}emitData(e){this.currentExecution?.emitData(e)}endShellExecution(e,i){if(this._currentExecutionProperties?.isMultiLine){if(this._currentExecutionProperties.unresolvedCommandLines&&this._currentExecutionProperties.unresolvedCommandLines.length>0){return}}if(this._currentExecution){const n=this._currentExecutionProperties?.isMultiLine?this._currentExecution.value.commandLine:e;this._currentExecution.endExecution(n);const s=this._currentExecution;this._pendingEndingExecution=s;this._currentExecution=void 0;s.flush().then(()=>{if(this._pendingEndingExecution===s){this._onDidRequestEndExecution.fire({terminal:this._terminal,shellIntegration:this.value,execution:s.value,exitCode:i});this._pendingEndingExecution=void 0}})}}setEnv(e,i,n){const s={};for(let r=0;r<e.length;r++){s[e[r]]=i[r]}this._env={value:s,isTrusted:n};this._fireChangeEvent()}setCwd(e){let i=false;if(b.isUri(this._cwd)){i=!b.isUri(e)||this._cwd.toString()!==e.toString()}else if(this._cwd!==e){i=true}if(i){this._cwd=e;this._fireChangeEvent()}}_fireChangeEvent(){this._onDidRequestChangeShellIntegration.fire({terminal:this._terminal,shellIntegration:this.value})}}class PD{constructor(e,i){this._commandLine=e;this.cwd=i;this._isEnded=false;const n=this;this.value={get commandLine(){return n._commandLine},get cwd(){return n.cwd},read(){return n._createDataStream()}}}_createDataStream(){if(!this._dataStream){if(this._isEnded){return Ei.EMPTY}this._dataStream=new IN}return this._dataStream.createIterable()}emitData(e){if(!this._isEnded){this._dataStream?.emitData(e)}}endExecution(e){if(e){this._commandLine=e}this._dataStream?.endExecution();this._isEnded=true}async flush(){if(this._dataStream){await this._dataStream.flush();this._dataStream.dispose();this._dataStream=void 0}}}class IN extends Ee{constructor(){super(...arguments);this._iterables=[];this._emitters=[]}createIterable(){if(!this._barrier){this._barrier=new xs}const e=this._barrier;const i=new Ei(async n=>{this._emitters.push(n);await e.wait()});this._iterables.push(i);return i}emitData(e){for(const i of this._emitters){i.emitOne(e)}}endExecution(){this._barrier?.open()}async flush(){await Promise.all(this._iterables.map(e=>e.toPromise()))}}function wf(t){return t.split("\n").map(e=>e.trim()).filter(e=>e.length>0)}function AD(t,e){if(t.length===0){return false}const i=[...t];const n=wf(e.value);if(i&&i.length>0){while(i.length>0){if(i[0]!==n[0]){break}i.shift();n.shift()}if(n.length===0){return{unresolvedCommandLines:i}}}return false}var qr;(function(t){t[t["CR"]=13]="CR";t[t["LF"]=10]="LF";t[t["COLON"]=58]="COLON";t[t["SPACE"]=32]="SPACE"})(qr||(qr={}));class F1{constructor(e){this.dataBuffer="";this.eventTypeBuffer="";this.buffer=[];this.endedOnCR=false;this.onEventHandler=e;this.decoder=new TextDecoder("utf-8")}getLastEventId(){return this.lastEventIdBuffer}getReconnectionTime(){return this.reconnectionTime}feed(e){if(e.length===0){return}let i=0;if(this.endedOnCR&&e[0]===qr.LF){i++}this.endedOnCR=false;while(i<e.length){const n=e.indexOf(qr.CR,i);const s=e.indexOf(qr.LF,i);const r=n===-1?s:s===-1?n:Math.min(n,s);if(r===-1){break}let o="";for(const a of this.buffer){o+=this.decoder.decode(a,{stream:true})}o+=this.decoder.decode(e.subarray(i,r));this.processLine(o);this.buffer.length=0;i=r+(e[r]===qr.CR&&e[r+1]===qr.LF?2:1)}if(i<e.length){this.buffer.push(e.subarray(i))}else{this.endedOnCR=e[e.length-1]===qr.CR}}processLine(e){if(!e.length){this.dispatchEvent();return}if(e.startsWith(":")){return}let i;let n;const s=e.indexOf(":");if(s===-1){i=e;n=""}else{i=e.substring(0,s);n=e.substring(s+1);if(n.startsWith(" ")){n=n.substring(1)}}this.processField(i,n)}processField(e,i){switch(e){case"event":this.eventTypeBuffer=i;break;case"data":this.dataBuffer+=i;this.dataBuffer+="\n";break;case"id":if(!i.includes("\0")){this.currentEventId=this.lastEventIdBuffer=i}else{this.currentEventId=void 0}break;case"retry":if(/^\d+$/.test(i)){this.reconnectionTime=parseInt(i,10)}break}}dispatchEvent(){if(this.dataBuffer===""){this.dataBuffer="";this.eventTypeBuffer="";return}if(this.dataBuffer.endsWith("\n")){this.dataBuffer=this.dataBuffer.substring(0,this.dataBuffer.length-1)}const e={type:this.eventTypeBuffer||"message",data:this.dataBuffer};if(this.currentEventId!==void 0){e.id=this.currentEventId}if(this.reconnectionTime!==void 0){e.retry=this.reconnectionTime}this.onEventHandler(e);this.reset()}reset(){this.dataBuffer="";this.eventTypeBuffer="";this.currentEventId=void 0}}const Fb=xe("IExtHostMpcService");let Mb=class W$ extends Ee{constructor(e){super();this._initialProviderPromises=new Set;this._sseEventSources=this._register(new Cf);this._unresolvedMcpServers=new Map;this._proxy=e.getProxy(Y.MainThreadMcp)}$startMcp(e,i){this._startMcp(e,Md.fromSerialized(i))}_startMcp(e,i){if(i.type===Ta.HTTP){this._sseEventSources.set(e,new CN(e,i,this._proxy));return}throw new Error("not implemented")}$stopMcp(e){if(this._sseEventSources.has(e)){this._sseEventSources.deleteAndDispose(e);this._proxy.$onDidChangeState(e,{state:or.Kind.Stopped})}}$sendMessage(e,i){this._sseEventSources.get(e)?.send(i)}async $waitForInitialCollectionProviders(){await Promise.all(this._initialProviderPromises)}async $resolveMcpLaunch(e,i){const n=this._unresolvedMcpServers.get(e);if(!n){return}const s=n.servers.find(o=>o.label===i);if(!s){return}if(!n.provider.resolveMcpServerDefinition){return Lu.from(s)}const r=await n.provider.resolveMcpServerDefinition(s,bt.None);return r?Lu.from(r):void 0}registerMcpConfigurationProvider(e,i,n){const s=new Ie;const r=e.contributes?.modelContextServerCollections?.find(c=>c.id===i);if(!r){throw new Error(`MCP configuration providers must be registered in the contributes.modelContextServerCollections array within your package.json, but "${i}" was not`)}const o={id:P3(e.identifier,i),isTrustedByDefault:true,label:r?.label??e.displayName??e.name,scope:qt.WORKSPACE,canResolveLaunch:typeof n.resolveMcpServerDefinition==="function",extensionId:e.identifier.value};const a=async()=>{const c=await n.provideMcpServerDefinitions(bt.None);this._unresolvedMcpServers.set(o.id,{servers:c??[],provider:n});const u=[];for(const d of c??[]){let p=Ze.toKey(e.identifier)+"/"+d.label;if(u.some(f=>f.id===p)){let f=2;while(u.some(m=>m.id===p+f)){f++}p=p+f}u.push({id:p,label:d.label,cacheNonce:d.version,launch:Lu.from(d)})}this._proxy.$upsertMcpCollection(o,u)};s.add(ge(()=>{this._unresolvedMcpServers.delete(o.id);this._proxy.$deleteMcpCollection(o.id)}));if(n.onDidChangeServerDefinitions){s.add(n.onDidChangeServerDefinitions(a))}if(n.onDidChange){s.add(n.onDidChange(a))}const l=new Promise(c=>{setTimeout(()=>a().finally(()=>{this._initialProviderPromises.delete(l);c()}),0)});this._initialProviderPromises.add(l);return s}};Mb=z([O(0,st)],Mb);var pn;(function(t){t[t["Unknown"]=0]="Unknown";t[t["Http"]=1]="Http";t[t["SSE"]=2]="SSE"})(pn||(pn={}));class CN extends Ee{constructor(e,i,n){super();this._id=e;this._launch=i;this._proxy=n;this._requestSequencer=new CP;this._postEndpoint=new Fs;this._mode={value:pn.Unknown};this._cts=new Ot;this._abortCtrl=new AbortController;this._register(ge(()=>{this._abortCtrl.abort();this._cts.dispose(true)}));this._proxy.$onDidChangeState(this._id,{state:or.Kind.Running})}async send(e){try{await this._requestSequencer.queue(()=>{if(this._mode.value===pn.SSE){return this._sendLegacySSE(this._mode.endpoint,e)}else{return this._sendStreamableHttp(e,this._mode.value===pn.Http?this._mode.sessionId:void 0)}})}catch(i){const n=`Error sending message to ${this._launch.uri}: ${String(i)}`;this._proxy.$onDidChangeState(this._id,{state:or.Kind.Error,message:n})}}async _sendStreamableHttp(e,i){const n=new TextEncoder().encode(e);const s={...Object.fromEntries(this._launch.headers),"Content-Type":"application/json","Content-Length":String(n.length),Accept:"text/event-stream, application/json"};if(i){s["Mcp-Session-Id"]=i}const r=await fetch(this._launch.uri.toString(true),{method:"POST",signal:this._abortCtrl.signal,headers:s,body:n});const o=this._mode.value===pn.Unknown;const a=r.headers.get("Mcp-Session-Id");if(a){this._mode={value:pn.Http,sessionId:a}}if(this._mode.value===pn.Unknown&&r.status>=400&&r.status<500){this._log(Be.Info,`${r.status} status sending message to ${this._launch.uri}, will attempt to fall back to legacy SSE`);const l=await this._attachSSE();if(l){this._mode={value:pn.SSE,endpoint:l};await this._sendLegacySSE(l,e)}return}if(r.status>=300){const l=this._mode.value===pn.Http&&!!this._mode.sessionId;this._proxy.$onDidChangeState(this._id,{state:or.Kind.Error,message:`${r.status} status sending message to ${this._launch.uri}: ${await this._getErrText(r)}`+l?`; will retry with new session ID`:"",shouldRetry:l});return}if(this._mode.value===pn.Unknown){this._mode={value:pn.Http,sessionId:void 0}}if(o){this._attachStreamableBackchannel()}this._handleSuccessfulStreamableHttp(r)}async _handleSuccessfulStreamableHttp(e){if(e.status===202){return}switch(e.headers.get("Content-Type")?.toLowerCase()){case"text/event-stream":{const i=new F1(n=>{if(n.type==="message"){this._proxy.$onDidReceiveMessage(this._id,n.data)}});try{await this._doSSE(i,e)}catch(n){this._log(Be.Warning,`Error reading SSE stream: ${String(n)}`)}break}case"application/json":this._proxy.$onDidReceiveMessage(this._id,await e.text());break;default:{const i=await e.text();if(TN(i)){this._proxy.$onDidReceiveMessage(this._id,i)}else{this._log(Be.Warning,`Unexpected ${e.status} response for request: ${i}`)}}}}async _attachStreamableBackchannel(){let e;for(let i=0;!this._store.isDisposed;i++){await Ts(Math.min(i*1e3,3e4),this._cts.token);let n;try{const r={...Object.fromEntries(this._launch.headers),"Accept":"text/event-stream"};if(this._mode.value===pn.Http&&this._mode.sessionId!==void 0){r["Mcp-Session-Id"]=this._mode.sessionId}if(e){r["Last-Event-ID"]=e}n=await fetch(this._launch.uri.toString(true),{method:"GET",signal:this._abortCtrl.signal,headers:r})}catch(r){this._log(Be.Info,`Error connecting to ${this._launch.uri} for async notifications, will retry`);continue}if(n.status>=400){this._log(Be.Debug,`${n.status} status connecting to ${this._launch.uri} for async notifications; they will be disabled: ${await this._getErrText(n)}`);return}i=0;const s=new F1(r=>{if(r.type==="message"){this._proxy.$onDidReceiveMessage(this._id,r.data)}if(r.id){e=r.id}});try{await this._doSSE(s,n)}catch(r){this._log(Be.Info,`Error reading from async stream, we will reconnect: ${r}`)}}}async _attachSSE(){const e=new Fs;let i;try{i=await fetch(this._launch.uri.toString(true),{method:"GET",signal:this._abortCtrl.signal,headers:{...Object.fromEntries(this._launch.headers),"Accept":"text/event-stream"}});if(i.status>=300){this._proxy.$onDidChangeState(this._id,{state:or.Kind.Error,message:`${i.status} status connecting to ${this._launch.uri} as SSE: ${await this._getErrText(i)}`});return}}catch(s){this._proxy.$onDidChangeState(this._id,{state:or.Kind.Error,message:`Error connecting to ${this._launch.uri} as SSE: ${s}`});return}const n=new F1(s=>{if(s.type==="message"){this._proxy.$onDidReceiveMessage(this._id,s.data)}else if(s.type==="endpoint"){e.complete(new URL(s.data,this._launch.uri.toString(true)).toString())}});this._register(ge(()=>e.cancel()));this._doSSE(n,i).catch(s=>{this._proxy.$onDidChangeState(this._id,{state:or.Kind.Error,message:`Error reading SSE stream: ${String(s)}`})});return e.p}async _sendLegacySSE(e,i){const n=new TextEncoder().encode(i);const s=await fetch(e,{method:"POST",signal:this._abortCtrl.signal,headers:{...Object.fromEntries(this._launch.headers),"Content-Type":"application/json","Content-Length":String(n.length)},body:n});if(s.status>=300){this._log(Be.Warning,`${s.status} status sending message to ${this._postEndpoint}: ${await this._getErrText(s)}`)}}async _doSSE(e,i){if(!i.body){return}const n=i.body.getReader();let s;do{try{s=await vI(n.read(),this._cts.token)}catch(r){n.cancel();if(this._store.isDisposed){return}else{throw r}}if(s.value){e.feed(s.value)}}while(!s.done)}_log(e,i){if(!this._store.isDisposed){this._proxy.$onDidPublishLog(this._id,e,i)}}async _getErrText(e){try{return await e.text()}catch{return e.statusText}}}function TN(t){try{JSON.parse(t);return true}catch(e){return false}}xt(by,lb,_t.Delayed);xt(Cc,Yg,_t.Delayed);xt(zm,_b,_t.Delayed);xt(Ba,nb,_t.Eager);xt(_y,ob,_t.Eager);xt(vy,ab,_t.Eager);xt(Tr,jw,_t.Eager);xt(Hm,Qw,_t.Eager);xt(qm,Cb,_t.Eager);xt(zC,Ab,_t.Eager);xt($C,pb,_t.Eager);xt(Oc,mb,_t.Eager);xt(yy,cb,_t.Eager);xt(Tc,u7,_t.Eager);xt(UC,fb,_t.Delayed);xt(GC,Rb,_t.Eager);xt(fy,EC,_t.Eager);xt(HC,Db,_t.Eager);xt(Nc,rb,_t.Eager);xt(QC,Ob,_t.Eager);xt(gy,eb,_t.Eager);xt(KC,Nb,_t.Eager);xt(Cr,Ww,_t.Eager);xt(wy,RC,_t.Eager);xt(_h,kb,_t.Eager);xt(Dy,Tb,_t.Eager);xt(Fb,Mb,_t.Eager);function JC(t,e,i,n,s,r){if(Array.isArray(t)){let o=0;for(const a of t){const l=JC(a,e,i,n,s,r);if(l===10){return l}if(l>o){o=l}}return o}else if(typeof t==="string"){if(t==="*"){return 5}else if(t===i){return 10}else{return 0}}else if(t){const{language:o,pattern:a,scheme:l,hasAccessToAllModels:c,notebookType:u}=t;if(u&&s){e=s}let d=0;if(l){if(l===e.scheme){d=10}else if(l==="*"){d=5}else{return 0}}if(o){if(o===i){d=10}else if(o==="*"){d=Math.max(d,5)}else{return 0}}if(u){if(u===r){d=10}else if(u==="*"&&r!==void 0){d=Math.max(d,5)}else{return 0}}if(a){let p;if(typeof a==="string"){p=a}else{p={...a,base:jl(a.base)}}if(p===e.fsPath||Su(p,e.fsPath)){d=10}else{return 0}}return d}else{return 0}}function XC(t){if(typeof t==="string"){return false}else if(Array.isArray(t)){return t.some(XC)}else{return!!t.notebookType}}var Ub;(function(t){t[t["None"]=0]="None";t[t["Indent"]=1]="Indent";t[t["IndentOutdent"]=2]="IndentOutdent";t[t["Outdent"]=3]="Outdent"})(Ub||(Ub={}));var $b;(function(t){t[t["Complete"]=100]="Complete";t[t["Partial"]=50]="Partial";t[t["None"]=0]="None"})($b||($b={}));class PN{constructor(e){this._relatedInformationProviders=new Map;this._nextHandle=0;this._proxy=e.getProxy(Y.MainThreadAiRelatedInformation)}async $provideAiRelatedInformation(e,i,n){if(this._relatedInformationProviders.size===0){throw new Error("No related information providers registered")}const s=this._relatedInformationProviders.get(e);if(!s){throw new Error("related information provider not found")}const r=await s.provideRelatedInformation(i,n)??[];return r}getRelatedInformation(e,i,n){return this._proxy.$getAiRelatedInformation(i,n)}registerRelatedInformationProvider(e,i,n){const s=this._nextHandle;this._nextHandle++;this._relatedInformationProviders.set(s,n);this._proxy.$registerAiRelatedInformationProvider(s,i);return new qe(()=>{this._proxy.$unregisterAiRelatedInformationProvider(s);this._relatedInformationProviders.delete(s)})}}var nh;(function(t){t[t["Full"]=1]="Full";t[t["Delta"]=2]="Delta"})(nh||(nh={}));function YC(t){for(let e=0,i=t.length;e<i;e+=4){const n=t[e+0];const s=t[e+1];const r=t[e+2];const o=t[e+3];t[e+0]=o;t[e+1]=r;t[e+2]=s;t[e+3]=n}}function AN(t){const e=new Uint8Array(t.buffer,t.byteOffset,t.length*4);if(!eI()){YC(e)}return ue.wrap(e)}function RN(t){const e=t.buffer;if(!eI()){YC(e)}if(e.byteOffset%4===0){return new Uint32Array(e.buffer,e.byteOffset,e.length/4)}else{const i=new Uint8Array(e.byteLength);i.set(e);return new Uint32Array(i.buffer,i.byteOffset,i.length/4)}}function Hb(t){const e=new Uint32Array(LN(t));let i=0;e[i++]=t.id;if(t.type==="full"){e[i++]=nh.Full;e[i++]=t.data.length;e.set(t.data,i);i+=t.data.length}else{e[i++]=nh.Delta;e[i++]=t.deltas.length;for(const n of t.deltas){e[i++]=n.start;e[i++]=n.deleteCount;if(n.data){e[i++]=n.data.length;e.set(n.data,i);i+=n.data.length}else{e[i++]=0}}}return AN(e)}function LN(t){let e=0;e+=1+1;if(t.type==="full"){e+=1+t.data.length}else{e+=1;e+=(1+1+1)*t.deltas.length;for(const i of t.deltas){if(i.data){e+=i.data.length}}}return e}function RD(t){const e=RN(t);let i=0;const n=e[i++];const s=e[i++];if(s===nh.Full){const a=e[i++];const l=e.subarray(i,i+a);i+=a;return{id:n,type:"full",data:l}}const r=e[i++];const o=[];for(let a=0;a<r;a++){const l=e[i++];const c=e[i++];const u=e[i++];let d;if(u>0){d=e.subarray(i,i+u);i+=u}o[a]={start:l,deleteCount:c,data:d}}return{id:n,type:"delta",deltas:o}}const NN=[new Te("vscode.executeDocumentHighlights","_executeDocumentHighlights","Execute document highlight provider.",[q.Uri,q.Position],new Se("A promise that resolves to an array of DocumentHighlight-instances.",Bn(fc.to))),new Te("vscode.executeDocumentSymbolProvider","_executeDocumentSymbolProvider","Execute document symbol provider.",[q.Uri],new Se("A promise that resolves to an array of SymbolInformation and DocumentSymbol instances.",(t,e)=>{if(h0(t)){return void 0}class i extends ld{static to(s){const r=new i(s.name,Un.to(s.kind),s.containerName||"",new kn(e[0],W.to(s.range)));r.detail=s.detail;r.range=r.location.range;r.selectionRange=W.to(s.selectionRange);r.children=s.children?s.children.map(i.to):[];return r}}return t.map(i.to)})),new Te("vscode.executeFormatDocumentProvider","_executeFormatDocumentProvider","Execute document format provider.",[q.Uri,new q("options","Formatting options",t=>true,t=>t)],new Se("A promise that resolves to an array of TextEdits.",Bn(li.to))),new Te("vscode.executeFormatRangeProvider","_executeFormatRangeProvider","Execute range format provider.",[q.Uri,q.Range,new q("options","Formatting options",t=>true,t=>t)],new Se("A promise that resolves to an array of TextEdits.",Bn(li.to))),new Te("vscode.executeFormatOnTypeProvider","_executeFormatOnTypeProvider","Execute format on type provider.",[q.Uri,q.Position,new q("ch","Trigger character",t=>typeof t==="string",t=>t),new q("options","Formatting options",t=>true,t=>t)],new Se("A promise that resolves to an array of TextEdits.",Bn(li.to))),new Te("vscode.executeDefinitionProvider","_executeDefinitionProvider","Execute all definition providers.",[q.Uri,q.Position],new Se("A promise that resolves to an array of Location or LocationLink instances.",Fr)),new Te("vscode.experimental.executeDefinitionProvider_recursive","_executeDefinitionProvider_recursive","Execute all definition providers.",[q.Uri,q.Position],new Se("A promise that resolves to an array of Location or LocationLink instances.",Fr)),new Te("vscode.executeTypeDefinitionProvider","_executeTypeDefinitionProvider","Execute all type definition providers.",[q.Uri,q.Position],new Se("A promise that resolves to an array of Location or LocationLink instances.",Fr)),new Te("vscode.experimental.executeTypeDefinitionProvider_recursive","_executeTypeDefinitionProvider_recursive","Execute all type definition providers.",[q.Uri,q.Position],new Se("A promise that resolves to an array of Location or LocationLink instances.",Fr)),new Te("vscode.executeDeclarationProvider","_executeDeclarationProvider","Execute all declaration providers.",[q.Uri,q.Position],new Se("A promise that resolves to an array of Location or LocationLink instances.",Fr)),new Te("vscode.experimental.executeDeclarationProvider_recursive","_executeDeclarationProvider_recursive","Execute all declaration providers.",[q.Uri,q.Position],new Se("A promise that resolves to an array of Location or LocationLink instances.",Fr)),new Te("vscode.executeImplementationProvider","_executeImplementationProvider","Execute all implementation providers.",[q.Uri,q.Position],new Se("A promise that resolves to an array of Location or LocationLink instances.",Fr)),new Te("vscode.experimental.executeImplementationProvider_recursive","_executeImplementationProvider_recursive","Execute all implementation providers.",[q.Uri,q.Position],new Se("A promise that resolves to an array of Location or LocationLink instances.",Fr)),new Te("vscode.executeReferenceProvider","_executeReferenceProvider","Execute all reference providers.",[q.Uri,q.Position],new Se("A promise that resolves to an array of Location-instances.",Bn(Zi.to))),new Te("vscode.experimental.executeReferenceProvider","_executeReferenceProvider_recursive","Execute all reference providers.",[q.Uri,q.Position],new Se("A promise that resolves to an array of Location-instances.",Bn(Zi.to))),new Te("vscode.executeHoverProvider","_executeHoverProvider","Execute all hover providers.",[q.Uri,q.Position],new Se("A promise that resolves to an array of Hover-instances.",Bn(Hd.to))),new Te("vscode.experimental.executeHoverProvider_recursive","_executeHoverProvider_recursive","Execute all hover providers.",[q.Uri,q.Position],new Se("A promise that resolves to an array of Hover-instances.",Bn(Hd.to))),new Te("vscode.executeSelectionRangeProvider","_executeSelectionRangeProvider","Execute selection range provider.",[q.Uri,new q("position","A position in a text document",t=>Array.isArray(t)&&t.every(e=>Ve.isPosition(e)),t=>t.map(rt.from))],new Se("A promise that resolves to an array of ranges.",t=>{return t.map(e=>{let i;for(const n of e.reverse()){i=new hd(W.to(n),i)}return i})})),new Te("vscode.executeWorkspaceSymbolProvider","_executeWorkspaceSymbolProvider","Execute all workspace symbol providers.",[q.String.with("query","Search string")],new Se("A promise that resolves to an array of SymbolInformation-instances.",t=>{return t.map(Pa.to)})),new Te("vscode.prepareCallHierarchy","_executePrepareCallHierarchy","Prepare call hierarchy at a position inside a document",[q.Uri,q.Position],new Se("A promise that resolves to an array of CallHierarchyItem-instances",t=>t.map(Aa.to))),new Te("vscode.provideIncomingCalls","_executeProvideIncomingCalls","Compute incoming calls for an item",[q.CallHierarchyItem],new Se("A promise that resolves to an array of CallHierarchyIncomingCall-instances",t=>t.map(ow.to))),new Te("vscode.provideOutgoingCalls","_executeProvideOutgoingCalls","Compute outgoing calls for an item",[q.CallHierarchyItem],new Se("A promise that resolves to an array of CallHierarchyOutgoingCall-instances",t=>t.map(aw.to))),new Te("vscode.prepareRename","_executePrepareRename","Execute the prepareRename of rename provider.",[q.Uri,q.Position],new Se("A promise that resolves to a range and placeholder text.",t=>{if(!t){return void 0}return{range:W.to(t.range),placeholder:t.text}})),new Te("vscode.executeDocumentRenameProvider","_executeDocumentRenameProvider","Execute rename provider.",[q.Uri,q.Position,q.String.with("newName","The new symbol name")],new Se("A promise that resolves to a WorkspaceEdit.",t=>{if(!t){return void 0}if(t.rejectReason){throw new Error(t.rejectReason)}return un.to(t)})),new Te("vscode.executeLinkProvider","_executeLinkProvider","Execute document link provider.",[q.Uri,q.Number.with("linkResolveCount","Number of links that should be resolved, only when links are unresolved.").optional()],new Se("A promise that resolves to an array of DocumentLink-instances.",t=>t.map(pa.to))),new Te("vscode.provideDocumentSemanticTokensLegend","_provideDocumentSemanticTokensLegend","Provide semantic tokens legend for a document",[q.Uri],new Se("A promise that resolves to SemanticTokensLegend.",t=>{if(!t){return void 0}return new Dv(t.tokenTypes,t.tokenModifiers)})),new Te("vscode.provideDocumentSemanticTokens","_provideDocumentSemanticTokens","Provide semantic tokens for a document",[q.Uri],new Se("A promise that resolves to SemanticTokens.",t=>{if(!t){return void 0}const e=RD(t);if(e.type!=="full"){return void 0}return new ac(e.data,void 0)})),new Te("vscode.provideDocumentRangeSemanticTokensLegend","_provideDocumentRangeSemanticTokensLegend","Provide semantic tokens legend for a document range",[q.Uri,q.Range.optional()],new Se("A promise that resolves to SemanticTokensLegend.",t=>{if(!t){return void 0}return new Dv(t.tokenTypes,t.tokenModifiers)})),new Te("vscode.provideDocumentRangeSemanticTokens","_provideDocumentRangeSemanticTokens","Provide semantic tokens for a document range",[q.Uri,q.Range],new Se("A promise that resolves to SemanticTokens.",t=>{if(!t){return void 0}const e=RD(t);if(e.type!=="full"){return void 0}return new ac(e.data,void 0)})),new Te("vscode.executeCompletionItemProvider","_executeCompletionItemProvider","Execute completion item provider.",[q.Uri,q.Position,q.String.with("triggerCharacter","Trigger completion when the user types the character, like `,` or `(`").optional(),q.Number.with("itemResolveCount","Number of completions to resolve (too large numbers slow down completions)").optional()],new Se("A promise that resolves to a CompletionList-instance.",(t,e,i)=>{if(!t){return new ec([])}const n=t.suggestions.map(s=>hw.to(s,i));return new ec(n,t.incomplete)})),new Te("vscode.executeSignatureHelpProvider","_executeSignatureHelpProvider","Execute signature help provider.",[q.Uri,q.Position,q.String.with("triggerCharacter","Trigger signature help when the user types the character, like `,` or `(`").optional()],new Se("A promise that resolves to SignatureHelp.",t=>{if(t){return Bd.to(t)}return void 0})),new Te("vscode.executeCodeLensProvider","_executeCodeLensProvider","Execute code lens provider.",[q.Uri,q.Number.with("itemResolveCount","Number of lenses that should be resolved and returned. Will only return resolved lenses, will impact performance)").optional()],new Se("A promise that resolves to an array of CodeLens-instances.",(t,e,i)=>{return Bn(n=>{return new Fp(W.to(n.range),n.command&&i.fromInternal(n.command))})(t)})),new Te("vscode.executeCodeActionProvider","_executeCodeActionProvider","Execute code action provider.",[q.Uri,new q("rangeOrSelection","Range in a text document. Some refactoring provider requires Selection object.",t=>Oe.isRange(t),t=>Dr.isSelection(t)?ls.from(t):W.from(t)),q.String.with("kind","Code action kind to return code actions for").optional(),q.Number.with("itemResolveCount","Number of code actions to resolve (too large numbers slow down code actions)").optional()],new Se("A promise that resolves to an array of Command-instances.",(t,e,i)=>{return Bn(n=>{if(n._isSynthetic){if(!n.command){throw new Error("Synthetic code actions must have a command")}return i.fromInternal(n.command)}else{const s=new dd(n.title,n.kind?new Pt(n.kind):void 0);if(n.edit){s.edit=un.to(n.edit)}if(n.command){s.command=i.fromInternal(n.command)}s.isPreferred=n.isPreferred;return s}})(t)})),new Te("vscode.executeDocumentColorProvider","_executeDocumentColorProvider","Execute document color provider.",[q.Uri],new Se("A promise that resolves to an array of ColorInformation objects.",t=>{if(t){return t.map(e=>new Vp(W.to(e.range),pc.to(e.color)))}return[]})),new Te("vscode.executeColorPresentationProvider","_executeColorPresentationProvider","Execute color presentation provider.",[new q("color","The color to show and insert",t=>t instanceof nc,pc.from),new q("context","Context object with uri and range",t=>true,t=>({uri:t.uri,range:W.from(t.range)}))],new Se("A promise that resolves to an array of ColorPresentation objects.",t=>{if(t){return t.map(kg.to)}return[]})),new Te("vscode.executeInlayHintProvider","_executeInlayHintProvider","Execute inlay hints provider",[q.Uri,q.Range],new Se("A promise that resolves to an array of Inlay objects",(t,e,i)=>{return t.map(fw.to.bind(void 0,i))})),new Te("vscode.executeFoldingRangeProvider","_executeFoldingRangeProvider","Execute folding range provider",[q.Uri],new Se("A promise that resolves to an array of FoldingRange objects",(t,e)=>{if(t){return t.map(Cg.to)}return void 0})),new Te("vscode.resolveNotebookContentProviders","_resolveNotebookContentProvider","Resolve Notebook Content Providers",[],new Se("A promise that resolves to an array of NotebookContentProvider static info objects.",Bn(t=>{return{viewType:t.viewType,displayName:t.displayName,options:{transientOutputs:t.options.transientOutputs,transientCellMetadata:t.options.transientCellMetadata,transientDocumentMetadata:t.options.transientDocumentMetadata},filenamePattern:t.filenamePattern.map(e=>Pg.to(e))}}))),new Te("vscode.executeInlineValueProvider","_executeInlineValueProvider","Execute inline value provider",[q.Uri,q.Range,new q("context","An InlineValueContext",t=>t&&typeof t.frameId==="number"&&t.stoppedLocation instanceof Oe,t=>bg.from(t))],new Se("A promise that resolves to an array of InlineValue objects",t=>{return t.map(wg.to)})),new Te("vscode.open","_workbench.open","Opens the provided resource in the editor. Can be a text or binary file, or an http(s) URL. If you need more control over the options for opening a text file, use vscode.window.showTextDocument instead.",[new q("uriOrString","Uri-instance or string (only http/https)",t=>b.isUri(t)||typeof t==="string"&&pP(t,ae.http,ae.https),t=>t),new q("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",t=>t===void 0||typeof t==="number"||typeof t==="object",t=>!t?t:typeof t==="number"?[ai.from(t),void 0]:[ai.from(t.viewColumn),Au.from(t)]).optional(),q.String.with("label","").optional()],Se.Void),new Te("vscode.openWith","_workbench.openWith","Opens the provided resource with a specific editor.",[q.Uri.with("resource","Resource to open"),q.String.with("viewId","Custom editor view id. This should be the viewType string for custom editors or the notebookType string for notebooks. Use 'default' to use VS Code's default text editor"),new q("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",t=>t===void 0||typeof t==="number"||typeof t==="object",t=>!t?t:typeof t==="number"?[ai.from(t),void 0]:[ai.from(t.viewColumn),Au.from(t)]).optional()],Se.Void),new Te("vscode.diff","_workbench.diff","Opens the provided resources in the diff editor to compare their contents.",[q.Uri.with("left","Left-hand side resource of the diff editor"),q.Uri.with("right","Right-hand side resource of the diff editor"),q.String.with("title","Human readable title for the diff editor").optional(),new q("columnOrOptions","Either the column in which to open or editor options, see vscode.TextDocumentShowOptions",t=>t===void 0||typeof t==="object",t=>t&&[ai.from(t.viewColumn),Au.from(t)]).optional()],Se.Void),new Te("vscode.changes","_workbench.changes","Opens a list of resources in the changes editor to compare their contents.",[q.String.with("title","Human readable title for the changes editor"),new q("resourceList","List of resources to compare",t=>{for(const e of t){if(e.length!==3){return false}const[i,n,s]=e;if(!b.isUri(i)||!b.isUri(n)&&n!==void 0&&n!==null||!b.isUri(s)&&s!==void 0&&s!==null){return false}}return true},t=>t)],Se.Void),new Te("vscode.prepareTypeHierarchy","_executePrepareTypeHierarchy","Prepare type hierarchy at a position inside a document",[q.Uri,q.Position],new Se("A promise that resolves to an array of TypeHierarchyItem-instances",t=>t.map(ga.to))),new Te("vscode.provideSupertypes","_executeProvideSupertypes","Compute supertypes for an item",[q.TypeHierarchyItem],new Se("A promise that resolves to an array of TypeHierarchyItem-instances",t=>t.map(ga.to))),new Te("vscode.provideSubtypes","_executeProvideSubtypes","Compute subtypes for an item",[q.TypeHierarchyItem],new Se("A promise that resolves to an array of TypeHierarchyItem-instances",t=>t.map(ga.to))),new Te("vscode.revealTestInExplorer","_revealTestInExplorer","Reveals a test instance in the explorer",[q.TestItem],Se.Void),new Te("vscode.startContinuousTestRun","testing.startContinuousRunFromExtension","Starts running the given tests with continuous run mode.",[q.TestProfile,q.Arr(q.TestItem)],Se.Void),new Te("vscode.stopContinuousTestRun","testing.stopContinuousRunFromExtension","Stops running the given tests with continuous run mode.",[q.Arr(q.TestItem)],Se.Void),new Te("vscode.experimental.editSession.continue","_workbench.editSessions.actions.continueEditSession","Continue the current edit session in a different workspace",[q.Uri.with("workspaceUri","The target workspace to continue the current edit session in")],Se.Void),new Te("setContext","_setContext","Set a custom context key value that can be used in when clauses.",[q.String.with("name","The context key name"),new q("value","The context key value",()=>true,t=>t)],Se.Void),new Te("vscode.editorChat.start","inlineChat.start","Invoke a new editor chat session",[new q("Run arguments","",t=>true,t=>{if(!t){return void 0}return{initialRange:t.initialRange?W.from(t.initialRange):void 0,initialSelection:Dr.isSelection(t.initialSelection)?ls.from(t.initialSelection):void 0,message:t.message,attachments:t.attachments,autoSend:t.autoSend,position:t.position?rt.from(t.position):void 0}})],Se.Void)];class ON{static register(e){NN.forEach(e.registerApiCommand,e);this._registerValidateWhenClausesCommand(e)}static _registerValidateWhenClausesCommand(e){e.registerCommand(false,"_validateWhenClauses",SA)}}function Bn(t){return e=>{if(Array.isArray(e)){return e.map(t)}return void 0}}function Fr(t){if(!Array.isArray(t)){return void 0}const e=[];for(const i of t){if(x8(i)){e.push($d.to(i))}else{e.push(Zi.to(i))}}return e}let Bb=class z${constructor(e,i){this._proxy=e.getProxy(Y.MainThreadBulkEdits);this._versionInformationProvider={getTextDocumentVersion:n=>i.getDocument(n)?.version,getNotebookDocumentVersion:()=>void 0}}applyWorkspaceEdit(e,i,n){const s=new Bi(un.from(e,this._versionInformationProvider));return this._proxy.$tryApplyWorkspaceEdit(s,void 0,n?.isRefactoring??false)}};Bb=z([O(0,st)],Bb);function FN(t){return!!t&&typeof t.sessionId==="string"&&t.$mid===it.ChatViewContext}class MN{constructor(e,i,n,s,r){this._extension=e;this._request=i;this._proxy=n;this._commandsConverter=s;this._sessionDisposables=r;this._stopWatch=xr.create(false);this._isClosed=false}close(){this._isClosed=true}get timings(){return{firstProgress:this._firstProgress,totalElapsed:this._stopWatch.elapsed()}}get apiObject(){if(!this._apiObject){let i=function(s){if(e._isClosed){const r=new Error("Response stream has been closed");Error.captureStackTrace(r,s);throw r}};const e=this;this._stopWatch.reset();const n=(s,r)=>{if(typeof this._firstProgress==="undefined"&&(s.kind==="markdownContent"||s.kind==="markdownVuln")){this._firstProgress=this._stopWatch.elapsed()}if(r){const o=this._proxy.$handleProgressChunk(this._request.requestId,s);const a={report:l=>{o?.then(c=>{if(c){if(cn.isMarkdownString(l.value)){this._proxy.$handleProgressChunk(this._request.requestId,Kd.from(l),c)}else{this._proxy.$handleProgressChunk(this._request.requestId,_a.from(l),c)}}})}};Promise.all([o,r?.(a)]).then(([l,c])=>{if(l!==void 0){this._proxy.$handleProgressChunk(this._request.requestId,Iw.from(c),l)}})}else{this._proxy.$handleProgressChunk(this._request.requestId,s)}};this._apiObject=Object.freeze({markdown(s){i(this.markdown);const r=new Am(s);const o=qd.from(r);n(o);return this},markdownWithVulnerabilities(s,r){i(this.markdown);if(r){$(e._extension,"chatParticipantAdditions")}const o=new Rd(s,r);const a=Ng.from(o);n(a);return this},codeblockUri(s,r){i(this.codeblockUri);$(e._extension,"chatParticipantAdditions");const o=new Nm(s,r);const a=Lg.from(o);n(a);return this},filetree(s,r){i(this.filetree);const o=new Rm(s,r);const a=jd.from(o);n(a);return this},anchor(s,r){const o=new Ld(s,r);return this.push(o)},button(s){i(this.anchor);const r=new Lm(s);const o=Qd.from(r,e._commandsConverter,e._sessionDisposables);n(o);return this},progress(s,r){i(this.progress);const o=new pf(s,r);const a=r?Fg.from(o):Gd.from(o);n(a,r);return this},warning(s){i(this.progress);$(e._extension,"chatParticipantAdditions");const r=new Nd(s);const o=Kd.from(r);n(o);return this},reference(s,r){return this.reference2(s,r)},reference2(s,r,o){i(this.reference);if(typeof s==="object"&&"variableName"in s){$(e._extension,"chatParticipantAdditions")}if(typeof s==="object"&&"variableName"in s&&!s.value){const a=e._request.variables.variables.find(l=>l.name===s.variableName);if(a){let l;if(a.references?.length){l=a.references.map(c=>({kind:"reference",reference:{variableName:s.variableName,value:c.reference}}))}else{const c=new fa(s,r,o);const u=_a.from(c);l=[u]}l.forEach(c=>n(c));return this}}else{const a=new fa(s,r,o);const l=_a.from(a);n(l)}return this},codeCitation(s,r,o){i(this.codeCitation);$(e._extension,"chatParticipantAdditions");const a=new hg(s,r,o);const l=Hg.from(a);n(l)},textEdit(s,r){i(this.textEdit);$(e._extension,"chatParticipantAdditions");const o=new Od(s,r);o.isDone=r===true?true:void 0;const a=Mg.from(o);n(a);return this},notebookEdit(s,r){i(this.notebookEdit);$(e._extension,"chatParticipantAdditions");const o=new fg(s,r);const a=$g.from(o);n(a);return this},confirmation(s,r,o,a){i(this.confirmation);$(e._extension,"chatParticipantAdditions");const l=new dg(s,r,o,a);const c=Og.from(l);n(c);return this},push(s){i(this.push);if(s instanceof Od||s instanceof fg||s instanceof Rd||s instanceof Nd||s instanceof dg||s instanceof hg||s instanceof Om||s instanceof ly||s instanceof pf){$(e._extension,"chatParticipantAdditions")}if(s instanceof fa){this.reference2(s.value,s.iconPath,s.options)}else if(s instanceof pf){const r=s.task?Fg.from(s):Gd.from(s);n(r,s.task)}else if(s instanceof Ld){const r=Ec.from(s);if(s.resolve){$(e._extension,"chatParticipantAdditions");r.resolveId=vi();const o=new Ot;s.resolve(o.token).then(()=>{const a=Ec.from(s);e._proxy.$handleAnchorResolve(e._request.requestId,r.resolveId,a)}).then(()=>o.dispose(),()=>o.dispose());e._sessionDisposables.add(ge(()=>o.dispose(true)))}n(r)}else{const r=Bg.from(s,e._commandsConverter,e._sessionDisposables);n(r)}return this}})}return this._apiObject}}class wl extends Ee{static{this._idPool=0}static{this._participantDetectionProviderIdPool=0}static{this._relatedFilesProviderIdPool=0}constructor(e,i,n,s,r,o,a){super();this._logService=i;this._commands=n;this._documents=s;this._languageModels=r;this._diagnostics=o;this._tools=a;this._agents=new Map;this._participantDetectionProviders=new Map;this._relatedFilesProviders=new Map;this._sessionDisposables=this._register(new Cf);this._completionDisposables=this._register(new Cf);this._inFlightRequests=new Set;this._onDidDisposeChatSession=this._register(new L);this.onDidDisposeChatSession=this._onDidDisposeChatSession.event;this._proxy=e.getProxy(Y.MainThreadChatAgents2);n.registerArgumentProcessor({processArgument:l=>{if(FN(l)){return null}return l}})}transferActiveChat(e){this._proxy.$transferActiveChatSession(e)}createChatAgent(e,i,n){const s=wl._idPool++;const r=new LD(e,i,this._proxy,s,n);this._agents.set(s,r);this._proxy.$registerAgent(s,e.identifier,i,{},void 0);return r.apiAgent}createDynamicChatAgent(e,i,n,s){const r=wl._idPool++;const o=new LD(e,i,this._proxy,r,s);this._agents.set(r,o);this._proxy.$registerAgent(r,e.identifier,i,{isSticky:true},n);return o.apiAgent}registerChatParticipantDetectionProvider(e,i){const n=wl._participantDetectionProviderIdPool++;this._participantDetectionProviders.set(n,new UN(e,i));this._proxy.$registerChatParticipantDetectionProvider(n);return ge(()=>{this._participantDetectionProviders.delete(n);this._proxy.$unregisterChatParticipantDetectionProvider(n)})}registerRelatedFilesProvider(e,i,n){const s=wl._relatedFilesProviderIdPool++;this._relatedFilesProviders.set(s,new $N(e,i));this._proxy.$registerRelatedFilesProvider(s,n);return ge(()=>{this._relatedFilesProviders.delete(s);this._proxy.$unregisterRelatedFilesProvider(s)})}async $provideRelatedFiles(e,i,n){const s=this._relatedFilesProviders.get(e);if(!s){return Promise.resolve([])}const r=Cw.to(i);return await s.provider.provideRelatedFiles(r,n)??void 0}async $detectChatParticipant(e,i,n,s,r){const o=this._participantDetectionProviders.get(e);if(!o){return void 0}const{request:a,location:l,history:c}=await this._createRequest(i,n,o.extension);const u=await this.getModelForRequest(a,o.extension);const d=Vg.to(a,l,u,this.getDiagnosticsWhenEnabled(o.extension),this.getToolsForRequest(o.extension,a),this.getTools2ForRequest(o.extension,a),o.extension,this._logService);return o.provider.provideParticipantDetection(d,{history:c},{participants:s.participants,location:Jd.to(s.location)},r)}async _createRequest(e,i,n){const s=ti(e);const r=await this.prepareHistoryTurns(n,s.agentId,i);let o;if(s.locationData?.type===$i.Editor){const a=this._documents.getDocument(s.locationData.document);o=new sC(a,ls.to(s.locationData.selection),W.to(s.locationData.wholeRange))}else if(s.locationData?.type===$i.Notebook){const a=this._documents.getDocument(s.locationData.sessionInputUri);o=new rC(a)}else;return{request:s,location:o,history:r}}async getModelForRequest(e,i){let n;if(e.userSelectedModelId){n=await this._languageModels.getLanguageModelByIdentifier(i,e.userSelectedModelId)}if(!n){n=await this._languageModels.getDefaultLanguageModel(i);if(!n){throw new Error("Language model unavailable")}}return n}async $setRequestPaused(e,i,n){const s=this._agents.get(e);if(!s){return}const r=_i.find(this._inFlightRequests,o=>o.requestId===i);if(!r){return}s.setChatRequestPauseState({request:r.extRequest,isPaused:n})}async $invokeAgent(e,i,n,s){const r=this._agents.get(e);if(!r){throw new Error(`[CHAT](${e}) CANNOT invoke agent because the agent is not registered`)}let o;let a;try{const{request:l,location:c,history:u}=await this._createRequest(i,n,r.extension);let d=this._sessionDisposables.get(l.sessionId);if(!d){d=new Ie;this._sessionDisposables.set(l.sessionId,d)}o=new MN(r.extension,l,this._proxy,this._commands.converter,d);const p=await this.getModelForRequest(l,r.extension);const f=Vg.to(l,c,p,this.getDiagnosticsWhenEnabled(r.extension),this.getToolsForRequest(r.extension,l),this.getTools2ForRequest(r.extension,l),r.extension,this._logService);a={requestId:i.requestId,extRequest:f};this._inFlightRequests.add(a);const m=r.invoke(f,{history:u},o.apiObject,s);return await _I(Promise.resolve(m).then(v=>{if(v?.metadata){try{JSON.stringify(v.metadata)}catch(D){const I=`result.metadata MUST be JSON.stringify-able. Got error: ${D.message}`;this._logService.error(`[${r.extension.identifier.value}] [@${r.id}] ${I}`,r.extension);return{errorDetails:{message:I},timings:o?.timings,nextQuestion:v.nextQuestion}}}let y;if(v?.errorDetails){y={...v.errorDetails,responseIsIncomplete:true}}if(y?.responseIsRedacted||y?.isQuotaExceeded){$(r.extension,"chatParticipantPrivate")}return{errorDetails:y,timings:o?.timings,metadata:v?.metadata,nextQuestion:v?.nextQuestion}}),s)}catch(l){this._logService.error(l,r.extension);if(l instanceof pi&&l.cause){l=l.cause}const c=l instanceof Error&&l.name==="ChatQuotaExceeded";return{errorDetails:{message:Rc(l),responseIsIncomplete:true,isQuotaExceeded:c}}}finally{if(a){this._inFlightRequests.delete(a)}o?.close()}}getDiagnosticsWhenEnabled(e){if(!dt(e,"chatReferenceDiagnostic")){return[]}return this._diagnostics.getDiagnostics()}getTools2ForRequest(e,i){if(!i.userSelectedTools2){return new Map}const n=new Map;for(const s of this._tools.getTools(e)){if(typeof i.userSelectedTools2[s.name]==="boolean"){n.set(s.name,i.userSelectedTools2[s.name])}}return n}getToolsForRequest(e,i){if(!kc(i.userSelectedTools)){return void 0}const n=new Set(i.userSelectedTools);const s=this._tools.getTools(e).filter(r=>n.has(r.name));return{tools:s,isExclusive:i.toolSelectionIsExclusive}}async prepareHistoryTurns(e,i,n){const s=[];for(const r of n.history){const o=$l.to(r.result);const a=i===r.request.agentId?o:{...o,metadata:void 0};const l=r.request.variables.variables.filter(f=>f.kind!=="tool").map(f=>Wg.to(f,this.getDiagnosticsWhenEnabled(e),this._logService)).filter(ln);const c=r.request.variables.variables.filter(f=>f.kind==="tool").map(zg.to);const u=dt(e,"chatParticipantPrivate")?r.request.editedFileEvents:void 0;const d=new Vv(r.request.message,r.request.command,l,r.request.agentId,c,u);s.push(d);const p=ei(r.response.map(f=>Bg.toContent(f,this._commands.converter)));s.push(new nC(p,a,r.request.agentId,r.request.command))}return s}$releaseSession(e){this._sessionDisposables.deleteAndDispose(e);this._onDidDisposeChatSession.fire(e)}async $provideFollowups(e,i,n,s,r){const o=this._agents.get(i);if(!o){return Promise.resolve([])}const a=ti(e);const l=await this.prepareHistoryTurns(o.extension,o.id,s);const c=$l.to(n);return(await o.provideFollowups(c,{history:l},r)).filter(u=>{const d=!u.participant||_i.some(this._agents.values(),p=>p.id===u.participant&&Ze.equals(p.extension.identifier,o.extension.identifier));if(!d){this._logService.warn(`[@${o.id}] ChatFollowup refers to an unknown participant: ${u.participant}`)}return d}).map(u=>zd.from(u,a))}$acceptFeedback(e,i,n){const s=this._agents.get(e);if(!s){return}const r=$l.to(i);let o;switch(n.direction){case pp.Down:o=Ad.Unhelpful;break;case pp.Up:o=Ad.Helpful;break}const a={result:r,kind:o,unhelpfulReason:dt(s.extension,"chatParticipantAdditions")?n.reason:void 0};s.acceptFeedback(Object.freeze(a))}$acceptAction(e,i,n){const s=this._agents.get(e);if(!s){return}if(n.action.kind==="vote"){return}const r=Pw.to(i,n,this._commands.converter);if(r){s.acceptAction(Object.freeze(r))}}async $invokeCompletionProvider(e,i,n){const s=this._agents.get(e);if(!s){return[]}let r=this._completionDisposables.get(e);if(r){r.clear()}else{r=new Ie;this._completionDisposables.set(e,r)}const o=await s.invokeCompletionProvider(i,n);return o.map(a=>Tw.from(a,this._commands.converter,r))}async $provideChatTitle(e,i,n){const s=this._agents.get(e);if(!s){return}const r=await this.prepareHistoryTurns(s.extension,s.id,{history:i});return await s.provideTitle({history:r},n)}async $provideSampleQuestions(e,i,n){const s=this._agents.get(e);if(!s){return}return(await s.provideSampleQuestions(Jd.to(i),n)).map(r=>zd.from(r,void 0))}}class UN{constructor(e,i){this.extension=e;this.provider=i}}class $N{constructor(e,i){this.extension=e;this.provider=i}}class LD{constructor(e,i,n,s,r){this.extension=e;this.id=i;this._proxy=n;this._handle=s;this._requestHandler=r;this._onDidReceiveFeedback=new L;this._onDidPerformAction=new L;this._pauseStateEmitter=new L}acceptFeedback(e){this._onDidReceiveFeedback.fire(e)}acceptAction(e){this._onDidPerformAction.fire(e)}setChatRequestPauseState(e){this._pauseStateEmitter.fire(e)}async invokeCompletionProvider(e,i){if(!this._agentVariableProvider){return[]}return await this._agentVariableProvider.provider.provideCompletionItems(e,i)??[]}async provideFollowups(e,i,n){if(!this._followupProvider){return[]}const s=await this._followupProvider.provideFollowups(e,i,n);if(!s){return[]}return s.filter(r=>!(r&&"commandId"in r)).filter(r=>!(r&&"message"in r))}async provideTitle(e,i){if(!this._titleProvider){return}return await this._titleProvider.provideChatTitle(e,i)??void 0}async provideSampleQuestions(e,i){if(!this._welcomeMessageProvider||!this._welcomeMessageProvider.provideSampleQuestions){return[]}const n=await this._welcomeMessageProvider.provideSampleQuestions(e,i);if(!n){return[]}return n}get apiAgent(){let e=false;let i=false;const n=()=>{if(e){return}if(i){return}i=true;queueMicrotask(()=>{this._proxy.$updateAgent(this._handle,{icon:!this._iconPath?void 0:this._iconPath instanceof b?this._iconPath:"light"in this._iconPath?this._iconPath.light:void 0,iconDark:!this._iconPath?void 0:"dark"in this._iconPath?this._iconPath.dark:void 0,themeIcon:this._iconPath instanceof Vi?this._iconPath:void 0,hasFollowups:this._followupProvider!==void 0,helpTextPrefix:!this._helpTextPrefix||typeof this._helpTextPrefix==="string"?this._helpTextPrefix:Pe.from(this._helpTextPrefix),helpTextVariablesPrefix:!this._helpTextVariablesPrefix||typeof this._helpTextVariablesPrefix==="string"?this._helpTextVariablesPrefix:Pe.from(this._helpTextVariablesPrefix),helpTextPostfix:!this._helpTextPostfix||typeof this._helpTextPostfix==="string"?this._helpTextPostfix:Pe.from(this._helpTextPostfix),supportIssueReporting:this._supportIssueReporting,requester:this._requester,additionalWelcomeMessage:!this._additionalWelcomeMessage||typeof this._additionalWelcomeMessage==="string"?this._additionalWelcomeMessage:Pe.from(this._additionalWelcomeMessage)});i=false})};const s=this;return{get id(){return s.id},get iconPath(){return s._iconPath},set iconPath(r){s._iconPath=r;n()},get requestHandler(){return s._requestHandler},set requestHandler(r){Mk(typeof r==="function","Invalid request handler");s._requestHandler=r},get followupProvider(){return s._followupProvider},set followupProvider(r){s._followupProvider=r;n()},get helpTextPrefix(){$(s.extension,"defaultChatParticipant");return s._helpTextPrefix},set helpTextPrefix(r){$(s.extension,"defaultChatParticipant");s._helpTextPrefix=r;n()},get helpTextVariablesPrefix(){$(s.extension,"defaultChatParticipant");return s._helpTextVariablesPrefix},set helpTextVariablesPrefix(r){$(s.extension,"defaultChatParticipant");s._helpTextVariablesPrefix=r;n()},get helpTextPostfix(){$(s.extension,"defaultChatParticipant");return s._helpTextPostfix},set helpTextPostfix(r){$(s.extension,"defaultChatParticipant");s._helpTextPostfix=r;n()},get supportIssueReporting(){$(s.extension,"chatParticipantPrivate");return s._supportIssueReporting},set supportIssueReporting(r){$(s.extension,"chatParticipantPrivate");s._supportIssueReporting=r;n()},get onDidReceiveFeedback(){return s._onDidReceiveFeedback.event},set participantVariableProvider(r){$(s.extension,"chatParticipantAdditions");s._agentVariableProvider=r;if(r){if(!r.triggerCharacters.length){throw new Error("triggerCharacters are required")}s._proxy.$registerAgentCompletionsProvider(s._handle,s.id,r.triggerCharacters)}else{s._proxy.$unregisterAgentCompletionsProvider(s._handle,s.id)}},get participantVariableProvider(){$(s.extension,"chatParticipantAdditions");return s._agentVariableProvider},set welcomeMessageProvider(r){$(s.extension,"defaultChatParticipant");s._welcomeMessageProvider=r;n()},get welcomeMessageProvider(){$(s.extension,"defaultChatParticipant");return s._welcomeMessageProvider},set additionalWelcomeMessage(r){$(s.extension,"defaultChatParticipant");s._additionalWelcomeMessage=r;n()},get additionalWelcomeMessage(){$(s.extension,"defaultChatParticipant");return s._additionalWelcomeMessage},set titleProvider(r){$(s.extension,"defaultChatParticipant");s._titleProvider=r;n()},get titleProvider(){$(s.extension,"defaultChatParticipant");return s._titleProvider},get onDidChangePauseState(){$(s.extension,"chatParticipantAdditions");return s._pauseStateEmitter.event},onDidPerformAction:!dt(this.extension,"chatParticipantAdditions")?void 0:this._onDidPerformAction.event,set requester(r){s._requester=r;n()},get requester(){return s._requester},dispose(){e=true;s._followupProvider=void 0;s._onDidReceiveFeedback.dispose();s._proxy.$unregisterAgent(s._handle)}}}invoke(e,i,n,s){return this._requestHandler(e,i,n,s)}}class HN{constructor(e){this._items=new Map;this._proxy=e.getProxy(Y.MainThreadChatStatus)}createChatStatusItem(e,i){const n=BN(e.identifier,i);if(this._items.has(n)){throw new Error(`Chat status item '${i}' already exists`)}const s={id:n,title:"",description:"",detail:""};let r=false;let o=false;const a=()=>{if(r){throw new Error("Chat status item is disposed")}if(!o){return}this._proxy.$setEntry(i,s)};const l=Object.freeze({id:i,get title(){return s.title},set title(c){s.title=c;a()},get description(){return s.description},set description(c){s.description=c;a()},get detail(){return s.detail},set detail(c){s.detail=c;a()},show:()=>{o=true;a()},hide:()=>{o=false;this._proxy.$disposeEntry(i)},dispose:()=>{r=true;this._proxy.$disposeEntry(i);this._items.delete(n)}});this._items.set(n,l);return l}}function BN(t,e){return`${Ze.toKey(t)}.${e}`}class VN{constructor(e){const i=e.getProxy(Y.MainThreadClipboard);this.value=Object.freeze({readText(){return i.$readText()},writeText(n){return i.$writeText(n)}})}}const ZC="vscode-cdn.net";const WN=`vscode-resource.${ZC}`;const Vb=`'self' https://*.${ZC}`;function Mu(t,e){if(t.scheme===ae.http||t.scheme===ae.https){return t}if(e&&e.authority&&e.isRemote&&t.scheme===ae.file){t=b.from({scheme:ae.vscodeRemote,authority:e.authority,path:t.path})}return b.from({scheme:ae.https,authority:`${t.scheme}+${zN(t.authority)}.${WN}`,path:t.path,fragment:t.fragment,query:t.query})}function zN(t){return t.replace(/./g,e=>{const i=e.charCodeAt(0);if(i>=A.a&&i<=A.z||i>=A.A&&i<=A.Z||i>=A.Digit0&&i<=A.Digit9){return e}return"-"+i.toString(16).padStart(4,"0")})}class qN{constructor(e,i,n){this._proxy=e;this._editors=i;this._remoteInfo=n;this._handlePool=0;this._disposables=new Ie;this._insets=new Map;this._disposables.add(i.onDidChangeVisibleTextEditors(()=>{const s=i.getVisibleTextEditors();for(const r of this._insets.values()){if(s.indexOf(r.editor)<0){r.inset.dispose()}}}))}dispose(){this._insets.forEach(e=>e.inset.dispose());this._disposables.dispose()}createWebviewEditorInset(e,i,n,s,r){let o;for(const f of this._editors.getVisibleTextEditors(true)){if(f.value===e){o=f;break}}if(!o){throw new Error("not a visible editor")}const a=this;const l=this._handlePool++;const c=new L;const u=new L;const d=new class{constructor(){this._html="";this._options=Object.create(null)}asWebviewUri(f){return Mu(f,a._remoteInfo)}get cspSource(){return Vb}set options(f){this._options=f;a._proxy.$setOptions(l,f)}get options(){return this._options}set html(f){this._html=f;a._proxy.$setHtml(l,f)}get html(){return this._html}get onDidReceiveMessage(){return c.event}postMessage(f){return a._proxy.$postMessage(l,f)}};const p=new class{constructor(){this.editor=e;this.line=i;this.height=n;this.webview=d;this.onDidDispose=u.event}dispose(){if(a._insets.has(l)){a._insets.delete(l);a._proxy.$disposeEditorInset(l);u.fire();u.dispose();c.dispose()}}};this._proxy.$createEditorInset(l,o.id,o.value.document.uri,i+1,n,s||{},r.identifier,r.extensionLocation);this._insets.set(l,{editor:e,inset:p,onDidReceiveMessage:c});return p}$onDidDispose(e){const i=this._insets.get(e);if(i){i.inset.dispose()}}$onDidReceiveMessage(e,i){const n=this._insets.get(e);n?.onDidReceiveMessage.fire(i)}}class Iy{static{this._providerHandlePool=0}constructor(e){this.providers=new Map;this._proxy=e.getProxy(Y.MainThreadCodeMapper)}async $mapCode(e,i,n){const s=this.providers.get(e);if(!s){throw new Error(`Received request to map code for unknown provider handle ${e}`)}const r={textEdit:(l,c)=>{c=Sn(c);this._proxy.$handleProgress(i.requestId,{uri:l,edits:c.map(li.from)})},notebookEdit:(l,c)=>{c=Sn(c);this._proxy.$handleProgress(i.requestId,{uri:l,edits:c.map(Ug.from)})}};const o={location:i.location,chatRequestId:i.chatRequestId,chatRequestModel:i.chatRequestModel,chatSessionId:i.chatSessionId,codeBlocks:i.codeBlocks.map(l=>{return{code:l.code,resource:b.revive(l.resource),markdownBeforeBlock:l.markdownBeforeBlock}})};const a=await s.provideMappedEdits(o,r,n);return a??null}registerMappedEditsProvider(e,i){const n=Iy._providerHandlePool++;this._proxy.$registerCodeMapperProvider(n,e.displayName??e.name);this.providers.set(n,i);return{dispose:()=>{return this._proxy.$unregisterCodeMapperProvider(n)}}}}function jN(t,e,i){const n=t.getProxy(Y.MainThreadComments);class s{static{this.handlePool=0}constructor(){this._commentControllers=new Map;this._commentControllersByExtension=new Sr;e.registerArgumentProcessor({processArgument:m=>{if(m&&m.$mid===it.CommentController){const v=this._commentControllers.get(m.handle);if(!v){return m}return v.value}else if(m&&m.$mid===it.CommentThread){const v=m;const y=this._commentControllers.get(v.commentControlHandle);if(!y){return v}const D=y.getCommentThread(v.commentThreadHandle);if(!D){return v}return D.value}else if(m&&(m.$mid===it.CommentThreadReply||m.$mid===it.CommentThreadInstance)){const v=this._commentControllers.get(m.thread.commentControlHandle);if(!v){return m}const y=v.getCommentThread(m.thread.commentThreadHandle);if(!y){return m}if(m.$mid===it.CommentThreadInstance){return y.value}return{thread:y.value,text:m.text}}else if(m&&m.$mid===it.CommentNode){const v=this._commentControllers.get(m.thread.commentControlHandle);if(!v){return m}const y=v.getCommentThread(m.thread.commentThreadHandle);if(!y){return m}const D=m.commentUniqueId;const I=y.getCommentByUniqueId(D);if(!I){return m}return I}else if(m&&m.$mid===it.CommentThreadNode){const v=this._commentControllers.get(m.thread.commentControlHandle);if(!v){return m}const y=v.getCommentThread(m.thread.commentThreadHandle);if(!y){return m}const D=m.text;const I=m.commentUniqueId;const R=y.getCommentByUniqueId(I);if(!R){return m}if(typeof R.body==="string"){R.body=D}else{R.body=new cn(D)}return R}return m}})}createCommentController(m,v,y){const D=s.handlePool++;const I=new o(m,D,v,y);this._commentControllers.set(I.handle,I);const R=this._commentControllersByExtension.get(m.identifier)||[];R.push(I);this._commentControllersByExtension.set(m.identifier,R);return I.value}async $createCommentThreadTemplate(m,v,y,D){const I=this._commentControllers.get(m);if(!I){return}I.$createCommentThreadTemplate(v,y,D)}async $setActiveComment(m,v){const y=this._commentControllers.get(m);if(!y){return}y.$setActiveComment(v??void 0)}async $updateCommentThreadTemplate(m,v,y){const D=this._commentControllers.get(m);if(!D){return}D.$updateCommentThreadTemplate(v,y)}$deleteCommentThread(m,v){const y=this._commentControllers.get(m);y?.$deleteCommentThread(v)}async $updateCommentThread(m,v,y){const D=this._commentControllers.get(m);D?.$updateCommentThread(v,y)}async $provideCommentingRanges(m,v,y){const D=this._commentControllers.get(m);if(!D||!D.commentingRangeProvider){return Promise.resolve(void 0)}const I=await i.ensureDocumentData(b.revive(v));return Ci(async()=>{const R=await D.commentingRangeProvider?.provideCommentingRanges(I.document,y);let J;if(Array.isArray(R)){J={ranges:R,fileComments:false}}else if(R){J={ranges:R.ranges||[],fileComments:R.enableFileComments||false}}else{J=R??void 0}return J}).then(R=>{let J=void 0;if(R){J={ranges:R.ranges.map(H=>W.from(H)),fileComments:R.fileComments}}return J})}$toggleReaction(m,v,y,D,I){const R=this._commentControllers.get(m);if(!R||!R.reactionHandler){return Promise.resolve(void 0)}return Ci(()=>{const J=R.getCommentThread(v);if(J){const H=J.getCommentByUniqueId(D.uniqueIdInThread);if(R!==void 0&&H){if(R.reactionHandler){return R.reactionHandler(H,c(I))}}}return Promise.resolve(void 0)})}}class r{static{this._handlePool=0}set threadId(m){this._id=m}get threadId(){return this._id}get id(){return this._id}get resource(){return this._uri}get uri(){return this._uri}set range(m){if(m===void 0!==(this._range===void 0)||(!m||!this._range||!m.isEqual(this._range))){this._range=m;this.modifications.range=m;this._onDidUpdateCommentThread.fire()}}get range(){return this._range}set canReply(m){if(this._canReply!==m){this._canReply=m;this.modifications.canReply=m;this._onDidUpdateCommentThread.fire()}}get canReply(){return this._canReply}get label(){return this._label}set label(m){this._label=m;this.modifications.label=m;this._onDidUpdateCommentThread.fire()}get contextValue(){return this._contextValue}set contextValue(m){this._contextValue=m;this.modifications.contextValue=m;this._onDidUpdateCommentThread.fire()}get comments(){return this._comments}set comments(m){this._comments=m;this.modifications.comments=m;this._onDidUpdateCommentThread.fire()}get collapsibleState(){return this._collapseState}set collapsibleState(m){if(this._collapseState===m){return}this._collapseState=m;this.modifications.collapsibleState=m;this._onDidUpdateCommentThread.fire()}get state(){return this._state}set state(m){this._state=m;if(typeof m==="object"){$(this.extensionDescription,"commentThreadApplicability");this.modifications.state=m.resolved;this.modifications.applicability=m.applicability}else{this.modifications.state=m}this._onDidUpdateCommentThread.fire()}get isDisposed(){return this._isDiposed}constructor(m,v,y,D,I,R,J,H,Q){this._commentControllerHandle=v;this._id=y;this._uri=D;this._range=I;this._comments=R;this.extensionDescription=J;this._isTemplate=H;this.handle=r._handlePool++;this.commentHandle=0;this.modifications=Object.create(null);this._onDidUpdateCommentThread=new L;this.onDidUpdateCommentThread=this._onDidUpdateCommentThread.event;this._canReply=true;this._commentsMap=new Map;this._acceptInputDisposables=new eo;this._acceptInputDisposables.value=new Ie;if(this._id===void 0){this._id=`${m}.${this.handle}`}n.$createCommentThread(v,this.handle,this._id,this._uri,W.from(this._range),this._comments.map(te=>a(this,te,this._commentsMap,this.extensionDescription)),J.identifier,this._isTemplate,Q);this._localDisposables=[];this._isDiposed=false;this._localDisposables.push(this.onDidUpdateCommentThread(()=>{this.eventuallyUpdateCommentThread()}));this._localDisposables.push({dispose:()=>{n.$deleteCommentThread(v,this.handle)}});const ne=this;this.value={get uri(){return ne.uri},get range(){return ne.range},set range(te){ne.range=te},get comments(){return ne.comments},set comments(te){ne.comments=te},get collapsibleState(){return ne.collapsibleState},set collapsibleState(te){ne.collapsibleState=te},get canReply(){return ne.canReply},set canReply(te){ne.canReply=te},get contextValue(){return ne.contextValue},set contextValue(te){ne.contextValue=te},get label(){return ne.label},set label(te){ne.label=te},get state(){return ne.state},set state(te){ne.state=te},reveal:(te,le)=>ne.reveal(te,le),hide:()=>ne.hide(),dispose:()=>{ne.dispose()}}}updateIsTemplate(){if(this._isTemplate){this._isTemplate=false;this.modifications.isTemplate=false}}eventuallyUpdateCommentThread(){if(this._isDiposed){return}this.updateIsTemplate();if(!this._acceptInputDisposables.value){this._acceptInputDisposables.value=new Ie}const m=y=>Object.prototype.hasOwnProperty.call(this.modifications,y);const v={};if(m("range")){v.range=W.from(this._range)}if(m("label")){v.label=this.label}if(m("contextValue")){v.contextValue=this.contextValue??null}if(m("comments")){v.comments=this._comments.map(y=>a(this,y,this._commentsMap,this.extensionDescription))}if(m("collapsibleState")){v.collapseState=u(this._collapseState)}if(m("canReply")){v.canReply=this.canReply}if(m("state")){v.state=d(this._state)}if(m("applicability")){v.applicability=p(this._state)}if(m("isTemplate")){v.isTemplate=this._isTemplate}this.modifications={};n.$updateCommentThread(this._commentControllerHandle,this.handle,this._id,this._uri,v)}getCommentByUniqueId(m){for(const v of this._commentsMap){const y=v[0];const D=v[1];if(m===D){return y}}return}async reveal(m,v){$(this.extensionDescription,"commentReveal");let y;if(m&&m.body!==void 0){y=m}else{v=v??m}let D=y?this._commentsMap.get(y):void 0;D??=this._commentsMap.get(this._comments[0]);let I=true;let R=false;if(v?.focus===kd.Reply){R=true;I=false}else if(v?.focus===kd.Comment){I=false}return n.$revealCommentThread(this._commentControllerHandle,this.handle,D,{preserveFocus:I,focusReply:R})}async hide(){return n.$hideCommentThread(this._commentControllerHandle,this.handle)}dispose(){this._isDiposed=true;this._acceptInputDisposables.dispose();this._localDisposables.forEach(m=>m.dispose())}}class o{get id(){return this._id}get label(){return this._label}get handle(){return this._handle}get commentingRangeProvider(){return this._commentingRangeProvider}set commentingRangeProvider(m){this._commentingRangeProvider=m;if(m?.resourceHints){$(this._extension,"commentingRangeHint")}n.$updateCommentingRanges(this.handle,m?.resourceHints)}get reactionHandler(){return this._reactionHandler}set reactionHandler(m){this._reactionHandler=m;n.$updateCommentControllerFeatures(this.handle,{reactionHandler:!!m})}get options(){return this._options}set options(m){this._options=m;n.$updateCommentControllerFeatures(this.handle,{options:this._options})}get activeComment(){$(this._extension,"activeComment");return this._activeComment}get activeCommentThread(){$(this._extension,"activeComment");return this._activeThread?.value}constructor(m,v,y,D){this._extension=m;this._handle=v;this._id=y;this._label=D;this._threads=new Map;n.$registerCommentController(this.handle,y,D,this._extension.identifier.value);const I=this;this.value=Object.freeze({id:I.id,label:I.label,get options(){return I.options},set options(R){I.options=R},get commentingRangeProvider(){return I.commentingRangeProvider},set commentingRangeProvider(R){I.commentingRangeProvider=R},get reactionHandler(){return I.reactionHandler},set reactionHandler(R){I.reactionHandler=R},get activeCommentThread(){return I.activeCommentThread},createCommentThread(R,J,H){return I.createCommentThread(R,J,H).value},dispose:()=>{I.dispose()}});this._localDisposables=[];this._localDisposables.push({dispose:()=>{n.$unregisterCommentController(this.handle)}})}createCommentThread(m,v,y){const D=new r(this.id,this.handle,void 0,m,v,y,this._extension,false);this._threads.set(D.handle,D);return D}$setActiveComment(m){if(!m){this._activeComment=void 0;this._activeThread=void 0;return}const v=this._threads.get(m.commentThreadHandle);if(v){this._activeComment=m.uniqueIdInThread?v.getCommentByUniqueId(m.uniqueIdInThread):void 0;this._activeThread=v}}$createCommentThreadTemplate(m,v,y){const D=new r(this.id,this.handle,void 0,b.revive(m),W.to(v),[],this._extension,true,y);D.collapsibleState=cl.Expanded;this._threads.set(D.handle,D);return D}$updateCommentThreadTemplate(m,v){const y=this._threads.get(m);if(y){y.range=W.to(v)}}$updateCommentThread(m,v){const y=this._threads.get(m);if(!y){return}const D=I=>Object.prototype.hasOwnProperty.call(v,I);if(D("collapseState")){y.collapsibleState=u(v.collapseState)}}$deleteCommentThread(m){const v=this._threads.get(m);v?.dispose();this._threads.delete(m)}getCommentThread(m){return this._threads.get(m)}dispose(){this._threads.forEach(m=>{m.dispose()});this._localDisposables.forEach(m=>m.dispose())}}function a(f,m,v,y){let D=v.get(m);if(!D){D=++f.commentHandle;v.set(m,D)}if(m.state!==void 0){$(y,"commentsDraftState")}if(m.reactions?.some(I=>I.reactors!==void 0)){$(y,"commentReactor")}return{mode:m.mode,contextValue:m.contextValue,uniqueIdInThread:D,body:typeof m.body==="string"?m.body:Pe.from(m.body),userName:m.author.name,userIconPath:m.author.iconPath,label:m.label,commentReactions:m.reactions?m.reactions.map(I=>l(I)):void 0,state:m.state,timestamp:m.timestamp?.toJSON()}}function l(f){return{label:f.label,iconPath:f.iconPath?Mm(f.iconPath):void 0,count:f.count,hasReacted:f.authorHasReacted,reactors:f.reactors&&f.reactors.length>0&&typeof f.reactors[0]!=="string"?f.reactors.map(m=>m.name):f.reactors}}function c(f){return{label:f.label||"",count:f.count||0,iconPath:f.iconPath?b.revive(f.iconPath):"",authorHasReacted:f.hasReacted||false,reactors:f.reactors?.map(m=>({name:m}))}}function u(f){if(f!==void 0){switch(f){case Ed.Expanded:return cl.Expanded;case Ed.Collapsed:return cl.Collapsed}}return cl.Collapsed}function d(f){let m;if(typeof f==="object"){m=f.resolved}else{m=f}if(m!==void 0){switch(m){case Sd.Unresolved:return yu.Unresolved;case Sd.Resolved:return yu.Resolved}}return yu.Unresolved}function p(f){let m=void 0;if(typeof f==="object"){m=f.applicability}if(m!==void 0){switch(m){case Dd.Current:return xu.Current;case Dd.Outdated:return xu.Outdated}}return xu.Current}return new s}var Oh={exports:{}};var M1={};var ND;function GN(){if(ND)return Oh.exports;ND=1;(function(t,e){e=t.exports=ot;var i;if(typeof process==="object"&&M1&&M1.NODE_DEBUG&&/\bsemver\b/i.test(M1.NODE_DEBUG))i=function(){var x=Array.prototype.slice.call(arguments,0);x.unshift("SEMVER");console.log.apply(console,x)};else i=function(){};e.SEMVER_SPEC_VERSION="2.0.0";var n=256;var s=Number.MAX_SAFE_INTEGER||9007199254740991;var r=16;var o=e.re=[];var a=e.src=[];var l=0;var c=l++;a[c]="0|[1-9]\\d*";var u=l++;a[u]="[0-9]+";var d=l++;a[d]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var p=l++;a[p]="("+a[c]+")\\.("+a[c]+")\\.("+a[c]+")";var f=l++;a[f]="("+a[u]+")\\.("+a[u]+")\\.("+a[u]+")";var m=l++;a[m]="(?:"+a[c]+"|"+a[d]+")";var v=l++;a[v]="(?:"+a[u]+"|"+a[d]+")";var y=l++;a[y]="(?:-("+a[m]+"(?:\\."+a[m]+")*))";var D=l++;a[D]="(?:-?("+a[v]+"(?:\\."+a[v]+")*))";var I=l++;a[I]="[0-9A-Za-z-]+";var R=l++;a[R]="(?:\\+("+a[I]+"(?:\\."+a[I]+")*))";var J=l++;var H="v?"+a[p]+a[y]+"?"+a[R]+"?";a[J]="^"+H+"$";var Q="[v=\\s]*"+a[f]+a[D]+"?"+a[R]+"?";var ne=l++;a[ne]="^"+Q+"$";var te=l++;a[te]="((?:<|>)?=?)";var le=l++;a[le]=a[u]+"|x|X|\\*";var Ce=l++;a[Ce]=a[c]+"|x|X|\\*";var Je=l++;a[Je]="[v=\\s]*("+a[Ce]+")(?:\\.("+a[Ce]+")(?:\\.("+a[Ce]+")(?:"+a[y]+")?"+a[R]+"?)?)?";var We=l++;a[We]="[v=\\s]*("+a[le]+")(?:\\.("+a[le]+")(?:\\.("+a[le]+")(?:"+a[D]+")?"+a[R]+"?)?)?";var se=l++;a[se]="^"+a[te]+"\\s*"+a[Je]+"$";var G=l++;a[G]="^"+a[te]+"\\s*"+a[We]+"$";var ce=l++;a[ce]="(?:^|[^\\d])(\\d{1,"+r+"})(?:\\.(\\d{1,"+r+"}))?(?:\\.(\\d{1,"+r+"}))?(?:$|[^\\d])";var ie=l++;a[ie]="(?:~>?)";var _e=l++;a[_e]="(\\s*)"+a[ie]+"\\s+";o[_e]=new RegExp(a[_e],"g");var be="$1~";var Ke=l++;a[Ke]="^"+a[ie]+a[Je]+"$";var Et=l++;a[Et]="^"+a[ie]+a[We]+"$";var Ue=l++;a[Ue]="(?:\\^)";var Gt=l++;a[Gt]="(\\s*)"+a[Ue]+"\\s+";o[Gt]=new RegExp(a[Gt],"g");var Ri="$1^";var At=l++;a[At]="^"+a[Ue]+a[Je]+"$";var dn=l++;a[dn]="^"+a[Ue]+a[We]+"$";var bi=l++;a[bi]="^"+a[te]+"\\s*("+Q+")$|^$";var Vt=l++;a[Vt]="^"+a[te]+"\\s*("+H+")$|^$";var Cn=l++;a[Cn]="(\\s*)"+a[te]+"\\s*("+Q+"|"+a[Je]+")";o[Cn]=new RegExp(a[Cn],"g");var Km="$1$2$3";var Pr=l++;a[Pr]="^\\s*("+a[Je]+")\\s+-\\s+("+a[Je]+")\\s*$";var yo=l++;a[yo]="^\\s*("+a[We]+")\\s+-\\s+("+a[We]+")\\s*$";var je=l++;a[je]="(<|>)?=?\\s*\\*";for(var Hs=0;Hs<l;Hs++){i(Hs,a[Hs]);if(!o[Hs])o[Hs]=new RegExp(a[Hs])}e.parse=Bs;function Bs(x,F){if(x instanceof ot)return x;if(typeof x!=="string")return null;if(x.length>n)return null;var B=F?o[ne]:o[J];if(!B.test(x))return null;try{return new ot(x,F)}catch(re){return null}}e.valid=Vs;function Vs(x,F){var B=Bs(x,F);return B?B.version:null}e.clean=xo;function xo(x,F){var B=Bs(x.trim().replace(/^[=v]+/,""),F);return B?B.version:null}e.SemVer=ot;function ot(x,F){if(x instanceof ot){if(x.loose===F)return x;else x=x.version}else if(typeof x!=="string"){throw new TypeError("Invalid Version: "+x)}if(x.length>n)throw new TypeError("version is longer than "+n+" characters");if(!(this instanceof ot))return new ot(x,F);i("SemVer",x,F);this.loose=F;var B=x.trim().match(F?o[ne]:o[J]);if(!B)throw new TypeError("Invalid Version: "+x);this.raw=x;this.major=+B[1];this.minor=+B[2];this.patch=+B[3];if(this.major>s||this.major<0)throw new TypeError("Invalid major version");if(this.minor>s||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>s||this.patch<0)throw new TypeError("Invalid patch version");if(!B[4])this.prerelease=[];else this.prerelease=B[4].split(".").map(function(re){if(/^[0-9]+$/.test(re)){var K=+re;if(K>=0&&K<s)return K}return re});this.build=B[5]?B[5].split("."):[];this.format()}ot.prototype.format=function(){this.version=this.major+"."+this.minor+"."+this.patch;if(this.prerelease.length)this.version+="-"+this.prerelease.join(".");return this.version};ot.prototype.toString=function(){return this.version};ot.prototype.compare=function(x){i("SemVer.compare",this.version,this.loose,x);if(!(x instanceof ot))x=new ot(x,this.loose);return this.compareMain(x)||this.comparePre(x)};ot.prototype.compareMain=function(x){if(!(x instanceof ot))x=new ot(x,this.loose);return Ws(this.major,x.major)||Ws(this.minor,x.minor)||Ws(this.patch,x.patch)};ot.prototype.comparePre=function(x){if(!(x instanceof ot))x=new ot(x,this.loose);if(this.prerelease.length&&!x.prerelease.length)return-1;else if(!this.prerelease.length&&x.prerelease.length)return 1;else if(!this.prerelease.length&&!x.prerelease.length)return 0;var F=0;do{var B=this.prerelease[F];var re=x.prerelease[F];i("prerelease compare",F,B,re);if(B===void 0&&re===void 0)return 0;else if(re===void 0)return 1;else if(B===void 0)return-1;else if(B===re)continue;else return Ws(B,re)}while(++F)};ot.prototype.inc=function(x,F){switch(x){case"premajor":this.prerelease.length=0;this.patch=0;this.minor=0;this.major++;this.inc("pre",F);break;case"preminor":this.prerelease.length=0;this.patch=0;this.minor++;this.inc("pre",F);break;case"prepatch":this.prerelease.length=0;this.inc("patch",F);this.inc("pre",F);break;case"prerelease":if(this.prerelease.length===0)this.inc("patch",F);this.inc("pre",F);break;case"major":if(this.minor!==0||this.patch!==0||this.prerelease.length===0)this.major++;this.minor=0;this.patch=0;this.prerelease=[];break;case"minor":if(this.patch!==0||this.prerelease.length===0)this.minor++;this.patch=0;this.prerelease=[];break;case"patch":if(this.prerelease.length===0)this.patch++;this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{var B=this.prerelease.length;while(--B>=0){if(typeof this.prerelease[B]==="number"){this.prerelease[B]++;B=-2}}if(B===-1)this.prerelease.push(0)}if(F){if(this.prerelease[0]===F){if(isNaN(this.prerelease[1]))this.prerelease=[F,0]}else this.prerelease=[F,0]}break;default:throw new Error("invalid increment argument: "+x)}this.format();this.raw=this.version;return this};e.inc=Qm;function Qm(x,F,B,re){if(typeof B==="string"){re=B;B=void 0}try{return new ot(x,B).inc(F,re).version}catch(K){return null}}e.diff=Jm;function Jm(x,F){if(ds(x,F)){return null}else{var B=Bs(x);var re=Bs(F);if(B.prerelease.length||re.prerelease.length){for(var K in B){if(K==="major"||K==="minor"||K==="patch"){if(B[K]!==re[K]){return"pre"+K}}}return"prerelease"}for(var K in B){if(K==="major"||K==="minor"||K==="patch"){if(B[K]!==re[K]){return K}}}}}e.compareIdentifiers=Ws;var vh=/^[0-9]+$/;function Ws(x,F){var B=vh.test(x);var re=vh.test(F);if(B&&re){x=+x;F=+F}return B&&!re?-1:re&&!B?1:x<F?-1:x>F?1:0}e.rcompareIdentifiers=Xm;function Xm(x,F){return Ws(F,x)}e.major=wh;function wh(x,F){return new ot(x,F).major}e.minor=Ym;function Ym(x,F){return new ot(x,F).minor}e.patch=Mc;function Mc(x,F){return new ot(x,F).patch}e.compare=hn;function hn(x,F,B){return new ot(x,B).compare(new ot(F,B))}e.compareLoose=Zm;function Zm(x,F){return hn(x,F,true)}e.rcompare=e1;function e1(x,F,B){return hn(F,x,B)}e.sort=Ar;function Ar(x,F){return x.sort(function(B,re){return e.compare(B,re,F)})}e.rsort=t1;function t1(x,F){return x.sort(function(B,re){return e.rcompare(B,re,F)})}e.gt=Va;function Va(x,F,B){return hn(x,F,B)>0}e.lt=zs;function zs(x,F,B){return hn(x,F,B)<0}e.eq=ds;function ds(x,F,B){return hn(x,F,B)===0}e.neq=Uc;function Uc(x,F,B){return hn(x,F,B)!==0}e.gte=$c;function $c(x,F,B){return hn(x,F,B)>=0}e.lte=Hc;function Hc(x,F,B){return hn(x,F,B)<=0}e.cmp=Eo;function Eo(x,F,B,re){var K;switch(F){case"===":if(typeof x==="object")x=x.version;if(typeof B==="object")B=B.version;K=x===B;break;case"!==":if(typeof x==="object")x=x.version;if(typeof B==="object")B=B.version;K=x!==B;break;case"":case"=":case"==":K=ds(x,B,re);break;case"!=":K=Uc(x,B,re);break;case">":K=Va(x,B,re);break;case">=":K=$c(x,B,re);break;case"<":K=zs(x,B,re);break;case"<=":K=Hc(x,B,re);break;default:throw new TypeError("Invalid operator: "+F)}return K}e.Comparator=en;function en(x,F){if(x instanceof en){if(x.loose===F)return x;else x=x.value}if(!(this instanceof en))return new en(x,F);i("comparator",x,F);this.loose=F;this.parse(x);if(this.semver===$n)this.value="";else this.value=this.operator+this.semver.version;i("comp",this)}var $n={};en.prototype.parse=function(x){var F=this.loose?o[bi]:o[Vt];var B=x.match(F);if(!B)throw new TypeError("Invalid comparator: "+x);this.operator=B[1];if(this.operator==="=")this.operator="";if(!B[2])this.semver=$n;else this.semver=new ot(B[2],this.loose)};en.prototype.toString=function(){return this.value};en.prototype.test=function(x){i("Comparator.test",x,this.loose);if(this.semver===$n)return true;if(typeof x==="string")x=new ot(x,this.loose);return Eo(x,this.operator,this.semver,this.loose)};en.prototype.intersects=function(x,F){if(!(x instanceof en)){throw new TypeError("a Comparator is required")}var B;if(this.operator===""){B=new Mt(x.value,F);return Wa(this.value,B,F)}else if(x.operator===""){B=new Mt(this.value,F);return Wa(x.semver,B,F)}var re=(this.operator===">="||this.operator===">")&&(x.operator===">="||x.operator===">");var K=(this.operator==="<="||this.operator==="<")&&(x.operator==="<="||x.operator==="<");var De=this.semver.version===x.semver.version;var Ne=(this.operator===">="||this.operator==="<=")&&(x.operator===">="||x.operator==="<=");var Ge=Eo(this.semver,"<",x.semver,F)&&((this.operator===">="||this.operator===">")&&(x.operator==="<="||x.operator==="<"));var _=Eo(this.semver,">",x.semver,F)&&((this.operator==="<="||this.operator==="<")&&(x.operator===">="||x.operator===">"));return re||K||De&&Ne||Ge||_};e.Range=Mt;function Mt(x,F){if(x instanceof Mt){if(x.loose===F){return x}else{return new Mt(x.raw,F)}}if(x instanceof en){return new Mt(x.value,F)}if(!(this instanceof Mt))return new Mt(x,F);this.loose=F;this.raw=x;this.set=x.split(/\s*\|\|\s*/).map(function(B){return this.parseRange(B.trim())},this).filter(function(B){return B.length});if(!this.set.length){throw new TypeError("Invalid SemVer Range: "+x)}this.format()}Mt.prototype.format=function(){this.range=this.set.map(function(x){return x.join(" ").trim()}).join("||").trim();return this.range};Mt.prototype.toString=function(){return this.range};Mt.prototype.parseRange=function(x){var F=this.loose;x=x.trim();i("range",x,F);var B=F?o[yo]:o[Pr];x=x.replace(B,r1);i("hyphen replace",x);x=x.replace(o[Cn],Km);i("comparator trim",x,o[Cn]);x=x.replace(o[_e],be);x=x.replace(o[Gt],Ri);x=x.split(/\s+/).join(" ");var re=F?o[bi]:o[Vt];var K=x.split(" ").map(function(De){return n1(De,F)}).join(" ").split(/\s+/);if(this.loose){K=K.filter(function(De){return!!De.match(re)})}K=K.map(function(De){return new en(De,F)});return K};Mt.prototype.intersects=function(x,F){if(!(x instanceof Mt)){throw new TypeError("a Range is required")}return this.set.some(function(B){return B.every(function(re){return x.set.some(function(K){return K.every(function(De){return re.intersects(De,F)})})})})};e.toComparators=i1;function i1(x,F){return new Mt(x,F).set.map(function(B){return B.map(function(re){return re.value}).join(" ").trim().split(" ")})}function n1(x,F){i("comp",x);x=k(x,F);i("caret",x);x=bh(x,F);i("tildes",x);x=Bc(x,F);i("xrange",x);x=lt(x,F);i("stars",x);return x}function hi(x){return!x||x.toLowerCase()==="x"||x==="*"}function bh(x,F){return x.trim().split(/\s+/).map(function(B){return s1(B,F)}).join(" ")}function s1(x,F){var B=F?o[Et]:o[Ke];return x.replace(B,function(re,K,De,Ne,Ge){i("tilde",x,re,K,De,Ne,Ge);var _;if(hi(K))_="";else if(hi(De))_=">="+K+".0.0 <"+(+K+1)+".0.0";else if(hi(Ne))_=">="+K+"."+De+".0 <"+K+"."+(+De+1)+".0";else if(Ge){i("replaceTilde pr",Ge);if(Ge.charAt(0)!=="-")Ge="-"+Ge;_=">="+K+"."+De+"."+Ne+Ge+" <"+K+"."+(+De+1)+".0"}else _=">="+K+"."+De+"."+Ne+" <"+K+"."+(+De+1)+".0";i("tilde return",_);return _})}function k(x,F){return x.trim().split(/\s+/).map(function(B){return hs(B,F)}).join(" ")}function hs(x,F){i("caret",x,F);var B=F?o[dn]:o[At];return x.replace(B,function(re,K,De,Ne,Ge){i("caret",x,re,K,De,Ne,Ge);var _;if(hi(K))_="";else if(hi(De))_=">="+K+".0.0 <"+(+K+1)+".0.0";else if(hi(Ne)){if(K==="0")_=">="+K+"."+De+".0 <"+K+"."+(+De+1)+".0";else _=">="+K+"."+De+".0 <"+(+K+1)+".0.0"}else if(Ge){i("replaceCaret pr",Ge);if(Ge.charAt(0)!=="-")Ge="-"+Ge;if(K==="0"){if(De==="0")_=">="+K+"."+De+"."+Ne+Ge+" <"+K+"."+De+"."+(+Ne+1);else _=">="+K+"."+De+"."+Ne+Ge+" <"+K+"."+(+De+1)+".0"}else _=">="+K+"."+De+"."+Ne+Ge+" <"+(+K+1)+".0.0"}else{i("no pr");if(K==="0"){if(De==="0")_=">="+K+"."+De+"."+Ne+" <"+K+"."+De+"."+(+Ne+1);else _=">="+K+"."+De+"."+Ne+" <"+K+"."+(+De+1)+".0"}else _=">="+K+"."+De+"."+Ne+" <"+(+K+1)+".0.0"}i("caret return",_);return _})}function Bc(x,F){i("replaceXRanges",x,F);return x.split(/\s+/).map(function(B){return he(B,F)}).join(" ")}function he(x,F){x=x.trim();var B=F?o[G]:o[se];return x.replace(B,function(re,K,De,Ne,Ge,_){i("xRange",x,re,K,De,Ne,Ge,_);var w=hi(De);var S=w||hi(Ne);var fe=S||hi(Ge);var He=fe;if(K==="="&&He)K="";if(w){if(K===">"||K==="<"){re="<0.0.0"}else{re="*"}}else if(K&&He){if(S)Ne=0;if(fe)Ge=0;if(K===">"){K=">=";if(S){De=+De+1;Ne=0;Ge=0}else if(fe){Ne=+Ne+1;Ge=0}}else if(K==="<="){K="<";if(S)De=+De+1;else Ne=+Ne+1}re=K+De+"."+Ne+"."+Ge}else if(S){re=">="+De+".0.0 <"+(+De+1)+".0.0"}else if(fe){re=">="+De+"."+Ne+".0 <"+De+"."+(+Ne+1)+".0"}i("xRange return",re);return re})}function lt(x,F){i("replaceStars",x,F);return x.trim().replace(o[je],"")}function r1(x,F,B,re,K,De,Ne,Ge,_,w,S,fe,He){if(hi(B))F="";else if(hi(re))F=">="+B+".0.0";else if(hi(K))F=">="+B+"."+re+".0";else F=">="+F;if(hi(_))Ge="";else if(hi(w))Ge="<"+(+_+1)+".0.0";else if(hi(S))Ge="<"+_+"."+(+w+1)+".0";else if(fe)Ge="<="+_+"."+w+"."+S+"-"+fe;else Ge="<="+Ge;return(F+" "+Ge).trim()}Mt.prototype.test=function(x){if(!x)return false;if(typeof x==="string")x=new ot(x,this.loose);for(var F=0;F<this.set.length;F++){if(o1(this.set[F],x))return true}return false};function o1(x,F){for(var B=0;B<x.length;B++){if(!x[B].test(F))return false}if(F.prerelease.length){for(var B=0;B<x.length;B++){i(x[B].semver);if(x[B].semver===$n)continue;if(x[B].semver.prerelease.length>0){var re=x[B].semver;if(re.major===F.major&&re.minor===F.minor&&re.patch===F.patch)return true}}return false}return true}e.satisfies=Wa;function Wa(x,F,B){try{F=new Mt(F,B)}catch(re){return false}return F.test(x)}e.maxSatisfying=a1;function a1(x,F,B){var re=null;var K=null;try{var De=new Mt(F,B)}catch(Ne){return null}x.forEach(function(Ne){if(De.test(Ne)){if(!re||K.compare(Ne)===-1){re=Ne;K=new ot(re,B)}}});return re}e.minSatisfying=za;function za(x,F,B){var re=null;var K=null;try{var De=new Mt(F,B)}catch(Ne){return null}x.forEach(function(Ne){if(De.test(Ne)){if(!re||K.compare(Ne)===1){re=Ne;K=new ot(re,B)}}});return re}e.validRange=l1;function l1(x,F){try{return new Mt(x,F).range||"*"}catch(B){return null}}e.ltr=c1;function c1(x,F,B){return qa(x,F,"<",B)}e.gtr=u1;function u1(x,F,B){return qa(x,F,">",B)}e.outside=qa;function qa(x,F,B,re){x=new ot(x,re);F=new Mt(F,re);var K,De,Ne,Ge,_;switch(B){case">":K=Va;De=Hc;Ne=zs;Ge=">";_=">=";break;case"<":K=zs;De=$c;Ne=Va;Ge="<";_="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(Wa(x,F,re)){return false}for(var w=0;w<F.set.length;++w){var S=F.set[w];var fe=null;var He=null;S.forEach(function(St){if(St.semver===$n){St=new en(">=0.0.0")}fe=fe||St;He=He||St;if(K(St.semver,fe.semver,re)){fe=St}else if(Ne(St.semver,He.semver,re)){He=St}});if(fe.operator===Ge||fe.operator===_){return false}if((!He.operator||He.operator===Ge)&&De(x,He.semver)){return false}else if(He.operator===_&&Ne(x,He.semver)){return false}}return true}e.prerelease=d1;function d1(x,F){var B=Bs(x,F);return B&&B.prerelease.length?B.prerelease:null}e.intersects=h1;function h1(x,F,B){x=new Mt(x,B);F=new Mt(F,B);return x.intersects(F)}e.coerce=f1;function f1(x){if(x instanceof ot)return x;if(typeof x!=="string")return null;var F=x.match(o[ce]);if(F==null)return null;return Bs((F[1]||"0")+"."+(F[2]||"0")+"."+(F[3]||"0"))}})(Oh,Oh.exports);return Oh.exports}GN();const e5=/^(\^|>=)?((\d+)|x)\.((\d+)|x)\.((\d+)|x)(\-.*)?$/;const KN=/^-(\d{4})(\d{2})(\d{2})$/;function QN(t){t=t.trim();return t==="*"||e5.test(t)}function t5(t){if(!QN(t)){return null}t=t.trim();if(t==="*"){return{hasCaret:false,hasGreaterEquals:false,majorBase:0,majorMustEqual:false,minorBase:0,minorMustEqual:false,patchBase:0,patchMustEqual:false,preRelease:null}}const e=t.match(e5);if(!e){return null}return{hasCaret:e[1]==="^",hasGreaterEquals:e[1]===">=",majorBase:e[2]==="x"?0:parseInt(e[2],10),majorMustEqual:e[2]==="x"?false:true,minorBase:e[4]==="x"?0:parseInt(e[4],10),minorMustEqual:e[4]==="x"?false:true,patchBase:e[6]==="x"?0:parseInt(e[6],10),patchMustEqual:e[6]==="x"?false:true,preRelease:e[8]||null}}function i5(t){if(!t){return null}const e=t.majorBase;const i=t.majorMustEqual;const n=t.minorBase;let s=t.minorMustEqual;const r=t.patchBase;let o=t.patchMustEqual;if(t.hasCaret){if(e===0){o=false}else{s=false;o=false}}let a=0;if(t.preRelease){const l=KN.exec(t.preRelease);if(l){const[,c,u,d]=l;a=Date.UTC(Number(c),Number(u)-1,Number(d))}}return{majorBase:e,majorMustEqual:i,minorBase:n,minorMustEqual:s,patchBase:r,patchMustEqual:o,isMinimum:t.hasGreaterEquals,notBefore:a}}class JN{constructor(){this.buffers=[]}add(e){let i=this.buffers.indexOf(e);if(i<0){i=this.buffers.length;this.buffers.push(e)}return i}}function XN(t,e){if(e.serializeBuffersForPostMessage){const i=new JN;const n=(o,a)=>{if(a instanceof ArrayBuffer){const l=i.add(a);return{$$vscode_array_buffer_reference$$:true,index:l}}else if(ArrayBuffer.isView(a)){const l=YN(a);if(l){const c=i.add(a.buffer);return{$$vscode_array_buffer_reference$$:true,index:c,view:{type:l,byteLength:a.byteLength,byteOffset:a.byteOffset}}}}return a};const s=JSON.stringify(t,n);const r=i.buffers.map(o=>{const a=new Uint8Array(o);return ue.wrap(a)});return{message:s,buffers:r}}else{return{message:JSON.stringify(t),buffers:[]}}}function YN(t){switch(t.constructor.name){case"Int8Array":return $t.Int8Array;case"Uint8Array":return $t.Uint8Array;case"Uint8ClampedArray":return $t.Uint8ClampedArray;case"Int16Array":return $t.Int16Array;case"Uint16Array":return $t.Uint16Array;case"Int32Array":return $t.Int32Array;case"Uint32Array":return $t.Uint32Array;case"Float32Array":return $t.Float32Array;case"Float64Array":return $t.Float64Array;case"BigInt64Array":return $t.BigInt64Array;case"BigUint64Array":return $t.BigUint64Array}return void 0}function ZN(t,e){const i=e.map(r=>{const o=new ArrayBuffer(r.byteLength);const a=new Uint8Array(o);a.set(r.buffer);return o});const n=!e.length?void 0:(r,o)=>{if(o&&typeof o==="object"&&o.$$vscode_array_buffer_reference$$){const a=o;const{index:l}=a;const c=i[l];if(a.view){switch(a.view.type){case $t.Int8Array:return new Int8Array(c,a.view.byteOffset,a.view.byteLength/Int8Array.BYTES_PER_ELEMENT);case $t.Uint8Array:return new Uint8Array(c,a.view.byteOffset,a.view.byteLength/Uint8Array.BYTES_PER_ELEMENT);case $t.Uint8ClampedArray:return new Uint8ClampedArray(c,a.view.byteOffset,a.view.byteLength/Uint8ClampedArray.BYTES_PER_ELEMENT);case $t.Int16Array:return new Int16Array(c,a.view.byteOffset,a.view.byteLength/Int16Array.BYTES_PER_ELEMENT);case $t.Uint16Array:return new Uint16Array(c,a.view.byteOffset,a.view.byteLength/Uint16Array.BYTES_PER_ELEMENT);case $t.Int32Array:return new Int32Array(c,a.view.byteOffset,a.view.byteLength/Int32Array.BYTES_PER_ELEMENT);case $t.Uint32Array:return new Uint32Array(c,a.view.byteOffset,a.view.byteLength/Uint32Array.BYTES_PER_ELEMENT);case $t.Float32Array:return new Float32Array(c,a.view.byteOffset,a.view.byteLength/Float32Array.BYTES_PER_ELEMENT);case $t.Float64Array:return new Float64Array(c,a.view.byteOffset,a.view.byteLength/Float64Array.BYTES_PER_ELEMENT);case $t.BigInt64Array:return new BigInt64Array(c,a.view.byteOffset,a.view.byteLength/BigInt64Array.BYTES_PER_ELEMENT);case $t.BigUint64Array:return new BigUint64Array(c,a.view.byteOffset,a.view.byteLength/BigUint64Array.BYTES_PER_ELEMENT);default:throw new Error("Unknown array buffer view type")}}return c}return o};const s=JSON.parse(t,n);return{message:s,arrayBuffers:i}}class eO{#e;#t;#i;#n;#r;#s;#a;#o;#l;#c;#u;#h;constructor(e,i,n,s,r,o,a){this.#a="";this.#l=false;this.#c=false;this._onMessageEmitter=new L;this.onDidReceiveMessage=this._onMessageEmitter.event;this.#d=new L;this._onDidDispose=this.#d.event;this.#e=e;this.#t=i;this.#o=n;this.#n=s;this.#r=r;this.#s=o;this.#u=Dc(o);this.#h=tO(o);this.#i=a}#d;dispose(){this.#l=true;this.#d.fire();this.#d.dispose();this._onMessageEmitter.dispose()}asWebviewUri(e){this.#c=true;return Mu(e,this.#n)}get cspSource(){const e=this.#s.extensionLocation;if(e.scheme===ae.https||e.scheme===ae.http){let i=e.toString();if(!i.endsWith("/")){i+="/"}return i+" "+Vb}return Vb}get html(){this.assertNotDisposed();return this.#a}set html(e){this.assertNotDisposed();if(this.#a!==e){this.#a=e;if(this.#h&&!this.#c&&/(["'])vscode-resource:([^\s'"]+?)(["'])/i.test(e)){this.#c=true;this.#i.report("Webview vscode-resource: uris",this.#s,`Please migrate to use the 'webview.asWebviewUri' api instead: https://aka.ms/vscode-webview-use-aswebviewuri`)}this.#t.$setHtml(this.#e,this.rewriteOldResourceUrlsIfNeeded(e))}}get options(){this.assertNotDisposed();return this.#o}set options(e){this.assertNotDisposed();if(!Xi(this.#o,e)){this.#t.$setOptions(this.#e,n5(this.#s,this.#r,e))}this.#o=e}async postMessage(e){if(this.#l){return false}const i=XN(e,{serializeBuffersForPostMessage:this.#u});return this.#t.$postMessage(this.#e,i.message,...i.buffers)}assertNotDisposed(){if(this.#l){throw new Error("Webview is disposed")}}rewriteOldResourceUrlsIfNeeded(e){if(!this.#h){return e}const i=this.#s.extensionLocation?.scheme===ae.vscodeRemote;const n=this.#s.extensionLocation.scheme===ae.vscodeRemote?this.#s.extensionLocation.authority:void 0;return e.replace(/(["'])(?:vscode-resource):(\/\/([^\s\/'"]+?)(?=\/))?([^\s'"]+?)(["'])/gi,(s,r,o,a,l,c)=>{const u=b.from({scheme:a||"file",path:decodeURIComponent(l)});const d=Mu(u,{isRemote:i,authority:n}).toString();return`${r}${d}${c}`}).replace(/(["'])(?:vscode-webview-resource):(\/\/[^\s\/'"]+\/([^\s\/'"]+?)(?=\/))?([^\s'"]+?)(["'])/gi,(s,r,o,a,l,c)=>{const u=b.from({scheme:a||"file",path:decodeURIComponent(l)});const d=Mu(u,{isRemote:i,authority:n}).toString();return`${r}${d}${c}`})}}function Dc(t){try{const e=i5(t5(t.engines.vscode));return!!e&&e.majorBase>=1&&e.minorBase>=57}catch{return false}}function tO(t){try{const e=i5(t5(t.engines.vscode));if(!e){return false}return e.majorBase<1||e.majorBase===1&&e.minorBase<60}catch{return false}}class iO extends Ee{constructor(e,i,n,s,r){super();this.remoteInfo=i;this.workspace=n;this._logService=s;this._deprecationService=r;this._webviews=new Map;this._webviewProxy=e.getProxy(Y.MainThreadWebviews)}dispose(){super.dispose();for(const e of this._webviews.values()){e.dispose()}this._webviews.clear()}$onMessage(e,i,n){const s=this.getWebview(e);if(s){const{message:r}=ZN(i,n.value);s._onMessageEmitter.fire(r)}}$onMissingCsp(e,i){this._logService.warn(`${i} created a webview without a content security policy: https://aka.ms/vscode-webview-missing-csp`)}createNewWebview(e,i,n){const s=new eO(e,this._webviewProxy,nO(i),this.remoteInfo,this.workspace,n,this._deprecationService);this._webviews.set(e,s);const r=s._onDidDispose(()=>{r.dispose();this.deleteWebview(e)});return s}deleteWebview(e){this._webviews.delete(e)}getWebview(e){return this._webviews.get(e)}}function am(t){return{id:t.identifier,location:t.extensionLocation}}function n5(t,e,i){return{enableCommandUris:i.enableCommandUris,enableScripts:i.enableScripts,enableForms:i.enableForms,portMapping:i.portMapping,localResourceRoots:i.localResourceRoots||sO(t,e)}}function nO(t){return{enableCommandUris:t.enableCommandUris,enableScripts:t.enableScripts,enableForms:t.enableForms,portMapping:t.portMapping,localResourceRoots:t.localResourceRoots?.map(e=>b.from(e))}}function sO(t,e){return[...(e?.getWorkspaceFolders()||[]).map(i=>i.uri),t.extensionLocation]}class In{static{this.enableDebugLogging=false}constructor(e){this.id=e;this._data=new Map;this._idPool=1}add(e){const i=this._idPool++;this._data.set(i,e);this.logDebugInfo();return i}get(e,i){return this._data.has(e)?this._data.get(e)[i]:void 0}delete(e){this._data.delete(e);this.logDebugInfo()}logDebugInfo(){if(!In.enableDebugLogging){return}console.log(`${this.id} cache size - ${this._data.size}`)}}class rO{constructor(e,i){this.document=e;this._storagePath=i;this._backupCounter=1;this._edits=new In("custom documents")}addEdit(e){return this._edits.add([e])}async undo(e,i){await this.getEdit(e).undo();if(!i){this.disposeBackup()}}async redo(e,i){await this.getEdit(e).redo();if(!i){this.disposeBackup()}}disposeEdits(e){for(const i of e){this._edits.delete(i)}}getNewBackupUri(){if(!this._storagePath){throw new Error("Backup requires a valid storage path")}const e=dO(this.document.uri)+this._backupCounter++;return ki(this._storagePath,e)}updateBackup(e){this._backup?.delete();this._backup=e}disposeBackup(){this._backup?.delete();this._backup=void 0}getEdit(e){const i=this._edits.get(e,0);if(!i){throw new Error("No edit found")}return i}}class oO{constructor(){this._documents=new Map}get(e,i){return this._documents.get(this.key(e,i))}add(e,i,n){const s=this.key(e,i.uri);if(this._documents.has(s)){throw new Error(`Document already exists for viewType:${e} resource:${i.uri}`)}const r=new rO(i,n);this._documents.set(s,r);return r}delete(e,i){const n=this.key(e,i.uri);this._documents.delete(n)}key(e,i){return`${e}@@@${i}`}}var ao;(function(t){t[t["Text"]=0]="Text";t[t["Custom"]=1]="Custom"})(ao||(ao={}));class aO{constructor(){this._providers=new Map}addTextProvider(e,i,n){return this.add(e,{type:ao.Text,extension:i,provider:n})}addCustomProvider(e,i,n){return this.add(e,{type:ao.Custom,extension:i,provider:n})}get(e){return this._providers.get(e)}add(e,i){if(this._providers.has(e)){throw new Error(`Provider for viewType:${e} already registered`)}this._providers.set(e,i);return new qe(()=>this._providers.delete(e))}}class lO{constructor(e,i,n,s,r){this._extHostDocuments=i;this._extensionStoragePaths=n;this._extHostWebview=s;this._extHostWebviewPanels=r;this._editorProviders=new aO;this._documents=new oO;this._proxy=e.getProxy(Y.MainThreadCustomEditors)}registerCustomEditorProvider(e,i,n,s){const r=new Ie;if(cO(n)){r.add(this._editorProviders.addTextProvider(i,e,n));this._proxy.$registerTextEditorProvider(am(e),i,s.webviewOptions||{},{supportsMove:!!n.moveCustomTextEditor},Dc(e))}else{r.add(this._editorProviders.addCustomProvider(i,e,n));if(Fh(n)){r.add(n.onDidChangeCustomDocument(o=>{const a=this.getCustomDocumentEntry(i,o.document.uri);if(uO(o)){const l=a.addEdit(o);this._proxy.$onDidEdit(o.document.uri,i,l,o.label)}else{this._proxy.$onContentChange(o.document.uri,i)}}))}this._proxy.$registerCustomEditorProvider(am(e),i,s.webviewOptions||{},!!s.supportsMultipleEditorsPerDocument,Dc(e))}return qe.from(r,new qe(()=>{this._proxy.$unregisterEditorProvider(i)}))}async $createCustomDocument(e,i,n,s,r){const o=this._editorProviders.get(i);if(!o){throw new Error(`No provider found for '${i}'`)}if(o.type!==ao.Custom){throw new Error(`Invalid provide type for '${i}'`)}const a=b.revive(e);const l=await o.provider.openCustomDocument(a,{backupId:n,untitledDocumentData:s?.buffer},r);let c;if(Fh(o.provider)&&this._extensionStoragePaths){c=this._extensionStoragePaths.workspaceValue(o.extension)??this._extensionStoragePaths.globalValue(o.extension)}this._documents.add(i,l,c);return{editable:Fh(o.provider)}}async $disposeCustomDocument(e,i){const n=this._editorProviders.get(i);if(!n){throw new Error(`No provider found for '${i}'`)}if(n.type!==ao.Custom){throw new Error(`Invalid provider type for '${i}'`)}const s=b.revive(e);const{document:r}=this.getCustomDocumentEntry(i,s);this._documents.delete(i,r);r.dispose()}async $resolveCustomEditor(e,i,n,s,r,o){const a=this._editorProviders.get(n);if(!a){throw new Error(`No provider found for '${n}'`)}const l=ai.to(r);const c=this._extHostWebview.createNewWebview(i,s.contentOptions,a.extension);const u=this._extHostWebviewPanels.createNewWebviewPanel(i,n,s.title,l,s.options,c,s.active);const d=b.revive(e);switch(a.type){case ao.Custom:{const{document:p}=this.getCustomDocumentEntry(n,d);return a.provider.resolveCustomEditor(p,u,o)}case ao.Text:{const p=this._extHostDocuments.getDocument(d);return a.provider.resolveCustomTextEditor(p,u,o)}default:{throw new Error("Unknown webview provider type")}}}$disposeEdits(e,i,n){const s=this.getCustomDocumentEntry(i,e);s.disposeEdits(n)}async $onMoveCustomEditor(e,i,n){const s=this._editorProviders.get(n);if(!s){throw new Error(`No provider found for '${n}'`)}if(!s.provider.moveCustomTextEditor){throw new Error(`Provider does not implement move '${n}'`)}const r=this._extHostWebviewPanels.getWebviewPanel(e);if(!r){throw new Error(`No webview found`)}const o=b.revive(i);const a=this._extHostDocuments.getDocument(o);await s.provider.moveCustomTextEditor(a,r,bt.None)}async $undo(e,i,n,s){const r=this.getCustomDocumentEntry(i,e);return r.undo(n,s)}async $redo(e,i,n,s){const r=this.getCustomDocumentEntry(i,e);return r.redo(n,s)}async $revert(e,i,n){const s=this.getCustomDocumentEntry(i,e);const r=this.getCustomEditorProvider(i);await r.revertCustomDocument(s.document,n);s.disposeBackup()}async $onSave(e,i,n){const s=this.getCustomDocumentEntry(i,e);const r=this.getCustomEditorProvider(i);await r.saveCustomDocument(s.document,n);s.disposeBackup()}async $onSaveAs(e,i,n,s){const r=this.getCustomDocumentEntry(i,e);const o=this.getCustomEditorProvider(i);return o.saveCustomDocumentAs(r.document,b.revive(n),s)}async $backup(e,i,n){const s=this.getCustomDocumentEntry(i,e);const r=this.getCustomEditorProvider(i);const o=await r.backupCustomDocument(s.document,{destination:s.getNewBackupUri()},n);s.updateBackup(o);return o.id}getCustomDocumentEntry(e,i){const n=this._documents.get(e,b.revive(i));if(!n){throw new Error("No custom document found")}return n}getCustomEditorProvider(e){const i=this._editorProviders.get(e);const n=i?.provider;if(!n||!Fh(n)){throw new Error("Custom document is not editable")}return n}}function Fh(t){return!!t.onDidChangeCustomDocument}function cO(t){return typeof t.resolveCustomTextEditor==="function"}function uO(t){return typeof t.undo==="function"&&typeof t.redo==="function"}function dO(t){const e=t.scheme===ae.file||t.scheme===ae.untitled?t.fsPath:t.toString();return td(e)+""}var Ro;class lm{#e;#t;#i;constructor(e,i,n,s,r,o,a,l){this._name=e;this._owner=i;this._maxDiagnosticsTotal=n;this._maxDiagnosticsPerFile=s;this._modelVersionIdProvider=r;this._isDisposed=false;this._maxDiagnosticsTotal=Math.max(s,n);this.#i=new Ft(c=>o.getComparisonKey(c));this.#e=a;this.#t=l}dispose(){if(!this._isDisposed){this.#t.fire([...this.#i.keys()]);this.#e?.$clear(this._owner);this.#i.clear();this._isDisposed=true}}get name(){this._checkDisposed();return this._name}set(e,i){if(!e){this.clear();return}this._checkDisposed();let n=[];if(b.isUri(e)){if(!i){this.delete(e);return}this.#i.set(e,i.slice());n=[e]}else if(Array.isArray(e)){n=[];let o;e=[...e].sort(lm._compareIndexedTuplesByUri);for(const a of e){const[l,c]=a;if(!o||l.toString()!==o.toString()){if(o&&this.#i.get(o).length===0){this.#i.delete(o)}o=l;n.push(l);this.#i.set(l,[])}if(!c){const u=this.#i.get(l);if(u){u.length=0}}else{const u=this.#i.get(l);u?.push(...c)}}}this.#t.fire(n);if(!this.#e){return}const s=[];let r=0;for(const o of n){let a=[];const l=this.#i.get(o);if(l){if(l.length>this._maxDiagnosticsPerFile){a=[];const c=[Di.Error,Di.Warning,Di.Information,Di.Hint];e:for(let u=0;u<4;u++){for(const d of l){if(d.severity===c[u]){const p=a.push({...dc.from(d),modelVersionId:this._modelVersionIdProvider(o)});if(p===this._maxDiagnosticsPerFile){break e}}}}a.push({severity:Ki.Info,message:h(2555,"Not showing {0} further errors and warnings.",l.length-this._maxDiagnosticsPerFile),startLineNumber:a[a.length-1].startLineNumber,startColumn:a[a.length-1].startColumn,endLineNumber:a[a.length-1].endLineNumber,endColumn:a[a.length-1].endColumn})}else{a=l.map(c=>({...dc.from(c),modelVersionId:this._modelVersionIdProvider(o)}))}}s.push([o,a]);r+=a.length;if(r>this._maxDiagnosticsTotal){break}}this.#e.$changeMany(this._owner,s)}delete(e){this._checkDisposed();this.#t.fire([e]);this.#i.delete(e);this.#e?.$changeMany(this._owner,[[e,void 0]])}clear(){this._checkDisposed();this.#t.fire([...this.#i.keys()]);this.#i.clear();this.#e?.$clear(this._owner)}forEach(e,i){this._checkDisposed();for(const[n,s]of this){e.call(i,n,s,this)}}*[Symbol.iterator](){this._checkDisposed();for(const e of this.#i.keys()){yield[e,this.get(e)]}}get(e){this._checkDisposed();const i=this.#i.get(e);if(Array.isArray(i)){return Object.freeze(i.slice(0))}return[]}has(e){this._checkDisposed();return Array.isArray(this.#i.get(e))}_checkDisposed(){if(this._isDisposed){throw new Error("illegal state - object is disposed")}}static _compareIndexedTuplesByUri(e,i){if(e[0].toString()<i[0].toString()){return-1}else if(e[0].toString()>i[0].toString()){return 1}else{return 0}}}let Wb=class q${static{Ro=this}static{this._idPool=0}static{this._maxDiagnosticsPerFile=1e3}static{this._maxDiagnosticsTotal=1.1*this._maxDiagnosticsPerFile}static _mapper(e){const i=new Ft;for(const n of e){i.set(n,n)}return{uris:Object.freeze(Array.from(i.values()))}}constructor(e,i,n,s){this._logService=i;this._fileSystemInfoService=n;this._extHostDocumentsAndEditors=s;this._collections=new Map;this._onDidChangeDiagnostics=new dT({merge:r=>r.flat(),delay:50});this.onDidChangeDiagnostics=Bt.map(this._onDidChangeDiagnostics.event,Ro._mapper);this._proxy=e.getProxy(Y.MainThreadDiagnostics)}createDiagnosticCollection(e,i){const{_collections:n,_proxy:s,_onDidChangeDiagnostics:r,_logService:o,_fileSystemInfoService:a,_extHostDocumentsAndEditors:l}=this;const c=new class{$changeMany(p,f){s.$changeMany(p,f);o.trace("[DiagnosticCollection] change many (extension, owner, uris)",e.value,p,f.length===0?"CLEARING":f)}$clear(p){s.$clear(p);o.trace("[DiagnosticCollection] remove all (extension, owner)",e.value,p)}dispose(){s.dispose()}};let u;if(!i){i="_generated_diagnostic_collection_name_#"+Ro._idPool++;u=i}else if(!n.has(i)){u=i}else{this._logService.warn(`DiagnosticCollection with name '${i}' does already exist.`);do{u=i+Ro._idPool++}while(n.has(u))}const d=new class extends lm{constructor(){super(i,u,Ro._maxDiagnosticsTotal,Ro._maxDiagnosticsPerFile,p=>l.getDocument(p)?.version,a.extUri,c,r);n.set(u,this)}dispose(){super.dispose();n.delete(u)}};return d}getDiagnostics(e){if(e){return this._getDiagnostics(e)}else{const i=new Map;const n=[];for(const s of this._collections.values()){s.forEach((r,o)=>{let a=i.get(r.toString());if(typeof a==="undefined"){a=n.length;i.set(r.toString(),a);n.push([r,[]])}n[a][1]=n[a][1].concat(...o)})}return n}}_getDiagnostics(e){let i=[];for(const n of this._collections.values()){if(n.has(e)){i=i.concat(n.get(e))}}return i}$acceptMarkersChange(e){if(!this._mirrorCollection){const i="_generated_mirror";const n=new lm(i,i,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,s=>void 0,this._fileSystemInfoService.extUri,void 0,this._onDidChangeDiagnostics);this._collections.set(i,n);this._mirrorCollection=n}for(const[i,n]of e){this._mirrorCollection.set(b.revive(i),n.map(dc.to))}}};Wb=Ro=z([O(1,at),O(2,Tc)],Wb);class hO{constructor(e){this._proxy=e.getProxy(Y.MainThreadDialogs)}showOpenDialog(e){return this._proxy.$showOpenDialog(e).then(i=>{return i?i.map(n=>b.revive(n)):void 0})}showSaveDialog(e){return this._proxy.$showSaveDialog(e).then(i=>{return i?b.revive(i):void 0})}}class Cy{static{this._handlePool=0}constructor(e,i,n){this._documentsAndEditors=i;this._logService=n;this._documentContentProviders=new Map;this._proxy=e.getProxy(Y.MainThreadDocumentContentProviders)}registerTextDocumentContentProvider(e,i){if(Object.keys(ae).indexOf(e)>=0){throw new Error(`scheme '${e}' already registered`)}const n=Cy._handlePool++;this._documentContentProviders.set(n,i);this._proxy.$registerTextContentProvider(n,e);let s;if(typeof i.onDidChange==="function"){let r;s=i.onDidChange(async o=>{if(o.scheme!==e){this._logService.warn(`Provider for scheme '${e}' is firing event for schema '${o.scheme}' which will be IGNORED`);return}if(!this._documentsAndEditors.getDocument(o)){return}if(r){await r}const a=this.$provideTextDocumentContent(n,o).then(async l=>{if(!l&&typeof l!=="string"){return}const c=this._documentsAndEditors.getDocument(o);if(!c){return}const u=uI(l);if(!c.equalLines(u)){return this._proxy.$onVirtualDocumentChange(o,l)}}).catch(Pi).finally(()=>{if(r===a){r=void 0}});r=a})}return new qe(()=>{if(this._documentContentProviders.delete(n)){this._proxy.$unregisterTextContentProvider(n)}if(s){s.dispose();s=void 0}})}$provideTextDocumentContent(e,i){const n=this._documentContentProviders.get(e);if(!n){return Promise.reject(new Error(`unsupported uri-scheme: ${i.scheme}`))}return Promise.resolve(n.provideTextDocumentContent(b.revive(i),bt.None))}}class fO{constructor(e,i,n,s={timeout:1500,errors:3}){this._logService=e;this._documents=i;this._mainThreadBulkEdits=n;this._thresholds=s;this._callbacks=new wo;this._badListeners=new WeakMap}dispose(){this._callbacks.clear()}getOnWillSaveTextDocumentEvent(e){return(i,n,s)=>{const r=this._callbacks.push([i,n,e]);const o={dispose:r};if(Array.isArray(s)){s.push(o)}return o}}async $participateInSave(e,i){const n=b.revive(e);let s=false;const r=setTimeout(()=>s=true,this._thresholds.timeout);const o=[];try{for(const a of[...this._callbacks]){if(s){break}const l=this._documents.getDocument(n);const c=await this._deliverEventAsyncAndBlameBadListeners(a,{document:l,reason:Ig.to(i)});o.push(c)}}finally{clearTimeout(r)}return o}_deliverEventAsyncAndBlameBadListeners([e,i,n],s){const r=this._badListeners.get(e);if(typeof r==="number"&&r>this._thresholds.errors){return Promise.resolve(false)}return this._deliverEventAsync(n,e,i,s).then(()=>{return true},o=>{this._logService.error(`onWillSaveTextDocument-listener from extension '${n.identifier.value}' threw ERROR`);this._logService.error(o);if(!(o instanceof Error)||o.message!=="concurrent_edits"){const a=this._badListeners.get(e);this._badListeners.set(e,!a?1:a+1);if(typeof a==="number"&&a>this._thresholds.errors){this._logService.info(`onWillSaveTextDocument-listener from extension '${n.identifier.value}' will now be IGNORED because of timeouts and/or errors`)}}return false})}_deliverEventAsync(e,i,n,s){const r=[];const o=Date.now();const{document:a,reason:l}=s;const{version:c}=a;const u=Object.freeze({document:a,reason:l,waitUntil(d){if(Object.isFrozen(r)){throw d0("waitUntil can not be called async")}r.push(Promise.resolve(d))}});try{i.apply(n,[u])}catch(d){return Promise.reject(d)}return new Promise((d,p)=>{const f=setTimeout(()=>p(new Error("timeout")),this._thresholds.timeout);return Promise.all(r).then(m=>{this._logService.debug(`onWillSaveTextDocument-listener from extension '${e.identifier.value}' finished after ${Date.now()-o}ms`);clearTimeout(f);d(m)}).catch(m=>{clearTimeout(f);p(m)})}).then(d=>{const p={edits:[]};for(const f of d){if(Array.isArray(f)&&f.every(m=>m instanceof go)){for(const{newText:m,newEol:v,range:y}of f){p.edits.push({resource:a.uri,versionId:void 0,textEdit:{range:y&&W.from(y),text:m,eol:v&&gc.from(v)}})}}}if(p.edits.length===0){return void 0}if(c===a.version){return this._mainThreadBulkEdits.$tryApplyWorkspaceEdit(new Bi(p))}return Promise.reject(new Error("concurrent_edits"))})}}class pO{constructor(e,i){this._onDidAddDocument=new L;this._onDidRemoveDocument=new L;this._onDidChangeDocument=new L;this._onDidSaveDocument=new L;this.onDidAddDocument=this._onDidAddDocument.event;this.onDidRemoveDocument=this._onDidRemoveDocument.event;this.onDidChangeDocument=this._onDidChangeDocument.event;this.onDidSaveDocument=this._onDidSaveDocument.event;this._toDispose=new Ie;this._documentLoader=new Map;this._proxy=e.getProxy(Y.MainThreadDocuments);this._documentsAndEditors=i;this._documentsAndEditors.onDidRemoveDocuments(n=>{for(const s of n){this._onDidRemoveDocument.fire(s.document)}},void 0,this._toDispose);this._documentsAndEditors.onDidAddDocuments(n=>{for(const s of n){this._onDidAddDocument.fire(s.document)}},void 0,this._toDispose)}dispose(){this._toDispose.dispose()}getAllDocumentData(){return[...this._documentsAndEditors.allDocuments()]}getDocumentData(e){if(!e){return void 0}const i=this._documentsAndEditors.getDocument(e);if(i){return i}return void 0}getDocument(e){const i=this.getDocumentData(e);if(!i?.document){throw new Error(`Unable to retrieve document from URI '${e}'`)}return i.document}ensureDocumentData(e,i){const n=this._documentsAndEditors.getDocument(e);if(n&&(!i?.encoding||n.document.encoding===i.encoding)){return Promise.resolve(n)}let s=this._documentLoader.get(e.toString());if(!s){s=this._proxy.$tryOpenDocument(e,i).then(r=>{this._documentLoader.delete(e.toString());const o=b.revive(r);return zl(this._documentsAndEditors.getDocument(o))},r=>{this._documentLoader.delete(e.toString());return Promise.reject(r)});this._documentLoader.set(e.toString(),s)}else{if(i?.encoding){s=s.then(r=>{if(r.document.encoding!==i.encoding){return this.ensureDocumentData(e,i)}return r})}}return s}createDocumentData(e){return this._proxy.$tryCreateDocument(e).then(i=>b.revive(i))}$acceptModelLanguageChanged(e,i){const n=b.revive(e);const s=this._documentsAndEditors.getDocument(n);if(!s){throw new Error("unknown document")}this._onDidRemoveDocument.fire(s.document);s._acceptLanguageId(i);this._onDidAddDocument.fire(s.document)}$acceptModelSaved(e){const i=b.revive(e);const n=this._documentsAndEditors.getDocument(i);if(!n){throw new Error("unknown document")}this.$acceptDirtyStateChanged(e,false);this._onDidSaveDocument.fire(n.document)}$acceptDirtyStateChanged(e,i){const n=b.revive(e);const s=this._documentsAndEditors.getDocument(n);if(!s){throw new Error("unknown document")}s._acceptIsDirty(i);this._onDidChangeDocument.fire({document:s.document,contentChanges:[],reason:void 0})}$acceptEncodingChanged(e,i){const n=b.revive(e);const s=this._documentsAndEditors.getDocument(n);if(!s){throw new Error("unknown document")}s._acceptEncoding(i);this._onDidChangeDocument.fire({document:s.document,contentChanges:[],reason:void 0})}$acceptModelChanged(e,i,n){const s=b.revive(e);const r=this._documentsAndEditors.getDocument(s);if(!r){throw new Error("unknown document")}r._acceptIsDirty(n);r.onEvents(i);let o=void 0;if(i.isUndoing){o=gd.Undo}else if(i.isRedoing){o=gd.Redo}this._onDidChangeDocument.fire(II({document:r.document,contentChanges:i.changes.map(a=>{return{range:W.to(a.range),rangeOffset:a.rangeOffset,rangeLength:a.rangeLength,text:a.text}}),reason:o}))}setWordDefinitionFor(e,i){CL(e,i)}}class gO{constructor(e){this._provider=new Map;this._onDidChange=new L;this.onDidChange=this._onDidChange.event;this._allKnownModels=new Set;this._handlePool=0;this._proxy=e.getProxy(Y.MainThreadEmbeddings)}registerEmbeddingsProvider(e,i,n){if(this._allKnownModels.has(i)){throw new Error("An embeddings provider for this model is already registered")}const s=this._handlePool++;this._proxy.$registerEmbeddingProvider(s,i);this._provider.set(s,{id:i,provider:n});return ge(()=>{this._allKnownModels.delete(i);this._proxy.$unregisterEmbeddingProvider(s);this._provider.delete(s)})}async computeEmbeddings(e,i,n){n??=bt.None;let s=false;if(typeof i==="string"){i=[i];s=true}const r=await this._proxy.$computeEmbeddings(e,i,n);if(r.length!==i.length){throw new Error}if(s){if(r.length!==1){throw new Error}return r[0]}return r}async $provideEmbeddings(e,i,n){const s=this._provider.get(e);if(!s){return[]}const r=await s.provider.provideEmbeddings(i,n);if(!r){return[]}return r}get embeddingsModels(){return Array.from(this._allKnownModels)}$acceptEmbeddingModels(e){this._allKnownModels=new Set(e);this._onDidChange.fire()}}class mO{constructor(e){this._AiEmbeddingVectorProviders=new Map;this._nextHandle=0;this._proxy=e.getProxy(Y.MainThreadAiEmbeddingVector)}async $provideAiEmbeddingVector(e,i,n){if(this._AiEmbeddingVectorProviders.size===0){throw new Error("No embedding vector providers registered")}const s=this._AiEmbeddingVectorProviders.get(e);if(!s){throw new Error("Embedding vector provider not found")}const r=await s.provideEmbeddingVector(i,n);if(!r){throw new Error("Embedding vector provider returned undefined")}return r}registerEmbeddingVectorProvider(e,i,n){const s=this._nextHandle;this._nextHandle++;this._AiEmbeddingVectorProviders.set(s,n);this._proxy.$registerAiEmbeddingVectorProvider(i,s);return new qe(()=>{this._proxy.$unregisterAiEmbeddingVectorProvider(s);this._AiEmbeddingVectorProviders.delete(s)})}}var ye;(function(t){t[t["Invalid"]=0]="Invalid";t[t["Start"]=1]="Start";t[t["H"]=2]="H";t[t["HT"]=3]="HT";t[t["HTT"]=4]="HTT";t[t["HTTP"]=5]="HTTP";t[t["F"]=6]="F";t[t["FI"]=7]="FI";t[t["FIL"]=8]="FIL";t[t["BeforeColon"]=9]="BeforeColon";t[t["AfterColon"]=10]="AfterColon";t[t["AlmostThere"]=11]="AlmostThere";t[t["End"]=12]="End";t[t["Accept"]=13]="Accept";t[t["LastKnownState"]=14]="LastKnownState"})(ye||(ye={}));class _O{constructor(e,i,n){const s=new Uint8Array(e*i);for(let r=0,o=e*i;r<o;r++){s[r]=n}this._data=s;this.rows=e;this.cols=i}get(e,i){return this._data[e*this.cols+i]}set(e,i,n){this._data[e*this.cols+i]=n}}class s5{constructor(e){let i=0;let n=ye.Invalid;for(let r=0,o=e.length;r<o;r++){const[a,l,c]=e[r];if(l>i){i=l}if(a>n){n=a}if(c>n){n=c}}i++;n++;const s=new _O(n,i,ye.Invalid);for(let r=0,o=e.length;r<o;r++){const[a,l,c]=e[r];s.set(a,l,c)}this._states=s;this._maxCharCode=i}nextState(e,i){if(i<0||i>=this._maxCharCode){return ye.Invalid}return this._states.get(e,i)}}let U1=null;function vO(){if(U1===null){U1=new s5([[ye.Start,A.h,ye.H],[ye.Start,A.H,ye.H],[ye.Start,A.f,ye.F],[ye.Start,A.F,ye.F],[ye.H,A.t,ye.HT],[ye.H,A.T,ye.HT],[ye.HT,A.t,ye.HTT],[ye.HT,A.T,ye.HTT],[ye.HTT,A.p,ye.HTTP],[ye.HTT,A.P,ye.HTTP],[ye.HTTP,A.s,ye.BeforeColon],[ye.HTTP,A.S,ye.BeforeColon],[ye.HTTP,A.Colon,ye.AfterColon],[ye.F,A.i,ye.FI],[ye.F,A.I,ye.FI],[ye.FI,A.l,ye.FIL],[ye.FI,A.L,ye.FIL],[ye.FIL,A.e,ye.BeforeColon],[ye.FIL,A.E,ye.BeforeColon],[ye.BeforeColon,A.Colon,ye.AfterColon],[ye.AfterColon,A.Slash,ye.AlmostThere],[ye.AlmostThere,A.Slash,ye.End]])}return U1}var Tt;(function(t){t[t["None"]=0]="None";t[t["ForceTermination"]=1]="ForceTermination";t[t["CannotEndIn"]=2]="CannotEndIn"})(Tt||(Tt={}));let Jc=null;function wO(){if(Jc===null){Jc=new Wm(Tt.None);const t=` 	<>'"`;for(let i=0;i<t.length;i++){Jc.set(t.charCodeAt(i),Tt.ForceTermination)}const e=".,;:";for(let i=0;i<e.length;i++){Jc.set(e.charCodeAt(i),Tt.CannotEndIn)}}return Jc}class cm{static _createLink(e,i,n,s,r){let o=r-1;do{const a=i.charCodeAt(o);const l=e.get(a);if(l!==Tt.CannotEndIn){break}o--}while(o>s);if(s>0){const a=i.charCodeAt(s-1);const l=i.charCodeAt(o);if(a===A.OpenParen&&l===A.CloseParen||a===A.OpenSquareBracket&&l===A.CloseSquareBracket||a===A.OpenCurlyBrace&&l===A.CloseCurlyBrace){o--}}return{range:{startLineNumber:n,startColumn:s+1,endLineNumber:n,endColumn:o+2},url:i.substring(s,o+1)}}static computeLinks(e,i=vO()){const n=wO();const s=[];for(let r=1,o=e.getLineCount();r<=o;r++){const a=e.getLineContent(r);const l=a.length;let c=0;let u=0;let d=0;let p=ye.Start;let f=false;let m=false;let v=false;let y=false;while(c<l){let D=false;const I=a.charCodeAt(c);if(p===ye.Accept){let R;switch(I){case A.OpenParen:f=true;R=Tt.None;break;case A.CloseParen:R=f?Tt.None:Tt.ForceTermination;break;case A.OpenSquareBracket:v=true;m=true;R=Tt.None;break;case A.CloseSquareBracket:v=false;R=m?Tt.None:Tt.ForceTermination;break;case A.OpenCurlyBrace:y=true;R=Tt.None;break;case A.CloseCurlyBrace:R=y?Tt.None:Tt.ForceTermination;break;case A.SingleQuote:case A.DoubleQuote:case A.BackTick:if(d===I){R=Tt.ForceTermination}else if(d===A.SingleQuote||d===A.DoubleQuote||d===A.BackTick){R=Tt.None}else{R=Tt.ForceTermination}break;case A.Asterisk:R=d===A.Asterisk?Tt.ForceTermination:Tt.None;break;case A.Pipe:R=d===A.Pipe?Tt.ForceTermination:Tt.None;break;case A.Space:R=v?Tt.None:Tt.ForceTermination;break;default:R=n.get(I)}if(R===Tt.ForceTermination){s.push(cm._createLink(n,a,r,u,c));D=true}}else if(p===ye.End){let R;if(I===A.OpenSquareBracket){m=true;R=Tt.None}else{R=n.get(I)}if(R===Tt.ForceTermination){D=true}else{p=ye.Accept}}else{p=i.nextState(p,I);if(p===ye.Invalid){D=true}}if(D){p=ye.Start;f=false;m=false;y=false;u=c+1;d=I}c++}if(p===ye.Accept){s.push(cm._createLink(n,a,r,u,l))}}return s}}class bO{constructor(){this._schemes=[]}add(e){this._stateMachine=void 0;this._schemes.push(e)}delete(e){const i=this._schemes.indexOf(e);if(i>=0){this._schemes.splice(i,1);this._stateMachine=void 0}}_initStateMachine(){if(!this._stateMachine){const e=this._schemes.sort();const i=[];let n;let s;let r=ye.LastKnownState;let o=ye.LastKnownState;for(const a of e){let l=!n?0:eP(n,a);if(l===0){s=ye.Start}else{s=o}for(;l<a.length;l++){if(l+1===a.length){r=o;o=ye.BeforeColon}else{o+=1}i.push([s,a.toUpperCase().charCodeAt(l),o]);i.push([s,a.toLowerCase().charCodeAt(l),o]);s=o}n=a;o=r}i.push([ye.BeforeColon,A.Colon,ye.AfterColon]);i.push([ye.AfterColon,A.Slash,ye.End]);this._stateMachine=new s5(i)}}provideDocumentLinks(e){this._initStateMachine();const i=[];const n=cm.computeLinks({getLineContent(s){return e.lineAt(s-1).text},getLineCount(){return e.lineCount}},this._stateMachine);for(const s of n){const r=pa.to(s);if(r.target){i.push(r)}}return i}}class um{constructor(e,i){this._extHostLanguageFeatures=i;this._linkProvider=new bO;this._fsProvider=new Map;this._registeredSchemes=new Set;this._watches=new Map;this._handlePool=0;this._proxy=e.getProxy(Y.MainThreadFileSystem)}dispose(){this._linkProviderRegistration?.dispose()}registerFileSystemProvider(e,i,n,s={}){um._validateFileSystemProvider(n);if(this._registeredSchemes.has(i)){throw new Error(`a provider for the scheme '${i}' is already registered`)}if(!this._linkProviderRegistration){this._linkProviderRegistration=this._extHostLanguageFeatures.registerDocumentLinkProvider(e,"*",this._linkProvider)}const r=this._handlePool++;this._linkProvider.add(i);this._registeredSchemes.add(i);this._fsProvider.set(r,n);let o=ws.FileReadWrite;if(s.isCaseSensitive){o+=ws.PathCaseSensitive}if(s.isReadonly){o+=ws.Readonly}if(typeof n.copy==="function"){o+=ws.FileFolderCopy}if(typeof n.open==="function"&&typeof n.close==="function"&&typeof n.read==="function"&&typeof n.write==="function"){$(e,"fsChunks");o+=ws.FileOpenReadWriteClose}let a;if(s.isReadonly&&Ir(s.isReadonly)&&s.isReadonly.value!==""){a={value:s.isReadonly.value,isTrusted:s.isReadonly.isTrusted,supportThemeIcons:s.isReadonly.supportThemeIcons,supportHtml:s.isReadonly.supportHtml,baseUri:s.isReadonly.baseUri,uris:s.isReadonly.uris}}this._proxy.$registerFileSystemProvider(r,i,o,a).catch(c=>{console.error(`FAILED to register filesystem provider of ${e.identifier.value}-extension for the scheme ${i}`);console.error(c)});const l=n.onDidChangeFile(c=>{const u=[];for(const d of c){const{uri:p,type:f}=d;if(p.scheme!==i){continue}let m;switch(f){case Nl.Changed:m=es.UPDATED;break;case Nl.Created:m=es.ADDED;break;case Nl.Deleted:m=es.DELETED;break;default:throw new Error("Unknown FileChangeType")}u.push({resource:p,type:m})}this._proxy.$onFileSystemChange(r,u)});return ge(()=>{l.dispose();this._linkProvider.delete(i);this._registeredSchemes.delete(i);this._fsProvider.delete(r);this._proxy.$unregisterProvider(r)})}static _validateFileSystemProvider(e){if(!e){throw new Error("MISSING provider")}if(typeof e.watch!=="function"){throw new Error("Provider does NOT implement watch")}if(typeof e.stat!=="function"){throw new Error("Provider does NOT implement stat")}if(typeof e.readDirectory!=="function"){throw new Error("Provider does NOT implement readDirectory")}if(typeof e.createDirectory!=="function"){throw new Error("Provider does NOT implement createDirectory")}if(typeof e.readFile!=="function"){throw new Error("Provider does NOT implement readFile")}if(typeof e.writeFile!=="function"){throw new Error("Provider does NOT implement writeFile")}if(typeof e.delete!=="function"){throw new Error("Provider does NOT implement delete")}if(typeof e.rename!=="function"){throw new Error("Provider does NOT implement rename")}}static _asIStat(e){const{type:i,ctime:n,mtime:s,size:r,permissions:o}=e;return{type:i,ctime:n,mtime:s,size:r,permissions:o}}$stat(e,i){return Promise.resolve(this._getFsProvider(e).stat(b.revive(i))).then(n=>um._asIStat(n))}$readdir(e,i){return Promise.resolve(this._getFsProvider(e).readDirectory(b.revive(i)))}$readFile(e,i){return Promise.resolve(this._getFsProvider(e).readFile(b.revive(i))).then(n=>ue.wrap(n))}$writeFile(e,i,n,s){return Promise.resolve(this._getFsProvider(e).writeFile(b.revive(i),n.buffer,s))}$delete(e,i,n){return Promise.resolve(this._getFsProvider(e).delete(b.revive(i),n))}$rename(e,i,n,s){return Promise.resolve(this._getFsProvider(e).rename(b.revive(i),b.revive(n),s))}$copy(e,i,n,s){const r=this._getFsProvider(e);if(!r.copy){throw new Error('FileSystemProvider does not implement "copy"')}return Promise.resolve(r.copy(b.revive(i),b.revive(n),s))}$mkdir(e,i){return Promise.resolve(this._getFsProvider(e).createDirectory(b.revive(i)))}$watch(e,i,n,s){const r=this._getFsProvider(e).watch(b.revive(n),s);this._watches.set(i,r)}$unwatch(e,i){const n=this._watches.get(i);if(n){n.dispose();this._watches.delete(i)}}$open(e,i,n){const s=this._getFsProvider(e);if(!s.open){throw new Error('FileSystemProvider does not implement "open"')}return Promise.resolve(s.open(b.revive(i),n))}$close(e,i){const n=this._getFsProvider(e);if(!n.close){throw new Error('FileSystemProvider does not implement "close"')}return Promise.resolve(n.close(i))}$read(e,i,n,s){const r=this._getFsProvider(e);if(!r.read){throw new Error('FileSystemProvider does not implement "read"')}const o=ue.alloc(s);return Promise.resolve(r.read(i,n,o.buffer,0,s)).then(a=>{return o.slice(0,a)})}$write(e,i,n,s){const r=this._getFsProvider(e);if(!r.write){throw new Error('FileSystemProvider does not implement "write"')}return Promise.resolve(r.write(i,n,s.buffer,0,s.byteLength))}_getFsProvider(e){const i=this._fsProvider.get(e);if(!i){const n=new Error;n.name="ENOPRO";n.message=`no provider`;throw n}return i}}class r5 extends Ee{static{this.MAX_RESTARTS=5}constructor(e,i,n,s){super();this.onFileChanges=e;this.onLogMessage=i;this.verboseLogging=n;this.options=s;this.watcherDisposables=this._register(new eo);this.requests=void 0;this.restartCounter=0}init(){const e=new Ie;this.watcherDisposables.value=e;this.watcher=this.createWatcher(e);this.watcher.setVerboseLogging(this.verboseLogging);e.add(this.watcher.onDidChangeFile(i=>this.onFileChanges(i)));e.add(this.watcher.onDidLogMessage(i=>this.onLogMessage(i)));e.add(this.watcher.onDidError(i=>this.onError(i.error,i.request)))}onError(e,i){if(this.canRestart(e,i)){if(this.restartCounter<r5.MAX_RESTARTS&&this.requests){this.error(`restarting watcher after unexpected error: ${e}`);this.restart(this.requests)}else{this.error(`gave up attempting to restart watcher after unexpected error: ${e}`)}}else{this.error(e)}}canRestart(e,i){if(!this.options.restartOnError){return false}if(i){return false}if(e.indexOf("No space left on device")!==-1||e.indexOf("EMFILE")!==-1){return false}return true}restart(e){this.restartCounter++;this.init();this.watch(e)}async watch(e){this.requests=e;await this.watcher?.watch(e)}async setVerboseLogging(e){this.verboseLogging=e;await this.watcher?.setVerboseLogging(e)}error(e){this.onLogMessage({type:"error",message:`[File Watcher (${this.options.type})] ${e}`})}trace(e){this.onLogMessage({type:"trace",message:`[File Watcher (${this.options.type})] ${e}`})}dispose(){this.watcher=void 0;return super.dispose()}}function yO(t,e){if(typeof e==="string"&&!e.startsWith(jo)&&!Nf(e)){return{base:t,pattern:e}}return e}class xO{get ignoreCreateEvents(){return Boolean(this._config&1)}get ignoreChangeEvents(){return Boolean(this._config&2)}get ignoreDeleteEvents(){return Boolean(this._config&4)}constructor(e,i,n,s,r,o,a){this.session=Math.random();this._onDidCreate=new L;this._onDidChange=new L;this._onDidDelete=new L;this._config=0;if(a.ignoreCreateEvents){this._config+=1}if(a.ignoreChangeEvents){this._config+=2}if(a.ignoreDeleteEvents){this._config+=4}const l=Yl(o);const c=typeof o==="string";const u=r(d=>{if(typeof d.session==="number"&&d.session!==this.session){return}if(!a.ignoreCreateEvents){for(const p of d.created){const f=b.revive(p);if(l(f.fsPath)&&(!c||n.getWorkspaceFolder(f))){this._onDidCreate.fire(f)}}}if(!a.ignoreChangeEvents){for(const p of d.changed){const f=b.revive(p);if(l(f.fsPath)&&(!c||n.getWorkspaceFolder(f))){this._onDidChange.fire(f)}}}if(!a.ignoreDeleteEvents){for(const p of d.deleted){const f=b.revive(p);if(l(f.fsPath)&&(!c||n.getWorkspaceFolder(f))){this._onDidDelete.fire(f)}}}});this._disposable=qe.from(this.ensureWatching(e,n,i,s,o,a,false),this._onDidCreate,this._onDidChange,this._onDidDelete,u)}ensureWatching(e,i,n,s,r,o,a){const l=qe.from();if(typeof r==="string"){return l}if(o.ignoreChangeEvents&&o.ignoreCreateEvents&&o.ignoreDeleteEvents){return l}const c=e.getProxy(Y.MainThreadFileSystemEventService);let u=false;if(r.pattern.includes(jo)||r.pattern.includes(L_)){u=true}const d=[];let p=void 0;let f;if(a){if(o.ignoreChangeEvents||o.ignoreCreateEvents||o.ignoreDeleteEvents){f=Hr.UPDATED|Hr.ADDED|Hr.DELETED;if(o.ignoreChangeEvents){f&=~Hr.UPDATED}if(o.ignoreCreateEvents){f&=~Hr.ADDED}if(o.ignoreDeleteEvents){f&=~Hr.DELETED}}}else{if(u&&d.length===0){const m=i.getWorkspaceFolder(b.revive(r.baseUri));const v=n.getConfiguration("files",m).get("watcherExclude");if(v){for(const y in v){if(y&&v[y]===true){d.push(y)}}}}else if(!u){const m=i.getWorkspaceFolder(b.revive(r.baseUri));if(m){const v=n.getConfiguration("files",m).get("watcherExclude");if(v){for(const y in v){if(y&&v[y]===true){const D=`${c_(y,"/")}/${jo}`;if(!p){p=[]}p.push(yO(m.uri.fsPath,D))}}}if(!p||p.length===0){return l}}}}c.$watch(s.identifier.value,this.session,r.baseUri,{recursive:u,excludes:d,includes:p,filter:f},Boolean(a));return qe.from({dispose:()=>c.$unwatch(this.session)})}dispose(){this._disposable.dispose()}get onDidCreate(){return this._onDidCreate.event}get onDidChange(){return this._onDidChange.event}get onDidDelete(){return this._onDidDelete.event}}class EO{get created(){return this._created.value}get changed(){return this._changed.value}get deleted(){return this._deleted.value}constructor(e){this._events=e;this._created=new Fn(()=>this._events.created.map(b.revive));this._changed=new Fn(()=>this._events.changed.map(b.revive));this._deleted=new Fn(()=>this._events.deleted.map(b.revive));this.session=this._events.session}}class SO{constructor(e,i,n){this._mainContext=e;this._logService=i;this._extHostDocumentsAndEditors=n;this._onFileSystemEvent=new L;this._onDidRenameFile=new L;this._onDidCreateFile=new L;this._onDidDeleteFile=new L;this._onWillRenameFile=new hu;this._onWillCreateFile=new hu;this._onWillDeleteFile=new hu;this.onDidRenameFile=this._onDidRenameFile.event;this.onDidCreateFile=this._onDidCreateFile.event;this.onDidDeleteFile=this._onDidDeleteFile.event}createFileSystemWatcher(e,i,n,s,r){return new xO(this._mainContext,i,e,n,this._onFileSystemEvent.event,an.from(s),r)}$onFileEvent(e){this._onFileSystemEvent.fire(new EO(e))}$onDidRunFileOperation(e,i){switch(e){case ms.MOVE:this._onDidRenameFile.fire(Object.freeze({files:i.map(n=>({oldUri:b.revive(n.source),newUri:b.revive(n.target)}))}));break;case ms.DELETE:this._onDidDeleteFile.fire(Object.freeze({files:i.map(n=>b.revive(n.target))}));break;case ms.CREATE:case ms.COPY:this._onDidCreateFile.fire(Object.freeze({files:i.map(n=>b.revive(n.target))}));break}}getOnWillRenameFileEvent(e){return this._createWillExecuteEvent(e,this._onWillRenameFile)}getOnWillCreateFileEvent(e){return this._createWillExecuteEvent(e,this._onWillCreateFile)}getOnWillDeleteFileEvent(e){return this._createWillExecuteEvent(e,this._onWillDeleteFile)}_createWillExecuteEvent(e,i){return(n,s,r)=>{const o=function a(l){n.call(s,l)};o.extension=e;return i.event(o,void 0,r)}}async $onWillRunFileOperation(e,i,n,s){switch(e){case ms.MOVE:return await this._fireWillEvent(this._onWillRenameFile,{files:i.map(r=>({oldUri:b.revive(r.source),newUri:b.revive(r.target)}))},n,s);case ms.DELETE:return await this._fireWillEvent(this._onWillDeleteFile,{files:i.map(r=>b.revive(r.target))},n,s);case ms.CREATE:case ms.COPY:return await this._fireWillEvent(this._onWillCreateFile,{files:i.map(r=>b.revive(r.target))},n,s)}return void 0}async _fireWillEvent(e,i,n,s){const r=new Set;const o=[];await e.fireAsync(i,s,async(l,c)=>{const u=Date.now();const d=await Promise.resolve(l);if(d instanceof Da){o.push([c.extension,d]);r.add(c.extension.displayName??c.extension.identifier.value)}if(Date.now()-u>n){this._logService.warn("SLOW file-participant",c.extension.identifier)}});if(s.isCancellationRequested){return void 0}if(o.length===0){return void 0}const a={edits:[]};for(const[,l]of o){const{edits:c}=un.from(l,{getTextDocumentVersion:u=>this._extHostDocumentsAndEditors.getDocument(u)?.version,getNotebookDocumentVersion:()=>void 0});a.edits=a.edits.concat(c)}return{edit:a,extensionNames:Array.from(r)}}}class DO{constructor(e,i,n,s,r){this._extHostNotebooks=i;this._textDocumentsAndEditors=n;this._commands=s;const o=new Te("interactive.open","_interactive.open","Open interactive window and return notebook editor and input URI",[new q("showOptions","Show Options",a=>true,a=>a),new q("resource","Interactive resource Uri",a=>true,a=>a),new q("controllerId","Notebook controller Id",a=>true,a=>a),new q("title","Interactive editor title",a=>true,a=>a)],new Se("Notebook and input URI",a=>{r.debug("[ExtHostInteractive] open iw with notebook editor id",a.notebookEditorId);if(a.notebookEditorId!==void 0){const l=this._extHostNotebooks.getEditorById(a.notebookEditorId);r.debug("[ExtHostInteractive] notebook editor found",l.id);return{notebookUri:b.revive(a.notebookUri),inputUri:b.revive(a.inputUri),notebookEditor:l.apiEditor}}r.debug("[ExtHostInteractive] notebook editor not found, uris for the interactive document",a.notebookUri,a.inputUri);return{notebookUri:b.revive(a.notebookUri),inputUri:b.revive(a.inputUri)}}));this._commands.registerApiCommand(o)}$willAddInteractiveDocument(e,i,n,s){this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({addedDocuments:[{EOL:i,lines:[""],languageId:n,uri:e,isDirty:false,versionId:1,encoding:"utf8"}]})}$willRemoveInteractiveDocument(e,i){this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({removedDocuments:[e]})}}class kO{constructor(e){this._handlePool=0;this._proxy=e.getProxy(Y.MainThreadLabelService)}$registerResourceLabelFormatter(e){const i=this._handlePool++;this._proxy.$registerResourceLabelFormatter(i,e);return ge(()=>{this._proxy.$unregisterResourceLabelFormatter(i)})}}var jr;(function(t){t[t["LTR"]=0]="LTR";t[t["RTL"]=1]="RTL"})(jr||(jr={}));class gn extends et{constructor(e,i,n,s){super(e,i,n,s);this.selectionStartLineNumber=e;this.selectionStartColumn=i;this.positionLineNumber=n;this.positionColumn=s}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(e){return gn.selectionsEqual(this,e)}static selectionsEqual(e,i){return e.selectionStartLineNumber===i.selectionStartLineNumber&&e.selectionStartColumn===i.selectionStartColumn&&e.positionLineNumber===i.positionLineNumber&&e.positionColumn===i.positionColumn}getDirection(){if(this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn){return jr.LTR}return jr.RTL}setEndPosition(e,i){if(this.getDirection()===jr.LTR){return new gn(this.startLineNumber,this.startColumn,e,i)}return new gn(e,i,this.startLineNumber,this.startColumn)}getPosition(){return new En(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new En(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(e,i){if(this.getDirection()===jr.LTR){return new gn(e,i,this.endLineNumber,this.endColumn)}return new gn(this.endLineNumber,this.endColumn,e,i)}static fromPositions(e,i=e){return new gn(e.lineNumber,e.column,i.lineNumber,i.column)}static fromRange(e,i){if(i===jr.LTR){return new gn(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn)}else{return new gn(e.endLineNumber,e.endColumn,e.startLineNumber,e.startColumn)}}static liftSelection(e){return new gn(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)}static selectionsArrEqual(e,i){if(e&&!i||!e&&i){return false}if(!e&&!i){return true}if(e.length!==i.length){return false}for(let n=0,s=e.length;n<s;n++){if(!this.selectionsEqual(e[n],i[n])){return false}}return true}static isISelection(e){return e&&typeof e.selectionStartLineNumber==="number"&&typeof e.selectionStartColumn==="number"&&typeof e.positionLineNumber==="number"&&typeof e.positionColumn==="number"}static createWithDirection(e,i,n,s,r){if(r===jr.LTR){return new gn(e,i,n,s)}return new gn(n,s,e,i)}}class dm{constructor(e,i){this._documents=e;this._provider=i}async provideDocumentSymbols(e,i){const n=this._documents.getDocument(e);const s=await this._provider.provideDocumentSymbols(n,i);if(h0(s)){return void 0}else if(s[0]instanceof cd){return s.map(rw.from)}else{return dm._asDocumentSymbolTree(s)}}static _asDocumentSymbolTree(e){e=e.slice(0).sort((s,r)=>{let o=s.location.range.start.compareTo(r.location.range.start);if(o===0){o=r.location.range.end.compareTo(s.location.range.end)}return o});const i=[];const n=[];for(const s of e){const r={name:s.name||"!!MISSING: name!!",kind:Un.from(s.kind),tags:s.tags?.map(kr.from)||[],detail:"",containerName:s.containerName,range:W.from(s.location.range),selectionRange:W.from(s.location.range),children:[]};while(true){if(n.length===0){n.push(r);i.push(r);break}const o=n[n.length-1];if(et.containsRange(o.range,r.range)&&!et.equalsRange(o.range,r.range)){o.children?.push(r);n.push(r);break}n.pop()}}return i}}class Mh{constructor(e,i,n,s,r,o){this._documents=e;this._commands=i;this._provider=n;this._extension=s;this._extTelemetry=r;this._logService=o;this._cache=new In("CodeLens");this._disposables=new Map}async provideCodeLenses(e,i){const n=this._documents.getDocument(e);const s=await this._provider.provideCodeLenses(n,i);if(!s||i.isCancellationRequested){return void 0}const r=this._cache.add(s);const o=new Ie;this._disposables.set(r,o);const a={cacheId:r,lenses:[]};for(let l=0;l<s.length;l++){if(!Oe.isRange(s[l].range)){console.warn("INVALID code lens, range is not defined",this._extension.identifier.value);continue}a.lenses.push({cacheId:[r,l],range:W.from(s[l].range),command:this._commands.toInternal(s[l].command,o)})}return a}async resolveCodeLens(e,i){const n=e.cacheId&&this._cache.get(...e.cacheId);if(!n){return void 0}let s;if(typeof this._provider.resolveCodeLens!=="function"||n.isResolved){s=n}else{s=await this._provider.resolveCodeLens(n,i)}if(!s){s=n}if(i.isCancellationRequested){return void 0}const r=e.cacheId&&this._disposables.get(e.cacheId[0]);if(!r){return void 0}if(!s.command){const o=new Error("INVALID code lens resolved, lacks command: "+this._extension.identifier.value);this._extTelemetry.onExtensionError(this._extension.identifier,o);this._logService.error(o);return void 0}e.command=this._commands.toInternal(s.command,r);return e}releaseCodeLenses(e){this._disposables.get(e)?.dispose();this._disposables.delete(e);this._cache.delete(e)}}function jm(t){if(Array.isArray(t)){return t.map($d.from)}else if(t){return[$d.from(t)]}return[]}class OD{constructor(e,i){this._documents=e;this._provider=i}async provideDefinition(e,i,n){const s=this._documents.getDocument(e);const r=rt.to(i);const o=await this._provider.provideDefinition(s,r,n);return jm(o)}}class FD{constructor(e,i){this._documents=e;this._provider=i}async provideDeclaration(e,i,n){const s=this._documents.getDocument(e);const r=rt.to(i);const o=await this._provider.provideDeclaration(s,r,n);return jm(o)}}class MD{constructor(e,i){this._documents=e;this._provider=i}async provideImplementation(e,i,n){const s=this._documents.getDocument(e);const r=rt.to(i);const o=await this._provider.provideImplementation(s,r,n);return jm(o)}}class UD{constructor(e,i){this._documents=e;this._provider=i}async provideTypeDefinition(e,i,n){const s=this._documents.getDocument(e);const r=rt.to(i);const o=await this._provider.provideTypeDefinition(s,r,n);return jm(o)}}class Uu{static{this.HOVER_MAP_MAX_SIZE=10}constructor(e,i){this._documents=e;this._provider=i;this._hoverCounter=0;this._hoverMap=new Map}async provideHover(e,i,n,s){const r=this._documents.getDocument(e);const o=rt.to(i);let a;if(n&&n.verbosityRequest){const d=n.verbosityRequest.previousHover.id;const p=this._hoverMap.get(d);if(!p){throw new Error(`Hover with id ${d} not found`)}const f={verbosityDelta:n.verbosityRequest.verbosityDelta,previousHover:p};a=await this._provider.provideHover(r,o,s,f)}else{a=await this._provider.provideHover(r,o,s)}if(!a||h0(a.contents)){return void 0}if(!a.range){a.range=r.getWordRangeAtPosition(o)}if(!a.range){a.range=new Oe(o,o)}const l=Hd.from(a);const c=this._hoverCounter;if(this._hoverMap.size===Uu.HOVER_MAP_MAX_SIZE){const d=Math.min(...this._hoverMap.keys());this._hoverMap.delete(d)}this._hoverMap.set(c,a);this._hoverCounter+=1;const u={...l,id:c};return u}releaseHover(e){this._hoverMap.delete(e)}}class $D{constructor(e,i){this._documents=e;this._provider=i}async provideEvaluatableExpression(e,i,n){const s=this._documents.getDocument(e);const r=rt.to(i);const o=await this._provider.provideEvaluatableExpression(s,r,n);if(o){return lw.from(o)}return void 0}}class HD{constructor(e,i){this._documents=e;this._provider=i}async provideInlineValues(e,i,n,s){const r=this._documents.getDocument(e);const o=await this._provider.provideInlineValues(r,W.to(i),bg.to(n),s);if(Array.isArray(o)){return o.map(a=>wg.from(a))}return void 0}}class BD{constructor(e,i){this._documents=e;this._provider=i}async provideDocumentHighlights(e,i,n){const s=this._documents.getDocument(e);const r=rt.to(i);const o=await this._provider.provideDocumentHighlights(s,r,n);if(Array.isArray(o)){return o.map(fc.from)}return void 0}}class VD{constructor(e,i,n){this._documents=e;this._provider=i;this._logService=n}async provideMultiDocumentHighlights(e,i,n,s){const r=this._documents.getDocument(e);const o=n.map(c=>{try{return this._documents.getDocument(c)}catch(u){this._logService.error("Error: Unable to retrieve document from URI: "+c+". Error message: "+u);return void 0}}).filter(c=>c!==void 0);const a=rt.to(i);const l=await this._provider.provideMultiDocumentHighlights(r,a,o,s);if(Array.isArray(l)){return l.map(cw.from)}return void 0}}class WD{constructor(e,i){this._documents=e;this._provider=i}async provideLinkedEditingRanges(e,i,n){const s=this._documents.getDocument(e);const r=rt.to(i);const o=await this._provider.provideLinkedEditingRanges(s,r,n);if(o&&Array.isArray(o.ranges)){return{ranges:ei(o.ranges.map(W.from)),wordPattern:o.wordPattern}}return void 0}}class zD{constructor(e,i){this._documents=e;this._provider=i}async provideReferences(e,i,n,s){const r=this._documents.getDocument(e);const o=rt.to(i);const a=await this._provider.provideReferences(r,o,n,s);if(Array.isArray(a)){return a.map(Zi.from)}return void 0}}class lo{static{this._maxCodeActionsPerFile=1e3}constructor(e,i,n,s,r,o,a){this._documents=e;this._commands=i;this._diagnostics=n;this._provider=s;this._logService=r;this._extension=o;this._apiDeprecation=a;this._cache=new In("CodeAction");this._disposables=new Map}async provideCodeActions(e,i,n,s){const r=this._documents.getDocument(e);const o=gn.isISelection(i)?ls.to(i):W.to(i);const a=[];for(const f of this._diagnostics.getDiagnostics(e)){if(o.intersection(f.range)){const m=a.push(f);if(m>lo._maxCodeActionsPerFile){break}}}const l={diagnostics:a,only:n.only?new Pt(n.only):void 0,triggerKind:Sw.to(n.trigger)};const c=await this._provider.provideCodeActions(r,o,l,s);if(!kc(c)||s.isCancellationRequested){return void 0}const u=this._cache.add(c);const d=new Ie;this._disposables.set(u,d);const p=[];for(let f=0;f<c.length;f++){const m=c[f];if(!m){continue}if(lo._isCommand(m)&&!(m instanceof dd)){this._apiDeprecation.report("CodeActionProvider.provideCodeActions - return commands",this._extension,`Return 'CodeAction' instances instead.`);p.push({_isSynthetic:true,title:m.title,command:this._commands.toInternal(m,d)})}else{const v=m;if(l.only){if(!v.kind){this._logService.warn(`${this._extension.identifier.value} - Code actions of kind '${l.only.value}' requested but returned code action does not have a 'kind'. Code action will be dropped. Please set 'CodeAction.kind'.`)}else if(!l.only.contains(v.kind)){this._logService.warn(`${this._extension.identifier.value} - Code actions of kind '${l.only.value}' requested but returned code action is of kind '${v.kind.value}'. Code action will be dropped. Please check 'CodeActionContext.only' to only return requested code actions.`)}}const y=v.ranges??[];p.push({cacheId:[u,f],title:v.title,command:v.command&&this._commands.toInternal(v.command,d),diagnostics:v.diagnostics&&v.diagnostics.map(dc.from),edit:v.edit&&un.from(v.edit,void 0),kind:v.kind&&v.kind.value,isPreferred:v.isPreferred,isAI:dt(this._extension,"codeActionAI")?v.isAI:false,ranges:dt(this._extension,"codeActionRanges")?ei(y.map(W.from)):void 0,disabled:v.disabled?.reason})}}return{cacheId:u,actions:p}}async resolveCodeAction(e,i){const[n,s]=e;const r=this._cache.get(n,s);if(!r||lo._isCommand(r)){return{}}if(!this._provider.resolveCodeAction){return{}}const o=await this._provider.resolveCodeAction(r,i)??r;let a;if(o.edit){a=un.from(o.edit,void 0)}let l;if(o.command){const c=this._disposables.get(n);if(c){l=this._commands.toInternal(o.command,c)}}return{edit:a,command:l}}releaseCodeActions(e){this._disposables.get(e)?.dispose();this._disposables.delete(e);this._cache.delete(e)}static _isCommand(e){return typeof e.command==="string"&&typeof e.title==="string"}}class Xc{constructor(e,i,n,s,r){this._proxy=e;this._documents=i;this._provider=n;this._handle=s;this._extension=r;this._editsCache=new In("DocumentPasteEdit.edits")}async prepareDocumentPaste(e,i,n,s){if(!this._provider.prepareDocumentPaste){return}this._cachedPrepare=void 0;const r=this._documents.getDocument(e);const o=i.map(d=>W.to(d));const a=yc.toDataTransfer(n,()=>{throw new b5});await this._provider.prepareDocumentPaste(r,o,a,s);if(s.isCancellationRequested){return}const l=Array.from(a).filter(([,d])=>!(d instanceof Gp));const c=new Map;const u=await Promise.all(Array.from(l,async([d,p])=>{const f=vi();c.set(f,p);return[d,await ma.from(d,p,f)]}));this._cachedPrepare=c;return{items:u}}async providePasteEdits(e,i,n,s,r,o){if(!this._provider.provideDocumentPasteEdits){return[]}const a=this._documents.getDocument(i);const l=n.map(f=>W.to(f));const c=s.items.map(([f,m])=>{const v=this._cachedPrepare?.get(m.id);if(v){return[f,v]}return[f,ma.to(f,m,async y=>{return(await this._proxy.$resolvePasteFileData(this._handle,e,y)).buffer})]});const u=new rc(c);const d=await this._provider.provideDocumentPasteEdits(a,l,u,{only:r.only?new Mn(r.only):void 0,triggerKind:r.triggerKind},o);if(!d||o.isCancellationRequested){return[]}const p=this._editsCache.add(d);return d.map((f,m)=>({_cacheId:[p,m],title:f.title??h(2558,"Paste using '{0}' extension",this._extension.displayName||this._extension.name),kind:f.kind,yieldTo:f.yieldTo?.map(v=>v.value),insertText:typeof f.insertText==="string"?f.insertText:{snippet:f.insertText.value},additionalEdit:f.additionalEdit?un.from(f.additionalEdit,void 0):void 0}))}async resolvePasteEdit(e,i){const[n,s]=e;const r=this._editsCache.get(n,s);if(!r||!this._provider.resolveDocumentPasteEdit){return{}}const o=await this._provider.resolveDocumentPasteEdit(r,i)??r;return{insertText:o.insertText,additionalEdit:o.additionalEdit?un.from(o.additionalEdit,void 0):void 0}}releasePasteEdits(e){this._editsCache.delete(e)}}class qD{constructor(e,i){this._documents=e;this._provider=i}async provideDocumentFormattingEdits(e,i,n){const s=this._documents.getDocument(e);const r=await this._provider.provideDocumentFormattingEdits(s,i,n);if(Array.isArray(r)){return r.map(li.from)}return void 0}}class $1{constructor(e,i){this._documents=e;this._provider=i}async provideDocumentRangeFormattingEdits(e,i,n,s){const r=this._documents.getDocument(e);const o=W.to(i);const a=await this._provider.provideDocumentRangeFormattingEdits(r,o,n,s);if(Array.isArray(a)){return a.map(li.from)}return void 0}async provideDocumentRangesFormattingEdits(e,i,n,s){Mk(typeof this._provider.provideDocumentRangesFormattingEdits==="function","INVALID invocation of `provideDocumentRangesFormattingEdits`");const r=this._documents.getDocument(e);const o=i.map(W.to);const a=await this._provider.provideDocumentRangesFormattingEdits(r,o,n,s);if(Array.isArray(a)){return a.map(li.from)}return void 0}}class jD{constructor(e,i){this._documents=e;this._provider=i;this.autoFormatTriggerCharacters=[]}async provideOnTypeFormattingEdits(e,i,n,s,r){const o=this._documents.getDocument(e);const a=rt.to(i);const l=await this._provider.provideOnTypeFormattingEdits(o,a,n,s,r);if(Array.isArray(l)){return l.map(li.from)}return void 0}}class Uh{constructor(e,i){this._provider=e;this._logService=i;this._cache=new In("WorkspaceSymbols")}async provideWorkspaceSymbols(e,i){const n=await this._provider.provideWorkspaceSymbols(e,i);if(!kc(n)){return{symbols:[]}}const s=this._cache.add(n);const r={cacheId:s,symbols:[]};for(let o=0;o<n.length;o++){const a=n[o];if(!a||!a.name){this._logService.warn("INVALID SymbolInformation",a);continue}r.symbols.push({...Pa.from(a),cacheId:[s,o]})}return r}async resolveWorkspaceSymbol(e,i){if(typeof this._provider.resolveWorkspaceSymbol!=="function"){return e}if(!e.cacheId){return e}const n=this._cache.get(...e.cacheId);if(n){const s=await this._provider.resolveWorkspaceSymbol(n,i);return s&&Ea(e,Pa.from(s),true)}return void 0}releaseWorkspaceSymbols(e){this._cache.delete(e)}}class ta{static supportsResolving(e){return typeof e.prepareRename==="function"}constructor(e,i,n){this._documents=e;this._provider=i;this._logService=n}async provideRenameEdits(e,i,n,s){const r=this._documents.getDocument(e);const o=rt.to(i);try{const a=await this._provider.provideRenameEdits(r,o,n,s);if(!a){return void 0}return un.from(a)}catch(a){const l=ta._asMessage(a);if(l){return{rejectReason:l,edits:void 0}}else{return Promise.reject(a)}}}async resolveRenameLocation(e,i,n){if(typeof this._provider.prepareRename!=="function"){return Promise.resolve(void 0)}const s=this._documents.getDocument(e);const r=rt.to(i);try{const o=await this._provider.prepareRename(s,r,n);let a;let l;if(Oe.isRange(o)){a=o;l=s.getText(o)}else if(Yt(o)){a=o.range;l=o.placeholder}if(!a||!l){return void 0}if(a.start.line>r.line||a.end.line<r.line){this._logService.warn("INVALID rename location: position line must be within range start/end lines");return void 0}return{range:W.from(a),text:l}}catch(o){const a=ta._asMessage(o);if(a){return{rejectReason:a,range:void 0,text:void 0}}else{return Promise.reject(o)}}}static _asMessage(e){if(typeof e==="string"){return e}else if(e instanceof Error&&typeof e.message==="string"){return e.message}else{return void 0}}}class Vl{static{this.languageTriggerKindToVSCodeTriggerKind={[ep.Invoke]:xd.Invoke,[ep.Automatic]:xd.Automatic}}constructor(e,i,n){this._documents=e;this._provider=i;this._logService=n}async supportsAutomaticNewSymbolNamesTriggerKind(){return this._provider.supportsAutomaticTriggerKind}async provideNewSymbolNames(e,i,n,s){const r=this._documents.getDocument(e);const o=W.to(i);try{const a=Vl.languageTriggerKindToVSCodeTriggerKind[n];const l=await this._provider.provideNewSymbolNames(r,o,a,s);if(!l){return void 0}return l.map(c=>typeof c==="string"?{newSymbolName:c}:{newSymbolName:c.newSymbolName,tags:c.tags})}catch(a){this._logService.error(Vl._asMessage(a)??JSON.stringify(a,null,"	"));return void 0}}static _asMessage(e){if(typeof e==="string"){return e}else if(e instanceof Error&&typeof e.message==="string"){return e.message}else{return void 0}}}class H1{constructor(e,i){this.resultId=e;this.tokens=i}}class sn{constructor(e,i){this._documents=e;this._provider=i;this._nextResultId=1;this._previousResults=new Map}async provideDocumentSemanticTokens(e,i,n){const s=this._documents.getDocument(e);const r=i!==0?this._previousResults.get(i):null;let o=typeof r?.resultId==="string"&&typeof this._provider.provideDocumentSemanticTokensEdits==="function"?await this._provider.provideDocumentSemanticTokensEdits(s,r.resultId,n):await this._provider.provideDocumentSemanticTokens(s,n);if(r){this._previousResults.delete(i)}if(!o){return null}o=sn._fixProvidedSemanticTokens(o);return this._send(sn._convertToEdits(r,o),o)}async releaseDocumentSemanticColoring(e){this._previousResults.delete(e)}static _fixProvidedSemanticTokens(e){if(sn._isSemanticTokens(e)){if(sn._isCorrectSemanticTokens(e)){return e}return new ac(new Uint32Array(e.data),e.resultId)}else if(sn._isSemanticTokensEdits(e)){if(sn._isCorrectSemanticTokensEdits(e)){return e}return new df(e.edits.map(i=>new W4(i.start,i.deleteCount,i.data?new Uint32Array(i.data):i.data)),e.resultId)}return e}static _isSemanticTokens(e){return e&&!!e.data}static _isCorrectSemanticTokens(e){return e.data instanceof Uint32Array}static _isSemanticTokensEdits(e){return e&&Array.isArray(e.edits)}static _isCorrectSemanticTokensEdits(e){for(const i of e.edits){if(!(i.data instanceof Uint32Array)){return false}}return true}static _convertToEdits(e,i){if(!sn._isSemanticTokens(i)){return i}if(!e||!e.tokens){return i}const n=e.tokens;const s=n.length;const r=i.data;const o=r.length;let a=0;const l=Math.min(s,o);while(a<l&&n[a]===r[a]){a++}if(a===s&&a===o){return new df([],i.resultId)}let c=0;const u=l-a;while(c<u&&n[s-c-1]===r[o-c-1]){c++}return new df([{start:a,deleteCount:s-a-c,data:r.subarray(a,o-c)}],i.resultId)}_send(e,i){if(sn._isSemanticTokens(e)){const n=this._nextResultId++;this._previousResults.set(n,new H1(e.resultId,e.data));return Hb({id:n,type:"full",data:e.data})}if(sn._isSemanticTokensEdits(e)){const n=this._nextResultId++;if(sn._isSemanticTokens(i)){this._previousResults.set(n,new H1(i.resultId,i.data))}else{this._previousResults.set(n,new H1(e.resultId))}return Hb({id:n,type:"delta",deltas:(e.edits||[]).map(s=>({start:s.start,deleteCount:s.deleteCount,data:s.data}))})}return null}}class GD{constructor(e,i){this._documents=e;this._provider=i}async provideDocumentRangeSemanticTokens(e,i,n){const s=this._documents.getDocument(e);const r=await this._provider.provideDocumentRangeSemanticTokens(s,W.to(i),n);if(!r){return null}return this._send(r)}_send(e){return Hb({id:0,type:"full",data:e.data})}}class $o{static supportsResolving(e){return typeof e.resolveCompletionItem==="function"}constructor(e,i,n,s,r){this._documents=e;this._commands=i;this._provider=n;this._apiDeprecation=s;this._extension=r;this._cache=new In("CompletionItem");this._disposables=new Map}async provideCompletionItems(e,i,n,s){const r=this._documents.getDocument(e);const o=rt.to(i);const a=r.getWordRangeAtPosition(o)||new Oe(o,o);const l=a.with({end:o});const c=new xr;const u=await this._provider.provideCompletionItems(r,o,s,dw.to(n));if(!u){return void 0}if(s.isCancellationRequested){return void 0}const d=Array.isArray(u)?new ec(u):u;const p=$o.supportsResolving(this._provider)?this._cache.add(d.items):this._cache.add([]);const f=new Ie;this._disposables.set(p,f);const m=[];const v={x:p,[rl.completions]:m,[rl.defaultRanges]:{replace:W.from(a),insert:W.from(l)},[rl.isIncomplete]:d.isIncomplete||void 0,[rl.duration]:c.elapsed()};for(let y=0;y<d.items.length;y++){const D=d.items[y];const I=this._convertCompletionItem(D,[p,y],l,a);m.push(I)}return v}async resolveCompletionItem(e,i){if(typeof this._provider.resolveCompletionItem!=="function"){return void 0}const n=this._cache.get(...e);if(!n){return void 0}const s=this._convertCompletionItem(n,e);const r=await this._provider.resolveCompletionItem(n,i);if(!r){return void 0}const o=this._convertCompletionItem(r,e);if(s[Fe.insertText]!==o[Fe.insertText]||s[Fe.insertTextRules]!==o[Fe.insertTextRules]){this._apiDeprecation.report("CompletionItem.insertText",this._extension,"extension MAY NOT change 'insertText' of a CompletionItem during resolve")}if(s[Fe.commandIdent]!==o[Fe.commandIdent]||s[Fe.commandId]!==o[Fe.commandId]||!Xi(s[Fe.commandArguments],o[Fe.commandArguments])){this._apiDeprecation.report("CompletionItem.command",this._extension,"extension MAY NOT change 'command' of a CompletionItem during resolve")}return{...s,[Fe.documentation]:o[Fe.documentation],[Fe.detail]:o[Fe.detail],[Fe.additionalTextEdits]:o[Fe.additionalTextEdits],[Fe.insertText]:o[Fe.insertText],[Fe.insertTextRules]:o[Fe.insertTextRules],[Fe.commandIdent]:o[Fe.commandIdent],[Fe.commandId]:o[Fe.commandId],[Fe.commandArguments]:o[Fe.commandArguments]}}releaseCompletionItems(e){this._disposables.get(e)?.dispose();this._disposables.delete(e);this._cache.delete(e)}_convertCompletionItem(e,i,n,s){const r=this._disposables.get(i[0]);if(!r){throw Error("DisposableStore is missing...")}const o=this._commands.toInternal(e.command,r);const a={x:i,[Fe.label]:e.label,[Fe.kind]:e.kind!==void 0?xg.from(e.kind):void 0,[Fe.kindModifier]:e.tags&&e.tags.map(yg.from),[Fe.detail]:e.detail,[Fe.documentation]:typeof e.documentation==="undefined"?void 0:Pe.fromStrict(e.documentation),[Fe.sortText]:e.sortText!==e.label?e.sortText:void 0,[Fe.filterText]:e.filterText!==e.label?e.filterText:void 0,[Fe.preselect]:e.preselect||void 0,[Fe.insertTextRules]:e.keepWhitespace?aa.KeepWhitespace:aa.None,[Fe.commitCharacters]:e.commitCharacters?.join(""),[Fe.additionalTextEdits]:e.additionalTextEdits&&e.additionalTextEdits.map(li.from),[Fe.commandIdent]:o?.$ident,[Fe.commandId]:o?.id,[Fe.commandArguments]:o?.$ident?void 0:o?.arguments};if(e.textEdit){this._apiDeprecation.report("CompletionItem.textEdit",this._extension,`Use 'CompletionItem.insertText' and 'CompletionItem.range' instead.`);a[Fe.insertText]=e.textEdit.newText}else if(typeof e.insertText==="string"){a[Fe.insertText]=e.insertText}else if(e.insertText instanceof ka){a[Fe.insertText]=e.insertText.value;a[Fe.insertTextRules]|=aa.InsertAsSnippet}let l;if(e.textEdit){l=e.textEdit.range}else if(e.range){l=e.range}if(Oe.isRange(l)){a[Fe.range]=W.from(l)}else if(l&&(!n?.isEqual(l.inserting)||!s?.isEqual(l.replacing))){a[Fe.range]={insert:W.from(l.inserting),replace:W.from(l.replacing)}}return a}}class Mr{constructor(e,i,n,s){this._extension=e;this._documents=i;this._provider=n;this._commands=s;this._references=new o5;this._isAdditionsProposedApiEnabled=dt(this._extension,"inlineCompletionsAdditions");this.languageTriggerKindToVSCodeTriggerKind={[Jf.Automatic]:yd.Automatic,[Jf.Explicit]:yd.Invoke}}get supportsHandleEvents(){return dt(this._extension,"inlineCompletionsAdditions")&&(typeof this._provider.handleDidShowCompletionItem==="function"||typeof this._provider.handleDidPartiallyAcceptCompletionItem==="function"||typeof this._provider.handleDidRejectCompletionItem==="function"||typeof this._provider.handleEndOfLifetime==="function")}async provideInlineCompletions(e,i,n,s){const r=this._documents.getDocument(e);const o=rt.to(i);const a=await this._provider.provideInlineCompletionItems(r,o,{selectedCompletionInfo:n.selectedSuggestionInfo?{range:W.to(n.selectedSuggestionInfo.range),text:n.selectedSuggestionInfo.text}:void 0,triggerKind:this.languageTriggerKindToVSCodeTriggerKind[n.triggerKind],requestUuid:n.requestUuid},s);if(!a){return void 0}if(s.isCancellationRequested){return void 0}const l=Array.isArray(a)?a:a.items;const c=this._isAdditionsProposedApiEnabled?Array.isArray(a)?[]:a.commands||[]:[];const u=this._isAdditionsProposedApiEnabled&&!Array.isArray(a)?a.enableForwardStability:void 0;let d=void 0;const p=this._references.createReferenceId({dispose(){d?.dispose()},items:l});return{pid:p,items:l.map((f,m)=>{let v=void 0;if(f.command){if(!d){d=new Ie}v=this._commands.toInternal(f.command,d)}let y=void 0;if(f.action){if(!d){d=new Ie}y=this._commands.toInternal(f.action,d)}const D=f.insertText;return{insertText:typeof D==="string"?D:{snippet:D.value},filterText:f.filterText,range:f.range?W.from(f.range):void 0,showRange:this._isAdditionsProposedApiEnabled&&f.showRange?W.from(f.showRange):void 0,command:v,action:y,idx:m,completeBracketPairs:this._isAdditionsProposedApiEnabled?f.completeBracketPairs:false,isInlineEdit:this._isAdditionsProposedApiEnabled?f.isInlineEdit:false,showInlineEditMenu:this._isAdditionsProposedApiEnabled?f.showInlineEditMenu:false,displayLocation:f.displayLocation&&this._isAdditionsProposedApiEnabled?{range:W.from(f.displayLocation.range),label:f.displayLocation.label}:void 0,warning:f.warning&&this._isAdditionsProposedApiEnabled?{message:Pe.from(f.warning.message),icon:f.warning.icon?Mw.fromThemeIcon(f.warning.icon):void 0}:void 0}}),commands:c.map(f=>{if(!d){d=new Ie}return this._commands.toInternal(f,d)}),suppressSuggestions:false,enableForwardStability:u}}async provideInlineEditsForRange(e,i,n,s){if(!this._provider.provideInlineEditsForRange){return void 0}$(this._extension,"inlineCompletionsAdditions");const r=this._documents.getDocument(e);const o=W.to(i);const a=await this._provider.provideInlineEditsForRange(r,o,{selectedCompletionInfo:n.selectedSuggestionInfo?{range:W.to(n.selectedSuggestionInfo.range),text:n.selectedSuggestionInfo.text}:void 0,triggerKind:this.languageTriggerKindToVSCodeTriggerKind[n.triggerKind],userPrompt:n.userPrompt,requestUuid:n.requestUuid},s);if(!a){return void 0}if(s.isCancellationRequested){return void 0}const l=Array.isArray(a)?a:a.items;const c=this._isAdditionsProposedApiEnabled?Array.isArray(a)?[]:a.commands||[]:[];const u=this._isAdditionsProposedApiEnabled&&!Array.isArray(a)?a.enableForwardStability:void 0;let d=void 0;const p=this._references.createReferenceId({dispose(){d?.dispose()},items:l});return{pid:p,items:l.map((f,m)=>{let v=void 0;if(f.command){if(!d){d=new Ie}v=this._commands.toInternal(f.command,d)}let y=void 0;if(f.action){if(!d){d=new Ie}y=this._commands.toInternal(f.action,d)}const D=f.insertText;return{insertText:typeof D==="string"?D:{snippet:D.value},filterText:f.filterText,range:f.range?W.from(f.range):void 0,command:v,action:y,idx:m,completeBracketPairs:this._isAdditionsProposedApiEnabled?f.completeBracketPairs:false}}),commands:c.map(f=>{if(!d){d=new Ie}return this._commands.toInternal(f,d)}),suppressSuggestions:false,enableForwardStability:u}}disposeCompletions(e){const i=this._references.disposeReferenceId(e);i?.dispose()}handleDidShowCompletionItem(e,i,n){const s=this._references.get(e)?.items[i];if(s){if(this._provider.handleDidShowCompletionItem&&this._isAdditionsProposedApiEnabled){this._provider.handleDidShowCompletionItem(s,n)}}}handlePartialAccept(e,i,n,s){const r=this._references.get(e)?.items[i];if(r){if(this._provider.handleDidPartiallyAcceptCompletionItem&&this._isAdditionsProposedApiEnabled){this._provider.handleDidPartiallyAcceptCompletionItem(r,n);this._provider.handleDidPartiallyAcceptCompletionItem(r,Lw.to(s))}}}handleEndOfLifetime(e,i,n){const s=this._references.get(e)?.items[i];if(s){if(this._provider.handleEndOfLifetime&&this._isAdditionsProposedApiEnabled){const r=Ow.to(n,o=>this._references.get(o.pid)?.items[o.idx]);this._provider.handleEndOfLifetime(s,r)}}}handleRejection(e,i){const n=this._references.get(e)?.items[i];if(n){if(this._provider.handleDidRejectCompletionItem&&this._isAdditionsProposedApiEnabled){this._provider.handleDidRejectCompletionItem(n)}}}}class B1{async provideInlineEdits(e,i,n){const s=this._documents.getDocument(e);const r=await this._provider.provideInlineEdit(s,{triggerKind:this.languageTriggerKindToVSCodeTriggerKind[i.triggerKind],requestUuid:i.requestUuid},n);if(!r){return void 0}if(n.isCancellationRequested){return void 0}let o=void 0;const a=this._references.createReferenceId({dispose(){o?.dispose()},item:r});let l=void 0;if(r.accepted){if(!o){o=new Ie}l=this._commands.toInternal(r.accepted,o)}let c=void 0;if(r.rejected){if(!o){o=new Ie}c=this._commands.toInternal(r.rejected,o)}let u=void 0;if(r.shown){if(!o){o=new Ie}u=this._commands.toInternal(r.shown,o)}let d=void 0;if(r.action){if(!o){o=new Ie}d=this._commands.toInternal(r.action,o)}if(!o){o=new Ie}const p={pid:a,text:r.text,range:W.from(r.range),showRange:W.from(r.showRange),accepted:l,rejected:c,shown:u,action:d,commands:r.commands?.map(f=>this._commands.toInternal(f,o))};return p}disposeEdit(e){const i=this._references.disposeReferenceId(e);i?.dispose()}constructor(e,i,n,s){this._documents=i;this._provider=n;this._commands=s;this._references=new o5;this.languageTriggerKindToVSCodeTriggerKind={[tp.Automatic]:Fd.Automatic,[tp.Invoke]:Fd.Invoke}}}class o5{constructor(){this._references=new Map;this._idPool=1}createReferenceId(e){const i=this._idPool++;this._references.set(i,e);return i}disposeReferenceId(e){const i=this._references.get(e);this._references.delete(e);return i}get(e){return this._references.get(e)}}class V1{constructor(e,i){this._documents=e;this._provider=i;this._cache=new In("SignatureHelp")}async provideSignatureHelp(e,i,n,s){const r=this._documents.getDocument(e);const o=rt.to(i);const a=this.reviveContext(n);const l=await this._provider.provideSignatureHelp(r,o,s,a);if(l){const c=this._cache.add([l]);return{...Bd.from(l),id:c}}return void 0}reviveContext(e){let i=void 0;if(e.activeSignatureHelp){const n=Bd.to(e.activeSignatureHelp);const s=this._cache.get(e.activeSignatureHelp.id,0);if(s){i=s;i.activeSignature=n.activeSignature;i.activeParameter=n.activeParameter}else{i=n}}return{...e,activeSignatureHelp:i}}releaseSignatureHelp(e){this._cache.delete(e)}}class $h{constructor(e,i,n,s,r){this._documents=e;this._commands=i;this._provider=n;this._logService=s;this._extension=r;this._cache=new In("InlayHints");this._disposables=new Map}async provideInlayHints(e,i,n){const s=this._documents.getDocument(e);const r=W.to(i);const o=await this._provider.provideInlayHints(s,r,n);if(!Array.isArray(o)||o.length===0){this._logService.trace(`[InlayHints] NO inlay hints from '${this._extension.identifier.value}' for range ${JSON.stringify(i)}`);return void 0}if(n.isCancellationRequested){return void 0}const a=this._cache.add(o);this._disposables.set(a,new Ie);const l={hints:[],cacheId:a};for(let c=0;c<o.length;c++){if(this._isValidInlayHint(o[c],r)){l.hints.push(this._convertInlayHint(o[c],[a,c]))}}this._logService.trace(`[InlayHints] ${l.hints.length} inlay hints from '${this._extension.identifier.value}' for range ${JSON.stringify(i)}`);return l}async resolveInlayHint(e,i){if(typeof this._provider.resolveInlayHint!=="function"){return void 0}const n=this._cache.get(...e);if(!n){return void 0}const s=await this._provider.resolveInlayHint(n,i);if(!s){return void 0}if(!this._isValidInlayHint(s)){return void 0}return this._convertInlayHint(s,e)}releaseHints(e){this._disposables.get(e)?.dispose();this._disposables.delete(e);this._cache.delete(e)}_isValidInlayHint(e,i){if(e.label.length===0||Array.isArray(e.label)&&e.label.every(n=>n.value.length===0)){console.log("INVALID inlay hint, empty label",e);return false}if(i&&!i.contains(e.position)){return false}return true}_convertInlayHint(e,i){const n=this._disposables.get(i[0]);if(!n){throw Error("DisposableStore is missing...")}const s={label:"",cacheId:i,tooltip:Pe.fromStrict(e.tooltip),position:rt.from(e.position),textEdits:e.textEdits&&e.textEdits.map(li.from),kind:e.kind&&Dg.from(e.kind),paddingLeft:e.paddingLeft,paddingRight:e.paddingRight};if(typeof e.label==="string"){s.label=e.label}else{const r=[];s.label=r;for(const o of e.label){if(!o.value){console.warn("INVALID inlay hint, empty label part",this._extension.identifier.value);continue}const a={label:o.value,tooltip:Pe.fromStrict(o.tooltip)};if(kn.isLocation(o.location)){a.location=Zi.from(o.location)}if(o.command){a.command=this._commands.toInternal(o.command,n)}r.push(a)}}return s}}class co{constructor(e,i){this._documents=e;this._provider=i;this._cache=new In("DocumentLink")}async provideLinks(e,i){const n=this._documents.getDocument(e);const s=await this._provider.provideDocumentLinks(n,i);if(!Array.isArray(s)||s.length===0){return void 0}if(i.isCancellationRequested){return void 0}if(typeof this._provider.resolveDocumentLink!=="function"){return{links:s.filter(co._validateLink).map(pa.from)}}else{const r=this._cache.add(s);const o={links:[],cacheId:r};for(let a=0;a<s.length;a++){if(!co._validateLink(s[a])){continue}const l=pa.from(s[a]);l.cacheId=[r,a];o.links.push(l)}return o}}static _validateLink(e){if(e.target&&e.target.path.length>5e4){console.warn("DROPPING link because it is too long");return false}return true}async resolveLink(e,i){if(typeof this._provider.resolveDocumentLink!=="function"){return void 0}const n=this._cache.get(...e);if(!n){return void 0}const s=await this._provider.resolveDocumentLink(n,i);if(!s||!co._validateLink(s)){return void 0}return pa.from(s)}releaseLinks(e){this._cache.delete(e)}}class W1{constructor(e,i){this._documents=e;this._provider=i}async provideColors(e,i){const n=this._documents.getDocument(e);const s=await this._provider.provideDocumentColors(n,i);if(!Array.isArray(s)){return[]}const r=s.map(o=>{return{color:pc.from(o.color),range:W.from(o.range)}});return r}async provideColorPresentations(e,i,n){const s=this._documents.getDocument(e);const r=W.to(i.range);const o=pc.to(i.color);const a=await this._provider.provideColorPresentations(o,{document:s,range:r},n);if(!Array.isArray(a)){return void 0}return a.map(kg.from)}}class KD{constructor(e,i){this._documents=e;this._provider=i}async provideFoldingRanges(e,i,n){const s=this._documents.getDocument(e);const r=await this._provider.provideFoldingRanges(s,i,n);if(!Array.isArray(r)){return void 0}return r.map(Cg.from)}}class QD{constructor(e,i,n){this._documents=e;this._provider=i;this._logService=n}async provideSelectionRanges(e,i,n){const s=this._documents.getDocument(e);const r=i.map(rt.to);const o=await this._provider.provideSelectionRanges(s,r,n);if(!kc(o)){return[]}if(o.length!==r.length){this._logService.warn("BAD selection ranges, provider must return ranges for each position");return[]}const a=[];for(let l=0;l<r.length;l++){const c=[];a.push(c);let u=r[l];let d=o[l];while(true){if(!d.range.contains(u)){throw new Error("INVALID selection range, must contain the previous range")}c.push(gw.from(d));if(!d.parent){break}u=d.range;d=d.parent}}return a}}class Yc{constructor(e,i){this._documents=e;this._provider=i;this._idPool=new Ey("");this._cache=new Map}async prepareSession(e,i,n){const s=this._documents.getDocument(e);const r=rt.to(i);const o=await this._provider.prepareCallHierarchy(s,r,n);if(!o){return void 0}const a=this._idPool.nextId();this._cache.set(a,new Map);if(Array.isArray(o)){return o.map(l=>this._cacheAndConvertItem(a,l))}else{return[this._cacheAndConvertItem(a,o)]}}async provideCallsTo(e,i,n){const s=this._itemFromCache(e,i);if(!s){throw new Error("missing call hierarchy item")}const r=await this._provider.provideCallHierarchyIncomingCalls(s,n);if(!r){return void 0}return r.map(o=>{return{from:this._cacheAndConvertItem(e,o.from),fromRanges:o.fromRanges.map(a=>W.from(a))}})}async provideCallsFrom(e,i,n){const s=this._itemFromCache(e,i);if(!s){throw new Error("missing call hierarchy item")}const r=await this._provider.provideCallHierarchyOutgoingCalls(s,n);if(!r){return void 0}return r.map(o=>{return{to:this._cacheAndConvertItem(e,o.to),fromRanges:o.fromRanges.map(a=>W.from(a))}})}releaseSession(e){this._cache.delete(e)}_cacheAndConvertItem(e,i){const n=this._cache.get(e);const s=Aa.from(i,e,n.size.toString(36));n.set(s._itemId,i);return s}_itemFromCache(e,i){const n=this._cache.get(e);return n?.get(i)}}class Zc{constructor(e,i){this._documents=e;this._provider=i;this._idPool=new Ey("");this._cache=new Map}async prepareSession(e,i,n){const s=this._documents.getDocument(e);const r=rt.to(i);const o=await this._provider.prepareTypeHierarchy(s,r,n);if(!o){return void 0}const a=this._idPool.nextId();this._cache.set(a,new Map);if(Array.isArray(o)){return o.map(l=>this._cacheAndConvertItem(a,l))}else{return[this._cacheAndConvertItem(a,o)]}}async provideSupertypes(e,i,n){const s=this._itemFromCache(e,i);if(!s){throw new Error("missing type hierarchy item")}const r=await this._provider.provideTypeHierarchySupertypes(s,n);if(!r){return void 0}return r.map(o=>{return this._cacheAndConvertItem(e,o)})}async provideSubtypes(e,i,n){const s=this._itemFromCache(e,i);if(!s){throw new Error("missing type hierarchy item")}const r=await this._provider.provideTypeHierarchySubtypes(s,n);if(!r){return void 0}return r.map(o=>{return this._cacheAndConvertItem(e,o)})}releaseSession(e){this._cache.delete(e)}_cacheAndConvertItem(e,i){const n=this._cache.get(e);const s=ga.from(i,e,n.size.toString(36));n.set(s._itemId,i);return s}_itemFromCache(e,i){const n=this._cache.get(e);return n?.get(i)}}class Hh{constructor(e,i,n,s,r){this._proxy=e;this._documents=i;this._provider=n;this._handle=s;this._extension=r;this._cache=new In("DocumentDropEdit")}async provideDocumentOnDropEdits(e,i,n,s,r){const o=this._documents.getDocument(i);const a=rt.to(n);const l=yc.toDataTransfer(s,async p=>{return(await this._proxy.$resolveDocumentOnDropFileData(this._handle,e,p)).buffer});const c=await this._provider.provideDocumentDropEdits(o,a,l,r);if(!c){return void 0}const u=Sn(c);const d=this._cache.add(u);return u.map((p,f)=>({_cacheId:[d,f],title:p.title??h(2559,"Drop using '{0}' extension",this._extension.displayName||this._extension.name),kind:p.kind?.value,yieldTo:p.yieldTo?.map(m=>m.value),insertText:typeof p.insertText==="string"?p.insertText:{snippet:p.insertText.value},additionalEdit:p.additionalEdit?un.from(p.additionalEdit,void 0):void 0}))}async resolveDropEdit(e,i){const[n,s]=e;const r=this._cache.get(n,s);if(!r||!this._provider.resolveDocumentDropEdit){return{}}const o=await this._provider.resolveDocumentDropEdit(r,i)??r;const a=o.additionalEdit?un.from(o.additionalEdit,void 0):void 0;return{additionalEdit:a}}releaseDropEdits(e){this._cache.delete(e)}}class eu{constructor(e,i){this.adapter=e;this.extension=i}}class ni{static{this._handlePool=0}constructor(e,i,n,s,r,o,a,l){this._uriTransformer=i;this._documents=n;this._commands=s;this._diagnostics=r;this._logService=o;this._apiDeprecation=a;this._extensionTelemetry=l;this._adapter=new Map;this._proxy=e.getProxy(Y.MainThreadLanguageFeatures)}_transformDocumentSelector(e,i){return uc.from(e,this._uriTransformer,i)}_createDisposable(e){return new qe(()=>{this._adapter.delete(e);this._proxy.$unregister(e)})}_nextHandle(){return ni._handlePool++}async _withAdapter(e,i,n,s,r,o=false){const a=this._adapter.get(e);if(!a||!(a.adapter instanceof i)){return s}const l=Date.now();if(!o){this._logService.trace(`[${a.extension.identifier.value}] INVOKE provider '${n.toString().replace(/[\r\n]/g,"")}'`)}const c=n(a.adapter,a.extension);Promise.resolve(c).catch(u=>{if(!fo(u)){this._logService.error(`[${a.extension.identifier.value}] provider FAILED`);this._logService.error(u);this._extensionTelemetry.onExtensionError(a.extension.identifier,u)}}).finally(()=>{if(!o){this._logService.trace(`[${a.extension.identifier.value}] provider DONE after ${Date.now()-l}ms`)}});if(bt.isCancellationToken(r)){return vI(c,r)}return c}_addNewAdapter(e,i){const n=this._nextHandle();this._adapter.set(n,new eu(e,i));return n}static _extLabel(e){return e.displayName||e.name}static _extId(e){return e.identifier.value}registerDocumentSymbolProvider(e,i,n,s){const r=this._addNewAdapter(new dm(this._documents,n),e);const o=s&&s.label||ni._extLabel(e);this._proxy.$registerDocumentSymbolProvider(r,this._transformDocumentSelector(i,e),o);return this._createDisposable(r)}$provideDocumentSymbols(e,i,n){return this._withAdapter(e,dm,s=>s.provideDocumentSymbols(b.revive(i),n),void 0,n)}registerCodeLensProvider(e,i,n){const s=this._nextHandle();const r=typeof n.onDidChangeCodeLenses==="function"?this._nextHandle():void 0;this._adapter.set(s,new eu(new Mh(this._documents,this._commands.converter,n,e,this._extensionTelemetry,this._logService),e));this._proxy.$registerCodeLensSupport(s,this._transformDocumentSelector(i,e),r);let o=this._createDisposable(s);if(r!==void 0){const a=n.onDidChangeCodeLenses(l=>this._proxy.$emitCodeLensEvent(r));o=qe.from(o,a)}return o}$provideCodeLenses(e,i,n){return this._withAdapter(e,Mh,s=>s.provideCodeLenses(b.revive(i),n),void 0,n,i.scheme==="output")}$resolveCodeLens(e,i,n){return this._withAdapter(e,Mh,s=>s.resolveCodeLens(i,n),void 0,void 0,true)}$releaseCodeLenses(e,i){this._withAdapter(e,Mh,n=>Promise.resolve(n.releaseCodeLenses(i)),void 0,void 0,true)}registerDefinitionProvider(e,i,n){const s=this._addNewAdapter(new OD(this._documents,n),e);this._proxy.$registerDefinitionSupport(s,this._transformDocumentSelector(i,e));return this._createDisposable(s)}$provideDefinition(e,i,n,s){return this._withAdapter(e,OD,r=>r.provideDefinition(b.revive(i),n,s),[],s)}registerDeclarationProvider(e,i,n){const s=this._addNewAdapter(new FD(this._documents,n),e);this._proxy.$registerDeclarationSupport(s,this._transformDocumentSelector(i,e));return this._createDisposable(s)}$provideDeclaration(e,i,n,s){return this._withAdapter(e,FD,r=>r.provideDeclaration(b.revive(i),n,s),[],s)}registerImplementationProvider(e,i,n){const s=this._addNewAdapter(new MD(this._documents,n),e);this._proxy.$registerImplementationSupport(s,this._transformDocumentSelector(i,e));return this._createDisposable(s)}$provideImplementation(e,i,n,s){return this._withAdapter(e,MD,r=>r.provideImplementation(b.revive(i),n,s),[],s)}registerTypeDefinitionProvider(e,i,n){const s=this._addNewAdapter(new UD(this._documents,n),e);this._proxy.$registerTypeDefinitionSupport(s,this._transformDocumentSelector(i,e));return this._createDisposable(s)}$provideTypeDefinition(e,i,n,s){return this._withAdapter(e,UD,r=>r.provideTypeDefinition(b.revive(i),n,s),[],s)}registerHoverProvider(e,i,n,s){const r=this._addNewAdapter(new Uu(this._documents,n),e);this._proxy.$registerHoverProvider(r,this._transformDocumentSelector(i,e));return this._createDisposable(r)}$provideHover(e,i,n,s,r){return this._withAdapter(e,Uu,o=>o.provideHover(b.revive(i),n,s,r),void 0,r)}$releaseHover(e,i){this._withAdapter(e,Uu,n=>Promise.resolve(n.releaseHover(i)),void 0,void 0)}registerEvaluatableExpressionProvider(e,i,n,s){const r=this._addNewAdapter(new $D(this._documents,n),e);this._proxy.$registerEvaluatableExpressionProvider(r,this._transformDocumentSelector(i,e));return this._createDisposable(r)}$provideEvaluatableExpression(e,i,n,s){return this._withAdapter(e,$D,r=>r.provideEvaluatableExpression(b.revive(i),n,s),void 0,s)}registerInlineValuesProvider(e,i,n,s){const r=typeof n.onDidChangeInlineValues==="function"?this._nextHandle():void 0;const o=this._addNewAdapter(new HD(this._documents,n),e);this._proxy.$registerInlineValuesProvider(o,this._transformDocumentSelector(i,e),r);let a=this._createDisposable(o);if(r!==void 0){const l=n.onDidChangeInlineValues(c=>this._proxy.$emitInlineValuesEvent(r));a=qe.from(a,l)}return a}$provideInlineValues(e,i,n,s,r){return this._withAdapter(e,HD,o=>o.provideInlineValues(b.revive(i),n,s,r),void 0,r)}registerDocumentHighlightProvider(e,i,n){const s=this._addNewAdapter(new BD(this._documents,n),e);this._proxy.$registerDocumentHighlightProvider(s,this._transformDocumentSelector(i,e));return this._createDisposable(s)}registerMultiDocumentHighlightProvider(e,i,n){const s=this._addNewAdapter(new VD(this._documents,n,this._logService),e);this._proxy.$registerMultiDocumentHighlightProvider(s,this._transformDocumentSelector(i,e));return this._createDisposable(s)}$provideDocumentHighlights(e,i,n,s){return this._withAdapter(e,BD,r=>r.provideDocumentHighlights(b.revive(i),n,s),void 0,s)}$provideMultiDocumentHighlights(e,i,n,s,r){return this._withAdapter(e,VD,o=>o.provideMultiDocumentHighlights(b.revive(i),n,s.map(a=>b.revive(a)),r),void 0,r)}registerLinkedEditingRangeProvider(e,i,n){const s=this._addNewAdapter(new WD(this._documents,n),e);this._proxy.$registerLinkedEditingRangeProvider(s,this._transformDocumentSelector(i,e));return this._createDisposable(s)}$provideLinkedEditingRanges(e,i,n,s){return this._withAdapter(e,WD,async r=>{const o=await r.provideLinkedEditingRanges(b.revive(i),n,s);if(o){return{ranges:o.ranges,wordPattern:o.wordPattern?ni._serializeRegExp(o.wordPattern):void 0}}return void 0},void 0,s)}registerReferenceProvider(e,i,n){const s=this._addNewAdapter(new zD(this._documents,n),e);this._proxy.$registerReferenceSupport(s,this._transformDocumentSelector(i,e));return this._createDisposable(s)}$provideReferences(e,i,n,s,r){return this._withAdapter(e,zD,o=>o.provideReferences(b.revive(i),n,s,r),void 0,r)}registerCodeActionProvider(e,i,n,s){const r=new Ie;const o=this._addNewAdapter(new lo(this._documents,this._commands.converter,this._diagnostics,n,this._logService,e,this._apiDeprecation),e);this._proxy.$registerCodeActionSupport(o,this._transformDocumentSelector(i,e),{providedKinds:s?.providedCodeActionKinds?.map(a=>a.value),documentation:s?.documentation?.map(a=>({kind:a.kind.value,command:this._commands.converter.toInternal(a.command,r)}))},ni._extLabel(e),ni._extId(e),Boolean(n.resolveCodeAction));r.add(this._createDisposable(o));return r}$provideCodeActions(e,i,n,s,r){return this._withAdapter(e,lo,o=>o.provideCodeActions(b.revive(i),n,s,r),void 0,r)}$resolveCodeAction(e,i,n){return this._withAdapter(e,lo,s=>s.resolveCodeAction(i,n),{},void 0)}$releaseCodeActions(e,i){this._withAdapter(e,lo,n=>Promise.resolve(n.releaseCodeActions(i)),void 0,void 0)}registerDocumentFormattingEditProvider(e,i,n){const s=this._addNewAdapter(new qD(this._documents,n),e);this._proxy.$registerDocumentFormattingSupport(s,this._transformDocumentSelector(i,e),e.identifier,e.displayName||e.name);return this._createDisposable(s)}$provideDocumentFormattingEdits(e,i,n,s){return this._withAdapter(e,qD,r=>r.provideDocumentFormattingEdits(b.revive(i),n,s),void 0,s)}registerDocumentRangeFormattingEditProvider(e,i,n){const s=typeof n.provideDocumentRangesFormattingEdits==="function";const r=this._addNewAdapter(new $1(this._documents,n),e);this._proxy.$registerRangeFormattingSupport(r,this._transformDocumentSelector(i,e),e.identifier,e.displayName||e.name,s);return this._createDisposable(r)}$provideDocumentRangeFormattingEdits(e,i,n,s,r){return this._withAdapter(e,$1,o=>o.provideDocumentRangeFormattingEdits(b.revive(i),n,s,r),void 0,r)}$provideDocumentRangesFormattingEdits(e,i,n,s,r){return this._withAdapter(e,$1,o=>o.provideDocumentRangesFormattingEdits(b.revive(i),n,s,r),void 0,r)}registerOnTypeFormattingEditProvider(e,i,n,s){const r=this._addNewAdapter(new jD(this._documents,n),e);this._proxy.$registerOnTypeFormattingSupport(r,this._transformDocumentSelector(i,e),s,e.identifier);return this._createDisposable(r)}$provideOnTypeFormattingEdits(e,i,n,s,r,o){return this._withAdapter(e,jD,a=>a.provideOnTypeFormattingEdits(b.revive(i),n,s,r,o),void 0,o)}registerWorkspaceSymbolProvider(e,i){const n=this._addNewAdapter(new Uh(i,this._logService),e);this._proxy.$registerNavigateTypeSupport(n,typeof i.resolveWorkspaceSymbol==="function");return this._createDisposable(n)}$provideWorkspaceSymbols(e,i,n){return this._withAdapter(e,Uh,s=>s.provideWorkspaceSymbols(i,n),{symbols:[]},n)}$resolveWorkspaceSymbol(e,i,n){return this._withAdapter(e,Uh,s=>s.resolveWorkspaceSymbol(i,n),void 0,void 0)}$releaseWorkspaceSymbols(e,i){this._withAdapter(e,Uh,n=>n.releaseWorkspaceSymbols(i),void 0,void 0)}registerRenameProvider(e,i,n){const s=this._addNewAdapter(new ta(this._documents,n,this._logService),e);this._proxy.$registerRenameSupport(s,this._transformDocumentSelector(i,e),ta.supportsResolving(n));return this._createDisposable(s)}$provideRenameEdits(e,i,n,s,r){return this._withAdapter(e,ta,o=>o.provideRenameEdits(b.revive(i),n,s,r),void 0,r)}$resolveRenameLocation(e,i,n,s){return this._withAdapter(e,ta,r=>r.resolveRenameLocation(b.revive(i),n,s),void 0,s)}registerNewSymbolNamesProvider(e,i,n){const s=this._addNewAdapter(new Vl(this._documents,n,this._logService),e);this._proxy.$registerNewSymbolNamesProvider(s,this._transformDocumentSelector(i,e));return this._createDisposable(s)}$supportsAutomaticNewSymbolNamesTriggerKind(e){return this._withAdapter(e,Vl,i=>i.supportsAutomaticNewSymbolNamesTriggerKind(),false,void 0)}$provideNewSymbolNames(e,i,n,s,r){return this._withAdapter(e,Vl,o=>o.provideNewSymbolNames(b.revive(i),n,s,r),void 0,r)}registerDocumentSemanticTokensProvider(e,i,n,s){const r=this._addNewAdapter(new sn(this._documents,n),e);const o=typeof n.onDidChangeSemanticTokens==="function"?this._nextHandle():void 0;this._proxy.$registerDocumentSemanticTokensProvider(r,this._transformDocumentSelector(i,e),s,o);let a=this._createDisposable(r);if(o){const l=n.onDidChangeSemanticTokens(c=>this._proxy.$emitDocumentSemanticTokensEvent(o));a=qe.from(a,l)}return a}$provideDocumentSemanticTokens(e,i,n,s){return this._withAdapter(e,sn,r=>r.provideDocumentSemanticTokens(b.revive(i),n,s),null,s)}$releaseDocumentSemanticTokens(e,i){this._withAdapter(e,sn,n=>n.releaseDocumentSemanticColoring(i),void 0,void 0)}registerDocumentRangeSemanticTokensProvider(e,i,n,s){const r=this._addNewAdapter(new GD(this._documents,n),e);this._proxy.$registerDocumentRangeSemanticTokensProvider(r,this._transformDocumentSelector(i,e),s);return this._createDisposable(r)}$provideDocumentRangeSemanticTokens(e,i,n,s){return this._withAdapter(e,GD,r=>r.provideDocumentRangeSemanticTokens(b.revive(i),n,s),null,s)}registerCompletionItemProvider(e,i,n,s){const r=this._addNewAdapter(new $o(this._documents,this._commands.converter,n,this._apiDeprecation,e),e);this._proxy.$registerCompletionsProvider(r,this._transformDocumentSelector(i,e),s,$o.supportsResolving(n),e.identifier);return this._createDisposable(r)}$provideCompletionItems(e,i,n,s,r){return this._withAdapter(e,$o,o=>o.provideCompletionItems(b.revive(i),n,s,r),void 0,r)}$resolveCompletionItem(e,i,n){return this._withAdapter(e,$o,s=>s.resolveCompletionItem(i,n),void 0,n)}$releaseCompletionItems(e,i){this._withAdapter(e,$o,n=>n.releaseCompletionItems(i),void 0,void 0)}registerInlineCompletionsProvider(e,i,n,s){const r=typeof n.onDidChange==="function"&&dt(e,"inlineCompletionsAdditions")?this._nextHandle():void 0;const o=new Mr(e,this._documents,n,this._commands.converter);const a=this._addNewAdapter(o,e);let l=this._createDisposable(a);if(r!==void 0){const c=n.onDidChange(u=>this._proxy.$emitInlineCompletionsChange(r));l=qe.from(l,c)}this._proxy.$registerInlineCompletionsSupport(a,this._transformDocumentSelector(i,e),o.supportsHandleEvents,Ze.toKey(e.identifier.value),s?.yieldTo?.map(c=>Ze.toKey(c))||[],s?.displayName,s?.debounceDelayMs,r);return l}$provideInlineCompletions(e,i,n,s,r){return this._withAdapter(e,Mr,o=>o.provideInlineCompletions(b.revive(i),n,s,r),void 0,r)}$provideInlineEditsForRange(e,i,n,s,r){return this._withAdapter(e,Mr,o=>o.provideInlineEditsForRange(b.revive(i),n,s,r),void 0,r)}$handleInlineCompletionDidShow(e,i,n,s){this._withAdapter(e,Mr,async r=>{r.handleDidShowCompletionItem(i,n,s)},void 0,void 0)}$handleInlineCompletionPartialAccept(e,i,n,s,r){this._withAdapter(e,Mr,async o=>{o.handlePartialAccept(i,n,s,r)},void 0,void 0)}$handleInlineCompletionEndOfLifetime(e,i,n,s){this._withAdapter(e,Mr,async r=>{r.handleEndOfLifetime(i,n,s)},void 0,void 0)}$handleInlineCompletionRejection(e,i,n){this._withAdapter(e,Mr,async s=>{s.handleRejection(i,n)},void 0,void 0)}$freeInlineCompletionsList(e,i){this._withAdapter(e,Mr,async n=>{n.disposeCompletions(i)},void 0,void 0)}registerInlineEditProvider(e,i,n){const s=new B1(e,this._documents,n,this._commands.converter);const r=this._addNewAdapter(s,e);this._proxy.$registerInlineEditProvider(r,this._transformDocumentSelector(i,e),e.identifier,n.displayName||e.name);return this._createDisposable(r)}$provideInlineEdit(e,i,n,s){return this._withAdapter(e,B1,r=>r.provideInlineEdits(b.revive(i),n,s),void 0,s)}$freeInlineEdit(e,i){this._withAdapter(e,B1,async n=>{n.disposeEdit(i)},void 0,void 0)}registerSignatureHelpProvider(e,i,n,s){const r=Array.isArray(s)?{triggerCharacters:s,retriggerCharacters:[]}:s;const o=this._addNewAdapter(new V1(this._documents,n),e);this._proxy.$registerSignatureHelpProvider(o,this._transformDocumentSelector(i,e),r);return this._createDisposable(o)}$provideSignatureHelp(e,i,n,s,r){return this._withAdapter(e,V1,o=>o.provideSignatureHelp(b.revive(i),n,s,r),void 0,r)}$releaseSignatureHelp(e,i){this._withAdapter(e,V1,n=>n.releaseSignatureHelp(i),void 0,void 0)}registerInlayHintsProvider(e,i,n){const s=typeof n.onDidChangeInlayHints==="function"?this._nextHandle():void 0;const r=this._addNewAdapter(new $h(this._documents,this._commands.converter,n,this._logService,e),e);this._proxy.$registerInlayHintsProvider(r,this._transformDocumentSelector(i,e),typeof n.resolveInlayHint==="function",s,ni._extLabel(e));let o=this._createDisposable(r);if(s!==void 0){const a=n.onDidChangeInlayHints(l=>this._proxy.$emitInlayHintsEvent(s));o=qe.from(o,a)}return o}$provideInlayHints(e,i,n,s){return this._withAdapter(e,$h,r=>r.provideInlayHints(b.revive(i),n,s),void 0,s)}$resolveInlayHint(e,i,n){return this._withAdapter(e,$h,s=>s.resolveInlayHint(i,n),void 0,n)}$releaseInlayHints(e,i){this._withAdapter(e,$h,n=>n.releaseHints(i),void 0,void 0)}registerDocumentLinkProvider(e,i,n){const s=this._addNewAdapter(new co(this._documents,n),e);this._proxy.$registerDocumentLinkProvider(s,this._transformDocumentSelector(i,e),typeof n.resolveDocumentLink==="function");return this._createDisposable(s)}$provideDocumentLinks(e,i,n){return this._withAdapter(e,co,s=>s.provideLinks(b.revive(i),n),void 0,n,i.scheme==="output")}$resolveDocumentLink(e,i,n){return this._withAdapter(e,co,s=>s.resolveLink(i,n),void 0,void 0,true)}$releaseDocumentLinks(e,i){this._withAdapter(e,co,n=>n.releaseLinks(i),void 0,void 0,true)}registerColorProvider(e,i,n){const s=this._addNewAdapter(new W1(this._documents,n),e);this._proxy.$registerDocumentColorProvider(s,this._transformDocumentSelector(i,e));return this._createDisposable(s)}$provideDocumentColors(e,i,n){return this._withAdapter(e,W1,s=>s.provideColors(b.revive(i),n),[],n)}$provideColorPresentations(e,i,n,s){return this._withAdapter(e,W1,r=>r.provideColorPresentations(b.revive(i),n,s),void 0,s)}registerFoldingRangeProvider(e,i,n){const s=this._nextHandle();const r=typeof n.onDidChangeFoldingRanges==="function"?this._nextHandle():void 0;this._adapter.set(s,new eu(new KD(this._documents,n),e));this._proxy.$registerFoldingRangeProvider(s,this._transformDocumentSelector(i,e),e.identifier,r);let o=this._createDisposable(s);if(r!==void 0){const a=n.onDidChangeFoldingRanges(()=>this._proxy.$emitFoldingRangeEvent(r));o=qe.from(o,a)}return o}$provideFoldingRanges(e,i,n,s){return this._withAdapter(e,KD,r=>r.provideFoldingRanges(b.revive(i),n,s),void 0,s)}registerSelectionRangeProvider(e,i,n){const s=this._addNewAdapter(new QD(this._documents,n,this._logService),e);this._proxy.$registerSelectionRangeProvider(s,this._transformDocumentSelector(i,e));return this._createDisposable(s)}$provideSelectionRanges(e,i,n,s){return this._withAdapter(e,QD,r=>r.provideSelectionRanges(b.revive(i),n,s),[],s)}registerCallHierarchyProvider(e,i,n){const s=this._addNewAdapter(new Yc(this._documents,n),e);this._proxy.$registerCallHierarchyProvider(s,this._transformDocumentSelector(i,e));return this._createDisposable(s)}$prepareCallHierarchy(e,i,n,s){return this._withAdapter(e,Yc,r=>Promise.resolve(r.prepareSession(b.revive(i),n,s)),void 0,s)}$provideCallHierarchyIncomingCalls(e,i,n,s){return this._withAdapter(e,Yc,r=>r.provideCallsTo(i,n,s),void 0,s)}$provideCallHierarchyOutgoingCalls(e,i,n,s){return this._withAdapter(e,Yc,r=>r.provideCallsFrom(i,n,s),void 0,s)}$releaseCallHierarchy(e,i){this._withAdapter(e,Yc,n=>Promise.resolve(n.releaseSession(i)),void 0,void 0)}registerTypeHierarchyProvider(e,i,n){const s=this._addNewAdapter(new Zc(this._documents,n),e);this._proxy.$registerTypeHierarchyProvider(s,this._transformDocumentSelector(i,e));return this._createDisposable(s)}$prepareTypeHierarchy(e,i,n,s){return this._withAdapter(e,Zc,r=>Promise.resolve(r.prepareSession(b.revive(i),n,s)),void 0,s)}$provideTypeHierarchySupertypes(e,i,n,s){return this._withAdapter(e,Zc,r=>r.provideSupertypes(i,n,s),void 0,s)}$provideTypeHierarchySubtypes(e,i,n,s){return this._withAdapter(e,Zc,r=>r.provideSubtypes(i,n,s),void 0,s)}$releaseTypeHierarchy(e,i){this._withAdapter(e,Zc,n=>Promise.resolve(n.releaseSession(i)),void 0,void 0)}registerDocumentOnDropEditProvider(e,i,n,s){const r=this._nextHandle();this._adapter.set(r,new eu(new Hh(this._proxy,this._documents,n,r,e),e));this._proxy.$registerDocumentOnDropEditProvider(r,this._transformDocumentSelector(i,e),s?{supportsResolve:!!n.resolveDocumentDropEdit,dropMimeTypes:s.dropMimeTypes,providedDropKinds:s.providedDropEditKinds?.map(o=>o.value)}:void 0);return this._createDisposable(r)}$provideDocumentOnDropEdits(e,i,n,s,r,o){return this._withAdapter(e,Hh,a=>Promise.resolve(a.provideDocumentOnDropEdits(i,b.revive(n),s,r,o)),void 0,void 0)}$resolveDropEdit(e,i,n){return this._withAdapter(e,Hh,s=>s.resolveDropEdit(i,n),{},void 0)}$releaseDocumentOnDropEdits(e,i){this._withAdapter(e,Hh,n=>Promise.resolve(n.releaseDropEdits(i)),void 0,void 0)}registerDocumentPasteEditProvider(e,i,n,s){const r=this._nextHandle();this._adapter.set(r,new eu(new Xc(this._proxy,this._documents,n,r,e),e));this._proxy.$registerPasteEditProvider(r,this._transformDocumentSelector(i,e),{supportsCopy:!!n.prepareDocumentPaste,supportsPaste:!!n.provideDocumentPasteEdits,supportsResolve:!!n.resolveDocumentPasteEdit,providedPasteEditKinds:s.providedPasteEditKinds?.map(o=>o.value),copyMimeTypes:s.copyMimeTypes,pasteMimeTypes:s.pasteMimeTypes});return this._createDisposable(r)}$prepareDocumentPaste(e,i,n,s,r){return this._withAdapter(e,Xc,o=>o.prepareDocumentPaste(b.revive(i),n,s,r),void 0,r)}$providePasteEdits(e,i,n,s,r,o,a){return this._withAdapter(e,Xc,l=>l.providePasteEdits(i,b.revive(n),s,r,o,a),void 0,a)}$resolvePasteEdit(e,i,n){return this._withAdapter(e,Xc,s=>s.resolvePasteEdit(i,n),{},void 0)}$releasePasteEdits(e,i){this._withAdapter(e,Xc,n=>Promise.resolve(n.releasePasteEdits(i)),void 0,void 0)}static _serializeRegExp(e){return{pattern:e.source,flags:e.flags}}static _serializeIndentationRule(e){return{decreaseIndentPattern:ni._serializeRegExp(e.decreaseIndentPattern),increaseIndentPattern:ni._serializeRegExp(e.increaseIndentPattern),indentNextLinePattern:e.indentNextLinePattern?ni._serializeRegExp(e.indentNextLinePattern):void 0,unIndentedLinePattern:e.unIndentedLinePattern?ni._serializeRegExp(e.unIndentedLinePattern):void 0}}static _serializeOnEnterRule(e){return{beforeText:ni._serializeRegExp(e.beforeText),afterText:e.afterText?ni._serializeRegExp(e.afterText):void 0,previousLineText:e.previousLineText?ni._serializeRegExp(e.previousLineText):void 0,action:e.action}}static _serializeOnEnterRules(e){return e.map(ni._serializeOnEnterRule)}static _serializeAutoClosingPair(e){return{open:e.open,close:e.close,notIn:e.notIn?e.notIn.map(i=>ic.toString(i)):void 0}}static _serializeAutoClosingPairs(e){return e.map(ni._serializeAutoClosingPair)}setLanguageConfiguration(e,i,n){const{wordPattern:s}=n;if(s&&cI(s)){throw new Error(`Invalid language configuration: wordPattern '${s}' is not allowed to match the empty string.`)}if(s){this._documents.setWordDefinitionFor(i,s)}else{this._documents.setWordDefinitionFor(i,void 0)}if(n.__electricCharacterSupport){this._apiDeprecation.report("LanguageConfiguration.__electricCharacterSupport",e,`Do not use.`)}if(n.__characterPairSupport){this._apiDeprecation.report("LanguageConfiguration.__characterPairSupport",e,`Do not use.`)}const r=this._nextHandle();const o={comments:n.comments,brackets:n.brackets,wordPattern:n.wordPattern?ni._serializeRegExp(n.wordPattern):void 0,indentationRules:n.indentationRules?ni._serializeIndentationRule(n.indentationRules):void 0,onEnterRules:n.onEnterRules?ni._serializeOnEnterRules(n.onEnterRules):void 0,__electricCharacterSupport:n.__electricCharacterSupport,__characterPairSupport:n.__characterPairSupport,autoClosingPairs:n.autoClosingPairs?ni._serializeAutoClosingPairs(n.autoClosingPairs):void 0};this._proxy.$setLanguageConfiguration(r,i,o);return this._createDisposable(r)}$setWordDefinitions(e){for(const i of e){this._documents.setWordDefinitionFor(i.languageId,new RegExp(i.regexSource,i.regexFlags))}}}var JD;(function(t){function e(i){switch(i.type){case"extension":return`extension:${i.extensionId.value}`;case"mcp":return`mcp:${i.collectionId}:${i.definitionId}`;case"internal":return"internal"}}t.toKey=e})(JD||(JD={}));function IO(t){return typeof t==="object"&&typeof t.sessionId==="string"}const CO=xe("notebookService");const TO=xe("codeMapperService");const PO=xe("IChatService");const XD="vscode_editFile";const zb="vscode_editFile_internal";const YD={id:zb,displayName:"",modelDescription:"",source:{type:"internal"}};let qb=class j${constructor(e,i,n){this.chatService=e;this.codeMapperService=i;this.notebookService=n}async invoke(e,i,n,s){if(!e.context){throw new Error("toolInvocationToken is required for this tool")}const r=e.parameters;const o=b.revive(r.uri);const a=sp.parse(o)?.notebook||o;const l=this.chatService.getSession(e.context?.sessionId);const c=l.getRequests().at(-1);if(c.response?.response.getMarkdown().length){l.acceptResponseProgress(c,{kind:"undoStop",id:vi()})}l.acceptResponseProgress(c,{kind:"markdownContent",content:new Xl("\n````\n")});l.acceptResponseProgress(c,{kind:"codeblockUri",uri:a,isEdit:true});l.acceptResponseProgress(c,{kind:"markdownContent",content:new Xl("\n````\n")});if(this.notebookService.hasSupportedNotebooks(a)&&this.notebookService.getNotebookTextModel(a)){l.acceptResponseProgress(c,{kind:"notebookEdit",edits:[],uri:a})}else{l.acceptResponseProgress(c,{kind:"textEdit",edits:[],uri:a})}const u=l.editingSession;if(!u){throw new Error("This tool must be called from within an editing session")}const d=await this.codeMapperService.mapCode({codeBlocks:[{code:r.code,resource:a,markdownBeforeBlock:r.explanation}],location:"tool",chatRequestId:e.chatRequestId,chatRequestModel:e.modelId,chatSessionId:e.context.sessionId},{textEdit:(f,m)=>{l.acceptResponseProgress(c,{kind:"textEdit",uri:f,edits:m})},notebookEdit(f,m){l.acceptResponseProgress(c,{kind:"notebookEdit",uri:f,edits:m})}},s);if(this.notebookService.hasSupportedNotebooks(a)&&this.notebookService.getNotebookTextModel(a)){l.acceptResponseProgress(c,{kind:"notebookEdit",uri:a,edits:[],done:true})}else{l.acceptResponseProgress(c,{kind:"textEdit",uri:a,edits:[],done:true})}if(d?.errorMessage){throw new Error(d.errorMessage)}let p;await new Promise(f=>{let m=false;p=T_(v=>{const y=u.entries.read(v);const D=y?.find(I=>I.modifiedURI.toString()===a.toString());if(D){if(D.isCurrentlyBeingModifiedBy.read(v)){m=true}else if(m){f(true)}}})}).finally(()=>{p.dispose()});return{content:[{kind:"text",value:"The file was edited successfully"}]}}async prepareToolInvocation(e,i){return{presentation:"hidden"}}};qb=z([O(0,PO),O(1,TO),O(2,CO)],qb);const AO=xe("ILanguageModelToolsService");let ZD=class G$ extends Ee{static{this.ID="chat.builtinTools"}constructor(e,i){super();const n=i.createInstance(qb);this._register(e.registerToolData(YD));this._register(e.registerToolImplementation(YD.id,n))}};ZD=z([O(0,AO),O(1,ch)],ZD);const RO="vscode_fetchWebPage_internal";const a5=xe("commandService");const Ty=new class{constructor(){this._commands=new Map;this._onDidRegisterCommand=new L;this.onDidRegisterCommand=this._onDidRegisterCommand.event}registerCommand(t,e){if(!t){throw new Error(`invalid command`)}if(typeof t==="string"){if(!e){throw new Error(`invalid command`)}return this.registerCommand({id:t,handler:e})}if(t.metadata&&Array.isArray(t.metadata.args)){const o=[];for(const l of t.metadata.args){o.push(l.constraint)}const a=t.handler;t.handler=function(l,...c){U5(c,o);return a(l,...c)}}const{id:i}=t;let n=this._commands.get(i);if(!n){n=new wo;this._commands.set(i,n)}const s=n.unshift(t);const r=ge(()=>{s();const o=this._commands.get(i);if(o?.isEmpty()){this._commands.delete(i)}});this._onDidRegisterCommand.fire(i);return n_(r)}registerCommandAlias(t,e){return Ty.registerCommand(t,(i,...n)=>i.get(a5).executeCommand(e,...n))}getCommand(t){const e=this._commands.get(t);if(!e||e.isEmpty()){return void 0}return _i.first(e)}getCommands(){const t=new Map;for(const e of this._commands.keys()){const i=this.getCommand(e);if(i){t.set(e,i)}}return t}};Ty.registerCommand("noop",()=>{});var E;(function(t){t[t["DependsOnKbLayout"]=-1]="DependsOnKbLayout";t[t["Unknown"]=0]="Unknown";t[t["Backspace"]=1]="Backspace";t[t["Tab"]=2]="Tab";t[t["Enter"]=3]="Enter";t[t["Shift"]=4]="Shift";t[t["Ctrl"]=5]="Ctrl";t[t["Alt"]=6]="Alt";t[t["PauseBreak"]=7]="PauseBreak";t[t["CapsLock"]=8]="CapsLock";t[t["Escape"]=9]="Escape";t[t["Space"]=10]="Space";t[t["PageUp"]=11]="PageUp";t[t["PageDown"]=12]="PageDown";t[t["End"]=13]="End";t[t["Home"]=14]="Home";t[t["LeftArrow"]=15]="LeftArrow";t[t["UpArrow"]=16]="UpArrow";t[t["RightArrow"]=17]="RightArrow";t[t["DownArrow"]=18]="DownArrow";t[t["Insert"]=19]="Insert";t[t["Delete"]=20]="Delete";t[t["Digit0"]=21]="Digit0";t[t["Digit1"]=22]="Digit1";t[t["Digit2"]=23]="Digit2";t[t["Digit3"]=24]="Digit3";t[t["Digit4"]=25]="Digit4";t[t["Digit5"]=26]="Digit5";t[t["Digit6"]=27]="Digit6";t[t["Digit7"]=28]="Digit7";t[t["Digit8"]=29]="Digit8";t[t["Digit9"]=30]="Digit9";t[t["KeyA"]=31]="KeyA";t[t["KeyB"]=32]="KeyB";t[t["KeyC"]=33]="KeyC";t[t["KeyD"]=34]="KeyD";t[t["KeyE"]=35]="KeyE";t[t["KeyF"]=36]="KeyF";t[t["KeyG"]=37]="KeyG";t[t["KeyH"]=38]="KeyH";t[t["KeyI"]=39]="KeyI";t[t["KeyJ"]=40]="KeyJ";t[t["KeyK"]=41]="KeyK";t[t["KeyL"]=42]="KeyL";t[t["KeyM"]=43]="KeyM";t[t["KeyN"]=44]="KeyN";t[t["KeyO"]=45]="KeyO";t[t["KeyP"]=46]="KeyP";t[t["KeyQ"]=47]="KeyQ";t[t["KeyR"]=48]="KeyR";t[t["KeyS"]=49]="KeyS";t[t["KeyT"]=50]="KeyT";t[t["KeyU"]=51]="KeyU";t[t["KeyV"]=52]="KeyV";t[t["KeyW"]=53]="KeyW";t[t["KeyX"]=54]="KeyX";t[t["KeyY"]=55]="KeyY";t[t["KeyZ"]=56]="KeyZ";t[t["Meta"]=57]="Meta";t[t["ContextMenu"]=58]="ContextMenu";t[t["F1"]=59]="F1";t[t["F2"]=60]="F2";t[t["F3"]=61]="F3";t[t["F4"]=62]="F4";t[t["F5"]=63]="F5";t[t["F6"]=64]="F6";t[t["F7"]=65]="F7";t[t["F8"]=66]="F8";t[t["F9"]=67]="F9";t[t["F10"]=68]="F10";t[t["F11"]=69]="F11";t[t["F12"]=70]="F12";t[t["F13"]=71]="F13";t[t["F14"]=72]="F14";t[t["F15"]=73]="F15";t[t["F16"]=74]="F16";t[t["F17"]=75]="F17";t[t["F18"]=76]="F18";t[t["F19"]=77]="F19";t[t["F20"]=78]="F20";t[t["F21"]=79]="F21";t[t["F22"]=80]="F22";t[t["F23"]=81]="F23";t[t["F24"]=82]="F24";t[t["NumLock"]=83]="NumLock";t[t["ScrollLock"]=84]="ScrollLock";t[t["Semicolon"]=85]="Semicolon";t[t["Equal"]=86]="Equal";t[t["Comma"]=87]="Comma";t[t["Minus"]=88]="Minus";t[t["Period"]=89]="Period";t[t["Slash"]=90]="Slash";t[t["Backquote"]=91]="Backquote";t[t["BracketLeft"]=92]="BracketLeft";t[t["Backslash"]=93]="Backslash";t[t["BracketRight"]=94]="BracketRight";t[t["Quote"]=95]="Quote";t[t["OEM_8"]=96]="OEM_8";t[t["IntlBackslash"]=97]="IntlBackslash";t[t["Numpad0"]=98]="Numpad0";t[t["Numpad1"]=99]="Numpad1";t[t["Numpad2"]=100]="Numpad2";t[t["Numpad3"]=101]="Numpad3";t[t["Numpad4"]=102]="Numpad4";t[t["Numpad5"]=103]="Numpad5";t[t["Numpad6"]=104]="Numpad6";t[t["Numpad7"]=105]="Numpad7";t[t["Numpad8"]=106]="Numpad8";t[t["Numpad9"]=107]="Numpad9";t[t["NumpadMultiply"]=108]="NumpadMultiply";t[t["NumpadAdd"]=109]="NumpadAdd";t[t["NUMPAD_SEPARATOR"]=110]="NUMPAD_SEPARATOR";t[t["NumpadSubtract"]=111]="NumpadSubtract";t[t["NumpadDecimal"]=112]="NumpadDecimal";t[t["NumpadDivide"]=113]="NumpadDivide";t[t["KEY_IN_COMPOSITION"]=114]="KEY_IN_COMPOSITION";t[t["ABNT_C1"]=115]="ABNT_C1";t[t["ABNT_C2"]=116]="ABNT_C2";t[t["AudioVolumeMute"]=117]="AudioVolumeMute";t[t["AudioVolumeUp"]=118]="AudioVolumeUp";t[t["AudioVolumeDown"]=119]="AudioVolumeDown";t[t["BrowserSearch"]=120]="BrowserSearch";t[t["BrowserHome"]=121]="BrowserHome";t[t["BrowserBack"]=122]="BrowserBack";t[t["BrowserForward"]=123]="BrowserForward";t[t["MediaTrackNext"]=124]="MediaTrackNext";t[t["MediaTrackPrevious"]=125]="MediaTrackPrevious";t[t["MediaStop"]=126]="MediaStop";t[t["MediaPlayPause"]=127]="MediaPlayPause";t[t["LaunchMediaPlayer"]=128]="LaunchMediaPlayer";t[t["LaunchMail"]=129]="LaunchMail";t[t["LaunchApp2"]=130]="LaunchApp2";t[t["Clear"]=131]="Clear";t[t["MAX_VALUE"]=132]="MAX_VALUE"})(E||(E={}));var C;(function(t){t[t["DependsOnKbLayout"]=-1]="DependsOnKbLayout";t[t["None"]=0]="None";t[t["Hyper"]=1]="Hyper";t[t["Super"]=2]="Super";t[t["Fn"]=3]="Fn";t[t["FnLock"]=4]="FnLock";t[t["Suspend"]=5]="Suspend";t[t["Resume"]=6]="Resume";t[t["Turbo"]=7]="Turbo";t[t["Sleep"]=8]="Sleep";t[t["WakeUp"]=9]="WakeUp";t[t["KeyA"]=10]="KeyA";t[t["KeyB"]=11]="KeyB";t[t["KeyC"]=12]="KeyC";t[t["KeyD"]=13]="KeyD";t[t["KeyE"]=14]="KeyE";t[t["KeyF"]=15]="KeyF";t[t["KeyG"]=16]="KeyG";t[t["KeyH"]=17]="KeyH";t[t["KeyI"]=18]="KeyI";t[t["KeyJ"]=19]="KeyJ";t[t["KeyK"]=20]="KeyK";t[t["KeyL"]=21]="KeyL";t[t["KeyM"]=22]="KeyM";t[t["KeyN"]=23]="KeyN";t[t["KeyO"]=24]="KeyO";t[t["KeyP"]=25]="KeyP";t[t["KeyQ"]=26]="KeyQ";t[t["KeyR"]=27]="KeyR";t[t["KeyS"]=28]="KeyS";t[t["KeyT"]=29]="KeyT";t[t["KeyU"]=30]="KeyU";t[t["KeyV"]=31]="KeyV";t[t["KeyW"]=32]="KeyW";t[t["KeyX"]=33]="KeyX";t[t["KeyY"]=34]="KeyY";t[t["KeyZ"]=35]="KeyZ";t[t["Digit1"]=36]="Digit1";t[t["Digit2"]=37]="Digit2";t[t["Digit3"]=38]="Digit3";t[t["Digit4"]=39]="Digit4";t[t["Digit5"]=40]="Digit5";t[t["Digit6"]=41]="Digit6";t[t["Digit7"]=42]="Digit7";t[t["Digit8"]=43]="Digit8";t[t["Digit9"]=44]="Digit9";t[t["Digit0"]=45]="Digit0";t[t["Enter"]=46]="Enter";t[t["Escape"]=47]="Escape";t[t["Backspace"]=48]="Backspace";t[t["Tab"]=49]="Tab";t[t["Space"]=50]="Space";t[t["Minus"]=51]="Minus";t[t["Equal"]=52]="Equal";t[t["BracketLeft"]=53]="BracketLeft";t[t["BracketRight"]=54]="BracketRight";t[t["Backslash"]=55]="Backslash";t[t["IntlHash"]=56]="IntlHash";t[t["Semicolon"]=57]="Semicolon";t[t["Quote"]=58]="Quote";t[t["Backquote"]=59]="Backquote";t[t["Comma"]=60]="Comma";t[t["Period"]=61]="Period";t[t["Slash"]=62]="Slash";t[t["CapsLock"]=63]="CapsLock";t[t["F1"]=64]="F1";t[t["F2"]=65]="F2";t[t["F3"]=66]="F3";t[t["F4"]=67]="F4";t[t["F5"]=68]="F5";t[t["F6"]=69]="F6";t[t["F7"]=70]="F7";t[t["F8"]=71]="F8";t[t["F9"]=72]="F9";t[t["F10"]=73]="F10";t[t["F11"]=74]="F11";t[t["F12"]=75]="F12";t[t["PrintScreen"]=76]="PrintScreen";t[t["ScrollLock"]=77]="ScrollLock";t[t["Pause"]=78]="Pause";t[t["Insert"]=79]="Insert";t[t["Home"]=80]="Home";t[t["PageUp"]=81]="PageUp";t[t["Delete"]=82]="Delete";t[t["End"]=83]="End";t[t["PageDown"]=84]="PageDown";t[t["ArrowRight"]=85]="ArrowRight";t[t["ArrowLeft"]=86]="ArrowLeft";t[t["ArrowDown"]=87]="ArrowDown";t[t["ArrowUp"]=88]="ArrowUp";t[t["NumLock"]=89]="NumLock";t[t["NumpadDivide"]=90]="NumpadDivide";t[t["NumpadMultiply"]=91]="NumpadMultiply";t[t["NumpadSubtract"]=92]="NumpadSubtract";t[t["NumpadAdd"]=93]="NumpadAdd";t[t["NumpadEnter"]=94]="NumpadEnter";t[t["Numpad1"]=95]="Numpad1";t[t["Numpad2"]=96]="Numpad2";t[t["Numpad3"]=97]="Numpad3";t[t["Numpad4"]=98]="Numpad4";t[t["Numpad5"]=99]="Numpad5";t[t["Numpad6"]=100]="Numpad6";t[t["Numpad7"]=101]="Numpad7";t[t["Numpad8"]=102]="Numpad8";t[t["Numpad9"]=103]="Numpad9";t[t["Numpad0"]=104]="Numpad0";t[t["NumpadDecimal"]=105]="NumpadDecimal";t[t["IntlBackslash"]=106]="IntlBackslash";t[t["ContextMenu"]=107]="ContextMenu";t[t["Power"]=108]="Power";t[t["NumpadEqual"]=109]="NumpadEqual";t[t["F13"]=110]="F13";t[t["F14"]=111]="F14";t[t["F15"]=112]="F15";t[t["F16"]=113]="F16";t[t["F17"]=114]="F17";t[t["F18"]=115]="F18";t[t["F19"]=116]="F19";t[t["F20"]=117]="F20";t[t["F21"]=118]="F21";t[t["F22"]=119]="F22";t[t["F23"]=120]="F23";t[t["F24"]=121]="F24";t[t["Open"]=122]="Open";t[t["Help"]=123]="Help";t[t["Select"]=124]="Select";t[t["Again"]=125]="Again";t[t["Undo"]=126]="Undo";t[t["Cut"]=127]="Cut";t[t["Copy"]=128]="Copy";t[t["Paste"]=129]="Paste";t[t["Find"]=130]="Find";t[t["AudioVolumeMute"]=131]="AudioVolumeMute";t[t["AudioVolumeUp"]=132]="AudioVolumeUp";t[t["AudioVolumeDown"]=133]="AudioVolumeDown";t[t["NumpadComma"]=134]="NumpadComma";t[t["IntlRo"]=135]="IntlRo";t[t["KanaMode"]=136]="KanaMode";t[t["IntlYen"]=137]="IntlYen";t[t["Convert"]=138]="Convert";t[t["NonConvert"]=139]="NonConvert";t[t["Lang1"]=140]="Lang1";t[t["Lang2"]=141]="Lang2";t[t["Lang3"]=142]="Lang3";t[t["Lang4"]=143]="Lang4";t[t["Lang5"]=144]="Lang5";t[t["Abort"]=145]="Abort";t[t["Props"]=146]="Props";t[t["NumpadParenLeft"]=147]="NumpadParenLeft";t[t["NumpadParenRight"]=148]="NumpadParenRight";t[t["NumpadBackspace"]=149]="NumpadBackspace";t[t["NumpadMemoryStore"]=150]="NumpadMemoryStore";t[t["NumpadMemoryRecall"]=151]="NumpadMemoryRecall";t[t["NumpadMemoryClear"]=152]="NumpadMemoryClear";t[t["NumpadMemoryAdd"]=153]="NumpadMemoryAdd";t[t["NumpadMemorySubtract"]=154]="NumpadMemorySubtract";t[t["NumpadClear"]=155]="NumpadClear";t[t["NumpadClearEntry"]=156]="NumpadClearEntry";t[t["ControlLeft"]=157]="ControlLeft";t[t["ShiftLeft"]=158]="ShiftLeft";t[t["AltLeft"]=159]="AltLeft";t[t["MetaLeft"]=160]="MetaLeft";t[t["ControlRight"]=161]="ControlRight";t[t["ShiftRight"]=162]="ShiftRight";t[t["AltRight"]=163]="AltRight";t[t["MetaRight"]=164]="MetaRight";t[t["BrightnessUp"]=165]="BrightnessUp";t[t["BrightnessDown"]=166]="BrightnessDown";t[t["MediaPlay"]=167]="MediaPlay";t[t["MediaRecord"]=168]="MediaRecord";t[t["MediaFastForward"]=169]="MediaFastForward";t[t["MediaRewind"]=170]="MediaRewind";t[t["MediaTrackNext"]=171]="MediaTrackNext";t[t["MediaTrackPrevious"]=172]="MediaTrackPrevious";t[t["MediaStop"]=173]="MediaStop";t[t["Eject"]=174]="Eject";t[t["MediaPlayPause"]=175]="MediaPlayPause";t[t["MediaSelect"]=176]="MediaSelect";t[t["LaunchMail"]=177]="LaunchMail";t[t["LaunchApp2"]=178]="LaunchApp2";t[t["LaunchApp1"]=179]="LaunchApp1";t[t["SelectTask"]=180]="SelectTask";t[t["LaunchScreenSaver"]=181]="LaunchScreenSaver";t[t["BrowserSearch"]=182]="BrowserSearch";t[t["BrowserHome"]=183]="BrowserHome";t[t["BrowserBack"]=184]="BrowserBack";t[t["BrowserForward"]=185]="BrowserForward";t[t["BrowserStop"]=186]="BrowserStop";t[t["BrowserRefresh"]=187]="BrowserRefresh";t[t["BrowserFavorites"]=188]="BrowserFavorites";t[t["ZoomToggle"]=189]="ZoomToggle";t[t["MailReply"]=190]="MailReply";t[t["MailForward"]=191]="MailForward";t[t["MailSend"]=192]="MailSend";t[t["MAX_VALUE"]=193]="MAX_VALUE"})(C||(C={}));class Py{constructor(){this._keyCodeToStr=[];this._strToKeyCode=Object.create(null)}define(e,i){this._keyCodeToStr[e]=i;this._strToKeyCode[i.toLowerCase()]=e}keyCodeToStr(e){return this._keyCodeToStr[e]}strToKeyCode(e){return this._strToKeyCode[e.toLowerCase()]||E.Unknown}}const bf=new Py;const jb=new Py;const Gb=new Py;const LO=new Array(230);const NO=Object.create(null);const OO=Object.create(null);const Kb=[];for(let t=0;t<=C.MAX_VALUE;t++){E.DependsOnKbLayout}for(let t=0;t<=E.MAX_VALUE;t++){Kb[t]=C.DependsOnKbLayout}(function(){const t="";const e=[[1,C.None,"None",E.Unknown,"unknown",0,"VK_UNKNOWN",t,t],[1,C.Hyper,"Hyper",E.Unknown,t,0,t,t,t],[1,C.Super,"Super",E.Unknown,t,0,t,t,t],[1,C.Fn,"Fn",E.Unknown,t,0,t,t,t],[1,C.FnLock,"FnLock",E.Unknown,t,0,t,t,t],[1,C.Suspend,"Suspend",E.Unknown,t,0,t,t,t],[1,C.Resume,"Resume",E.Unknown,t,0,t,t,t],[1,C.Turbo,"Turbo",E.Unknown,t,0,t,t,t],[1,C.Sleep,"Sleep",E.Unknown,t,0,"VK_SLEEP",t,t],[1,C.WakeUp,"WakeUp",E.Unknown,t,0,t,t,t],[0,C.KeyA,"KeyA",E.KeyA,"A",65,"VK_A",t,t],[0,C.KeyB,"KeyB",E.KeyB,"B",66,"VK_B",t,t],[0,C.KeyC,"KeyC",E.KeyC,"C",67,"VK_C",t,t],[0,C.KeyD,"KeyD",E.KeyD,"D",68,"VK_D",t,t],[0,C.KeyE,"KeyE",E.KeyE,"E",69,"VK_E",t,t],[0,C.KeyF,"KeyF",E.KeyF,"F",70,"VK_F",t,t],[0,C.KeyG,"KeyG",E.KeyG,"G",71,"VK_G",t,t],[0,C.KeyH,"KeyH",E.KeyH,"H",72,"VK_H",t,t],[0,C.KeyI,"KeyI",E.KeyI,"I",73,"VK_I",t,t],[0,C.KeyJ,"KeyJ",E.KeyJ,"J",74,"VK_J",t,t],[0,C.KeyK,"KeyK",E.KeyK,"K",75,"VK_K",t,t],[0,C.KeyL,"KeyL",E.KeyL,"L",76,"VK_L",t,t],[0,C.KeyM,"KeyM",E.KeyM,"M",77,"VK_M",t,t],[0,C.KeyN,"KeyN",E.KeyN,"N",78,"VK_N",t,t],[0,C.KeyO,"KeyO",E.KeyO,"O",79,"VK_O",t,t],[0,C.KeyP,"KeyP",E.KeyP,"P",80,"VK_P",t,t],[0,C.KeyQ,"KeyQ",E.KeyQ,"Q",81,"VK_Q",t,t],[0,C.KeyR,"KeyR",E.KeyR,"R",82,"VK_R",t,t],[0,C.KeyS,"KeyS",E.KeyS,"S",83,"VK_S",t,t],[0,C.KeyT,"KeyT",E.KeyT,"T",84,"VK_T",t,t],[0,C.KeyU,"KeyU",E.KeyU,"U",85,"VK_U",t,t],[0,C.KeyV,"KeyV",E.KeyV,"V",86,"VK_V",t,t],[0,C.KeyW,"KeyW",E.KeyW,"W",87,"VK_W",t,t],[0,C.KeyX,"KeyX",E.KeyX,"X",88,"VK_X",t,t],[0,C.KeyY,"KeyY",E.KeyY,"Y",89,"VK_Y",t,t],[0,C.KeyZ,"KeyZ",E.KeyZ,"Z",90,"VK_Z",t,t],[0,C.Digit1,"Digit1",E.Digit1,"1",49,"VK_1",t,t],[0,C.Digit2,"Digit2",E.Digit2,"2",50,"VK_2",t,t],[0,C.Digit3,"Digit3",E.Digit3,"3",51,"VK_3",t,t],[0,C.Digit4,"Digit4",E.Digit4,"4",52,"VK_4",t,t],[0,C.Digit5,"Digit5",E.Digit5,"5",53,"VK_5",t,t],[0,C.Digit6,"Digit6",E.Digit6,"6",54,"VK_6",t,t],[0,C.Digit7,"Digit7",E.Digit7,"7",55,"VK_7",t,t],[0,C.Digit8,"Digit8",E.Digit8,"8",56,"VK_8",t,t],[0,C.Digit9,"Digit9",E.Digit9,"9",57,"VK_9",t,t],[0,C.Digit0,"Digit0",E.Digit0,"0",48,"VK_0",t,t],[1,C.Enter,"Enter",E.Enter,"Enter",13,"VK_RETURN",t,t],[1,C.Escape,"Escape",E.Escape,"Escape",27,"VK_ESCAPE",t,t],[1,C.Backspace,"Backspace",E.Backspace,"Backspace",8,"VK_BACK",t,t],[1,C.Tab,"Tab",E.Tab,"Tab",9,"VK_TAB",t,t],[1,C.Space,"Space",E.Space,"Space",32,"VK_SPACE",t,t],[0,C.Minus,"Minus",E.Minus,"-",189,"VK_OEM_MINUS","-","OEM_MINUS"],[0,C.Equal,"Equal",E.Equal,"=",187,"VK_OEM_PLUS","=","OEM_PLUS"],[0,C.BracketLeft,"BracketLeft",E.BracketLeft,"[",219,"VK_OEM_4","[","OEM_4"],[0,C.BracketRight,"BracketRight",E.BracketRight,"]",221,"VK_OEM_6","]","OEM_6"],[0,C.Backslash,"Backslash",E.Backslash,"\\",220,"VK_OEM_5","\\","OEM_5"],[0,C.IntlHash,"IntlHash",E.Unknown,t,0,t,t,t],[0,C.Semicolon,"Semicolon",E.Semicolon,";",186,"VK_OEM_1",";","OEM_1"],[0,C.Quote,"Quote",E.Quote,"'",222,"VK_OEM_7","'","OEM_7"],[0,C.Backquote,"Backquote",E.Backquote,"`",192,"VK_OEM_3","`","OEM_3"],[0,C.Comma,"Comma",E.Comma,",",188,"VK_OEM_COMMA",",","OEM_COMMA"],[0,C.Period,"Period",E.Period,".",190,"VK_OEM_PERIOD",".","OEM_PERIOD"],[0,C.Slash,"Slash",E.Slash,"/",191,"VK_OEM_2","/","OEM_2"],[1,C.CapsLock,"CapsLock",E.CapsLock,"CapsLock",20,"VK_CAPITAL",t,t],[1,C.F1,"F1",E.F1,"F1",112,"VK_F1",t,t],[1,C.F2,"F2",E.F2,"F2",113,"VK_F2",t,t],[1,C.F3,"F3",E.F3,"F3",114,"VK_F3",t,t],[1,C.F4,"F4",E.F4,"F4",115,"VK_F4",t,t],[1,C.F5,"F5",E.F5,"F5",116,"VK_F5",t,t],[1,C.F6,"F6",E.F6,"F6",117,"VK_F6",t,t],[1,C.F7,"F7",E.F7,"F7",118,"VK_F7",t,t],[1,C.F8,"F8",E.F8,"F8",119,"VK_F8",t,t],[1,C.F9,"F9",E.F9,"F9",120,"VK_F9",t,t],[1,C.F10,"F10",E.F10,"F10",121,"VK_F10",t,t],[1,C.F11,"F11",E.F11,"F11",122,"VK_F11",t,t],[1,C.F12,"F12",E.F12,"F12",123,"VK_F12",t,t],[1,C.PrintScreen,"PrintScreen",E.Unknown,t,0,t,t,t],[1,C.ScrollLock,"ScrollLock",E.ScrollLock,"ScrollLock",145,"VK_SCROLL",t,t],[1,C.Pause,"Pause",E.PauseBreak,"PauseBreak",19,"VK_PAUSE",t,t],[1,C.Insert,"Insert",E.Insert,"Insert",45,"VK_INSERT",t,t],[1,C.Home,"Home",E.Home,"Home",36,"VK_HOME",t,t],[1,C.PageUp,"PageUp",E.PageUp,"PageUp",33,"VK_PRIOR",t,t],[1,C.Delete,"Delete",E.Delete,"Delete",46,"VK_DELETE",t,t],[1,C.End,"End",E.End,"End",35,"VK_END",t,t],[1,C.PageDown,"PageDown",E.PageDown,"PageDown",34,"VK_NEXT",t,t],[1,C.ArrowRight,"ArrowRight",E.RightArrow,"RightArrow",39,"VK_RIGHT","Right",t],[1,C.ArrowLeft,"ArrowLeft",E.LeftArrow,"LeftArrow",37,"VK_LEFT","Left",t],[1,C.ArrowDown,"ArrowDown",E.DownArrow,"DownArrow",40,"VK_DOWN","Down",t],[1,C.ArrowUp,"ArrowUp",E.UpArrow,"UpArrow",38,"VK_UP","Up",t],[1,C.NumLock,"NumLock",E.NumLock,"NumLock",144,"VK_NUMLOCK",t,t],[1,C.NumpadDivide,"NumpadDivide",E.NumpadDivide,"NumPad_Divide",111,"VK_DIVIDE",t,t],[1,C.NumpadMultiply,"NumpadMultiply",E.NumpadMultiply,"NumPad_Multiply",106,"VK_MULTIPLY",t,t],[1,C.NumpadSubtract,"NumpadSubtract",E.NumpadSubtract,"NumPad_Subtract",109,"VK_SUBTRACT",t,t],[1,C.NumpadAdd,"NumpadAdd",E.NumpadAdd,"NumPad_Add",107,"VK_ADD",t,t],[1,C.NumpadEnter,"NumpadEnter",E.Enter,t,0,t,t,t],[1,C.Numpad1,"Numpad1",E.Numpad1,"NumPad1",97,"VK_NUMPAD1",t,t],[1,C.Numpad2,"Numpad2",E.Numpad2,"NumPad2",98,"VK_NUMPAD2",t,t],[1,C.Numpad3,"Numpad3",E.Numpad3,"NumPad3",99,"VK_NUMPAD3",t,t],[1,C.Numpad4,"Numpad4",E.Numpad4,"NumPad4",100,"VK_NUMPAD4",t,t],[1,C.Numpad5,"Numpad5",E.Numpad5,"NumPad5",101,"VK_NUMPAD5",t,t],[1,C.Numpad6,"Numpad6",E.Numpad6,"NumPad6",102,"VK_NUMPAD6",t,t],[1,C.Numpad7,"Numpad7",E.Numpad7,"NumPad7",103,"VK_NUMPAD7",t,t],[1,C.Numpad8,"Numpad8",E.Numpad8,"NumPad8",104,"VK_NUMPAD8",t,t],[1,C.Numpad9,"Numpad9",E.Numpad9,"NumPad9",105,"VK_NUMPAD9",t,t],[1,C.Numpad0,"Numpad0",E.Numpad0,"NumPad0",96,"VK_NUMPAD0",t,t],[1,C.NumpadDecimal,"NumpadDecimal",E.NumpadDecimal,"NumPad_Decimal",110,"VK_DECIMAL",t,t],[0,C.IntlBackslash,"IntlBackslash",E.IntlBackslash,"OEM_102",226,"VK_OEM_102",t,t],[1,C.ContextMenu,"ContextMenu",E.ContextMenu,"ContextMenu",93,t,t,t],[1,C.Power,"Power",E.Unknown,t,0,t,t,t],[1,C.NumpadEqual,"NumpadEqual",E.Unknown,t,0,t,t,t],[1,C.F13,"F13",E.F13,"F13",124,"VK_F13",t,t],[1,C.F14,"F14",E.F14,"F14",125,"VK_F14",t,t],[1,C.F15,"F15",E.F15,"F15",126,"VK_F15",t,t],[1,C.F16,"F16",E.F16,"F16",127,"VK_F16",t,t],[1,C.F17,"F17",E.F17,"F17",128,"VK_F17",t,t],[1,C.F18,"F18",E.F18,"F18",129,"VK_F18",t,t],[1,C.F19,"F19",E.F19,"F19",130,"VK_F19",t,t],[1,C.F20,"F20",E.F20,"F20",131,"VK_F20",t,t],[1,C.F21,"F21",E.F21,"F21",132,"VK_F21",t,t],[1,C.F22,"F22",E.F22,"F22",133,"VK_F22",t,t],[1,C.F23,"F23",E.F23,"F23",134,"VK_F23",t,t],[1,C.F24,"F24",E.F24,"F24",135,"VK_F24",t,t],[1,C.Open,"Open",E.Unknown,t,0,t,t,t],[1,C.Help,"Help",E.Unknown,t,0,t,t,t],[1,C.Select,"Select",E.Unknown,t,0,t,t,t],[1,C.Again,"Again",E.Unknown,t,0,t,t,t],[1,C.Undo,"Undo",E.Unknown,t,0,t,t,t],[1,C.Cut,"Cut",E.Unknown,t,0,t,t,t],[1,C.Copy,"Copy",E.Unknown,t,0,t,t,t],[1,C.Paste,"Paste",E.Unknown,t,0,t,t,t],[1,C.Find,"Find",E.Unknown,t,0,t,t,t],[1,C.AudioVolumeMute,"AudioVolumeMute",E.AudioVolumeMute,"AudioVolumeMute",173,"VK_VOLUME_MUTE",t,t],[1,C.AudioVolumeUp,"AudioVolumeUp",E.AudioVolumeUp,"AudioVolumeUp",175,"VK_VOLUME_UP",t,t],[1,C.AudioVolumeDown,"AudioVolumeDown",E.AudioVolumeDown,"AudioVolumeDown",174,"VK_VOLUME_DOWN",t,t],[1,C.NumpadComma,"NumpadComma",E.NUMPAD_SEPARATOR,"NumPad_Separator",108,"VK_SEPARATOR",t,t],[0,C.IntlRo,"IntlRo",E.ABNT_C1,"ABNT_C1",193,"VK_ABNT_C1",t,t],[1,C.KanaMode,"KanaMode",E.Unknown,t,0,t,t,t],[0,C.IntlYen,"IntlYen",E.Unknown,t,0,t,t,t],[1,C.Convert,"Convert",E.Unknown,t,0,t,t,t],[1,C.NonConvert,"NonConvert",E.Unknown,t,0,t,t,t],[1,C.Lang1,"Lang1",E.Unknown,t,0,t,t,t],[1,C.Lang2,"Lang2",E.Unknown,t,0,t,t,t],[1,C.Lang3,"Lang3",E.Unknown,t,0,t,t,t],[1,C.Lang4,"Lang4",E.Unknown,t,0,t,t,t],[1,C.Lang5,"Lang5",E.Unknown,t,0,t,t,t],[1,C.Abort,"Abort",E.Unknown,t,0,t,t,t],[1,C.Props,"Props",E.Unknown,t,0,t,t,t],[1,C.NumpadParenLeft,"NumpadParenLeft",E.Unknown,t,0,t,t,t],[1,C.NumpadParenRight,"NumpadParenRight",E.Unknown,t,0,t,t,t],[1,C.NumpadBackspace,"NumpadBackspace",E.Unknown,t,0,t,t,t],[1,C.NumpadMemoryStore,"NumpadMemoryStore",E.Unknown,t,0,t,t,t],[1,C.NumpadMemoryRecall,"NumpadMemoryRecall",E.Unknown,t,0,t,t,t],[1,C.NumpadMemoryClear,"NumpadMemoryClear",E.Unknown,t,0,t,t,t],[1,C.NumpadMemoryAdd,"NumpadMemoryAdd",E.Unknown,t,0,t,t,t],[1,C.NumpadMemorySubtract,"NumpadMemorySubtract",E.Unknown,t,0,t,t,t],[1,C.NumpadClear,"NumpadClear",E.Clear,"Clear",12,"VK_CLEAR",t,t],[1,C.NumpadClearEntry,"NumpadClearEntry",E.Unknown,t,0,t,t,t],[1,C.None,t,E.Ctrl,"Ctrl",17,"VK_CONTROL",t,t],[1,C.None,t,E.Shift,"Shift",16,"VK_SHIFT",t,t],[1,C.None,t,E.Alt,"Alt",18,"VK_MENU",t,t],[1,C.None,t,E.Meta,"Meta",91,"VK_COMMAND",t,t],[1,C.ControlLeft,"ControlLeft",E.Ctrl,t,0,"VK_LCONTROL",t,t],[1,C.ShiftLeft,"ShiftLeft",E.Shift,t,0,"VK_LSHIFT",t,t],[1,C.AltLeft,"AltLeft",E.Alt,t,0,"VK_LMENU",t,t],[1,C.MetaLeft,"MetaLeft",E.Meta,t,0,"VK_LWIN",t,t],[1,C.ControlRight,"ControlRight",E.Ctrl,t,0,"VK_RCONTROL",t,t],[1,C.ShiftRight,"ShiftRight",E.Shift,t,0,"VK_RSHIFT",t,t],[1,C.AltRight,"AltRight",E.Alt,t,0,"VK_RMENU",t,t],[1,C.MetaRight,"MetaRight",E.Meta,t,0,"VK_RWIN",t,t],[1,C.BrightnessUp,"BrightnessUp",E.Unknown,t,0,t,t,t],[1,C.BrightnessDown,"BrightnessDown",E.Unknown,t,0,t,t,t],[1,C.MediaPlay,"MediaPlay",E.Unknown,t,0,t,t,t],[1,C.MediaRecord,"MediaRecord",E.Unknown,t,0,t,t,t],[1,C.MediaFastForward,"MediaFastForward",E.Unknown,t,0,t,t,t],[1,C.MediaRewind,"MediaRewind",E.Unknown,t,0,t,t,t],[1,C.MediaTrackNext,"MediaTrackNext",E.MediaTrackNext,"MediaTrackNext",176,"VK_MEDIA_NEXT_TRACK",t,t],[1,C.MediaTrackPrevious,"MediaTrackPrevious",E.MediaTrackPrevious,"MediaTrackPrevious",177,"VK_MEDIA_PREV_TRACK",t,t],[1,C.MediaStop,"MediaStop",E.MediaStop,"MediaStop",178,"VK_MEDIA_STOP",t,t],[1,C.Eject,"Eject",E.Unknown,t,0,t,t,t],[1,C.MediaPlayPause,"MediaPlayPause",E.MediaPlayPause,"MediaPlayPause",179,"VK_MEDIA_PLAY_PAUSE",t,t],[1,C.MediaSelect,"MediaSelect",E.LaunchMediaPlayer,"LaunchMediaPlayer",181,"VK_MEDIA_LAUNCH_MEDIA_SELECT",t,t],[1,C.LaunchMail,"LaunchMail",E.LaunchMail,"LaunchMail",180,"VK_MEDIA_LAUNCH_MAIL",t,t],[1,C.LaunchApp2,"LaunchApp2",E.LaunchApp2,"LaunchApp2",183,"VK_MEDIA_LAUNCH_APP2",t,t],[1,C.LaunchApp1,"LaunchApp1",E.Unknown,t,0,"VK_MEDIA_LAUNCH_APP1",t,t],[1,C.SelectTask,"SelectTask",E.Unknown,t,0,t,t,t],[1,C.LaunchScreenSaver,"LaunchScreenSaver",E.Unknown,t,0,t,t,t],[1,C.BrowserSearch,"BrowserSearch",E.BrowserSearch,"BrowserSearch",170,"VK_BROWSER_SEARCH",t,t],[1,C.BrowserHome,"BrowserHome",E.BrowserHome,"BrowserHome",172,"VK_BROWSER_HOME",t,t],[1,C.BrowserBack,"BrowserBack",E.BrowserBack,"BrowserBack",166,"VK_BROWSER_BACK",t,t],[1,C.BrowserForward,"BrowserForward",E.BrowserForward,"BrowserForward",167,"VK_BROWSER_FORWARD",t,t],[1,C.BrowserStop,"BrowserStop",E.Unknown,t,0,"VK_BROWSER_STOP",t,t],[1,C.BrowserRefresh,"BrowserRefresh",E.Unknown,t,0,"VK_BROWSER_REFRESH",t,t],[1,C.BrowserFavorites,"BrowserFavorites",E.Unknown,t,0,"VK_BROWSER_FAVORITES",t,t],[1,C.ZoomToggle,"ZoomToggle",E.Unknown,t,0,t,t,t],[1,C.MailReply,"MailReply",E.Unknown,t,0,t,t,t],[1,C.MailForward,"MailForward",E.Unknown,t,0,t,t,t],[1,C.MailSend,"MailSend",E.Unknown,t,0,t,t,t],[1,C.None,t,E.KEY_IN_COMPOSITION,"KeyInComposition",229,t,t,t],[1,C.None,t,E.ABNT_C2,"ABNT_C2",194,"VK_ABNT_C2",t,t],[1,C.None,t,E.OEM_8,"OEM_8",223,"VK_OEM_8",t,t],[1,C.None,t,E.Unknown,t,0,"VK_KANA",t,t],[1,C.None,t,E.Unknown,t,0,"VK_HANGUL",t,t],[1,C.None,t,E.Unknown,t,0,"VK_JUNJA",t,t],[1,C.None,t,E.Unknown,t,0,"VK_FINAL",t,t],[1,C.None,t,E.Unknown,t,0,"VK_HANJA",t,t],[1,C.None,t,E.Unknown,t,0,"VK_KANJI",t,t],[1,C.None,t,E.Unknown,t,0,"VK_CONVERT",t,t],[1,C.None,t,E.Unknown,t,0,"VK_NONCONVERT",t,t],[1,C.None,t,E.Unknown,t,0,"VK_ACCEPT",t,t],[1,C.None,t,E.Unknown,t,0,"VK_MODECHANGE",t,t],[1,C.None,t,E.Unknown,t,0,"VK_SELECT",t,t],[1,C.None,t,E.Unknown,t,0,"VK_PRINT",t,t],[1,C.None,t,E.Unknown,t,0,"VK_EXECUTE",t,t],[1,C.None,t,E.Unknown,t,0,"VK_SNAPSHOT",t,t],[1,C.None,t,E.Unknown,t,0,"VK_HELP",t,t],[1,C.None,t,E.Unknown,t,0,"VK_APPS",t,t],[1,C.None,t,E.Unknown,t,0,"VK_PROCESSKEY",t,t],[1,C.None,t,E.Unknown,t,0,"VK_PACKET",t,t],[1,C.None,t,E.Unknown,t,0,"VK_DBE_SBCSCHAR",t,t],[1,C.None,t,E.Unknown,t,0,"VK_DBE_DBCSCHAR",t,t],[1,C.None,t,E.Unknown,t,0,"VK_ATTN",t,t],[1,C.None,t,E.Unknown,t,0,"VK_CRSEL",t,t],[1,C.None,t,E.Unknown,t,0,"VK_EXSEL",t,t],[1,C.None,t,E.Unknown,t,0,"VK_EREOF",t,t],[1,C.None,t,E.Unknown,t,0,"VK_PLAY",t,t],[1,C.None,t,E.Unknown,t,0,"VK_ZOOM",t,t],[1,C.None,t,E.Unknown,t,0,"VK_NONAME",t,t],[1,C.None,t,E.Unknown,t,0,"VK_PA1",t,t],[1,C.None,t,E.Unknown,t,0,"VK_OEM_CLEAR",t,t]];const i=[];const n=[];for(const s of e){const[r,o,a,l,c,u,d,p,f]=s;if(!n[o]){n[o]=true;NO[a]=o;OO[a.toLowerCase()]=o;if(r){if(l!==E.Unknown&&l!==E.Enter&&l!==E.Ctrl&&l!==E.Shift&&l!==E.Alt&&l!==E.Meta){Kb[l]=o}}}if(!i[l]){i[l]=true;if(!c){throw new Error(`String representation missing for key code ${l} around scan code ${a}`)}bf.define(l,c);jb.define(l,p||c);Gb.define(l,f||p||c)}if(u){LO[u]=l}}Kb[E.Enter]=C.Enter})();var ek;(function(t){function e(a){return bf.keyCodeToStr(a)}t.toString=e;function i(a){return bf.strToKeyCode(a)}t.fromString=i;function n(a){return jb.keyCodeToStr(a)}t.toUserSettingsUS=n;function s(a){return Gb.keyCodeToStr(a)}t.toUserSettingsGeneral=s;function r(a){return jb.strToKeyCode(a)||Gb.strToKeyCode(a)}t.fromUserSettings=r;function o(a){if(a>=E.Numpad0&&a<=E.NumpadDivide){return null}switch(a){case E.UpArrow:return"Up";case E.DownArrow:return"Down";case E.LeftArrow:return"Left";case E.RightArrow:return"Right"}return bf.keyCodeToStr(a)}t.toElectronAccelerator=o})(ek||(ek={}));var tk;(function(t){t[t["CtrlCmd"]=2048]="CtrlCmd";t[t["Shift"]=1024]="Shift";t[t["Alt"]=512]="Alt";t[t["WinCtrl"]=256]="WinCtrl"})(tk||(tk={}));var Ho;(function(t){t[t["CtrlCmd"]=2048]="CtrlCmd";t[t["Shift"]=1024]="Shift";t[t["Alt"]=512]="Alt";t[t["WinCtrl"]=256]="WinCtrl";t[t["KeyCode"]=255]="KeyCode"})(Ho||(Ho={}));function ik(t,e){if(typeof t==="number"){if(t===0){return null}const i=(t&65535)>>>0;const n=(t&4294901760)>>>16;if(n!==0){return new yf([Bh(i,e),Bh(n,e)])}return new yf([Bh(i,e)])}else{const i=[];for(let n=0;n<t.length;n++){i.push(Bh(t[n],e))}return new yf(i)}}function Bh(t,e){const i=t&Ho.CtrlCmd?true:false;const n=t&Ho.WinCtrl?true:false;const s=e===Cs.Macintosh?n:i;const r=t&Ho.Shift?true:false;const o=t&Ho.Alt?true:false;const a=e===Cs.Macintosh?i:n;const l=t&Ho.KeyCode;return new Ay(s,r,o,a,l)}class Ay{constructor(e,i,n,s,r){this.ctrlKey=e;this.shiftKey=i;this.altKey=n;this.metaKey=s;this.keyCode=r}equals(e){return e instanceof Ay&&this.ctrlKey===e.ctrlKey&&this.shiftKey===e.shiftKey&&this.altKey===e.altKey&&this.metaKey===e.metaKey&&this.keyCode===e.keyCode}getHashCode(){const e=this.ctrlKey?"1":"0";const i=this.shiftKey?"1":"0";const n=this.altKey?"1":"0";const s=this.metaKey?"1":"0";return`K${e}${i}${n}${s}${this.keyCode}`}isModifierKey(){return this.keyCode===E.Unknown||this.keyCode===E.Ctrl||this.keyCode===E.Meta||this.keyCode===E.Alt||this.keyCode===E.Shift}toKeybinding(){return new yf([this])}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===E.Ctrl||this.shiftKey&&this.keyCode===E.Shift||this.altKey&&this.keyCode===E.Alt||this.metaKey&&this.keyCode===E.Meta}}class yf{constructor(e){if(e.length===0){throw $e(`chords`)}this.chords=e}getHashCode(){let e="";for(let i=0,n=this.chords.length;i<n;i++){if(i!==0){e+=";"}e+=this.chords[i].getHashCode()}return e}equals(e){if(e===null){return false}if(this.chords.length!==e.chords.length){return false}for(let i=0;i<this.chords.length;i++){if(!this.chords[i].equals(e.chords[i])){return false}}return true}}var nk;(function(t){t[t["EditorCore"]=0]="EditorCore";t[t["EditorContrib"]=100]="EditorContrib";t[t["WorkbenchContrib"]=200]="WorkbenchContrib";t[t["BuiltinExtension"]=300]="BuiltinExtension";t[t["ExternalExtension"]=400]="ExternalExtension"})(nk||(nk={}));class Ry{constructor(){this._coreKeybindings=new wo;this._extensionKeybindings=[];this._cachedMergedKeybindings=null}static bindToCurrentPlatform(e){if(Eh===Cs.Windows){if(e&&e.win){return e.win}}else if(Eh===Cs.Macintosh){if(e&&e.mac){return e.mac}}else{if(e&&e.linux){return e.linux}}return e}registerKeybindingRule(e){const i=Ry.bindToCurrentPlatform(e);const n=new Ie;if(i&&i.primary){const s=ik(i.primary,Eh);if(s){n.add(this._registerDefaultKeybinding(s,e.id,e.args,e.weight,0,e.when))}}if(i&&Array.isArray(i.secondary)){for(let s=0,r=i.secondary.length;s<r;s++){const o=i.secondary[s];const a=ik(o,Eh);if(a){n.add(this._registerDefaultKeybinding(a,e.id,e.args,e.weight,-s-1,e.when))}}}return n}setExtensionKeybindings(e){const i=[];let n=0;for(const s of e){if(s.keybinding){i[n++]={keybinding:s.keybinding,command:s.id,commandArgs:s.args,when:s.when,weight1:s.weight,weight2:0,extensionId:s.extensionId||null,isBuiltinExtension:s.isBuiltinExtension||false}}}this._extensionKeybindings=i;this._cachedMergedKeybindings=null}registerCommandAndKeybindingRule(e){return g0(this.registerKeybindingRule(e),Ty.registerCommand(e))}_registerDefaultKeybinding(e,i,n,s,r,o){const a=this._coreKeybindings.push({keybinding:e,command:i,commandArgs:n,when:o,weight1:s,weight2:r,extensionId:null,isBuiltinExtension:false});this._cachedMergedKeybindings=null;return ge(()=>{a();this._cachedMergedKeybindings=null})}getDefaultKeybindings(){if(!this._cachedMergedKeybindings){this._cachedMergedKeybindings=Array.from(this._coreKeybindings).concat(this._extensionKeybindings);this._cachedMergedKeybindings.sort(UO)}return this._cachedMergedKeybindings.slice(0)}}const FO=new Ry;const MO={EditorModes:"platform.keybindingsRegistry"};ci.add(MO.EditorModes,FO);function UO(t,e){if(t.weight1!==e.weight1){return t.weight1-e.weight1}if(t.command&&e.command){if(t.command<e.command){return-1}if(t.command>e.command){return 1}}return t.weight2-e.weight2}var xf;function $O(t){return t.command!==void 0}class P{static{this._instances=new Map}static{this.CommandPalette=new P("CommandPalette")}static{this.DebugBreakpointsContext=new P("DebugBreakpointsContext")}static{this.DebugCallStackContext=new P("DebugCallStackContext")}static{this.DebugConsoleContext=new P("DebugConsoleContext")}static{this.DebugVariablesContext=new P("DebugVariablesContext")}static{this.NotebookVariablesContext=new P("NotebookVariablesContext")}static{this.DebugHoverContext=new P("DebugHoverContext")}static{this.DebugWatchContext=new P("DebugWatchContext")}static{this.DebugToolBar=new P("DebugToolBar")}static{this.DebugToolBarStop=new P("DebugToolBarStop")}static{this.DebugDisassemblyContext=new P("DebugDisassemblyContext")}static{this.DebugCallStackToolbar=new P("DebugCallStackToolbar")}static{this.DebugCreateConfiguration=new P("DebugCreateConfiguration")}static{this.EditorContext=new P("EditorContext")}static{this.SimpleEditorContext=new P("SimpleEditorContext")}static{this.EditorContent=new P("EditorContent")}static{this.EditorLineNumberContext=new P("EditorLineNumberContext")}static{this.EditorContextCopy=new P("EditorContextCopy")}static{this.EditorContextPeek=new P("EditorContextPeek")}static{this.EditorContextShare=new P("EditorContextShare")}static{this.EditorTitle=new P("EditorTitle")}static{this.EditorTitleRun=new P("EditorTitleRun")}static{this.EditorTitleContext=new P("EditorTitleContext")}static{this.EditorTitleContextShare=new P("EditorTitleContextShare")}static{this.EmptyEditorGroup=new P("EmptyEditorGroup")}static{this.EmptyEditorGroupContext=new P("EmptyEditorGroupContext")}static{this.EditorTabsBarContext=new P("EditorTabsBarContext")}static{this.EditorTabsBarShowTabsSubmenu=new P("EditorTabsBarShowTabsSubmenu")}static{this.EditorTabsBarShowTabsZenModeSubmenu=new P("EditorTabsBarShowTabsZenModeSubmenu")}static{this.EditorActionsPositionSubmenu=new P("EditorActionsPositionSubmenu")}static{this.ExplorerContext=new P("ExplorerContext")}static{this.ExplorerContextShare=new P("ExplorerContextShare")}static{this.ExtensionContext=new P("ExtensionContext")}static{this.ExtensionEditorContextMenu=new P("ExtensionEditorContextMenu")}static{this.GlobalActivity=new P("GlobalActivity")}static{this.CommandCenter=new P("CommandCenter")}static{this.CommandCenterCenter=new P("CommandCenterCenter")}static{this.LayoutControlMenuSubmenu=new P("LayoutControlMenuSubmenu")}static{this.LayoutControlMenu=new P("LayoutControlMenu")}static{this.MenubarMainMenu=new P("MenubarMainMenu")}static{this.MenubarAppearanceMenu=new P("MenubarAppearanceMenu")}static{this.MenubarDebugMenu=new P("MenubarDebugMenu")}static{this.MenubarEditMenu=new P("MenubarEditMenu")}static{this.MenubarCopy=new P("MenubarCopy")}static{this.MenubarFileMenu=new P("MenubarFileMenu")}static{this.MenubarGoMenu=new P("MenubarGoMenu")}static{this.MenubarHelpMenu=new P("MenubarHelpMenu")}static{this.MenubarLayoutMenu=new P("MenubarLayoutMenu")}static{this.MenubarNewBreakpointMenu=new P("MenubarNewBreakpointMenu")}static{this.PanelAlignmentMenu=new P("PanelAlignmentMenu")}static{this.PanelPositionMenu=new P("PanelPositionMenu")}static{this.ActivityBarPositionMenu=new P("ActivityBarPositionMenu")}static{this.MenubarPreferencesMenu=new P("MenubarPreferencesMenu")}static{this.MenubarRecentMenu=new P("MenubarRecentMenu")}static{this.MenubarSelectionMenu=new P("MenubarSelectionMenu")}static{this.MenubarShare=new P("MenubarShare")}static{this.MenubarSwitchEditorMenu=new P("MenubarSwitchEditorMenu")}static{this.MenubarSwitchGroupMenu=new P("MenubarSwitchGroupMenu")}static{this.MenubarTerminalMenu=new P("MenubarTerminalMenu")}static{this.MenubarTerminalSuggestStatusMenu=new P("MenubarTerminalSuggestStatusMenu")}static{this.MenubarViewMenu=new P("MenubarViewMenu")}static{this.MenubarHomeMenu=new P("MenubarHomeMenu")}static{this.OpenEditorsContext=new P("OpenEditorsContext")}static{this.OpenEditorsContextShare=new P("OpenEditorsContextShare")}static{this.ProblemsPanelContext=new P("ProblemsPanelContext")}static{this.SCMInputBox=new P("SCMInputBox")}static{this.SCMChangeContext=new P("SCMChangeContext")}static{this.SCMResourceContext=new P("SCMResourceContext")}static{this.SCMResourceContextShare=new P("SCMResourceContextShare")}static{this.SCMResourceFolderContext=new P("SCMResourceFolderContext")}static{this.SCMResourceGroupContext=new P("SCMResourceGroupContext")}static{this.SCMSourceControl=new P("SCMSourceControl")}static{this.SCMSourceControlInline=new P("SCMSourceControlInline")}static{this.SCMSourceControlTitle=new P("SCMSourceControlTitle")}static{this.SCMHistoryTitle=new P("SCMHistoryTitle")}static{this.SCMHistoryItemContext=new P("SCMHistoryItemContext")}static{this.SCMHistoryItemHover=new P("SCMHistoryItemHover")}static{this.SCMHistoryItemRefContext=new P("SCMHistoryItemRefContext")}static{this.SCMQuickDiffDecorations=new P("SCMQuickDiffDecorations")}static{this.SCMTitle=new P("SCMTitle")}static{this.SearchContext=new P("SearchContext")}static{this.SearchActionMenu=new P("SearchActionContext")}static{this.StatusBarWindowIndicatorMenu=new P("StatusBarWindowIndicatorMenu")}static{this.StatusBarRemoteIndicatorMenu=new P("StatusBarRemoteIndicatorMenu")}static{this.StickyScrollContext=new P("StickyScrollContext")}static{this.TestItem=new P("TestItem")}static{this.TestItemGutter=new P("TestItemGutter")}static{this.TestProfilesContext=new P("TestProfilesContext")}static{this.TestMessageContext=new P("TestMessageContext")}static{this.TestMessageContent=new P("TestMessageContent")}static{this.TestPeekElement=new P("TestPeekElement")}static{this.TestPeekTitle=new P("TestPeekTitle")}static{this.TestCallStack=new P("TestCallStack")}static{this.TestCoverageFilterItem=new P("TestCoverageFilterItem")}static{this.TouchBarContext=new P("TouchBarContext")}static{this.TitleBar=new P("TitleBar")}static{this.TitleBarContext=new P("TitleBarContext")}static{this.TitleBarTitleContext=new P("TitleBarTitleContext")}static{this.TunnelContext=new P("TunnelContext")}static{this.TunnelPrivacy=new P("TunnelPrivacy")}static{this.TunnelProtocol=new P("TunnelProtocol")}static{this.TunnelPortInline=new P("TunnelInline")}static{this.TunnelTitle=new P("TunnelTitle")}static{this.TunnelLocalAddressInline=new P("TunnelLocalAddressInline")}static{this.TunnelOriginInline=new P("TunnelOriginInline")}static{this.ViewItemContext=new P("ViewItemContext")}static{this.ViewContainerTitle=new P("ViewContainerTitle")}static{this.ViewContainerTitleContext=new P("ViewContainerTitleContext")}static{this.ViewTitle=new P("ViewTitle")}static{this.ViewTitleContext=new P("ViewTitleContext")}static{this.CommentEditorActions=new P("CommentEditorActions")}static{this.CommentThreadTitle=new P("CommentThreadTitle")}static{this.CommentThreadActions=new P("CommentThreadActions")}static{this.CommentThreadAdditionalActions=new P("CommentThreadAdditionalActions")}static{this.CommentThreadTitleContext=new P("CommentThreadTitleContext")}static{this.CommentThreadCommentContext=new P("CommentThreadCommentContext")}static{this.CommentTitle=new P("CommentTitle")}static{this.CommentActions=new P("CommentActions")}static{this.CommentsViewThreadActions=new P("CommentsViewThreadActions")}static{this.InteractiveToolbar=new P("InteractiveToolbar")}static{this.InteractiveCellTitle=new P("InteractiveCellTitle")}static{this.InteractiveCellDelete=new P("InteractiveCellDelete")}static{this.InteractiveCellExecute=new P("InteractiveCellExecute")}static{this.InteractiveInputExecute=new P("InteractiveInputExecute")}static{this.InteractiveInputConfig=new P("InteractiveInputConfig")}static{this.ReplInputExecute=new P("ReplInputExecute")}static{this.IssueReporter=new P("IssueReporter")}static{this.NotebookToolbar=new P("NotebookToolbar")}static{this.NotebookToolbarContext=new P("NotebookToolbarContext")}static{this.NotebookStickyScrollContext=new P("NotebookStickyScrollContext")}static{this.NotebookCellTitle=new P("NotebookCellTitle")}static{this.NotebookCellDelete=new P("NotebookCellDelete")}static{this.NotebookCellInsert=new P("NotebookCellInsert")}static{this.NotebookCellBetween=new P("NotebookCellBetween")}static{this.NotebookCellListTop=new P("NotebookCellTop")}static{this.NotebookCellExecute=new P("NotebookCellExecute")}static{this.NotebookCellExecuteGoTo=new P("NotebookCellExecuteGoTo")}static{this.NotebookCellExecutePrimary=new P("NotebookCellExecutePrimary")}static{this.NotebookDiffCellInputTitle=new P("NotebookDiffCellInputTitle")}static{this.NotebookDiffDocumentMetadata=new P("NotebookDiffDocumentMetadata")}static{this.NotebookDiffCellMetadataTitle=new P("NotebookDiffCellMetadataTitle")}static{this.NotebookDiffCellOutputsTitle=new P("NotebookDiffCellOutputsTitle")}static{this.NotebookOutputToolbar=new P("NotebookOutputToolbar")}static{this.NotebookOutlineFilter=new P("NotebookOutlineFilter")}static{this.NotebookOutlineActionMenu=new P("NotebookOutlineActionMenu")}static{this.NotebookEditorLayoutConfigure=new P("NotebookEditorLayoutConfigure")}static{this.NotebookKernelSource=new P("NotebookKernelSource")}static{this.BulkEditTitle=new P("BulkEditTitle")}static{this.BulkEditContext=new P("BulkEditContext")}static{this.TimelineItemContext=new P("TimelineItemContext")}static{this.TimelineTitle=new P("TimelineTitle")}static{this.TimelineTitleContext=new P("TimelineTitleContext")}static{this.TimelineFilterSubMenu=new P("TimelineFilterSubMenu")}static{this.AccountsContext=new P("AccountsContext")}static{this.SidebarTitle=new P("SidebarTitle")}static{this.PanelTitle=new P("PanelTitle")}static{this.AuxiliaryBarTitle=new P("AuxiliaryBarTitle")}static{this.AuxiliaryBarHeader=new P("AuxiliaryBarHeader")}static{this.TerminalInstanceContext=new P("TerminalInstanceContext")}static{this.TerminalEditorInstanceContext=new P("TerminalEditorInstanceContext")}static{this.TerminalNewDropdownContext=new P("TerminalNewDropdownContext")}static{this.TerminalTabContext=new P("TerminalTabContext")}static{this.TerminalTabEmptyAreaContext=new P("TerminalTabEmptyAreaContext")}static{this.TerminalStickyScrollContext=new P("TerminalStickyScrollContext")}static{this.WebviewContext=new P("WebviewContext")}static{this.InlineCompletionsActions=new P("InlineCompletionsActions")}static{this.InlineEditsActions=new P("InlineEditsActions")}static{this.NewFile=new P("NewFile")}static{this.MergeInput1Toolbar=new P("MergeToolbar1Toolbar")}static{this.MergeInput2Toolbar=new P("MergeToolbar2Toolbar")}static{this.MergeBaseToolbar=new P("MergeBaseToolbar")}static{this.MergeInputResultToolbar=new P("MergeToolbarResultToolbar")}static{this.InlineSuggestionToolbar=new P("InlineSuggestionToolbar")}static{this.InlineEditToolbar=new P("InlineEditToolbar")}static{this.ChatContext=new P("ChatContext")}static{this.ChatCodeBlock=new P("ChatCodeblock")}static{this.ChatCompareBlock=new P("ChatCompareBlock")}static{this.ChatMessageTitle=new P("ChatMessageTitle")}static{this.ChatMessageFooter=new P("ChatMessageFooter")}static{this.ChatExecute=new P("ChatExecute")}static{this.ChatExecuteSecondary=new P("ChatExecuteSecondary")}static{this.ChatInput=new P("ChatInput")}static{this.ChatInputSide=new P("ChatInputSide")}static{this.ChatModelPicker=new P("ChatModelPicker")}static{this.ChatEditingWidgetToolbar=new P("ChatEditingWidgetToolbar")}static{this.ChatEditingEditorContent=new P("ChatEditingEditorContent")}static{this.ChatEditingEditorHunk=new P("ChatEditingEditorHunk")}static{this.ChatEditingDeletedNotebookCell=new P("ChatEditingDeletedNotebookCell")}static{this.ChatInputAttachmentToolbar=new P("ChatInputAttachmentToolbar")}static{this.ChatEditingWidgetModifiedFilesToolbar=new P("ChatEditingWidgetModifiedFilesToolbar")}static{this.ChatInputResourceAttachmentContext=new P("ChatInputResourceAttachmentContext")}static{this.ChatInputSymbolAttachmentContext=new P("ChatInputSymbolAttachmentContext")}static{this.ChatInlineResourceAnchorContext=new P("ChatInlineResourceAnchorContext")}static{this.ChatInlineSymbolAnchorContext=new P("ChatInlineSymbolAnchorContext")}static{this.ChatEditingCodeBlockContext=new P("ChatEditingCodeBlockContext")}static{this.ChatTitleBarMenu=new P("ChatTitleBarMenu")}static{this.ChatAttachmentsContext=new P("ChatAttachmentsContext")}static{this.AccessibleView=new P("AccessibleView")}static{this.MultiDiffEditorFileToolbar=new P("MultiDiffEditorFileToolbar")}static{this.DiffEditorHunkToolbar=new P("DiffEditorHunkToolbar")}static{this.DiffEditorSelectionToolbar=new P("DiffEditorSelectionToolbar")}static for(e){return P._instances.get(e)??new P(e)}constructor(e){if(P._instances.has(e)){throw new TypeError(`MenuId with identifier '${e}' already exists. Use MenuId.for(ident) or a unique identifier`)}P._instances.set(e,this);this.id=e}}class Zr{static{this._all=new Map}static for(e){let i=this._all.get(e);if(!i){i=new Zr(e);this._all.set(e,i)}return i}static merge(e){const i=new Set;for(const n of e){if(n instanceof Zr){i.add(n.id)}}return i}constructor(e){this.id=e;this.has=i=>i===e}}new class{constructor(){this._commands=new Map;this._menuItems=new Map;this._onDidChangeMenu=new hT({merge:Zr.merge});this.onDidChangeMenu=this._onDidChangeMenu.event}addCommand(t){this._commands.set(t.id,t);this._onDidChangeMenu.fire(Zr.for(P.CommandPalette));return n_(ge(()=>{if(this._commands.delete(t.id)){this._onDidChangeMenu.fire(Zr.for(P.CommandPalette))}}))}getCommand(t){return this._commands.get(t)}getCommands(){const t=new Map;this._commands.forEach((e,i)=>t.set(i,e));return t}appendMenuItem(t,e){let i=this._menuItems.get(t);if(!i){i=new wo;this._menuItems.set(t,i)}const n=i.push(e);this._onDidChangeMenu.fire(Zr.for(t));return n_(ge(()=>{n();this._onDidChangeMenu.fire(Zr.for(t))}))}appendMenuItems(t){const e=new Ie;for(const{id:i,item:n}of t){e.add(this.appendMenuItem(i,n))}return e}getMenuItems(t){let e;if(this._menuItems.has(t)){e=[...this._menuItems.get(t)]}else{e=[]}if(t===P.CommandPalette){this._appendImplicitItems(e)}return e}_appendImplicitItems(t){const e=new Set;for(const i of t){if($O(i)){e.add(i.command.id);if(i.alt){e.add(i.alt.id)}}}this._commands.forEach((i,n)=>{if(!e.has(n)){t.push({command:i})}})}};let sk=xf=class K${static label(e,i){return i?.renderShortTitle&&e.shortTitle?typeof e.shortTitle==="string"?e.shortTitle:e.shortTitle.value:typeof e.title==="string"?e.title:e.title.value}constructor(e,i,n,s,r,o,a){this.hideActions=s;this.menuKeybinding=r;this._commandService=a;this.id=e.id;this.label=xf.label(e,n);this.tooltip=(typeof e.tooltip==="string"?e.tooltip:e.tooltip?.value)??"";this.enabled=!e.precondition||o.contextMatchesRules(e.precondition);this.checked=void 0;let l;if(e.toggled){const c=e.toggled.condition?e.toggled:{condition:e.toggled};this.checked=o.contextMatchesRules(c.condition);if(this.checked&&c.tooltip){this.tooltip=typeof c.tooltip==="string"?c.tooltip:c.tooltip.value}if(this.checked&&Zt.isThemeIcon(c.icon)){l=c.icon}if(this.checked&&c.title){this.label=typeof c.title==="string"?c.title:c.title.value}}if(!l){l=Zt.isThemeIcon(e.icon)?e.icon:void 0}this.item=e;this.alt=i?new xf(i,void 0,n,s,void 0,o,a):void 0;this._options=n;this.class=l&&Zt.asClassName(l)}run(...e){let i=[];if(this._options?.arg){i=[...i,this._options.arg]}if(this._options?.shouldForwardArgs){i=[...i,...e]}return this._commandService.executeCommand(this.id,...i)}};sk=xf=z([O(5,Im),O(6,a5)],sk);const l5=xe("extensionsWorkbenchService");gm(6786,"Extensions");var Qb;(function(t){t[t["Installing"]=0]="Installing";t[t["Installed"]=1]="Installed";t[t["Uninstalling"]=2]="Uninstalling";t[t["Uninstalled"]=3]="Uninstalled"})(Qb||(Qb={}));var rk;(function(t){t["ReloadWindow"]="reloadWindow";t["RestartExtensions"]="restartExtensions";t["DownloadUpdate"]="downloadUpdate";t["ApplyUpdate"]="applyUpdate";t["QuitAndInstall"]="quitAndInstall"})(rk||(rk={}));var ok;(function(t){t["Readme"]="readme";t["Features"]="features";t["Changelog"]="changelog";t["Dependencies"]="dependencies";t["ExtensionPack"]="extensionPack"})(ok||(ok={}));let ak=class Q$ extends Ee{constructor(e,i){super();this.containers=e;this._register(i.onChange(this.update,this))}set extension(e){this.containers.forEach(i=>i.extension=e)}update(e){for(const i of this.containers){if(e&&i.extension){if(PR(i.extension.identifier,e.identifier)){if(i.extension.server&&e.server&&i.extension.server!==e.server){if(i.updateWhenCounterExtensionChanges){i.update()}}else{i.extension=e}}}else{i.update()}}}};ak=z([O(1,l5)],ak);new T("hasOutdatedExtensions",false);new T("hasGallery",false);new T("extensionResultListFocused ",true);new P("extensionsSearchActionsMenu");const HO="vscode_searchExtensions_internal";({icon:Zt.fromId(ve.extensions.id),displayName:h(6799,"Search Extensions"),modelDescription:h(6800,"This is a tool for browsing Visual Studio Code Extensions Marketplace. It allows the model to search for extensions and retrieve detailed information about them. The model should use this tool whenever it needs to discover extensions or resolve information about known ones. To use the tool, the model has to provide the category of the extensions, relevant search keywords, or known extension IDs. Note that search results may include false positives, so reviewing and filtering is recommended.")});let lk=class J${constructor(e){this.extensionWorkbenchService=e}async invoke(e,i,n,s){const r=e.parameters;if(!r.keywords?.length&&!r.category&&!r.ids?.length){return{content:[{kind:"text",value:h(6801,"Please provide a category or keywords or ids to search for.")}]}}const o=new Map;const a=u=>{for(const d of u){if(d.deprecationInfo||d.isMalicious){continue}o.set(d.identifier.id.toLowerCase(),{id:d.identifier.id,name:d.displayName,description:d.description,installed:d.state===Qb.Installed,installCount:d.installCount??0,rating:d.rating??0,categories:d.categories??[],tags:d.gallery?.tags??[]})}};const l=async u=>{const d=await this.extensionWorkbenchService.queryGallery({text:u,pageSize:10,sortBy:H_.InstallCount},s);if(d.firstPage.length){a(d.firstPage)}};if(r.ids?.length){const u=await this.extensionWorkbenchService.getExtensions(r.ids.map(d=>({id:d})),s);a(u)}if(r.keywords?.length){for(const u of r.keywords??[]){if(u==="featured"){await l("featured")}else{let d=r.category?`category:"${r.category}"`:"";d=u?`${d} ${u}`.trim():d;await l(d)}}}else{await l(`category:"${r.category}"`)}const c=Array.from(o.values());return{content:[{kind:"text",value:`Here are the list of extensions:
${JSON.stringify(c)}
. Important: Use the following format to display extensions to the user because there is a renderer available to parse these extensions in this format and display them with all details. So, do not describe about the extensions to the user.
\`\`\`vscode-extensions
extensionId1,extensionId2
\`\`\`
.`}],toolResultDetails:{input:JSON.stringify(r),output:[{type:"text",value:JSON.stringify(c.map(u=>u.id))}]}}}};lk=z([O(0,l5)],lk);class ck{constructor(e){this._data=e}update(e){this._data=e}get data(){return this._data}get apiObject(){if(!this._apiObject){const e=this;this._apiObject=Object.freeze({get name(){return e._data.id},get description(){return e._data.modelDescription},get inputSchema(){return e._data.inputSchema},get tags(){return e._data.tags??[]}})}return this._apiObject}}class BO{constructor(e,i){this._languageModels=i;this._registeredTools=new Map;this._tokenCountFuncs=new Map;this._allTools=new Map;this._proxy=e.getProxy(Y.MainThreadLanguageModelTools);this._proxy.$getTools().then(n=>{for(const s of n){this._allTools.set(s.id,new ck(ti(s)))}})}async $countTokensForInvocation(e,i,n){const s=this._tokenCountFuncs.get(e);if(!s){throw new Error(`Tool invocation call ${e} not found`)}return await s(i,n)}async invokeTool(e,i,n,s){const r=vi();if(n.tokenizationOptions){this._tokenCountFuncs.set(r,n.tokenizationOptions.countTokens)}try{if(n.toolInvocationToken&&!IO(n.toolInvocationToken)){throw new Error(`Invalid tool invocation token`)}if((i===zb||i===XD)&&!dt(e,"chatParticipantPrivate")){throw new Error(`Invalid tool: ${i}`)}const o=await this._proxy.$invokeTool({toolId:i,callId:r,parameters:n.input,tokenBudget:n.tokenizationOptions?.tokenBudget,context:n.toolInvocationToken,chatRequestId:dt(e,"chatParticipantPrivate")?n.chatRequestId:void 0,chatInteractionId:dt(e,"chatParticipantPrivate")?n.chatInteractionId:void 0},s);const a=o instanceof Bi?o.value:o;return Gg.to(ti(a))}finally{this._tokenCountFuncs.delete(r)}}$onDidChangeTools(e){const i=new Set(this._registeredTools.keys());for(const n of e){i.delete(n.id);const s=this._allTools.get(n.id);if(s){s.update(n)}else{this._allTools.set(n.id,new ck(ti(n)))}}for(const n of i){this._allTools.delete(n)}}getTools(e){return Array.from(this._allTools.values()).map(i=>i.apiObject).filter(i=>{switch(i.name){case zb:case XD:case RO:case HO:return dt(e,"chatParticipantPrivate");default:return true}})}async $invokeTool(e,i){const n=this._registeredTools.get(e.toolId);if(!n){throw new Error(`Unknown tool ${e.toolId}`)}const s={input:e.parameters,toolInvocationToken:e.context};if(dt(n.extension,"chatParticipantPrivate")){s.chatRequestId=e.chatRequestId;s.chatInteractionId=e.chatInteractionId;s.chatSessionId=e.context?.sessionId;if(e.toolSpecificData?.kind==="terminal"){s.terminalCommand=e.toolSpecificData.command}}if(dt(n.extension,"chatParticipantAdditions")&&e.modelId){s.model=await this.getModel(e.modelId,n.extension)}if(e.tokenBudget!==void 0){s.tokenizationOptions={tokenBudget:e.tokenBudget,countTokens:this._tokenCountFuncs.get(e.callId)||((a,l=bt.None)=>this._proxy.$countTokensForInvocation(e.callId,a,l))}}let r;if(dt(n.extension,"toolProgress")){r={report:a=>{this._proxy.$acceptToolProgress(e.callId,{message:Pe.fromStrict(a.message),increment:a.increment,total:100})}}}const o=await _I(Promise.resolve(n.tool.invoke(s,i,r)),i);if(!o){throw new Us}return Gg.from(o,n.extension)}async getModel(e,i){let n;if(e){n=await this._languageModels.getLanguageModelByIdentifier(i,e)}if(!n){n=await this._languageModels.getDefaultLanguageModel(i);if(!n){throw new Error("Language model unavailable")}}return n}async $prepareToolInvocation(e,i,n){const s=this._registeredTools.get(e);if(!s){throw new Error(`Unknown tool ${e}`)}const r={input:i};if(dt(s.extension,"chatParticipantPrivate")&&s.tool.prepareInvocation2){const o=await s.tool.prepareInvocation2(r,n);if(!o){return void 0}return{confirmationMessages:o.confirmationMessages?{title:o.confirmationMessages.title,message:typeof o.confirmationMessages.message==="string"?o.confirmationMessages.message:Pe.from(o.confirmationMessages.message)}:void 0,toolSpecificData:{kind:"terminal",language:o.language,command:o.command}}}else if(s.tool.prepareInvocation){const o=await s.tool.prepareInvocation(r,n);if(!o){return void 0}if(o.pastTenseMessage||o.presentation){$(s.extension,"chatParticipantPrivate")}return{confirmationMessages:o.confirmationMessages?{title:o.confirmationMessages.title,message:typeof o.confirmationMessages.message==="string"?o.confirmationMessages.message:Pe.from(o.confirmationMessages.message)}:void 0,invocationMessage:Pe.fromStrict(o.invocationMessage),pastTenseMessage:Pe.fromStrict(o.pastTenseMessage),presentation:o.presentation}}return void 0}registerTool(e,i,n){this._registeredTools.set(i,{extension:e,tool:n});this._proxy.$registerTool(i);return ge(()=>{this._registeredTools.delete(i);this._proxy.$unregisterTool(i)})}}class VO{constructor(e,i,n,s){this._documents=i;this._commands=n;this._uriTransformer=s;this._languageIds=[];this._handlePool=0;this._ids=new Set;this._proxy=e.getProxy(Y.MainThreadLanguages)}$acceptLanguageIds(e){this._languageIds=e}async getLanguages(){return this._languageIds.slice(0)}async changeLanguage(e,i){await this._proxy.$changeLanguage(e,i);const n=this._documents.getDocumentData(e);if(!n){throw new Error(`document '${e.toString()}' NOT found`)}return n.document}async tokenAtPosition(e,i){const n=e.version;const s=rt.from(i);const r=await this._proxy.$tokensAtPosition(e.uri,s);const o={type:so.Other,range:e.getWordRangeAtPosition(i)??new Oe(i.line,i.character,i.line,i.character)};if(!r){return o}const a={range:W.to(r.range),type:iw.to(r.type)};if(!a.range.contains(i)){return o}if(n!==e.version){return o}return a}createLanguageStatusItem(e,i,n){const s=this._handlePool++;const r=this._proxy;const o=this._ids;const a=`${e.identifier.value}/${i}`;if(o.has(a)){throw new Error(`LanguageStatusItem with id '${i}' ALREADY exists`)}o.add(a);const l={selector:n,id:i,name:e.displayName??e.name,severity:Il.Information,command:void 0,text:"",detail:"",busy:false};let c;const u=new Ie;const d=()=>{c?.dispose();if(!o.has(a)){console.warn(`LanguageStatusItem (${i}) from ${e.identifier.value} has been disposed and CANNOT be updated anymore`);return}c=LP(()=>{u.clear();this._proxy.$setLanguageStatus(s,{id:a,name:l.name??e.displayName??e.name,source:e.displayName??e.name,selector:uc.from(l.selector,this._uriTransformer),label:l.text,detail:l.detail??"",severity:l.severity===Il.Error?jt.Error:l.severity===Il.Warning?jt.Warning:jt.Info,command:l.command&&this._commands.toInternal(l.command,u),accessibilityInfo:l.accessibilityInformation,busy:l.busy})},0)};const p={dispose(){u.dispose();c?.dispose();r.$removeLanguageStatus(s);o.delete(a)},get id(){return l.id},get name(){return l.name},set name(f){l.name=f;d()},get selector(){return l.selector},set selector(f){l.selector=f;d()},get text(){return l.text},set text(f){l.text=f;d()},set text2(f){$(e,"languageStatusText");l.text=f;d()},get text2(){$(e,"languageStatusText");return l.text},get detail(){return l.detail},set detail(f){l.detail=f;d()},get severity(){return l.severity},set severity(f){l.severity=f;d()},get accessibilityInformation(){return l.accessibilityInformation},set accessibilityInformation(f){l.accessibilityInformation=f;d()},get command(){return l.command},set command(f){l.command=f;d()},get busy(){return l.busy},set busy(f){l.busy=f;d()}};d();return p}}function WO(t){return t&&t.title}let Jb=class X${constructor(e,i){this._logService=i;this._proxy=e.getProxy(Y.MainThreadMessageService)}showMessage(e,i,n,s,r){const o={source:{identifier:e.identifier,label:e.displayName||e.name}};let a;if(typeof s==="string"||WO(s)){a=[s,...r]}else{o.modal=s?.modal;o.useCustom=s?.useCustom;o.detail=s?.detail;a=r}if(o.useCustom){$(e,"resolvers")}const l=[];let c=false;for(let u=0;u<a.length;u++){const d=a[u];if(typeof d==="string"){l.push({title:d,handle:u,isCloseAffordance:false})}else if(typeof d==="object"){const{title:p,isCloseAffordance:f}=d;l.push({title:p,isCloseAffordance:!!f,handle:u});if(f){if(c){this._logService.warn(`[${e.identifier}] Only one message item can have 'isCloseAffordance':`,d)}else{c=true}}}else{this._logService.warn(`[${e.identifier}] Invalid message item:`,d)}}return this._proxy.$showMessage(i,n,o,l).then(u=>{if(typeof u==="number"){return a[u]}return void 0})}};Jb=z([O(1,at)],Jb);class z1{constructor(e,i,n,s){this.start=e;this.deletedCount=i;this.deletedItems=n;this.items=s}asApiEvent(){return{range:new gr(this.start,this.start+this.deletedCount),addedCells:this.items.map(e=>e.apiCell),removedCells:this.deletedItems}}}class Xb{static asModelAddData(e){return{EOL:e.eol,lines:e.source,languageId:e.language,uri:e.uri,isDirty:false,versionId:1,encoding:"utf8"}}constructor(e,i,n){this.notebook=e;this._extHostDocument=i;this._cellData=n;this.handle=n.handle;this.uri=b.revive(n.uri);this.cellKind=n.cellKind;this._outputs=n.outputs.map(_o.to);this._internalMetadata=n.internalMetadata??{};this._metadata=Object.freeze(n.metadata??{});this._previousResult=Object.freeze(mc.to(n.internalMetadata??{}))}get internalMetadata(){return this._internalMetadata}get apiCell(){if(!this._apiCell){const e=this;const i=this._extHostDocument.getDocument(this.uri);if(!i){throw new Error(`MISSING extHostDocument for notebook cell: ${this.uri}`)}const n={get index(){return e.notebook.getCellIndex(e)},notebook:e.notebook.apiNotebook,kind:Vd.to(this._cellData.cellKind),document:i.document,get mime(){return e._mime},set mime(s){e._mime=s},get outputs(){return e._outputs.slice(0)},get metadata(){return e._metadata},get executionSummary(){return e._previousResult}};this._apiCell=Object.freeze(n)}return this._apiCell}setOutputs(e){this._outputs=e.map(_o.to)}setOutputItems(e,i,n){const s=n.map(vc.to);const r=this._outputs.find(o=>o.id===e);if(r){if(!i){r.items.length=0}r.items.push(...s);if(r.items.length>1&&r.items.every(o=>_4(o.mime))){const o=new Map;const a=[];r.items.forEach(l=>{let c;if(o.has(l.mime)){c=o.get(l.mime)}else{c=[];o.set(l.mime,c);a.push(l.mime)}c.push(l.data)});r.items.length=0;a.forEach(l=>{const c=E9(o.get(l));r.items.push({mime:l,data:c.data.buffer})})}}}setMetadata(e){this._metadata=Object.freeze(e)}setInternalMetadata(e){this._internalMetadata=e;this._previousResult=Object.freeze(mc.to(e))}setMime(e){}}class Ly{static{this._handlePool=0}constructor(e,i,n,s,r){this._proxy=e;this._textDocumentsAndEditors=i;this._textDocuments=n;this.uri=s;this.handle=Ly._handlePool++;this._cells=[];this._versionId=0;this._isDirty=false;this._disposed=false;this._notebookType=r.viewType;this._metadata=Object.freeze(r.metadata??Object.create(null));this._spliceNotebookCells([[0,0,r.cells]],true,void 0);this._versionId=r.versionId}dispose(){this._disposed=true}get versionId(){return this._versionId}get apiNotebook(){if(!this._notebook){const e=this;const i={get uri(){return e.uri},get version(){return e._versionId},get notebookType(){return e._notebookType},get isDirty(){return e._isDirty},get isUntitled(){return e.uri.scheme===ae.untitled},get isClosed(){return e._disposed},get metadata(){return e._metadata},get cellCount(){return e._cells.length},cellAt(n){n=e._validateIndex(n);return e._cells[n].apiCell},getCells(n){const s=n?e._getCells(n):e._cells;return s.map(r=>r.apiCell)},save(){return e._save()},[Symbol.for("debug.description")](){return`NotebookDocument(${this.uri.toString()})`}};this._notebook=Object.freeze(i)}return this._notebook}acceptDocumentPropertiesChanged(e){if(e.metadata){this._metadata=Object.freeze({...this._metadata,...e.metadata})}}acceptDirty(e){this._isDirty=e}acceptModelChanged(e,i,n){this._versionId=e.versionId;this._isDirty=i;this.acceptDocumentPropertiesChanged({metadata:n});const s={notebook:this.apiNotebook,metadata:n,cellChanges:[],contentChanges:[]};const r=[];for(const a of e.rawEvents){if(a.kind===qn.ModelChange){this._spliceNotebookCells(a.changes,false,s.contentChanges)}else if(a.kind===qn.Move){this._moveCells(a.index,a.length,a.newIdx,s.contentChanges)}else if(a.kind===qn.Output){this._setCellOutputs(a.index,a.outputs);r.push({cell:this._cells[a.index].apiCell,outputs:this._cells[a.index].apiCell.outputs})}else if(a.kind===qn.OutputItem){this._setCellOutputItems(a.index,a.outputId,a.append,a.outputItems);r.push({cell:this._cells[a.index].apiCell,outputs:this._cells[a.index].apiCell.outputs})}else if(a.kind===qn.ChangeCellLanguage){this._changeCellLanguage(a.index,a.language);r.push({cell:this._cells[a.index].apiCell,document:this._cells[a.index].apiCell.document})}else if(a.kind===qn.ChangeCellContent){r.push({cell:this._cells[a.index].apiCell,document:this._cells[a.index].apiCell.document})}else if(a.kind===qn.ChangeCellMime){this._changeCellMime(a.index,a.mime)}else if(a.kind===qn.ChangeCellMetadata){this._changeCellMetadata(a.index,a.metadata);r.push({cell:this._cells[a.index].apiCell,metadata:this._cells[a.index].apiCell.metadata})}else if(a.kind===qn.ChangeCellInternalMetadata){this._changeCellInternalMetadata(a.index,a.internalMetadata);r.push({cell:this._cells[a.index].apiCell,executionSummary:this._cells[a.index].apiCell.executionSummary})}}const o=new Map;for(let a=0;a<r.length;a++){const l=r[a];const c=o.get(l.cell);if(c===void 0){const u=s.cellChanges.push({document:void 0,executionSummary:void 0,metadata:void 0,outputs:void 0,...l});o.set(l.cell,u-1)}else{s.cellChanges[c]={...s.cellChanges[c],...l}}}return s}_validateIndex(e){e=e|0;if(e<0){return 0}else if(e>=this._cells.length){return this._cells.length-1}else{return e}}_validateRange(e){let i=e.start|0;let n=e.end|0;if(i<0){i=0}if(n>this._cells.length){n=this._cells.length}return e.with({start:i,end:n})}_getCells(e){e=this._validateRange(e);const i=[];for(let n=e.start;n<e.end;n++){i.push(this._cells[n])}return i}async _save(){if(this._disposed){return Promise.reject(new Error("Notebook has been closed"))}return this._proxy.$trySaveNotebook(this.uri)}_spliceNotebookCells(e,i,n){if(this._disposed){return}const s=[];const r=[];const o=[];e.reverse().forEach(a=>{const l=a[2];const c=l.map(p=>{const f=new Xb(this,this._textDocumentsAndEditors,p);if(!i){r.push(Xb.asModelAddData(p))}return f});const u=new z1(a[0],a[1],[],c);const d=this._cells.splice(a[0],a[1],...c);for(const p of d){o.push(p.uri);u.deletedItems.push(p.apiCell)}s.push(u)});this._textDocumentsAndEditors.acceptDocumentsAndEditorsDelta({addedDocuments:r,removedDocuments:o});if(n){for(const a of s){n.push(a.asApiEvent())}}}_moveCells(e,i,n,s){const r=this._cells.splice(e,i);this._cells.splice(n,0,...r);const o=[new z1(e,i,r.map(a=>a.apiCell),[]),new z1(n,0,[],r)];for(const a of o){s.push(a.asApiEvent())}}_setCellOutputs(e,i){const n=this._cells[e];n.setOutputs(i)}_setCellOutputItems(e,i,n,s){const r=this._cells[e];r.setOutputItems(i,n,s)}_changeCellLanguage(e,i){const n=this._cells[e];if(n.apiCell.document.languageId!==i){this._textDocuments.$acceptModelLanguageChanged(n.uri,i)}}_changeCellMime(e,i){const n=this._cells[e];n.apiCell.mime=i}_changeCellMetadata(e,i){const n=this._cells[e];n.setMetadata(i)}_changeCellInternalMetadata(e,i){const n=this._cells[e];n.setInternalMetadata(i)}getCellFromApiCell(e){return this._cells.find(i=>i.apiCell===e)}getCellFromIndex(e){return this._cells[e]}getCell(e){return this._cells.find(i=>i.handle===e)}getCellIndex(e){return this._cells.indexOf(e)}}class sh{static{this.apiEditorsToExtHost=new WeakMap}constructor(e,i,n,s,r,o,a){this.id=e;this._proxy=i;this.notebookData=n;this._visibleRanges=s;this._selections=r;this._viewColumn=o;this.viewType=a;this._visible=false}get apiEditor(){if(!this._editor){const e=this;this._editor={get notebook(){return e.notebookData.apiNotebook},get selection(){return e._selections[0]},set selection(i){this.selections=[i]},get selections(){return e._selections},set selections(i){if(!Array.isArray(i)||!i.every(gr.isNotebookRange)){throw $e("selections")}e._selections=i;e._trySetSelections(i)},get visibleRanges(){return e._visibleRanges},revealRange(i,n){e._proxy.$tryRevealRange(e.id,Ls.from(i),n??rg.Default)},get viewColumn(){return e._viewColumn},get replOptions(){if(e.viewType==="repl"){return{appendIndex:this.notebook.cellCount-1}}return void 0},[Symbol.for("debug.description")](){return`NotebookEditor(${this.notebook.uri.toString()})`}};sh.apiEditorsToExtHost.set(this._editor,this)}return this._editor}get visible(){return this._visible}_acceptVisibility(e){this._visible=e}_acceptVisibleRanges(e){this._visibleRanges=e}_acceptSelections(e){this._selections=e}_trySetSelections(e){this._proxy.$trySetSelections(this.id,e.map(Ls.from))}_acceptViewColumn(e){this._viewColumn=e}}class Yb{constructor(e,i){this.piece=e;this.color=i;this.size_left=0;this.lf_left=0;this.parent=this;this.left=this;this.right=this}next(){if(this.right!==pe){return Ny(this.right)}let e=this;while(e.parent!==pe){if(e.parent.left===e){break}e=e.parent}if(e.parent===pe){return pe}else{return e.parent}}prev(){if(this.left!==pe){return c5(this.left)}let e=this;while(e.parent!==pe){if(e.parent.right===e){break}e=e.parent}if(e.parent===pe){return pe}else{return e.parent}}detach(){this.parent=null;this.left=null;this.right=null}}var Me;(function(t){t[t["Black"]=0]="Black";t[t["Red"]=1]="Red"})(Me||(Me={}));const pe=new Yb(null,Me.Black);pe.parent=pe;pe.left=pe;pe.right=pe;pe.color=Me.Black;function Ny(t){while(t.left!==pe){t=t.left}return t}function c5(t){while(t.right!==pe){t=t.right}return t}function Oy(t){if(t===pe){return 0}return t.size_left+t.piece.length+Oy(t.right)}function Fy(t){if(t===pe){return 0}return t.lf_left+t.piece.lineFeedCnt+Fy(t.right)}function q1(){pe.parent=pe}function $u(t,e){const i=e.right;i.size_left+=e.size_left+(e.piece?e.piece.length:0);i.lf_left+=e.lf_left+(e.piece?e.piece.lineFeedCnt:0);e.right=i.left;if(i.left!==pe){i.left.parent=e}i.parent=e.parent;if(e.parent===pe){t.root=i}else if(e.parent.left===e){e.parent.left=i}else{e.parent.right=i}i.left=e;e.parent=i}function Hu(t,e){const i=e.left;e.left=i.right;if(i.right!==pe){i.right.parent=e}i.parent=e.parent;e.size_left-=i.size_left+(i.piece?i.piece.length:0);e.lf_left-=i.lf_left+(i.piece?i.piece.lineFeedCnt:0);if(e.parent===pe){t.root=i}else if(e===e.parent.right){e.parent.right=i}else{e.parent.left=i}i.right=e;e.parent=i}function Vh(t,e){let i;let n;if(e.left===pe){n=e;i=n.right}else if(e.right===pe){n=e;i=n.left}else{n=Ny(e.right);i=n.right}if(n===t.root){t.root=i;i.color=Me.Black;e.detach();q1();t.root.parent=pe;return}const s=n.color===Me.Red;if(n===n.parent.left){n.parent.left=i}else{n.parent.right=i}if(n===e){i.parent=n.parent;du(t,i)}else{if(n.parent===e){i.parent=n}else{i.parent=n.parent}du(t,i);n.left=e.left;n.right=e.right;n.parent=e.parent;n.color=e.color;if(e===t.root){t.root=n}else{if(e===e.parent.left){e.parent.left=n}else{e.parent.right=n}}if(n.left!==pe){n.left.parent=n}if(n.right!==pe){n.right.parent=n}n.size_left=e.size_left;n.lf_left=e.lf_left;du(t,n)}e.detach();if(i.parent.left===i){const o=Oy(i);const a=Fy(i);if(o!==i.parent.size_left||a!==i.parent.lf_left){const l=o-i.parent.size_left;const c=a-i.parent.lf_left;i.parent.size_left=o;i.parent.lf_left=a;Ys(t,i.parent,l,c)}}du(t,i.parent);if(s){q1();return}let r;while(i!==t.root&&i.color===Me.Black){if(i===i.parent.left){r=i.parent.right;if(r.color===Me.Red){r.color=Me.Black;i.parent.color=Me.Red;$u(t,i.parent);r=i.parent.right}if(r.left.color===Me.Black&&r.right.color===Me.Black){r.color=Me.Red;i=i.parent}else{if(r.right.color===Me.Black){r.left.color=Me.Black;r.color=Me.Red;Hu(t,r);r=i.parent.right}r.color=i.parent.color;i.parent.color=Me.Black;r.right.color=Me.Black;$u(t,i.parent);i=t.root}}else{r=i.parent.left;if(r.color===Me.Red){r.color=Me.Black;i.parent.color=Me.Red;Hu(t,i.parent);r=i.parent.left}if(r.left.color===Me.Black&&r.right.color===Me.Black){r.color=Me.Red;i=i.parent}else{if(r.left.color===Me.Black){r.right.color=Me.Black;r.color=Me.Red;$u(t,r);r=i.parent.left}r.color=i.parent.color;i.parent.color=Me.Black;r.left.color=Me.Black;Hu(t,i.parent);i=t.root}}}i.color=Me.Black;q1()}function uk(t,e){du(t,e);while(e!==t.root&&e.parent.color===Me.Red){if(e.parent===e.parent.parent.left){const i=e.parent.parent.right;if(i.color===Me.Red){e.parent.color=Me.Black;i.color=Me.Black;e.parent.parent.color=Me.Red;e=e.parent.parent}else{if(e===e.parent.right){e=e.parent;$u(t,e)}e.parent.color=Me.Black;e.parent.parent.color=Me.Red;Hu(t,e.parent.parent)}}else{const i=e.parent.parent.left;if(i.color===Me.Red){e.parent.color=Me.Black;i.color=Me.Black;e.parent.parent.color=Me.Red;e=e.parent.parent}else{if(e===e.parent.left){e=e.parent;Hu(t,e)}e.parent.color=Me.Black;e.parent.parent.color=Me.Red;$u(t,e.parent.parent)}}}t.root.color=Me.Black}function Ys(t,e,i,n){while(e!==t.root&&e!==pe){if(e.parent.left===e){e.parent.size_left+=i;e.parent.lf_left+=n}e=e.parent}}function du(t,e){let i=0;let n=0;if(e===t.root){return}while(e!==t.root&&e===e.parent.right){e=e.parent}if(e===t.root){return}e=e.parent;i=Oy(e.left)-e.size_left;n=Fy(e.left)-e.lf_left;e.size_left+=i;e.lf_left+=n;while(e!==t.root&&(i!==0||n!==0)){if(e.parent.left===e){e.parent.size_left+=i;e.parent.lf_left+=n}e=e.parent}}const Gs=65535;function u5(t){let e;if(t[t.length-1]<65536){e=new Uint16Array(t.length)}else{e=new Uint32Array(t.length)}e.set(t,0);return e}class zO{constructor(e,i,n,s,r){this.lineStarts=e;this.cr=i;this.lf=n;this.crlf=s;this.isBasicASCII=r}}function nr(t,e=true){const i=[0];let n=1;for(let s=0,r=t.length;s<r;s++){const o=t.charCodeAt(s);if(o===A.CarriageReturn){if(s+1<r&&t.charCodeAt(s+1)===A.LineFeed){i[n++]=s+2;s++}else{i[n++]=s+1}}else if(o===A.LineFeed){i[n++]=s+1}}if(e){return u5(i)}else{return i}}function qO(t,e){t.length=0;t[0]=0;let i=1;let n=0,s=0,r=0;let o=true;for(let l=0,c=e.length;l<c;l++){const u=e.charCodeAt(l);if(u===A.CarriageReturn){if(l+1<c&&e.charCodeAt(l+1)===A.LineFeed){r++;t[i++]=l+2;l++}else{n++;t[i++]=l+1}}else if(u===A.LineFeed){s++;t[i++]=l+1}else{if(o){if(u!==A.Tab&&(u<32||u>126)){o=false}}}}const a=new zO(u5(t),n,s,r,o);t.length=0;return a}class qi{constructor(e,i,n,s,r){this.bufferIndex=e;this.start=i;this.end=n;this.lineFeedCnt=s;this.length=r}}class Bo{constructor(e,i){this.buffer=e;this.lineStarts=i}}class jO{constructor(e,i){this._pieces=[];this._tree=e;this._BOM=i;this._index=0;if(e.root!==pe){e.iterate(e.root,n=>{if(n!==pe){this._pieces.push(n.piece)}return true})}}read(){if(this._pieces.length===0){if(this._index===0){this._index++;return this._BOM}else{return null}}if(this._index>this._pieces.length-1){return null}if(this._index===0){return this._BOM+this._tree.getPieceContent(this._pieces[this._index++])}return this._tree.getPieceContent(this._pieces[this._index++])}}class GO{constructor(e){this._limit=e;this._cache=[]}get(e){for(let i=this._cache.length-1;i>=0;i--){const n=this._cache[i];if(n.nodeStartOffset<=e&&n.nodeStartOffset+n.node.piece.length>=e){return n}}return null}get2(e){for(let i=this._cache.length-1;i>=0;i--){const n=this._cache[i];if(n.nodeStartLineNumber&&n.nodeStartLineNumber<e&&n.nodeStartLineNumber+n.node.piece.lineFeedCnt>=e){return n}}return null}set(e){if(this._cache.length>=this._limit){this._cache.shift()}this._cache.push(e)}validate(e){let i=false;const n=this._cache;for(let s=0;s<n.length;s++){const r=n[s];if(r.node.parent===null||r.nodeStartOffset>=e){n[s]=null;i=true;continue}}if(i){const s=[];for(const r of n){if(r!==null){s.push(r)}}this._cache=s}}}class KO{constructor(e,i,n){this.create(e,i,n)}create(e,i,n){this._buffers=[new Bo("",[0])];this._lastChangeBufferPos={line:0,column:0};this.root=pe;this._lineCnt=1;this._length=0;this._EOL=i;this._EOLLength=i.length;this._EOLNormalized=n;let s=null;for(let r=0,o=e.length;r<o;r++){if(e[r].buffer.length>0){if(!e[r].lineStarts){e[r].lineStarts=nr(e[r].buffer)}const a=new qi(r+1,{line:0,column:0},{line:e[r].lineStarts.length-1,column:e[r].buffer.length-e[r].lineStarts[e[r].lineStarts.length-1]},e[r].lineStarts.length-1,e[r].buffer.length);this._buffers.push(e[r]);s=this.rbInsertRight(s,a)}}this._searchCache=new GO(1);this._lastVisitedLine={lineNumber:0,value:""};this.computeBufferMetadata()}normalizeEOL(e){const i=Gs;const n=i-Math.floor(i/3);const s=n*2;let r="";let o=0;const a=[];this.iterate(this.root,l=>{const c=this.getNodeContent(l);const u=c.length;if(o<=n||o+u<s){r+=c;o+=u;return true}const d=r.replace(/\r\n|\r|\n/g,e);a.push(new Bo(d,nr(d)));r=c;o=u;return true});if(o>0){const l=r.replace(/\r\n|\r|\n/g,e);a.push(new Bo(l,nr(l)))}this.create(a,e,true)}getEOL(){return this._EOL}setEOL(e){this._EOL=e;this._EOLLength=this._EOL.length;this.normalizeEOL(e)}createSnapshot(e){return new jO(this,e)}equal(e){if(this.getLength()!==e.getLength()){return false}if(this.getLineCount()!==e.getLineCount()){return false}let i=0;const n=this.iterate(this.root,s=>{if(s===pe){return true}const r=this.getNodeContent(s);const o=r.length;const a=e.nodeAt(i);const l=e.nodeAt(i+o);const c=e.getValueInRange2(a,l);i+=o;return r===c});return n}getOffsetAt(e,i){let n=0;let s=this.root;while(s!==pe){if(s.left!==pe&&s.lf_left+1>=e){s=s.left}else if(s.lf_left+s.piece.lineFeedCnt+1>=e){n+=s.size_left;const r=this.getAccumulatedValue(s,e-s.lf_left-2);return n+=r+i-1}else{e-=s.lf_left+s.piece.lineFeedCnt;n+=s.size_left+s.piece.length;s=s.right}}return n}getPositionAt(e){e=Math.floor(e);e=Math.max(0,e);let i=this.root;let n=0;const s=e;while(i!==pe){if(i.size_left!==0&&i.size_left>=e){i=i.left}else if(i.size_left+i.piece.length>=e){const r=this.getIndexOf(i,e-i.size_left);n+=i.lf_left+r.index;if(r.index===0){const o=this.getOffsetAt(n+1,1);const a=s-o;return new En(n+1,a+1)}return new En(n+1,r.remainder+1)}else{e-=i.size_left+i.piece.length;n+=i.lf_left+i.piece.lineFeedCnt;if(i.right===pe){const r=this.getOffsetAt(n+1,1);const o=s-e-r;return new En(n+1,o+1)}else{i=i.right}}}return new En(1,1)}getValueInRange(e,i){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn){return""}const n=this.nodeAt2(e.startLineNumber,e.startColumn);const s=this.nodeAt2(e.endLineNumber,e.endColumn);const r=this.getValueInRange2(n,s);if(i){if(i!==this._EOL||!this._EOLNormalized){return r.replace(/\r\n|\r|\n/g,i)}if(i===this.getEOL()&&this._EOLNormalized){return r}return r.replace(/\r\n|\r|\n/g,i)}return r}getValueInRange2(e,i){if(e.node===i.node){const a=e.node;const l=this._buffers[a.piece.bufferIndex].buffer;const c=this.offsetInBuffer(a.piece.bufferIndex,a.piece.start);return l.substring(c+e.remainder,c+i.remainder)}let n=e.node;const s=this._buffers[n.piece.bufferIndex].buffer;const r=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);let o=s.substring(r+e.remainder,r+n.piece.length);n=n.next();while(n!==pe){const a=this._buffers[n.piece.bufferIndex].buffer;const l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);if(n===i.node){o+=a.substring(l,l+i.remainder);break}else{o+=a.substr(l,n.piece.length)}n=n.next()}return o}getLinesContent(){const e=[];let i=0;let n="";let s=false;this.iterate(this.root,r=>{if(r===pe){return true}const o=r.piece;let a=o.length;if(a===0){return true}const l=this._buffers[o.bufferIndex].buffer;const c=this._buffers[o.bufferIndex].lineStarts;const u=o.start.line;const d=o.end.line;let p=c[u]+o.start.column;if(s){if(l.charCodeAt(p)===A.LineFeed){p++;a--}e[i++]=n;n="";s=false;if(a===0){return true}}if(u===d){if(!this._EOLNormalized&&l.charCodeAt(p+a-1)===A.CarriageReturn){s=true;n+=l.substr(p,a-1)}else{n+=l.substr(p,a)}return true}n+=this._EOLNormalized?l.substring(p,Math.max(p,c[u+1]-this._EOLLength)):l.substring(p,c[u+1]).replace(/(\r\n|\r|\n)$/,"");e[i++]=n;for(let f=u+1;f<d;f++){n=this._EOLNormalized?l.substring(c[f],c[f+1]-this._EOLLength):l.substring(c[f],c[f+1]).replace(/(\r\n|\r|\n)$/,"");e[i++]=n}if(!this._EOLNormalized&&l.charCodeAt(c[d]+o.end.column-1)===A.CarriageReturn){s=true;if(o.end.column===0){i--}else{n=l.substr(c[d],o.end.column-1)}}else{n=l.substr(c[d],o.end.column)}return true});if(s){e[i++]=n;n=""}e[i++]=n;return e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){if(this._lastVisitedLine.lineNumber===e){return this._lastVisitedLine.value}this._lastVisitedLine.lineNumber=e;if(e===this._lineCnt){this._lastVisitedLine.value=this.getLineRawContent(e)}else if(this._EOLNormalized){this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength)}else{this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,"")}return this._lastVisitedLine.value}_getCharCode(e){if(e.remainder===e.node.piece.length){const i=e.node.next();if(!i){return 0}const n=this._buffers[i.piece.bufferIndex];const s=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return n.buffer.charCodeAt(s)}else{const i=this._buffers[e.node.piece.bufferIndex];const n=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start);const s=n+e.remainder;return i.buffer.charCodeAt(s)}}getLineCharCode(e,i){const n=this.nodeAt2(e,i+1);return this._getCharCode(n)}getLineLength(e){if(e===this.getLineCount()){const i=this.getOffsetAt(e,1);return this.getLength()-i}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}getCharCode(e){const i=this.nodeAt(e);return this._getCharCode(i)}getNearestChunk(e){const i=this.nodeAt(e);if(i.remainder===i.node.piece.length){const n=i.node.next();if(!n||n===pe){return""}const s=this._buffers[n.piece.bufferIndex];const r=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);return s.buffer.substring(r,r+n.piece.length)}else{const n=this._buffers[i.node.piece.bufferIndex];const s=this.offsetInBuffer(i.node.piece.bufferIndex,i.node.piece.start);const r=s+i.remainder;const o=s+i.node.piece.length;return n.buffer.substring(r,o)}}findMatchesInNode(e,i,n,s,r,o,a,l,c,u,d){const p=this._buffers[e.piece.bufferIndex];const f=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start);const m=this.offsetInBuffer(e.piece.bufferIndex,r);const v=this.offsetInBuffer(e.piece.bufferIndex,o);let y;const D={line:0,column:0};let I;let R;if(i._wordSeparators){I=p.buffer.substring(m,v);R=J=>J+m;i.reset(0)}else{I=p.buffer;R=J=>J;i.reset(m)}do{y=i.next(I);if(y){if(R(y.index)>=v){return u}this.positionInBuffer(e,R(y.index)-f,D);const J=this.getLineFeedCnt(e.piece.bufferIndex,r,D);const H=D.line===r.line?D.column-r.column+s:D.column+1;const Q=H+y[0].length;d[u++]=sD(new et(n+J,H,n+J,Q),y,l);if(R(y.index)+y[0].length>=v){return u}if(u>=c){return u}}}while(y);return u}findMatchesLineByLine(e,i,n,s){const r=[];let o=0;const a=new K6(i.wordSeparators,i.regex);let l=this.nodeAt2(e.startLineNumber,e.startColumn);if(l===null){return[]}const c=this.nodeAt2(e.endLineNumber,e.endColumn);if(c===null){return[]}let u=this.positionInBuffer(l.node,l.remainder);const d=this.positionInBuffer(c.node,c.remainder);if(l.node===c.node){this.findMatchesInNode(l.node,a,e.startLineNumber,e.startColumn,u,d,i,n,s,o,r);return r}let p=e.startLineNumber;let f=l.node;while(f!==c.node){const v=this.getLineFeedCnt(f.piece.bufferIndex,u,f.piece.end);if(v>=1){const D=this._buffers[f.piece.bufferIndex].lineStarts;const I=this.offsetInBuffer(f.piece.bufferIndex,f.piece.start);const R=D[u.line+v];const J=p===e.startLineNumber?e.startColumn:1;o=this.findMatchesInNode(f,a,p,J,u,this.positionInBuffer(f,R-I),i,n,s,o,r);if(o>=s){return r}p+=v}const y=p===e.startLineNumber?e.startColumn-1:0;if(p===e.endLineNumber){const D=this.getLineContent(p).substring(y,e.endColumn-1);o=this._findMatchesInLine(i,a,D,e.endLineNumber,y,o,r,n,s);return r}o=this._findMatchesInLine(i,a,this.getLineContent(p).substr(y),p,y,o,r,n,s);if(o>=s){return r}p++;l=this.nodeAt2(p,1);f=l.node;u=this.positionInBuffer(l.node,l.remainder)}if(p===e.endLineNumber){const v=p===e.startLineNumber?e.startColumn-1:0;const y=this.getLineContent(p).substring(v,e.endColumn-1);o=this._findMatchesInLine(i,a,y,e.endLineNumber,v,o,r,n,s);return r}const m=p===e.startLineNumber?e.startColumn:1;o=this.findMatchesInNode(c.node,a,p,m,u,d,i,n,s,o,r);return r}_findMatchesInLine(e,i,n,s,r,o,a,l,c){const u=e.wordSeparators;if(!l&&e.simpleSearch){const p=e.simpleSearch;const f=p.length;const m=n.length;let v=-f;while((v=n.indexOf(p,v+f))!==-1){if(!u||PC(u,n,m,v,f)){a[o++]=new k_(new et(s,v+1+r,s,v+1+f+r),null);if(o>=c){return o}}}return o}let d;i.reset(0);do{d=i.next(n);if(d){a[o++]=sD(new et(s,d.index+1+r,s,d.index+1+d[0].length+r),d,l);if(o>=c){return o}}}while(d);return o}insert(e,i,n=false){this._EOLNormalized=this._EOLNormalized&&n;this._lastVisitedLine.lineNumber=0;this._lastVisitedLine.value="";if(this.root!==pe){const{node:s,remainder:r,nodeStartOffset:o}=this.nodeAt(e);const a=s.piece;const l=a.bufferIndex;const c=this.positionInBuffer(s,r);if(s.piece.bufferIndex===0&&a.end.line===this._lastChangeBufferPos.line&&a.end.column===this._lastChangeBufferPos.column&&o+a.length===e&&i.length<Gs){this.appendToNode(s,i);this.computeBufferMetadata();return}if(o===e){this.insertContentToNodeLeft(i,s);this._searchCache.validate(e)}else if(o+s.piece.length>e){const u=[];let d=new qi(a.bufferIndex,c,a.end,this.getLineFeedCnt(a.bufferIndex,c,a.end),this.offsetInBuffer(l,a.end)-this.offsetInBuffer(l,c));if(this.shouldCheckCRLF()&&this.endWithCR(i)){const m=this.nodeCharCodeAt(s,r);if(m===10){const v={line:d.start.line+1,column:0};d=new qi(d.bufferIndex,v,d.end,this.getLineFeedCnt(d.bufferIndex,v,d.end),d.length-1);i+="\n"}}if(this.shouldCheckCRLF()&&this.startWithLF(i)){const m=this.nodeCharCodeAt(s,r-1);if(m===13){const v=this.positionInBuffer(s,r-1);this.deleteNodeTail(s,v);i="\r"+i;if(s.piece.length===0){u.push(s)}}else{this.deleteNodeTail(s,c)}}else{this.deleteNodeTail(s,c)}const p=this.createNewPieces(i);if(d.length>0){this.rbInsertRight(s,d)}let f=s;for(let m=0;m<p.length;m++){f=this.rbInsertRight(f,p[m])}this.deleteNodes(u)}else{this.insertContentToNodeRight(i,s)}}else{const s=this.createNewPieces(i);let r=this.rbInsertLeft(null,s[0]);for(let o=1;o<s.length;o++){r=this.rbInsertRight(r,s[o])}}this.computeBufferMetadata()}delete(e,i){this._lastVisitedLine.lineNumber=0;this._lastVisitedLine.value="";if(i<=0||this.root===pe){return}const n=this.nodeAt(e);const s=this.nodeAt(e+i);const r=n.node;const o=s.node;if(r===o){const p=this.positionInBuffer(r,n.remainder);const f=this.positionInBuffer(r,s.remainder);if(n.nodeStartOffset===e){if(i===r.piece.length){const m=r.next();Vh(this,r);this.validateCRLFWithPrevNode(m);this.computeBufferMetadata();return}this.deleteNodeHead(r,f);this._searchCache.validate(e);this.validateCRLFWithPrevNode(r);this.computeBufferMetadata();return}if(n.nodeStartOffset+r.piece.length===e+i){this.deleteNodeTail(r,p);this.validateCRLFWithNextNode(r);this.computeBufferMetadata();return}this.shrinkNode(r,p,f);this.computeBufferMetadata();return}const a=[];const l=this.positionInBuffer(r,n.remainder);this.deleteNodeTail(r,l);this._searchCache.validate(e);if(r.piece.length===0){a.push(r)}const c=this.positionInBuffer(o,s.remainder);this.deleteNodeHead(o,c);if(o.piece.length===0){a.push(o)}const u=r.next();for(let p=u;p!==pe&&p!==o;p=p.next()){a.push(p)}const d=r.piece.length===0?r.prev():r;this.deleteNodes(a);this.validateCRLFWithNextNode(d);this.computeBufferMetadata()}insertContentToNodeLeft(e,i){const n=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(i)){const o=i.piece;const a={line:o.start.line+1,column:0};const l=new qi(o.bufferIndex,a,o.end,this.getLineFeedCnt(o.bufferIndex,a,o.end),o.length-1);i.piece=l;e+="\n";Ys(this,i,-1,-1);if(i.piece.length===0){n.push(i)}}const s=this.createNewPieces(e);let r=this.rbInsertLeft(i,s[s.length-1]);for(let o=s.length-2;o>=0;o--){r=this.rbInsertLeft(r,s[o])}this.validateCRLFWithPrevNode(r);this.deleteNodes(n)}insertContentToNodeRight(e,i){if(this.adjustCarriageReturnFromNext(e,i)){e+="\n"}const n=this.createNewPieces(e);const s=this.rbInsertRight(i,n[0]);let r=s;for(let o=1;o<n.length;o++){r=this.rbInsertRight(r,n[o])}this.validateCRLFWithPrevNode(s)}positionInBuffer(e,i,n){const s=e.piece;const r=e.piece.bufferIndex;const o=this._buffers[r].lineStarts;const a=o[s.start.line]+s.start.column;const l=a+i;let c=s.start.line;let u=s.end.line;let d=0;let p=0;let f=0;while(c<=u){d=c+(u-c)/2|0;f=o[d];if(d===u){break}p=o[d+1];if(l<f){u=d-1}else if(l>=p){c=d+1}else{break}}if(n){n.line=d;n.column=l-f;return null}return{line:d,column:l-f}}getLineFeedCnt(e,i,n){if(n.column===0){return n.line-i.line}const s=this._buffers[e].lineStarts;if(n.line===s.length-1){return n.line-i.line}const r=s[n.line+1];const o=s[n.line]+n.column;if(r>o+1){return n.line-i.line}const a=o-1;const l=this._buffers[e].buffer;if(l.charCodeAt(a)===13){return n.line-i.line+1}else{return n.line-i.line}}offsetInBuffer(e,i){const n=this._buffers[e].lineStarts;return n[i.line]+i.column}deleteNodes(e){for(let i=0;i<e.length;i++){Vh(this,e[i])}}createNewPieces(e){if(e.length>Gs){const u=[];while(e.length>Gs){const p=e.charCodeAt(Gs-1);let f;if(p===A.CarriageReturn||p>=55296&&p<=56319){f=e.substring(0,Gs-1);e=e.substring(Gs-1)}else{f=e.substring(0,Gs);e=e.substring(Gs)}const m=nr(f);u.push(new qi(this._buffers.length,{line:0,column:0},{line:m.length-1,column:f.length-m[m.length-1]},m.length-1,f.length));this._buffers.push(new Bo(f,m))}const d=nr(e);u.push(new qi(this._buffers.length,{line:0,column:0},{line:d.length-1,column:e.length-d[d.length-1]},d.length-1,e.length));this._buffers.push(new Bo(e,d));return u}let i=this._buffers[0].buffer.length;const n=nr(e,false);let s=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===i&&i!==0&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1};s=this._lastChangeBufferPos;for(let u=0;u<n.length;u++){n[u]+=i+1}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1));this._buffers[0].buffer+="_"+e;i+=1}else{if(i!==0){for(let u=0;u<n.length;u++){n[u]+=i}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(n.slice(1));this._buffers[0].buffer+=e}const r=this._buffers[0].buffer.length;const o=this._buffers[0].lineStarts.length-1;const a=r-this._buffers[0].lineStarts[o];const l={line:o,column:a};const c=new qi(0,s,l,this.getLineFeedCnt(0,s,l),r-i);this._lastChangeBufferPos=l;return[c]}getLinesRawContent(){return this.getContentOfSubTree(this.root)}getLineRawContent(e,i=0){let n=this.root;let s="";const r=this._searchCache.get2(e);if(r){n=r.node;const o=this.getAccumulatedValue(n,e-r.nodeStartLineNumber-1);const a=this._buffers[n.piece.bufferIndex].buffer;const l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);if(r.nodeStartLineNumber+n.piece.lineFeedCnt===e){s=a.substring(l+o,l+n.piece.length)}else{const c=this.getAccumulatedValue(n,e-r.nodeStartLineNumber);return a.substring(l+o,l+c-i)}}else{let o=0;const a=e;while(n!==pe){if(n.left!==pe&&n.lf_left>=e-1){n=n.left}else if(n.lf_left+n.piece.lineFeedCnt>e-1){const l=this.getAccumulatedValue(n,e-n.lf_left-2);const c=this.getAccumulatedValue(n,e-n.lf_left-1);const u=this._buffers[n.piece.bufferIndex].buffer;const d=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);o+=n.size_left;this._searchCache.set({node:n,nodeStartOffset:o,nodeStartLineNumber:a-(e-1-n.lf_left)});return u.substring(d+l,d+c-i)}else if(n.lf_left+n.piece.lineFeedCnt===e-1){const l=this.getAccumulatedValue(n,e-n.lf_left-2);const c=this._buffers[n.piece.bufferIndex].buffer;const u=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);s=c.substring(u+l,u+n.piece.length);break}else{e-=n.lf_left+n.piece.lineFeedCnt;o+=n.size_left+n.piece.length;n=n.right}}}n=n.next();while(n!==pe){const o=this._buffers[n.piece.bufferIndex].buffer;if(n.piece.lineFeedCnt>0){const a=this.getAccumulatedValue(n,0);const l=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);s+=o.substring(l,l+a-i);return s}else{const a=this.offsetInBuffer(n.piece.bufferIndex,n.piece.start);s+=o.substr(a,n.piece.length)}n=n.next()}return s}computeBufferMetadata(){let e=this.root;let i=1;let n=0;while(e!==pe){i+=e.lf_left+e.piece.lineFeedCnt;n+=e.size_left+e.piece.length;e=e.right}this._lineCnt=i;this._length=n;this._searchCache.validate(this._length)}getIndexOf(e,i){const n=e.piece;const s=this.positionInBuffer(e,i);const r=s.line-n.start.line;if(this.offsetInBuffer(n.bufferIndex,n.end)-this.offsetInBuffer(n.bufferIndex,n.start)===i){const o=this.getLineFeedCnt(e.piece.bufferIndex,n.start,s);if(o!==r){return{index:o,remainder:0}}}return{index:r,remainder:s.column}}getAccumulatedValue(e,i){if(i<0){return 0}const n=e.piece;const s=this._buffers[n.bufferIndex].lineStarts;const r=n.start.line+i+1;if(r>n.end.line){return s[n.end.line]+n.end.column-s[n.start.line]-n.start.column}else{return s[r]-s[n.start.line]-n.start.column}}deleteNodeTail(e,i){const n=e.piece;const s=n.lineFeedCnt;const r=this.offsetInBuffer(n.bufferIndex,n.end);const o=i;const a=this.offsetInBuffer(n.bufferIndex,o);const l=this.getLineFeedCnt(n.bufferIndex,n.start,o);const c=l-s;const u=a-r;const d=n.length+u;e.piece=new qi(n.bufferIndex,n.start,o,l,d);Ys(this,e,u,c)}deleteNodeHead(e,i){const n=e.piece;const s=n.lineFeedCnt;const r=this.offsetInBuffer(n.bufferIndex,n.start);const o=i;const a=this.getLineFeedCnt(n.bufferIndex,o,n.end);const l=this.offsetInBuffer(n.bufferIndex,o);const c=a-s;const u=r-l;const d=n.length+u;e.piece=new qi(n.bufferIndex,o,n.end,a,d);Ys(this,e,u,c)}shrinkNode(e,i,n){const s=e.piece;const r=s.start;const o=s.end;const a=s.length;const l=s.lineFeedCnt;const c=i;const u=this.getLineFeedCnt(s.bufferIndex,s.start,c);const d=this.offsetInBuffer(s.bufferIndex,i)-this.offsetInBuffer(s.bufferIndex,r);e.piece=new qi(s.bufferIndex,s.start,c,u,d);Ys(this,e,d-a,u-l);const p=new qi(s.bufferIndex,n,o,this.getLineFeedCnt(s.bufferIndex,n,o),this.offsetInBuffer(s.bufferIndex,o)-this.offsetInBuffer(s.bufferIndex,n));const f=this.rbInsertRight(e,p);this.validateCRLFWithPrevNode(f)}appendToNode(e,i){if(this.adjustCarriageReturnFromNext(i,e)){i+="\n"}const n=this.shouldCheckCRLF()&&this.startWithLF(i)&&this.endWithCR(e);const s=this._buffers[0].buffer.length;this._buffers[0].buffer+=i;const r=nr(i,false);for(let f=0;f<r.length;f++){r[f]+=s}if(n){const f=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop();this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:s-f}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(r.slice(1));const o=this._buffers[0].lineStarts.length-1;const a=this._buffers[0].buffer.length-this._buffers[0].lineStarts[o];const l={line:o,column:a};const c=e.piece.length+i.length;const u=e.piece.lineFeedCnt;const d=this.getLineFeedCnt(0,e.piece.start,l);const p=d-u;e.piece=new qi(e.piece.bufferIndex,e.piece.start,l,d,c);this._lastChangeBufferPos=l;Ys(this,e,i.length,p)}nodeAt(e){let i=this.root;const n=this._searchCache.get(e);if(n){return{node:n.node,nodeStartOffset:n.nodeStartOffset,remainder:e-n.nodeStartOffset}}let s=0;while(i!==pe){if(i.size_left>e){i=i.left}else if(i.size_left+i.piece.length>=e){s+=i.size_left;const r={node:i,remainder:e-i.size_left,nodeStartOffset:s};this._searchCache.set(r);return r}else{e-=i.size_left+i.piece.length;s+=i.size_left+i.piece.length;i=i.right}}return null}nodeAt2(e,i){let n=this.root;let s=0;while(n!==pe){if(n.left!==pe&&n.lf_left>=e-1){n=n.left}else if(n.lf_left+n.piece.lineFeedCnt>e-1){const r=this.getAccumulatedValue(n,e-n.lf_left-2);const o=this.getAccumulatedValue(n,e-n.lf_left-1);s+=n.size_left;return{node:n,remainder:Math.min(r+i-1,o),nodeStartOffset:s}}else if(n.lf_left+n.piece.lineFeedCnt===e-1){const r=this.getAccumulatedValue(n,e-n.lf_left-2);if(r+i-1<=n.piece.length){return{node:n,remainder:r+i-1,nodeStartOffset:s}}else{i-=n.piece.length-r;break}}else{e-=n.lf_left+n.piece.lineFeedCnt;s+=n.size_left+n.piece.length;n=n.right}}n=n.next();while(n!==pe){if(n.piece.lineFeedCnt>0){const r=this.getAccumulatedValue(n,0);const o=this.offsetOfNode(n);return{node:n,remainder:Math.min(i-1,r),nodeStartOffset:o}}else{if(n.piece.length>=i-1){const r=this.offsetOfNode(n);return{node:n,remainder:i-1,nodeStartOffset:r}}else{i-=n.piece.length}}n=n.next()}return null}nodeCharCodeAt(e,i){if(e.piece.lineFeedCnt<1){return-1}const n=this._buffers[e.piece.bufferIndex];const s=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+i;return n.buffer.charCodeAt(s)}offsetOfNode(e){if(!e){return 0}let i=e.size_left;while(e!==this.root){if(e.parent.right===e){i+=e.parent.size_left+e.parent.piece.length}e=e.parent}return i}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL==="\n")}startWithLF(e){if(typeof e==="string"){return e.charCodeAt(0)===10}if(e===pe||e.piece.lineFeedCnt===0){return false}const i=e.piece;const n=this._buffers[i.bufferIndex].lineStarts;const s=i.start.line;const r=n[s]+i.start.column;if(s===n.length-1){return false}const o=n[s+1];if(o>r+1){return false}return this._buffers[i.bufferIndex].buffer.charCodeAt(r)===10}endWithCR(e){if(typeof e==="string"){return e.charCodeAt(e.length-1)===13}if(e===pe||e.piece.lineFeedCnt===0){return false}return this.nodeCharCodeAt(e,e.piece.length-1)===13}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){const i=e.prev();if(this.endWithCR(i)){this.fixCRLF(i,e)}}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const i=e.next();if(this.startWithLF(i)){this.fixCRLF(e,i)}}}fixCRLF(e,i){const n=[];const s=this._buffers[e.piece.bufferIndex].lineStarts;let r;if(e.piece.end.column===0){r={line:e.piece.end.line-1,column:s[e.piece.end.line]-s[e.piece.end.line-1]-1}}else{r={line:e.piece.end.line,column:e.piece.end.column-1}}const o=e.piece.length-1;const a=e.piece.lineFeedCnt-1;e.piece=new qi(e.piece.bufferIndex,e.piece.start,r,a,o);Ys(this,e,-1,-1);if(e.piece.length===0){n.push(e)}const l={line:i.piece.start.line+1,column:0};const c=i.piece.length-1;const u=this.getLineFeedCnt(i.piece.bufferIndex,l,i.piece.end);i.piece=new qi(i.piece.bufferIndex,l,i.piece.end,u,c);Ys(this,i,-1,-1);if(i.piece.length===0){n.push(i)}const d=this.createNewPieces("\r\n");this.rbInsertRight(e,d[0]);for(let p=0;p<n.length;p++){Vh(this,n[p])}}adjustCarriageReturnFromNext(e,i){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const n=i.next();if(this.startWithLF(n)){e+="\n";if(n.piece.length===1){Vh(this,n)}else{const s=n.piece;const r={line:s.start.line+1,column:0};const o=s.length-1;const a=this.getLineFeedCnt(s.bufferIndex,r,s.end);n.piece=new qi(s.bufferIndex,r,s.end,a,o);Ys(this,n,-1,-1)}return true}}return false}iterate(e,i){if(e===pe){return i(pe)}const n=this.iterate(e.left,i);if(!n){return n}return i(e)&&this.iterate(e.right,i)}getNodeContent(e){if(e===pe){return""}const i=this._buffers[e.piece.bufferIndex];const n=e.piece;const s=this.offsetInBuffer(n.bufferIndex,n.start);const r=this.offsetInBuffer(n.bufferIndex,n.end);const o=i.buffer.substring(s,r);return o}getPieceContent(e){const i=this._buffers[e.bufferIndex];const n=this.offsetInBuffer(e.bufferIndex,e.start);const s=this.offsetInBuffer(e.bufferIndex,e.end);const r=i.buffer.substring(n,s);return r}rbInsertRight(e,i){const n=new Yb(i,Me.Red);n.left=pe;n.right=pe;n.parent=pe;n.size_left=0;n.lf_left=0;const s=this.root;if(s===pe){this.root=n;n.color=Me.Black}else if(e.right===pe){e.right=n;n.parent=e}else{const r=Ny(e.right);r.left=n;n.parent=r}uk(this,n);return n}rbInsertLeft(e,i){const n=new Yb(i,Me.Red);n.left=pe;n.right=pe;n.parent=pe;n.size_left=0;n.lf_left=0;if(this.root===pe){this.root=n;n.color=Me.Black}else if(e.left===pe){e.left=n;n.parent=e}else{const s=c5(e.left);s.right=n;n.parent=s}uk(this,n);return n}getContentOfSubTree(e){let i="";this.iterate(e,n=>{i+=this.getNodeContent(n);return true});return i}}var mr;(function(t){t[t["Unknown"]=0]="Unknown";t[t["Invalid"]=3]="Invalid";t[t["LF"]=1]="LF";t[t["CRLF"]=2]="CRLF"})(mr||(mr={}));function j1(t){let e=0;let i=0;let n=0;let s=mr.Unknown;for(let r=0,o=t.length;r<o;r++){const a=t.charCodeAt(r);if(a===A.CarriageReturn){if(e===0){i=r}e++;if(r+1<o&&t.charCodeAt(r+1)===A.LineFeed){s|=mr.CRLF;r++}else{s|=mr.Invalid}n=r+1}else if(a===A.LineFeed){s|=mr.LF;if(e===0){i=r}e++;n=r+1}}if(e===0){i=t.length}return[e,i,t.length-n,s]}let G1;function QO(){if(!G1){G1=new TextDecoder("UTF-16LE")}return G1}function JO(t,e,i){const n=new Uint16Array(t.buffer,e,i);if(i>0&&(n[0]===65279||n[0]===65534)){return XO(t,e,i)}return QO().decode(n)}function XO(t,e,i){const n=[];let s=0;for(let r=0;r<i;r++){const o=j5(t,e);e+=2;n[s++]=String.fromCharCode(o)}return n.join("")}function Wh(t){return t.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}class Gn{get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}constructor(e,i,n,s){this.oldPosition=e;this.oldText=i;this.newPosition=n;this.newText=s}toString(){if(this.oldText.length===0){return`(insert@${this.oldPosition} "${Wh(this.newText)}")`}if(this.newText.length===0){return`(delete@${this.oldPosition} "${Wh(this.oldText)}")`}return`(replace@${this.oldPosition} "${Wh(this.oldText)}" with "${Wh(this.newText)}")`}static _writeStringSize(e){return 4+2*e.length}static _writeString(e,i,n){const s=i.length;Gh(e,s,n);n+=4;for(let r=0;r<s;r++){G5(e,i.charCodeAt(r),n);n+=2}return n}static _readString(e,i){const n=jh(e,i);i+=4;return JO(e,i,n)}writeSize(){return 4+4+Gn._writeStringSize(this.oldText)+Gn._writeStringSize(this.newText)}write(e,i){Gh(e,this.oldPosition,i);i+=4;Gh(e,this.newPosition,i);i+=4;i=Gn._writeString(e,this.oldText,i);i=Gn._writeString(e,this.newText,i);return i}static read(e,i,n){const s=jh(e,i);i+=4;const r=jh(e,i);i+=4;const o=Gn._readString(e,i);i+=Gn._writeStringSize(o);const a=Gn._readString(e,i);i+=Gn._writeStringSize(a);n.push(new Gn(s,o,r,a));return i}}class bl extends Ee{constructor(e,i,n,s,r,o,a){super();this._onDidChangeContent=this._register(new L);this.onDidChangeContent=this._onDidChangeContent.event;this._BOM=i;this._mightContainNonBasicASCII=!o;this._mightContainRTL=s;this._mightContainUnusualLineTerminators=r;this._pieceTree=new KO(e,n,a)}equals(e){if(!(e instanceof bl)){return false}if(this._BOM!==e._BOM){return false}if(this.getEOL()!==e.getEOL()){return false}return this._pieceTree.equal(e._pieceTree)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=false}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(e){return this._pieceTree.createSnapshot(e?this._BOM:"")}getOffsetAt(e,i){return this._pieceTree.getOffsetAt(e,i)}getPositionAt(e){return this._pieceTree.getPositionAt(e)}getRangeAt(e,i){const n=e+i;const s=this.getPositionAt(e);const r=this.getPositionAt(n);return new et(s.lineNumber,s.column,r.lineNumber,r.column)}getValueInRange(e,i=tr.TextDefined){if(e.isEmpty()){return""}const n=this._getEndOfLine(i);return this._pieceTree.getValueInRange(e,n)}getValueLengthInRange(e,i=tr.TextDefined){if(e.isEmpty()){return 0}if(e.startLineNumber===e.endLineNumber){return e.endColumn-e.startColumn}const n=this.getOffsetAt(e.startLineNumber,e.startColumn);const s=this.getOffsetAt(e.endLineNumber,e.endColumn);let r=0;const o=this._getEndOfLine(i);const a=this.getEOL();if(o.length!==a.length){const l=o.length-a.length;const c=e.endLineNumber-e.startLineNumber;r=l*c}return s-n+r}getCharacterCountInRange(e,i=tr.TextDefined){if(this._mightContainNonBasicASCII){let n=0;const s=e.startLineNumber;const r=e.endLineNumber;for(let o=s;o<=r;o++){const a=this.getLineContent(o);const l=o===s?e.startColumn-1:0;const c=o===r?e.endColumn-1:a.length;for(let u=l;u<c;u++){if(_m(a.charCodeAt(u))){n=n+1;u=u+1}else{n=n+1}}}n+=this._getEndOfLine(i).length*(r-s);return n}return this.getValueLengthInRange(e,i)}getNearestChunk(e){return this._pieceTree.getNearestChunk(e)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(e){return this._pieceTree.getLineContent(e)}getLineCharCode(e,i){return this._pieceTree.getLineCharCode(e,i)}getCharCode(e){return this._pieceTree.getCharCode(e)}getLineLength(e){return this._pieceTree.getLineLength(e)}getLineMinColumn(e){return 1}getLineMaxColumn(e){return this.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){const i=v1(this.getLineContent(e));if(i===-1){return 0}return i+1}getLineLastNonWhitespaceColumn(e){const i=ZT(this.getLineContent(e));if(i===-1){return 0}return i+2}_getEndOfLine(e){switch(e){case tr.LF:return"\n";case tr.CRLF:return"\r\n";case tr.TextDefined:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(e){this._pieceTree.setEOL(e)}applyEdits(e,i,n){let s=this._mightContainRTL;let r=this._mightContainUnusualLineTerminators;let o=this._mightContainNonBasicASCII;let a=true;let l=[];for(let v=0;v<e.length;v++){const y=e[v];if(a&&y._isTracked){a=false}const D=y.range;if(y.text){let Q=true;if(!o){Q=!oP(y.text);o=Q}if(!s&&Q){s=hI(y.text)}if(!r&&Q){r=fI(y.text)}}let I="";let R=0;let J=0;let H=0;if(y.text){let Q;[R,J,H,Q]=j1(y.text);const ne=this.getEOL();const te=ne==="\r\n"?mr.CRLF:mr.LF;if(Q===mr.Unknown||Q===te){I=y.text}else{I=y.text.replace(/\r\n|\r|\n/g,ne)}}l[v]={sortIndex:v,identifier:y.identifier||null,range:D,rangeOffset:this.getOffsetAt(D.startLineNumber,D.startColumn),rangeLength:this.getValueLengthInRange(D),text:I,eolCount:R,firstLineLength:J,lastLineLength:H,forceMoveMarkers:Boolean(y.forceMoveMarkers),isAutoWhitespaceEdit:y.isAutoWhitespaceEdit||false}}l.sort(bl._sortOpsAscending);let c=false;for(let v=0,y=l.length-1;v<y;v++){const D=l[v].range.getEndPosition();const I=l[v+1].range.getStartPosition();if(I.isBeforeOrEqual(D)){if(I.isBefore(D)){throw new Error("Overlapping ranges are not allowed!")}c=true}}if(a){l=this._reduceOperations(l)}const u=n||i?bl._getInverseEditRanges(l):[];const d=[];if(i){for(let v=0;v<l.length;v++){const y=l[v];const D=u[v];if(y.isAutoWhitespaceEdit&&y.range.isEmpty()){for(let I=D.startLineNumber;I<=D.endLineNumber;I++){let R="";if(I===D.startLineNumber){R=this.getLineContent(y.range.startLineNumber);if(v1(R)!==-1){continue}}d.push({lineNumber:I,oldContent:R})}}}}let p=null;if(n){let v=0;p=[];for(let y=0;y<l.length;y++){const D=l[y];const I=u[y];const R=this.getValueInRange(D.range);const J=D.rangeOffset+v;v+=D.text.length-R.length;p[y]={sortIndex:D.sortIndex,identifier:D.identifier,range:I,text:R,textChange:new Gn(D.rangeOffset,R,J,D.text)}}if(!c){p.sort((y,D)=>y.sortIndex-D.sortIndex)}}this._mightContainRTL=s;this._mightContainUnusualLineTerminators=r;this._mightContainNonBasicASCII=o;const f=this._doApplyEdits(l);let m=null;if(i&&d.length>0){d.sort((v,y)=>y.lineNumber-v.lineNumber);m=[];for(let v=0,y=d.length;v<y;v++){const D=d[v].lineNumber;if(v>0&&d[v-1].lineNumber===D){continue}const I=d[v].oldContent;const R=this.getLineContent(D);if(R.length===0||R===I||v1(R)!==-1){continue}m.push(D)}}this._onDidChangeContent.fire();return new D8(p,f,m)}_reduceOperations(e){if(e.length<1e3){return e}return[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let i=false;const n=e[0].range;const s=e[e.length-1].range;const r=new et(n.startLineNumber,n.startColumn,s.endLineNumber,s.endColumn);let o=n.startLineNumber;let a=n.startColumn;const l=[];for(let f=0,m=e.length;f<m;f++){const v=e[f];const y=v.range;i=i||v.forceMoveMarkers;l.push(this.getValueInRange(new et(o,a,y.startLineNumber,y.startColumn)));if(v.text.length>0){l.push(v.text)}o=y.endLineNumber;a=y.endColumn}const c=l.join("");const[u,d,p]=j1(c);return{sortIndex:0,identifier:e[0].identifier,range:r,rangeOffset:this.getOffsetAt(r.startLineNumber,r.startColumn),rangeLength:this.getValueLengthInRange(r,tr.TextDefined),text:c,eolCount:u,firstLineLength:d,lastLineLength:p,forceMoveMarkers:i,isAutoWhitespaceEdit:false}}_doApplyEdits(e){e.sort(bl._sortOpsDescending);const i=[];for(let n=0;n<e.length;n++){const s=e[n];const r=s.range.startLineNumber;const o=s.range.startColumn;const a=s.range.endLineNumber;const l=s.range.endColumn;if(r===a&&o===l&&s.text.length===0){continue}if(s.text){this._pieceTree.delete(s.rangeOffset,s.rangeLength);this._pieceTree.insert(s.rangeOffset,s.text,true)}else{this._pieceTree.delete(s.rangeOffset,s.rangeLength)}const c=new et(r,o,a,l);i.push({range:c,rangeLength:s.rangeLength,text:s.text,rangeOffset:s.rangeOffset,forceMoveMarkers:s.forceMoveMarkers})}return i}findMatchesLineByLine(e,i,n,s){return this._pieceTree.findMatchesLineByLine(e,i,n,s)}getPieceTree(){return this._pieceTree}static _getInverseEditRange(e,i){const n=e.startLineNumber;const s=e.startColumn;const[r,o,a]=j1(i);let l;if(i.length>0){const c=r+1;if(c===1){l=new et(n,s,n,s+o)}else{l=new et(n,s,n+c-1,a+1)}}else{l=new et(n,s,n,s)}return l}static _getInverseEditRanges(e){const i=[];let n=0;let s=0;let r=null;for(let o=0,a=e.length;o<a;o++){const l=e[o];let c;let u;if(r){if(r.range.endLineNumber===l.range.startLineNumber){c=n;u=s+(l.range.startColumn-r.range.endColumn)}else{c=n+(l.range.startLineNumber-r.range.endLineNumber);u=l.range.startColumn}}else{c=l.range.startLineNumber;u=l.range.startColumn}let d;if(l.text.length>0){const p=l.eolCount+1;if(p===1){d=new et(c,u,c,u+l.firstLineLength)}else{d=new et(c,u,c+p-1,l.lastLineLength+1)}}else{d=new et(c,u,c,u)}n=d.endLineNumber;s=d.endColumn;i.push(d);r=l}return i}static _sortOpsAscending(e,i){const n=et.compareRangesUsingEnds(e.range,i.range);if(n===0){return e.sortIndex-i.sortIndex}return n}static _sortOpsDescending(e,i){const n=et.compareRangesUsingEnds(e.range,i.range);if(n===0){return i.sortIndex-e.sortIndex}return-n}}class YO{constructor(e,i,n,s,r,o,a,l,c){this._chunks=e;this._bom=i;this._cr=n;this._lf=s;this._crlf=r;this._containsRTL=o;this._containsUnusualLineTerminators=a;this._isBasicASCII=l;this._normalizeEOL=c}_getEOL(e){const i=this._cr+this._lf+this._crlf;const n=this._cr+this._crlf;if(i===0){return e===Yu.LF?"\n":"\r\n"}if(n>i/2){return"\r\n"}return"\n"}create(e){const i=this._getEOL(e);const n=this._chunks;if(this._normalizeEOL&&(i==="\r\n"&&(this._cr>0||this._lf>0)||i==="\n"&&(this._cr>0||this._crlf>0))){for(let r=0,o=n.length;r<o;r++){const a=n[r].buffer.replace(/\r\n|\r|\n/g,i);const l=nr(a);n[r]=new Bo(a,l)}}const s=new bl(n,this._bom,i,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:s,disposable:s}}getFirstLineText(e){return this._chunks[0].buffer.substr(0,e).split(/\r\n|\r|\n/)[0]}}class dk{constructor(){this.chunks=[];this.BOM="";this._hasPreviousChar=false;this._previousChar=0;this._tmpLineStarts=[];this.cr=0;this.lf=0;this.crlf=0;this.containsRTL=false;this.containsUnusualLineTerminators=false;this.isBasicASCII=true}acceptChunk(e){if(e.length===0){return}if(this.chunks.length===0){if(cP(e)){this.BOM=lP;e=e.substr(1)}}const i=e.charCodeAt(e.length-1);if(i===A.CarriageReturn||i>=55296&&i<=56319){this._acceptChunk1(e.substr(0,e.length-1),false);this._hasPreviousChar=true;this._previousChar=i}else{this._acceptChunk1(e,false);this._hasPreviousChar=false;this._previousChar=i}}_acceptChunk1(e,i){if(!i&&e.length===0){return}if(this._hasPreviousChar){this._acceptChunk2(String.fromCharCode(this._previousChar)+e)}else{this._acceptChunk2(e)}}_acceptChunk2(e){const i=qO(this._tmpLineStarts,e);this.chunks.push(new Bo(e,i.lineStarts));this.cr+=i.cr;this.lf+=i.lf;this.crlf+=i.crlf;if(!i.isBasicASCII){this.isBasicASCII=false;if(!this.containsRTL){this.containsRTL=hI(e)}if(!this.containsUnusualLineTerminators){this.containsUnusualLineTerminators=fI(e)}}}finish(e=true){this._finish();return new YO(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(this.chunks.length===0){this._acceptChunk1("",true)}if(this._hasPreviousChar){this._hasPreviousChar=false;const e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);const i=nr(e.buffer);e.lineStarts=i;if(this._previousChar===A.CarriageReturn){this.cr++}}}}class ZO extends Ee{constructor(e,i,n){super();this._source=e;this._inputTextBuffer=i;this._outputs=n;this._outputTextBuffers=void 0}_getFullModelRange(e){const i=e.getLineCount();return new et(1,1,i,this._getLineMaxColumn(e,i))}_getLineMaxColumn(e,i){if(i<1||i>e.getLineCount()){throw new Error("Illegal value for lineNumber")}return e.getLineLength(i)+1}get inputTextBuffer(){if(!this._inputTextBuffer){const e=new dk;e.acceptChunk(this._source);const i=e.finish(true);const{textBuffer:n,disposable:s}=i.create(Yu.LF);this._inputTextBuffer=n;this._register(s)}return this._inputTextBuffer}get outputTextBuffers(){if(!this._outputTextBuffers){this._outputTextBuffers=this._outputs.map(e=>{const i=new dk;i.acceptChunk(e);const n=i.finish(true);const{textBuffer:s,disposable:r}=n.create(Yu.LF);this._register(r);return s})}return this._outputTextBuffers}findInInputs(e){const i=new nD(e,false,false,null);const n=i.parseSearchRequest();if(!n){return[]}const s=this._getFullModelRange(this.inputTextBuffer);return this.inputTextBuffer.findMatchesLineByLine(s,n,true,5e3)}findInOutputs(e){const i=new nD(e,false,false,null);const n=i.parseSearchRequest();if(!n){return[]}return this.outputTextBuffers.map(s=>{const r=s.findMatchesLineByLine(this._getFullModelRange(s),n,true,5e3);if(r.length===0){return void 0}return{textBuffer:s,matches:r}}).filter(s=>!!s)}}function hk(t,e){let i=-1;const n=[];let s=[];t.forEach(o=>{if(o.range.startLineNumber!==i){if(s.length>0){n.push([...s]);s=[]}}s.push(o);i=o.range.endLineNumber});if(s.length>0){n.push([...s])}const r=n.map(o=>{const a=[];const l=o[0].range.startLineNumber;const c=o[o.length-1].range.endLineNumber;for(let u=l;u<=c;u++){a.push(e.getLineContent(u))}return new N3(a.join("\n")+"\n",o.map(u=>new et(u.range.startLineNumber-1,u.range.startColumn-1,u.range.endLineNumber-1,u.range.endColumn-1)))});return r}const eF=xe("remoteAgentService");const tF=xe("IUserDataProfilesService");const iF=Object.freeze({"id":"workbench","order":7,"title":h(3772,"Workbench"),"type":"object"});const nF=Object.freeze({"id":"security","scope":wt.APPLICATION,"title":h(3773,"Security"),"type":"object","order":7});Object.freeze({"id":"problems","title":h(3774,"Problems"),"type":"object","order":101});const sF=Object.freeze({"id":"window","order":8,"title":h(3775,"Window"),"type":"object"});const rF={ConfigurationMigration:"base.contributions.configuration.migration"};class oF{constructor(){this.migrations=[];this._onDidRegisterConfigurationMigrations=new L;this.onDidRegisterConfigurationMigration=this._onDidRegisterConfigurationMigrations.event}registerConfigurationMigrations(e){this.migrations.push(...e)}}const Ef=new oF;ci.add(rF.ConfigurationMigration,Ef);let fk=class Y$ extends Ee{static{this.ID="workbench.contrib.configurationMigration"}constructor(e,i){super();this.configurationService=e;this.workspaceService=i;this._register(this.workspaceService.onDidChangeWorkspaceFolders(async n=>{for(const s of n.added){await this.migrateConfigurationsForFolder(s,Ef.migrations)}}));this.migrateConfigurations(Ef.migrations);this._register(Ef.onDidRegisterConfigurationMigration(n=>this.migrateConfigurations(n)))}async migrateConfigurations(e){await this.migrateConfigurationsForFolder(void 0,e);for(const i of this.workspaceService.getWorkspace().folders){await this.migrateConfigurationsForFolder(i,e)}}async migrateConfigurationsForFolder(e,i){await Promise.all([i.map(n=>this.migrateConfigurationsForFolderAndOverride(n,e?.uri))])}async migrateConfigurationsForFolderAndOverride(e,i){const n=this.configurationService.inspect(e.key,{resource:i});const s=this.workspaceService.getWorkbenchState()===Vf.WORKSPACE?[["user",di.USER],["userLocal",di.USER_LOCAL],["userRemote",di.USER_REMOTE],["workspace",di.WORKSPACE],["workspaceFolder",di.WORKSPACE_FOLDER]]:[["user",di.USER],["userLocal",di.USER_LOCAL],["userRemote",di.USER_REMOTE],["workspace",di.WORKSPACE]];for(const[r,o]of s){const a=n[r];if(!a){continue}const l=[];if(a.value!==void 0){const c=await this.runMigration(e,r,a.value,i,void 0);for(const u of c??[]){l.push([u,[]])}}for(const{identifiers:c,value:u}of a.overrides??[]){if(u!==void 0){const d=await this.runMigration(e,r,u,i,c);for(const p of d??[]){l.push([p,c])}}}if(l.length){await Promise.allSettled(l.map(async([[c,u],d])=>this.configurationService.updateValue(c,u.value,{resource:i,overrideIdentifiers:d},o)))}}}async runMigration(e,i,n,s,r){const o=l=>{const c=this.configurationService.inspect(l,{resource:s});const u=c[i];if(!u){return void 0}if(!r){return u.value}return u.overrides?.find(({identifiers:d})=>Xi(d,r))?.value};const a=await e.migrateFn(n,o);return Array.isArray(a)?a:[[e.key,a]]}};fk=z([O(0,Bm),O(1,AC)],fk);let pk=class Z$ extends Ee{static{this.ID="workbench.contrib.dynamicWorkbenchSecurityConfiguration"}constructor(e){super();this.remoteAgentService=e;this._ready=new Fs;this.ready=this._ready.p;this.create()}async create(){try{await this.doCreate()}finally{this._ready.complete()}}async doCreate(){if(!Yi){const i=await this.remoteAgentService.getEnvironment();if(i?.os!==Cs.Windows){return}}const e=ci.as($a.Configuration);e.registerConfiguration({...nF,"properties":{"security.allowedUNCHosts":{"type":"array","items":{"type":"string","pattern":"^[^\\\\]+$","patternErrorMessage":h(3776,"UNC host names must not contain backslashes.")},"default":[],"markdownDescription":h(3777,"A set of UNC host names (without leading or trailing backslash, for example `192.168.0.1` or `my-server`) to allow without user confirmation. If a UNC host is being accessed that is not allowed via this setting or has not been acknowledged via user confirmation, an error will occur and the operation stopped. A restart is required when changing this setting. Find out more about this setting at https://aka.ms/vscode-windows-unc."),"scope":wt.APPLICATION_MACHINE},"security.restrictUNCAccess":{"type":"boolean","default":true,"markdownDescription":h(3778,"If enabled, only allows access to UNC host names that are allowed by the `#security.allowedUNCHosts#` setting or after user confirmation. Find out more about this setting at https://aka.ms/vscode-windows-unc."),"scope":wt.APPLICATION_MACHINE}}})}};pk=z([O(0,eF)],pk);const tu="window.newWindowProfile";let gk=class eH extends Ee{static{this.ID="workbench.contrib.dynamicWindowConfiguration"}constructor(e,i){super();this.userDataProfilesService=e;this.configurationService=i;this.registerNewWindowProfileConfiguration();this._register(this.userDataProfilesService.onDidChangeProfiles(n=>this.registerNewWindowProfileConfiguration()));this.setNewWindowProfile();this.checkAndResetNewWindowProfileConfig();this._register(i.onDidChangeConfiguration(n=>{if(n.source!==di.DEFAULT&&n.affectsConfiguration(tu)){this.setNewWindowProfile()}}));this._register(this.userDataProfilesService.onDidChangeProfiles(()=>this.checkAndResetNewWindowProfileConfig()))}registerNewWindowProfileConfiguration(){const e=ci.as($a.Configuration);const i={...sF,"properties":{[tu]:{"type":["string","null"],"default":null,"enum":[...this.userDataProfilesService.profiles.map(n=>n.name),null],"enumItemLabels":[...this.userDataProfilesService.profiles.map(n=>""),h(3779,"Active Window")],"description":h(3780,"Specifies the profile to use when opening a new window. If a profile name is provided, the new window will use that profile. If no profile name is provided, the new window will use the profile of the active window or the Default profile if no active window exists."),"scope":wt.APPLICATION}}};if(this.configurationNode){e.updateConfigurations({add:[i],remove:[this.configurationNode]})}else{e.registerConfiguration(i)}this.configurationNode=i}setNewWindowProfile(){const e=this.configurationService.getValue(tu);this.newWindowProfile=e?this.userDataProfilesService.profiles.find(i=>i.name===e):void 0}checkAndResetNewWindowProfileConfig(){const e=this.configurationService.getValue(tu);if(!e){return}const i=this.newWindowProfile?this.userDataProfilesService.profiles.find(n=>n.id===this.newWindowProfile.id):void 0;if(e===i?.name){return}this.configurationService.updateValue(tu,i?.name)}};gk=z([O(0,tF),O(1,Bm)],gk);const aF=ci.as($a.Configuration);const lF={...iF,properties:{"workbench.editorAssociations":{type:"object",markdownDescription:h(12191,'Configure [glob patterns](https://aka.ms/vscode-glob-patterns) to editors (for example `"*.hex": "hexEditor.hexedit"`). These have precedence over the default behavior.'),additionalProperties:{type:"string"}}}};aF.registerConfiguration(lF);var Zb;(function(t){t["builtin"]="builtin";t["option"]="option";t["exclusive"]="exclusive";t["default"]="default"})(Zb||(Zb={}));var mk;(function(t){t[t["ABORT"]=1]="ABORT";t[t["NONE"]=2]="NONE"})(mk||(mk={}));function cF(t,e){const i=new Set([ae.extension,ae.webviewPanel,ae.vscodeWorkspaceTrust,ae.vscodeSettings]);if(i.has(e.scheme)){return false}const n=typeof t==="string"&&t.indexOf(ct.sep)>=0;const s=n?`${e.scheme}:${e.path}`:$s(e);return Su(typeof t==="string"?t.toLowerCase():t,s.toLowerCase())}class yl{static{this._notebookStatusBarItemProviderHandlePool=0}get activeNotebookEditor(){return this._activeNotebookEditor?.apiEditor}get visibleNotebookEditors(){return this._visibleNotebookEditors.map(e=>e.apiEditor)}constructor(e,i,n,s,r,o,a){this._textDocumentsAndEditors=n;this._textDocuments=s;this._extHostFileSystem=r;this._extHostSearch=o;this._logService=a;this._notebookStatusBarItemProviders=new Map;this._documents=new Ft;this._editors=new Map;this._onDidChangeActiveNotebookEditor=new L;this.onDidChangeActiveNotebookEditor=this._onDidChangeActiveNotebookEditor.event;this._visibleNotebookEditors=[];this._onDidOpenNotebookDocument=new L;this.onDidOpenNotebookDocument=this._onDidOpenNotebookDocument.event;this._onDidCloseNotebookDocument=new L;this.onDidCloseNotebookDocument=this._onDidCloseNotebookDocument.event;this._onDidChangeVisibleNotebookEditors=new L;this.onDidChangeVisibleNotebookEditors=this._onDidChangeVisibleNotebookEditors.event;this._statusBarCache=new In("NotebookCellStatusBarCache");this._handlePool=0;this._notebookSerializer=new Map;this._notebookProxy=e.getProxy(Y.MainThreadNotebook);this._notebookDocumentsProxy=e.getProxy(Y.MainThreadNotebookDocuments);this._notebookEditorsProxy=e.getProxy(Y.MainThreadNotebookEditors);this._commandsConverter=i.converter;i.registerArgumentProcessor({processArgument:l=>{if(l&&l.$mid===it.NotebookCellActionContext){const c=l.notebookEditor?.notebookUri;const u=l.cell.handle;const d=this._documents.get(c);const p=d?.getCell(u);if(p){return p.apiCell}}if(l&&l.$mid===it.NotebookActionContext){const c=l.uri;const u=this._documents.get(c);if(u){return u.apiNotebook}}return l}});yl._registerApiCommands(i)}getEditorById(e){const i=this._editors.get(e);if(!i){throw new Error(`unknown text editor: ${e}. known editors: ${[...this._editors.keys()]} `)}return i}getIdByEditor(e){for(const[i,n]of this._editors){if(n.apiEditor===e){return i}}return void 0}get notebookDocuments(){return[...this._documents.values()]}getNotebookDocument(e,i){const n=this._documents.get(e);if(!n&&!i){throw new Error(`NO notebook document for '${e}'`)}return n}static _convertNotebookRegistrationData(e,i){if(!i){return}const n=i.filenamePattern.map(s=>Pg.from(s)).filter(s=>s!==void 0);if(i.filenamePattern&&!n){console.warn(`Notebook content provider view options file name pattern is invalid ${i.filenamePattern}`);return void 0}return{extension:e.identifier,providerDisplayName:e.displayName||e.name,displayName:i.displayName,filenamePattern:n,priority:i.exclusive?Zb.exclusive:void 0}}registerNotebookCellStatusBarItemProvider(e,i,n){const s=yl._notebookStatusBarItemProviderHandlePool++;const r=typeof n.onDidChangeCellStatusBarItems==="function"?yl._notebookStatusBarItemProviderHandlePool++:void 0;this._notebookStatusBarItemProviders.set(s,n);this._notebookProxy.$registerNotebookCellStatusBarItemProvider(s,r,i);let o;if(r!==void 0){o=n.onDidChangeCellStatusBarItems(a=>this._notebookProxy.$emitCellStatusBarEvent(r))}return new qe(()=>{this._notebookStatusBarItemProviders.delete(s);this._notebookProxy.$unregisterNotebookCellStatusBarItemProvider(s,r);o?.dispose()})}async createNotebookDocument(e){const i=await this._notebookDocumentsProxy.$tryCreateNotebook({viewType:e.viewType,content:e.content&&Vr.from(e.content)});return b.revive(i)}async openNotebookDocument(e){const i=this._documents.get(e);if(i){return i.apiNotebook}const n=await this._notebookDocumentsProxy.$tryOpenNotebook(e);const s=this._documents.get(b.revive(n));return zl(s?.apiNotebook)}async showNotebookDocument(e,i){let n;if(typeof i==="object"){n={position:ai.from(i.viewColumn),preserveFocus:i.preserveFocus,selections:i.selections&&i.selections.map(Ls.from),pinned:typeof i.preview==="boolean"?!i.preview:void 0,label:typeof i.asRepl==="string"?i.asRepl:typeof i.asRepl==="object"?i.asRepl.label:void 0}}else{n={preserveFocus:false,pinned:true}}const s=!!i?.asRepl?"repl":e.notebookType;const r=await this._notebookEditorsProxy.$tryShowNotebookDocument(e.uri,s,n);const o=r&&this._editors.get(r)?.apiEditor;if(o){return o}if(r){throw new Error(`Could NOT open editor for "${e.uri.toString()}" because another editor opened in the meantime.`)}else{throw new Error(`Could NOT open editor for "${e.uri.toString()}".`)}}async $provideNotebookCellStatusBarItems(e,i,n,s){const r=this._notebookStatusBarItemProviders.get(e);const o=b.revive(i);const a=this._documents.get(o);if(!a||!r){return}const l=a.getCellFromIndex(n);if(!l){return}const c=await r.provideCellStatusBarItems(l.apiCell,s);if(!c){return void 0}const u=new Ie;const d=this._statusBarCache.add([u]);const p=Array.isArray(c)?c:[c];const f=p.map(m=>ww.from(m,this._commandsConverter,u));return{cacheId:d,items:f}}$releaseNotebookCellStatusBarItems(e){this._statusBarCache.delete(e)}registerNotebookSerializer(e,i,n,s,r){if(Qu(i)){throw new Error(`viewType cannot be empty or just whitespace`)}const o=this._handlePool++;this._notebookSerializer.set(o,{viewType:i,serializer:n,options:s});this._notebookProxy.$registerNotebookSerializer(o,{id:e.identifier,location:e.extensionLocation},i,yw.from(s),yl._convertNotebookRegistrationData(e,r));return ge(()=>{this._notebookProxy.$unregisterNotebookSerializer(o)})}async $dataToNotebook(e,i,n){const s=this._notebookSerializer.get(e);if(!s){throw new Error("NO serializer found")}const r=await s.serializer.deserializeNotebook(i.buffer,n);return new Bi(Vr.from(r))}async $notebookToData(e,i,n){const s=this._notebookSerializer.get(e);if(!s){throw new Error("NO serializer found")}const r=await s.serializer.serializeNotebook(Vr.to(i.value),n);return ue.wrap(r)}async $saveNotebook(e,i,n,s,r){const o=b.revive(i);const a=this._notebookSerializer.get(e);this.trace(`enter saveNotebook(versionId: ${n}, ${o.toString()})`);if(!a){throw new Error("NO serializer found")}const l=this._documents.get(o);if(!l){throw new Error("Document NOT found")}if(l.versionId!==n){throw new Error("Document version mismatch")}if(!this._extHostFileSystem.value.isWritableFileSystem(o.scheme)){throw new v_(h(2564,"Unable to modify read-only file '{0}'",this._resourceForError(o)),wn.FILE_PERMISSION_DENIED)}const c={metadata:Tx(l.apiNotebook.metadata,m=>!(a.options?.transientDocumentMetadata??{})[m]),cells:[]};for(const m of l.apiNotebook.getCells()){const v=new Pm(m.kind,m.document.getText(),m.document.languageId,m.mime,!a.options?.transientOutputs?[...m.outputs]:[],m.metadata,m.executionSummary);v.metadata=Tx(m.metadata,y=>!(a.options?.transientCellMetadata??{})[y]);c.cells.push(v)}await this._validateWriteFile(o,s);if(r.isCancellationRequested){throw new Error("canceled")}const u=await a.serializer.serializeNotebook(c,r);if(r.isCancellationRequested){throw new Error("canceled")}this.trace(`serialized versionId: ${n} ${o.toString()}`);await this._extHostFileSystem.value.writeFile(o,u);this.trace(`Finished write versionId: ${n} ${o.toString()}`);const d=this._extHostFileSystem.getFileSystemProviderExtUri(o.scheme);const p=await this._extHostFileSystem.value.stat(o);const f={name:d.basename(o),isFile:(p.type&ra.File)!==0,isDirectory:(p.type&ra.Directory)!==0,isSymbolicLink:(p.type&ra.SymbolicLink)!==0,mtime:p.mtime,ctime:p.ctime,size:p.size,readonly:Boolean((p.permissions??0)&Ql.Readonly)||!this._extHostFileSystem.value.isWritableFileSystem(o.scheme),locked:Boolean((p.permissions??0)&Ql.Locked),etag:Ax({mtime:p.mtime,size:p.size}),children:void 0};this.trace(`exit saveNotebook(versionId: ${n}, ${o.toString()})`);return f}async $searchInNotebooks(e,i,n,s,r){const o=this._notebookSerializer.get(e)?.serializer;if(!o){return{limitHit:false,results:[]}}const a=new Nk;const l=async(p,f,m)=>{await Promise.all(p.map(async v=>await Promise.all(v.filenamePatterns.map(y=>{const D={_reason:m._reason,folderQueries:m.folderQueries,includePattern:m.includePattern,excludePattern:m.excludePattern,maxResults:m.maxResults,type:va.File,filePattern:y};return this._extHostSearch.doInternalFileSearchWithCustomCallback(D,f,I=>{I.forEach(R=>{if(a.has(R)){return}const J=s.some(H=>{if(v.isFromSettings&&!H.isFromSettings){return false}else{return H.filenamePatterns.some(Q=>cF(Q,R))}});if(J){return}a.add(R)})}).catch(I=>{if(I.code==="ENOENT"){console.warn(`Could not find notebook search results, ignoring notebook results.`);return{limitHit:false,messages:[]}}else{throw I}})}))));return};await l(n,r,i);const c=new Ft;let u=false;const d=Array.from(a).map(async p=>{const f=[];try{if(r.isCancellationRequested){return}if(i.maxResults&&[...c.values()].reduce((D,I)=>D+I.cellResults.length,0)>i.maxResults){u=true;return}const m=[];const v=this._documents.get(p);if(v){const D=v.apiNotebook.getCells();D.forEach(I=>m.push({input:I.document.getText(),outputs:I.outputs.flatMap(R=>R.items.map(J=>J.data.toString()))}))}else{const D=await this._extHostFileSystem.value.readFile(p);const I=ue.fromString(D.toString());const R=await o.deserializeNotebook(I.buffer,r);if(r.isCancellationRequested){return}const J=Vr.from(R);J.cells.forEach(H=>m.push({input:H.source,outputs:H.outputs.flatMap(Q=>Q.items.map(ne=>ne.valueBytes.toString()))}))}if(r.isCancellationRequested){return}m.forEach((D,I)=>{const R=i.contentPattern.pattern;const J=new ZO(D.input,void 0,D.outputs);const H=J.findInInputs(R);const Q=J.findInOutputs(R);const ne=Q.flatMap(te=>hk(te.matches,te.textBuffer)).map((te,le)=>{te.webviewIndex=le;return te});if(H.length>0||Q.length>0){const te={index:I,contentResults:hk(H,J.inputTextBuffer),webviewResults:ne};f.push(te)}});const y={resource:p,cellResults:f};c.set(p,y);return}catch(m){return}});await Promise.all(d);return{limitHit:u,results:[...c.values()]}}async _validateWriteFile(e,i){const n=await this._extHostFileSystem.value.stat(e);if(typeof i?.mtime==="number"&&typeof i.etag==="string"&&i.etag!==r7&&typeof n.mtime==="number"&&typeof n.size==="number"&&i.mtime<n.mtime&&i.etag!==Ax({mtime:i.mtime,size:n.size})){throw new v_(h(2565,"File Modified Since"),wn.FILE_MODIFIED_SINCE,i)}return}_resourceForError(e){return e.scheme===ae.file?e.fsPath:e.toString()}_createExtHostEditor(e,i,n){if(this._editors.has(i)){throw new Error(`editor with id ALREADY EXSIST: ${i}`)}const s=new sh(i,this._notebookEditorsProxy,e,n.visibleRanges.map(Ls.to),n.selections.map(Ls.to),typeof n.viewColumn==="number"?ai.to(n.viewColumn):void 0,n.viewType);this._editors.set(i,s)}$acceptDocumentAndEditorsDelta(e){if(e.value.removedDocuments){for(const i of e.value.removedDocuments){const n=b.revive(i);const s=this._documents.get(n);if(s){s.dispose();this._documents.delete(n);this._textDocumentsAndEditors.$acceptDocumentsAndEditorsDelta({removedDocuments:s.apiNotebook.getCells().map(r=>r.document.uri)});this._onDidCloseNotebookDocument.fire(s.apiNotebook)}for(const r of this._editors.values()){if(r.notebookData.uri.toString()===n.toString()){this._editors.delete(r.id)}}}}if(e.value.addedDocuments){const i=[];for(const n of e.value.addedDocuments){const s=b.revive(n.uri);if(this._documents.has(s)){throw new Error(`adding EXISTING notebook ${s} `)}const r=new Ly(this._notebookDocumentsProxy,this._textDocumentsAndEditors,this._textDocuments,s,n);i.push(...n.cells.map(o=>Xb.asModelAddData(o)));this._documents.get(s)?.dispose();this._documents.set(s,r);this._textDocumentsAndEditors.$acceptDocumentsAndEditorsDelta({addedDocuments:i});this._onDidOpenNotebookDocument.fire(r.apiNotebook)}}if(e.value.addedEditors){for(const i of e.value.addedEditors){if(this._editors.has(i.id)){return}const n=b.revive(i.documentUri);const s=this._documents.get(n);if(s){this._createExtHostEditor(s,i.id,i)}}}if(e.value.removedEditors){for(const i of e.value.removedEditors){const n=this._editors.get(i);if(n){this._editors.delete(i);if(this._activeNotebookEditor?.id===n.id){this._activeNotebookEditor=void 0}}}}if(e.value.visibleEditors){this._visibleNotebookEditors=e.value.visibleEditors.map(n=>this._editors.get(n)).filter(n=>!!n);const i=new Set;this._visibleNotebookEditors.forEach(n=>i.add(n.id));for(const n of this._editors.values()){const s=i.has(n.id);n._acceptVisibility(s)}this._visibleNotebookEditors=[...this._editors.values()].map(n=>n).filter(n=>n.visible);this._onDidChangeVisibleNotebookEditors.fire(this.visibleNotebookEditors)}if(e.value.newActiveEditor===null){this._activeNotebookEditor=void 0}else if(e.value.newActiveEditor){const i=this._editors.get(e.value.newActiveEditor);if(!i){console.error(`FAILED to find active notebook editor ${e.value.newActiveEditor}`)}this._activeNotebookEditor=this._editors.get(e.value.newActiveEditor)}if(e.value.newActiveEditor!==void 0){this._onDidChangeActiveNotebookEditor.fire(this._activeNotebookEditor?.apiEditor)}}static _registerApiCommands(e){const i=q.String.with("notebookType","A notebook type");const n=new Te("vscode.executeDataToNotebook","_executeDataToNotebook","Invoke notebook serializer",[i,new q("data","Bytes to convert to data",r=>r instanceof Uint8Array,r=>ue.wrap(r))],new Se("Notebook Data",r=>Vr.to(r.value)));const s=new Te("vscode.executeNotebookToData","_executeNotebookToData","Invoke notebook serializer",[i,new q("NotebookData","Notebook data to convert to bytes",r=>true,r=>new Bi(Vr.from(r)))],new Se("Bytes",r=>r.buffer));e.registerApiCommand(n);e.registerApiCommand(s)}trace(e){this._logService.trace(`[Extension Host Notebook] ${e}`)}}class uF{constructor(e,i,n,s={timeout:1500,errors:3}){this._logService=e;this._notebooksAndEditors=i;this._mainThreadBulkEdits=n;this._thresholds=s;this._onWillSaveNotebookDocumentEvent=new hu}dispose(){}getOnWillSaveNotebookDocumentEvent(e){return(i,n,s)=>{const r=function o(a){i.call(n,a)};r.extension=e;return this._onWillSaveNotebookDocumentEvent.event(r,void 0,s)}}async $participateInSave(e,i,n){const s=b.revive(e);const r=this._notebooksAndEditors.getNotebookDocument(s);if(!r){throw new Error("Unable to resolve notebook document")}const o=[];await this._onWillSaveNotebookDocumentEvent.fireAsync({notebook:r.apiNotebook,reason:Ig.to(i)},n,async(l,c)=>{const u=Date.now();const d=await await Promise.resolve(l);if(Date.now()-u>this._thresholds.timeout){this._logService.warn("onWillSaveNotebookDocument-listener from extension",c.extension.identifier)}if(n.isCancellationRequested){return}if(d){if(d instanceof Da){o.push(d)}else{this._logService.warn("onWillSaveNotebookDocument-listener from extension",c.extension.identifier,"ignored due to invalid data")}}return});if(n.isCancellationRequested){return false}if(o.length===0){return true}const a={edits:[]};for(const l of o){const{edits:c}=un.from(l);a.edits=a.edits.concat(c)}return this._mainThreadBulkEdits.$tryApplyWorkspaceEdit(new Bi(a))}}class dF{constructor(e){this._notebooksAndEditors=e;this._onDidSaveNotebookDocument=new L;this.onDidSaveNotebookDocument=this._onDidSaveNotebookDocument.event;this._onDidChangeNotebookDocument=new L;this.onDidChangeNotebookDocument=this._onDidChangeNotebookDocument.event}$acceptModelChanged(e,i,n,s){const r=this._notebooksAndEditors.getNotebookDocument(b.revive(e));const o=r.acceptModelChanged(i.value,n,s);this._onDidChangeNotebookDocument.fire(o)}$acceptDirtyStateChanged(e,i){const n=this._notebooksAndEditors.getNotebookDocument(b.revive(e));n.acceptDirty(i)}$acceptModelSaved(e){const i=this._notebooksAndEditors.getNotebookDocument(b.revive(e));this._onDidSaveNotebookDocument.fire(i.apiNotebook)}}let e0=class tH{constructor(e,i){this._logService=e;this._notebooksAndEditors=i;this._onDidChangeNotebookEditorSelection=new L;this._onDidChangeNotebookEditorVisibleRanges=new L;this.onDidChangeNotebookEditorSelection=this._onDidChangeNotebookEditorSelection.event;this.onDidChangeNotebookEditorVisibleRanges=this._onDidChangeNotebookEditorVisibleRanges.event}$acceptEditorPropertiesChanged(e,i){this._logService.debug("ExtHostNotebook#$acceptEditorPropertiesChanged",e,i);const n=this._notebooksAndEditors.getEditorById(e);if(i.visibleRanges){n._acceptVisibleRanges(i.visibleRanges.ranges.map(Ls.to))}if(i.selections){n._acceptSelections(i.selections.selections.map(Ls.to))}if(i.visibleRanges){this._onDidChangeNotebookEditorVisibleRanges.fire({notebookEditor:n.apiEditor,visibleRanges:n.apiEditor.visibleRanges})}if(i.selections){this._onDidChangeNotebookEditorSelection.fire(Object.freeze({notebookEditor:n.apiEditor,selections:n.apiEditor.selections}))}}$acceptEditorViewColumns(e){for(const i in e){const n=this._notebooksAndEditors.getEditorById(i);n._acceptViewColumn(ai.to(e[i]))}}};e0=z([O(0,at)],e0);var xl;(function(t){t[t["Output"]=1]="Output";t[t["OutputItems"]=2]="OutputItems";t[t["ExecutionState"]=3]="ExecutionState"})(xl||(xl={}));const hF=100;var _k;(function(t){t[t["Disconnected"]=1]="Disconnected";t[t["Connected"]=2]="Connected";t[t["Initializing"]=3]="Initializing"})(_k||(_k={}));let t0=class iH{constructor(e,i,n,s,r){this._initData=i;this._extHostNotebook=n;this._commands=s;this._logService=r;this._activeExecutions=new Ft;this._activeNotebookExecutions=new Ft;this._kernelDetectionTask=new Map;this._kernelDetectionTaskHandlePool=0;this._kernelSourceActionProviders=new Map;this._kernelSourceActionProviderHandlePool=0;this._kernelData=new Map;this._handlePool=0;this._onDidChangeCellExecutionState=new L;this.onDidChangeNotebookCellExecutionState=this._onDidChangeCellExecutionState.event;this.id=0;this.variableStore={};this._proxy=e.getProxy(Y.MainThreadNotebookKernels);const o=new Te("notebook.selectKernel","_notebook.selectKernel","Trigger kernel picker for specified notebook editor widget",[new q("options","Select kernel options",l=>true,l=>{if(l&&"notebookEditor"in l&&"id"in l){const c=this._extHostNotebook.getIdByEditor(l.notebookEditor);return{id:l.id,extension:l.extension,notebookEditorId:c}}else if(l&&"notebookEditor"in l){const c=this._extHostNotebook.getIdByEditor(l.notebookEditor);if(c===void 0){throw new Error(`Cannot invoke 'notebook.selectKernel' for unrecognized notebook editor ${l.notebookEditor.notebook.uri.toString()}`)}if("skipIfAlreadySelected"in l){return{notebookEditorId:c,skipIfAlreadySelected:l.skipIfAlreadySelected}}return{notebookEditorId:c}}return l})],Se.Void);const a=new Te("vscode.executeNotebookVariableProvider","_executeNotebookVariableProvider","Execute notebook variable provider",[q.Uri],new Se("A promise that resolves to an array of variables",(l,c)=>{return l.map(u=>{return{variable:{name:u.name,value:u.value,expression:u.expression,type:u.type,language:u.language},hasNamedChildren:u.hasNamedChildren,indexedChildrenCount:u.indexedChildrenCount}})}));this._commands.registerApiCommand(o);this._commands.registerApiCommand(a)}createNotebookController(e,i,n,s,r,o){for(const H of this._kernelData.values()){if(H.controller.id===i&&Ze.equals(e.identifier,H.extensionId)){throw new Error(`notebook controller with id '${i}' ALREADY exist`)}}const a=this._handlePool++;const l=this;this._logService.trace(`NotebookController[${a}], CREATED by ${e.identifier.value}, ${i}`);const c=()=>console.warn(`NO execute handler from notebook controller '${f.id}' of extension: '${e.identifier}'`);let u=false;const d=new L;const p=new L;const f={id:zh(e.identifier,i),notebookType:n,extensionId:e.identifier,extensionLocation:e.extensionLocation,label:s||e.identifier.value,preloads:o?o.map(Ag.from):[]};let m=r??c;let v;let y;this._proxy.$addKernel(a,f).catch(H=>{console.log(H);u=true});let D=0;const I=()=>{if(u){return}const H=++D;Promise.resolve().then(()=>{if(H===D){this._proxy.$updateKernel(a,f)}})};const R=new Ft;const J={get id(){return i},get notebookType(){return f.notebookType},onDidChangeSelectedNotebooks:d.event,get label(){return f.label},set label(H){f.label=H??e.displayName??e.name;I()},get detail(){return f.detail??""},set detail(H){f.detail=H;I()},get description(){return f.description??""},set description(H){f.description=H;I()},get supportedLanguages(){return f.supportedLanguages},set supportedLanguages(H){f.supportedLanguages=H;I()},get supportsExecutionOrder(){return f.supportsExecutionOrder??false},set supportsExecutionOrder(H){f.supportsExecutionOrder=H;I()},get rendererScripts(){return f.preloads?f.preloads.map(Ag.to):[]},get executeHandler(){return m},set executeHandler(H){m=H??c},get interruptHandler(){return v},set interruptHandler(H){v=H;f.supportsInterrupt=Boolean(H);I()},set variableProvider(H){$(e,"notebookVariableProvider");y=H;f.hasVariableProvider=!!H;H?.onDidChangeVariables(Q=>l._proxy.$variablesUpdated(Q.uri));I()},get variableProvider(){return y},createNotebookCellExecution(H){if(u){throw new Error("notebook controller is DISPOSED")}if(!R.has(H.notebook.uri)){l._logService.trace(`NotebookController[${a}] NOT associated to notebook, associated to THESE notebooks:`,Array.from(R.keys()).map(Q=>Q.toString()));throw new Error(`notebook controller is NOT associated to notebook: ${H.notebook.uri.toString()}`)}return l._createNotebookCellExecution(H,zh(e.identifier,this.id))},createNotebookExecution(H){$(e,"notebookExecution");if(u){throw new Error("notebook controller is DISPOSED")}if(!R.has(H.uri)){l._logService.trace(`NotebookController[${a}] NOT associated to notebook, associated to THESE notebooks:`,Array.from(R.keys()).map(Q=>Q.toString()));throw new Error(`notebook controller is NOT associated to notebook: ${H.uri.toString()}`)}return l._createNotebookExecution(H,zh(e.identifier,this.id))},dispose:()=>{if(!u){this._logService.trace(`NotebookController[${a}], DISPOSED`);u=true;this._kernelData.delete(a);d.dispose();p.dispose();this._proxy.$removeKernel(a)}},updateNotebookAffinity(H,Q){if(Q===og.Hidden){$(e,"notebookControllerAffinityHidden")}l._proxy.$updateNotebookPriority(a,H.uri,Q)},onDidReceiveMessage:p.event,postMessage(H,Q){$(e,"notebookMessaging");return l._proxy.$postMessage(a,Q&&l._extHostNotebook.getIdByEditor(Q),H)},asWebviewUri(H){$(e,"notebookMessaging");return Mu(H,l._initData.remote)}};this._kernelData.set(a,{extensionId:e.identifier,controller:J,onDidReceiveMessage:p,onDidChangeSelection:d,associatedNotebooks:R});return J}getIdByController(e){for(const[i,n]of this._kernelData){if(n.controller===e){return zh(n.extensionId,e.id)}}return null}createNotebookControllerDetectionTask(e,i){const n=this._kernelDetectionTaskHandlePool++;const s=this;this._logService.trace(`NotebookControllerDetectionTask[${n}], CREATED by ${e.identifier.value}`);this._proxy.$addKernelDetectionTask(n,i);const r={dispose:()=>{this._kernelDetectionTask.delete(n);s._proxy.$removeKernelDetectionTask(n)}};this._kernelDetectionTask.set(n,r);return r}registerKernelSourceActionProvider(e,i,n){const s=this._kernelSourceActionProviderHandlePool++;const r=typeof n.onDidChangeNotebookKernelSourceActions==="function"?s:void 0;const o=this;this._kernelSourceActionProviders.set(s,n);this._logService.trace(`NotebookKernelSourceActionProvider[${s}], CREATED by ${e.identifier.value}`);this._proxy.$addKernelSourceActionProvider(s,s,i);let a;if(r!==void 0){a=n.onDidChangeNotebookKernelSourceActions(l=>this._proxy.$emitNotebookKernelSourceActionsChangeEvent(r))}return{dispose:()=>{this._kernelSourceActionProviders.delete(s);o._proxy.$removeKernelSourceActionProvider(s,s);a?.dispose()}}}async $provideKernelSourceActions(e,i){const n=this._kernelSourceActionProviders.get(e);if(n){const s=new Ie;const r=await n.provideNotebookKernelSourceActions(i);return(r??[]).map(o=>bw.from(o,this._commands.converter,s))}return[]}$acceptNotebookAssociation(e,i,n){const s=this._kernelData.get(e);if(s){const r=this._extHostNotebook.getNotebookDocument(b.revive(i));if(n){s.associatedNotebooks.set(r.uri,true)}else{s.associatedNotebooks.delete(r.uri)}this._logService.trace(`NotebookController[${e}] ASSOCIATE notebook`,r.uri.toString(),n);s.onDidChangeSelection.fire({selected:n,notebook:r.apiNotebook})}}async $executeCells(e,i,n){const s=this._kernelData.get(e);if(!s){return}const r=this._extHostNotebook.getNotebookDocument(b.revive(i));const o=[];for(const a of n){const l=r.getCell(a);if(l){o.push(l.apiCell)}}try{this._logService.trace(`NotebookController[${e}] EXECUTE cells`,r.uri.toString(),o.length);await s.controller.executeHandler.call(s.controller,o,r.apiNotebook,s.controller)}catch(a){this._logService.error(`NotebookController[${e}] execute cells FAILED`,a);console.error(a)}}async $cancelCells(e,i,n){const s=this._kernelData.get(e);if(!s){return}const r=this._extHostNotebook.getNotebookDocument(b.revive(i));if(s.controller.interruptHandler){await s.controller.interruptHandler.call(s.controller,r.apiNotebook)}else{for(const o of n){const a=r.getCell(o);if(a){this._activeExecutions.get(a.uri)?.cancel()}}}if(s.controller.interruptHandler){const o=this._activeNotebookExecutions.get(r.uri);this._activeNotebookExecutions.delete(r.uri);if(n.length&&Array.isArray(o)&&o.length){o.forEach(a=>a.dispose())}}}async $provideVariables(e,i,n,s,r,o,a){const l=this._kernelData.get(e);if(!l){return}const c=this._extHostNotebook.getNotebookDocument(b.revive(n));const u=l.controller.variableProvider;if(!u){return}let d=void 0;if(s!==void 0){d=this.variableStore[s];if(!d){return}}else{this.variableStore={}}const p=r==="named"?Td.Named:Td.Indexed;const f=u.provideVariables(c.apiNotebook,d,p,o,a);let m=0;for await(const v of f){if(a.isCancellationRequested){return}const y={id:this.id++,name:v.variable.name,value:v.variable.value,type:v.variable.type,interfaces:v.variable.interfaces,language:v.variable.language,expression:v.variable.expression,hasNamedChildren:v.hasNamedChildren,indexedChildrenCount:v.indexedChildrenCount,extensionId:l.extensionId.value};this.variableStore[y.id]=v.variable;this._proxy.$receiveVariable(i,y);if(m++>=hF){return}}}$acceptKernelMessageFromRenderer(e,i,n){const s=this._kernelData.get(e);if(!s){return}const r=this._extHostNotebook.getEditorById(i);s.onDidReceiveMessage.fire(Object.freeze({editor:r.apiEditor,message:n}))}$cellExecutionChanged(e,i,n){const s=this._extHostNotebook.getNotebookDocument(b.revive(e));const r=s.getCell(i);if(r){const o=n?vw.to(n):lc.Idle;if(o!==void 0){this._onDidChangeCellExecutionState.fire({cell:r.apiCell,state:o})}}}_createNotebookCellExecution(e,i){if(e.index<0){throw new Error("CANNOT execute cell that has been REMOVED from notebook")}const n=this._extHostNotebook.getNotebookDocument(e.notebook.uri);const s=n.getCellFromApiCell(e);if(!s){throw new Error("invalid cell")}if(this._activeExecutions.has(s.uri)){throw new Error(`duplicate execution for ${s.uri}`)}const r=new My(i,s,this._proxy);this._activeExecutions.set(s.uri,r);const o=r.onDidChangeState(()=>{if(r.state===Xn.Resolved){r.dispose();o.dispose();this._activeExecutions.delete(s.uri)}});return r.asApiObject()}_createNotebookExecution(e,i){const n=this._extHostNotebook.getNotebookDocument(e.uri);const s=e.getCells().find(a=>{const l=n.getCellFromApiCell(a);return l&&this._activeExecutions.has(l.uri)});if(s){throw new Error(`duplicate cell execution for ${s.document.uri}`)}if(this._activeNotebookExecutions.has(n.uri)){throw new Error(`duplicate notebook execution for ${n.uri}`)}const r=new Uy(i,n,this._proxy);const o=r.onDidChangeState(()=>{if(r.state===lr.Resolved){r.dispose();o.dispose();this._activeNotebookExecutions.delete(n.uri)}});this._activeNotebookExecutions.set(n.uri,[r,o]);return r.asApiObject()}};t0=z([O(4,at)],t0);var Xn;(function(t){t[t["Init"]=0]="Init";t[t["Started"]=1]="Started";t[t["Resolved"]=2]="Resolved"})(Xn||(Xn={}));class My extends Ee{static{this.HANDLE=0}get state(){return this._state}constructor(e,i,n){super();this._cell=i;this._proxy=n;this._handle=My.HANDLE++;this._onDidChangeState=new L;this.onDidChangeState=this._onDidChangeState.event;this._state=Xn.Init;this._tokenSource=this._register(new Ot);this._collector=new pF(10,s=>this.update(s));this._executionOrder=i.internalMetadata.executionOrder;this._proxy.$createExecution(this._handle,e,this._cell.notebook.uri,this._cell.handle)}cancel(){this._tokenSource.cancel()}async updateSoon(e){await this._collector.addItem(e)}async update(e){const i=Array.isArray(e)?e:[e];return this._proxy.$updateExecution(this._handle,new Bi(i))}verifyStateForOutput(){if(this._state===Xn.Init){throw new Error("Must call start before modifying cell output")}if(this._state===Xn.Resolved){throw new Error("Cannot modify cell output after calling resolve")}}cellIndexToHandle(e){let i=this._cell;if(e){i=this._cell.notebook.getCellFromApiCell(e)}if(!i){throw new Error("INVALID cell")}return i.handle}validateAndConvertOutputs(e){return e.map(i=>{const n=ng.ensureUniqueMimeTypes(i.items,true);if(n===i.items){return _o.from(i)}return _o.from({items:n,id:i.id,metadata:i.metadata})})}async updateOutputs(e,i,n){const s=this.cellIndexToHandle(i);const r=this.validateAndConvertOutputs(Sn(e));return this.updateSoon({editType:xl.Output,cellHandle:s,append:n,outputs:r})}async updateOutputItems(e,i,n){e=ng.ensureUniqueMimeTypes(Sn(e),true);return this.updateSoon({editType:xl.OutputItems,items:e.map(vc.from),outputId:i.id,append:n})}asApiObject(){const e=this;const i={get token(){return e._tokenSource.token},get cell(){return e._cell.apiCell},get executionOrder(){return e._executionOrder},set executionOrder(n){e._executionOrder=n;e.update([{editType:xl.ExecutionState,executionOrder:e._executionOrder}])},start(n){if(e._state===Xn.Resolved||e._state===Xn.Started){throw new Error("Cannot call start again")}e._state=Xn.Started;e._onDidChangeState.fire();e.update({editType:xl.ExecutionState,runStartTime:n})},end(n,s,r){if(e._state===Xn.Resolved){throw new Error("Cannot call resolve twice")}e._state=Xn.Resolved;e._onDidChangeState.fire();e._collector.flush();const o=fF(r);e._proxy.$completeExecution(e._handle,new Bi({runEndTime:s,lastRunSuccess:n,error:o}))},clearOutput(n){e.verifyStateForOutput();return e.updateOutputs([],n,false)},appendOutput(n,s){e.verifyStateForOutput();return e.updateOutputs(n,s,true)},replaceOutput(n,s){e.verifyStateForOutput();return e.updateOutputs(n,s,false)},appendOutputItems(n,s){e.verifyStateForOutput();return e.updateOutputItems(n,s,true)},replaceOutputItems(n,s){e.verifyStateForOutput();return e.updateOutputItems(n,s,false)}};return Object.freeze(i)}}function fF(t){const e=s=>s?{startLineNumber:s.start.line,startColumn:s.start.character,endLineNumber:s.end.line,endColumn:s.end.character}:void 0;const i=s=>({uri:s.uri,position:s.position,label:s.label});const n=t?{name:t.name,message:t.message,stack:t.stack instanceof Array?t.stack.map(s=>i(s)):t.stack,location:e(t.location),uri:t.uri}:void 0;return n}var lr;(function(t){t[t["Init"]=0]="Init";t[t["Started"]=1]="Started";t[t["Resolved"]=2]="Resolved"})(lr||(lr={}));class Uy extends Ee{static{this.HANDLE=0}get state(){return this._state}constructor(e,i,n){super();this._notebook=i;this._proxy=n;this._handle=Uy.HANDLE++;this._onDidChangeState=new L;this.onDidChangeState=this._onDidChangeState.event;this._state=lr.Init;this._tokenSource=this._register(new Ot);this._proxy.$createNotebookExecution(this._handle,e,this._notebook.uri)}cancel(){this._tokenSource.cancel()}asApiObject(){const e={start:()=>{if(this._state===lr.Resolved||this._state===lr.Started){throw new Error("Cannot call start again")}this._state=lr.Started;this._onDidChangeState.fire();this._proxy.$beginNotebookExecution(this._handle)},end:()=>{if(this._state===lr.Resolved){throw new Error("Cannot call resolve twice")}this._state=lr.Resolved;this._onDidChangeState.fire();this._proxy.$completeNotebookExecution(this._handle)}};return Object.freeze(e)}}class pF{constructor(e,i){this.delay=e;this.callback=i;this.batch=[];this.startedTimer=Date.now()}addItem(e){this.batch.push(e);if(!this.currentDeferred){this.currentDeferred=new Fs;this.startedTimer=Date.now();Ts(this.delay).then(()=>{return this.flush()})}if(Date.now()-this.startedTimer>this.delay){return this.flush()}return this.currentDeferred.p}flush(){if(this.batch.length===0||!this.currentDeferred){return Promise.resolve()}const e=this.currentDeferred;this.currentDeferred=void 0;const i=this.batch;this.batch=[];return this.callback(i).finally(()=>e.complete())}}function zh(t,e){return`${t.value}/${e}`}class gF{constructor(e,i){this._extHostNotebook=i;this._rendererMessageEmitters=new Map;this.proxy=e.getProxy(Y.MainThreadNotebookRenderers)}$postRendererMessage(e,i,n){const s=this._extHostNotebook.getEditorById(e);this._rendererMessageEmitters.get(i)?.fire({editor:s.apiEditor,message:n})}createRendererMessaging(e,i){if(!e.contributes?.notebookRenderer?.some(s=>s.id===i)){throw new Error(`Extensions may only call createRendererMessaging() for renderers they contribute (got ${i})`)}const n={onDidReceiveMessage:(s,r,o)=>{return this.getOrCreateEmitterFor(i).event(s,r,o)},postMessage:(s,r)=>{if(sh.apiEditorsToExtHost.has(s)){[s,r]=[r,s]}const o=r&&sh.apiEditorsToExtHost.get(r);return this.proxy.$postMessage(o?.id,i,s)}};return n}getOrCreateEmitterFor(e){let i=this._rendererMessageEmitters.get(e);if(i){return i}i=new L({onDidRemoveLastListener:()=>{i?.dispose();this._rendererMessageEmitters.delete(e)}});this._rendererMessageEmitters.set(e,i);return i}}class mF{constructor(e){this.handlers=new Map;this.proxy=e.getProxy(Y.MainThreadProfileContentHandlers)}registerProfileContentHandler(e,i,n){$(e,"profileContentHandlers");if(this.handlers.has(i)){throw new Error(`Handler with id '${i}' already registered`)}this.handlers.set(i,n);this.proxy.$registerProfileContentHandler(i,n.name,n.description,e.identifier.value);return ge(()=>{this.handlers.delete(i);this.proxy.$unregisterProfileContentHandler(i)})}async $saveProfile(e,i,n,s){const r=this.handlers.get(e);if(!r){throw new Error(`Unknown handler with id: ${e}`)}return r.saveProfile(i,n,s)}async $readProfile(e,i,n){const s=this.handlers.get(e);if(!s){throw new Error(`Unknown handler with id: ${e}`)}return s.readProfile(tt(i)?i:b.revive(i),n)}}function d5(t){return(e,i,n)=>{let s=null;let r=null;if(typeof n.value==="function"){s="value";r=n.value}else if(typeof n.get==="function"){s="get";r=n.get}if(!r||typeof i==="symbol"){throw new Error("not supported")}n[s]=t(r,i)}}function h5(t,e,i){return d5((n,s)=>{const r=`$debounce$${s}`;const o=`$debounce$result$${s}`;return function(...a){if(!this[o]){this[o]=void 0}clearTimeout(this[r]);this[r]=setTimeout(()=>{n.apply(this,a);this[o]=void 0},t)}})}function _F(t,e,i){return d5((n,s)=>{const r=`$throttle$timer$${s}`;const o=`$throttle$result$${s}`;const a=`$throttle$lastRun$${s}`;const l=`$throttle$pending$${s}`;return function(...c){if(!this[o]){this[o]=i?i():void 0}if(this[a]===null||this[a]===void 0){this[a]=-Number.MAX_VALUE}if(e){this[o]=e(this[o],...c)}if(this[l]){return}const u=this[a]+t;if(u<=Date.now()){this[a]=Date.now();n.apply(this,[this[o]]);this[o]=i?i():void 0}else{this[l]=true;this[r]=setTimeout(()=>{this[l]=false;this[a]=Date.now();n.apply(this,[this[o]]);this[o]=i?i():void 0},u-Date.now())}}})}class vF{constructor(e){this._handles=0;this._mapHandleToCancellationSource=new Map;this._proxy=e}async withProgress(e,i,n){const s=this._handles++;const{title:r,location:o,cancellable:a}=i;const l={label:e.displayName||e.name,id:e.identifier.value};this._proxy.$startProgress(s,{location:mw.from(o),title:r,source:l,cancellable:a},!e.isUnderDevelopment?e.identifier.value:void 0).catch(Pk);return this._withProgress(s,n,!!a)}_withProgress(e,i,n){let s;if(n){s=new Ot;this._mapHandleToCancellationSource.set(e,s)}const r=a=>{this._proxy.$progressEnd(a);this._mapHandleToCancellationSource.delete(a);s?.dispose()};let o;try{o=i(new i0(this._proxy,e),n&&s?s.token:bt.None)}catch(a){r(e);throw a}o.then(a=>r(e),a=>r(e));return o}$acceptProgressCanceled(e){const i=this._mapHandleToCancellationSource.get(e);if(i){i.cancel();this._mapHandleToCancellationSource.delete(e)}}}function wF(t,e){t.message=e.message;if(typeof e.increment==="number"){if(typeof t.increment==="number"){t.increment+=e.increment}else{t.increment=e.increment}}return t}class i0 extends $0{constructor(e,i){super(n=>this.throttledReport(n));this._proxy=e;this._handle=i}throttledReport(e){this._proxy.$progressReport(this._handle,e)}}i0.__decorator=z([_F(100,(t,e)=>wF(t,e),()=>Object.create(null))],i0.prototype,"throttledReport",null);class $y{static{this.handlePool=0}constructor(e,i){this.uriTransformer=i;this.providers=new Map;this.proxy=e.getProxy(Y.MainThreadQuickDiff)}$provideOriginalResource(e,i,n){const s=b.revive(i);const r=this.providers.get(e);if(!r){return Promise.resolve(null)}return Ci(()=>r.provideOriginalResource(s,n)).then(o=>o||null)}registerQuickDiffProvider(e,i,n,s,r,o){const a=$y.handlePool++;this.providers.set(a,n);const l=Ze.toKey(e.identifier);this.proxy.$registerQuickDiffProvider(a,uc.from(i,this.uriTransformer),`${l}.${s}`,r,o);return{dispose:()=>{this.proxy.$unregisterQuickDiffProvider(a);this.providers.delete(a)}}}}function bF(t,e,i){const n=t.getProxy(Y.MainThreadQuickOpen);class s{constructor(f,m){this._sessions=new Map;this._instances=0;this._workspace=f;this._commands=m}showQuickPick(f,m,v,y=bt.None){this._onDidSelectItem=void 0;const D=Promise.resolve(m);const I=++this._instances;const R=n.$show(I,{title:v?.title,placeHolder:v?.placeHolder,matchOnDescription:v?.matchOnDescription,matchOnDetail:v?.matchOnDetail,ignoreFocusLost:v?.ignoreFocusOut,canPickMany:v?.canPickMany},y);const J={};const H=R.then(()=>J);return Promise.race([H,D]).then(Q=>{if(Q===J){return void 0}const ne=dt(f,"quickPickItemTooltip");return D.then(te=>{const le=[];for(let Ce=0;Ce<te.length;Ce++){const Je=te[Ce];if(typeof Je==="string"){le.push({label:Je,handle:Ce})}else if(Je.kind===Cd.Separator){le.push({type:"separator",label:Je.label})}else{if(Je.tooltip&&!ne){console.warn(`Extension '${f.identifier.value}' uses a tooltip which is proposed API that is only available when running out of dev or with the following command line switch: --enable-proposed-api ${f.identifier.value}`)}const We=Je.iconPath?c(Je.iconPath):void 0;le.push({label:Je.label,iconPath:We?.iconPath,iconClass:We?.iconClass,description:Je.description,detail:Je.detail,picked:Je.picked,alwaysShow:Je.alwaysShow,tooltip:ne?Pe.fromStrict(Je.tooltip):void 0,handle:Ce})}}if(v&&typeof v.onDidSelectItem==="function"){this._onDidSelectItem=Ce=>{v.onDidSelectItem(te[Ce])}}n.$setItems(I,le);return R.then(Ce=>{if(typeof Ce==="number"){return te[Ce]}else if(Array.isArray(Ce)){return Ce.map(Je=>te[Je])}return void 0})})}).then(void 0,Q=>{if(fo(Q)){return void 0}n.$setError(I,Q);return Promise.reject(Q)})}$onItemSelected(f){this._onDidSelectItem?.(f)}showInput(f,m=bt.None){this._validateInput=f?.validateInput;return n.$input(f,typeof this._validateInput==="function",m).then(void 0,v=>{if(fo(v)){return void 0}return Promise.reject(v)})}async $validateInput(f){if(!this._validateInput){return}const m=await this._validateInput(f);if(!m||typeof m==="string"){return m}let v;switch(m.severity){case Ol.Info:v=jt.Info;break;case Ol.Warning:v=jt.Warning;break;case Ol.Error:v=jt.Error;break;default:v=m.message?jt.Error:jt.Ignore;break}return{content:m.message,severity:v}}async showWorkspaceFolderPick(f,m=bt.None){const v=await this._commands.executeCommand("_workbench.pickWorkspaceFolder",[f]);if(!v){return void 0}const y=await this._workspace.getWorkspaceFolders2();if(!y){return void 0}return y.find(D=>D.uri.toString()===v.uri.toString())}createQuickPick(f){const m=new u(f,()=>this._sessions.delete(m._id));this._sessions.set(m._id,m);return m}createInputBox(f){const m=new d(f,()=>this._sessions.delete(m._id));this._sessions.set(m._id,m);return m}$onDidChangeValue(f,m){const v=this._sessions.get(f);v?._fireDidChangeValue(m)}$onDidAccept(f){const m=this._sessions.get(f);m?._fireDidAccept()}$onDidChangeActive(f,m){const v=this._sessions.get(f);if(v instanceof u){v._fireDidChangeActive(m)}}$onDidChangeSelection(f,m){const v=this._sessions.get(f);if(v instanceof u){v._fireDidChangeSelection(m)}}$onDidTriggerButton(f,m){const v=this._sessions.get(f);v?._fireDidTriggerButton(m)}$onDidTriggerItemButton(f,m,v){const y=this._sessions.get(f);if(y instanceof u){y._fireDidTriggerItemButton(m,v)}}$onDidHide(f){const m=this._sessions.get(f);m?._fireDidHide()}}class r{static{this._nextId=1}constructor(f,m){this._extension=f;this._onDidDispose=m;this._id=u._nextId++;this._visible=false;this._expectingHide=false;this._enabled=true;this._busy=false;this._ignoreFocusOut=true;this._value="";this._valueSelection=void 0;this._buttons=[];this._handlesToButtons=new Map;this._onDidAcceptEmitter=new L;this._onDidChangeValueEmitter=new L;this._onDidTriggerButtonEmitter=new L;this._onDidHideEmitter=new L;this._pendingUpdate={id:this._id};this._disposed=false;this._disposables=[this._onDidTriggerButtonEmitter,this._onDidHideEmitter,this._onDidAcceptEmitter,this._onDidChangeValueEmitter];this.onDidChangeValue=this._onDidChangeValueEmitter.event;this.onDidAccept=this._onDidAcceptEmitter.event;this.onDidTriggerButton=this._onDidTriggerButtonEmitter.event;this.onDidHide=this._onDidHideEmitter.event}get title(){return this._title}set title(f){this._title=f;this.update({title:f})}get step(){return this._steps}set step(f){this._steps=f;this.update({step:f})}get totalSteps(){return this._totalSteps}set totalSteps(f){this._totalSteps=f;this.update({totalSteps:f})}get enabled(){return this._enabled}set enabled(f){this._enabled=f;this.update({enabled:f})}get busy(){return this._busy}set busy(f){this._busy=f;this.update({busy:f})}get ignoreFocusOut(){return this._ignoreFocusOut}set ignoreFocusOut(f){this._ignoreFocusOut=f;this.update({ignoreFocusOut:f})}get value(){return this._value}set value(f){this._value=f;this.update({value:f})}get valueSelection(){return this._valueSelection}set valueSelection(f){this._valueSelection=f;this.update({valueSelection:f})}get placeholder(){return this._placeholder}set placeholder(f){this._placeholder=f;this.update({placeholder:f})}get buttons(){return this._buttons}set buttons(f){const m=dt(this._extension,"quickInputButtonLocation");if(!m&&f.some(v=>v.location)){console.warn(`Extension '${this._extension.identifier.value}' uses a button location which is proposed API that is only available when running out of dev or with the following command line switch: --enable-proposed-api ${this._extension.identifier.value}`)}this._buttons=f.slice();this._handlesToButtons.clear();f.forEach((v,y)=>{const D=v===Id.Back?-1:y;this._handlesToButtons.set(D,v)});this.update({buttons:f.map((v,y)=>{return{...c(v.iconPath),tooltip:v.tooltip,handle:v===Id.Back?-1:y,location:m?v.location:void 0}})})}show(){this._visible=true;this._expectingHide=true;this.update({visible:true})}hide(){this._visible=false;this.update({visible:false})}_fireDidAccept(){this._onDidAcceptEmitter.fire()}_fireDidChangeValue(f){this._value=f;this._onDidChangeValueEmitter.fire(f)}_fireDidTriggerButton(f){const m=this._handlesToButtons.get(f);if(m){this._onDidTriggerButtonEmitter.fire(m)}}_fireDidHide(){if(this._expectingHide){this._expectingHide=this._visible;this._onDidHideEmitter.fire()}}dispose(){if(this._disposed){return}this._disposed=true;this._fireDidHide();this._disposables=yr(this._disposables);if(this._updateTimeout){clearTimeout(this._updateTimeout);this._updateTimeout=void 0}this._onDidDispose();n.$dispose(this._id)}update(f){if(this._disposed){return}for(const m of Object.keys(f)){const v=f[m];this._pendingUpdate[m]=v===void 0?null:v}if("visible"in this._pendingUpdate){if(this._updateTimeout){clearTimeout(this._updateTimeout);this._updateTimeout=void 0}this.dispatchUpdate()}else if(this._visible&&!this._updateTimeout){this._updateTimeout=setTimeout(()=>{this._updateTimeout=void 0;this.dispatchUpdate()},0)}}dispatchUpdate(){n.$createOrUpdate(this._pendingUpdate);this._pendingUpdate={id:this._id}}}function o(p){if(p instanceof Vi){return{id:p.id}}const f=l(p);const m=a(p);return{dark:typeof f==="string"?b.file(f):f,light:typeof m==="string"?b.file(m):m}}function a(p){return typeof p==="object"&&"light"in p?p.light:p}function l(p){return typeof p==="object"&&"dark"in p?p.dark:p}function c(p){const f=o(p);let m;let v;if("id"in f){v=Zt.asClassName(f)}else{m=f}return{iconPath:m,iconClass:v}}class u extends r{constructor(f,m){super(f,m);this._items=[];this._handlesToItems=new Map;this._itemsToHandles=new Map;this._canSelectMany=false;this._matchOnDescription=true;this._matchOnDetail=true;this._sortByLabel=true;this._keepScrollPosition=false;this._activeItems=[];this._onDidChangeActiveEmitter=new L;this._selectedItems=[];this._onDidChangeSelectionEmitter=new L;this._onDidTriggerItemButtonEmitter=new L;this.onDidChangeActive=this._onDidChangeActiveEmitter.event;this.onDidChangeSelection=this._onDidChangeSelectionEmitter.event;this.onDidTriggerItemButton=this._onDidTriggerItemButtonEmitter.event;this._disposables.push(this._onDidChangeActiveEmitter,this._onDidChangeSelectionEmitter,this._onDidTriggerItemButtonEmitter);this.update({type:"quickPick"})}get items(){return this._items}set items(f){this._items=f.slice();this._handlesToItems.clear();this._itemsToHandles.clear();f.forEach((y,D)=>{this._handlesToItems.set(D,y);this._itemsToHandles.set(y,D)});const m=dt(this._extension,"quickPickItemTooltip");const v=[];for(let y=0;y<f.length;y++){const D=f[y];if(D.kind===Cd.Separator){v.push({type:"separator",label:D.label})}else{if(D.tooltip&&!m){console.warn(`Extension '${this._extension.identifier.value}' uses a tooltip which is proposed API that is only available when running out of dev or with the following command line switch: --enable-proposed-api ${this._extension.identifier.value}`)}const I=D.iconPath?c(D.iconPath):void 0;v.push({handle:y,label:D.label,iconPath:I?.iconPath,iconClass:I?.iconClass,description:D.description,detail:D.detail,picked:D.picked,alwaysShow:D.alwaysShow,tooltip:m?Pe.fromStrict(D.tooltip):void 0,buttons:D.buttons?.map((R,J)=>{return{...c(R.iconPath),tooltip:R.tooltip,handle:J}})})}}this.update({items:v})}get canSelectMany(){return this._canSelectMany}set canSelectMany(f){this._canSelectMany=f;this.update({canSelectMany:f})}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(f){this._matchOnDescription=f;this.update({matchOnDescription:f})}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(f){this._matchOnDetail=f;this.update({matchOnDetail:f})}get sortByLabel(){return this._sortByLabel}set sortByLabel(f){this._sortByLabel=f;this.update({sortByLabel:f})}get keepScrollPosition(){return this._keepScrollPosition}set keepScrollPosition(f){this._keepScrollPosition=f;this.update({keepScrollPosition:f})}get activeItems(){return this._activeItems}set activeItems(f){this._activeItems=f.filter(m=>this._itemsToHandles.has(m));this.update({activeItems:this._activeItems.map(m=>this._itemsToHandles.get(m))})}get selectedItems(){return this._selectedItems}set selectedItems(f){this._selectedItems=f.filter(m=>this._itemsToHandles.has(m));this.update({selectedItems:this._selectedItems.map(m=>this._itemsToHandles.get(m))})}_fireDidChangeActive(f){const m=ei(f.map(v=>this._handlesToItems.get(v)));this._activeItems=m;this._onDidChangeActiveEmitter.fire(m)}_fireDidChangeSelection(f){const m=ei(f.map(v=>this._handlesToItems.get(v)));this._selectedItems=m;this._onDidChangeSelectionEmitter.fire(m)}_fireDidTriggerItemButton(f,m){const v=this._handlesToItems.get(f);if(!v||!v.buttons||!v.buttons.length){return}const y=v.buttons[m];if(y){this._onDidTriggerItemButtonEmitter.fire({button:y,item:v})}}}class d extends r{constructor(f,m){super(f,m);this._password=false;this.update({type:"inputBox"})}get password(){return this._password}set password(f){this._password=f;this.update({password:f})}get prompt(){return this._prompt}set prompt(f){this._prompt=f;this.update({prompt:f})}get validationMessage(){return this._validationMessage}set validationMessage(f){this._validationMessage=f;if(!f){this.update({validationMessage:void 0,severity:jt.Ignore})}else if(typeof f==="string"){this.update({validationMessage:f,severity:jt.Error})}else{this.update({validationMessage:f.message,severity:f.severity??jt.Error})}}}return new s(e,i)}const vk=new Fn(()=>{const t=new Intl.Collator(void 0,{numeric:true,sensitivity:"base"});return{collator:t,collatorIsNumeric:t.resolvedOptions().numeric}});function yF(t,e,i=false){const n=t||"";const s=e||"";const r=vk.value.collator.compare(n,s);if(vk.value.collatorIsNumeric&&r===0&&n!==s){return n<s?-1:1}return r}function xF(t,e,i=false){if(!i){t=t&&t.toLowerCase();e=e&&e.toLowerCase()}if(t===e){return 0}return t<e?-1:1}function Sf(t,e,i=false){const n=t.split(os);const s=e.split(os);const r=n.length-1;const o=s.length-1;let a,l;for(let c=0;;c++){a=r===c;l=o===c;if(a&&l){return yF(n[c],s[c],i)}else if(a){return-1}else if(l){return 1}const u=xF(n[c],s[c],i);if(u!==0){return u}}}var n0;function wk(t){return t instanceof b}function EF(t,e){if(t.scheme===ae.file&&e.scheme===ae.file&&Er){return t.toString()===e.toString()}return t.toString().toLowerCase()===e.toString().toLowerCase()}function K1(t){if(!t){return void 0}else if(typeof t.iconPath==="string"){return b.file(t.iconPath)}else if(b.isUri(t.iconPath)){return t.iconPath}else if(Zt.isThemeIcon(t.iconPath)){return t.iconPath}else{return void 0}}function ba(t){if(!t){return void 0}else if(b.isUri(t)){return t}else if(Zt.isThemeIcon(t)){return t}else{const e=t;return{light:e.light,dark:e.dark}}}function SF(t){const e=ba(t.authorIcon);const i=t.references?.map(n=>({...n,icon:ba(n.icon)}));return{...t,authorIcon:e,references:i}}function Q1(t){return t?{...t,icon:ba(t.icon)}:void 0}function J1(t,e){if(!t.iconPath&&!e.iconPath){return 0}else if(!t.iconPath){return-1}else if(!e.iconPath){return 1}const i=typeof t.iconPath==="string"?t.iconPath:b.isUri(t.iconPath)?t.iconPath.fsPath:t.iconPath.id;const n=typeof e.iconPath==="string"?e.iconPath:b.isUri(e.iconPath)?e.iconPath.fsPath:e.iconPath.id;return Sf(i,n)}function DF(t,e){let i=0;if(t.strikeThrough!==e.strikeThrough){return t.strikeThrough?1:-1}if(t.faded!==e.faded){return t.faded?1:-1}if(t.tooltip!==e.tooltip){return(t.tooltip||"").localeCompare(e.tooltip||"")}i=J1(t,e);if(i!==0){return i}if(t.light&&e.light){i=J1(t.light,e.light)}else if(t.light){return 1}else if(e.light){return-1}if(i!==0){return i}if(t.dark&&e.dark){i=J1(t.dark,e.dark)}else if(t.dark){return 1}else if(e.dark){return-1}return i}function kF(t,e){if(t.command!==e.command){return t.command<e.command?-1:1}if(t.title!==e.title){return t.title<e.title?-1:1}if(t.tooltip!==e.tooltip){if(t.tooltip!==void 0&&e.tooltip!==void 0){return t.tooltip<e.tooltip?-1:1}else if(t.tooltip!==void 0){return 1}else if(e.tooltip!==void 0){return-1}}if(t.arguments===e.arguments){return 0}else if(!t.arguments){return-1}else if(!e.arguments){return 1}else if(t.arguments.length!==e.arguments.length){return t.arguments.length-e.arguments.length}for(let i=0;i<t.arguments.length;i++){const n=t.arguments[i];const s=e.arguments[i];if(n===s){continue}if(wk(n)&&wk(s)&&EF(n,s)){continue}return n<s?-1:1}return 0}function bk(t,e){let i=Sf(t.resourceUri.fsPath,e.resourceUri.fsPath,true);if(i!==0){return i}if(t.command&&e.command){i=kF(t.command,e.command)}else if(t.command){return 1}else if(e.command){return-1}if(i!==0){return i}if(t.decorations&&e.decorations){i=DF(t.decorations,e.decorations)}else if(t.decorations){return 1}else if(e.decorations){return-1}if(i!==0){return i}if(t.multiFileDiffEditorModifiedUri&&e.multiFileDiffEditorModifiedUri){i=Sf(t.multiFileDiffEditorModifiedUri.fsPath,e.multiFileDiffEditorModifiedUri.fsPath,true)}else if(t.multiFileDiffEditorModifiedUri){return 1}else if(e.multiFileDiffEditorModifiedUri){return-1}if(i!==0){return i}if(t.multiDiffEditorOriginalUri&&e.multiDiffEditorOriginalUri){i=Sf(t.multiDiffEditorOriginalUri.fsPath,e.multiDiffEditorOriginalUri.fsPath,true)}else if(t.multiDiffEditorOriginalUri){return 1}else if(e.multiDiffEditorOriginalUri){return-1}return i}function IF(t,e){for(let i=0;i<t.length;i++){if(t[i]!==e[i]){return false}}return true}function CF(t,e){return t.command===e.command&&t.title===e.title&&t.tooltip===e.tooltip&&(t.arguments&&e.arguments?IF(t.arguments,e.arguments):t.arguments===e.arguments)}function TF(t,e){return Is(t,e,CF)}class PF{#e;#t;get value(){return this._value}set value(e){e=e??"";this.#e.$setInputBoxValue(this._sourceControlHandle,e);this.updateValue(e)}get onDidChange(){return this._onDidChange.event}get placeholder(){return this._placeholder}set placeholder(e){this.#e.$setInputBoxPlaceholder(this._sourceControlHandle,e);this._placeholder=e}get validateInput(){$(this._extension,"scmValidation");return this._validateInput}set validateInput(e){$(this._extension,"scmValidation");if(e&&typeof e!=="function"){throw new Error(`[${this._extension.identifier.value}]: Invalid SCM input box validation function`)}this._validateInput=e;this.#e.$setValidationProviderIsEnabled(this._sourceControlHandle,!!e)}get enabled(){return this._enabled}set enabled(e){e=!!e;if(this._enabled===e){return}this._enabled=e;this.#e.$setInputBoxEnablement(this._sourceControlHandle,e)}get visible(){return this._visible}set visible(e){e=!!e;if(this._visible===e){return}this._visible=e;this.#e.$setInputBoxVisibility(this._sourceControlHandle,e)}get document(){$(this._extension,"scmTextDocument");return this.#t.getDocument(this._documentUri)}constructor(e,i,n,s,r){this._extension=e;this._sourceControlHandle=s;this._documentUri=r;this._value="";this._onDidChange=new L;this._placeholder="";this._enabled=true;this._visible=true;this.#t=i;this.#e=n}showValidationMessage(e,i){$(this._extension,"scmValidation");this.#e.$showValidationMessage(this._sourceControlHandle,e,i)}$onInputBoxValueChange(e){this.updateValue(e)}updateValue(e){this._value=e;this._onDidChange.fire(e)}}class Hy{static{this._handlePool=0}get disposed(){return this._disposed}get id(){return this._id}get label(){return this._label}set label(e){this._label=e;this._proxy.$updateGroupLabel(this._sourceControlHandle,this.handle,e)}get contextValue(){return this._contextValue}set contextValue(e){this._contextValue=e;this._proxy.$updateGroup(this._sourceControlHandle,this.handle,this.features)}get hideWhenEmpty(){return this._hideWhenEmpty}set hideWhenEmpty(e){this._hideWhenEmpty=e;this._proxy.$updateGroup(this._sourceControlHandle,this.handle,this.features)}get features(){return{contextValue:this.contextValue,hideWhenEmpty:this.hideWhenEmpty}}get resourceStates(){return[...this._resourceStates]}set resourceStates(e){this._resourceStates=[...e];this._onDidUpdateResourceStates.fire()}constructor(e,i,n,s,r,o,a){this._proxy=e;this._commands=i;this._sourceControlHandle=n;this._id=s;this._label=r;this.multiDiffEditorEnableViewChanges=o;this._extension=a;this._resourceHandlePool=0;this._resourceStates=[];this._resourceStatesMap=new Map;this._resourceStatesCommandsMap=new Map;this._resourceStatesDisposablesMap=new Map;this._onDidUpdateResourceStates=new L;this.onDidUpdateResourceStates=this._onDidUpdateResourceStates.event;this._disposed=false;this._onDidDispose=new L;this.onDidDispose=this._onDidDispose.event;this._handlesSnapshot=[];this._resourceSnapshot=[];this._contextValue=void 0;this._hideWhenEmpty=void 0;this.handle=Hy._handlePool++}getResourceState(e){return this._resourceStatesMap.get(e)}$executeResourceCommand(e,i){const n=this._resourceStatesCommandsMap.get(e);if(!n){return Promise.resolve(void 0)}return Ci(()=>this._commands.executeCommand(n.command,...n.arguments||[],i))}_takeResourceStateSnapshot(){const e=[...this._resourceStates].sort(bk);const i=Rk(this._resourceSnapshot,e,bk);const n=i.map(o=>{const a=o.toInsert.map(l=>{const c=this._resourceHandlePool++;this._resourceStatesMap.set(c,l);const u=l.resourceUri;let d;if(l.command){if(l.command.command==="vscode.open"||l.command.command==="vscode.diff"||l.command.command==="vscode.changes"){const te=new Ie;d=this._commands.converter.toInternal(l.command,te);this._resourceStatesDisposablesMap.set(c,te)}else{this._resourceStatesCommandsMap.set(c,l.command)}}const p=dt(this._extension,"scmMultiDiffEditor");const f=p?l.multiDiffEditorOriginalUri:void 0;const m=p?l.multiFileDiffEditorModifiedUri:void 0;const v=K1(l.decorations);const y=l.decorations&&K1(l.decorations.light)||v;const D=l.decorations&&K1(l.decorations.dark)||v;const I=[y,D];const R=l.decorations&&l.decorations.tooltip||"";const J=l.decorations&&!!l.decorations.strikeThrough;const H=l.decorations&&!!l.decorations.faded;const Q=l.contextValue||"";const ne=[c,u,I,R,J,H,Q,d,f,m];return{rawResource:ne,handle:c}});return{start:o.start,deleteCount:o.deleteCount,toInsert:a}});const s=n.map(({start:o,deleteCount:a,toInsert:l})=>[o,a,l.map(c=>c.rawResource)]);const r=n.reverse();for(const{start:o,deleteCount:a,toInsert:l}of r){const c=l.map(d=>d.handle);const u=this._handlesSnapshot.splice(o,a,...c);for(const d of u){this._resourceStatesMap.delete(d);this._resourceStatesCommandsMap.delete(d);this._resourceStatesDisposablesMap.get(d)?.dispose();this._resourceStatesDisposablesMap.delete(d)}}this._resourceSnapshot=e;return s}dispose(){this._disposed=true;this._onDidDispose.fire()}}class Ra{static{this._handlePool=0}#e;get id(){return this._id}get label(){return this._label}get rootUri(){return this._rootUri}get inputBox(){return this._inputBox}get count(){return this._count}set count(e){if(this._count===e){return}this._count=e;this.#e.$updateSourceControl(this.handle,{count:e})}get quickDiffProvider(){return this._quickDiffProvider}set quickDiffProvider(e){this._quickDiffProvider=e;let i=void 0;if(dt(this._extension,"quickDiffProvider")){i=e?.label}this.#e.$updateSourceControl(this.handle,{hasQuickDiffProvider:!!e,quickDiffLabel:i})}get secondaryQuickDiffProvider(){$(this._extension,"quickDiffProvider");return this._secondaryQuickDiffProvider}set secondaryQuickDiffProvider(e){$(this._extension,"quickDiffProvider");this._secondaryQuickDiffProvider=e;const i=e?.label;this.#e.$updateSourceControl(this.handle,{hasSecondaryQuickDiffProvider:!!e,secondaryQuickDiffLabel:i})}get historyProvider(){$(this._extension,"scmHistoryProvider");return this._historyProvider}set historyProvider(e){$(this._extension,"scmHistoryProvider");this._historyProvider=e;this._historyProviderDisposable.value=new Ie;this.#e.$updateSourceControl(this.handle,{hasHistoryProvider:!!e});if(e){this._historyProviderDisposable.value.add(e.onDidChangeCurrentHistoryItemRefs(()=>{const i=Q1(e?.currentHistoryItemRef);const n=Q1(e?.currentHistoryItemRemoteRef);const s=Q1(e?.currentHistoryItemBaseRef);this.#e.$onDidChangeHistoryProviderCurrentHistoryItemRefs(this.handle,i,n,s)}));this._historyProviderDisposable.value.add(e.onDidChangeHistoryItemRefs(i=>{if(i.added.length===0&&i.modified.length===0&&i.removed.length===0){return}const n=i.added.map(o=>({...o,icon:ba(o.icon)}));const s=i.modified.map(o=>({...o,icon:ba(o.icon)}));const r=i.removed.map(o=>({...o,icon:ba(o.icon)}));this.#e.$onDidChangeHistoryProviderHistoryItemRefs(this.handle,{added:n,modified:s,removed:r,silent:i.silent})}))}}get commitTemplate(){return this._commitTemplate}set commitTemplate(e){if(e===this._commitTemplate){return}this._commitTemplate=e;this.#e.$updateSourceControl(this.handle,{commitTemplate:e})}get acceptInputCommand(){return this._acceptInputCommand}set acceptInputCommand(e){this._acceptInputDisposables.value=new Ie;this._acceptInputCommand=e;const i=this._commands.converter.toInternal(e,this._acceptInputDisposables.value);this.#e.$updateSourceControl(this.handle,{acceptInputCommand:i})}get actionButton(){$(this._extension,"scmActionButton");return this._actionButton}set actionButton(e){$(this._extension,"scmActionButton");if(P_(this._actionButton,e)){return}this._actionButton=e;this._actionButtonDisposables.value=new Ie;const i=e!==void 0?{command:{...this._commands.converter.toInternal(e.command,this._actionButtonDisposables.value),shortTitle:e.command.shortTitle},secondaryCommands:e.secondaryCommands?.map(n=>{return n.map(s=>this._commands.converter.toInternal(s,this._actionButtonDisposables.value))}),enabled:e.enabled}:void 0;this.#e.$updateSourceControl(this.handle,{actionButton:i??null})}get statusBarCommands(){return this._statusBarCommands}set statusBarCommands(e){if(this._statusBarCommands&&e&&TF(this._statusBarCommands,e)){return}this._statusBarDisposables.value=new Ie;this._statusBarCommands=e;const i=(e||[]).map(n=>this._commands.converter.toInternal(n,this._statusBarDisposables.value));this.#e.$updateSourceControl(this.handle,{statusBarCommands:i})}get selected(){return this._selected}constructor(e,i,n,s,r,o,a){this._extension=e;this._commands=s;this._id=r;this._label=o;this._rootUri=a;this._groups=new Map;this._count=void 0;this._quickDiffProvider=void 0;this._secondaryQuickDiffProvider=void 0;this._historyProviderDisposable=new eo;this._commitTemplate=void 0;this._acceptInputDisposables=new eo;this._acceptInputCommand=void 0;this._actionButtonDisposables=new eo;this._statusBarDisposables=new eo;this._statusBarCommands=void 0;this._selected=false;this._onDidChangeSelection=new L;this.onDidChangeSelection=this._onDidChangeSelection.event;this.handle=Ra._handlePool++;this.createdResourceGroups=new Map;this.updatedResourceGroups=new Set;this.#e=n;const l=b.from({scheme:ae.vscodeSourceControl,path:`${r}/scm${this.handle}/input`,query:a?`rootUri=${encodeURIComponent(a.toString())}`:void 0});this._inputBox=new PF(e,i,this.#e,this.handle,l);this.#e.$registerSourceControl(this.handle,r,o,a,l)}createResourceGroup(e,i,n){const s=dt(this._extension,"scmMultiDiffEditor")&&n?.multiDiffEditorEnableViewChanges===true;const r=new Hy(this.#e,this._commands,this.handle,e,i,s,this._extension);const o=Bt.once(r.onDidDispose)(()=>this.createdResourceGroups.delete(r));this.createdResourceGroups.set(r,o);this.eventuallyAddResourceGroups();return r}eventuallyAddResourceGroups(){const e=[];const i=[];for(const[n,s]of this.createdResourceGroups){s.dispose();const r=n.onDidUpdateResourceStates(()=>{this.updatedResourceGroups.add(n);this.eventuallyUpdateResourceStates()});Bt.once(n.onDidDispose)(()=>{this.updatedResourceGroups.delete(n);r.dispose();this._groups.delete(n.handle);this.#e.$unregisterGroup(this.handle,n.handle)});e.push([n.handle,n.id,n.label,n.features,n.multiDiffEditorEnableViewChanges]);const o=n._takeResourceStateSnapshot();if(o.length>0){i.push([n.handle,o])}this._groups.set(n.handle,n)}this.#e.$registerGroups(this.handle,e,i);this.createdResourceGroups.clear()}eventuallyUpdateResourceStates(){const e=[];this.updatedResourceGroups.forEach(i=>{const n=i._takeResourceStateSnapshot();if(n.length===0){return}e.push([i.handle,n])});if(e.length>0){this.#e.$spliceResourceStates(this.handle,e)}this.updatedResourceGroups.clear()}getResourceGroup(e){return this._groups.get(e)}setSelectionState(e){this._selected=e;this._onDidChangeSelection.fire(e)}dispose(){this._acceptInputDisposables.dispose();this._actionButtonDisposables.dispose();this._statusBarDisposables.dispose();this._groups.forEach(e=>e.dispose());this.#e.$unregisterSourceControl(this.handle)}}Ra.__decorator=z([h5(100)],Ra.prototype,"eventuallyAddResourceGroups",null);Ra.__decorator=z([h5(100)],Ra.prototype,"eventuallyUpdateResourceStates",null);let s0=class nH{static{n0=this}static{this._handlePool=0}get onDidChangeActiveProvider(){return this._onDidChangeActiveProvider.event}constructor(e,i,n,s){this._commands=i;this._extHostDocuments=n;this.logService=s;this._sourceControls=new Map;this._sourceControlsByExtension=new Sr;this._onDidChangeActiveProvider=new L;this._proxy=e.getProxy(Y.MainThreadSCM);this._telemetry=e.getProxy(Y.MainThreadTelemetry);i.registerArgumentProcessor({processArgument:r=>{if(r&&r.$mid===it.ScmResource){const o=this._sourceControls.get(r.sourceControlHandle);if(!o){return r}const a=o.getResourceGroup(r.groupHandle);if(!a){return r}return a.getResourceState(r.handle)}else if(r&&r.$mid===it.ScmResourceGroup){const o=this._sourceControls.get(r.sourceControlHandle);if(!o){return r}return o.getResourceGroup(r.groupHandle)}else if(r&&r.$mid===it.ScmProvider){const o=this._sourceControls.get(r.handle);if(!o){return r}return o}return r}})}createSourceControl(e,i,n,s){this.logService.trace("ExtHostSCM#createSourceControl",e.identifier.value,i,n,s);this._telemetry.$publicLog2("api/scm/createSourceControl",{extensionId:e.identifier.value});const r=n0._handlePool++;const o=new Ra(e,this._extHostDocuments,this._proxy,this._commands,i,n,s);this._sourceControls.set(r,o);const a=this._sourceControlsByExtension.get(e.identifier)||[];a.push(o);this._sourceControlsByExtension.set(e.identifier,a);return o}getLastInputBox(e){this.logService.trace("ExtHostSCM#getLastInputBox",e.identifier.value);const i=this._sourceControlsByExtension.get(e.identifier);const n=i&&i[i.length-1];return n&&n.inputBox}$provideOriginalResource(e,i,n){const s=b.revive(i);this.logService.trace("ExtHostSCM#$provideOriginalResource",e,s.toString());const r=this._sourceControls.get(e);if(!r||!r.quickDiffProvider||!r.quickDiffProvider.provideOriginalResource){return Promise.resolve(null)}return Ci(()=>r.quickDiffProvider.provideOriginalResource(s,n)).then(o=>o||null)}$provideSecondaryOriginalResource(e,i,n){const s=b.revive(i);this.logService.trace("ExtHostSCM#$provideSecondaryOriginalResource",e,s.toString());const r=this._sourceControls.get(e);if(!r||!r.secondaryQuickDiffProvider||!r.secondaryQuickDiffProvider.provideOriginalResource){return Promise.resolve(null)}return Ci(()=>r.secondaryQuickDiffProvider.provideOriginalResource(s,n)).then(o=>o||null)}$onInputBoxValueChange(e,i){this.logService.trace("ExtHostSCM#$onInputBoxValueChange",e);const n=this._sourceControls.get(e);if(!n){return Promise.resolve(void 0)}n.inputBox.$onInputBoxValueChange(i);return Promise.resolve(void 0)}$executeResourceCommand(e,i,n,s){this.logService.trace("ExtHostSCM#$executeResourceCommand",e,i,n);const r=this._sourceControls.get(e);if(!r){return Promise.resolve(void 0)}const o=r.getResourceGroup(i);if(!o){return Promise.resolve(void 0)}return o.$executeResourceCommand(n,s)}$validateInput(e,i,n){this.logService.trace("ExtHostSCM#$validateInput",e);const s=this._sourceControls.get(e);if(!s){return Promise.resolve(void 0)}if(!s.inputBox.validateInput){return Promise.resolve(void 0)}return Ci(()=>s.inputBox.validateInput(i,n)).then(r=>{if(!r){return Promise.resolve(void 0)}const o=Pe.fromStrict(r.message);if(!o){return Promise.resolve(void 0)}return Promise.resolve([o,r.type])})}$setSelectedSourceControl(e){this.logService.trace("ExtHostSCM#$setSelectedSourceControl",e);if(e!==void 0){this._sourceControls.get(e)?.setSelectionState(true)}if(this._selectedSourceControlHandle!==void 0){this._sourceControls.get(this._selectedSourceControlHandle)?.setSelectionState(false)}this._selectedSourceControlHandle=e;return Promise.resolve(void 0)}async $resolveHistoryItemRefsCommonAncestor(e,i,n){try{const s=this._sourceControls.get(e)?.historyProvider;const r=await s?.resolveHistoryItemRefsCommonAncestor(i,n);return r??void 0}catch(s){this.logService.error("ExtHostSCM#$resolveHistoryItemRefsCommonAncestor",s);return void 0}}async $provideHistoryItemRefs(e,i,n){try{const s=this._sourceControls.get(e)?.historyProvider;const r=await s?.provideHistoryItemRefs(i,n);return r?.map(o=>({...o,icon:ba(o.icon)}))??void 0}catch(s){this.logService.error("ExtHostSCM#$provideHistoryItemRefs",s);return void 0}}async $provideHistoryItems(e,i,n){try{const s=this._sourceControls.get(e)?.historyProvider;const r=await s?.provideHistoryItems(i,n);return r?.map(o=>SF(o))??void 0}catch(s){this.logService.error("ExtHostSCM#$provideHistoryItems",s);return void 0}}async $provideHistoryItemChanges(e,i,n,s){try{const r=this._sourceControls.get(e)?.historyProvider;const o=await r?.provideHistoryItemChanges(i,n,s);return o??void 0}catch(r){this.logService.error("ExtHostSCM#$provideHistoryItemChanges",r);return void 0}}};s0=n0=z([O(3,at)],s0);class By{static{this.handlePool=0}constructor(e,i){this.uriTransformer=i;this.providers=new Map;this.proxy=e.getProxy(Y.MainThreadShare)}async $provideShare(e,i,n){const s=this.providers.get(e);const r=await s?.provideShare({selection:W.to(i.selection),resourceUri:b.revive(i.resourceUri)},n);return r??void 0}registerShareProvider(e,i){const n=By.handlePool++;this.providers.set(n,i);this.proxy.$registerShareProvider(n,uc.from(e,this.uriTransformer),i.id,i.label,i.priority);return{dispose:()=>{this.proxy.$unregisterShareProvider(n);this.providers.delete(n)}}}}class Vy{static{this.ID_POOL=1}constructor(e){this.providers=new Map;this.sessions=new Map;this.synthesizers=new Map;this.proxy=e.getProxy(Y.MainThreadSpeech)}async $createSpeechToTextSession(e,i,n){const s=this.providers.get(e);if(!s){return}const r=new Ie;const o=new Ot;this.sessions.set(i,o);const a=await s.provideSpeechToTextSession(o.token,n?{language:n}:void 0);if(!a){return}r.add(a.onDidChange(l=>{if(o.token.isCancellationRequested){return}this.proxy.$emitSpeechToTextEvent(i,l)}));r.add(o.token.onCancellationRequested(()=>r.dispose()))}async $cancelSpeechToTextSession(e){this.sessions.get(e)?.dispose(true);this.sessions.delete(e)}async $createTextToSpeechSession(e,i,n){const s=this.providers.get(e);if(!s){return}const r=new Ie;const o=new Ot;this.sessions.set(i,o);const a=await s.provideTextToSpeechSession(o.token,n?{language:n}:void 0);if(!a){return}this.synthesizers.set(i,a);r.add(a.onDidChange(l=>{if(o.token.isCancellationRequested){return}this.proxy.$emitTextToSpeechEvent(i,l)}));r.add(o.token.onCancellationRequested(()=>r.dispose()))}async $synthesizeSpeech(e,i){this.synthesizers.get(e)?.synthesize(i)}async $cancelTextToSpeechSession(e){this.sessions.get(e)?.dispose(true);this.sessions.delete(e);this.synthesizers.delete(e)}async $createKeywordRecognitionSession(e,i){const n=this.providers.get(e);if(!n){return}const s=new Ie;const r=new Ot;this.sessions.set(i,r);const o=await n.provideKeywordRecognitionSession(r.token);if(!o){return}s.add(o.onDidChange(a=>{if(r.token.isCancellationRequested){return}this.proxy.$emitKeywordRecognitionEvent(i,a)}));s.add(r.token.onCancellationRequested(()=>s.dispose()))}async $cancelKeywordRecognitionSession(e){this.sessions.get(e)?.dispose(true);this.sessions.delete(e)}registerProvider(e,i,n){const s=Vy.ID_POOL++;this.providers.set(s,n);this.proxy.$registerProvider(s,i,{extension:e,displayName:e.value});return ge(()=>{this.proxy.$unregisterProvider(s);this.providers.delete(s)})}}class Bu{static{this.ID_GEN=0}static{this.ALLOWED_BACKGROUND_COLORS=new Map([["statusBarItem.errorBackground",new vd("statusBarItem.errorForeground")],["statusBarItem.warningBackground",new vd("statusBarItem.warningForeground")]])}#e;#t;constructor(e,i,n,s,r,o=no.Left,a,l){this._onDispose=l;this._disposed=false;this._text="";this._staleCommandRegistrations=new Ie;this.#e=e;this.#t=i;if(r&&s){this._entryId=s3(s.identifier,r);const c=n.get(this._entryId);if(c){o=c.alignLeft?no.Left:no.Right;a=c.priority;this._visible=true;this.name=c.name;this.text=c.text;this.tooltip=c.tooltip;this.command=c.command;this.accessibilityInformation=c.accessibilityInformation}}else{this._entryId=String(Bu.ID_GEN++)}this._extension=s;this._id=r;this._alignment=o;this._priority=this.validatePriority(a)}validatePriority(e){if(!ia(e)){return void 0}if(e===Number.POSITIVE_INFINITY){return Number.MAX_VALUE}if(e===Number.NEGATIVE_INFINITY){return-Number.MAX_VALUE}return e}get id(){return this._id??this._extension.identifier.value}get entryId(){return this._entryId}get alignment(){return this._alignment}get priority(){return this._priority}get text(){return this._text}get name(){return this._name}get tooltip(){return this._tooltip}get tooltip2(){if(this._extension){$(this._extension,"statusBarItemTooltip")}return this._tooltip2}get color(){return this._color}get backgroundColor(){return this._backgroundColor}get command(){return this._command?.fromApi}get accessibilityInformation(){return this._accessibilityInformation}set text(e){this._text=e;this.update()}set name(e){this._name=e;this.update()}set tooltip(e){this._tooltip=e;this.update()}set tooltip2(e){if(this._extension){$(this._extension,"statusBarItemTooltip")}this._tooltip2=e;this.update()}set color(e){this._color=e;this.update()}set backgroundColor(e){if(e&&!Bu.ALLOWED_BACKGROUND_COLORS.has(e.id)){e=void 0}this._backgroundColor=e;this.update()}set command(e){if(this._command?.fromApi===e){return}if(this._latestCommandRegistration){this._staleCommandRegistrations.add(this._latestCommandRegistration)}this._latestCommandRegistration=new Ie;if(typeof e==="string"){this._command={fromApi:e,internal:this.#t.toInternal({title:"",command:e},this._latestCommandRegistration)}}else if(e){this._command={fromApi:e,internal:this.#t.toInternal(e,this._latestCommandRegistration)}}else{this._command=void 0}this.update()}set accessibilityInformation(e){this._accessibilityInformation=e;this.update()}show(){this._visible=true;this.update()}hide(){clearTimeout(this._timeoutHandle);this._visible=false;this.#e.$disposeEntry(this._entryId)}update(){if(this._disposed||!this._visible){return}clearTimeout(this._timeoutHandle);this._timeoutHandle=setTimeout(()=>{this._timeoutHandle=void 0;let e;if(this._extension){if(this._id){e=`${this._extension.identifier.value}.${this._id}`}else{e=this._extension.identifier.value}}else{e=this._id}let i;if(this._name){i=this._name}else{i=h(2566,"{0} (Extension)",this._extension.displayName||this._extension.name)}let n=this._color;if(this._backgroundColor){n=Bu.ALLOWED_BACKGROUND_COLORS.get(this._backgroundColor.id)}let s;let r;if(typeof this._tooltip2==="function"){s=Pe.fromStrict(this._tooltip);r=true}else{s=Pe.fromStrict(this._tooltip2??this._tooltip);r=false}this.#e.$setEntry(this._entryId,e,this._extension?.identifier.value,i,this._text,s,r,this._command?.internal,n,this._backgroundColor,this._alignment===no.Left,this._priority,this._accessibilityInformation);this._staleCommandRegistrations.clear()},0)}dispose(){this.hide();this._onDispose?.();this._disposed=true}}class AF{constructor(e){this._messages=[];this._item=e.createStatusBarEntry(void 0,"status.extensionMessage",no.Left,Number.MIN_VALUE);this._item.name=h(2567,"Extension Status")}dispose(){this._messages.length=0;this._item.dispose()}setMessage(e){const i={message:e};this._messages.unshift(i);this._update();return new qe(()=>{const n=this._messages.indexOf(i);if(n>=0){this._messages.splice(n,1);this._update()}})}_update(){if(this._messages.length>0){this._item.text=this._messages[0].message;this._item.show()}else{this._item.hide()}}}class RF{constructor(e,i){this._entries=new Map;this._existingItems=new Map;this._proxy=e.getProxy(Y.MainThreadStatusBar);this._commands=i;this._statusMessage=new AF(this)}$acceptStaticEntries(e){for(const i of e){this._existingItems.set(i.entryId,i)}}async $provideTooltip(e,i){const n=this._entries.get(e);if(!n){return void 0}const s=typeof n.tooltip2==="function"?await n.tooltip2(i):n.tooltip2;return!i.isCancellationRequested?Pe.fromStrict(s):void 0}createStatusBarEntry(e,i,n,s){const r=new Bu(this._proxy,this._commands,this._existingItems,e,i,n,s,()=>this._entries.delete(r.entryId));this._entries.set(r.entryId,r);return r}setStatusBarMessage(e,i){const n=this._statusMessage.setMessage(e);let s;if(typeof i==="number"){s=setTimeout(()=>n.dispose(),i)}else if(typeof i!=="undefined"){i.then(()=>n.dispose(),()=>n.dispose())}return new qe(()=>{n.dispose();clearTimeout(s)})}}class LF extends Ee{constructor(e,i){super();this._extHostDocumentsAndEditors=i;this._onDidChangeTextEditorSelection=new L;this._onDidChangeTextEditorOptions=new L;this._onDidChangeTextEditorVisibleRanges=new L;this._onDidChangeTextEditorViewColumn=new L;this._onDidChangeTextEditorDiffInformation=new L;this._onDidChangeActiveTextEditor=new L;this._onDidChangeVisibleTextEditors=new L;this.onDidChangeTextEditorSelection=this._onDidChangeTextEditorSelection.event;this.onDidChangeTextEditorOptions=this._onDidChangeTextEditorOptions.event;this.onDidChangeTextEditorVisibleRanges=this._onDidChangeTextEditorVisibleRanges.event;this.onDidChangeTextEditorViewColumn=this._onDidChangeTextEditorViewColumn.event;this.onDidChangeTextEditorDiffInformation=this._onDidChangeTextEditorDiffInformation.event;this.onDidChangeActiveTextEditor=this._onDidChangeActiveTextEditor.event;this.onDidChangeVisibleTextEditors=this._onDidChangeVisibleTextEditors.event;this._proxy=e.getProxy(Y.MainThreadTextEditors);this._register(this._extHostDocumentsAndEditors.onDidChangeVisibleTextEditors(n=>this._onDidChangeVisibleTextEditors.fire(n)));this._register(this._extHostDocumentsAndEditors.onDidChangeActiveTextEditor(n=>this._onDidChangeActiveTextEditor.fire(n)))}getActiveTextEditor(){return this._extHostDocumentsAndEditors.activeEditor()}getVisibleTextEditors(e){const i=this._extHostDocumentsAndEditors.allEditors();return e?i:i.map(n=>n.value)}async showTextDocument(e,i,n){let s;if(typeof i==="number"){s={position:ai.from(i),preserveFocus:n}}else if(typeof i==="object"){s={position:ai.from(i.viewColumn),preserveFocus:i.preserveFocus,selection:typeof i.selection==="object"?W.from(i.selection):void 0,pinned:typeof i.preview==="boolean"?!i.preview:void 0}}else{s={preserveFocus:false}}const r=await this._proxy.$tryShowTextDocument(e.uri,s);const o=r&&this._extHostDocumentsAndEditors.getEditor(r);if(o){return o.value}if(r){throw new Error(`Could NOT open editor for "${e.uri.toString()}" because another editor opened in the meantime.`)}else{throw new Error(`Could NOT open editor for "${e.uri.toString()}".`)}}createTextEditorDecorationType(e,i){return new Sy(this._proxy,e,i).value}$acceptEditorPropertiesChanged(e,i){const n=this._extHostDocumentsAndEditors.getEditor(e);if(!n){throw new Error("unknown text editor")}if(i.options){n._acceptOptions(i.options)}if(i.selections){const s=i.selections.selections.map(ls.to);n._acceptSelections(s)}if(i.visibleRanges){const s=ei(i.visibleRanges.map(W.to));n._acceptVisibleRanges(s)}if(i.options){this._onDidChangeTextEditorOptions.fire({textEditor:n.value,options:{...i.options,lineNumbers:Ul.to(i.options.lineNumbers)}})}if(i.selections){const s=tc.fromValue(i.selections.source);const r=i.selections.selections.map(ls.to);this._onDidChangeTextEditorSelection.fire({textEditor:n.value,selections:r,kind:s})}if(i.visibleRanges){const s=ei(i.visibleRanges.map(W.to));this._onDidChangeTextEditorVisibleRanges.fire({textEditor:n.value,visibleRanges:s})}}$acceptEditorPositionData(e){for(const i in e){const n=this._extHostDocumentsAndEditors.getEditor(i);if(!n){throw new Error("Unknown text editor")}const s=ai.to(e[i]);if(n.value.viewColumn!==s){n._acceptViewColumn(s);this._onDidChangeTextEditorViewColumn.fire({textEditor:n.value,viewColumn:s})}}}$acceptEditorDiffInformation(e,i){const n=this._extHostDocumentsAndEditors.getEditor(e);if(!n){throw new Error("unknown text editor")}if(!i){n._acceptDiffInformation(void 0);this._onDidChangeTextEditorDiffInformation.fire({textEditor:n.value,diffInformation:void 0});return}const s=this;const r=i.map(o=>{const a=b.revive(o.original);const l=b.revive(o.modified);const c=o.changes.map(u=>{const[d,p,f,m]=u;let v;if(d===p){v=Al.Addition}else if(f===m){v=Al.Deletion}else{v=Al.Modification}return{original:{startLineNumber:d,endLineNumberExclusive:p},modified:{startLineNumber:f,endLineNumberExclusive:m},kind:v}});return Object.freeze({documentVersion:o.documentVersion,original:a,modified:l,changes:c,get isStale(){const u=s._extHostDocumentsAndEditors.getDocument(l);return u?.version!==o.documentVersion}})});n._acceptDiffInformation(r);this._onDidChangeTextEditorDiffInformation.fire({textEditor:n.value,diffInformation:r})}getDiffInformation(e){return Promise.resolve(this._proxy.$getDiffInformation(e))}}let r0=class sH{constructor(e){this._actual=new ig(Yr.Dark);this._onDidChangeActiveColorTheme=new L}get activeColorTheme(){return this._actual}$onColorThemeChange(e){let i;switch(e){case"light":i=Yr.Light;break;case"hcDark":i=Yr.HighContrast;break;case"hcLight":i=Yr.HighContrastLight;break;default:i=Yr.Dark}this._actual=new ig(i);this._onDidChangeActiveColorTheme.fire(this._actual)}get onDidChangeActiveColorTheme(){return this._onDidChangeActiveColorTheme.event}};r0=z([O(0,st)],r0);class NF{constructor(e,i){this._providers=new Map;this._itemsBySourceAndUriMap=new Map;this._proxy=e.getProxy(Y.MainThreadTimeline);i.registerArgumentProcessor({processArgument:(n,s)=>{if(n&&n.$mid===it.TimelineActionContext){if(this._providers.get(n.source)&&s&&dt(s,"timeline")){const r=n.uri===void 0?void 0:b.revive(n.uri);return this._itemsBySourceAndUriMap.get(n.source)?.get(yk(r))?.get(n.handle)}else{return void 0}}return n}})}async $getTimeline(e,i,n,s){const r=this._providers.get(e);return r?.provider.provideTimeline(b.revive(i),n,s)}registerTimelineProvider(e,i,n,s){const r=new Ie;const o=this.convertTimelineItem(i.id,s,r).bind(this);let a;if(i.onDidChange){a=i.onDidChange(c=>this._proxy.$emitTimelineChangeEvent({uri:void 0,reset:true,...c,id:i.id}),this)}const l=this._itemsBySourceAndUriMap;return this.registerTimelineProviderCore({...i,scheme:e,onDidChange:void 0,async provideTimeline(c,u,d){if(u?.resetCache){r.clear();l.get(i.id)?.clear()}const p=await i.provideTimeline(c,u,d);if(p===void 0||p===null){return void 0}const f=o(c,u);return{...p,source:i.id,items:p.items.map(f)}},dispose(){for(const c of l.values()){c.get(i.id)?.clear()}a?.dispose();r.dispose()}},n)}convertTimelineItem(e,i,n){return(s,r)=>{let o;if(r?.cacheResults){let a=this._itemsBySourceAndUriMap.get(e);if(a===void 0){a=new Map;this._itemsBySourceAndUriMap.set(e,a)}const l=yk(s);o=a.get(l);if(o===void 0){o=new Map;a.set(l,o)}}return a=>{const{iconPath:l,...c}=a;const u=`${e}|${a.id??a.timestamp}`;o?.set(u,a);let d;let p;let f;if(a.iconPath){if(l instanceof Vi){f={id:l.id,color:l.color}}else if(b.isUri(l)){d=l;p=l}else{({light:d,dark:p}=l)}}let m;if(cn.isMarkdownString(c.tooltip)){m=Pe.from(c.tooltip)}else if(tt(c.tooltip)){m=c.tooltip}else if(cn.isMarkdownString(c.detail)){console.warn("Using deprecated TimelineItem.detail, migrate to TimelineItem.tooltip");m=Pe.from(c.detail)}else if(tt(c.detail)){console.warn("Using deprecated TimelineItem.detail, migrate to TimelineItem.tooltip");m=c.detail}return{...c,id:c.id??void 0,handle:u,source:e,command:a.command?i.toInternal(a.command,n):void 0,icon:d,iconDark:p,themeIcon:f,tooltip:m,accessibilityInformation:a.accessibilityInformation}}}}registerTimelineProviderCore(e,i){const n=this._providers.get(e.id);if(n){throw new Error(`Timeline Provider ${e.id} already exists.`)}this._proxy.$registerTimelineProvider({id:e.id,label:e.label,scheme:e.scheme});this._providers.set(e.id,{provider:e,extension:i});return ge(()=>{for(const s of this._itemsBySourceAndUriMap.values()){s.get(e.id)?.clear()}this._providers.delete(e.id);this._proxy.$unregisterTimelineProvider(e.id);e.dispose()})}}function yk(t){return t?.toString()}const OF={IconContribution:"base.contributions.icons"};var xk;(function(t){function e(i,n){let s=i.defaults;while(Zt.isThemeIcon(s)){const r=Fc.getIcon(s.id);if(!r){return void 0}s=r.defaults}return s}t.getDefinition=e})(xk||(xk={}));var Ek;(function(t){function e(n){return{weight:n.weight,style:n.style,src:n.src.map(s=>({format:s.format,location:s.location.toString()}))}}t.toJSONObject=e;function i(n){const s=r=>tt(r)?r:void 0;if(n&&Array.isArray(n.src)&&n.src.every(r=>tt(r.format)&&tt(r.location))){return{weight:s(n.weight),style:s(n.style),src:n.src.map(r=>({format:r.format,location:b.parse(r.location)}))}}return void 0}t.fromJSONObject=i})(Ek||(Ek={}));const FF=/^([\w_-]+)$/;const MF=h(2286,"The font ID must only contain letters, numbers, underscores and dashes.");class UF extends Ee{constructor(){super();this._onDidChange=this._register(new L);this.onDidChange=this._onDidChange.event;this.iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:h(2287,"The id of the font to use. If not set, the font that is defined first is used."),pattern:FF.source,patternErrorMessage:MF},fontCharacter:{type:"string",description:h(2288,"The font character associated with the icon definition.")}},additionalProperties:false,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}};this.iconReferenceSchema={type:"string",pattern:`^${Zt.iconNameExpression}$`,enum:[],enumDescriptions:[]};this.iconsById={};this.iconFontsById={}}registerIcon(e,i,n,s){const r=this.iconsById[e];if(r){if(n&&!r.description){r.description=n;this.iconSchema.properties[e].markdownDescription=`${n} $(${e})`;const l=this.iconReferenceSchema.enum.indexOf(e);if(l!==-1){this.iconReferenceSchema.enumDescriptions[l]=n}this._onDidChange.fire()}return r}const o={id:e,description:n,defaults:i,deprecationMessage:s};this.iconsById[e]=o;const a={$ref:"#/definitions/icons"};if(s){a.deprecationMessage=s}if(n){a.markdownDescription=`${n}: $(${e})`}this.iconSchema.properties[e]=a;this.iconReferenceSchema.enum.push(e);this.iconReferenceSchema.enumDescriptions.push(n||"");this._onDidChange.fire();return{id:e}}deregisterIcon(e){delete this.iconsById[e];delete this.iconSchema.properties[e];const i=this.iconReferenceSchema.enum.indexOf(e);if(i!==-1){this.iconReferenceSchema.enum.splice(i,1);this.iconReferenceSchema.enumDescriptions.splice(i,1)}this._onDidChange.fire()}getIcons(){return Object.keys(this.iconsById).map(e=>this.iconsById[e])}getIcon(e){return this.iconsById[e]}getIconSchema(){return this.iconSchema}getIconReferenceSchema(){return this.iconReferenceSchema}registerIconFont(e,i){const n=this.iconFontsById[e];if(n){return n}this.iconFontsById[e]=i;this._onDidChange.fire();return i}deregisterIconFont(e){delete this.iconFontsById[e]}getIconFont(e){return this.iconFontsById[e]}toString(){const e=(r,o)=>{return r.id.localeCompare(o.id)};const i=r=>{while(Zt.isThemeIcon(r.defaults)){r=this.iconsById[r.defaults.id]}return`codicon codicon-${r?r.id:""}`};const n=[];n.push(`| preview     | identifier                        | default codicon ID                | description`);n.push(`| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |`);const s=Object.keys(this.iconsById).map(r=>this.iconsById[r]);for(const r of s.filter(o=>!!o.description).sort(e)){n.push(`|<i class="${i(r)}"></i>|${r.id}|${Zt.isThemeIcon(r.defaults)?r.defaults.id:r.id}|${r.description||""}|`)}n.push(`| preview     | identifier                        `);n.push(`| ----------- | --------------------------------- |`);for(const r of s.filter(o=>!Zt.isThemeIcon(o.defaults)).sort(e)){n.push(`|<i class="${i(r)}"></i>|${r.id}|`)}return n.join("\n")}}const Fc=new UF;ci.add(OF.IconContribution,Fc);function Gm(t,e,i,n){return Fc.registerIcon(t,e,i,n)}function $F(){const t=w7();for(const e in t){const i="\\"+t[e].toString(16);Fc.registerIcon(e,{fontCharacter:i})}}$F();const f5="vscode://schemas/icons";const p5=ci.as(Cm.JSONContribution);p5.registerSchema(f5,Fc.getIconSchema());const Sk=new Ic(()=>p5.notifySchemaChanged(f5),200);Fc.onDidChange(()=>{if(!Sk.isScheduled()){Sk.schedule()}});Gm("widget-close",ve.close,h(2289,"Icon for the close action in widgets."));Gm("goto-previous-location",ve.arrowUp,h(2290,"Icon for goto previous editor location."));Gm("goto-next-location",ve.arrowDown,h(2291,"Icon for goto next editor location."));Zt.modify(ve.sync,"spin");Zt.modify(ve.loading,"spin");h(4020,"Views");Gm("default-view-icon",ve.window,h(4021,"Default view icon."));var hm;(function(t){t.ViewContainersRegistry="workbench.registry.view.containers";t.ViewsRegistry="workbench.registry.view"})(hm||(hm={}));var Vu;(function(t){t[t["Sidebar"]=0]="Sidebar";t[t["Panel"]=1]="Panel";t[t["AuxiliaryBar"]=2]="AuxiliaryBar"})(Vu||(Vu={}));[Vu.Sidebar,Vu.Panel,Vu.AuxiliaryBar];class HF extends Ee{constructor(){super(...arguments);this._onDidRegister=this._register(new L);this.onDidRegister=this._onDidRegister.event;this._onDidDeregister=this._register(new L);this.onDidDeregister=this._onDidDeregister.event;this.viewContainers=new Map;this.defaultViewContainers=[]}get all(){return[...this.viewContainers.values()].flat()}registerViewContainer(e,i,n){const s=this.get(e.id);if(s){return s}const r=e;r.openCommandActionDescriptor=n?.doNotRegisterOpenCommand?void 0:r.openCommandActionDescriptor??{id:r.id};const o=T5(this.viewContainers,i,[]);o.push(r);if(n?.isDefault){this.defaultViewContainers.push(r)}this._onDidRegister.fire({viewContainer:r,viewContainerLocation:i});return r}deregisterViewContainer(e){for(const i of this.viewContainers.keys()){const n=this.viewContainers.get(i);const s=n?.indexOf(e);if(s!==-1){n?.splice(s,1);if(n.length===0){this.viewContainers.delete(i)}this._onDidDeregister.fire({viewContainer:e,viewContainerLocation:i});return}}}get(e){return this.all.filter(i=>i.id===e)[0]}getViewContainers(e){return[...this.viewContainers.get(e)||[]]}getViewContainerLocation(e){return[...this.viewContainers.keys()].filter(i=>this.getViewContainers(i).filter(n=>n?.id===e.id).length>0)[0]}getDefaultViewContainer(e){return this.defaultViewContainers.find(i=>this.getViewContainerLocation(i)===e)}}ci.add(hm.ViewContainersRegistry,new HF);var fm;(function(t){t["Open"]="2_open";t["Debug"]="4_debug";t["SCM"]="5_scm";t["More"]="9_more"})(fm||(fm={}));function BF(t,e){const i=t.group??fm.More;const n=e.group??fm.More;if(i!==n){return i.localeCompare(n)}return(t.order??5)-(e.order??5)}class VF extends Ee{constructor(){super(...arguments);this._onViewsRegistered=this._register(new L);this.onViewsRegistered=this._onViewsRegistered.event;this._onViewsDeregistered=this._register(new L);this.onViewsDeregistered=this._onViewsDeregistered.event;this._onDidChangeContainer=this._register(new L);this.onDidChangeContainer=this._onDidChangeContainer.event;this._onDidChangeViewWelcomeContent=this._register(new L);this.onDidChangeViewWelcomeContent=this._onDidChangeViewWelcomeContent.event;this._viewContainers=[];this._views=new Map;this._viewWelcomeContents=new Ok}registerViews(e,i){this.registerViews2([{views:e,viewContainer:i}])}registerViews2(e){e.forEach(({views:i,viewContainer:n})=>this.addViews(i,n));this._onViewsRegistered.fire(e)}deregisterViews(e,i){const n=this.removeViews(e,i);if(n.length){this._onViewsDeregistered.fire({views:n,viewContainer:i})}}moveViews(e,i){for(const n of this._views.keys()){if(n!==i){const s=this.removeViews(e,n);if(s.length){this.addViews(s,i);this._onDidChangeContainer.fire({views:s,from:n,to:i})}}}}getViews(e){return this._views.get(e)||[]}getView(e){for(const i of this._viewContainers){const n=(this._views.get(i)||[]).filter(s=>s.id===e)[0];if(n){return n}}return null}getViewContainer(e){for(const i of this._viewContainers){const n=(this._views.get(i)||[]).filter(s=>s.id===e)[0];if(n){return i}}return null}registerViewWelcomeContent(e,i){this._viewWelcomeContents.add(e,i);this._onDidChangeViewWelcomeContent.fire(e);return ge(()=>{this._viewWelcomeContents.delete(e,i);this._onDidChangeViewWelcomeContent.fire(e)})}registerViewWelcomeContent2(e,i){const n=new Map;for(const[s,r]of i){this._viewWelcomeContents.add(e,r);n.set(s,ge(()=>{this._viewWelcomeContents.delete(e,r);this._onDidChangeViewWelcomeContent.fire(e)}))}this._onDidChangeViewWelcomeContent.fire(e);return n}getViewWelcomeContent(e){const i=[];this._viewWelcomeContents.forEach(e,n=>i.push(n));return i.sort(BF)}addViews(e,i){let n=this._views.get(i);if(!n){n=[];this._views.set(i,n);this._viewContainers.push(i)}for(const s of e){if(this.getView(s.id)!==null){throw new Error(h(4022,"A view with id '{0}' is already registered",s.id))}n.push(s)}}removeViews(e,i){const n=this._views.get(i);if(!n){return[]}const s=[];const r=[];for(const o of n){if(!e.includes(o)){r.push(o)}else{s.push(o)}}if(s.length){if(r.length){this._views.set(i,r)}else{this._views.delete(i);this._viewContainers.splice(this._viewContainers.indexOf(i),1)}}return s}}ci.add(hm.ViewsRegistry,new VF);var Dk;(function(t){t[t["Default"]=0]="Default";t[t["Expand"]=1]="Expand"})(Dk||(Dk={}));var kk;(function(t){t[t["None"]=0]="None";t[t["Collapsed"]=1]="Collapsed";t[t["Expanded"]=2]="Expanded"})(kk||(kk={}));class Ks extends Error{constructor(e){super(h(4023,"No tree view with id '{0}' registered.",e));this.name="NoTreeViewError"}static is(e){return!!e&&e.name==="NoTreeViewError"}}class WF{constructor(){this._dragOperations=new Map}removeDragOperationTransfer(e){if(e&&this._dragOperations.has(e)){const i=this._dragOperations.get(e);this._dragOperations.delete(e);return i}return void 0}addDragOperationTransfer(e,i){this._dragOperations.set(e,i)}}function Ik(t,e){if(tt(t)){return{label:t}}if(t&&typeof t==="object"&&typeof t.label==="string"){let i=void 0;if(Array.isArray(t.highlights)){i=t.highlights.filter(n=>n.length===2&&typeof n[0]==="number"&&typeof n[1]==="number");i=i.length?i:void 0}return{label:t.label,highlights:i}}return void 0}class zF extends Ee{constructor(e,i,n){super();this._proxy=e;this.commands=i;this.logService=n;this.treeViews=new Map;this.treeDragAndDropService=new WF;function s(r){return r&&r.$treeViewId&&(r.$treeItemHandle||r.$selectedTreeItems||r.$focusedTreeItem)}i.registerArgumentProcessor({processArgument:r=>{if(s(r)){return this.convertArgument(r)}else if(Array.isArray(r)&&r.length>0){return r.map(o=>{if(s(o)){return this.convertArgument(o)}return o})}return r}})}registerTreeDataProvider(e,i,n){const s=this.createTreeView(e,{treeDataProvider:i},n);return{dispose:()=>s.dispose()}}createTreeView(e,i,n){if(!i||!i.treeDataProvider){throw new Error("Options with treeDataProvider is mandatory")}const s=i.dragAndDropController?.dropMimeTypes??[];const r=i.dragAndDropController?.dragMimeTypes??[];const o=!!i.dragAndDropController?.handleDrag;const a=!!i.dragAndDropController?.handleDrop;const l=this.createExtHostTreeView(e,i,n);const c={showCollapseAll:!!i.showCollapseAll,canSelectMany:!!i.canSelectMany,dropMimeTypes:s,dragMimeTypes:r,hasHandleDrag:o,hasHandleDrop:a,manuallyManageCheckboxes:!!i.manageCheckboxStateManually};const u=this._proxy.$registerTreeViewDataProvider(e,c);const d={get onDidCollapseElement(){return l.onDidCollapseElement},get onDidExpandElement(){return l.onDidExpandElement},get selection(){return l.selectedElements},get onDidChangeSelection(){return l.onDidChangeSelection},get activeItem(){$(n,"treeViewActiveItem");return l.focusedElement},get onDidChangeActiveItem(){$(n,"treeViewActiveItem");return l.onDidChangeActiveItem},get visible(){return l.visible},get onDidChangeVisibility(){return l.onDidChangeVisibility},get onDidChangeCheckboxState(){return l.onDidChangeCheckboxState},get message(){return l.message},set message(p){if(Ir(p)){$(n,"treeViewMarkdownMessage")}l.message=p},get title(){return l.title},set title(p){l.title=p},get description(){return l.description},set description(p){l.description=p},get badge(){return l.badge},set badge(p){if(p!==void 0&&_v.isViewBadge(p)){l.badge={value:Math.floor(Math.abs(p.value)),tooltip:p.tooltip}}else if(p===void 0){l.badge=void 0}},reveal:(p,f)=>{return l.reveal(p,f)},dispose:async()=>{await u;this.treeViews.delete(e);l.dispose()}};this._register(d);return d}async $getChildren(e,i){const n=this.treeViews.get(e);if(!n){return Promise.reject(new Ks(e))}if(!i){const r=await n.getChildren();return r?[[0,...r]]:void 0}const s=[];for(let r=0;r<i.length;r++){const o=i[r];const a=await n.getChildren(o);if(a){s.push([r,...a])}}return s}async $handleDrop(e,i,n,s,r,o,a,l){const c=this.treeViews.get(e);if(!c){return Promise.reject(new Ks(e))}const u=yc.toDataTransfer(n,async d=>{return(await this._proxy.$resolveDropFileData(e,i,d)).buffer});if(a===e&&l){await this.addAdditionalTransferItems(u,c,l,r,o)}return c.onDrop(u,s,r)}async addAdditionalTransferItems(e,i,n,s,r){const o=this.treeDragAndDropService.removeDragOperationTransfer(r);if(o){(await o)?.forEach((a,l)=>{if(a){e.set(l,a)}})}else if(r&&i.handleDrag){const a=i.handleDrag(n,e,s);this.treeDragAndDropService.addDragOperationTransfer(r,a);await a}return e}async $handleDrag(e,i,n,s){const r=this.treeViews.get(e);if(!r){return Promise.reject(new Ks(e))}const o=await this.addAdditionalTransferItems(new rc,r,i,s,n);if(!o||s.isCancellationRequested){return}return yc.from(o)}async $hasResolve(e){const i=this.treeViews.get(e);if(!i){throw new Ks(e)}return i.hasResolve}$resolve(e,i,n){const s=this.treeViews.get(e);if(!s){throw new Ks(e)}return s.resolveTreeItem(i,n)}$setExpanded(e,i,n){const s=this.treeViews.get(e);if(!s){throw new Ks(e)}s.setExpanded(i,n)}$setSelectionAndFocus(e,i,n){const s=this.treeViews.get(e);if(!s){throw new Ks(e)}s.setSelectionAndFocus(i,n)}$setVisible(e,i){const n=this.treeViews.get(e);if(!n){if(!i){return}throw new Ks(e)}n.setVisible(i)}$changeCheckboxState(e,i){const n=this.treeViews.get(e);if(!n){throw new Ks(e)}n.setCheckboxState(i)}createExtHostTreeView(e,i,n){const s=this._register(new pm(e,i,this._proxy,this.commands.converter,this.logService,n));this.treeViews.set(e,s);return s}convertArgument(e){const i=this.treeViews.get(e.$treeViewId);if(i&&"$treeItemHandle"in e){return i.getExtensionElement(e.$treeItemHandle)}if(i&&"$focusedTreeItem"in e&&e.$focusedTreeItem){return i.focusedElement}return null}}class pm extends Ee{static{this.LABEL_HANDLE_PREFIX="0"}static{this.ID_HANDLE_PREFIX="1"}get visible(){return this._visible}get selectedElements(){return this._selectedHandles.map(e=>this.getExtensionElement(e)).filter(e=>!Xt(e))}get focusedElement(){return this._focusedHandle?this.getExtensionElement(this._focusedHandle):void 0}constructor(e,i,n,s,r,o){super();this.viewId=e;this.proxy=n;this.commands=s;this.logService=r;this.extension=o;this.roots=void 0;this.elements=new Map;this.nodes=new Map;this._visible=false;this._selectedHandles=[];this._focusedHandle=void 0;this._onDidExpandElement=this._register(new L);this.onDidExpandElement=this._onDidExpandElement.event;this._onDidCollapseElement=this._register(new L);this.onDidCollapseElement=this._onDidCollapseElement.event;this._onDidChangeSelection=this._register(new L);this.onDidChangeSelection=this._onDidChangeSelection.event;this._onDidChangeActiveItem=this._register(new L);this.onDidChangeActiveItem=this._onDidChangeActiveItem.event;this._onDidChangeVisibility=this._register(new L);this.onDidChangeVisibility=this._onDidChangeVisibility.event;this._onDidChangeCheckboxState=this._register(new L);this.onDidChangeCheckboxState=this._onDidChangeCheckboxState.event;this._onDidChangeData=this._register(new L);this.refreshPromise=Promise.resolve();this.refreshQueue=Promise.resolve();this._message="";this._title="";this._refreshCancellationSource=new Ot;if(o.contributes&&o.contributes.views){for(const u in o.contributes.views){for(const d of o.contributes.views[u]){if(d.id===e){this._title=d.name}}}}this.dataProvider=i.treeDataProvider;this.dndController=i.dragAndDropController;if(this.dataProvider.onDidChangeTreeData){this._register(this.dataProvider.onDidChangeTreeData(u=>{if(Array.isArray(u)&&u.length===0){return}this._onDidChangeData.fire({message:false,element:u})}))}let a;let l;const c=Bt.debounce(this._onDidChangeData.event,(u,d)=>{if(!u){u={message:false,elements:[]}}if(d.element!==false){if(!a){a=new Promise(p=>l=p);this.refreshPromise=this.refreshPromise.then(()=>a)}if(Array.isArray(d.element)){u.elements.push(...d.element)}else{u.elements.push(d.element)}}if(d.message){u.message=true}return u},200,true);this._register(c(({message:u,elements:d})=>{if(d.length){this.refreshQueue=this.refreshQueue.then(()=>{const p=l;a=null;return this.refresh(d).then(()=>p())})}if(u){this.proxy.$setMessage(this.viewId,Pe.fromStrict(this._message)??"")}}))}async getChildren(e){const i=e?this.getExtensionElement(e):void 0;if(e&&!i){this.logService.error(`No tree item with id '${e}' found.`);return Promise.resolve([])}let n=this.getChildrenNodes(e);if(!n){n=await this.fetchChildrenNodes(i)}return n?n.map(s=>s.item):void 0}getExtensionElement(e){return this.elements.get(e)}reveal(e,i){i=i?i:{select:true,focus:false};const n=Xt(i.select)?true:i.select;const s=Xt(i.focus)?false:i.focus;const r=Xt(i.expand)?false:i.expand;if(typeof this.dataProvider.getParent!=="function"){return Promise.reject(new Error(`Required registered TreeDataProvider to implement 'getParent' method to access 'reveal' method`))}if(e){return this.refreshPromise.then(()=>this.resolveUnknownParentChain(e)).then(o=>this.resolveTreeNode(e,o[o.length-1]).then(a=>this.proxy.$reveal(this.viewId,{item:a.item,parentChain:o.map(l=>l.item)},{select:n,focus:s,expand:r})),o=>this.logService.error(o))}else{return this.proxy.$reveal(this.viewId,void 0,{select:n,focus:s,expand:r})}}get message(){return this._message}set message(e){this._message=e;this._onDidChangeData.fire({message:true,element:false})}get title(){return this._title}set title(e){this._title=e;this.proxy.$setTitle(this.viewId,e,this._description)}get description(){return this._description}set description(e){this._description=e;this.proxy.$setTitle(this.viewId,this._title,e)}get badge(){return this._badge}set badge(e){if(this._badge?.value===e?.value&&this._badge?.tooltip===e?.tooltip){return}this._badge=Rg.from(e);this.proxy.$setBadge(this.viewId,e)}setExpanded(e,i){const n=this.getExtensionElement(e);if(n){if(i){this._onDidExpandElement.fire(Object.freeze({element:n}))}else{this._onDidCollapseElement.fire(Object.freeze({element:n}))}}}setSelectionAndFocus(e,i){const n=!Is(this._selectedHandles,e);this._selectedHandles=e;const s=this._focusedHandle!==i;this._focusedHandle=i;if(n){this._onDidChangeSelection.fire(Object.freeze({selection:this.selectedElements}))}if(s){this._onDidChangeActiveItem.fire(Object.freeze({activeItem:this.focusedElement}))}}setVisible(e){if(e!==this._visible){this._visible=e;this._onDidChangeVisibility.fire(Object.freeze({visible:this._visible}))}}async setCheckboxState(e){const i=(await Promise.all(e.map(async n=>{const s=this.getExtensionElement(n.treeItemHandle);if(s){return{extensionItem:s,treeItem:await this.dataProvider.getTreeItem(s),newState:n.newState?ys.Checked:ys.Unchecked}}return Promise.resolve(void 0)}))).filter(n=>n!==void 0);i.forEach(n=>{n.treeItem.checkboxState=n.newState?ys.Checked:ys.Unchecked});this._onDidChangeCheckboxState.fire({items:i.map(n=>[n.extensionItem,n.newState])})}async handleDrag(e,i,n){const s=[];for(const r of e){const o=this.getExtensionElement(r);if(o){s.push(o)}}if(!this.dndController?.handleDrag||s.length===0){return}await this.dndController.handleDrag(s,i,n);return i}get hasHandleDrag(){return!!this.dndController?.handleDrag}async onDrop(e,i,n){const s=i?this.getExtensionElement(i):void 0;if(!s&&i||!this.dndController?.handleDrop){return}return Ci(()=>this.dndController?.handleDrop?this.dndController.handleDrop(s,e,n):void 0)}get hasResolve(){return!!this.dataProvider.resolveTreeItem}async resolveTreeItem(e,i){if(!this.dataProvider.resolveTreeItem){return}const n=this.elements.get(e);if(n){const s=this.nodes.get(n);if(s){const r=await this.dataProvider.resolveTreeItem(s.extensionItem,n,i)??s.extensionItem;this.validateTreeItem(r);s.item.tooltip=this.getTooltip(r.tooltip);s.item.command=this.getCommand(s.disposableStore,r.command);return s.item}}return}resolveUnknownParentChain(e){return this.resolveParent(e).then(i=>{if(!i){return Promise.resolve([])}return this.resolveUnknownParentChain(i).then(n=>this.resolveTreeNode(i,n[n.length-1]).then(s=>{n.push(s);return n}))})}resolveParent(e){const i=this.nodes.get(e);if(i){return Promise.resolve(i.parent?this.elements.get(i.parent.item.handle):void 0)}return Ci(()=>this.dataProvider.getParent(e))}resolveTreeNode(e,i){const n=this.nodes.get(e);if(n){return Promise.resolve(n)}return Ci(()=>this.dataProvider.getTreeItem(e)).then(s=>this.createHandle(e,s,i,true)).then(s=>this.getChildren(i?i.item.handle:void 0).then(()=>{const r=this.getExtensionElement(s);if(r){const o=this.nodes.get(r);if(o){return Promise.resolve(o)}}throw new Error(`Cannot resolve tree item for element ${s} from extension ${this.extension.identifier.value}`)}))}getChildrenNodes(e){if(e){let i;if(typeof e==="string"){const n=this.getExtensionElement(e);i=n?this.nodes.get(n):void 0}else{i=e}return i?i.children||void 0:void 0}return this.roots}async fetchChildrenNodes(e){this.clearChildren(e);const i=new Ot(this._refreshCancellationSource.token);try{const n=e?this.nodes.get(e):void 0;const s=await this.dataProvider.getChildren(e);if(i.token.isCancellationRequested){return void 0}const r=ei(s||[]);const o=await Promise.all(ei(r).map(l=>{return this.dataProvider.getTreeItem(l)}));if(i.token.isCancellationRequested){return void 0}const a=o.map((l,c)=>l?this.createAndRegisterTreeNode(r[c],l,n):null);return ei(a)}finally{i.dispose()}}refresh(e){const i=e.some(n=>!n);if(i){this._refreshCancellationSource.dispose(true);this._refreshCancellationSource=new Ot;this.clearAll();return this.proxy.$refresh(this.viewId)}else{const n=this.getHandlesToRefresh(e);if(n.length){return this.refreshHandles(n)}}return Promise.resolve(void 0)}getHandlesToRefresh(e){const i=new Set;const n=e.map(r=>this.nodes.get(r));for(const r of n){if(r&&!i.has(r.item.handle)){let o=r;while(o&&o.parent&&n.findIndex(a=>o&&o.parent&&a&&a.item.handle===o.parent.item.handle)===-1){const a=this.elements.get(o.parent.item.handle);o=a?this.nodes.get(a):void 0}if(o&&!o.parent){i.add(r.item.handle)}}}const s=[];i.forEach(r=>{const o=this.elements.get(r);if(o){const a=this.nodes.get(o);if(a&&(!a.parent||!i.has(a.parent.item.handle))){s.push(r)}}});return s}refreshHandles(e){const i={};return Promise.all(e.map(n=>this.refreshNode(n).then(s=>{if(s){i[n]=s.item}}))).then(()=>Object.keys(i).length?this.proxy.$refresh(this.viewId,i):void 0)}refreshNode(e){const i=this.getExtensionElement(e);if(i){const n=this.nodes.get(i);if(n){this.clearChildren(i);return Ci(()=>this.dataProvider.getTreeItem(i)).then(s=>{if(s){const r=this.createTreeNode(i,s,n.parent);this.updateNodeCache(i,r,n,n.parent);n.dispose();return r}return null})}}return Promise.resolve(null)}createAndRegisterTreeNode(e,i,n){const s=this.createTreeNode(e,i,n);if(i.id&&this.elements.has(s.item.handle)){throw new Error(h(2570,"Element with id {0} is already registered",i.id))}this.addNodeToCache(e,s);this.addNodeToParentCache(s,n);return s}getTooltip(e){if(cn.isMarkdownString(e)){return Pe.from(e)}return e}getCommand(e,i){return i?{...this.commands.toInternal(i,e),originalId:i.command}:void 0}getCheckbox(e){if(e.checkboxState===void 0){return void 0}let i;let n=void 0;let s=void 0;if(typeof e.checkboxState==="number"){i=e.checkboxState}else{i=e.checkboxState.state;n=e.checkboxState.tooltip;s=e.checkboxState.accessibilityInformation}return{isChecked:i===ys.Checked,tooltip:n,accessibilityInformation:s}}validateTreeItem(e){if(!qp.isTreeItem(e,this.extension)){throw new Error(`Extension ${this.extension.identifier.value} has provided an invalid tree item.`)}}createTreeNode(e,i,n){this.validateTreeItem(i);const s=this._register(new Ie);const r=this.createHandle(e,i,n);const o=this.getLightIconPath(i);const a={handle:r,parentHandle:n?n.item.handle:void 0,label:Ik(i.label),description:i.description,resourceUri:i.resourceUri,tooltip:this.getTooltip(i.tooltip),command:this.getCommand(s,i.command),contextValue:i.contextValue,icon:o,iconDark:this.getDarkIconPath(i)||o,themeIcon:this.getThemeIcon(i),collapsibleState:Xt(i.collapsibleState)?da.None:i.collapsibleState,accessibilityInformation:i.accessibilityInformation,checkbox:this.getCheckbox(i)};return{item:a,extensionItem:i,parent:n,children:void 0,disposableStore:s,dispose(){s.dispose()}}}getThemeIcon(e){return e.iconPath instanceof Vi?e.iconPath:void 0}createHandle(e,{id:i,label:n,resourceUri:s},r,o){if(i){return`${pm.ID_HANDLE_PREFIX}/${i}`}const a=Ik(n);const l=r?r.item.handle:pm.LABEL_HANDLE_PREFIX;let c=a?a.label:s?$s(s):"";c=c.indexOf("/")!==-1?c.replace("/","//"):c;const u=this.nodes.has(e)?this.nodes.get(e).item.handle:void 0;const d=this.getChildrenNodes(r)||[];let p;let f=0;do{p=`${l}/${f}:${c}`;if(o||!this.elements.has(p)||u===p){break}f++}while(f<=d.length);return p}getLightIconPath(e){if(e.iconPath&&!(e.iconPath instanceof Vi)){if(typeof e.iconPath==="string"||b.isUri(e.iconPath)){return this.getIconPath(e.iconPath)}return this.getIconPath(e.iconPath.light)}return void 0}getDarkIconPath(e){if(e.iconPath&&!(e.iconPath instanceof Vi)&&e.iconPath.dark){return this.getIconPath(e.iconPath.dark)}return void 0}getIconPath(e){if(b.isUri(e)){return e}return b.file(e)}addNodeToCache(e,i){this.elements.set(i.item.handle,e);this.nodes.set(e,i)}updateNodeCache(e,i,n,s){this.elements.delete(i.item.handle);this.nodes.delete(e);if(i.item.handle!==n.item.handle){this.elements.delete(n.item.handle)}this.addNodeToCache(e,i);const r=this.getChildrenNodes(s)||[];const o=r.filter(a=>a.item.handle===n.item.handle)[0];if(o){r.splice(r.indexOf(o),1,i)}}addNodeToParentCache(e,i){if(i){if(!i.children){i.children=[]}i.children.push(e)}else{if(!this.roots){this.roots=[]}this.roots.push(e)}}clearChildren(e){if(e){const i=this.nodes.get(e);if(i){if(i.children){for(const n of i.children){const s=this.elements.get(n.item.handle);if(s){this.clear(s)}}}i.children=void 0}}else{this.clearAll()}}clear(e){const i=this.nodes.get(e);if(i){if(i.children){for(const n of i.children){const s=this.elements.get(n.item.handle);if(s){this.clear(s)}}}this.nodes.delete(e);this.elements.delete(i.item.handle);i.dispose()}}clearAll(){this.roots=void 0;this.elements.clear();this.nodes.forEach(e=>e.dispose());this.nodes.clear()}dispose(){super.dispose();this._refreshCancellationSource.dispose();this.clearAll();this.proxy.$disposeTree(this.viewId)}}class Wy{static{this.supportedSchemes=new Set([ae.http,ae.https])}constructor(e){this._openers=new Map;this._proxy=e.getProxy(Y.MainThreadUriOpeners)}registerExternalUriOpener(e,i,n,s){if(this._openers.has(i)){throw new Error(`Opener with id '${i}' already registered`)}const r=s.schemes.find(o=>!Wy.supportedSchemes.has(o));if(r){throw new Error(`Scheme '${r}' is not supported. Only http and https are currently supported.`)}this._openers.set(i,n);this._proxy.$registerUriOpener(i,s.schemes,e,s.label);return ge(()=>{this._openers.delete(i);this._proxy.$unregisterUriOpener(i)})}async $canOpenUri(e,i,n){const s=this._openers.get(e);if(!s){throw new Error(`Unknown opener with id: ${e}`)}const r=b.revive(i);return s.canOpenExternalUri(r,n)}async $openUri(e,i,n){const s=this._openers.get(e);if(!s){throw new Error(`Unknown opener id: '${e}'`)}return s.openExternalUri(b.revive(i.resolvedUri),{sourceUri:b.revive(i.sourceUri)},n)}}class zy{static{this.HandlePool=0}constructor(e){this.handles=new La;this.handlers=new Map;this._proxy=e.getProxy(Y.MainThreadUrls)}registerUriHandler(e,i){const n=e.identifier;if(this.handles.has(n)){throw new Error(`Protocol handler already registered for extension ${n}`)}const s=zy.HandlePool++;this.handles.add(n);this.handlers.set(s,i);this._proxy.$registerUriHandler(s,n,e.displayName||e.name);return ge(()=>{this.handles.delete(n);this.handlers.delete(s);this._proxy.$unregisterUriHandler(s)})}$handleExternalUri(e,i){const n=this.handlers.get(e);if(!n){return Promise.resolve(void 0)}try{n.handleUri(b.revive(i))}catch(s){Pi(s)}return Promise.resolve(void 0)}async createAppUri(e){return b.revive(await this._proxy.$createAppUri(e))}}class qF extends Ee{#e;#t;#i;#n;#r;#s;#a;#o;#l;#c;#u;#h;#d;constructor(e,i,n,s){super();this.#o=void 0;this.#l=true;this.#u=false;this.#h=this._register(new L);this.onDidDispose=this.#h.event;this.#d=this._register(new L);this.onDidChangeViewState=this.#d.event;this.#e=e;this.#t=i;this.#n=n;this.#i=s.viewType;this.#r=s.panelOptions;this.#o=s.viewColumn;this.#s=s.title;this.#c=s.active}dispose(){if(this.#u){return}this.#u=true;this.#h.fire();this.#t.$disposeWebview(this.#e);this.#n.dispose();super.dispose()}get webview(){this.assertNotDisposed();return this.#n}get viewType(){this.assertNotDisposed();return this.#i}get title(){this.assertNotDisposed();return this.#s}set title(e){this.assertNotDisposed();if(this.#s!==e){this.#s=e;this.#t.$setTitle(this.#e,e)}}get iconPath(){this.assertNotDisposed();return this.#a}set iconPath(e){this.assertNotDisposed();if(this.#a!==e){this.#a=e;this.#t.$setIconPath(this.#e,b.isUri(e)?{light:e,dark:e}:e)}}get options(){return this.#r}get viewColumn(){this.assertNotDisposed();if(typeof this.#o==="number"&&this.#o<0){return void 0}return this.#o}get active(){this.assertNotDisposed();return this.#c}get visible(){this.assertNotDisposed();return this.#l}_updateViewState(e){if(this.#u){return}if(this.active!==e.active||this.visible!==e.visible||this.viewColumn!==e.viewColumn){this.#c=e.active;this.#l=e.visible;this.#o=e.viewColumn;this.#d.fire({webviewPanel:this})}}reveal(e,i){this.assertNotDisposed();this.#t.$reveal(this.#e,{viewColumn:typeof e==="undefined"?void 0:ai.from(e),preserveFocus:!!i})}assertNotDisposed(){if(this.#u){throw new Error("Webview is disposed")}}}class qy extends Ee{static newHandle(){return vi()}constructor(e,i,n){super();this.webviews=i;this.workspace=n;this._webviewPanels=new Map;this._serializers=new Map;this._proxy=e.getProxy(Y.MainThreadWebviewPanels)}dispose(){super.dispose();this._webviewPanels.forEach(e=>e.dispose());this._webviewPanels.clear()}createWebviewPanel(e,i,n,s,r={}){const o=typeof s==="object"?s.viewColumn:s;const a={viewColumn:ai.from(o),preserveFocus:typeof s==="object"&&!!s.preserveFocus};const l=Dc(e);const c=qy.newHandle();this._proxy.$createWebviewPanel(am(e),c,i,{title:n,panelOptions:jF(r),webviewOptions:n5(e,this.workspace,r),serializeBuffersForPostMessage:l},a);const u=this.webviews.createNewWebview(c,r,e);const d=this.createNewWebviewPanel(c,i,n,o,r,u,true);return d}$onDidChangeWebviewPanelViewStates(e){const i=Object.keys(e);i.sort((n,s)=>{const r=e[n];const o=e[s];if(r.active){return 1}if(o.active){return-1}return+r.visible-+o.visible});for(const n of i){const s=this.getWebviewPanel(n);if(!s){continue}const r=e[n];s._updateViewState({active:r.active,visible:r.visible,viewColumn:ai.to(r.position)})}}async $onDidDisposeWebviewPanel(e){const i=this.getWebviewPanel(e);i?.dispose();this._webviewPanels.delete(e);this.webviews.deleteWebview(e)}registerWebviewPanelSerializer(e,i,n){if(this._serializers.has(i)){throw new Error(`Serializer for '${i}' already registered`)}this._serializers.set(i,{serializer:n,extension:e});this._proxy.$registerSerializer(i,{serializeBuffersForPostMessage:Dc(e)});return new qe(()=>{this._serializers.delete(i);this._proxy.$unregisterSerializer(i)})}async $deserializeWebviewPanel(e,i,n,s){const r=this._serializers.get(i);if(!r){throw new Error(`No serializer found for '${i}'`)}const{serializer:o,extension:a}=r;const l=this.webviews.createNewWebview(e,n.webviewOptions,a);const c=this.createNewWebviewPanel(e,i,n.title,s,n.panelOptions,l,n.active);await o.deserializeWebviewPanel(c,n.state)}createNewWebviewPanel(e,i,n,s,r,o,a){const l=new qF(e,this._proxy,o,{viewType:i,title:n,viewColumn:s,panelOptions:r,active:a});this._webviewPanels.set(e,l);return l}getWebviewPanel(e){return this._webviewPanels.get(e)}}function jF(t){return{enableFindWidget:t.enableFindWidget,retainContextWhenHidden:t.retainContextWhenHidden}}class GF extends Ee{#e;#t;#i;#n;#r;#s;#a;#o;#l;constructor(e,i,n,s,r,o){super();this.#r=false;this.#c=this._register(new L);this.onDidChangeVisibility=this.#c.event;this.#u=this._register(new L);this.onDidDispose=this.#u.event;this.#i=n;this.#a=s;this.#e=e;this.#t=i;this.#n=r;this.#s=o}dispose(){if(this.#r){return}this.#r=true;this.#u.fire();this.#n.dispose();super.dispose()}#c;#u;get title(){this.assertNotDisposed();return this.#a}set title(e){this.assertNotDisposed();if(this.#a!==e){this.#a=e;this.#t.$setWebviewViewTitle(this.#e,e)}}get description(){this.assertNotDisposed();return this.#o}set description(e){this.assertNotDisposed();if(this.#o!==e){this.#o=e;this.#t.$setWebviewViewDescription(this.#e,e)}}get visible(){return this.#s}get webview(){return this.#n}get viewType(){return this.#i}_setVisible(e){if(e===this.#s||this.#r){return}this.#s=e;this.#c.fire()}get badge(){this.assertNotDisposed();return this.#l}set badge(e){this.assertNotDisposed();if(e?.value===this.#l?.value&&e?.tooltip===this.#l?.tooltip){return}this.#l=Rg.from(e);this.#t.$setWebviewViewBadge(this.#e,e)}show(e){this.assertNotDisposed();this.#t.$show(this.#e,!!e)}assertNotDisposed(){if(this.#r){throw new Error("Webview is disposed")}}}class KF{constructor(e,i){this._extHostWebview=i;this._viewProviders=new Map;this._webviewViews=new Map;this._proxy=e.getProxy(Y.MainThreadWebviewViews)}registerWebviewViewProvider(e,i,n,s){if(this._viewProviders.has(i)){throw new Error(`View provider for '${i}' already registered`)}this._viewProviders.set(i,{provider:n,extension:e});this._proxy.$registerWebviewViewProvider(am(e),i,{retainContextWhenHidden:s?.retainContextWhenHidden,serializeBuffersForPostMessage:Dc(e)});return new qe(()=>{this._viewProviders.delete(i);this._proxy.$unregisterWebviewViewProvider(i)})}async $resolveWebviewView(e,i,n,s,r){const o=this._viewProviders.get(i);if(!o){throw new Error(`No view provider found for '${i}'`)}const{provider:a,extension:l}=o;const c=this._extHostWebview.createNewWebview(e,{},l);const u=new GF(e,this._proxy,i,n,c,true);this._webviewViews.set(e,u);await a.resolveWebviewView(u,{state:s},r)}async $onDidChangeWebviewViewVisibility(e,i){const n=this.getWebviewView(e);n._setVisible(i)}async $disposeWebviewView(e){const i=this.getWebviewView(e);this._webviewViews.delete(e);i.dispose();this._extHostWebview.deleteWebview(e)}getWebviewView(e){const i=this._webviewViews.get(e);if(!i){throw new Error("No webview found")}return i}}class QF{constructor(e){this._settingsSearchProviders=new Map;this._nextHandle=0;this._proxy=e.getProxy(Y.MainThreadAiSettingsSearch)}async $startSearch(e,i,n,s){if(this._settingsSearchProviders.size===0){throw new Error("No related information providers registered")}const r=this._settingsSearchProviders.get(e);if(!r){throw new Error("Settings search provider not found")}const o=new $0(a=>{this._proxy.$handleSearchResult(e,Uw.fromSettingsSearchResult(a))});return r.provideSettingsSearchResults(i,n,o,s)}registerSettingsSearchProvider(e,i){const n=this._nextHandle;this._nextHandle++;this._settingsSearchProviders.set(n,i);this._proxy.$registerAiSettingsSearchProvider(n);return new qe(()=>{this._proxy.$unregisterAiSettingsSearchProvider(n);this._settingsSearchProviders.delete(n)})}}function JF(t){const e=t.get(Ai);const i=t.get(Tc);const n=t.get(Hm);const s=t.get(bo);const r=t.get(Cr);const o=t.get(Vm);const a=t.get(Tr);const l=t.get(wm);const c=t.get(st);const u=t.get(fy);const d=t.get(py);const p=t.get(Cc);const f=t.get(at);const m=t.get(gy);const v=t.get(zm);const y=t.get(KC);const D=t.get(wy);const I=t.get(_h);const R=t.get(yy);const J=t.get(_y);const H=t.get(vy);const Q=t.get(Fb);c.set(de.ExtHostFileSystemInfo,i);c.set(de.ExtHostLogLevelServiceShape,p);c.set(de.ExtHostWorkspace,r);c.set(de.ExtHostConfiguration,a);c.set(de.ExtHostExtensionService,s);c.set(de.ExtHostStorage,u);c.set(de.ExtHostTunnelService,m);c.set(de.ExtHostWindow,y);c.set(de.ExtHostSecretState,D);c.set(de.ExtHostTelemetry,o);c.set(de.ExtHostEditorTabs,I);c.set(de.ExtHostManagedSockets,R);c.set(de.ExtHostAuthentication,J);c.set(de.ExtHostChatProvider,H);const ne=c.set(de.ExtHostDecorations,t.get($C));const te=c.set(de.ExtHostDocumentsAndEditors,t.get(Oc));const le=c.set(de.ExtHostCommands,t.get(Ba));const Ce=c.set(de.ExtHostTerminalService,t.get(Nc));const Je=c.set(de.ExtHostTerminalShellIntegration,t.get(QC));const We=c.set(de.ExtHostDebugService,t.get(zC));const se=c.set(de.ExtHostSearch,t.get(GC));const G=c.set(de.ExtHostTask,t.get(HC));const ce=c.set(de.ExtHostOutputService,t.get(UC));const ie=c.set(de.ExtHostLocalization,t.get(by));const _e=c.set(de.ExtHostUrls,new zy(c));const be=c.set(de.ExtHostDocuments,new pO(c,te));const Ke=c.set(de.ExtHostDocumentContentProviders,new Cy(c,te,f));const Et=c.set(de.ExtHostDocumentSaveParticipant,new fO(f,be,c.getProxy(Y.MainThreadBulkEdits)));const Ue=c.set(de.ExtHostNotebook,new yl(c,le,te,be,n,se,f));const Gt=c.set(de.ExtHostNotebookDocuments,new dF(Ue));const Ri=c.set(de.ExtHostNotebookEditors,new e0(f,Ue));const At=c.set(de.ExtHostNotebookKernels,new t0(c,e,Ue,le,f));const dn=c.set(de.ExtHostNotebookRenderers,new gF(c,Ue));const bi=c.set(de.ExtHostNotebookDocumentSaveParticipant,new uF(f,Ue,c.getProxy(Y.MainThreadBulkEdits)));const Vt=c.set(de.ExtHostEditors,new LF(c,te));const Cn=c.set(de.ExtHostTreeViews,new zF(c.getProxy(Y.MainThreadTreeViews),le,f));const Km=c.set(de.ExtHostEditorInsets,new qN(c.getProxy(Y.MainThreadEditorInsets),Vt,e.remote));const Pr=c.set(de.ExtHostDiagnostics,new Wb(c,f,i,te));const yo=c.set(de.ExtHostLanguages,new VO(c,be,le.converter,l));const je=c.set(de.ExtHostLanguageFeatures,new ni(c,l,be,le,Pr,f,v,o));const Hs=c.set(de.ExtHostCodeMapper,new Iy(c));const Bs=c.set(de.ExtHostFileSystem,new um(c,je));const Vs=c.set(de.ExtHostFileSystemEventService,new SO(c,f,te));const xo=c.set(de.ExtHostQuickOpen,bF(c,r,le));const ot=c.set(de.ExtHostSCM,new s0(c,le,be,f));const Qm=c.set(de.ExtHostQuickDiff,new $y(c,l));const Jm=c.set(de.ExtHostShare,new By(c,l));const vh=c.set(de.ExtHostComments,jN(c,le,be));const Ws=c.set(de.ExtHostProgress,new vF(c.getProxy(Y.MainThreadProgress)));const Xm=c.set(de.ExtHostLabelService,new kO(c));const wh=c.set(de.ExtHostTheming,new r0(c));const Ym=c.set(de.ExtHostTimeline,new NF(c,le));const Mc=c.set(de.ExtHostWebviews,new iO(c,e.remote,r,f,v));const hn=c.set(de.ExtHostWebviewPanels,new qy(c,Mc,r));const Zm=c.set(de.ExtHostCustomEditors,new lO(c,be,d,Mc,hn));const e1=c.set(de.ExtHostWebviewViews,new KF(c,Mc));const Ar=c.set(de.ExtHostTesting,t.get(qm));const t1=c.set(de.ExtHostUriOpeners,new Wy(c));const Va=c.set(de.ExtHostProfileContentHandlers,new mF(c));c.set(de.ExtHostInteractive,new DO(c,Ue,te,le,f));const zs=c.set(de.ExtHostLanguageModelTools,new BO(c,H));const ds=c.set(de.ExtHostChatAgents2,new wl(c,f,le,be,H,Pr,zs));const Uc=c.set(de.ExtHostAiRelatedInformation,new PN(c));const $c=c.set(de.ExtHostAiEmbeddingVector,new mO(c));const Hc=c.set(de.ExtHostAiSettingsSearch,new QF(c));const Eo=c.set(de.ExtHostStatusBar,new RF(c,le.converter));const en=c.set(de.ExtHostSpeech,new Vy(c));const $n=c.set(de.ExtHostEmbeddings,new gO(c));c.set(de.ExtHostMcp,t.get(Fb));const Mt=Object.values(de);c.assertRegistered(Mt);const i1=new Bb(c,te);const n1=new VN(c);const hi=new Jb(c,f);const bh=new hO(c);const s1=new HN(c);ON.register(le);return function(k,hs,Bc){function he(_){return(w,S,fe)=>{const He=_(St=>{try{w.call(S,St)}catch(v5){Pk(new EI(k.identifier,v5,"FAILED to handle event"))}});fe?.push(He);return He}}const lt=function(){let _=!k.isUnderDevelopment;function w(){if(!_){f.info(`Extension '${k.identifier.value}' uses a document selector without scheme. Learn more about this: https://go.microsoft.com/fwlink/?linkid=872305`);_=true}}return function S(fe){if(Array.isArray(fe)){fe.forEach(S)}else if(typeof fe==="string"){w()}else{const He=fe;if(typeof He.scheme==="undefined"){w()}if(typeof He.exclusive==="boolean"){$(k,"documentFiltersExclusive")}}return fe}}();const r1={getSession(_,w,S){if(typeof S?.forceNewSession==="object"&&S.forceNewSession.learnMore||typeof S?.createIfNone==="object"&&S.createIfNone.learnMore){$(k,"authLearnMore")}return J.getSession(k,_,w,S)},getAccounts(_){return J.getAccounts(_)},async hasSession(_,w){$(k,"authSession");return!!await J.getSession(k,_,w,{silent:true})},get onDidChangeSessions(){return he(J.getExtensionScopedSessionsEvent(k.identifier.value))},registerAuthenticationProvider(_,w,S,fe){return J.registerAuthenticationProvider(_,w,S,fe)}};const o1={registerCommand(_,w,S){return le.registerCommand(true,_,w,S,void 0,k)},registerTextEditorCommand(_,w,S){return le.registerCommand(true,_,(...fe)=>{const He=Vt.getActiveTextEditor();if(!He){f.warn("Cannot execute "+_+" because there is no active text editor.");return void 0}return He.edit(St=>{w.apply(S,[He,St,...fe])}).then(St=>{if(!St){f.warn("Edits from command "+_+" were not applied.")}},St=>{f.warn("An error occurred while running command "+_,St)})},void 0,void 0,k)},registerDiffInformationCommand:(_,w,S)=>{$(k,"diffCommand");return le.registerCommand(true,_,async(...fe)=>{const He=te.activeEditor(true);if(!He){f.warn("Cannot execute "+_+" because there is no active text editor.");return void 0}const St=await Vt.getDiffInformation(He.id);w.apply(S,[St,...fe])},void 0,void 0,k)},executeCommand(_,...w){return le.executeCommand(_,...w)},getCommands(_=false){return le.getCommands(_)}};const Wa={get machineId(){return e.telemetryInfo.machineId},get sessionId(){return e.telemetryInfo.sessionId},get language(){return e.environment.appLanguage},get appName(){return e.environment.appName},get appRoot(){return e.environment.appRoot?.fsPath??""},get appHost(){return e.environment.appHost},get uriScheme(){return e.environment.appUriScheme},get clipboard(){return n1.value},get shell(){return Ce.getDefaultShell(false)},get onDidChangeShell(){return he(Ce.onDidChangeShell)},get isTelemetryEnabled(){return o.getTelemetryConfiguration()},get onDidChangeTelemetryEnabled(){return he(o.onDidChangeTelemetryEnabled)},get telemetryConfiguration(){$(k,"telemetry");return o.getTelemetryDetails()},get onDidChangeTelemetryConfiguration(){$(k,"telemetry");return he(o.onDidChangeTelemetryConfiguration)},get isNewAppInstall(){return kC(e.telemetryInfo.firstSessionDate)},createTelemetryLogger(_,w){DC.validateSender(_);return o.instantiateLogger(k,_,w)},openExternal(_,w){return y.openUri(_,{allowTunneling:!!e.remote.authority,allowContributedOpeners:w?.allowContributedOpeners})},async asExternalUri(_){if(_.scheme===e.environment.appUriScheme){return _e.createAppUri(_)}try{return await y.asExternalUri(_,{allowTunneling:!!e.remote.authority})}catch(w){if(h_(_,ae.http)||h_(_,ae.https)){return _}throw w}},get remoteName(){return k0(e.remote.authority)},get remoteAuthority(){$(k,"resolvers");return e.remote.authority},get uiKind(){return e.uiKind},get logLevel(){return f.getLevel()},get onDidChangeLogLevel(){return he(f.onDidChangeLogLevel)},get appQuality(){$(k,"resolvers");return e.quality},get appCommit(){$(k,"resolvers");return e.commit}};const a1={createTestController(_,w,S){return Ar.createTestController(k,_,w,S)},createTestObserver(){$(k,"testObserver");return Ar.createTestObserver()},runTests(_){$(k,"testObserver");return Ar.runTests(_)},registerTestFollowupProvider(_){$(k,"testObserver");return Ar.registerTestFollowupProvider(_)},get onDidChangeTestResults(){$(k,"testObserver");return he(Ar.onResultsChanged)},get testResults(){$(k,"testObserver");return Ar.results}};const za=e.remote.isRemote?ha.Workspace:ha.UI;const l1={getExtension(_,w){if(!dt(k,"extensionsAny")){w=false}const S=hs.mine.getExtensionDescription(_);if(S){return new cu(s,k.identifier,S,za,false)}if(w){const fe=hs.all.getExtensionDescription(_);if(fe){return new cu(s,k.identifier,fe,za,true)}}return void 0},get all(){const _=[];for(const w of hs.mine.getAllExtensionDescriptions()){_.push(new cu(s,k.identifier,w,za,false))}return _},get allAcrossExtensionHosts(){$(k,"extensionsAny");const _=new La(hs.mine.getAllExtensionDescriptions().map(S=>S.identifier));const w=[];for(const S of hs.all.getAllExtensionDescriptions()){const fe=!_.has(S.identifier);w.push(new cu(s,k.identifier,S,za,fe))}return w},get onDidChange(){if(dt(k,"extensionsAny")){return he(Bt.any(hs.mine.onDidChange,hs.all.onDidChange))}return he(hs.mine.onDidChange)}};const c1={createDiagnosticCollection(_){return Pr.createDiagnosticCollection(k.identifier,_)},get onDidChangeDiagnostics(){return he(Pr.onDidChangeDiagnostics)},getDiagnostics:_=>{return Pr.getDiagnostics(_)},getLanguages(){return yo.getLanguages()},setTextDocumentLanguage(_,w){return yo.changeLanguage(_.uri,w)},match(_,w){const S=_w.from(_);let fe;if(XC(S)){fe=Ue.notebookDocuments.find(He=>He.apiNotebook.getCells().find(St=>St.document===w))?.apiNotebook}return JC(S,w.uri,w.languageId,true,fe?.uri,fe?.notebookType)},registerCodeActionsProvider(_,w,S){return je.registerCodeActionProvider(k,lt(_),w,S)},registerDocumentPasteEditProvider(_,w,S){return je.registerDocumentPasteEditProvider(k,lt(_),w,S)},registerCodeLensProvider(_,w){return je.registerCodeLensProvider(k,lt(_),w)},registerDefinitionProvider(_,w){return je.registerDefinitionProvider(k,lt(_),w)},registerDeclarationProvider(_,w){return je.registerDeclarationProvider(k,lt(_),w)},registerImplementationProvider(_,w){return je.registerImplementationProvider(k,lt(_),w)},registerTypeDefinitionProvider(_,w){return je.registerTypeDefinitionProvider(k,lt(_),w)},registerHoverProvider(_,w){return je.registerHoverProvider(k,lt(_),w,k.identifier)},registerEvaluatableExpressionProvider(_,w){return je.registerEvaluatableExpressionProvider(k,lt(_),w,k.identifier)},registerInlineValuesProvider(_,w){return je.registerInlineValuesProvider(k,lt(_),w,k.identifier)},registerDocumentHighlightProvider(_,w){return je.registerDocumentHighlightProvider(k,lt(_),w)},registerMultiDocumentHighlightProvider(_,w){return je.registerMultiDocumentHighlightProvider(k,lt(_),w)},registerLinkedEditingRangeProvider(_,w){return je.registerLinkedEditingRangeProvider(k,lt(_),w)},registerReferenceProvider(_,w){return je.registerReferenceProvider(k,lt(_),w)},registerRenameProvider(_,w){return je.registerRenameProvider(k,lt(_),w)},registerNewSymbolNamesProvider(_,w){$(k,"newSymbolNamesProvider");return je.registerNewSymbolNamesProvider(k,lt(_),w)},registerDocumentSymbolProvider(_,w,S){return je.registerDocumentSymbolProvider(k,lt(_),w,S)},registerWorkspaceSymbolProvider(_){return je.registerWorkspaceSymbolProvider(k,_)},registerDocumentFormattingEditProvider(_,w){return je.registerDocumentFormattingEditProvider(k,lt(_),w)},registerDocumentRangeFormattingEditProvider(_,w){return je.registerDocumentRangeFormattingEditProvider(k,lt(_),w)},registerOnTypeFormattingEditProvider(_,w,S,...fe){return je.registerOnTypeFormattingEditProvider(k,lt(_),w,[S].concat(fe))},registerDocumentSemanticTokensProvider(_,w,S){return je.registerDocumentSemanticTokensProvider(k,lt(_),w,S)},registerDocumentRangeSemanticTokensProvider(_,w,S){return je.registerDocumentRangeSemanticTokensProvider(k,lt(_),w,S)},registerSignatureHelpProvider(_,w,S,...fe){if(typeof S==="object"){return je.registerSignatureHelpProvider(k,lt(_),w,S)}return je.registerSignatureHelpProvider(k,lt(_),w,typeof S==="undefined"?[]:[S,...fe])},registerCompletionItemProvider(_,w,...S){return je.registerCompletionItemProvider(k,lt(_),w,S)},registerInlineCompletionItemProvider(_,w,S){if(w.handleDidShowCompletionItem){$(k,"inlineCompletionsAdditions")}if(w.handleDidPartiallyAcceptCompletionItem){$(k,"inlineCompletionsAdditions")}if(S){$(k,"inlineCompletionsAdditions")}return je.registerInlineCompletionsProvider(k,lt(_),w,S)},registerInlineEditProvider(_,w){$(k,"inlineEdit");return je.registerInlineEditProvider(k,lt(_),w)},registerDocumentLinkProvider(_,w){return je.registerDocumentLinkProvider(k,lt(_),w)},registerColorProvider(_,w){return je.registerColorProvider(k,lt(_),w)},registerFoldingRangeProvider(_,w){return je.registerFoldingRangeProvider(k,lt(_),w)},registerSelectionRangeProvider(_,w){return je.registerSelectionRangeProvider(k,_,w)},registerCallHierarchyProvider(_,w){return je.registerCallHierarchyProvider(k,_,w)},registerTypeHierarchyProvider(_,w){return je.registerTypeHierarchyProvider(k,_,w)},setLanguageConfiguration:(_,w)=>{return je.setLanguageConfiguration(k,_,w)},getTokenInformationAtPosition(_,w){$(k,"tokenInformation");return yo.tokenAtPosition(_,w)},registerInlayHintsProvider(_,w){return je.registerInlayHintsProvider(k,_,w)},createLanguageStatusItem(_,w){return yo.createLanguageStatusItem(k,_,w)},registerDocumentDropEditProvider(_,w,S){return je.registerDocumentOnDropEditProvider(k,_,w,S)}};const u1={get activeTextEditor(){return Vt.getActiveTextEditor()},get visibleTextEditors(){return Vt.getVisibleTextEditors()},get activeTerminal(){return Ce.activeTerminal},get terminals(){return Ce.terminals},async showTextDocument(_,w,S){if(b.isUri(_)&&_.scheme===ae.vscodeRemote&&!_.authority){v.report("workspace.showTextDocument",k,`A URI of 'vscode-remote' scheme requires an authority.`)}const fe=await(b.isUri(_)?Promise.resolve(qa.openTextDocument(_)):Promise.resolve(_));return Vt.showTextDocument(fe,w,S)},createTextEditorDecorationType(_){return Vt.createTextEditorDecorationType(k,_)},onDidChangeActiveTextEditor(_,w,S){return he(Vt.onDidChangeActiveTextEditor)(_,w,S)},onDidChangeVisibleTextEditors(_,w,S){return he(Vt.onDidChangeVisibleTextEditors)(_,w,S)},onDidChangeTextEditorSelection(_,w,S){return he(Vt.onDidChangeTextEditorSelection)(_,w,S)},onDidChangeTextEditorOptions(_,w,S){return he(Vt.onDidChangeTextEditorOptions)(_,w,S)},onDidChangeTextEditorVisibleRanges(_,w,S){return he(Vt.onDidChangeTextEditorVisibleRanges)(_,w,S)},onDidChangeTextEditorViewColumn(_,w,S){return he(Vt.onDidChangeTextEditorViewColumn)(_,w,S)},onDidChangeTextEditorDiffInformation(_,w,S){$(k,"textEditorDiffInformation");return he(Vt.onDidChangeTextEditorDiffInformation)(_,w,S)},onDidCloseTerminal(_,w,S){return he(Ce.onDidCloseTerminal)(_,w,S)},onDidOpenTerminal(_,w,S){return he(Ce.onDidOpenTerminal)(_,w,S)},onDidChangeActiveTerminal(_,w,S){return he(Ce.onDidChangeActiveTerminal)(_,w,S)},onDidChangeTerminalDimensions(_,w,S){$(k,"terminalDimensions");return he(Ce.onDidChangeTerminalDimensions)(_,w,S)},onDidChangeTerminalState(_,w,S){return he(Ce.onDidChangeTerminalState)(_,w,S)},onDidWriteTerminalData(_,w,S){$(k,"terminalDataWriteEvent");return he(Ce.onDidWriteTerminalData)(_,w,S)},onDidExecuteTerminalCommand(_,w,S){$(k,"terminalExecuteCommandEvent");return he(Ce.onDidExecuteTerminalCommand)(_,w,S)},onDidChangeTerminalShellIntegration(_,w,S){return he(Je.onDidChangeTerminalShellIntegration)(_,w,S)},onDidStartTerminalShellExecution(_,w,S){return he(Je.onDidStartTerminalShellExecution)(_,w,S)},onDidEndTerminalShellExecution(_,w,S){return he(Je.onDidEndTerminalShellExecution)(_,w,S)},get state(){return y.getState()},onDidChangeWindowState(_,w,S){return he(y.onDidChangeWindowState)(_,w,S)},showInformationMessage(_,...w){return hi.showMessage(k,jt.Info,_,w[0],w.slice(1))},showWarningMessage(_,...w){return hi.showMessage(k,jt.Warning,_,w[0],w.slice(1))},showErrorMessage(_,...w){return hi.showMessage(k,jt.Error,_,w[0],w.slice(1))},showQuickPick(_,w,S){return xo.showQuickPick(k,_,w,S)},showWorkspaceFolderPick(_){return xo.showWorkspaceFolderPick(_)},showInputBox(_,w){return xo.showInput(_,w)},showOpenDialog(_){return bh.showOpenDialog(_)},showSaveDialog(_){return bh.showSaveDialog(_)},createStatusBarItem(_,w,S){let fe;let He;let St;if(typeof _==="string"){fe=_;He=w;St=S}else{He=_;St=w}return Eo.createStatusBarEntry(k,fe,He,St)},setStatusBarMessage(_,w){return Eo.setStatusBarMessage(_,w)},withScmProgress(_){v.report("window.withScmProgress",k,`Use 'withProgress' instead.`);return Ws.withProgress(k,{location:ua.SourceControl},(w,S)=>_({report(fe){}}))},withProgress(_,w){return Ws.withProgress(k,_,w)},createOutputChannel(_,w){return ce.createOutputChannel(_,w,k)},createWebviewPanel(_,w,S,fe){return hn.createWebviewPanel(k,_,w,S,fe)},createWebviewTextEditorInset(_,w,S,fe){$(k,"editorInsets");return Km.createWebviewEditorInset(_,w,S,fe,k)},createTerminal(_,w,S){if(typeof _==="object"){if("pty"in _){return Ce.createExtensionTerminal(_)}return Ce.createTerminalFromOptions(_)}return Ce.createTerminal(_,w,S)},registerTerminalLinkProvider(_){return Ce.registerLinkProvider(_)},registerTerminalProfileProvider(_,w){return Ce.registerProfileProvider(k,_,w)},registerTerminalCompletionProvider(_,...w){$(k,"terminalCompletionProvider");return Ce.registerTerminalCompletionProvider(k,_,...w)},registerTerminalQuickFixProvider(_,w){$(k,"terminalQuickFixProvider");return Ce.registerTerminalQuickFixProvider(_,k.identifier.value,w)},registerTreeDataProvider(_,w){return Cn.registerTreeDataProvider(_,w,k)},createTreeView(_,w){return Cn.createTreeView(_,w,k)},registerWebviewPanelSerializer:(_,w)=>{return hn.registerWebviewPanelSerializer(k,_,w)},registerCustomEditorProvider:(_,w,S={})=>{return Zm.registerCustomEditorProvider(k,_,w,S)},registerFileDecorationProvider(_){return ne.registerFileDecorationProvider(_,k)},registerUriHandler(_){return _e.registerUriHandler(k,_)},createQuickPick(){return xo.createQuickPick(k)},createInputBox(){return xo.createInputBox(k)},get activeColorTheme(){return wh.activeColorTheme},onDidChangeActiveColorTheme(_,w,S){return he(wh.onDidChangeActiveColorTheme)(_,w,S)},registerWebviewViewProvider(_,w,S){return e1.registerWebviewViewProvider(k,_,w,S?.webviewOptions)},get activeNotebookEditor(){return Ue.activeNotebookEditor},onDidChangeActiveNotebookEditor(_,w,S){return he(Ue.onDidChangeActiveNotebookEditor)(_,w,S)},get visibleNotebookEditors(){return Ue.visibleNotebookEditors},get onDidChangeVisibleNotebookEditors(){return he(Ue.onDidChangeVisibleNotebookEditors)},onDidChangeNotebookEditorSelection(_,w,S){return he(Ri.onDidChangeNotebookEditorSelection)(_,w,S)},onDidChangeNotebookEditorVisibleRanges(_,w,S){return he(Ri.onDidChangeNotebookEditorVisibleRanges)(_,w,S)},showNotebookDocument(_,w){return Ue.showNotebookDocument(_,w)},registerExternalUriOpener(_,w,S){$(k,"externalUriOpener");return t1.registerExternalUriOpener(k.identifier,_,w,S)},registerProfileContentHandler(_,w){$(k,"profileContentHandlers");return Va.registerProfileContentHandler(k,_,w)},registerQuickDiffProvider(_,w,S,fe,He){$(k,"quickDiffProvider");return Qm.registerQuickDiffProvider(k,lt(_),w,S,fe,He)},get tabGroups(){return I.tabGroups},registerShareProvider(_,w){$(k,"shareProvider");return Jm.registerShareProvider(lt(_),w)},get nativeHandle(){$(k,"nativeWindowHandle");return y.nativeHandle},createChatStatusItem:_=>{$(k,"chatStatusItem");return s1.createChatStatusItem(k,_)}};const qa={get rootPath(){v.report("workspace.rootPath",k,`Please use 'workspace.workspaceFolders' instead. More details: https://aka.ms/vscode-eliminating-rootpath`);return r.getPath()},set rootPath(_){throw new Vo("rootPath")},getWorkspaceFolder(_){return r.getWorkspaceFolder(_)},get workspaceFolders(){return r.getWorkspaceFolders()},get name(){return r.name},set name(_){throw new Vo("name")},get workspaceFile(){return r.workspaceFile},set workspaceFile(_){throw new Vo("workspaceFile")},updateWorkspaceFolders:(_,w,...S)=>{return r.updateWorkspaceFolders(k,_,w||0,...S)},onDidChangeWorkspaceFolders:function(_,w,S){return he(r.onDidChangeWorkspace)(_,w,S)},asRelativePath:(_,w)=>{return r.getRelativePath(_,w)},findFiles:(_,w,S,fe)=>{return r.findFiles(_,w,S,k.identifier,fe)},findFiles2:(_,w,S)=>{$(k,"findFiles2");return r.findFiles2(_,w,k.identifier,S)},findTextInFiles:(_,w,S,fe)=>{$(k,"findTextInFiles");let He;let St;if(typeof w==="object"){He=w;St=S}else{He={};St=w;fe=S}return r.findTextInFiles(_,He||{},St,k.identifier,fe)},findTextInFiles2:(_,w,S)=>{$(k,"findTextInFiles2");$(k,"textSearchProvider2");return r.findTextInFiles2(_,w,k.identifier,S)},save:_=>{return r.save(_)},saveAs:_=>{return r.saveAs(_)},saveAll:_=>{return r.saveAll(_)},applyEdit(_,w){return i1.applyWorkspaceEdit(_,k,w)},createFileSystemWatcher:(_,w,S,fe)=>{const He={ignoreCreateEvents:Boolean(w),ignoreChangeEvents:Boolean(S),ignoreDeleteEvents:Boolean(fe)};return Vs.createFileSystemWatcher(r,Bc,k,_,He)},get textDocuments(){return be.getAllDocumentData().map(_=>_.document)},set textDocuments(_){throw new Vo("textDocuments")},openTextDocument(_,w){let S;w=w??_;if(typeof _==="string"){S=Promise.resolve(b.file(_))}else if(b.isUri(_)){S=Promise.resolve(_)}else if(!w||typeof w==="object"){S=be.createDocumentData(w)}else{throw new Error("illegal argument - uriOrFileNameOrOptions")}return S.then(fe=>{f.trace(`openTextDocument from ${k.identifier}`);if(fe.scheme===ae.vscodeRemote&&!fe.authority){v.report("workspace.openTextDocument",k,`A URI of 'vscode-remote' scheme requires an authority.`)}return be.ensureDocumentData(fe,w).then(He=>{return He.document})})},onDidOpenTextDocument:(_,w,S)=>{return he(be.onDidAddDocument)(_,w,S)},onDidCloseTextDocument:(_,w,S)=>{return he(be.onDidRemoveDocument)(_,w,S)},onDidChangeTextDocument:(_,w,S)=>{return he(be.onDidChangeDocument)(_,w,S)},onDidSaveTextDocument:(_,w,S)=>{return he(be.onDidSaveDocument)(_,w,S)},onWillSaveTextDocument:(_,w,S)=>{return he(Et.getOnWillSaveTextDocumentEvent(k))(_,w,S)},get notebookDocuments(){return Ue.notebookDocuments.map(_=>_.apiNotebook)},async openNotebookDocument(_,w){let S;if(b.isUri(_)){S=_;await Ue.openNotebookDocument(_)}else if(typeof _==="string"){S=b.revive(await Ue.createNotebookDocument({viewType:_,content:w}))}else{throw new Error("Invalid arguments")}return Ue.getNotebookDocument(S).apiNotebook},onDidSaveNotebookDocument(_,w,S){return he(Gt.onDidSaveNotebookDocument)(_,w,S)},onDidChangeNotebookDocument(_,w,S){return he(Gt.onDidChangeNotebookDocument)(_,w,S)},onWillSaveNotebookDocument(_,w,S){return he(bi.getOnWillSaveNotebookDocumentEvent(k))(_,w,S)},get onDidOpenNotebookDocument(){return he(Ue.onDidOpenNotebookDocument)},get onDidCloseNotebookDocument(){return he(Ue.onDidCloseNotebookDocument)},registerNotebookSerializer(_,w,S,fe){return Ue.registerNotebookSerializer(k,_,w,S,dt(k,"notebookLiveShare")?fe:void 0)},onDidChangeConfiguration:(_,w,S)=>{return he(Bc.onDidChangeConfiguration)(_,w,S)},getConfiguration(_,w){w=arguments.length===1?void 0:w;return Bc.getConfiguration(_,w,k)},registerTextDocumentContentProvider(_,w){return Ke.registerTextDocumentContentProvider(_,w)},registerTaskProvider:(_,w)=>{v.report("window.registerTaskProvider",k,`Use the corresponding function on the 'tasks' namespace instead`);return G.registerTaskProvider(k,_,w)},registerFileSystemProvider(_,w,S){return g0(Bs.registerFileSystemProvider(k,_,w,S),n.addFileSystemProvider(_,w,S))},get fs(){return n.value},registerFileSearchProvider:(_,w)=>{$(k,"fileSearchProvider");return se.registerFileSearchProviderOld(_,w)},registerTextSearchProvider:(_,w)=>{$(k,"textSearchProvider");return se.registerTextSearchProviderOld(_,w)},registerAITextSearchProvider:(_,w)=>{$(k,"aiTextSearchProvider");$(k,"textSearchProvider2");return se.registerAITextSearchProvider(_,w)},registerFileSearchProvider2:(_,w)=>{$(k,"fileSearchProvider2");return se.registerFileSearchProvider(_,w)},registerTextSearchProvider2:(_,w)=>{$(k,"textSearchProvider2");return se.registerTextSearchProvider(_,w)},registerRemoteAuthorityResolver:(_,w)=>{$(k,"resolvers");return s.registerRemoteAuthorityResolver(_,w)},registerResourceLabelFormatter:_=>{$(k,"resolvers");return Xm.$registerResourceLabelFormatter(_)},getRemoteExecServer:_=>{$(k,"resolvers");return s.getRemoteExecServer(_)},onDidCreateFiles:(_,w,S)=>{return he(Vs.onDidCreateFile)(_,w,S)},onDidDeleteFiles:(_,w,S)=>{return he(Vs.onDidDeleteFile)(_,w,S)},onDidRenameFiles:(_,w,S)=>{return he(Vs.onDidRenameFile)(_,w,S)},onWillCreateFiles:(_,w,S)=>{return he(Vs.getOnWillCreateFileEvent(k))(_,w,S)},onWillDeleteFiles:(_,w,S)=>{return he(Vs.getOnWillDeleteFileEvent(k))(_,w,S)},onWillRenameFiles:(_,w,S)=>{return he(Vs.getOnWillRenameFileEvent(k))(_,w,S)},openTunnel:_=>{$(k,"tunnels");return m.openTunnel(k,_).then(w=>{if(!w){throw new Error("cannot open tunnel")}return w})},get tunnels(){$(k,"tunnels");return m.getTunnels()},onDidChangeTunnels:(_,w,S)=>{$(k,"tunnels");return he(m.onDidChangeTunnels)(_,w,S)},registerPortAttributesProvider:(_,w)=>{$(k,"portsAttributes");return m.registerPortsAttributesProvider(_,w)},registerTunnelProvider:(_,w)=>{$(k,"tunnelFactory");return m.registerTunnelProvider(_,w)},registerTimelineProvider:(_,w)=>{$(k,"timeline");return Ym.registerTimelineProvider(_,w,k.identifier,le.converter)},get isTrusted(){return r.trusted},requestWorkspaceTrust:_=>{$(k,"workspaceTrust");return r.requestWorkspaceTrust(_)},onDidGrantWorkspaceTrust:(_,w,S)=>{return he(r.onDidGrantWorkspaceTrust)(_,w,S)},registerEditSessionIdentityProvider:(_,w)=>{$(k,"editSessionIdentityProvider");return r.registerEditSessionIdentityProvider(_,w)},onWillCreateEditSessionIdentity:(_,w,S)=>{$(k,"editSessionIdentityProvider");return he(r.getOnWillCreateEditSessionIdentityEvent(k))(_,w,S)},registerCanonicalUriProvider:(_,w)=>{$(k,"canonicalUriProvider");return r.registerCanonicalUriProvider(_,w)},getCanonicalUri:(_,w,S)=>{$(k,"canonicalUriProvider");return r.provideCanonicalUri(_,w,S)},decode(_,w){return r.decode(_,w)},encode(_,w){return r.encode(_,w)}};const d1={get inputBox(){v.report("scm.inputBox",k,`Use 'SourceControl.inputBox' instead`);return ot.getLastInputBox(k)},createSourceControl(_,w,S){return ot.createSourceControl(k,_,w,S)}};const h1={createCommentController(_,w){return vh.createCommentController(k,_,w)}};const f1={get activeDebugSession(){return We.activeDebugSession},get activeDebugConsole(){return We.activeDebugConsole},get breakpoints(){return We.breakpoints},get activeStackItem(){return We.activeStackItem},registerDebugVisualizationProvider(_,w){$(k,"debugVisualization");return We.registerDebugVisualizationProvider(k,_,w)},registerDebugVisualizationTreeProvider(_,w){$(k,"debugVisualization");return We.registerDebugVisualizationTree(k,_,w)},onDidStartDebugSession(_,w,S){return he(We.onDidStartDebugSession)(_,w,S)},onDidTerminateDebugSession(_,w,S){return he(We.onDidTerminateDebugSession)(_,w,S)},onDidChangeActiveDebugSession(_,w,S){return he(We.onDidChangeActiveDebugSession)(_,w,S)},onDidReceiveDebugSessionCustomEvent(_,w,S){return he(We.onDidReceiveDebugSessionCustomEvent)(_,w,S)},onDidChangeBreakpoints(_,w,S){return he(We.onDidChangeBreakpoints)(_,w,S)},onDidChangeActiveStackItem(_,w,S){return he(We.onDidChangeActiveStackItem)(_,w,S)},registerDebugConfigurationProvider(_,w,S){return We.registerDebugConfigurationProvider(_,w,S||_p.Initial)},registerDebugAdapterDescriptorFactory(_,w){return We.registerDebugAdapterDescriptorFactory(k,_,w)},registerDebugAdapterTrackerFactory(_,w){return We.registerDebugAdapterTrackerFactory(_,w)},startDebugging(_,w,S){if(!S||typeof S==="object"&&"configuration"in S){return We.startDebugging(_,w,{parentSession:S})}return We.startDebugging(_,w,S||{})},stopDebugging(_){return We.stopDebugging(_)},addBreakpoints(_){return We.addBreakpoints(_)},removeBreakpoints(_){return We.removeBreakpoints(_)},asDebugSourceUri(_,w){return We.asDebugSourceUri(_,w)}};const x={registerTaskProvider:(_,w)=>{return G.registerTaskProvider(k,_,w)},fetchTasks:_=>{return G.fetchTasks(_)},executeTask:_=>{return G.executeTask(k,_)},get taskExecutions(){return G.taskExecutions},onDidStartTask:(_,w,S)=>{return he(G.onDidStartTask)(_,w,S)},onDidEndTask:(_,w,S)=>{return he(G.onDidEndTask)(_,w,S)},onDidStartTaskProcess:(_,w,S)=>{return he(G.onDidStartTaskProcess)(_,w,S)},onDidEndTaskProcess:(_,w,S)=>{return he(G.onDidEndTaskProcess)(_,w,S)},onDidStartTaskProblemMatchers:(_,w,S)=>{$(k,"taskProblemMatcherStatus");return he(G.onDidStartTaskProblemMatchers)(_,w,S)},onDidEndTaskProblemMatchers:(_,w,S)=>{$(k,"taskProblemMatcherStatus");return he(G.onDidEndTaskProblemMatchers)(_,w,S)}};const F={createNotebookController(_,w,S,fe,He){return At.createNotebookController(k,_,w,S,fe,dt(k,"notebookMessaging")?He:void 0)},registerNotebookCellStatusBarItemProvider:(_,w)=>{return Ue.registerNotebookCellStatusBarItemProvider(k,_,w)},createRendererMessaging(_){return dn.createRendererMessaging(k,_)},createNotebookControllerDetectionTask(_){$(k,"notebookKernelSource");return At.createNotebookControllerDetectionTask(k,_)},registerKernelSourceActionProvider(_,w){$(k,"notebookKernelSource");return At.registerKernelSourceActionProvider(k,_,w)},onDidChangeNotebookCellExecutionState(_,w,S){$(k,"notebookCellExecutionState");return he(At.onDidChangeNotebookCellExecutionState)(_,w,S)}};const B={t(..._){if(typeof _[0]==="string"){const w=_.shift();const S=!_||typeof _[0]!=="object"?_:_[0];return ie.getMessage(k.identifier.value,{message:w,args:S})}return ie.getMessage(k.identifier.value,_[0])},get bundle(){return ie.getBundle(k.identifier.value)},get uri(){return ie.getBundleUri(k.identifier.value)}};const re={transferActiveChat(_){$(k,"interactive");return ds.transferActiveChat(_)}};const K={getRelatedInformation(_,w){$(k,"aiRelatedInformation");return Uc.getRelatedInformation(k,_,w)},registerRelatedInformationProvider(_,w){$(k,"aiRelatedInformation");return Uc.registerRelatedInformationProvider(k,_,w)},registerEmbeddingVectorProvider(_,w){$(k,"aiRelatedInformation");return $c.registerEmbeddingVectorProvider(k,_,w)},registerSettingsSearchProvider(_){$(k,"aiSettingsSearch");return Hc.registerSettingsSearchProvider(k,_)}};const De={registerMappedEditsProvider(_,w){$(k,"mappedEditsProvider");return{dispose(){}}},registerMappedEditsProvider2(_){$(k,"mappedEditsProvider");return Hs.registerMappedEditsProvider(k,_)},createChatParticipant(_,w){return ds.createChatAgent(k,_,w)},createDynamicChatParticipant(_,w,S){$(k,"chatParticipantPrivate");return ds.createDynamicChatAgent(k,_,w,S)},registerChatParticipantDetectionProvider(_){$(k,"chatParticipantPrivate");return ds.registerChatParticipantDetectionProvider(k,_)},registerRelatedFilesProvider(_,w){$(k,"chatEditing");return ds.registerRelatedFilesProvider(k,_,w)},onDidDisposeChatSession:(_,w,S)=>{$(k,"chatParticipantPrivate");return he(ds.onDidDisposeChatSession)(_,w,S)}};const Ne={selectChatModels:_=>{return H.selectLanguageModels(k,_??{})},onDidChangeChatModels:(_,w,S)=>{return H.onDidChangeProviders(_,w,S)},registerChatModelProvider:(_,w,S)=>{$(k,"chatProvider");return H.registerLanguageModel(k,_,w,S)},get embeddingModels(){$(k,"embeddings");return $n.embeddingsModels},onDidChangeEmbeddingModels:(_,w,S)=>{$(k,"embeddings");return $n.onDidChange(_,w,S)},registerEmbeddingsProvider(_,w){$(k,"embeddings");return $n.registerEmbeddingsProvider(k,_,w)},async computeEmbeddings(_,w,S){$(k,"embeddings");if(typeof w==="string"){return $n.computeEmbeddings(_,w,S)}else{return $n.computeEmbeddings(_,w,S)}},registerTool(_,w){return zs.registerTool(k,_,w)},invokeTool(_,w,S){return zs.invokeTool(k,_,w,S)},get tools(){return zs.getTools(k)},fileIsIgnored(_,w){return H.fileIsIgnored(k,_,w)},registerIgnoredFileProvider(_){return H.registerIgnoredFileProvider(k,_)},registerMcpServerDefinitionProvider(_,w){$(k,"mcpConfigurationProvider");return Q.registerMcpConfigurationProvider(k,_,w)}};Ne.registerMcpConfigurationProvider=Ne.registerMcpServerDefinitionProvider;const Ge={registerSpeechProvider(_,w){$(k,"speech");return en.registerProvider(k.identifier,_,w)}};return{version:e.version,ai:K,authentication:r1,commands:o1,comments:h1,chat:De,debug:f1,env:Wa,extensions:l1,interactive:re,l10n:B,languages:c1,lm:Ne,notebooks:F,scm:d1,speech:Ge,tasks:x,tests:a1,window:u1,workspace:qa,Breakpoint:oc,TerminalOutputAnchor:Z_,ChatResultFeedbackKind:Ad,ChatVariableLevel:$v,ChatCompletionItem:S3,ChatReferenceDiagnostic:aC,CallHierarchyIncomingCall:M4,CallHierarchyItem:Z0,CallHierarchyOutgoingCall:U4,CancellationError:Us,CancellationTokenSource:Ot,CandidatePortSource:l_,CodeAction:dd,CodeActionKind:Pt,CodeActionTriggerKind:ud,CodeLens:Fp,Color:nc,ColorInformation:Vp,ColorPresentation:Wp,ColorThemeKind:Yr,CommentMode:Ev,CommentState:Sv,CommentThreadCollapsibleState:Ed,CommentThreadState:Sd,CommentThreadApplicability:Dd,CommentThreadFocus:kd,CompletionItem:$p,CompletionItemKind:ke,CompletionItemTag:fd,CompletionList:ec,CompletionTriggerKind:Cl,ConfigurationTarget:Rl,CustomExecution:ey,DebugAdapterExecutable:Qp,DebugAdapterInlineImplementation:bd,DebugAdapterNamedPipeServer:Jp,DebugAdapterServer:wd,DebugConfigurationProviderTriggerKind:_p,DebugConsoleMode:tg,DebugVisualization:_3,DecorationRangeBehavior:Qo,Diagnostic:Ap,DiagnosticRelatedInformation:rd,DiagnosticSeverity:Di,DiagnosticTag:Go,Disposable:qe,DocumentHighlight:Np,DocumentHighlightKind:od,MultiDocumentHighlight:Op,DocumentLink:Bp,DocumentSymbol:cd,EndOfLine:ss,EnvironmentVariableMutatorType:kl,EvaluatableExpression:Xp,InlineValueText:Yp,InlineValueVariableLookup:Zp,InlineValueEvaluatableExpression:eg,InlineCompletionTriggerKind:yd,EventEmitter:L,ExtensionKind:ha,ExtensionMode:Fl,ExternalUriOpenerPriority:Nv,FileChangeType:Nl,FileDecoration:Iv,FileDecoration2:Iv,FileSystemError:si,FileType:ra,FilePermission:Ql,FoldingRange:xv,FoldingRangeKind:rr,FunctionBreakpoint:Xo,InlineCompletionItem:ov,InlineCompletionList:av,Hover:Rp,VerboseHover:Lp,HoverVerbosityAction:ev,IndentAction:Ub,Location:kn,MarkdownString:cn,OverviewRulerLane:D_,ParameterInformation:tv,PortAutoForwardAction:Fv,Position:Ve,ProcessExecution:sc,ProgressLocation:ua,QuickInputButtonLocation:kv,QuickInputButtons:Id,Range:Oe,RelativePattern:Ll,Selection:Dr,SelectionRange:hd,SemanticTokens:ac,SemanticTokensBuilder:ty,SemanticTokensEdit:W4,SemanticTokensEdits:df,SemanticTokensLegend:Dv,ShellExecution:Ia,ShellQuoting:mv,SignatureHelp:nv,SignatureHelpTriggerKind:sv,SignatureInformation:iv,SnippetString:ka,SourceBreakpoint:Jo,StandardTokenType:so,StatusBarAlignment:no,SymbolInformation:ld,SymbolKind:gt,SymbolTag:ad,Task:zp,TaskEventKind:pv,TaskGroup:_d,TaskPanelKind:gv,TaskRevealKind:fv,TaskScope:mo,TerminalLink:r3,TerminalQuickFixTerminalCommand:a3,TerminalQuickFixOpener:o3,TerminalLocation:dv,TerminalProfile:l3,TerminalExitReason:cv,TerminalShellExecutionCommandLineConfidence:md,TerminalCompletionItem:c3,TerminalCompletionItemKind:hv,TerminalCompletionList:u3,TerminalShellType:uv,TextDocumentSaveReason:Pl,TextEdit:go,SnippetTextEdit:ca,TextEditorCursorStyle:ts,TextEditorChangeKind:Al,TextEditorLineNumbersStyle:Qn,TextEditorRevealType:Hp,TextEditorSelectionChangeKind:tc,SyntaxTokenType:ic,TextDocumentChangeReason:gd,ThemeColor:vd,ThemeIcon:Vi,TreeItem:qp,TreeItemCheckboxState:ys,TreeItemCollapsibleState:da,TypeHierarchyItem:iy,UIKind:Wu,Uri:b,ViewColumn:pd,WorkspaceEdit:Da,DocumentPasteTriggerKind:wv,DocumentDropEdit:vv,DocumentDropOrPasteEditKind:Mn,DocumentPasteEdit:f3,InlayHint:Up,InlayHintLabelPart:Mp,InlayHintKind:rv,RemoteAuthorityResolverError:bs,ResolvedAuthority:n3,ManagedResolvedAuthority:uf,SourceControlInputBoxValidationType:lv,ExtensionRuntime:ag,TimelineItem:Rv,NotebookRange:gr,NotebookCellKind:Yo,NotebookCellExecutionState:lc,NotebookCellData:Pm,NotebookData:z4,NotebookRendererScript:j4,NotebookCellStatusBarAlignment:sg,NotebookEditorRevealType:rg,NotebookCellOutput:ng,NotebookCellOutputItem:q4,CellErrorStackFrame:v3,NotebookCellStatusBarItem:w3,NotebookControllerAffinity:Av,NotebookControllerAffinity2:og,NotebookEdit:Pp,NotebookKernelSourceAction:b3,NotebookVariablesRequestKind:Td,PortAttributes:x3,LinkedEditingRanges:y3,TestResultState:Lv,TestRunRequest:lg,TestMessage:cg,TestMessageStackFrame:E3,TestTag:Pd,TestRunProfileKind:Ml,TextSearchCompleteMessageType:Kg,DataTransfer:rc,DataTransferItem:jp,TestCoverageCount:hf,FileCoverage:cc,StatementCoverage:K4,BranchCoverage:Q4,DeclarationCoverage:J4,WorkspaceTrustState:Ov,LanguageStatusSeverity:Il,QuickPickItemKind:Cd,InputBoxValidationSeverity:Ol,TabInputText:ny,TabInputTextDiff:ug,TabInputTextMerge:X4,TabInputCustom:sy,TabInputNotebook:ry,TabInputNotebookDiff:oy,TabInputWebview:Y4,TabInputTerminal:Z4,TabInputInteractiveWindow:eC,TabInputChat:tC,TabInputTextMultiDiff:iC,TelemetryTrustedValue:Q0,LogLevel:Be,EditSessionIdentityMatch:$b,InteractiveSessionVoteDirection:Mv,ChatCopyKind:Uv,ChatEditingSessionActionOutcome:Zo,InteractiveEditorResponseFeedbackKind:Bv,DebugStackFrame:B4,DebugThread:V4,RelatedInformationType:Jv,SpeechToTextStatus:Yv,TextToSpeechStatus:Zv,PartialAcceptTriggerKind:Ko,InlineCompletionEndOfLifeReasonKind:Tl,KeywordRecognitionStatus:ew,ChatImageMimeType:gg,ChatResponseMarkdownPart:Am,ChatResponseFileTreePart:Rm,ChatResponseAnchorPart:Ld,ChatResponseProgressPart:ay,ChatResponseProgressPart2:pf,ChatResponseReferencePart:fa,ChatResponseReferencePart2:fa,ChatResponseCodeCitationPart:hg,ChatResponseCodeblockUriPart:Nm,ChatResponseWarningPart:Nd,ChatResponseTextEditPart:Od,ChatResponseNotebookEditPart:fg,ChatResponseMarkdownWithVulnerabilitiesPart:Rd,ChatResponseCommandButtonPart:Lm,ChatResponseConfirmationPart:dg,ChatResponseMovePart:Om,ChatResponseExtensionsPart:ly,ChatResponseReferencePartStatusKind:Wv,ChatRequestTurn:Vv,ChatRequestTurn2:Vv,ChatResponseTurn:nC,ChatLocation:Jn,ChatRequestEditorData:sC,ChatRequestNotebookData:rC,ChatReferenceBinaryData:oC,ChatRequestEditedFileEventKind:Hv,LanguageModelChatMessageRole:on,LanguageModelChatMessage:lC,LanguageModelChatMessage2:cC,LanguageModelToolResultPart:pg,LanguageModelToolResultPart2:zv,LanguageModelTextPart:Ht,LanguageModelToolCallPart:Ca,LanguageModelError:pi,LanguageModelToolResult:Fm,LanguageModelToolResult2:uC,LanguageModelDataPart:On,LanguageModelExtraDataPart:Kv,ExtendedLanguageModelToolResult:k3,PreparedTerminalToolInvocation:D3,LanguageModelChatToolMode:Qv,LanguageModelPromptTsxPart:Ms,NewSymbolName:g3,NewSymbolNameTag:yv,NewSymbolNameTriggerKind:xd,InlineEdit:I3,InlineEditTriggerKind:Fd,ExcludeSettingOptions:ar,TextSearchContext2:cy,TextSearchMatch2:ro,AISearchKeyword:$w,TextSearchCompleteMessageTypeNew:Kg,ChatErrorLevel:qv,McpHttpServerDefinition:T3,McpStdioServerDefinition:C3,SettingsSearchResultKind:Xv}}}var Df;let o0=class rH{constructor(e,i,n,s,r,o,a){this._apiFactory=e;this._extensionRegistry=i;this._instaService=n;this._extHostConfiguration=s;this._extHostExtensionService=r;this._initData=o;this._logService=a;this._factories=new Map;this._alternatives=[]}async install(){this._installInterceptor();Qi("code/extHost/willWaitForConfig");const e=await this._extHostConfiguration.getConfigProvider();Qi("code/extHost/didWaitForConfig");const i=await this._extHostExtensionService.getExtensionPathIndex();this.register(new XF(this._apiFactory,i,this._extensionRegistry,e,this._logService));this.register(this._instaService.createInstance(a0));if(this._initData.remote.isRemote){this.register(this._instaService.createInstance(l0,i,this._initData.environment.appUriScheme))}}register(e){if("nodeModuleName"in e){if(Array.isArray(e.nodeModuleName)){for(const i of e.nodeModuleName){this._factories.set(i,e)}}else{this._factories.set(e.nodeModuleName,e)}}if(typeof e.alternativeModuleName==="function"){this._alternatives.push(i=>{return e.alternativeModuleName(i)})}}};o0=z([O(2,ch),O(3,Tr),O(4,bo),O(5,Ai),O(6,at)],o0);let a0=class oH{static{Df=this}static{this.aliased=new Map([["vscode-ripgrep","@vscode/ripgrep"],["vscode-windows-registry","@vscode/windows-registry"]])}constructor(e){if(e.environment.appRoot&&Df.aliased.size){const i=ya(this.forceForwardSlashes(e.environment.appRoot.fsPath));const n=`[a-z0-9_.-]`;const s=`@${n}+\\/${n}+|${n}+`;const r="node_modules|node_modules\\.asar(?:\\.unpacked)?";this.re=new RegExp(`^(${i}/${r}\\/)(${s})(.*)$`,"i")}}alternativeModuleName(e){if(!this.re){return}const i=this.re.exec(this.forceForwardSlashes(e));if(!i){return}const[,n,s,r]=i;const o=Df.aliased.get(s);if(o===void 0){return}console.warn(`${s} as been renamed to ${o}, please update your imports`);return n+o+r}forceForwardSlashes(e){return e.replace(/\\/g,"/")}};a0=Df=z([O(0,Ai)],a0);class XF{constructor(e,i,n,s,r){this._apiFactory=e;this._extensionPaths=i;this._extensionRegistry=n;this._configProvider=s;this._logService=r;this.nodeModuleName="vscode";this._extApiImpl=new Sr}load(e,i){const n=this._extensionPaths.findSubstr(i);if(n){let s=this._extApiImpl.get(n.identifier);if(!s){s=this._apiFactory(n,this._extensionRegistry,this._configProvider);this._extApiImpl.set(n.identifier,s)}return s}if(!this._defaultApiImpl){let s="";this._extensionPaths.forEach((r,o)=>s+=`	${o} -> ${r.identifier.value}
`);this._logService.warn(`Could not identify extension for 'vscode' require call from ${i}. These are the extension path mappings: 
${s}`);this._defaultApiImpl=this._apiFactory(LR,this._extensionRegistry,this._configProvider)}return this._defaultApiImpl}}let l0=class aH{constructor(e,i,n){this._extensionPaths=e;this._appUriScheme=i;this.nodeModuleName=["open","opn"];this._mainThreadTelemetry=n.getProxy(Y.MainThreadTelemetry);const s=n.getProxy(Y.MainThreadWindow);this._impl=(r,o)=>{const a=b.parse(r);if(o){return this.callOriginal(r,o)}if(a.scheme==="http"||a.scheme==="https"){return s.$openUri(a,r,{allowTunneling:true})}else if(a.scheme==="mailto"||a.scheme===this._appUriScheme){return s.$openUri(a,r,{})}return this.callOriginal(r,o)}}load(e,i,n){const s=this._extensionPaths.findSubstr(i);if(s){this._extensionId=s.identifier.value;this.sendShimmingTelemetry()}this._original=n(e);return this._impl}callOriginal(e,i){this.sendNoForwardTelemetry();return this._original(e,i)}sendShimmingTelemetry(){if(!this._extensionId){return}this._mainThreadTelemetry.$publicLog2("shimming.open",{extension:this._extensionId})}sendNoForwardTelemetry(){if(!this._extensionId){return}this._mainThreadTelemetry.$publicLog2("shimming.open.call.noForward",{extension:this._extensionId})}};l0=z([O(2,st)],l0);let c0=class lH{constructor(e,i){this._mainThreadConsole=e.getProxy(Y.MainThreadConsole);this._includeStack=i.consoleForward.includeStack;this._logNative=i.consoleForward.logNative;this._wrapConsoleMethod("info","log");this._wrapConsoleMethod("log","log");this._wrapConsoleMethod("warn","warn");this._wrapConsoleMethod("debug","debug");this._wrapConsoleMethod("error","error")}_wrapConsoleMethod(e,i){const n=this;const s=console[e];Object.defineProperty(console,e,{set:()=>{},get:()=>function(){n._handleConsoleCall(e,i,s,arguments)}})}_handleConsoleCall(e,i,n,s){this._mainThreadConsole.$logExtensionHostMessage({type:"__$console",severity:i,arguments:ZF(s,this._includeStack)});if(this._logNative){this._nativeConsoleLogMessage(e,n,s)}}};c0=z([O(0,st),O(1,Ai)],c0);const YF=1e5;function ZF(t,e){const i=[];if(t.length){for(let n=0;n<t.length;n++){let s=t[n];if(typeof s==="undefined"){s="undefined"}else if(s instanceof Error){const r=s;if(r.stack){s=r.stack}else{s=r.toString()}}i.push(s)}}if(e){const n=new Error().stack;if(n){i.push({__$stack:n.split("\n").slice(3).join("\n")})}}try{const n=i7(i);if(n.length>YF){return"Output omitted for a large object that exceeds the limits"}return n}catch(n){return`Output omitted for an object that cannot be inspected ('${n.toString()}')`}}let u0=class cH extends c0{constructor(e,i){super(e,i)}_nativeConsoleLogMessage(e,i,n){i.apply(console,n)}};u0=z([O(0,st),O(1,Ai)],u0);class eM extends o0{_installInterceptor(){}getModule(e,i){for(const n of this._alternatives){const s=n(e);if(s){e=s;break}}if(this._factories.has(e)){return this._factories.get(e).load(e,i,()=>{throw new Error("CANNOT LOAD MODULE from here.")})}return void 0}}class tM extends db{constructor(){super(...arguments);this.extensionRuntime=ag.Webworker}async _beforeAlmostReadyToRunExtensions(){if(ju){this._instaService.createInstance(u0)}this._apiFactory=this._instaService.invokeFunction(JF);this._fakeModules=this._instaService.createInstance(eM,this._apiFactory,{mine:this._myRegistry,all:this._globalRegistry});await this._fakeModules.install();performance.mark("code/extHost/didInitAPI");await this._waitForDebuggerAttachment()}_getEntryPoint(e){return e.browser}async _loadCommonJSModule(e,i,n){i=i.with({path:iM(i.path,".js")});const s=e?.identifier.value;if(s){performance.mark(`code/extHost/willFetchExtensionCode/${s}`)}const r=b.revive(await this._mainThreadExtensionsProxy.$asBrowserUri(i));const o=await fetch(r.toString(true));if(s){performance.mark(`code/extHost/didFetchExtensionCode/${s}`)}if(o.status!==200){throw new Error(o.statusText)}const a=await o.text();const l=`${i.toString(true)}#vscode-extension`;const c=`${a}
//# sourceURL=${l}`;let u;try{u=new Function("module","exports","require",c)}catch(m){if(s){console.error(`Loading code for extension ${s} failed: ${m.message}`)}else{console.error(`Loading code failed: ${m.message}`)}console.error(`${i.toString(true)}${typeof m.line==="number"?` line ${m.line}`:""}${typeof m.column==="number"?` column ${m.column}`:""}`);console.error(m);throw m}if(e){await this._extHostLocalizationService.initializeLocalizedMessages(e)}const d={};const p={exports:d};const f=m=>{const v=this._fakeModules.getModule(m,i);if(v===void 0){throw new Error(`Cannot load module '${m}'`)}return v};try{n.codeLoadingStart();if(s){performance.mark(`code/extHost/willLoadExtensionCode/${s}`)}u(p,d,f);return p.exports!==d?p.exports:d}finally{if(s){performance.mark(`code/extHost/didLoadExtensionCode/${s}`)}n.codeLoadingStop()}}_loadESMModule(e,i,n){throw new Error("ESM modules are not supported in the web worker extension host")}async $setRemoteEnvironment(e){return}async _waitForDebuggerAttachment(e=5e3){if(!this._initData.environment.isExtensionDevelopmentDebug){return}const i=Date.now()+e;while(Date.now()<i&&!("__jsDebugIsReady"in globalThis)){await Ts(10)}}}function iM(t,e){return t.endsWith(e)?t:t+e}xt(bo,tM,_t.Eager);xt(py,Jw,_t.Eager);xt(Vm,new Zn(ib,[true],true));const g5=self.close.bind(self);self.close=()=>console.trace(`'close' has been blocked`);const m5=postMessage.bind(self);self.postMessage=()=>console.trace(`'postMessage' has been blocked`);function Ck(t){return/^(file|extension-file|vscode-remote):/i.test(t)}const Tk=fetch.bind(self);function nM(t){self.fetch=async function(e,i){if(e instanceof Request){return Tk(e,i)}if(Ck(String(e))){e=(await t(b.parse(String(e)))).toString(true)}return Tk(e,i)};self.XMLHttpRequest=class extends XMLHttpRequest{open(e,i,n,s,r){(async()=>{if(Ck(i.toString())){i=(await t(b.parse(i.toString()))).toString(true)}super.open(e,i,n??true,s,r)})()}}}self.importScripts=()=>{throw new Error(`'importScripts' has been blocked`)};self.addEventListener=()=>console.trace(`'addEventListener' has been blocked`);self["AMDLoader"]=void 0;self["NLSLoaderPlugin"]=void 0;self["define"]=void 0;self["require"]=void 0;self["webkitRequestFileSystem"]=void 0;self["webkitRequestFileSystemSync"]=void 0;self["webkitResolveLocalFileSystemSyncURL"]=void 0;self["webkitResolveLocalFileSystemURL"]=void 0;function sM(t,e){if(self.Worker){const i=self.Worker;Worker=function(n,s){if(/^vscode-remote:/i.test(n.toString())){throw new Error(`Creating workers from remote extensions is currently not supported.`)}async function r(a){const[l,c]=await Promise.all([t(a).then(f=>f.toString(true)),e().then(f=>Object.fromEntries(f.map(([m,v])=>[m.toString(true),v.toString(true)])))]);const u=function f(m,v){function y(R){if(typeof R==="string"||R instanceof URL){R=String(R).replace(/^file:\/\//i,"vscode-file://vscode-app");return v[R]??R}return R}const D=fetch.bind(self);self.fetch=function(R,J){if(R instanceof Request){return D(R,J)}return D(y(R),J)};self.XMLHttpRequest=class extends XMLHttpRequest{constructor(){super(...arguments);this.notFound=false}open(R,J,H,Q,ne){const te=y(J);this.notFound=te.startsWith("extension-file:");return super.open(R,te,H??true,Q,ne)}send(R){if(this.notFound){return}super.send(R)}get status(){return this.notFound?404:super.status}};const I=importScripts.bind(self);self.importScripts=(...R)=>{I(...R.map(y))};self.importExt=R=>{return new Function("url","return import(url)")(y(R))};I(m)}.toString();const d=`(${u}('${l}', ${JSON.stringify(c)}))`;const p=new Blob([d],{type:"application/javascript"});return URL.createObjectURL(p)}s=s||{};s.name=`${name} -> ${s.name||rn(n.toString())}`;class o{constructor(l,c){this._onmessage=null;this._onmessageerror=null;this._onerror=null;this.workerPromise=r(b.parse(l instanceof URL?l.toString():l)).then(u=>{return new i(u,c)})}set onmessage(l){this._onmessage=l;this.workerPromise.then(c=>{c.onmessage=l},console.error)}get onmessage(){return this._onmessage}set onmessageerror(l){this._onmessageerror=l;this.workerPromise.then(c=>{c.onmessageerror=l},console.error)}get onmessageerror(){return this._onmessageerror}set onerror(l){this._onerror=l;this.workerPromise.then(c=>{c.onerror=l},console.error)}get onerror(){return this._onerror}postMessage(l,c){this.workerPromise.then(u=>{u.postMessage(l,c)},console.error)}terminate(){this.workerPromise.then(l=>{l.terminate()},console.error)}addEventListener(l,c,u){this.workerPromise.then(d=>{d.addEventListener(l,c,u)},console.error)}removeEventListener(l,c,u){this.workerPromise.then(d=>{d.removeEventListener(l,c,u)},console.error)}dispatchEvent(l){this.workerPromise.then(c=>{c.dispatchEvent(l)},console.error);return false}}return new o(n,s)}}else{self.Worker=class extends bL{constructor(i,n){super(m5,i,{name:rn(i.toString()),...n})}}}}const rM=new class{constructor(){this.pid=void 0}exit(t){g5()}};class oM{constructor(){const e=new MessageChannel;const i=new L;let n=false;m5(e.port2,[e.port2]);e.port1.onmessage=s=>{const{data:r}=s;if(!(r instanceof ArrayBuffer)){console.warn("UNKNOWN data received",r);return}const o=ue.wrap(new Uint8Array(r,0,r.byteLength));if(fT(o,rs.Terminate)){n=true;_5("received terminate message from renderer");return}i.fire(o)};this.protocol={onMessage:i.event,send:s=>{if(!n){const r=s.buffer.buffer.slice(s.buffer.byteOffset,s.buffer.byteOffset+s.buffer.byteLength);e.port1.postMessage(r,[r])}}}}}function aM(t){return new Promise(e=>{const i=t.onMessage(n=>{i.dispose();const s=JSON.parse(n.toString());t.send(Yy(rs.Initialized));e({protocol:t,initData:s})});t.send(Yy(rs.Ready))})}let _5=t=>g5();function lM(t){return!!t&&typeof t==="object"&&t.type==="vscode.init"&&t.data instanceof Map}function cM(){Qi(`code/extHost/willConnectToRenderer`);const t=new oM;return{onmessage(e){if(!lM(e)){return}aM(t.protocol).then(i=>{Qi(`code/extHost/didWaitForInitData`);const n=new xy(i.protocol,i.initData,rM,null,e.data);nM(s=>n.asBrowserUri(s));sM(s=>n.asBrowserUri(s),()=>n.getAllStaticBrowserUris());_5=s=>n.terminate(s)})}}}const uM=cM();self.onmessage=t=>uM.onmessage(t.data);
