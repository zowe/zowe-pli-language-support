import{cs as N,X as E,aq as m,ce as z,_ as M,e as T,ct as b,ai as H,cu as x,cv as i,cw as u,aB as S,a0 as g,as as h,cx as _,cy as C,cz as D,cA as A,cB as L,a2 as w,cC as B,cD as O,bc as y,cE as v,cF as P,cG as $,ci as R,cH as F,cI as W,cJ as I,cK as K,cL as G}from"./index-DzGITddh.js";const V=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));var p;N(V);let l=class Q extends E{static{p=this}static{this.ID="editor.contrib.inspectTokens"}static get(t){return t.getContribution(p.ID)}constructor(t,e,n){super();this._editor=t;this._languageService=n;this._widget=null;this._register(this._editor.onDidChangeModel(o=>this.stop()));this._register(this._editor.onDidChangeModelLanguage(o=>this.stop()));this._register(m.onDidChange(o=>this.stop()));this._register(this._editor.onKeyUp(o=>o.keyCode===z.Escape&&this.stop()))}dispose(){this.stop();super.dispose()}launch(){if(this._widget){return}if(!this._editor.hasModel()){return}this._widget=new f(this._editor,this._languageService)}stop(){if(this._widget){this._widget.dispose();this._widget=null}}};l=p=M([T(1,b),T(2,H)],l);class j extends v{constructor(){super({id:"editor.action.inspectTokens",label:P.inspectTokensAction,alias:"Developer: Inspect Tokens",precondition:void 0})}run(t,e){const n=l.get(e);n?.launch()}}function U(d){let t="";for(let e=0,n=d.length;e<n;e++){const o=d.charCodeAt(e);switch(o){case y.Tab:t+="→";break;case y.Space:t+="·";break;default:t+=String.fromCharCode(o)}}return t}function q(d,t){const e=m.get(t);if(e){return e}const n=d.encodeLanguageId(t);return{getInitialState:()=>O,tokenize:(o,c,r)=>B(t,r),tokenizeEncoded:(o,c,r)=>w(n,r)}}class f extends E{static{this._ID="editor.contrib.inspectTokensWidget"}constructor(t,e){super();this.allowEditorOverflow=true;this._editor=t;this._languageService=e;this._model=this._editor.getModel();this._domNode=document.createElement("div");this._domNode.className="tokens-inspect-widget";this._tokenizationSupport=q(this._languageService.languageIdCodec,this._model.getLanguageId());this._compute(this._editor.getPosition());this._register(this._editor.onDidChangeCursorPosition(n=>this._compute(this._editor.getPosition())));this._editor.addContentWidget(this)}dispose(){this._editor.removeContentWidget(this);super.dispose()}getId(){return f._ID}_compute(t){const e=this._getTokensAtLine(t.lineNumber);let n=0;for(let a=e.tokens1.length-1;a>=0;a--){const k=e.tokens1[a];if(t.column-1>=k.offset){n=a;break}}let o=0;for(let a=e.tokens2.length>>>1;a>=0;a--){if(t.column-1>=e.tokens2[a<<1]){o=a;break}}const c=this._model.getLineContent(t.lineNumber);let r="";if(n<e.tokens1.length){const a=e.tokens1[n].offset;const k=n+1<e.tokens1.length?e.tokens1[n+1].offset:c.length;r=c.substring(a,k)}x(this._domNode,i("h2.tm-token",void 0,U(r),i("span.tm-token-length",void 0,`${r.length} ${r.length===1?"char":"chars"}`)));u(this._domNode,i("hr.tokens-inspect-separator",{"style":"clear:both"}));const s=(o<<1)+1<e.tokens2.length?this._decodeMetadata(e.tokens2[(o<<1)+1]):null;u(this._domNode,i("table.tm-metadata-table",void 0,i("tbody",void 0,i("tr",void 0,i("td.tm-metadata-key",void 0,"language"),i("td.tm-metadata-value",void 0,`${s?s.languageId:"-?-"}`)),i("tr",void 0,i("td.tm-metadata-key",void 0,"token type"),i("td.tm-metadata-value",void 0,`${s?this._tokenTypeToString(s.tokenType):"-?-"}`)),i("tr",void 0,i("td.tm-metadata-key",void 0,"font style"),i("td.tm-metadata-value",void 0,`${s?this._fontStyleToString(s.fontStyle):"-?-"}`)),i("tr",void 0,i("td.tm-metadata-key",void 0,"foreground"),i("td.tm-metadata-value",void 0,`${s?S.Format.CSS.formatHex(s.foreground):"-?-"}`)),i("tr",void 0,i("td.tm-metadata-key",void 0,"background"),i("td.tm-metadata-value",void 0,`${s?S.Format.CSS.formatHex(s.background):"-?-"}`)))));u(this._domNode,i("hr.tokens-inspect-separator"));if(n<e.tokens1.length){u(this._domNode,i("span.tm-token-type",void 0,e.tokens1[n].type))}this._editor.layoutContentWidget(this)}_decodeMetadata(t){const e=m.getColorMap();const n=g.getLanguageId(t);const o=g.getTokenType(t);const c=g.getFontStyle(t);const r=g.getForeground(t);const s=g.getBackground(t);return{languageId:this._languageService.languageIdCodec.decodeLanguageId(n),tokenType:o,fontStyle:c,foreground:e[r],background:e[s]}}_tokenTypeToString(t){switch(t){case h.Other:return"Other";case h.Comment:return"Comment";case h.String:return"String";case h.RegEx:return"RegEx";default:return"??"}}_fontStyleToString(t){let e="";if(t&_.Italic){e+="italic "}if(t&_.Bold){e+="bold "}if(t&_.Underline){e+="underline "}if(t&_.Strikethrough){e+="strikethrough "}if(e.length===0){e="---"}return e}_getTokensAtLine(t){const e=this._getStateBeforeLine(t);const n=this._tokenizationSupport.tokenize(this._model.getLineContent(t),true,e);const o=this._tokenizationSupport.tokenizeEncoded(this._model.getLineContent(t),true,e);return{startState:e,tokens1:n.tokens,tokens2:o.tokens,endState:n.endState}}_getStateBeforeLine(t){let e=this._tokenizationSupport.getInitialState();for(let n=1;n<t;n++){const o=this._tokenizationSupport.tokenize(this._model.getLineContent(n),true,e);e=o.endState}return e}getDomNode(){return this._domNode}getPosition(){return{position:this._editor.getPosition(),preference:[C.BELOW,C.ABOVE]}}}D(l.ID,l,A.Lazy);L(j);class J extends v{constructor(){super({id:"editor.action.toggleHighContrast",label:$.toggleHighContrast,alias:"Toggle High Contrast Theme",precondition:void 0});this._originalThemeName=null}run(t,e){const n=t.get(b);const o=n.getColorTheme();if(R(o.type)){n.setTheme(this._originalThemeName||(I(o.type)?F:W));this._originalThemeName=null}else{n.setTheme(I(o.type)?K:G);this._originalThemeName=o.themeName}}}L(J);function Y(){return{}}export{Y as default};
